/**
 * Copyright @ 2019 Esri.
 * All rights reserved under the copyright laws of the United States and applicable international laws, treaties, and conventions.
 */
define(["esri/views/3d/layers/graphics/Graphics3DSymbolCommonCode","esri/core/libs/gl-matrix-2/vec3f64","esri/core/libs/gl-matrix-2/mat4f64","esri/core/libs/gl-matrix-2/vec3","esri/core/libs/gl-matrix-2/mat4","esri/views/3d/webgl-engine/lib/Util","esri/views/3d/support/mathUtils"],function(r,e,a,i,t,s,o){var l=e.vec3f64,i=i.vec3,c=a.mat4f64,t=t.mat4,n=s.logWithBase,v=1e4,m=10,f={getOrigin:function(e,a,s,f){if(!(e.length<=0)){var h=l.create();r.chooseOrigin(e,s,f,h),r.subtractCoordinates(e,0,a,h);for(var g,u=0,b=l.fromValues(e[u],e[u+1],e[u+2]),d=l.create(this.bbMin),M=0;M<a;M++){u=3*M;for(var p=0;p<3;p++)g=e[u+p],g<b[p]?b[p]=g:g>d[p]&&(d[p]=g)}var w=l.create();i.lerp(w,b,d,.5);for(var x=0,M=0;M<a;M++){u=3*M;var C=e[u]-w[0],_=e[u+1]-w[1],y=e[u+2]-w[2],O=C*C+_*_+y*y;O>x&&(x=O)}x=Math.sqrt(x);var S=c.create();t.translate(S,S,h);var U=o.maxScale(S);i.transformMat4(w,w,S),x*=U;var V=m,q=0,B=x*V/v;B>1&&(q=Math.ceil(n(B,2)));var D=Math.pow(2,q)*v,M=Math.round(w[0]/D),G=Math.round(w[1]/D),p=Math.round(w[2]/D),W=q+"_"+M+"_"+G+"_"+p;return{vec3:l.fromValues(M*D,G*D,p*D),id:W}}}};return f});