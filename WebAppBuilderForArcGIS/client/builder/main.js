// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dojo/promise/all":function(){define(["../_base/array","../_base/lang","../Deferred","../when"],function(p,g,t,v){var n=p.some;return function(m){var u,k;g.isArray(m)?k=m:m&&"object"===typeof m&&(u=m);var f,e=[];if(u){k=[];for(var b in u)Object.hasOwnProperty.call(u,b)&&(e.push(b),k.push(u[b]));f={}}else k&&(f=[]);if(!k||!k.length)return(new t).resolve(f);var a=new t;a.promise.always(function(){f=e=null});var c=k.length;n(k,function(b,w){u||e.push(w);v(b,function(b){a.isFulfilled()||
(f[e[w]]=b,0===--c&&a.resolve(f))},a.reject);return a.isFulfilled()});return a.promise}})},"dojo/cookie":function(){define(["./_base/kernel","./regexp"],function(p,g){p.cookie=function(p,v,n){var m=document.cookie,u;if(1==arguments.length)u=(u=m.match(new RegExp("(?:^|; )"+g.escapeString(p)+"\x3d([^;]*)")))?decodeURIComponent(u[1]):void 0;else{n=n||{};m=n.expires;if("number"==typeof m){var k=new Date;k.setTime(k.getTime()+864E5*m);m=n.expires=k}m&&m.toUTCString&&(n.expires=m.toUTCString());v=encodeURIComponent(v);
var m=p+"\x3d"+v,f;for(f in n)m+="; "+f,k=n[f],!0!==k&&(m+="\x3d"+k);document.cookie=m}return u};p.cookie.isSupported=function(){"cookieEnabled"in navigator||(this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled="CookiesAllowed"==this("__djCookieTest__"),navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1}));return navigator.cookieEnabled};return p.cookie})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(p,g){var t={};g.setObject("dojo.regexp",
t);t.escapeString=function(g,n){return g.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(m){return n&&-1!=n.indexOf(m)?m:"\\"+m})};t.buildGroupRE=function(g,n,m){if(!(g instanceof Array))return n(g);for(var u=[],k=0;k<g.length;k++)u.push(n(g[k]));return t.group(u.join("|"),m)};t.group=function(g,n){return"("+(n?"?:":"")+g+")"};return t})},"dojo/request/script":function(){define("module ./watch ./util ../_base/kernel ../_base/array ../_base/lang ../on ../dom ../dom-construct ../has ../_base/window".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){function a(a,b){a.canDelete&&C._remove(a.id,b.options.frameDoc,!0)}function c(a){D&&D.length&&(n.forEach(D,function(a){C._remove(a.id,a.frameDoc);a.frameDoc=null}),D=[]);return a.options.jsonp?!a.data:!0}function x(a){return!!this.scriptLoaded}function w(a){return(a=a.options.checkString)&&eval("typeof("+a+') !\x3d\x3d "undefined"')}function q(a,b){if(this.canDelete){var c=this.response.options;D.push({id:this.id,frameDoc:c.ioArgs?c.ioArgs.frameDoc:c.frameDoc});c.ioArgs&&
(c.ioArgs.frameDoc=null);c.frameDoc=null}b?this.reject(b):this.resolve(a)}function C(b,e,f){var k=t.parseArgs(b,t.deepCopy({},e));b=k.url;e=k.options;var n=t.deferred(k,a,c,e.jsonp?null:e.checkString?w:x,q);m.mixin(n,{id:z+E++,canDelete:!1});e.jsonp&&((new RegExp("[?\x26]"+e.jsonp+"\x3d")).test(b)||(b+=(~b.indexOf("?")?"\x26":"?")+e.jsonp+"\x3d"+(e.frameDoc?"parent.":"")+z+"_callbacks."+n.id),n.canDelete=!0,F[n.id]=function(a){k.data=a;n.handleResponse(k)});t.notify&&t.notify.emit("send",k,n.promise.cancel);
if(!e.canAttach||e.canAttach(n)){var D=C._attach(n.id,b,e.frameDoc,function(a){if(!(a instanceof Error)){var b=Error("Error loading "+(a.target?a.target.src:"script"));b.source=a;a=b}n.reject(a);C._remove(n.id,e.frameDoc,!0)});if(!e.jsonp&&!e.checkString)var I=u(D,B,function(a){if("load"===a.type||G.test(D.readyState))I.remove(),n.scriptLoaded=a})}g(n);return f?n:n.promise}e.add("script-readystatechange",function(a,b){return"undefined"!==typeof b.createElement("script").onreadystatechange&&("undefined"===
typeof a.opera||"[object Opera]"!==a.opera.toString())});var z=p.id.replace(/[\/\.\-]/g,"_"),E=0,B=e("script-readystatechange")?"readystatechange":"load",G=/complete|loaded/,F=v.global[z+"_callbacks"]={},D=[];C.get=C;C._attach=function(a,c,e,f){e=e||b.doc;var q=e.createElement("script");if(f)u.once(q,"error",f);q.type="text/javascript";try{q.src=c}catch(Q){f&&f(q)}q.id=a;q.async=!0;q.charset="utf-8";return e.getElementsByTagName("head")[0].appendChild(q)};C._remove=function(a,b,c){f.destroy(k.byId(a,
b));F[a]&&(c?F[a]=function(){delete F[a]}:delete F[a])};C._callbacksProperty=z+"_callbacks";return C})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/promise/all dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/geometryEngine esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils ./shared/utils ./accessibleUtils ./zoomToUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U,V,A,X,aa,l,d,h,r){function y(d,h){d=d||"";var l=0,r=[{test:window.File&&window.FileReader&&window.FileList&&window.Blob||!N.file.isEnabledFlash(),failure:[d+"libs/polyfills/fileAPI/FileAPI.js"],callback:function(){l++;l===r.length&&h()}}];for(d=0;d<r.length;d++)testLoad(r[d])}function H(d,h){var l=d.match(/url\([^)]+\)/gi),r,y;if(null===l||""===h)return d;for(r=0;r<l.length;r++)if(y=l[r].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),
4<=y.length){var a=y[2];/^data:image\/.*;/.test(a)||(h.endWith("/")||(h+="/"),d=d.replace(y[1]+a+y[3],y[1]+h+a+y[3]))}return d}function P(d,h){var l=Array.isArray(h),r=l&&[]||{};l?(d=d||[],r=r.concat(d),h.forEach(function(h,l){"undefined"===typeof d[l]?r[l]=h:"object"===typeof h?r[l]=P(d[l],h):-1===d.indexOf(h)&&r.push(h)})):(d&&"object"===typeof d&&Object.keys(d).forEach(function(h){r[h]=d[h]}),Object.keys(h).forEach(function(l){r[l]="object"===typeof h[l]&&h[l]?d[l]?P(d[l],h[l]):h[l]:h[l]}));return r}
function ba(d,h){var l=d.map(function(d){return d.id});g.forEach(h,function(h){0>l.indexOf(h)&&d.push({id:h,widgets:[]})},this);var r=[];d=g.filter(d,function(d){return 0>h.indexOf(d.id)?(r.push(d),!1):!0},this);if(0===d.length)return[];var y=d[d.length-1];g.forEach(r,function(d){y.widgets=y.widgets.concat(d.widgets)},this);return d=d.sort(function(d,l){return h.indexOf(d.id)-h.indexOf(l.id)})}function ea(d,h,l){function r(d,h){return p.isArray(d[h.key])?d[h.key][h.index]:d[h.key]}h=function(d){var h=
[];d.split("_").forEach(function(d){var l=!1,r;"--"===d.slice(d.length-2)&&(l=!0,d=d.slice(0,d.length-2));r=d.search(/\[[0-9]+\]/);-1===r&&(r=d.length);h.push({key:d.slice(0,r),index:Number(d.slice(r+1,-1)),deleteFlag:l})});return h}(h);for(var y=1;y<h.length-1;y++)if(d=r(d,h[y]),!d)return;if(h[h.length-1].deleteFlag)!0===l&&(p.isArray(d[h[h.length-1].key])?delete d[h[h.length-1].key][h[h.length-1].index]:delete d[h[h.length-1].key]);else if(p.isArray(d[h[h.length-1].key])){if(void 0===l)return d[h[h.length-
1].key][h[h.length-1].index];d[h[h.length-1].key][h[h.length-1].index]=l}else{if(void 0===l)return d[h[h.length-1].key];d[h[h.length-1].key]=l}}function va(d,h,l){function r(l){l=N.template.getSearchRange(h,l,"]");var r=h.slice(l.firstPos,l.lastPos);return-1!==l.firstPos?(r=h.slice(l.firstPos+r.indexOf("[")+1,l.lastPos-1),l=h.slice(l.lastPos+1),(r=N.getConfigElementById(d,r))?{object:r,key:"section_"+l,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var y=d,a=h=h.replace(/\//g,"_"),H=
r("groups\\[.+\\]");if("deleted"!==H.state&&("isSection"===H.state&&(y=H.object,a=H.key),H=r("widgets\\[.+\\]"),"delete"!==H.state))return"isSection"===H.state&&(y=H.object,a=H.key),ea(y,a,l)}var N={},Ca={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"};p.mixin(N,d);p.mixin(N,h);p.mixin(N,r);window.atob||(window.atob=function(d){d=C.decode(d);for(var h="",l=0,r=d.length;l<r;l++)h+=String.fromCharCode(d[l]);return h});window.btob||(window.btob=function(d){for(var h=
[],l=0,r=d.length;l<r;l++)h.push(String.charCodeAt(d[l]));return C.encode(h)});var ma="unload",wa=[];require.on("error",function(d){g.forEach(wa,function(h){d.info[0]&&-1<d.info[0].indexOf(h.resKey)&&h.def.reject(d);for(var l in d.info)-1<l.indexOf(h.resKey)&&h.def.reject(d)})});N.checkError=function(d,h){wa.push({resKey:d,def:h})};N.replacePlaceHolder=function(d,h){var l=a.stringify(d),r=l.match(/\$\{(\w)+\}/g);if(null===r)return d;for(d=0;d<r.length;d++){var y=r[d].match(/(\w)+/g)[0];h[y]&&(l=l.replace(r[d],
h[y]))}return a.parse(l)};N.changeUnit=function(d){var h=Math.abs(d),l;d=Math.floor(h);l=Math.floor(60*(h-d));h=(60*(60*(h-d)-l)).toFixed(2);return d+"\u00b0"+(10>l?"0"+l:l)+"'"+(10>h?"0"+h:h)+'"'};N.formatTime=function(d){var h=d/1E3;d=Math.floor(h/60);h=Number(h-60*d).toFixed(1);return(10>d?"0"+d:d)+":"+(10>h?"0"+h:h)};N.parseTime=function(d){var h=/(\d{2,})\:(\d{2})\.(\d{1})/;if(!h.test(d))return console.log("wrong time format."),-1;d=d.match(h);return 1E3*(60*parseInt(d[1],10)+parseInt(d[2],10)+
parseInt(d[3],10)/10)};N.preloadImg=function(d,h){var l=[],l="string"===typeof d?[d]:d;g.forEach(l,function(d){(new Image).src=h?h+d:d})};N.setWABLogoDefaultAlt=function(d){if(d){d=u("img",d);for(var h=0,l=d.length;h<l;h++){var r=d[h];"img_1545621838463"!==t.getAttr(r,"id")&&"img_1412759111499"!==t.getAttr(r,"id")||t.getAttr(r,"alt")||t.setAttr(r,"alt","Web AppBuilder for ArcGIS.png")}}};var xa=null;N.getImagesSize=function(d){var h=new f;if(!d||0!==d.indexOf("http"))return h.reject(),h;null===xa&&
(xa=t.create("img",{id:"__test-image-size",style:{position:"absolute",left:"-9999px",top:"-9999px"}},document.body));var l=b(xa,"load",function(){clearTimeout(r);r=null;l.remove();var d=t.getContentBox(xa);1===d.w&&1===d.h||0===d.w||0===d.h?h.reject():h.resolve([d.w,d.h])},{}),r=setTimeout(function(){clearTimeout(r);r=null;h.reject()},5E3);t.setAttr(xa,"src",d);return h};N.getPositionStyle=function(d){var h={};if(!d)return h;d=p.clone(d);if(window.isRTL){var l;"undefined"!==typeof d.left&&"undefined"!==
typeof d.right?(l=d.left,d.left=d.right,d.right=l):"undefined"!==typeof d.left?(d.right=d.left,delete d.left):"undefined"!==typeof d.right&&(d.left=d.right,delete d.right);"undefined"!==typeof d.paddingLeft&&"undefined"!==typeof d.paddingRight?(l=d.paddingLeft,d.paddingLeft=d.paddingRight,d.paddingRight=l):"undefined"!==typeof d.paddingLeft?(d.paddingRight=d.paddingLeft,delete d.paddingLeft):"undefined"!==typeof d.paddingRight&&(d.paddingLeft=d.paddingRight,delete d.paddingRight);"undefined"!==typeof d.marginLeft&&
"undefined"!==typeof d.marginRight?(l=d.marginLeft,d.marginLeft=d.marginRight,d.marginRight=l):"undefined"!==typeof d.marginLeft?(d.marginRight=d.marginLeft,delete d.marginLeft):"undefined"!==typeof d.marginRight&&(d.marginLeft=d.marginRight,delete d.marginRight)}l="left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom margin marginLeft marginRight marginTop marginBottom".split(" ");for(var r=0;r<l.length;r++){var y=l[r];"number"===typeof d[y]?h[y]=d[y]+"px":
"undefined"!==typeof d[y]?h[y]=d[y]:"padding"===y.substr(0,7)||"margin"===y.substr(0,7)?h[y]=0:h[y]="auto"}h.zIndex="undefined"===typeof d.zIndex?"auto":d.zIndex;return h};N.isEqual=function(d,h){function l(d,h){var a;if(null===d&&null===h||"undefined"===typeof d&&"undefined"===typeof h)return!0;if(null===d&&null!==h||null===h&&null!==d||"undefined"===typeof d&&"undefined"!==typeof h||"undefined"===typeof h&&"undefined"!==typeof d)return!1;if(isNaN(d)&&isNaN(h)&&"number"===typeof d&&"number"===typeof h||
d===h)return!0;if("function"===typeof d&&"function"===typeof h||d instanceof Date&&h instanceof Date||d instanceof RegExp&&h instanceof RegExp||d instanceof String&&h instanceof String||d instanceof Number&&h instanceof Number)return d.toString()===h.toString();if(-1<r.indexOf(d)||-1<y.indexOf(h))return!1;if(null!==h){for(a in h)if(h.hasOwnProperty(a)!==d.hasOwnProperty(a)||typeof h[a]!==typeof d[a])return!1;for(a in d){if(h.hasOwnProperty(a)!==d.hasOwnProperty(a)||typeof h[a]!==typeof d[a])return!1;
switch(typeof d[a]){case "object":case "function":r.push(d);y.push(h);if(!l(d[a],h[a]))return!1;r.pop();y.pop();break;default:if(!(isNaN(d[a])&&isNaN(h[a])&&"number"===typeof d[a]&&"number"===typeof h[a]||d[a]===h[a]))return!1}}}return!0}var r,y;r=[];y=[];return l(d,h)?!0:!1};N.file={loadFileAPI:function(){var d=new f;if("unload"===ma){var h=window.isBuilder?"stemapp/":"";window.FileAPI={debug:!1,flash:!0,staticPath:h+"libs/polyfills/fileAPI/",flashUrl:h+"libs/polyfills/fileAPI/FileAPI.flash.swf",
flashImageUrl:h+"libs/polyfills/fileAPI/FileAPI.flash.image.swf"};y(h,p.hitch(this,function(){ma="loaded";d.resolve()}));ma="loading"}else"loaded"===ma&&d.resolve();return d},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return v("safari")&&6>v("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var d=null;if(document.all)try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(la){d=
null}else navigator.plugins&&0<navigator.plugins.length&&(d=navigator.plugins["Shockwave Flash"]);return!!d},containSeparator:function(d){return 0<=d.indexOf("/")?!0:0<=d.indexOf("\\")?!0:!1},getNameFromPath:function(d){var h="",h=0<=d.indexOf("/")?"/":"\\";d=d.split(h);return 0<d.length?d[d.length-1]:null},getFolderFromPath:function(d){return d.substr(0,d.length-N.file.getNameFromPath(d).length)},readFile:function(d,h,l,r){if(this.supportHTML5()){var y=d.target.files[0];y&&(y.type.match(h)?y.size>=
l?r({errCode:"exceed"}):(d=new FileReader,d.onload=function(d){r(null,y.name,d.target.result)},d.readAsDataURL(y)):r({errCode:"invalidType"}))}else if(this.supportFileAPI()){var a=window.FileAPI.getFiles(d);a[0].type.match(h)?a[0].size>=l?r({errCode:"exceed"}):window.FileAPI.readAsDataURL(a[0],function(d){d&&d.result?r(null,a[0].name,d.result):r({errCode:"readError"})}):r({errCode:"invalidType"})}}};N.getUriInfo=function(d){var h,l={};h=d.indexOf("/");d.substring(0,h);h=d.substring(0,d.lastIndexOf("/")+
1);l.folderUrl=require(N.getRequireConfig()).toUrl(h);l.amdFolder=h;l.url=l.folderUrl;if(/^http(s)?:\/\//.test(d)||/^\/\//.test(d))l.isRemote=!0;return l};N.widgetJson=function(){var d={addManifest2WidgetJson:function(d,h){p.mixin(d,h.properties);d.name=h.name;d.label||(d.label=h.label);d.manifest=h;d.isRemote=h.isRemote;d.isRemote&&(d.itemId=h.itemId);h.featureActions&&(d.featureActions=h.featureActions);d.icon||(d.icon=h.icon);d.thumbnail||(d.thumbnail=h.thumbnail);d.folderUrl=h.folderUrl;d.amdFolder=
h.amdFolder},removeManifestFromWidgetJson:function(d){if(d.manifest){for(var h in d.manifest.properties)d[h]=void 0;d.name=void 0;d.label=void 0;d.featureActions=void 0;d.manifest=void 0}},getUriFromItem:function(h){return h.url?d.getFolderUrlFromItem(h)+"Widget":null},getFolderUrlFromItem:function(d){if(!d.url)return null;d=/manifest\.json$/.test(d.url)?d.url.substring(0,d.url.length-13):/\/$/.test(d.url)?d.url:d.url+"/";"https:"===window.location.protocol&&(d=d.replace(/^http:\/\//,"https://"));
return d}};return d}();N.getRequireConfig=function(){if(jimuConfig){var d=[];jimuConfig.widgetsPackage&&(d=d.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(d=d.concat(jimuConfig.themesPackage));jimuConfig.configsPackage&&(d=d.concat(jimuConfig.configsPackage));return{packages:d}}return{}};N.getTypeByGeometryType=function(d){var h="",l="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),r=["esriGeometryRing",
"esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(d)?h="point":0<=l.indexOf(d)?h="polyline":0<=r.indexOf(d)&&(h="polygon");return h};N.getSymbolTypeByGeometryType=function(d){var h=null;d=N.getTypeByGeometryType(d);"point"===d?h="marker":"polyline"===d?h="line":"polygon"===d&&(h="fill");return h};N.getServices=function(){return Ca};N.getArcGISDefaultGeometryService=function(){return new M(Ca.geometryService)};N.restoreToDefaultWebMapExtent=function(d,
h,l){var r=new f;if(!d||"esri.Map"!==d.declaredClass)return setTimeout(function(){r.reject("Invalid map.")},0),r;h=h&&h.itemInfo;if(!h)return setTimeout(function(){r.reject("Invalid itemInfo")},0),r;h=h.item&&h.item.extent;if(!h)return setTimeout(function(){r.reject("Invalid itemInfo.item.extent")}),r;var y=new G({wkid:4326}),y=new F(h[0][0],h[0][1],h[1][0],h[1][1],y);if(4326===parseInt(d.spatialReference.wkid,10))return d.setExtent(y);if(d.spatialReference.isWebMercator())return y=L.geographicToWebMercator(y),
d.setExtent(y);h=new Q;h.geometries=[y];h.outSR=d.spatialReference;y=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;y&&"esri.tasks.GeometryService"===y.declaredClass||(l&&"string"===typeof l&&p.trim(l)?(l=p.trim(l),y=new M(l)):y=N.getArcGISDefaultGeometryService());y.project(h).then(function(h){if(h=h&&h[0])return d.setExtent(h);r.reject("Invalid projected geometry.");return r},function(d){console.error(d);r.reject(d);return r});return r};N.getAncestorWindow=function(){for(var d=
window;d&&d.parent&&d!==d.parent;)d=d.parent;return d};N.getAncestorDom=function(d,h,l){if(d&&1===d.nodeType&&h&&"function"===typeof h){var r=100,y=document.body;l&&("number"===typeof l?(l=parseInt(l,10),0<l&&(r=l)):1===l.nodeType&&(y=l));for(l=0;d.parentNode&&l<r&&t.isDescendant(d.parentNode,y);){if(h(d.parentNode))return d.parentNode;d=d.parentNode;l++}}return null};N.bindClickAndDblclickEvents=function(d,h,l,r){var y=null;if(d&&1===d.nodeType&&h&&"function"===typeof h&&l&&"function"===typeof l){var a=
200;r&&"number"===typeof r&&(r=parseInt(r,10),0<r&&(a=r));var H=0,y=b(d,"click",function(d){H++;1===H?setTimeout(function(){1===H&&(H=0,h(d))},a):2===H&&(H=0,l(d))})}return y};N.isScrollToBottom=function(d){var h=t.getContentBox(d);return 1>d.scrollHeight-(d.scrollTop+h.h)};N.getAllItemTypes=function(){var d=[],d=d.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
"Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In","Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return d=d.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
"Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};N.getItemQueryStringByTypes=function(d){var h="",l=N.getAllItemTypes();if(d&&0<d.length&&0<d.length){var r="";g.forEach(d,function(h,l){r+=' type:"'+h+'" ';l!==d.length-1&&(r+=" OR ")});h=" ( "+r+" ) ";l=d.concat(l);l=g.filter(l,function(h){return g.every(d,
function(d){return 0>d.toLowerCase().indexOf(h.toLowerCase())})});g.forEach(l,function(d){h+=' -type:"'+d+'" '})}return h};N.getItemQueryStringByTypeKeywords=function(d){var h="";d&&0<d.length&&(h=' typekeywords:"'+d.join(",")+'" ');return h};N.isNotEmptyString=function(d,h){var l=d&&"string"===typeof d;return l?h?l&&p.trim(d):!0:!1};N.isNotEmptyStringArray=function(d,h){for(var l=0;l<d.length;l++){var r=d[l];if(!N.isNotEmptyString(r.value?r.value:r,h))return!1}return!0};N.isValidNumber=function(d){return"number"===
typeof d&&!isNaN(d)};N.isValidNumberArray=function(d){for(var h=0;h<d.length;h++){var l=d[h],l=l.value||0===l.value?l.value:l;if(!N.isValidNumber(l))return!1}return!0};N.isValidDate=function(d){if(d)try{return!isNaN((new Date(d)).getTime())}catch(la){return console.error(la),!1}else return!1};N.isObject=function(d){return d&&"object"===typeof d};N.createWebMap=function(d,h,r,y){d=l.getStandardPortalUrl(d);d=l.getBaseItemUrl(d);E.arcgisUrl=d;return E.createMap(h,r,y)};N.getRandomString=function(){var d=
Math.random().toString();return d=d.slice(2,d.length)};N._getDomainsByServerName=function(d){var h=d.split("."),l=h.length;return g.map(h,p.hitch(this,function(d,r){d=h.slice(r,l);var y="",a=d.length-1;g.forEach(d,p.hitch(this,function(d,h){y+=d;h!==a&&(y+=".")}));return y}))};N.removeCookie=function(d,h){var l=this._getDomainsByServerName(window.location.hostname);g.forEach(l,p.hitch(this,function(l){c(d,null,{expires:-1,path:h});c(d,null,{expires:-1,path:h,domain:l});c(d,null,{expires:-1,path:h,
domain:"."+l})}))};N.isLocaleChanged=function(d,h){return!d.startWith(h)};N.hashToObject=function(d){d=d.replace("#","");d=m.queryToObject(d);for(var h in d)if(d.hasOwnProperty(h))try{d[h]=a.parse(d[h])}catch(ua){}return d};N.reCreateObject=function(d){function h(d){var r=[];d.forEach(function(d){Array.isArray(d)?r.push(h(d)):"object"===typeof d?r.push(l(d)):r.push(d)});return r}function l(d){var r={},y;for(y in d)d.hasOwnProperty(y)&&(null===d[y]?r[y]=null:Array.isArray(d[y])?r[y]=h(d[y]):r[y]="object"===
typeof d[y]?l(d[y]):d[y]);return r}return Array.isArray(d)?h(d):l(d)};N.setVerticalCenter=function(d){setTimeout(function(){var h=u(".jimu-vcenter-text",d),l,r;g.forEach(h,function(d){l=t.getContentBox(d).h;t.setStyle(d,{lineHeight:l+"px"})},this);h=u(".jimu-vcenter",d);g.forEach(h,function(d){l=t.getContentBox(d).h;r=t.getContentBox(u(d).parent()[0]).h;t.setStyle(d,{marginTop:(r-l)/2+"px"})},this)},10)};N.merge=P;N.loadStyleLink=function(d,h,l){var r=new f,y,a=require(N.getRequireConfig()).toUrl(h);
if(require.cache["url:"+a]){y=require.cache["url:"+a];var A=a.split("/").pop(),a=a.substr(0,a.length-A.length);y=H(y,a);d=l?t.create("style",{id:d,type:"text/css"},t.byId(l),"before"):t.create("style",{id:d,type:"text/css"},document.getElementsByTagName("head")[0]);d.styleSheet&&!d.sheet?d.styleSheet.cssText=y:d.appendChild(t.toDom(y));r.resolve("load");return r}y=l?t.create("link",{id:d,rel:"stylesheet",type:"text/css",href:a+"?wab_dv\x3d"+window.deployVersion},t.byId(l),"before"):t.create("link",
{id:d,rel:"stylesheet",type:"text/css",href:a+"?wab_dv\x3d"+window.deployVersion},document.getElementsByTagName("head")[0]);b(y,"load",function(){r.resolve("load")});var c=setInterval(function(){var d;if(g.some(document.styleSheets,function(l){if(l.href&&l.href.substr(l.href.indexOf(h),l.href.length)===h)return d=l,!0}))try{!r.isFulfilled()&&(d.cssRules&&d.cssRules.length||d.rules&&d.rules.length)&&r.resolve("load"),clearInterval(c)}catch(za){}},50);return r};N.changeLocation=function(d){window.history.pushState&&
window.history.pushState({path:d},"",encodeURI(d))};N.urlToObject=function(d){var h=null;-1===d.indexOf("#")?(h=O.urlToObject(d),h.hash=null):(d=d.split("#"),h=O.urlToObject(d[0]),h.hash=d[1]?-1<d[1].indexOf("\x3d")?m.queryToObject(d[1]):d[1]:null);return h};N.manifest=function(){function h(d){d.panels.forEach(function(d){d.uri="panels/"+d.name+"/Panel.js"});d.styles.forEach(function(d){d.uri="styles/"+d.name+"/style.css"});d.layouts.forEach(function(d){d.uri="layouts/"+d.name+"/config.json";d.icon=
"layouts/"+d.name+"/icon.png";d.RTLIcon="layouts/"+d.name+"/icon_rtl.png"})}return{addManifestProperies:function(l){l.icon||(l.icon=l.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion);l.thumbnail||(l.thumbnail=l.folderUrl+"images/thumbnail.png");"theme"===l.category?h(l):("undefined"!==typeof l["2D"]&&(l.support2D=l["2D"]),"undefined"!==typeof l["3D"]&&(l.support3D=l["3D"]),"undefined"===typeof l["2D"]&&"undefined"===typeof l["3D"]&&(l.support2D=!0),delete l["2D"],delete l["3D"],"undefined"===
typeof l.properties&&(l.properties={}),d.processWidgetProperties(l))},processManifestLabel:function(d,h){var l=h.split("-")[0];d.label=d.i18nLabels&&(d.i18nLabels[h]||d.i18nLabels[l]||d.i18nLabels.defaultLabel)||d.label||d.name;d.layouts&&g.forEach(d.layouts,function(l){var r="i18nLabels_layout_"+l.name;l.label=d[r]&&(d[r][h]||d[r].defaultLabel)||l.label||l.name});d.styles&&g.forEach(d.styles,function(l){var r="i18nLabels_style_"+l.name;l.label=d[r]&&(d[r][h]||d[r].defaultLabel)||l.label||l.name})},
addI18NLabel:function(h){var l=new f;if(h.i18nLabels)return l.resolve(h),l;h.i18nLabels={};if(h.properties&&!1===h.properties.hasLocale)return l.resolve(h),l;var r;r=h.isRemote?h.amdFolder+"nls/strings.js":h.amdFolder+"nls/strings";require(N.getRequireConfig(),["dojo/i18n!"+r],function(r){var y={};y[dojoConfig.locale]=r;d.addI18NLabelToManifest(h,null,y);l.resolve(h)});return l}}}();N.isNumberField=function(d){return 0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"].indexOf(d)};N.getTime=function(d){var h=d.getTimezoneOffset(),h=0>h?"+"+Math.abs(h)/60:"-"+h/60;return d.getTime()+36E5*h};N.getUniqueValues=function(d,h,l,r,y){return function(){var h=new f,l={};r?(l.layerDefinition=r,y&&(l.fieldPopupInfo=y),h.resolve(l)):h=W({url:d,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(d){l.layerDefinition=d;return l},function(d){console.log("Error: ",d.message)});return h}().then(function(r){return N._getUniqueValues(d,
h,l,r.layerDefinition).then(function(d){return N._getValues(r.layerDefinition,r.fieldPopupInfo,h,d)})})};N._getValues=function(d,h,l,r){var y=[],y=N.getFieldInfoByFieldName(d.fields,l),a=null,H=N.isNumberField(y.type),A="esriFieldTypeDate"===y.type?!0:!1;if(y&&(H?r=g.map(r,function(d){d=parseFloat(d);isNaN(d)&&(d=null);return d}):A&&(r=g.map(r,p.hitch(this,function(d){return N.isValidDate(d)?(d=0>(h?h.format.dateFormat:"").indexOf("Time")?d:N.getTime(new Date(d)),N.localizeDateByFieldInfo(new Date(d),
h)):d}))),d=N.getCodedValueListForCodedValueOrSubTypes(d,l),null!==d))for(a={},l=0;l<d.length;l++)a[d[l].value]=d[l].label;return y=g.map(r,function(d){var l=null,l=null===d||void 0===d?"\x3cNull\x3e":a&&a.hasOwnProperty(d)?a[d]:H?h?N.localizeNumberByFieldInfo(d,h):N.localizeNumber(d):d;return{value:d,label:l}})};N._getUniqueValues=function(d,h,l,r){var y=new f;d=d.replace(/\/*$/g,"");l||(l="1\x3d1");var y=/\/ImageServer$/gi.test(d),a=-1<d.indexOf("MapServer/dynamicLayer");y||a?y=N._getUniqueValuesByQueryTask(d,
h,l):(y=N.getFieldInfoByFieldName(r.fields,h),y=0<N.getCodedValuesOrTypesCount(y,r)?N._getUniqueValuesByQueryTask(d,h,l):N._getUniqueValuesByGenerateRenderer(d,h,l));return y};N.getCodedValuesOrTypesCount=function(d,h){return d?h.typeIdField&&h.typeIdField.toUpperCase()===d.name.toUpperCase()&&h.types?h.types.length:(d=N._getAllCodedValue(h,d))?d.length:0:0};N._getUniqueValuesByQueryTask=function(d,h,l){var r=new U;r.where=l;r.returnDistinctValues=!0;r.returnGeometry=!1;r.outFields=[h];return(new V(d)).execute(r).then(function(d){var l=
[];d.features&&0<d.features.length&&g.forEach(d.features,function(d){d&&d.attributes&&l.push(d.attributes[h])});return l})};N._getUniqueValuesByGenerateRenderer=function(d,h,l){var r=new f,y=d.split("?");d=1<y.length?y[0].replace(/\/*$/g,"")+"/generateRenderer?"+y[1]:d.replace(/\/*$/g,"")+"/generateRenderer";h=a.stringify({type:"uniqueValueDef",uniqueValueFields:[h]});W({url:d,content:{classificationDef:h,f:"json",where:l},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(d){var h=
[];(d=d&&d.uniqueValueInfos)&&0<d.length&&(h=g.map(d,p.hitch(this,function(d){return d.value})));r.resolve(h)}),p.hitch(this,function(d){r.reject(d)}));return r};N.isCodedValuesSupportFilter=function(d,h){d=d.currentVersion?d:d.toJson().layerDefinition;var l=parseFloat(d.currentVersion);return h<=parseFloat(d.maxRecordCount)&&10.1<l};N.combineRadioCheckBoxWithLabel=function(d,h){var l=!1;if(d&&1===d.nodeType&&"input"===d.tagName.toLowerCase()){var r=d.getAttribute("type")||"",r=r.toLowerCase();if("radio"===
r||"checkbox"===r)l=!0}r=!1;h&&1===h.nodeType&&"label"===h.tagName.toLowerCase()&&(r=!0);l&&r&&(l=d.getAttribute("id"),l||(l="input_"+N.getRandomString(),d.setAttribute("id",l)),h.setAttribute("for",l),t.setStyle(h,"cursor","pointer"))};N.groupRadios=function(d,h){var l=[],r="radiogroup_"+N.getRandomString();g.forEach(d,function(d){d.name=r;h&&(d=b(d,"change",h),l.push(d))});return l};N.convertExtentToPolygon=function(d){var h=d.xmin,l=d.xmax,r=d.ymin,y=d.ymax;return new J({rings:[[[h,y],[l,y],[l,
r],[h,r],[h,y]]],spatialReference:d.toJson()})};N.combineGeometries=function(d){function h(d){var h={points:[],spatialReference:d[0].spatialReference.toJson()};g.forEach(d,function(d){"point"===d.type?h.points=h.points.concat([[d.x,d.y]]):"multipoint"===d.type&&(h.points=h.points.concat(d.points))});return new I(h)}function l(d){var h={paths:[],spatialReference:d[0].spatialReference.toJson()};g.forEach(d,function(d){h.paths=h.paths.concat(d.paths)});return new K(h)}function r(d){var h={rings:[],spatialReference:d[0].spatialReference.toJson()};
g.forEach(d,function(d){"polygon"===d.type?h.rings=h.rings.concat(d.rings):"extent"===d.type&&(d=N.convertExtentToPolygon(d),h.rings=h.rings.concat(d.rings))});return new J(h)}var y=null;if(d&&0<d.length)if(1===d.length)y=d[0];else{for(var a=null,H=null,A=null,b=null,c=0;c<d.length;c++){a=d[c];switch(a.type){case "point":case "multipoint":b="point";break;case "polyline":b="polyline";break;case "polygon":case "extent":b="polygon";break;default:return null}if(0===c)A=b;else if(A!==b)return null;if(c!==
d.length-1&&(H=d[c+1],!a.spatialReference.equals(H.spatialReference)))return null}"point"===b?y=h(d):"polyline"===b?y=l(d):"polygon"===b&&(y=r(d))}return y};N.combineGeometriesByGraphics=function(d){var h=null;d&&0<d.length&&(d=g.map(d,function(d){return d.geometry}),h=N.combineGeometries(d));return h};N.isFeaturelayerUrlSupportQuery=function(d,h){var l=!1,r=/\/featureserver\//gi.test(d);d=/\/mapserver\//gi.test(d);h=(h||"").toLowerCase();r?l=0<=h.indexOf("query"):d&&(l=0<=h.indexOf("data"));return l};
N.isImageServiceSupportQuery=function(d){return 0<=(d||"").toLowerCase().indexOf("catalog")};N.isStringEndWith=function(d,h){return d.lastIndexOf(h)+h.length===d.length};N.localizeNumber=function(d,h){var l=(d.toString().split(".")[1]||"").length,r="",r=h&&isFinite(h.places)&&h.places,r=0<r||0<l?"#,###,###,##0.0"+Array.prototype.join.call({length:0<r?r+1:l},"0"):"#,###,###,##0",l={locale:n.locale,pattern:r};p.mixin(l,h||{});try{return x.format(d,l)}catch(oa){return console.error(oa),d.toLocaleString()}};
N.parseNumber=function(d,h){var l={locale:n.locale};p.mixin(l,h||{});try{return x.parse(d,l)}catch(Ea){return console.error(Ea),d}};N.localizeDate=function(d,h){var l={locale:n.locale,fullYear:!0};p.mixin(l,h||{});"ar"===n.locale&&"long"!==l.formatLength&&"full"!==l.formatLength&&(l.formatLength="long");try{return w.format(d,l)}catch(Ea){return console.error(Ea),"date"===l.selector?d.toLocaleDateString():"time"===l.selector?d.toLocaleTimeString():d.toLocaleString()}};N.localizeNumberByFieldInfo=function(d,
h){var l=null,l=p.exists("format.places",h)&&h.format.places,l=N.localizeNumber(d,{places:l});return p.exists("format.digitSeparator",h)&&!h.format.digitSeparator?l.toString().replace(new RegExp("\\"+q.group,"g"),""):l};N.localizeDateByFieldInfo=function(d,h){var l=null;try{var r={date:d instanceof Date?d.getTime():d},y=p.exists("format.dateFormat",h)?h.format.dateFormat:"longMonthDayYear",l=z.substitute(r,"${date}",{dateFormat:{properties:["date"],formatter:"DateFormat"+B.prototype._dateFormats[y]}})}catch(ra){console.error(ra),
l=d}return l};N.fieldFormatter={getFormattedUrl:function(d){if(d&&"string"===typeof d){var h=d.indexOf("http:");-1===h&&(h=d.indexOf("https:"));if(-1<h&&-1===d.indexOf("href\x3d")){var l=d.indexOf(" ",h);-1===l&&(l=d.length);var r=-1<d.indexOf("\r\n",h)?d.indexOf("\r\n",h):-1<d.indexOf("\n",h)?d.indexOf("\n",h):l,l=r<l?r:l,r=d.substring(h,l);d=d.substring(0,h)+'\x3cA href\x3d"'+r+'" target\x3d"_blank"\x3e'+r+"\x3c/A\x3e"+d.substring(l,d.length)}}return null===d?"":d},getFormattedNumber:function(d,
h){if("number"===typeof d){var l=(d.toString().split(".")[1]||"").length;d=N.localizeNumberByFieldInfo(d,{format:{places:h&&"number"===typeof h.places?parseInt(h.places,10):l,digitSeparator:h&&h.digitSeparator}});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(d||"")+"\x3c/span\x3e"}return d},getFormattedDate:function(d,h){if("number"===typeof d||d instanceof Date)d=N.localizeDateByFieldInfo(d,{format:h});return d||""},getCodedValue:function(d,h){if(d&&d.codedValues){for(var l=0,r=d.codedValues.length;l<
r;l++){var y=d.codedValues[l];if(z.isDefined(h)&&p.exists("code",y)&&h.toString()===y.code.toString())return y.name}return h}return h||null},getTypeName:function(d,h){for(var l=h.length,r=0;r<l;r++)if(d===h[r].id)return h[r].name;return d}};N.addRelativePathInCss=H;N.url={isAbsolute:function(d){return d?d.startWith("http")||d.startWith("/"):!1},removeQueryParamFromUrl:function(d,h){d=O.urlToObject(d);d.query&&delete d.query[h];h=d.path;for(var l in d.query)h=h===d.path?h+"?"+l+"\x3d"+d.query[l]:h+
"\x26"+l+"\x3d"+d.query[l];return h},addQueryParamToUrl:function(d,h,l){d=O.urlToObject(d);d.query||(d.query={});d.query[h]=l;h=d.path;for(var r in d.query)h=h===d.path?h+"?"+r+"\x3d"+d.query[r]:h+"\x26"+r+"\x3d"+d.query[r];return h},compareUrl:function(d,h){d=this.getUrlPath(d);h=this.getUrlPath(h);d=l.removeProtocol(d.toString().toLowerCase()).replace(/\/+/g,"/");h=l.removeProtocol(h.toString().toLowerCase()).replace(/\/+/g,"/");return d===h},getUrlPath:function(d){return O.urlToObject(d).path}};
N.processUrlInWidgetConfig=function(d,h){if(d)return d.startWith("data:")||d.startWith("http")||d.startWith("/")?d:d.startWith("${appPath}")?d.replace("${appPath}",window.appInfo.appPath):h+d};N.processUrlInAppConfig=function(d){if(d)return d.startWith("data:")||d.startWith("http")||d.startWith("/")?d:window.appInfo.appPath+d};N.getLocationUrlWithoutHashAndQueryParams=function(){var d=window.location,h=d.protocol+"//"+d.host+d.pathname,d=O.urlToObject(d.href);d.query&&d.query.apiurl&&(h=N.url.addQueryParamToUrl(h,
"apiurl",d.query.apiurl));return h};N.getDefaultWebMapThumbnail=function(){return require.toUrl("jimu/images/webmap.png")};N.invertColor=function(d){d=d.substring(1);3===d.length&&(d=d.slice(0,1)+d.slice(0,1)+d.slice(1,1)+d.slice(1,1)+d.slice(2,1)+d.slice(2,1));d=parseInt(d,16);return 7829367<d?"#000000":"#ffffff"};N.isLightColor=function(d){d=d.substring(1);3===d.length&&(d=d.slice(0,1)+d.slice(0,1)+d.slice(1,1)+d.slice(1,1)+d.slice(2,1)+d.slice(2,1));d=parseInt(d,16);return 7829367<d?!0:!1};N.mixinAppConfigPosition=
function(d,h){var l=p.clone(d);if(!h)return l;h=p.clone(h);var r=l.widgetOnScreen,y=h.widgetOnScreen;y&&y.widgets&&("[object Object]"===Object.prototype.toString.call(y.widgets)?g.forEach(r.widgets,function(d,h){h=d.uri?d.uri:"ph_"+h;y.widgets[h]&&y.widgets[h].position&&(y.widgets[h].position.relativeTo||(y.widgets[h].position.relativeTo="map"),d.position=y.widgets[h].position)},this):g.forEach(y.widgets,function(d,h){d.position&&!d.position.relativeTo&&(d.position.relativeTo="map");r.widgets[h]&&
d.position&&(r.widgets[h].position=d.position)}));y&&y.groups&&("[object Object]"===Object.prototype.toString.call(y.groups)?g.forEach(r.groups,function(d,h){h=d.label?d.label:"g_"+h;y.groups[h]&&y.groups[h].panel&&y.groups[h].panel.position&&(y.groups[h].panel.position.relativeTo||(y.groups[h].panel.position.relativeTo="map"),d.panel.position=y.groups[h].panel.position)},this):(d=d.layoutDefinition?d.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager","jimu/layoutManagers/AbsolutePositionLayoutManager"===
d?g.forEach(y.groups,function(d,h){d.panel&&d.panel.position&&!d.panel.position.relativeTo&&(d.panel.position.relativeTo="map");r.groups[h]&&d.panel&&d.panel.position&&(r.groups[h].panel.position=d.panel.position)}):"jimu/layoutManagers/GridLayoutManager"===d&&(r.groups=ba(r.groups,y.groups.map(function(d){return d.id})))));h.map&&h.map.position&&(l.map?l.map.position=h.map.position:l.map={position:h.map.position});h.widgetPool&&h.widgetPool.panel&&(h.widgetPool.panel.position&&!h.widgetPool.panel.position.relativeTo&&
(h.widgetPool.panel.position.relativeTo="map"),l.widgetPool.panel.position=h.widgetPool.panel.position);h.mobileLayout&&(l.mobileLayout=h.mobileLayout);return l};N.handleGridLayoutOnScreenGroupChange=ba;N.template={groupIdentification:"groups\\[.+\\]",widgetIdentification:"widgets\\[.+\\]",getSearchRange:function(d,h,l){var r=-1;h=d.search(new RegExp(h));0<=h&&(d=d.slice(h,d.length),d=d.indexOf(l),r=h+d+l.length);return{firstPos:h,lastPos:r}},setConfigValue:function(d,h,l){ea(d,h,l)},getConfigValue:function(d,
h){return ea(d,h)},setConfigValueWithId:function(d,h,l){va(d,h,l)},getConfigValueWithId:function(d,h){return va(d,h)},getKeyInfo:function(d){var h=this.getWidgetIdByKey(d);if(null!==h)return{type:"widget",id:h};d=this.getGroupIdByKey(d);return null!==d?{type:"group",id:d}:{type:"unknow",id:null}},getWidgetIdByKey:function(d){var h=N.template.getSearchRange(d,N.template.widgetIdentification,"]");if(-1===h.firstPos)d=null;else{var l=d.slice(h.firstPos,h.lastPos);d=d.slice(h.firstPos+l.indexOf("[")+
1,h.lastPos-1)}return d},getGroupIdByKey:function(d){var h=N.template.getSearchRange(d,N.template.groupIdentification,"]");if(-1===h.firstPos)d=null;else{var l=d.slice(h.firstPos,h.lastPos);d=d.slice(h.firstPos+l.indexOf("[")+1,h.lastPos-1)}return d},getConfigedWidgetsByTemplateConfig:function(d){var h=[],l=N.template.widgetIdentification+"_config",r;g.forEach(d.configurationSettings,function(d){g.forEach(d.fields,function(d){d.fieldName&&(r=N.template.getSearchRange(d.fieldName,l,"]"),0<=r.firstPos&&
(d=N.template.getWidgetIdByKey(d.fieldName),-1===h.indexOf(d)&&h.push(d)))},this)},this);return h},mergeTemplateAppConfigToAppConfig:function(d,h,l){function r(d){var h=[];g.forEach(d,function(d){d&&h.push(d)},this);return h}var y=d.widgetOnScreen,a=d.portalUrl;h.values.webmap&&(d.map.itemId=h.values.webmap);l&&(d.map.mapOptions&&N.deleteMapOptions(d.map.mapOptions),d.map.portalUrl=a,h.values.app_title||(h.values.app_title=l.title),h.values.app_subtitle||(h.values.app_subtitle=l.snippet));for(var H in h.values)"webmap"!==
H&&N.template.setConfigValueWithId(d,H,h.values[H]);d.widgetPool.widgets=r(d.widgetPool.widgets);y.widgets=r(y.widgets);if(d.widgetPool.groups)for(h=0;h<d.widgetPool.groups.length;h++)d.widgetPool.groups[h].widgets=r(d.widgetPool.groups[h].widgets);if(y.groups)for(h=0;h<y.groups.length;h++)y.groups[h].widgets=r(y.groups[h].widgets);return d}};N.deleteMapOptions=function(d){d&&(delete d.extent,delete d.lods,delete d.center,delete d.scale,delete d.zoom,delete d.maxScale,delete d.maxZoom,delete d.minScale,
delete d.minZoom)};N.sanitizeHTML=function(d){return html_sanitize(d,function(d){return d},function(d){return d})};N.stripHTML=function(d){return d?-1<d.indexOf("\x3c")&&-1<d.indexOf("\x3e")?d.replace(/<(?:.|\s)*?>/g,""):d:d};N.encodeHTML=function(d){return String(d).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#39;")};N.removeSuffixSlashes=function(d){return d.replace(/\/*$/g,"")};N.getBestDisplayAttributes=function(d,h){var l=
{},r=null,y;for(y in d)r=N.getBestDisplayValue(y,d,h),l[y]=r;return l};N.getBestDisplayValue=function(d,h,l){var r="",y=null;p.isArrayLike(l)?y=N.getFieldInfoByFieldName(l,d):"object"===typeof l&&l.name===d&&(y=l);y&&(r=h[d],"esriFieldTypeDate"===y.type?r&&(d=new Date(parseInt(r,10)),r=N._tryLocaleDate(d)):"number"===typeof r&&(y.domain&&"codedValue"===y.domain.type?g.some(y.domain.codedValues,function(d){if(d.code===r)return r=d.name,!0}):r=N._tryLocaleNumber(r)));if(null===r||void 0===r)r="";return r};
N._getCodedValues=function(d){var h=null;(d=d.domain)&&"codedValue"===d.type&&d.codedValues&&0<d.codedValues.length&&(h=d.codedValues,h=g.map(h,p.hitch(this,function(d){return{value:d.code,label:d.name}})));return h};N._getSubTypes=function(d){var h=null;d.subtypeField&&d.subtypes&&0<d.subtypes.length&&(h=g.map(d.subtypes,p.hitch(this,function(d){return{value:d.id,label:d.name}})));return h};N._getRenderTypes=function(d){var h=null;d.typeIdField&&d.types&&0<d.types.length&&(h=g.map(d.types,p.hitch(this,
function(d){return{value:d.id,label:d.name}})));return h};N._getCodedValueOrSubtypes=function(d,h,l){var r=N.getFieldInfoByFieldName(d.fields,h);return void 0!==l&&null!==l?N._getCodedValueBySubTypeId(d,h,l,r):N._getAllCodedValue(d,r)};N._getDisplayValueForCodedValueOrSubtype=function(d,h,l,r){var y={isCodedValueOrSubtype:!1,displayValue:l+""};(d=N._getCodedValueOrSubtypes(d,h,r))&&0<d.length&&g.some(d,p.hitch(this,function(d){return d.value===l?(y={isCodedValueOrSubtype:!0,displayValue:d.label},
!0):!1}));return y};N._deleteSubtypePropertiesTemp=function(d){delete d.subtypeField;delete d.subtypes};N.getDisplayValueForCodedValueOrSubtype=function(d,h,l){N._deleteSubtypePropertiesTemp(d);var r=l[h],y,a=d.typeIdField;l.hasOwnProperty(a)&&(y=l[a]);(a=d.subtypeField)&&d.subtypes&&0<d.subtypes.length&&l.hasOwnProperty(a)&&(y=l[a]);r=N._getDisplayValueForCodedValueOrSubtype(d,h,r,y);d.typeIdField===h&&(r.displayValue=N._updateCodedValueListFromRender(d,[{value:l[h],label:r.displayValue}])[0].label);
return r};N._getDisplayValueFromCodedValues=function(d,h){var l={isCodedValueOrSubtype:!1,displayValue:d+""};h&&0<h.length&&g.some(h,p.hitch(this,function(h){return h.value===d?(l={isCodedValueOrSubtype:!0,displayValue:h.label},!0):!1}));l.value=d;return l};N.getDisplayValueForCodedValueOrSubtypeBatch=function(d,h,l){N._deleteSubtypePropertiesTemp(d);var r={},y=d.typeIdField,a=d.subtypeField,H=N.getFieldInfoByFieldName(d.fields,h);a&&d.subtypes&&0<d.subtypes.length?(r.subType=N._getSubTypes(d),y=
a,r.all=N._getAllCodedValueNew(d,H)):(r.all=N._getAllCodedValue(d,H),r.subType=N._getRenderTypes(d));if(r.subType&&0<r.subType.length){var a=r.subType,A;for(A in a){var b=a[A].value,c=N._getCodedValueBySubTypeId(d,h,b,H);r[b]=d.typeIdField===h?N._updateCodedValueListFromRender(d,c):c}}d.typeIdField===h&&(r.subType=N._updateCodedValueListFromRender(d,r.subType),r.all=N._updateCodedValueListFromRender(d,r.all));b=[];A=[];for(var e in l)b=l[e],a=b[h],y===h?b=r.subType:b.hasOwnProperty(y)?(b=b[y],b=r[b],
b||(b=N._getCodedValues(H),d.typeIdField===h&&(b=N._updateCodedValueListFromRender(d,b)))):b=r.all,a=N._getDisplayValueFromCodedValues(a,b),A.push(a);return A};N._getUniquCodedValue=function(d,h,l){d[h]?l!==d[h]&&(d[h]=d[h]+", "+l):d[h]=l;return d};N._getAllCodedValue=function(d,h){var l=h.name,r={},y=null,a=!0;if(d.typeIdField&&d.types&&0<d.types.length)g.map(d.types,p.hitch(this,function(d){d.domains&&d.domains[l]&&(d=d.domains[l],"inherited"===d.type?a&&(a=!1,d=N._getCodedValues(h),g.map(d,p.hitch(this,
function(d){r=N._getUniquCodedValue(r,d.value,d.label)}))):d.codedValues&&0<d.codedValues.length&&g.map(d.codedValues,p.hitch(this,function(d){r=N._getUniquCodedValue(r,d.code,d.name)})))})),y||(y=N._getCodedValues(h));else return this._getCodedValues(h);d=[];var H=N.isNumberField(h.type),A;for(A in r){var b=H?parseFloat(A):A;d.push({value:b,label:r[A]})}0<d.length&&(y=d);return y};N._getAllCodedValueNew=function(d,h){var l=h.name,r={},y=null,a=!0;if(d.subtypeField&&d.subtypes&&0<d.subtypes.length)g.map(d.subtypes,
p.hitch(this,function(d){d.domains&&d.domains[l]&&(d=d.domains[l],"inherited"===d.type?a&&(a=!1,d=N._getCodedValues(h),g.map(d,p.hitch(this,function(d){r=N._getUniquCodedValue(r,d.value,d.label)}))):d.codedValues&&0<d.codedValues.length&&g.map(d.codedValues,p.hitch(this,function(d){r=N._getUniquCodedValue(r,d.code,d.name)})))})),y||(y=N._getCodedValues(h));else return this._getCodedValues(h);d=[];var H=N.isNumberField(h.type),A;for(A in r){var b=H?parseFloat(A):A;d.push({value:b,label:r[A]})}0<d.length&&
(y=d);return y};N._getCodedValueBySubTypeId=function(d,h,l,r){var y="typeIdField",a="types";d.subtypeField&&d.subtypes&&0<d.subtypes.length&&(y="subtypeField",a="subtypes");var H=null;r=r?r:N.getFieldInfoByFieldName(d.fields,h);d[y]&&d[a]&&0<d[a].length?(g.map(d[a],p.hitch(this,function(a){if(a.id===l){if(h===d[y])return H=[{value:a.id,label:a.name}],!0;a.domains&&a.domains[h]?(a=a.domains[h],"inherited"===a.type?H=N._getCodedValues(r):a.codedValues&&0<a.codedValues.length&&(H=g.map(a.codedValues,
p.hitch(this,function(d){return{value:d.code,label:d.name}})))):a.domains&&(H=N._getCodedValues(r))}})),H||(H=N._getCodedValues(r))):H=N._getCodedValues(r);return H};N.getCodedValueListForCodedValueOrSubTypes=function(d,h,l){N._deleteSubtypePropertiesTemp(d);var r=null,r=N.getFieldInfoByFieldName(d.fields,h),y,a;l&&(y=l[d.typeIdField],a=l[d.subtypeField]);if(d.subtypeField&&d.subtypes&&0<d.subtypes.length)return h===d.subtypeField?(r=N._getSubTypes(d),void 0!==a&&(l=N._getDisplayValueFromCodedValues(a,
r),r=[{value:l.value,label:l.displayValue}])):r=void 0===a?N._getAllCodedValueNew(d,r):N._getCodedValueBySubTypeId(d,h,a,r),h===d.typeIdField&&(r=N._updateCodedValueListFromRender(d,r)),r;d.subtypeField="";d.subtypes=[];d.typeIdField&&d.typeIdField.toUpperCase()===h.toUpperCase()?(r=N._getRenderTypes(d),l&&void 0!==y&&null!==y&&(l=N._getDisplayValueFromCodedValues(y,r),r=[{value:l.value,label:l.displayValue}])):r=l&&void 0!==y&&null!==y?N._getCodedValueBySubTypeId(d,h,y,r):N._getAllCodedValue(d,r);
h===d.typeIdField&&(r=N._updateCodedValueListFromRender(d,r));return r};N._verifyIfFieldIsSubtypeField=function(d,h){var l={isSubtypeField:!1,subtypeField:""};if(d.subtypeField)return l={isSubtypeField:d.subtypeField===h.name,subtypeField:d.subtypeField};["esriFieldTypeSmallInteger","esriFieldTypeInteger"].indexOf(h.type)&&d.typeIdField===h.name&&d.types&&0<d.types.length&&(void 0===d.types[0].domains[h.name]?l={isSubtypeField:!0,subtypeField:h.name}:l.isSubtypeField=!1);return!1};N._getRendererFromLayerDef=
function(d){var h=null;d.drawingInfo&&d.drawingInfo.renderer&&"uniqueValue"===d.drawingInfo.renderer.type&&(h=d.drawingInfo.renderer);return h};N._getRenderValueLabelsForUnique=function(d){var h=null,l=null,r=N._getRendererFromLayerDef(d);r?(h={},l=r.uniqueValueInfos):d.renderer&&(r=d.toJson().layerDefinition,r=N._getRendererFromLayerDef(r),d=d.renderer.toJson(),"uniqueValue"===d.type&&r&&r.field1===d.field1?(h={},l=d.uniqueValueInfos):r&&(h={},l=r.uniqueValueInfos));if(l)for(d=0;d<l.length;d++)r=
l[d],h[r.value]=r.label;return h};N._updateCodedValueListFromRender=function(d,h){if((d=N._getRenderValueLabelsForUnique(d))&&h)for(var l=0;l<h.length;l++){var r=h[l];d[r.value]&&(r.label=d[r.value])}return h};N.getDefaultPortalFieldInfo=function(d){var h=d.name,h={fieldName:h,label:d.alias||h,tooltip:"",visible:!1,format:null,stringFieldOption:"textbox"};switch(d.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":h.format={places:0,digitSeparator:!0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":h.format=
{places:2,digitSeparator:!0};break;case "esriFieldTypeDate":h.format={dateFormat:"longMonthDayYear"}}return h};N.getDefaultPopupInfo=function(d,h,l){var r=null;d&&d.fields&&(r={title:h,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},g.forEach(d.fields,function(d){var h=!1;l?g.some(l,p.hitch(this,function(h){return h&&d.name.toLowerCase()===h.toLowerCase()}))&&(h=!0):h=!0;h&&(h=this.getDefaultPortalFieldInfo(d),h.visible=!0,h.isEditable=d.editable,r.fieldInfos.push(h))},this));return r};
N._tryLocaleNumber=function(d){var h=N.localizeNumber(d);if(null===h||void 0===h)h=d;return h};N._tryLocaleDate=function(d){var h=N.localizeDate(d);h||(h=d.toLocaleDateString());return h};N.getFieldInfoByFieldName=function(d,h){var l=null;d&&0<d.length&&g.some(d,p.hitch(this,function(d){return d.name===h?(l=d,!0):!1}));return l};N.getDateFieldFormatByFieldName=function(d,h){if(d&&0<d.length)for(var l=0;l<d.length;l++){var r=d[l];if(r.fieldName===h){if(r.format&&r.format.dateFormat)return r.format.dateFormat;
break}}return""};N.completePopupFieldFromLayerField=function(d,h){if(!h)return d;for(var l in d){var r=d[l].name,y=!1,a;for(a in h)if(h[a].fieldName===r){y=!0;break}y||(r=N.getPopupFieldFromLayerField(d[l]),h.push(r))}return h};N.getPopupFieldFromLayerField=function(d){return{fieldName:d.name,isEditable:d.editable,label:d.alias,visible:d.visible?d.visible:!1,stringFieldOption:"esriFieldTypeString"===d.type?"textbox":null,tooltips:"",domain:d.domain?d.domain:null}};N.containsNonLatinCharacter=function(d){for(var h=
0;h<d.length;h++)if(255<d.charCodeAt(h))return!0;return!1};N.has=function(d){var h=v(d);if(h)return h;if("ie"===d.toLowerCase()){d=0;var l=/MSIE (\d+\.\d+);/.test(navigator.userAgent),r=!!navigator.userAgent.match(/Trident\/7.0/),y=navigator.userAgent.indexOf("rv:11.0");l&&(d=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(d=10);r&&-1!==y&&(d=11);return 11===d&&11||h}if("edge"===d.toLowerCase())return navigator.userAgent.split("Edge/")[1]||h};N.detectUserAgent=function(){var d={},
h={},l=navigator.userAgent,r=navigator.platform,y=l.match(/Web[kK]it[\/]{0,1}([\d.]+)/),a=l.match(/(Android);?[\s\/]+([\d.]+)?/),H=!!l.match(/\(Macintosh\; Intel /),A=l.match(/(iPad).*OS\s([\d_]+)/),b=l.match(/(iPod)(.*OS\s([\d_]+))?/),c=!A&&l.match(/(iPhone\sOS)\s([\d_]+)/),e=l.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),r=/Win\d{2}|Windows/.test(r),f=l.match(/Windows Phone ([\d.]+)/),q=e&&l.match(/TouchPad/),w=l.match(/Kindle\/([\d.]+)/),P=l.match(/Silk\/([\d._]+)/),x=l.match(/(BlackBerry).*Version\/([\d.]+)/),
k=l.match(/(BB10).*Version\/([\d.]+)/),C=l.match(/(RIM\sTablet\sOS)\s([\d.]+)/),z=l.match(/PlayBook/),m=l.match(/Chrome\/([\d.]+)/)||l.match(/CriOS\/([\d.]+)/),B=l.match(/Firefox\/([\d.]+)/),u=l.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),n=l.match(/MSIE\s([\d.]+)/)||l.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),g=!m&&l.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),F=g||l.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);h.webkit=!!y;h.webkit&&(h.version=
y[1]);a&&(d.android=!0,d.version=a[2]);c&&!b&&(d.ios=d.iphone=!0,d.version=c[2].replace(/_/g,"."));A&&(d.ios=d.ipad=!0,d.version=A[2].replace(/_/g,"."));b&&(d.ios=d.ipod=!0,d.version=b[3]?b[3].replace(/_/g,"."):null);f&&(d.wp=!0,d.version=f[1]);e&&(d.webos=!0,d.version=e[2]);q&&(d.touchpad=!0);x&&(d.blackberry=!0,d.version=x[2]);k&&(d.bb10=!0,d.version=k[2]);C&&(d.rimtabletos=!0,d.version=C[2]);z&&(h.playbook=!0);w&&(d.kindle=!0,d.version=w[1]);P&&(h.silk=!0,h.version=P[1]);!P&&d.android&&l.match(/Kindle Fire/)&&
(h.silk=!0);m&&(h.chrome=!0,h.version=m[1]);B&&(h.firefox=!0,h.version=B[1]);u&&(d.firefoxos=!0,d.version=u[1]);n&&(h.ie=!0,h.version=n[1]);F&&(H||d.ios||r)&&(h.safari=!0,d.ios||(h.version=F[1]));g&&(h.webview=!0);d.tablet=!!(A||z||a&&!l.match(/Mobile/)||B&&l.match(/Tablet/)||n&&!l.match(/Phone/)&&l.match(/Touch/));d.phone=!(d.tablet||d.ipod||!(a||c||e||x||k||m&&l.match(/Android/)||m&&l.match(/CriOS\/([\d.]+)/)||B&&l.match(/Mobile/)||n&&l.match(/Touch/)));return{os:d,browser:h}};N.isMobileUa=function(){var d=
N.detectUserAgent();return!0===d.os.phone||!0===d.os.tablet?!0:!1};N.inMobileSize=function(){var d=t.getMarginBox(document.body);if(d.w<=window.jimuConfig.breakPoints[0]||d.h<=window.jimuConfig.breakPoints[0])return t.addClass(window.jimuConfig.layoutId,"jimu-ismobile"),!0;t.removeClass(window.jimuConfig.layoutId,"jimu-ismobile");return!1};N.getObjectIdField=function(d){if(d.objectIdField)return d.objectIdField;d=d.fields;for(var h=0;h<d.length;h++){var l=d[h];if("esriFieldTypeOID"===l.type)return l.name}return null};
N.isNeedHttpsButNot=function(){var d=navigator.geolocation,h=window.hasOwnProperty("isSecureContext");return(h&&window.isSecureContext||!h&&"https:"===window.location.protocol)&&d?!1:!0};N.toFeatureSet=function(d){var h=new S;"[object Object]"===Object.prototype.toString.call(d)&&(d=[d]);h.features=d;if(0<d.length){var l;g.some(d,function(d){if(d.geometry)return l=d,!0});if(l){d=l.getLayer();var r={};d&&(h.displayFieldName=d.displayField,g.forEach(d.fields,p.hitch(this,function(d){var h=d.name;r[h]=
d.alias||h})),h.fieldAliases=r);h.geometryType=l.geometry.type;h.spatialReference=l.geometry.spatialReference}}return h};N.showValidationErrorTipForFormDijit=function(d){try{!d.validate()&&d.domNode&&d.focusNode&&(d.focusNode.focus(),setTimeout(p.hitch(this,function(){d.focusNode.blur()}),100))}catch(la){console.error(la)}};N.getFeatureLayerDefinition=function(d){var h=null,l=d.graphics;d.graphics=[];var r=d.toJson();d.graphics=l;r&&(h=r.layerDefinition);return h};N.simulateClickEvent=function(d){if(v("safari")){var h=
document.createEvent("MouseEvents");h.initEvent("click",!0,!0);d.dispatchEvent(h)}else d.click()};N.getFeatureSetByLayerAndFeatures=function(d,h){var l=new S;l.fields=p.clone(d.fields);l.features=h;l.geometryType=d.geometryType;l.fieldAliases={};g.forEach(l.fields,p.hitch(this,function(d){var h=d.name;l.fieldAliases[h]=d.alias||h}));return l};N.featureAction=function(){return{zoomTo:function(d,h,l){l||(l={});if(d&&h&&0<h.length){var r=g.every(h,function(d){return d&&d.spatialReference&&d.type});if(g.every(h,
function(d){return d&&d.geometry&&d.geometry.spatialReference&&d.geometry.type})||r)r&&(h=g.map(h,function(d){return{geometry:d}})),N.zoomToFeatureSet(d,{features:h},l.extentFactor)}},flash:function(d,h){function l(d,h){g.forEach(y,function(l,r){l.setSymbol(h?d:a[r]||H)})}function r(d){return function(){setTimeout(function(){l(A,!0);y[0]&&h&&h.redraw();setTimeout(function(){l(null,!1);y[0]&&h&&h.redraw();d()},200)},200)}}if(g.every(d||[],function(d){return d&&d.geometry})){var y=d;d=y[0];var a=g.map(y,
function(d){return d.symbol}),H=d.symbol||p.getObject("renderer.symbol",!1,h),A=null;h&&"esriGeometryPoint"===h.geometryType?A=new T(require.toUrl("jimu")+"/images/flash.gif",20,20):(A=p.clone(H))&&(A.outline?A.outline.setColor("#ffc500"):A.setColor("#ffc500"));d&&H&&A&&h&&("esriGeometryPoint"===h.geometryType?(l(A,!0),h.redraw(),setTimeout(function(){l(null,!1);h.redraw()},2E3)):r(r(r(function(){})))())}},panTo:function(d,h){g.every(h||[],function(d){return d&&d.geometry})&&(0<h.length?h=A.graphicsExtent(h).getCenter():
(h=h[0].geometry,h="polyline"===h.type||"polygon"===h.type?h.getExtent().getCenter():"extent"===h.type?h.getCenter():"multipoint"===h.type?1<h.points.length?h.getExtent().getCenter():h.getPoint(0):h),d.centerAt(h))},showPopup:function(d,h){g.every(h||[],function(d){return d&&d.geometry})&&(d=d.infoWindow,d.setFeatures(h),h=h[0],"point"===h.geometry.type?d.show(h.geometry,{closetFirst:!0}):d.show(h.geometry.getExtent().getCenter(),{closetFirst:!0}))}}}();N.isInConfigOrPreviewWindow=function(){var d=
!1;try{d=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(la){d=!1}return!!d};N.getAppHref=function(){var d="";return d=N.isInConfigOrPreviewWindow()?window.parent.location.href:window.location.href};N.getAppIdFromUrl=function(){var d=!0,h=N.getAppHref();if(-1!==h.indexOf("id\x3d")||-1!==h.indexOf("appid\x3d")||-1!==h.indexOf("apps"))d=!1;if(!0===d)return h;d=this.urlToObject(window.location.href);if(d.query&&(d.query.id||d.query.appid))return d.query.id||d.query.appid;
if(window.appInfo){if(window.appInfo.id)return window.appInfo.id;if(window.appInfo.appPath){if(d=window.appInfo.appPath.split("/"),d.length&&2<d.length)return d[d.length-2]}else console.error("CAN NOT getAppIdFromUrl")}};N.getEditorContentHeight=function(d,h,l){var r=new f;this._content=d;this._dom=h;this._domParam=l;var y=setTimeout(p.hitch(this,function(){clearTimeout(y);y=null;var d=0,h=this._domParam.contentWidth;try{var l=document.createElement("div");l.setAttribute("id","fakeContent");t.setStyle(l,
"background-size","contain");l.innerHTML=this._content;this._dom.appendChild(l);if(l){var a=u("img",l);a&&a.length&&a.style({maxWidth:h-20+"px"});t.setStyle(l,"position","absolute");t.setStyle(l,"width",h+"px");t.setStyle(l,"left","-99999px");t.setStyle(l,"top","-99999px");t.setStyle(l,"visibility","hidden");var H=t.getContentBox(l);H.h&&(d=H.h,d+=this._domParam.contentMarginTop+this._domParam.footerHeight+8)}}catch(Fa){console.error("can't getEditorContentHeight"+Fa),d=200}r.resolve(d)}),1500);return r};
N.getBase64Data=function(d){var h=new f;if(d&&d.startWith("data:image"))h.resolve(d);else try{W({url:d,handleAs:"arraybuffer"}).then(function(d){var l=new FileReader;l.onloadend=function(){h.resolve(l.result)};l.onerror=function(){h.resolve(null)};l.readAsDataURL(new Blob([d],{type:"image/png"}))},function(){h.resolve(null)})}catch(ua){console.warn(ua),h.resolve(null)}return h};N.getEditorTextColor=function(d,h){return{name:"dijit.editor.plugins.EditorTextColor",custom:{recordUID:N.getColorRecordName(d),
forceAttr:h}}};N.getEditorBackgroundColor=function(d){return{name:"dijit.editor.plugins.EditorBackgroundColor",custom:{recordUID:N.getColorRecordName(d)}}};N.getColorRecordName=function(d){return"wab_cr_"+(d||"")};N.b64toBlob=function(d,h,l){h=h||"";l=l||512;d=window.atob(d.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,""));for(var r=[],y=0;y<d.length;y+=l){for(var a=d.slice(y,y+l),H=Array(a.length),A=0;A<a.length;A++)H[A]=a.charCodeAt(A);a=new Uint8Array(H);r.push(a)}return new Blob(r,{type:h})};
N.subtractionArray=function(d,h){for(var l=d.length-1;0<=l;l--)for(var r=d[l],y=h.length-1;0<=y;y--)if(r===h[y]){d.splice(l,1);h.splice(y,1);break}return d};N.resourcesUrlToBlob=function(d){return W({url:d,handleAs:"blob"})};N.processItemResourceOfAppConfig=function(d,h){function l(d){var h=d.obj,l=d.key,r={obj:h,key:l};"number"===typeof d.i?(r.i=d.i,r.value=h[l][d.i]):r.value=h[l];return r}function r(d){for(var h in d)if("object"===typeof d[h])if(Array.isArray(d[h]))for(var l=d,a=h,H=0;H<l[a].length;H++)"string"===
typeof l[a][H]?y(l,a,H):"object"===typeof l[a][H]&&r(l[a][H]);else r(d[h]);else"string"===typeof d[h]&&y(d,h)}function y(d,r,y){"number"===typeof y?h.test(d[r][y])&&(A=h.func(l({obj:d,key:r,i:y})),"function"===typeof A.then?H.push(A):a.push(A)):h.test(d[r])&&(A=h.func(l({obj:d,key:r})),"function"===typeof A.then?H.push(A):a.push(A))}var a=[],H=[],A;r(d);return 0<H.length?e(H).then(function(h){0<a.length&&(h=h.concat(a));return{appConfig:d,result:h}}):{appConfig:d,result:a}};N.isEsriDomain=function(d){return/^https?:\/\/(?:[\w\-\_]+\.)+(?:esri|arcgis)\.com/.test(d)};
N.uniqueArray=function(d){for(var h=[],l=0;l<d.length;l++)-1===h.indexOf(d[l])&&h.push(d[l]);return h};N.isNotEmptyObject=function(d,h){return h?N.isObject(d)&&0<Object.keys(d).length&&Array.isArray(d):N.isObject(d)&&0<Object.keys(d).length};N.getMinOfArray=function(d){return Number(Math.min.apply(Math,d))};N.getDataSchemaFromLayerDefinition=function(d){var h=d.fields.filter(function(d){return"esriFieldTypeOID"===d.type}),h=0<h.length?h[0]:null;return{geometryType:d.geometryType,fields:d.fields,displayField:d.displayField,
objectIdField:h,typeIdField:d.typeIdField}};N.isValidPointGeometry=function(d){return d&&"point"===d.type&&N.isTrueOrZero(d.x)&&N.isTrueOrZero(d.y)};N.isVaildPointGeometry=N.isValidPointGeometry;N.isNumberOrNumberString=function(d){return/^-?[1-9]\d*$/.test(d)||/^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/.test(d)};N.convertNumberToPercentage=function(d,h,l){if(!N.isNumberOrNumberString(d))return d;"undefined"===typeof l&&(l=!0);"undefined"===typeof h&&(h=2);h={format:{places:h,digitSeparator:l}};
var r=n.locale;l="ar"===r||"tr"===r;r="ar"===r||"he"===r;d=Number(d);var y=!1;0>d&&(y=!0,d=Math.abs(d));d=N.localizeNumberByFieldInfo(100*d,h);d=l?"%"+d:d+"%";y&&(d=r?d+"-":"-"+d);return d};N.getClientFeaturesFromMap=function(d,h,l,r){var y=[],a=!1;if(h){l?0<h.getSelectedFeatures().length?(y=h.getSelectedFeatures(),a=!0):y=h.graphics:y=h.graphics;r&&(y=N.filterFeaturesByExtent(d.extent,y));if(y&&0<y.length){var H=N.getObjectIdField(h);H&&(d=y[0])&&d.attributes&&d.attributes.hasOwnProperty(H)&&y.sort(function(d,
h){d.attributes||(d.attributes={});h.attributes||(h.attributes={});d=d.attributes[H];h=h.attributes[H];return d<h?-1:d>h?1:0})}y.isSelectedFeatures=a;return y}};N.filterFeaturesByExtent=function(d,h){var l=d.normalize();return h=g.filter(h,p.hitch(this,function(d){try{if(d.geometry){var h="point"===d.geometry.type||"multipoint"===d.geometry;return g.some(l,p.hitch(this,function(l){return h?l.contains(d.geometry):D.intersects(l,d.geometry)}))}}catch(ra){console.error(ra)}return!1}))};N.upperCaseString=
function(d){return d&&"string"===typeof d?d.toUpperCase():d};N.lowerCaseString=function(d){return d&&"string"===typeof d?d.toLowerCase():d};N.getUUID=function(){function d(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return d()+d()+"_"+d()+"_"+d()+"_"+d()+"_"+d()+d()+d()};N.checkEssentialAppsLicense=function(d,h,r){var y=l.getStandardPortalUrl(window.portalUrl),a=l.getSharingUrl(y),y=new aa({appId:"arcgisWebApps",portalUrl:y});X.registerOAuthInfos([y]);return r?X.checkAppAccess(a,
"arcgisWebApps"):h.getItemById(d).then(function(d){if("public"!==d.access)return X.checkAppAccess(a,"arcgisWebApps")})};return N})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(p,g,t){var v=p.NodeList;g.extend(v,{_buildArrayFromCallback:function(n){for(var m=[],u=0;u<this.length;u++){var k=n.call(this[u],this[u],m);k&&(m=m.concat(k))}return m},_getUniqueAsNodeList:function(n){for(var m=[],u=0,k;k=n[u];u++)1==k.nodeType&&-1==t.indexOf(m,k)&&m.push(k);
return this._wrap(m,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(n,m){n=this._getUniqueAsNodeList(n);n=m?p._filterResult(n,m):n;return n._stash(this)},_getRelatedUniqueNodes:function(n,m){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(m),n)},children:function(n){return this._getRelatedUniqueNodes(n,function(m,u){return g._toArray(m.childNodes)})},closest:function(n,m){return this._getRelatedUniqueNodes(null,function(u,k){do if(p._filterResult([u],n,m).length)return u;
while(u!=m&&(u=u.parentNode)&&1==u.nodeType);return null})},parent:function(n){return this._getRelatedUniqueNodes(n,function(m,u){return m.parentNode})},parents:function(n){return this._getRelatedUniqueNodes(n,function(m,u){for(u=[];m.parentNode;)m=m.parentNode,u.push(m);return u})},siblings:function(n){return this._getRelatedUniqueNodes(n,function(m,u){u=[];for(var k=m.parentNode&&m.parentNode.childNodes,f=0;f<k.length;f++)k[f]!=m&&u.push(k[f]);return u})},next:function(n){return this._getRelatedUniqueNodes(n,
function(m,u){for(m=m.nextSibling;m&&1!=m.nodeType;)m=m.nextSibling;return m})},nextAll:function(n){return this._getRelatedUniqueNodes(n,function(m,u){for(u=[];m=m.nextSibling;)1==m.nodeType&&u.push(m);return u})},prev:function(n){return this._getRelatedUniqueNodes(n,function(m,u){for(m=m.previousSibling;m&&1!=m.nodeType;)m=m.previousSibling;return m})},prevAll:function(n){return this._getRelatedUniqueNodes(n,function(m,u){for(u=[];m=m.previousSibling;)1==m.nodeType&&u.push(m);return u})},andSelf:function(){return this.concat(this._parent)},
first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(n,m){return 0!=m%2})},odd:function(){return this.filter(function(n,m){return 0==m%2})}});return v})},"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(p,g,t,v,n){var m={};p.setObject("dojo.number",m);m.format=function(k,f){f=p.mixin({},f||{});var e=
g.normalizeLocale(f.locale),e=g.getLocalization("dojo.cldr","number",e);f.customs=e;e=f.pattern||e[(f.type||"decimal")+"Format"];return isNaN(k)||Infinity==Math.abs(k)?null:m._applyPattern(k,e,f)};m._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;m._applyPattern=function(k,f,e){e=e||{};var b=e.customs.group,a=e.customs.decimal;f=f.split(";");var c=f[0];f=f[0>k?1:0]||"-"+c;if(-1!=f.indexOf("%"))k*=100;else if(-1!=f.indexOf("\u2030"))k*=1E3;else if(-1!=f.indexOf("\u00a4"))b=e.customs.currencyGroup||b,a=e.customs.currencyDecimal||
a,f=f.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,b,c,f){return(a=e[["symbol","currency","displayName"][c.length-1]]||e.currency||"")?b+a+f:""});else if(-1!=f.indexOf("E"))throw Error("exponential notation not supported");var x=m._numberPatternRE,c=c.match(x);if(!c)throw Error("unable to find a number expression in pattern: "+f);!1===e.fractional&&(e.places=0);return f.replace(x,m._formatAbsolute(k,c[0],{decimal:a,group:b,places:e.places,round:e.round}))};m.round=function(k,f,e){e=10/
(e||10);return(e*+k).toFixed(f)/e};if(0==(.9).toFixed()){var u=m.round;m.round=function(k,f,e){var b=Math.pow(10,-f||0),a=Math.abs(k);if(!k||a>=b)b=0;else if(a/=b,.5>a||.95<=a)b=0;return u(k,f,e)+(0<k?b:-b)}}m._formatAbsolute=function(k,f,e){e=e||{};!0===e.places&&(e.places=0);Infinity===e.places&&(e.places=6);f=f.split(".");var b="string"==typeof e.places&&e.places.indexOf(","),a=e.places;b?a=e.places.substring(b+1):0<=a||(a=(f[1]||[]).length);0>e.round||(k=m.round(k,a,e.round));k=String(Math.abs(k)).split(".");
var c=k[1]||"";f[1]||e.places?(b&&(e.places=e.places.substring(0,b)),b=void 0!==e.places?e.places:f[1]&&f[1].lastIndexOf("0")+1,b>c.length&&(k[1]=v.pad(c,b,"0",!0)),a<c.length&&(k[1]=c.substr(0,a))):k[1]&&k.pop();a=f[0].replace(",","");b=a.indexOf("0");-1!=b&&(b=a.length-b,b>k[0].length&&(k[0]=v.pad(k[0],b)),-1==a.indexOf("#")&&(k[0]=k[0].substr(k[0].length-b)));var a=f[0].lastIndexOf(","),x,w;-1!=a&&(x=f[0].length-a-1,f=f[0].substr(0,a),a=f.lastIndexOf(","),-1!=a&&(w=f.length-a-1));f=[];for(a=k[0];a;)b=
a.length-x,f.push(0<b?a.substr(b):a),a=0<b?a.slice(0,b):"",w&&(x=w,w=void 0);k[0]=f.reverse().join(e.group||",");return k.join(e.decimal||".")};m.regexp=function(k){return m._parseInfo(k).regexp};m._parseInfo=function(k){k=k||{};var f=g.normalizeLocale(k.locale),f=g.getLocalization("dojo.cldr","number",f),e=k.pattern||f[(k.type||"decimal")+"Format"],b=f.group,a=f.decimal,c=1;if(-1!=e.indexOf("%"))c/=100;else if(-1!=e.indexOf("\u2030"))c/=1E3;else{var x=-1!=e.indexOf("\u00a4");x&&(b=f.currencyGroup||
b,a=f.currencyDecimal||a)}f=e.split(";");1==f.length&&f.push("-"+f[0]);f=n.buildGroupRE(f,function(e){e="(?:"+n.escapeString(e,".")+")";return e.replace(m._numberPatternRE,function(e){var f={signed:!1,separator:k.strict?b:[b,""],fractional:k.fractional,decimal:a,exponent:!1};e=e.split(".");var q=k.places;1==e.length&&1!=c&&(e[1]="###");1==e.length||0===q?f.fractional=!1:(void 0===q&&(q=k.pattern?e[1].lastIndexOf("0")+1:Infinity),q&&void 0==k.fractional&&(f.fractional=!0),!k.places&&q<e[1].length&&
(q+=","+e[1].length),f.places=q);e=e[0].split(",");1<e.length&&(f.groupSize=e.pop().length,1<e.length&&(f.groupSize2=e.pop().length));return"("+m._realNumberRegexp(f)+")"})},!0);x&&(f=f.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,b,c,e){a=n.escapeString(k[["symbol","currency","displayName"][c.length-1]]||k.currency||"");if(!a)return"";b=b?"[\\s\\xa0]":"";e=e?"[\\s\\xa0]":"";return k.strict?b+a+e:(b&&(b+="*"),e&&(e+="*"),"(?:"+b+a+e+")?")}));return{regexp:f.replace(/[\xa0 ]/g,"[\\s\\xa0]"),
group:b,decimal:a,factor:c}};m.parse=function(k,f){f=m._parseInfo(f);k=(new RegExp("^"+f.regexp+"$")).exec(k);if(!k)return NaN;var e=k[1];if(!k[1]){if(!k[2])return NaN;e=k[2];f.factor*=-1}e=e.replace(new RegExp("["+f.group+"\\s\\xa0]","g"),"").replace(f.decimal,".");return e*f.factor};m._realNumberRegexp=function(k){k=k||{};"places"in k||(k.places=Infinity);"string"!=typeof k.decimal&&(k.decimal=".");"fractional"in k&&!/^0/.test(k.places)||(k.fractional=[!0,!1]);"exponent"in k||(k.exponent=[!0,!1]);
"eSigned"in k||(k.eSigned=[!0,!1]);var f=m._integerRegexp(k),e=n.buildGroupRE(k.fractional,function(a){var b="";a&&0!==k.places&&(b="\\"+k.decimal,b=Infinity==k.places?"(?:"+b+"\\d+)?":b+("\\d{"+k.places+"}"));return b},!0),b=n.buildGroupRE(k.exponent,function(a){return a?"([eE]"+m._integerRegexp({signed:k.eSigned})+")":""}),f=f+e;e&&(f="(?:(?:"+f+")|(?:"+e+"))");return f+b};m._integerRegexp=function(k){k=k||{};"signed"in k||(k.signed=[!0,!1]);"separator"in k?"groupSize"in k||(k.groupSize=3):k.separator=
"";var f=n.buildGroupRE(k.signed,function(b){return b?"[-+]":""},!0),e=n.buildGroupRE(k.separator,function(b){if(!b)return"(?:\\d+)";b=n.escapeString(b);" "==b?b="\\s":"\u00a0"==b&&(b="\\s\\xa0");var a=k.groupSize,c=k.groupSize2;return c?(b="(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+b+"]\\d{"+c+"})*["+b+"]\\d{"+a+"})",0<a-c?"(?:"+b+"|(?:0|[1-9]\\d{0,"+(a-1)+"}))":b):"(?:0|[1-9]\\d{0,"+(a-1)+"}(?:["+b+"]\\d{"+a+"})*)"},!0);return f+e};return m})},"dojo/i18n":function(){define("./_base/kernel require ./has ./_base/array ./_base/config ./_base/lang ./_base/xhr ./json module".split(" "),
function(p,g,t,v,n,m,u,k,f){t.add("dojo-preload-i18n-Api",1);u=p.i18n={};var e=/(^.*(^|\/)nls)(\/|$)([^\/]*)\/?([^\/]*)/,b=function(a,b,c,e){var f=[c+e];b=b.split("-");for(var q="",w=0;w<b.length;w++)if(q+=(q?"-":"")+b[w],!a||a[q])f.push(c+q+"/"+e),f.specificity=q;return f},a={},c=function(a,b,c){c=c?c.toLowerCase():p.locale;a=a.replace(/\./g,"/");b=b.replace(/\./g,"/");return/root/i.test(c)?a+"/nls/"+b:a+"/nls/"+c+"/"+b},x=p.getL10nName=function(a,b,e){return a=f.id+"!"+c(a,b,e)},w=function(c,e,
f,q,w,x){c([e],function(k){var C=m.clone(k.root||k.ROOT),z=b(!k._v1x&&k,w,f,q);c(z,function(){for(var b=1;b<z.length;b++)C=m.mixin(m.clone(C),arguments[b]);a[e+"/"+w]=C;C.$locale=z.specificity;x()})})},q=function(a){var b=n.extraLocale||[],b=m.isArray(b)?b:[b];b.push(a);return b},C=function(b,c,f){var x=e.exec(b),C=x[1]+"/",z=x[5]||x[4],u=C+z,n=(x=x[5]&&x[4])||p.locale||"",g=u+"/"+n,x=x?[n]:q(n),D=x.length,I=function(){--D||f(m.delegate(a[g]))},n=b.split("*"),K="preload"==n[1];if(t("dojo-preload-i18n-Api")){if(K&&
(a[b]||(a[b]=1,G(n[2],k.parse(n[3]),1,c)),f(1)),(n=K)||(E&&B.push([b,c,f]),n=E&&!a[g]),n)return}else if(K){f(1);return}v.forEach(x,function(A){var b=u+"/"+A;t("dojo-preload-i18n-Api")&&F(b);a[b]?I():w(c,u,C,z,A,I)})};t("dojo-preload-i18n-Api");var z=u.normalizeLocale=function(a){a=a?a.toLowerCase():p.locale;return"root"==a?"ROOT":a},E=0,B=[],G=u._preloadLocalizations=function(b,c,e,f){function q(a,b){f([a],b)}function w(a,b){for(a=a.split("-");a.length;){if(b(a.join("-")))return;a.pop()}b("ROOT")}
function x(){for(--E;!E&&B.length;)C.apply(null,B.shift())}function k(e){e=z(e);w(e,function(k){if(0<=v.indexOf(c,k)){var C=b.replace(/\./g,"/")+"_"+k;E++;q(C,function(b){for(var A in b){var c=b[A],q=A.match(/(.+)\/([^\/]+)$/),l;if(q&&(l=q[2],q=q[1]+"/",c._localized)){var d;if("ROOT"===k){var h=d=c._localized;delete c._localized;h.root=c;a[g.toAbsMid(A)]=h}else d=c._localized,a[g.toAbsMid(q+l+"/"+k)]=c;k!==e&&function(d,h,l,A){var r=[],y=[];w(e,function(l){A[l]&&(r.push(g.toAbsMid(d+l+"/"+h)),y.push(g.toAbsMid(d+
h+"/"+l)))});r.length?(E++,f(r,function(){for(var H=r.length-1;0<=H;H--)l=m.mixin(m.clone(l),arguments[H]),a[y[H]]=l;a[g.toAbsMid(d+h+"/"+e)]=m.clone(l);x()})):a[g.toAbsMid(d+h+"/"+e)]=l}(q,l,c,d)}}x()});return!0}return!1})}f=f||g;k();v.forEach(p.config.extraLocale,k)},F=function(){},D={},F=function(b){for(var c,e=b.split("/"),f=p.global[e[0]],q=1;f&&q<e.length-1;f=f[e[q++]]);f&&((c=f[e[q]])||(c=f[e[q].replace(/-/g,"_")]),c&&(a[b]=c));return c};u.getLocalization=function(a,b,e){var f,q=c(a,b,e);if(D[q])return D[q];
C(q,g,function(a){f=D[q]=a});return f};return m.mixin(u,{dynamic:!0,normalize:function(a,b){return/^\./.test(a)?b(a):a},load:C,cache:a,getL10nName:x})})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(p,g){var t=/[&<>'"\/]/g,v={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},n={};g.setObject("dojo.string",n);n.escape=function(m){return m?m.replace(t,function(m){return v[m]}):""};n.rep=function(m,u){if(0>=u||!m)return"";
for(var k=[];;){u&1&&k.push(m);if(!(u>>=1))break;m+=m}return k.join("")};n.pad=function(m,u,k,f){k||(k="0");m=String(m);u=n.rep(k,Math.ceil((u-m.length)/k.length));return f?m+u:u+m};n.substitute=function(m,u,k,f){f=f||p.global;k=k?g.hitch(f,k):function(e){return e};return m.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(e,b,a){if(""==b)return"$";e=g.getObject(b,!1,u);a&&(e=g.getObject(a,!1,f).call(f,e,b));a=k(e,b);if("undefined"===typeof a)throw Error('string.substitute could not find key "'+
b+'" in template');return a.toString()})};n.trim=String.prototype.trim?g.trim:function(m){m=m.replace(/^\s+/,"");for(var u=m.length-1;0<=u;u--)if(/\S/.test(m.charAt(u))){m=m.substring(0,u+1);break}return m};return n})},"dojo/date/locale":function(){define("../_base/lang ../_base/array ../date ../cldr/supplemental ../i18n ../regexp ../string ../i18n!../cldr/nls/gregorian module".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a,b,e,f){return f.replace(/([a-z])\1*/ig,function(q){var w,x,k=q.charAt(0);
q=q.length;var C=["abbr","wide","narrow"];switch(k){case "G":w=b[4>q?"eraAbbr":"eraNames"][0>a.getFullYear()?0:1];break;case "y":w=a.getFullYear();switch(q){case 1:break;case 2:if(!e.fullYear){w=String(w);w=w.substr(w.length-2);break}default:x=!0}break;case "Q":case "q":w=Math.ceil((a.getMonth()+1)/3);x=!0;break;case "M":case "L":w=a.getMonth();3>q?(w+=1,x=!0):(k=["months","L"==k?"standAlone":"format",C[q-3]].join("-"),w=b[k][w]);break;case "w":w=c._getWeekOfYear(a,0);x=!0;break;case "d":w=a.getDate();
x=!0;break;case "D":w=c._getDayOfYear(a);x=!0;break;case "e":case "c":if(w=a.getDay(),2>q){w=(w-v.getFirstDayOfWeek(e.locale)+8)%7;break}case "E":w=a.getDay();3>q?(w+=1,x=!0):(k=["days","c"==k?"standAlone":"format",C[q-3]].join("-"),w=b[k][w]);break;case "a":k=12>a.getHours()?"am":"pm";w=e[k]||b["dayPeriods-format-wide-"+k];break;case "h":case "H":case "K":case "k":x=a.getHours();switch(k){case "h":w=x%12||12;break;case "H":w=x;break;case "K":w=x%12;break;case "k":w=x||24}x=!0;break;case "m":w=a.getMinutes();
x=!0;break;case "s":w=a.getSeconds();x=!0;break;case "S":w=Math.round(a.getMilliseconds()*Math.pow(10,q-3));x=!0;break;case "v":case "z":if(w=c._getZone(a,!0,e))break;q=4;case "Z":k=c._getZone(a,!1,e);k=[0>=k?"+":"-",u.pad(Math.floor(Math.abs(k)/60),2),u.pad(Math.abs(k)%60,2)];4==q&&(k.splice(0,0,"GMT"),k.splice(3,0,":"));w=k.join("");break;default:throw Error("dojo.date.locale.format: invalid pattern char: "+f);}x&&(w=u.pad(w,q));return w})}function b(a,b,c,e){var f=function(a){return a};b=b||f;
c=c||f;e=e||f;var q=a.match(/(''|[^'])+/g),w="'"==a.charAt(0);g.forEach(q,function(a,e){a?(q[e]=(w?c:b)(a.replace(/''/g,"'")),w=!w):q[e]=""});return e(q.join(""))}function a(a,b,c,e){e=m.escapeString(e);c.strict||(e=e.replace(" a"," ?a"));return e.replace(/([a-z])\1*/ig,function(e){var f;f=e.charAt(0);var q=e.length,w="",k="";c.strict?(1<q&&(w="0{"+(q-1)+"}"),2<q&&(k="0{"+(q-2)+"}")):(w="0?",k="0{0,2}");switch(f){case "y":f="\\d{2,4}";break;case "M":case "L":2<q?(f=b["months-"+("L"==f?"standAlone":
"format")+"-"+x[q-3]].slice(0).join("|"),c.strict||(f=f.replace(/\./g,""),f="(?:"+f+")\\.?")):f="1[0-2]|"+w+"[1-9]";break;case "D":f="[12][0-9][0-9]|3[0-5][0-9]|36[0-6]|"+w+"[1-9][0-9]|"+k+"[1-9]";break;case "d":f="3[01]|[12]\\d|"+w+"[1-9]";break;case "w":f="[1-4][0-9]|5[0-3]|"+w+"[1-9]";break;case "E":case "e":case "c":f=".+?";break;case "h":f="1[0-2]|"+w+"[1-9]";break;case "k":f="1[01]|"+w+"\\d";break;case "H":f="1\\d|2[0-3]|"+w+"\\d";break;case "K":f="1\\d|2[0-4]|"+w+"[1-9]";break;case "m":case "s":f=
"[0-5]\\d";break;case "S":f="\\d{"+q+"}";break;case "a":q=c.am||b["dayPeriods-format-wide-am"];w=c.pm||b["dayPeriods-format-wide-pm"];f=q+"|"+w;c.strict||(q!=q.toLowerCase()&&(f+="|"+q.toLowerCase()),w!=w.toLowerCase()&&(f+="|"+w.toLowerCase()),-1!=f.indexOf(".")&&(f+="|"+f.replace(/\./g,"")));f=f.replace(/\./g,"\\.");break;default:f=".*"}a&&a.push(e);return"("+f+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var c={};p.setObject(f.id.replace(/\//g,"."),c);c._getZone=function(a,b,c){return b?t.getTimezoneName(a):
a.getTimezoneOffset()};c.format=function(a,f){f=f||{};var q=n.normalizeLocale(f.locale),w=f.formatLength||"short",q=c._getGregorianBundle(q),x=[];a=p.hitch(this,e,a,q,f);if("year"==f.selector)return b(q["dateFormatItem-yyyy"]||"yyyy",a);var k;"date"!=f.selector&&(k=f.timePattern||q["timeFormat-"+w])&&x.push(b(k,a));"time"!=f.selector&&(k=f.datePattern||q["dateFormat-"+w])&&x.push(b(k,a));return 1==x.length?x[0]:q["dateTimeFormat-"+w].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return x[b]})};
c.regexp=function(a){return c._parseInfo(a).regexp};c._parseInfo=function(e){e=e||{};var f=n.normalizeLocale(e.locale),f=c._getGregorianBundle(f),q=e.formatLength||"short",w=e.datePattern||f["dateFormat-"+q],x=e.timePattern||f["timeFormat-"+q],q="date"==e.selector?w:"time"==e.selector?x:f["dateTimeFormat-"+q].replace(/\{(\d+)\}/g,function(a,b){return[x,w][b]}),k=[];return{regexp:b(q,p.hitch(this,a,k,f,e)),tokens:k,bundle:f}};c.parse=function(a,b){var e=/[\u200E\u200F\u202A\u202E]/g,f=c._parseInfo(b),
q=f.tokens,w=f.bundle;a=(new RegExp("^"+f.regexp.replace(e,"")+"$",f.strict?"":"i")).exec(a&&a.replace(e,""));if(!a)return null;var x=["abbr","wide","narrow"],k=[1970,0,1,0,0,0,0],C="";a=g.every(a,function(a,c){if(!c)return!0;var e=q[c-1];c=e.length;e=e.charAt(0);switch(e){case "y":if(2!=c&&b.strict)k[0]=a;else if(100>a)a=Number(a),e=""+(new Date).getFullYear(),c=100*e.substring(0,2),e=Math.min(Number(e.substring(2,4))+20,99),k[0]=a<e?c+a:c-100+a;else{if(b.strict)return!1;k[0]=a}break;case "M":case "L":if(2<
c){if(c=w["months-"+("L"==e?"standAlone":"format")+"-"+x[c-3]].concat(),b.strict||(a=a.replace(".","").toLowerCase(),c=g.map(c,function(a){return a.replace(".","").toLowerCase()})),a=g.indexOf(c,a),-1==a)return!1}else a--;k[1]=a;break;case "E":case "e":case "c":c=w["days-"+("c"==e?"standAlone":"format")+"-"+x[c-3]].concat();b.strict||(a=a.toLowerCase(),c=g.map(c,function(a){return a.toLowerCase()}));a=g.indexOf(c,a);if(-1==a)return!1;break;case "D":k[1]=0;case "d":k[2]=a;break;case "a":c=b.am||w["dayPeriods-format-wide-am"];
e=b.pm||w["dayPeriods-format-wide-pm"];if(!b.strict){var f=/\./g;a=a.replace(f,"").toLowerCase();c=c.replace(f,"").toLowerCase();e=e.replace(f,"").toLowerCase()}if(b.strict&&a!=c&&a!=e)return!1;C=a==e?"p":a==c?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":if(23<a)return!1;k[3]=a;break;case "m":k[4]=a;break;case "s":k[5]=a;break;case "S":k[6]=a}return!0});e=+k[3];"p"===C&&12>e?k[3]=e+12:"a"===C&&12==e&&(k[3]=0);e=new Date(k[0],k[1],k[2],k[3],k[4],k[5],k[6]);b.strict&&e.setFullYear(k[0]);
var z=q.join(""),f=-1!=z.indexOf("d"),z=-1!=z.indexOf("M");if(!a||z&&e.getMonth()>k[1]||f&&e.getDate()>k[2])return null;if(z&&e.getMonth()<k[1]||f&&e.getDate()<k[2])e=t.add(e,"hour",1);return e};var x=["abbr","wide","narrow"],w=[],q={};c.addCustomFormats=function(a,b){w.push({pkg:a,name:b});q={}};c._getGregorianBundle=function(a){if(q[a])return q[a];var b={};g.forEach(w,function(c){c=n.getLocalization(c.pkg,c.name,a);b=p.mixin(b,c)},this);return q[a]=b};c.addCustomFormats(f.id.replace(/\/date\/locale$/,
".cldr"),"gregorian");c.getNames=function(a,b,e,f){var q;f=c._getGregorianBundle(f);a=[a,e,b];"standAlone"==e&&(e=a.join("-"),q=f[e],1==q[0]&&(q=void 0));a[1]="format";return(q||f[a.join("-")]).concat()};c.isWeekend=function(a,b){b=v.getWeekend(b);a=(a||new Date).getDay();b.end<b.start&&(b.end+=7,a<b.start&&(a+=7));return a>=b.start&&a<=b.end};c._getDayOfYear=function(a){return t.difference(new Date(a.getFullYear(),0,1,a.getHours()),a)+1};c._getWeekOfYear=function(a,b){1==arguments.length&&(b=0);
var e=(new Date(a.getFullYear(),0,1)).getDay(),f=(e-b+7)%7,f=Math.floor((c._getDayOfYear(a)+f-1)/7);e==b&&f++;return f};return c})},"dojo/date":function(){define(["./has","./_base/lang"],function(p,g){var t={getDaysInMonth:function(g){var n=g.getMonth();return 1==n&&t.isLeapYear(g)?29:[31,28,31,30,31,30,31,31,30,31,30,31][n]},isLeapYear:function(g){g=g.getFullYear();return!(g%400)||!(g%4)&&!!(g%100)},getTimezoneName:function(g){var n=g.toString(),m="",u=n.indexOf("(");if(-1<u)m=n.substring(++u,n.indexOf(")"));
else if(u=/([A-Z\/]+) \d{4}$/,n=n.match(u))m=n[1];else if(n=g.toLocaleString(),u=/ ([A-Z\/]+)$/,n=n.match(u))m=n[1];return"AM"==m||"PM"==m?"":m},compare:function(g,n,m){g=new Date(+g);n=new Date(+(n||new Date));"date"==m?(g.setHours(0,0,0,0),n.setHours(0,0,0,0)):"time"==m&&(g.setFullYear(0,0,0),n.setFullYear(0,0,0));return g>n?1:g<n?-1:0},add:function(g,n,m){var u=new Date(+g),k=!1,f="Date";switch(n){case "day":break;case "weekday":var e;(n=m%5)?e=parseInt(m/5):(n=0<m?5:-5,e=0<m?(m-5)/5:(m+5)/5);
var b=g.getDay(),a=0;6==b&&0<m?a=1:0==b&&0>m&&(a=-1);b+=n;if(0==b||6==b)a=0<m?2:-2;m=7*e+n+a;break;case "year":f="FullYear";k=!0;break;case "week":m*=7;break;case "quarter":m*=3;case "month":k=!0;f="Month";break;default:f="UTC"+n.charAt(0).toUpperCase()+n.substring(1)+"s"}if(f)u["set"+f](u["get"+f]()+m);k&&u.getDate()<g.getDate()&&u.setDate(0);return u},difference:function(g,n,m){n=n||new Date;m=m||"day";var u=n.getFullYear()-g.getFullYear(),k=1;switch(m){case "quarter":g=g.getMonth();n=n.getMonth();
k=Math.floor(n/3)+1+4*u-(Math.floor(g/3)+1);break;case "weekday":u=Math.round(t.difference(g,n,"day"));m=parseInt(t.difference(g,n,"week"));if(0==u%7)u=5*m;else{var k=0,f=g.getDay(),e=n.getDay();m=parseInt(u/7);n=u%7;g=new Date(g);g.setDate(g.getDate()+7*m);g=g.getDay();if(0<u)switch(!0){case 6==f:k=-1;break;case 0==f:k=0;break;case 6==e:k=-1;break;case 0==e:k=-2;break;case 5<g+n:k=-2}else if(0>u)switch(!0){case 6==f:k=0;break;case 0==f:k=1;break;case 6==e:k=2;break;case 0==e:k=1;break;case 0>g+n:k=
2}u=u+k-2*m}k=u;break;case "year":k=u;break;case "month":k=n.getMonth()-g.getMonth()+12*u;break;case "week":k=parseInt(t.difference(g,n,"day")/7);break;case "day":k/=24;case "hour":k/=60;case "minute":k/=60;case "second":k/=1E3;case "millisecond":k*=n.getTime()-g.getTime()}return Math.round(k)}};g.mixin(g.getObject("dojo.date",!0),t);return t})},"dojo/cldr/supplemental":function(){define(["../_base/lang","../i18n"],function(p,g){var t={};p.setObject("dojo.cldr.supplemental",t);t.getFirstDayOfWeek=
function(g){g={bd:5,mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,iq:6,ir:6,jo:6,kw:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,sy:6,ye:6,ag:0,ar:0,as:0,au:0,br:0,bs:0,bt:0,bw:0,by:0,bz:0,ca:0,cn:0,co:0,dm:0,"do":0,et:0,gt:0,gu:0,hk:0,hn:0,id:0,ie:0,il:0,"in":0,jm:0,jp:0,ke:0,kh:0,kr:0,la:0,mh:0,mm:0,mo:0,mt:0,mx:0,mz:0,ni:0,np:0,nz:0,pa:0,pe:0,ph:0,pk:0,pr:0,py:0,sg:0,sv:0,th:0,tn:0,tt:0,tw:0,um:0,us:0,ve:0,vi:0,ws:0,za:0,zw:0}[t._region(g)];return void 0===g?1:g};t._region=function(p){p=g.normalizeLocale(p);p=p.split("-");
var n=p[1];n?4==n.length&&(n=p[2]):n={aa:"et",ab:"ge",af:"za",ak:"gh",am:"et",ar:"eg",as:"in",av:"ru",ay:"bo",az:"az",ba:"ru",be:"by",bg:"bg",bi:"vu",bm:"ml",bn:"bd",bo:"cn",br:"fr",bs:"ba",ca:"es",ce:"ru",ch:"gu",co:"fr",cr:"ca",cs:"cz",cv:"ru",cy:"gb",da:"dk",de:"de",dv:"mv",dz:"bt",ee:"gh",el:"gr",en:"us",es:"es",et:"ee",eu:"es",fa:"ir",ff:"sn",fi:"fi",fj:"fj",fo:"fo",fr:"fr",fy:"nl",ga:"ie",gd:"gb",gl:"es",gn:"py",gu:"in",gv:"gb",ha:"ng",he:"il",hi:"in",ho:"pg",hr:"hr",ht:"ht",hu:"hu",hy:"am",
ia:"fr",id:"id",ig:"ng",ii:"cn",ik:"us","in":"id",is:"is",it:"it",iu:"ca",iw:"il",ja:"jp",ji:"ua",jv:"id",jw:"id",ka:"ge",kg:"cd",ki:"ke",kj:"na",kk:"kz",kl:"gl",km:"kh",kn:"in",ko:"kr",ks:"in",ku:"tr",kv:"ru",kw:"gb",ky:"kg",la:"va",lb:"lu",lg:"ug",li:"nl",ln:"cd",lo:"la",lt:"lt",lu:"cd",lv:"lv",mg:"mg",mh:"mh",mi:"nz",mk:"mk",ml:"in",mn:"mn",mo:"ro",mr:"in",ms:"my",mt:"mt",my:"mm",na:"nr",nb:"no",nd:"zw",ne:"np",ng:"na",nl:"nl",nn:"no",no:"no",nr:"za",nv:"us",ny:"mw",oc:"fr",om:"et",or:"in",os:"ge",
pa:"in",pl:"pl",ps:"af",pt:"br",qu:"pe",rm:"ch",rn:"bi",ro:"ro",ru:"ru",rw:"rw",sa:"in",sd:"in",se:"no",sg:"cf",si:"lk",sk:"sk",sl:"si",sm:"ws",sn:"zw",so:"so",sq:"al",sr:"rs",ss:"za",st:"za",su:"id",sv:"se",sw:"tz",ta:"in",te:"in",tg:"tj",th:"th",ti:"et",tk:"tm",tl:"ph",tn:"za",to:"to",tr:"tr",ts:"za",tt:"ru",ty:"pf",ug:"cn",uk:"ua",ur:"pk",uz:"uz",ve:"za",vi:"vn",wa:"be",wo:"sn",xh:"za",yi:"il",yo:"ng",za:"cn",zh:"cn",zu:"za",ace:"id",ady:"ru",agq:"cm",alt:"ru",amo:"ng",asa:"tz",ast:"es",awa:"in",
bal:"pk",ban:"id",bas:"cm",bax:"cm",bbc:"id",bem:"zm",bez:"tz",bfq:"in",bft:"pk",bfy:"in",bhb:"in",bho:"in",bik:"ph",bin:"ng",bjj:"in",bku:"ph",bqv:"ci",bra:"in",brx:"in",bss:"cm",btv:"pk",bua:"ru",buc:"yt",bug:"id",bya:"id",byn:"er",cch:"ng",ccp:"in",ceb:"ph",cgg:"ug",chk:"fm",chm:"ru",chp:"ca",chr:"us",cja:"kh",cjm:"vn",ckb:"iq",crk:"ca",csb:"pl",dar:"ru",dav:"ke",den:"ca",dgr:"ca",dje:"ne",doi:"in",dsb:"de",dua:"cm",dyo:"sn",dyu:"bf",ebu:"ke",efi:"ng",ewo:"cm",fan:"gq",fil:"ph",fon:"bj",fur:"it",
gaa:"gh",gag:"md",gbm:"in",gcr:"gf",gez:"et",gil:"ki",gon:"in",gor:"id",grt:"in",gsw:"ch",guz:"ke",gwi:"ca",haw:"us",hil:"ph",hne:"in",hnn:"ph",hoc:"in",hoj:"in",ibb:"ng",ilo:"ph",inh:"ru",jgo:"cm",jmc:"tz",kaa:"uz",kab:"dz",kaj:"ng",kam:"ke",kbd:"ru",kcg:"ng",kde:"tz",kdt:"th",kea:"cv",ken:"cm",kfo:"ci",kfr:"in",kha:"in",khb:"cn",khq:"ml",kht:"in",kkj:"cm",kln:"ke",kmb:"ao",koi:"ru",kok:"in",kos:"fm",kpe:"lr",krc:"ru",kri:"sl",krl:"ru",kru:"in",ksb:"tz",ksf:"cm",ksh:"de",kum:"ru",lag:"tz",lah:"pk",
lbe:"ru",lcp:"cn",lep:"in",lez:"ru",lif:"np",lis:"cn",lki:"ir",lmn:"in",lol:"cd",lua:"cd",luo:"ke",luy:"ke",lwl:"th",mad:"id",mag:"in",mai:"in",mak:"id",man:"gn",mas:"ke",mdf:"ru",mdh:"ph",mdr:"id",men:"sl",mer:"ke",mfe:"mu",mgh:"mz",mgo:"cm",min:"id",mni:"in",mnk:"gm",mnw:"mm",mos:"bf",mua:"cm",mwr:"in",myv:"ru",nap:"it",naq:"na",nds:"de","new":"np",niu:"nu",nmg:"cm",nnh:"cm",nod:"th",nso:"za",nus:"sd",nym:"tz",nyn:"ug",pag:"ph",pam:"ph",pap:"bq",pau:"pw",pon:"fm",prd:"ir",raj:"in",rcf:"re",rej:"id",
rjs:"np",rkt:"in",rof:"tz",rwk:"tz",saf:"gh",sah:"ru",saq:"ke",sas:"id",sat:"in",saz:"in",sbp:"tz",scn:"it",sco:"gb",sdh:"ir",seh:"mz",ses:"ml",shi:"ma",shn:"mm",sid:"et",sma:"se",smj:"se",smn:"fi",sms:"fi",snk:"ml",srn:"sr",srr:"sn",ssy:"er",suk:"tz",sus:"gn",swb:"yt",swc:"cd",syl:"bd",syr:"sy",tbw:"ph",tcy:"in",tdd:"cn",tem:"sl",teo:"ug",tet:"tl",tig:"er",tiv:"ng",tkl:"tk",tmh:"ne",tpi:"pg",trv:"tw",tsg:"ph",tts:"th",tum:"mw",tvl:"tv",twq:"ne",tyv:"ru",tzm:"ma",udm:"ru",uli:"fm",umb:"ao",unr:"in",
unx:"in",vai:"lr",vun:"tz",wae:"ch",wal:"et",war:"ph",xog:"ug",xsr:"np",yao:"mz",yap:"fm",yav:"cm",zza:"tr"}[p[0]];return n};t.getWeekend=function(g){var n=t._region(g);g={"in":0,af:4,dz:4,ir:4,om:4,sa:4,ye:4,ae:5,bh:5,eg:5,il:5,iq:5,jo:5,kw:5,ly:5,ma:5,qa:5,sd:5,sy:5,tn:5}[n];n={af:5,dz:5,ir:5,om:5,sa:5,ye:5,ae:6,bh:5,eg:6,il:6,iq:6,jo:6,kw:6,ly:6,ma:6,qa:6,sd:6,sy:6,tn:6}[n];void 0===g&&(g=6);void 0===n&&(n=0);return{start:g,end:n}};return t})},"dojox/encoding/base64":function(){define(["dojo/_base/lang"],
function(p){p=p.getObject("dojox.encoding.base64",!0);p.encode=function(g){for(var p=[],v=g.length,n=v%3,v=v-n,m=0;m<v;){var u=g[m++]<<16|g[m++]<<8|g[m++];p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>18&63));p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>12&63));p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>6&63));p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u&
63))}switch(n){case 2:u=g[m++]<<16|g[m++]<<8;p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>18&63));p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>12&63));p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>6&63));p.push("\x3d");break;case 1:u=g[m++]<<16,p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>18&63)),p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(u>>>
12&63)),p.push("\x3d"),p.push("\x3d")}return p.join("")};p.decode=function(g){g=g.split("");for(var p=[],v=g.length;"\x3d"==g[--v];);for(var n=0;n<v;){var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(g[n++])<<18;n<=v&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(g[n++])<<12);n<=v&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(g[n++])<<6);n<=v&&(m|="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(g[n++]));
p.push(m>>>16&255);p.push(m>>>8&255);p.push(m&255)}for(;0==p[p.length-1];)p.pop();return p};return p})},"esri/lang":function(){define("dojo/_base/array dojo/_base/json dojo/_base/kernel dojo/_base/lang dojo/date dojo/has dojo/number dojo/date/locale ./kernel".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a,b,c,e){(b=b&&b[a])?b={formatType:b.formatType,options:b}:e&&-1!==p.indexOf(e.properties||"",a)?b={formatType:e.formatter||"DateString",options:null}:c&&-1!==p.indexOf(c.properties||"",a)&&(b=
{formatType:c.formatter||"NumberFormat",options:null});return b}function b(a){return void 0!==a&&null!==a}function a(a){return b(a)?a:""}function c(c,e,f,q){var x=f.match(/([^\(]+)(\([^\)]+\))?/i);f=v.trim(x[1]);var m=x[2]?v.trim(x[2]):null,x=e[c];q=q||(m?g.fromJson(m.replace(/^\(/,"({").replace(/\)$/,"})")):{});m=q.utcOffset;if(-1===p.indexOf(w,f))f=v.getObject(f),v.isFunction(f)&&(x=f(x,c,e,q));else if("number"===typeof x||"string"===typeof x&&x&&!isNaN(Number(x)))switch(x=Number(x),f){case "NumberFormat":return u.format(x,
q);case "DateString":c=new Date(x);if(q.local||q.systemLocale)return q.systemLocale?c.toLocaleDateString()+(q.hideTime?"":" "+c.toLocaleTimeString()):c.toDateString()+(q.hideTime?"":" "+c.toTimeString());c=c.toUTCString();q.hideTime&&(c=c.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,""));return c;case "DateFormat":return c=new Date(x),b(m)&&(c=n.add(c,"minute",c.getTimezoneOffset()-m)),k.format(c,q)}return a(x)}function x(a,b){var c;if(b)for(c in a)a.hasOwnProperty(c)&&(void 0===a[c]?delete a[c]:a[c]instanceof
Object&&x(a[c],!0));else for(c in a)a.hasOwnProperty(c)&&void 0===a[c]&&delete a[c];return a}var w=["NumberFormat","DateString","DateFormat"],q=/<\/?[^>]+>/g;return{valueOf:function(a,b){for(var c in a)if(a[c]==b)return c;return null},stripTags:function(a){if(a){var b=typeof a;if("string"===b)a=a.replace(q,"");else if("object"===b)for(var c in a)(b=a[c])&&"string"===typeof b&&(b=b.replace(q,"")),a[c]=b}return a},substitute:function(f,q,w){var x,k,m,z;b(w)&&(v.isObject(w)?(x=w.first,k=w.dateFormat,
m=w.numberFormat,z=w.format):x=w);if(q&&"${*}"!==q)return v.replace(q,v.hitch({obj:f},function(b,f){var q=f.split(":");return 1<q.length?(f=q[0],q.shift(),(b=z&&z[q[0]])?q=b.formatType:(q=q.join(":"),b=null),c(f,this.obj,q,b)):(b=e(f,z,m,k))?c(f,this.obj,b.formatType,b.options):a(this.obj[f])}),/\$\{([^\}]+)\}/g);q=[];for(var C in f)if(w=(w=e(C,z,m,k))?c(C,f,w.formatType,w.options):f[C],q.push(C+" \x3d "+a(w)+"\x3cbr/\x3e"),x)break;return q.join("")},filter:function(a,b,c){b=[v.isString(a)?a.split(""):
a,c||t.global,v.isString(b)?new Function("item","index","array",b):b];c={};var e;a=b[0];for(e in a)b[2].call(b[e],a[e],e,a)&&(c[e]=a[e]);return c},startsWith:function(a,b,c){c=c||0;return a.indexOf(b,c)===c},endsWith:function(a,b,c){if("number"!==typeof c||!isFinite(c)||Math.floor(c)!==c||c>a.length)c=a.length;c-=b.length;a=a.indexOf(b,c);return-1!==a&&a===c},isDefined:b,fixJson:x,isObject:function(a){return a&&"object"===typeof a},isString:function(a){return"string"===typeof a},mixin:function(a,
b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},clone2DArray:function(a){if(a=a?a.slice(0):null){var b,c=a.length;for(b=0;b<c;b++)a[b]=a[b]?a[b].slice(0):null}return a},clone3DArray:function(a){if(a=a?a.slice(0):null){var b,c=a.length;for(b=0;b<c;b++){a[b]=a[b]?a[b].slice(0):null;var e=a[b];if(e){var f,q=e.length;for(f=0;f<q;f++)e[f]=e[f]?e[f].slice(0):null}}}return a}}})},"esri/kernel":function(){define(["dojo/_base/kernel","dojo/_base/config","dojo/has"],function(p,g,t){p=function(){return this}();
var v=p.location,n=v.pathname;t=v.protocol;v={version:"3.28",_appBaseUrl:t+"//"+v.host+n.substring(0,n.lastIndexOf(n.split("/")[n.split("/").length-1]))};g.noGlobals||(p.esri=v);(v.dijit=v.dijit||{})._arcgisUrl=("http:"===t||"https:"===t?t:"http:")+"//www.arcgis.com/sharing/rest";return v})},"esri/arcgis/utils":function(){define("require dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/on dojo/DeferredList dojo/dom-construct dojo/sniff dojox/gfx/_base ../kernel ../config ../Color ../lang ../request ../SpatialReference ../map ../urlUtils ../geometry/ScreenPoint ../geometry/Extent ../geometry/webMercatorUtils ../symbols/jsonUtils ../renderers/jsonUtils ../dijit/PopupTemplate ../dijit/Popup ../tasks/query ../tasks/GeometryService ../layers/ArcGISTiledMapServiceLayer ../layers/FeatureLayer dojo/i18n!../nls/jsapi".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O){function W(d){return C({url:R.arcgisUrl+"/"+d.itemId+"/data",content:{f:"json"},callbackParamName:"callback"},{disableIdentityLookup:!0,_preLookup:!0})}function U(d,h){var l={f:"json"};h&&(l.token=h);return C({url:d,content:l,callbackParamName:"callback"},{disableIdentityLookup:!0})}function V(d){!d.layerDefinition||d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.labelingInfo||(d.showLabels=!1);d.itemProperties.layerDefinition&&
(d.layerDefinition?(d.layerDefinition.drawingInfo||(d.layerDefinition.drawingInfo=d.itemProperties.layerDefinition.drawingInfo),q.isDefined(d.layerDefinition.definitionExpression)||(d.layerDefinition.definitionExpression=d.itemProperties.layerDefinition.definitionExpression),q.isDefined(d.layerDefinition.minScale)||(d.layerDefinition.minScale=d.itemProperties.layerDefinition.minScale),q.isDefined(d.layerDefinition.maxScale)||(d.layerDefinition.maxScale=d.itemProperties.layerDefinition.maxScale)):
d.layerDefinition=d.itemProperties.layerDefinition);!d.itemProperties.popupInfo||d.popupInfo||d.disablePopup||(d.popupInfo=d.itemProperties.popupInfo);q.isDefined(d.itemProperties.showLabels)&&!q.isDefined(d.showLabels)&&(d.showLabels=d.itemProperties.showLabels);q.isDefined(d.itemProperties.showLegend)&&!q.isDefined(d.showLegend)&&(d.showLegend=d.itemProperties.showLegend);q.isDefined(d.itemProperties.refreshInterval)&&!q.isDefined(d.refreshInterval)&&(d.refreshInterval=d.itemProperties.refreshInterval)}
function A(d){V(d);d.itemProperties.layerDefinition&&d.layerDefinition&&(!q.isDefined(d.layerDefinition.maximumTrackPoints)&&q.isDefined(d.itemProperties.layerDefinition.maximumTrackPoints)&&(d.layerDefinition.maximumTrackPoints=d.itemProperties.layerDefinition.maximumTrackPoints),!d.layerDefinition.definitionGeometry&&d.itemProperties.layerDefinition.definitionGeometry&&(d.layerDefinition.definitionGeometry=d.itemProperties.layerDefinition.definitionGeometry));d.itemProperties.purgeOptions&&!d.purgeOptions&&
(d.purgeOptions=d.itemProperties.purgeOptions)}function X(d,h){var l=new n;h=d.itemData;var r=[],y=[];t.forEach(h.operationalLayers,function(d){if(d.itemId&&!d.type){var h=d.url.toLowerCase();-1<h.indexOf("/featureserver")||-1<h.indexOf("/mapserver/")?(y.push(d),r.push(W(d))):-1<h.indexOf("/mapserver")&&-1===h.indexOf("/mapserver/")&&(!d.layers||!q.isDefined(d.minScale)&&!q.isDefined(d.maxScale))?(y.push(d),r.push(W(d))):-1<h.indexOf("/imageserver")&&!q.isDefined(d.minScale)&&!q.isDefined(d.maxScale)?
(y.push(d),r.push(W(d))):-1<h.indexOf("/streamserver")&&(y.push(d),r.push(W(d)))}});h.baseMap&&h.baseMap.baseMapLayers&&t.forEach(h.baseMap.baseMapLayers,function(d){d.itemId&&"VectorTileLayer"!==d.layerType&&(y.push(d),r.push(W(d)))});if(0<r.length){var a={};(new f(r)).addCallback(function(h){t.forEach(y,function(d,l){if((l=h[l][1])&&!(l instanceof Error)&&(a[d.itemId]=l,!d.type)){var r=d.url.toLowerCase();(-1<r.indexOf("/featureserver")||-1<r.indexOf("/mapserver/"))&&l.layers?t.forEach(l.layers,
function(h){var l="/featureserver/"+h.id;(l=r.match(l+"$")==l)||(l="/mapserver/"+h.id,l=r.match(l+"$")==l);l&&(d.itemProperties=h,V(d))}):-1<r.indexOf("/streamserver")?(d.itemProperties=l,A(d)):-1<r.indexOf("/mapserver")?(l.layers&&!d.layers&&(d.layers=l.layers),q.isDefined(l.minScale)&&!q.isDefined(d.minScale)&&(d.minScale=l.minScale),q.isDefined(l.maxScale)&&!q.isDefined(d.maxScale)&&(d.maxScale=l.maxScale),q.isDefined(l.refreshInterval)&&!q.isDefined(d.refreshInterval)&&(d.refreshInterval=l.refreshInterval),
l.visibleLayers&&!d.visibleLayers&&(d.visibleLayers=l.visibleLayers)):-1<r.indexOf("/imageserver")&&(q.isDefined(l.minScale)&&!q.isDefined(d.minScale)&&(d.minScale=l.minScale),q.isDefined(l.maxScale)&&!q.isDefined(d.maxScale)&&(d.maxScale=l.maxScale),q.isDefined(l.refreshInterval)&&!q.isDefined(d.refreshInterval)&&(d.refreshInterval=l.refreshInterval),!l.popupInfo||d.popupInfo||d.disablePopup||(d.popupInfo=l.popupInfo),l.renderingRule&&!d.renderingRule&&(d.renderingRule=l.renderingRule,l.renderingRule.functionName&&
(d.renderingRule.rasterFunction=l.renderingRule.functionName)),l.bandIds&&!d.bandIds&&(d.bandIds=l.bandIds),l.mosaicRule&&!d.mosaicRule&&(d.mosaicRule=l.mosaicRule),l.format&&!d.format&&(d.format=l.format),q.isDefined(l.compressionQuality)&&!q.isDefined(d.compressionQuality)&&(d.compressionQuality=l.compressionQuality),!l.layerDefinition||!l.layerDefinition.definitionExpression||q.isDefined(d.layerDefinition)&&q.isDefined(d.layerDefinition.definitionExpression)||(d.layerDefinition=d.layerDefinition||
{},d.layerDefinition.definitionExpression=l.layerDefinition.definitionExpression))}});d.relatedItemsData=a;l.callback(d)})}else l.callback(d);return l}function aa(l,y){var a=new n,H=l.itemData,b=H.baseMap.baseMapLayers[0];if("BingMapsAerial"===b.type||"BingMapsRoad"===b.type||"BingMapsHybrid"===b.type)if(b.portalUrl&&c.id)delete y.bingMapsKey,c.id.checkSignInStatus(B.urlToObject(R.arcgisUrl).path).then(g.hitch(null,function(l,r,y,a,H){U(b.portalUrl,H.token).then(g.hitch(null,d,l,r,y,a),g.hitch(null,
h,l,r,y,a))},l,y,H,a),g.hitch(null,function(l,r,y,a,H){U(b.portalUrl).then(g.hitch(null,d,l,r,y,a),g.hitch(null,h,l,r,y,a))},l,y,H,a));else if(y.bingMapsKey){var A=new Ra({bingMapsKey:y.bingMapsKey,mapStyle:Ra.MAP_STYLE_AERIAL});v.connect(A,"onLoad",g.hitch(this,function(){a.callback([l,y])}));v.connect(A,"onError",function(d){delete y.bingMapsKey;l.itemData=r(H);b=l.itemData.baseMap.baseMapLayers[0];b.errors=[];b.errors.push({message:"The owner of the application has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});
a.callback([l,y])})}else l.itemData=r(H),b=l.itemData.baseMap.baseMapLayers[0],b.errors=[],b.errors.push({message:"The owner of the application has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."}),a.callback([l,y]);else a.callback([l,y]);return a}function l(d){var h=new n,l,r;d=d.itemData;var y=d.baseMap&&d.baseMap.baseMapLayers;if(lb&&!lb.supported())for(d=0;d<y.length;d++){var a=y[d];if(!a.isReference){"VectorTileLayer"===a.layerType&&(l=a.itemId,r=d);break}}l?
sa(l,!1).addBoth(function(d){var l=/^https?:\/\/basemaps(dev)?\.arcgis\.com\/arcgis\/rest\/services\/World_Basemap\/VectorTileServer/i;d&&d.item&&l.test(d.item.url)&&(y[r]={id:"FB_"+a.id,layerType:"ArcGISTiledMapServiceLayer",opacity:"opacity"in a?a.opacity:1,visibility:"visibility"in a?a.visibility:!0,url:"https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer"});h.resolve()}):h.resolve();return h}function d(d,l,y,a,H){H.bingKey?(l.bingMapsKey=H.bingKey,H=new Ra({bingMapsKey:l.bingMapsKey,
mapStyle:Ra.MAP_STYLE_AERIAL}),v.connect(H,"onLoad",g.hitch(this,function(){a.callback([d,l])})),v.connect(H,"onError",function(h){delete l.bingMapsKey;d.itemData=r(y);h=d.itemData.baseMap.baseMapLayers[0];h.errors=[];h.errors.push({message:"The owner of the map has not provided a valid Bing Key for the Bing Map it includes. Switching to Esri layers."});a.callback([d,l])})):h(d,l,y,a)}function h(d,h,l,y){delete h.bingMapsKey;d.itemData=r(l);l=d.itemData.baseMap.baseMapLayers[0];l.errors=[];l.errors.push({message:"The owner of the map has not provided a Bing Key for the Bing Map it includes. Switching to Esri layers."});
y.callback([d,h])}function r(d){d.baseMap="BingMapsAerial"===d.baseMap.baseMapLayers[0].type?{title:"Imagery",baseMapLayers:[{id:"World_Imagery_2017",visibility:!0,opacity:1,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]}:"BingMapsRoad"===d.baseMap.baseMapLayers[0].type?{title:"Streets",baseMapLayers:[{id:"World_Street_Map_8421",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]}:{title:"Imagery with Labels",
baseMapLayers:[{id:"World_Imagery_6611",opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{id:"World_Boundaries_and_Places_1145",isReference:!0,opacity:1,visibility:!0,url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer"}]};return d}function y(d,h,l,r){var y=d.dynamicLayerInfos||d.layerInfos,a=h.layers;if(a&&y)if(r.usePopupManager){var H;t.forEach(y,function(d){var h=d.id;if(!d.subLayerIds)for(d=
0;d<a.length;d++){var r=a[d];if(r.id===h&&r.popupInfo){H||(H={});H[h]={infoTemplate:new l(r.popupInfo),layerUrl:r.layerUrl};break}}});H&&d.setInfoTemplates(H)}else{var b=[],A=[],c=[],e=[],f=[],w=[];t.forEach(y,function(h){var l=h.id;if(!h.subLayerIds&&-1!==t.indexOf(d.visibleLayers,l))for(h=0;h<a.length;h++){var r=a[h];if(r.id===l){A.push(l);b.push(r.popupInfo);c.push(r.layerUrl||"");r.layerDefinition&&r.layerDefinition.definitionExpression?e.push(r.layerDefinition.definitionExpression):e.push("");
f.push(q.isDefined(r.minScale)?r.minScale:null);w.push(q.isDefined(r.maxScale)?r.maxScale:null);break}}});b.length&&(d.__popups=b,d.__popupIds=A,d.__popupUrls=c,d.__popupWhereClauses=e,d.__popupMinScales=f,d.__popupMaxScales=w,d.__resourceInfo=h.resourceInfo)}}function H(d){if(!d)return!1;var h=(new u(R.arcgisUrl)).authority;return-1!==d.indexOf(".arcgis.com/")||-1!==d.indexOf(h)}function P(d){return d?-1!==d.indexOf("/services.arcgisonline.com/")||-1!==d.indexOf("/server.arcgisonline.com/"):!1}function ba(d){"https:"===
location.protocol&&(H(d)||P(d))&&(d=d.replace("http:","https:"));return d}function ea(d,h,l){var r=[],a;d.displayLevels||(r=t.map(d.resourceInfo.tileInfo.lods,function(d){return d.level}));d.exclusionAreas&&(a=g.clone(d.exclusionAreas),a=t.map(a,function(d){d.geometry=new F(d.geometry);return d}));r=new S(ba(d.url),{resourceInfo:d.resourceInfo,opacity:d.opacity,visible:d.visibility,displayLevels:d.displayLevels||r,id:d.id,minScale:d.minScale,maxScale:d.maxScale,refreshInterval:d.refreshInterval,exclusionAreas:a});
l.ignorePopups||y(r,d,h,l);return r}function va(d,h){if(!d||!h||0===h.length)return[];h=","+h+",";var l=[],r,y=",";for(r=0;r<d.length;r++)if(null!==d[r].subLayerIds){if(-1===h.indexOf(","+d[r].id+",")||-1<y.indexOf(","+d[r].id+","))y+=d[r].subLayerIds.toString()+","}else-1<h.indexOf(","+d[r].id+",")&&-1===y.indexOf(","+d[r].id+",")&&l.push(d[r].id);return l}function N(d,h,l){var r=new sb;r.format="png24";d.resourceInfo&&d.resourceInfo.supportedImageFormatTypes&&-1<d.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")&&
(r.format="png32");var r=new ka(ba(d.url),{resourceInfo:d.resourceInfo,opacity:d.opacity,visible:d.visibility,id:d.id,imageParameters:r,minScale:d.minScale,maxScale:d.maxScale,refreshInterval:d.refreshInterval}),a=d.visibleLayers;if(!d.visibleLayers){var H="";t.forEach(r.layerInfos,function(d){d.defaultVisibility&&(H+=(0<H.length?",":"")+d.id)});a=H}if(d.layers&&0<d.layers.length){var b=[],A=[],c,e=[],f,q;t.forEach(d.layers,function(h){var l=h.layerDefinition;l&&l.definitionExpression&&(b[h.id]=l.definitionExpression);
if(l&&l.source){c=null;q=l.source;if("mapLayer"===q.type){var r=t.filter(d.resourceInfo.layers,function(d){return d.id===q.mapLayerId});r.length&&(c=g.mixin(r[0],h))}else c=g.mixin({},h);c&&(c.source=q,delete c.popupInfo,c=new ha(c),d.visibleLayers&&(r="string"==typeof d.visibleLayers?d.visibleLayers.split(","):d.visibleLayers,-1<t.indexOf(r,h.id)?c.defaultVisibility=!0:c.defaultVisibility=!1),A.push(c))}l&&null!=l.transparency&&(r=l.drawingInfo||{},null==r.transparency&&(r.transparency=l.transparency,
l.drawingInfo=r));l&&l.source&&l.drawingInfo&&(f=new Ya(l.drawingInfo),e[h.id]=f)},this);0<b.length&&r.setLayerDefinitions(b);0<A.length?(r.setDynamicLayerInfos(A,!0),0<e.length&&r.setLayerDrawingOptions(e,!0)):(a=va(r.layerInfos,a),r.setVisibleLayers(a))}else a=va(r.layerInfos,a),r.setVisibleLayers(a);l.ignorePopups||y(r,d,h,l);return r}function Ca(d,h,l){var r=new Sa;r.bandIds=d.bandIds;null!=d.format&&(r.format=d.format,null!=d.compressionQuality&&(r.compressionQuality=d.compressionQuality));if(d.renderingRule&&
d.renderingRule.rasterFunction){var y=new tb(d.renderingRule);r.renderingRule=y}d.mosaicRule&&(y=new ub(d.mosaicRule),r.mosaicRule=y);q.isDefined(d.noData)&&(r.noData=d.noData);q.isDefined(d.noDataInterpretation)&&(r.noDataInterpretation=d.noDataInterpretation);q.isDefined(d.interpolation)&&(r.interpolation=d.interpolation);y=d.layerType?"ArcGISImageServiceVectorLayer"===d.layerType:!1;q.isDefined(d.layerType)||(y=d.resourceInfo.hasMultidimensions&&("esriImageServiceDataTypeVector-UV"===d.resourceInfo.serviceDataType||
"esriImageServiceDataTypeVector-MagDir"===d.resourceInfo.serviceDataType));r={resourceInfo:d.resourceInfo,opacity:d.opacity,visible:d.visibility,id:d.id,imageServiceParameters:r,minScale:d.minScale,maxScale:d.maxScale,refreshInterval:d.refreshInterval};r=y?new qa(ba(d.url),r):new ia(ba(d.url),r);d.layerDefinition&&(d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.renderer&&(y=K.fromJson(d.layerDefinition.drawingInfo.renderer),r.setRenderer(y)),d.layerDefinition.definitionExpression&&r.setDefinitionExpression(d.layerDefinition.definitionExpression,
!0));!l.ignorePopups&&d.popupInfo&&r.setInfoTemplate(new h(d.popupInfo));return r}function ma(d,h,l){var r=[102113,102100,3857],y=l||new z(h[0].layerObject.fullExtent.spatialReference),a=new z(d.resourceInfo.fullExtent.spatialReference);return y.wkt==a.wkt&&(y.wkid==a.wkid||q.isDefined(y.latestWkid)&&y.latestWkid==a.wkid||q.isDefined(a.latestWkid)&&y.wkid==a.latestWkid||q.isDefined(y.latestWkid)&&y.latestWkid==a.latestWkid)||y.wkid&&a.wkid&&t.some(r,function(d){return d===a.wkid})&&t.some(r,function(d){return d===
y.wkid})?!0:!1}function wa(d,h,l){if(!h[0].layerObject.tileInfo)return!1;d=d.resourceInfo.tileInfo;h=h[0].layerObject.tileInfo;l=l.width>l.height?l.width:l.height;for(var r=!1,y=!1,a=0;a<d.lods.length;a++){for(var H=d.lods[a].scale/d.dpi,b=0;b<h.lods.length;b++){var A=h.lods[b].scale/h.dpi;if(Math.abs(A-H)/A<1/l)if(r){y=!0;break}else r=!0}if(y)break}return y||r&&(1===d.lods.length||1===h.lods.length)?!0:!1}function xa(d,h,l,r,y,H){var b,A,e=l._clazz;if("OpenStreetMap"===d.type)b=new pb({id:d.id,opacity:d.opacity,
visible:null!==d.visibility&&void 0!==d.visibility?d.visibility:!0});else if("WFS"===d.type)r={customParameters:d.wfsInfo.customParameters,geometryType:d.layerDefinition.geometryType,id:d.id,labelingInfo:d.layerDefinition.drawingInfo.labelingInfo,maxFeatures:d.wfsInfo.maxFeatures,mode:d.mode,name:d.wfsInfo.name,showLabels:!0,swapXY:d.wfsInfo.swapXY,title:d.title,url:d.url,version:d.wfsInfo.version,visible:d.visibility,wkid:d.layerDefinition.spatialReference.wkid},b=new mb,b.fromJson(r,function(){q.isDefined(d.opacity)&&
b.setOpacity(d.opacity);q.isDefined(d.visibility)&&b.setVisibility(d.visibility);(d.minScale||d.maxScale)&&b.setScaleRange(d.minScale,d.maxScale);b.renderer=K.fromJson(d.layerDefinition.drawingInfo.renderer);!l.ignorePopups&&d.popupInfo&&b.setInfoTemplate(new e(d.popupInfo));b.emit("fromJsonComplete")});else if("WMS"===d.type){var f=[],w=[];t.forEach(d.layers,function(d){w.push(new qb({name:d.name,title:d.title,legendURL:d.legendURL,queryable:d.queryable,showPopup:d.showPopup}));f.push(d.name)},this);
d.visibleLayers&&(f=d.visibleLayers);r=new F(d.extent[0][0],d.extent[0][1],d.extent[1][0],d.extent[1][1],new z({wkid:4326}));r={customLayerParameters:d.customLayerParameters,customParameters:d.customParameters,extent:r,layerInfos:w,version:d.version,maxWidth:d.maxWidth,maxHeight:d.maxHeight,featureInfoFormat:d.featureInfoFormat,getFeatureInfoURL:d.featureInfoUrl,getMapURL:d.mapUrl,spatialReferences:d.spatialReferences,title:d.title,copyright:d.copyright,minScale:d.minScale||0,maxScale:d.maxScale||
0,format:d.format};b=new vb(d.url,{id:d.id,visibleLayers:f,format:"png",transparent:d.firstLayer?!1:!0,opacity:d.opacity,visible:null!==d.visibility?d.visibility:!0,resourceInfo:r,refreshInterval:d.refreshInterval});b.spatialReference.wkid=r.spatialReferences[0]}else if("KML"===d.type){A=d.url;if(c.id){var x=c.id.findCredential(B.urlToObject(R.arcgisUrl).path);x&&(h=R.arcgisUrl.substring(R.arcgisUrl.indexOf("//")+2,R.arcgisUrl.indexOf("/",R.arcgisUrl.indexOf("//")+3)),y=h.split("."),y=y[y.length-
2]+"."+y[y.length-1],H=A.indexOf(y),-1<H&&(A="https://"+h+A.substring(H+y.length),A+="?token\x3d"+x.token))}b=new Za(A,{id:d.id,visible:null!==d.visibility?d.visibility:!0,outSR:r,refreshInterval:d.refreshInterval});v.connect(b,"onLoad",function(){(d.opacity||0===d.opacity)&&b.setOpacity(d.opacity);q.isDefined(d.minScale)&&q.isDefined(d.maxScale)&&b.setScaleRange(d.minScale,d.maxScale);d.visibleFolders&&t.forEach(b.folders,function(h){-1<t.indexOf(d.visibleFolders,h.id)?b.setFolderVisibility(h,!0):
b.setFolderVisibility(h,!1)},this)})}else if("WebTiledLayer"===d.type){if(b=new wb(d.templateUrl,{id:d.id,visible:null!==d.visibility?d.visibility:!0,opacity:d.opacity,copyright:d.copyright,fullExtent:d.fullExtent&&new F(d.fullExtent),initialExtent:d.fullExtent&&new F(d.fullExtent),subDomains:d.subDomains,tileInfo:d.tileInfo?new bb(d.tileInfo):null,refreshInterval:d.refreshInterval,wmtsInfo:d.wmtsInfo}),q.isDefined(d.minScale)||q.isDefined(d.maxScale))b.loaded?b.setScaleRange(d.minScale,d.maxScale):
v.connect(b,"onLoad",function(){b.setScaleRange(d.minScale,d.maxScale)})}else if("GeoRSS"===d.type)b=new Y(d.url,{id:d.id,opacity:d.opacity,outSpatialReference:r,refreshInterval:d.refreshInterval}),v.connect(b,"onLoad",function(){!1===d.visibility&&b.hide();q.isDefined(d.minScale)&&q.isDefined(d.maxScale)&&b.setScaleRange(d.minScale,d.maxScale);var h=b.getFeatureLayers();t.forEach(h,function(l){d.pointSymbol&&"esriGeometryPoint"===l.geometryType?(l.renderer.symbol=I.fromJson(d.pointSymbol),1===h.length&&
(b.pointSymbol=I.fromJson(d.pointSymbol))):d.lineSymbol&&"esriGeometryPolyline"===l.geometryType?(l.renderer.symbol=I.fromJson(d.lineSymbol),1===h.length&&(b.polylineSymbol=I.fromJson(d.lineSymbol))):d.polygonSymbol&&"esriGeometryPolygon"===l.geometryType&&(l.renderer.symbol=I.fromJson(d.polygonSymbol),1===h.length&&(b.polygonSymbol=I.fromJson(d.polygonSymbol)))})});else if("CSV"==d.type&&d.url)r={layerDefinition:d.layerDefinition,columnDelimiter:d.columnDelimiter,id:d.id?d.id:null,visible:null!==
d.visibility?d.visibility:!0,opacity:d.opacity,refreshInterval:d.refreshInterval},d.locationInfo&&(r.latitudeFieldName=d.locationInfo.latitudeFieldName,r.longitudeFieldName=d.locationInfo.longitudeFieldName),!l.ignorePopups&&d.popupInfo&&(r.infoTemplate=new e(d.popupInfo)),b=new ga(d.url,r);else if("VectorTileLayer"===d.layerType&&d.styleUrl)b=new lb(d.styleUrl,{id:d.id,minScale:d.minScale,maxScale:d.maxScale,opacity:d.opacity,visible:d.visibility});else if(d.layerDefinition&&!d.url)r=m.fromJson(m.toJson(d)),
delete r.id,delete r.opacity,delete r.visibility,b=new T(r,{id:d.id,opacity:d.opacity,visible:d.visibility,outFields:["*"],autoGeneralize:!0}),!l.ignorePopups&&r.popupInfo&&b.setInfoTemplate(new e(r.popupInfo)),Ea(b);else if("BingMapsAerial"===d.type||"BingMapsRoad"===d.type||"BingMapsHybrid"===d.type)l.bingMapsKey?(r=Ra.MAP_STYLE_AERIAL_WITH_LABELS,"BingMapsAerial"===d.type?r=Ra.MAP_STYLE_AERIAL:"BingMapsRoad"===d.type&&(r=Ra.MAP_STYLE_ROAD),b=new Ra({bingMapsKey:l.bingMapsKey,mapStyle:r,opacity:d.opacity,
id:d.id}),v.connect(b,"onError",g.hitch(this,function(d){d.errors=d.errors||[];d.errors.push({message:"This application does not have a valid Bing Key for the Bing layer that is included in this map. [type:"+d.type+"]"})},d))):(d.errors=d.errors||[],d.errors.push({message:"This application does not provide a Bing Key for the Bing layer that is included in this map. [type:"+d.type+"]"}));else if(d.resourceInfo&&d.resourceInfo.mapName)b=!0===d.resourceInfo.singleFusedMapCache&&(d.baseMapLayer||ma(d,
h,r)&&wa(d,y,H))?ea(d,e,l):N(d,e,l);else if(d.resourceInfo&&d.resourceInfo.pixelSizeX)b=!0===d.resourceInfo.singleFusedMapCache&&(d.baseMapLayer||ma(d,h,r)&&wa(d,y,H))?ea(d,e,l):Ca(d,e,l);else if(d.resourceInfo&&"Feature Layer"===d.resourceInfo.type){d.capabilities&&(d.resourceInfo.capabilities=d.capabilities);var P;!1===l.editable?P=!1:l.privileges&&-1===t.indexOf(l.privileges,"features:user:edit")&&c.id&&c.id.findCredential(d.url)&&(P=!1);b=new T(ba(d.url),{resourceInfo:d.resourceInfo,opacity:d.opacity,
visible:d.visibility,id:d.id,mode:d.mode===T.MODE_SELECTION?T.MODE_SELECTION:T.MODE_AUTO,editable:P,outFields:["*"],autoGeneralize:!0,refreshInterval:d.refreshInterval});!l.ignorePopups&&d.popupInfo&&b.setInfoTemplate(new e(d.popupInfo));d.layerDefinition&&(d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.renderer&&(r=K.fromJson(d.layerDefinition.drawingInfo.renderer),r.isMaxInclusive=!0,b.setRenderer(r)),d.layerDefinition.drawingInfo&&d.layerDefinition.drawingInfo.labelingInfo&&(r=t.map(d.layerDefinition.drawingInfo.labelingInfo,
function(d){return new xb(d)}),b.setLabelingInfo(r)),d.layerDefinition.definitionExpression&&b.setDefinitionExpression(d.layerDefinition.definitionExpression),q.isDefined(d.layerDefinition.minScale)&&b.setMinScale(d.layerDefinition.minScale),q.isDefined(d.layerDefinition.maxScale)&&b.setMaxScale(d.layerDefinition.maxScale));Ea(b)}else d.resourceInfo&&d.resourceInfo.streamUrls&&(r={resourceInfo:d.resourceInfo,opacity:d.opacity,visible:d.visibility,id:d.id},d.layerDefinition&&(x=d.layerDefinition.drawingInfo,
d.layerDefinition.definitionGeometry&&(A=A||{},A.geometry=d.layerDefinition.definitionGeometry),q.isDefined(d.layerDefinition.definitionExpression)&&(A=A||{},A.where=d.layerDefinition.definitionExpression),q.isDefined(d.layerDefinition.maximumTrackPoints)&&(r.maximumTrackPoints=d.layerDefinition.maximumTrackPoints)),A&&(r.filter=A),d.purgeOptions&&(r.purgeOptions=d.purgeOptions),b=new yb(ba(d.url),r),x&&x.renderer&&(r=x.renderer,b.setRenderer(K.fromJson(r))),!l.ignorePopups&&d.popupInfo&&b.setInfoTemplate(new e(d.popupInfo)),
d.layerDefinition&&(q.isDefined(d.layerDefinition.minScale)&&b.setMinScale(d.layerDefinition.minScale),q.isDefined(d.layerDefinition.maxScale)&&b.setMaxScale(d.layerDefinition.maxScale)),k.once(b,"error",function(h){d.errors.push({message:"Error loading stream layer. Check websocket url"})}));b&&(b.arcgisProps={title:d.title},d.baseMapLayer&&(d.isReference?(b.attr("data-reference",!0),b._basemapGalleryLayerType="reference"):b._basemapGalleryLayerType="basemap"),b instanceof T&&d.layerDefinition&&
d.layerDefinition.featureReduction&&"cluster"===d.layerDefinition.featureReduction.type&&(r=d.layerDefinition.featureReduction,r.clusterSize&&(r.clusterSize=a.pt2px(r.clusterSize)),r.clusterRadius&&(r.clusterRadius=a.pt2px(r.clusterRadius)),r.popupInfo&&(r.infoTemplate=new J(r.popupInfo),delete r.popupInfo),b.setFeatureReduction(r)));return b}function ya(d,h,l,r,y){t.forEach(d,function(a){a.layerObject=xa(a,d,h,l,r,y)});var a=t.filter(d,function(d){return!d.isReference}),H=t.filter(d,function(d){return!!d.isReference});
return d=a.concat(H)}function la(d){var h=null;d=d[0];d.url&&!d.type?d.resourceInfo.spatialReference&&(h=new z,d.resourceInfo.spatialReference.wkid&&(h.wkid=d.resourceInfo.spatialReference.wkid),d.resourceInfo.spatialReference.wkt&&(h.wkt=d.resourceInfo.spatialReference.wkt)):d.type&&(-1<d.type.indexOf("BingMaps")||"OpenStreetMap"==d.type?h=new z({wkid:102100}):"WMS"==d.type&&(h=new z({wkid:d.spatialReferences[0]})));return h}function ua(d,h,l,r,y,a,H,b){t.forEach(h,function(h){h.url&&!h.type&&(h.resourceInfo=
d[h.deferredsPos][1],delete h.deferredsPos)});a=a||la(h);h=ya(h,l,a,H,b);y.callback(h);return y}function Ea(d){!window.CanvasRenderingContext2D&&d.renderer&&"esri.renderer.HeatmapRenderer"===d.renderer.declaredClass&&d.setRenderer(K.fromJson({type:"simple",symbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}}))}function oa(d,h){var l=ba(d);return C({url:l,content:{f:"json"},
callbackParamName:"callback",error:function(d,r){d.message=d.message?d.message+(" [url:"+l+"]"):"[url:"+l+"]";h.push(d);x.defaults.io.errorHandler(d,r)}})}function ra(d){var h=R.arcgisUrl+"/"+d.itemId+"/data";return C({url:h,content:{f:"json"},callbackParamName:"callback",error:function(l,r){l.message=l.message?l.message+(" [url:"+h+"]"):"[url:"+h+"]";d.errors=d.errors||[];d.errors.push(l);x.defaults.io.errorHandler(l,r)}})}function pa(d,h,l){var r=new n;if(!(l.featureCollection&&l.featureCollection.layers||
l.layers))return console.log("Invalid Feature Collection item data [item id: "+d.itemId+"]: ",l),d.errors=d.errors||[],d.errors.push({message:"Invalid Feature Collection item data. [item id: "+d.itemId+"]"}),r.errback(),r;l.layers&&(l.featureCollection={layers:l.layers},delete l.layers,q.isDefined(l.showLegend)&&(l.featureCollection.showLegend=l.showLegend,delete l.showLegend));Ia(d,l.featureCollection,h).then(function(h){l.featureCollection=h;d.featureCollection&&d.featureCollection.layers?t.forEach(l.featureCollection.layers,
function(h,l){l=d.featureCollection.layers[l];l.popupInfo||l.layerDefinition?l.layerDefinition?(q.isDefined(l.layerDefinition.minScale)&&q.isDefined(l.layerDefinition.maxScale)&&(l.layerDefinition.minScale!==h.layerDefinition.minScale||l.layerDefinition.maxScale!==h.layerDefinition.maxScale)&&(delete h.layerDefinition.minScale,delete h.layerDefinition.maxScale),l.layerDefinition.drawingInfo&&m.toJson(l.layerDefinition.drawingInfo)!==m.toJson(h.layerDefinition.drawingInfo)&&delete h.layerDefinition.drawingInfo,
l.layerDefinition.showLegend!==h.layerDefinition.showLegend&&delete h.layerDefinition.showLegend,l.layerDefinition=g.mixin(l.layerDefinition,h.layerDefinition)):l.layerDefinition=h.layerDefinition:(l.popupInfo=h.popupInfo,l.layerDefinition=h.layerDefinition);l.featureSet=h.featureSet;l.nextObjectId=h.nextObjectId}):(d.featureCollection=d.featureCollection||{},d.featureCollection=g.mixin(d.featureCollection,l.featureCollection));r.callback(d)});return r}function Ia(d,h,l){var r=new n;p(["./csv"],function(y){var a=
[];t.forEach(h.layers,function(d){d.featureSet&&d.featureSet.features&&d.featureSet.features.length&&d.featureSet.features[0].geometry&&d.featureSet.features[0].geometry.spatialReference&&(d.deferredsPos=a.length,a.push(y.projectFeatureCollection(d,l,d.featureSet.features[0].geometry.spatialReference)))});(new f(a)).addCallback(function(){t.forEach(h.layers,function(h){q.isDefined(h.deferredsPos)&&(a[h.deferredsPos].results&&a[h.deferredsPos].results.length?h=a[h.deferredsPos].results[0]:(console.log("Errors projecting feature collection. ["+
d.title+" - "+h.layerDefinition.name+"]"),h.errors=h.errors||[],h.errors.push({message:"Errors projecting feature collection. ["+d.title+" - "+h.layerDefinition.name+"]"})),delete h.deferredsPos)});r.callback(h)})});return r}function fa(d,h,l,r,y){var a=new n,H=new n,b=[],A;t.forEach(d.operationalLayers,function(d){d.itemId&&"Feature Collection"==d.type&&b.push(ra(d).then(g.hitch(null,pa,d,l)))});0===b.length?za(d,h,l,r,H,y):(A=new f(b),A.addCallback(function(a){za(d,h,l,r,H,y)}));H.then(function(d){b=
[];t.forEach(d,function(d){var h;d=d.layerObject;d instanceof T&&!d.loaded&&!d.loadError?(h=new n,k.once(d,"load, error",function(){h.callback(d)}),b.push(h)):d&&"esri.layers.WFSLayer"===d.declaredClass&&!d.loadError&&(h=new n,k.once(d,"fromJsonComplete, error",function(l){h.callback(d)}),b.push(h))});if(b.length){var h=new n;A=new f(b);A.addCallback(function(){h.callback(d)});return h.promise}return d}).then(function(d){var h=[];t.forEach(d,function(d){var l=d.layerObject;l instanceof T?l.loaded&&
l.labelingInfo&&(d.showLabels||l._collection?h.push(l):l.setShowLabels&&l.setShowLabels(!1)):l&&"esri.layers.WFSLayer"===l.declaredClass&&l.loaded&&l.labelingInfo&&h.push(l)});h.length?p(["../layers/LabelLayer"],function(l){var r=new l;t.forEach(h,function(d){r.addFeatureLayer(d)});d.push({layerObject:r});a.callback(d)}):a.callback(d)});return a}function za(d,h,l,r,y,a){var H=[],b=[],A=[];t.forEach(d.operationalLayers,function(d,h){if(d.featureCollection&&d.featureCollection.layers){var l=d.featureCollection.layers.length;
t.forEach(d.featureCollection.layers,function(r,y){var a=!0;d.visibleLayers&&-1==t.indexOf(d.visibleLayers,y)&&(a=!1);r.visibility=d.visibility&&a;r.opacity=d.opacity;r.id=(d.id||"operational"+h)+"_"+y;d.title&&(r.title=1!==l&&r.layerDefinition.name&&d.title!==r.layerDefinition.name?d.title+" - "+r.layerDefinition.name:d.title);A.push(r)},this)}else A.push(d)});t.forEach(d.baseMap.baseMapLayers,function(d,h){d.baseMapLayer=!0;d.id=d.id||"base"+h;H.push(d)});t.forEach(A,function(d,h){d.id=d.id||"operational"+
h;H.push(d)});t.forEach(H,function(d){d.url&&!d.type&&(d.deferredsPos=b.length,d.errors=d.errors||[],b.push(oa(d.url,d.errors)))});0===b.length?(l=l||la(H),H=ya(H,h,l,r,a),y.callback(H)):(new f(b)).addCallback(function(d){ua(d,H,h,b,y,l,r,a)});return y}function Fa(d,h,l,r){var y=d.minScale,a=d.maxScale;if(10.1>=l.version&&h)for(d=h.length-1;0<=d;d--){if(h[d].id==r)if(0==y&&0<h[d].minScale?y=h[d].minScale:0<y&&0==h[d].minScale?y=l.minScale:0<y&&0<h[d].minScale&&(y=Math.min(y,h[d].minScale)),a=Math.max(l.maxScale||
0,h[d].maxScale||0),l.setScaleRange(y,a),-1<h[d].parentLayerId)r=h[d].parentLayerId;else break}else 10.1<l.version&&(t.forEach(d.layerInfos,function(d){d.id==r&&(0==y&&0<d.minScale?y=d.minScale:0<y&&0==d.minScale||0<y&&0<d.minScale&&(y=Math.min(y,d.minScale)),a=Math.max(a||0,d.maxScale||0))}),l.setScaleRange(y,a))}function Ma(d,h,l,r){var y=d.url,a=d.__popupIds,H=d.__popupUrls,b=d.__popupWhereClauses,A=d.__popupMinScales,c=d.__popupMaxScales,e=d.__resourceInfo,f=[];t.forEach(d.__popups,function(r,
w){if(r){var x,P=[];t.forEach(r.fieldInfos,function(d){"shape"!==d.fieldName.toLowerCase()&&P.push(d.fieldName)});if(d.dynamicLayerInfos&&0<d.dynamicLayerInfos.length){var k=t.filter(d.dynamicLayerInfos,function(d){return a[w]==d.id})[0].source;x=new T(y+"/dynamicLayer",{parentLayer:d,id:d.id+"_"+a[w],source:k,outFields:P,mode:T.MODE_SELECTION,infoTemplate:r&&new l(r),drawMode:!1,visible:d.visible,autoGeneralize:!0});var m=function(l,r){0<b[l].length&&r.setDefinitionExpression(b[l]);if(q.isDefined(A[l])||
q.isDefined(c[l]))if(q.isDefined(d.minScale)||q.isDefined(d.maxScale)){var y=d.minScale,H=d.maxScale;0==y&&0<A[l]?y=A[l]:0<y&&0==A[l]||0<y&&0<A[l]&&(y=Math.min(y,A[l]));H=Math.max(H||0,c[l]||0);r.setScaleRange(y,H)}else r.setScaleRange(A[l],c[l]);else Fa(d,h||e.layers,r,a[l])};x.loaded?m(w,x):v.connect(x,"onLoad",function(d){m(w,x)})}else{var z=null,C=y+"/"+a[w];if(H[w].length)C=H[w];else if(h)for(k=0;k<h.length;k++)if(h[k].id===a[w]){z=h[k];break}x=new T(ba(C),{parentLayer:d,id:d.id+"_"+a[w],outFields:P,
mode:T.MODE_SELECTION,infoTemplate:r&&new l(r),drawMode:!1,visible:d.visible,resourceInfo:z,autoGeneralize:!0});x.loaded?(0<b[w].length&&x.setDefinitionExpression(b[w]),Fa(d,h||e.layers,x,a[w])):v.connect(x,"onLoad",function(l){0<b[w].length&&x.setDefinitionExpression(b[w]);Fa(d,h||e.layers,l,a[w])})}f.push(x)}});0<f.length&&(v.connect(d,"onVisibilityChange",g.hitch(this,function(d,h){t.forEach(d,function(d){h?d.show():d.hide()})},f)),v.connect(r,"onLayerRemove",g.hitch(this,function(d,h,l){d.id===
l.id&&t.forEach(h,function(d){r.removeLayer(d)})},d,f)));delete d.__popups;delete d.__popupIds;delete d.__popupUrls;delete d.__popupWhereClauses;delete d.__popupMinScales;delete d.__popupMaxScales;delete d.__resourceInfo;return f}function Da(d){return C({url:ba(d.url+"/layers"),content:{f:"json"},callbackParamName:"callback",error:function(){}})}function Pa(d,h,l){var r=[];t.forEach(d,function(d){var h=d.__popups;h&&1<h.length&&10<=d.version&&(d.__deferredsPos=r.length,r.push(Da(d)))});var y=[];0<
r.length?(new f(r)).addCallback(function(r){t.forEach(d,function(d){d.__popups&&0<d.__popups.length&&(d.__deferredsPos||0===d.__deferredsPos?(y=y.concat(Ma(d,r[d.__deferredsPos][1].layers,l,h)),delete d.__deferredsPos):y=y.concat(Ma(d,null,l,h)))});h.addLayers(y)}):(t.forEach(d,function(d){d.__popups&&0<d.__popups.length&&(y=y.concat(Ma(d,null,l,h)))}),h.addLayers(y))}function Ja(d){t.forEach(d,function(d){var h=d.layer;h.toJson&&(d=h.toJson(),d.featureSet&&h.name&&-1<h.name.indexOf("Text")&&t.forEach(d.featureSet.features,
function(d,l){d.attributes.TEXT&&(l=h.graphics[l],l.symbol.setText(d.attributes.TEXT),d.symbol.horizontalAlignment&&(l.symbol.align=d.symbol.horizontalAlignment),l.setSymbol(l.symbol),l.setAttributes(d.attributes))},this))})}function Ta(d){var h=6;t.forEach(d,function(d){if(d=d.renderer)"esri.renderer.SimpleRenderer"===d.declaredClass?((d=d.symbol)&&d.xoffset&&(h=Math.max(h,Math.abs(d.xoffset))),d&&d.yoffset&&(h=Math.max(h,Math.abs(d.yoffset)))):"esri.renderer.UniqueValueRenderer"!==d.declaredClass&&
"esri.renderer.ClassBreaksRenderer"!==d.declaredClass||t.forEach(d.infos,function(d){(d=d.symbol)&&d.xoffset&&(h=Math.max(h,Math.abs(d.xoffset)));d&&d.yoffset&&(h=Math.max(h,Math.abs(d.yoffset)))})});return h}function ca(d){var h=this,l=h.infoWindow,r=d.graphic;if(h.loaded){l.hide();l.clearFeatures();var y=[];t.forEach(h.graphicsLayerIds,function(d){(d=h.getLayer(d))&&d instanceof T&&d.loaded&&d.visible&&(d.clearSelection(),d.infoTemplate&&!d.suspended&&y.push(d))});t.forEach(h.layerIds,function(d){(d=
h.getLayer(d))&&-1!==d.declaredClass.indexOf("ArcGISImageServiceLayer")&&d.loaded&&d.visible&&d.infoTemplate&&y.push(d)});r=r&&r.getInfoTemplate()?r:null;if(y.length||r){var a=Ta(y),H=d.screenPoint,b=h.toMap(new G(H.x-a,H.y+a)),a=h.toMap(new G(H.x+a,H.y-a)),A=new F(b.x,b.y,a.x,a.y,h.spatialReference),c=new M;c.geometry=A;c.timeExtent=h.timeExtent;var e=!0,b=t.map(y,function(h){h=h&&h.isFeatureReductionActive&&h.isFeatureReductionActive()?h.getFeatureReductionLayer():h;var l;if(-1!==h.declaredClass.indexOf("ArcGISImageServiceLayer"))c.geometry=
d.mapPoint,e=!1,l=h.queryVisibleRasters(c,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),l.addCallback(function(){return h.getVisibleRasters()});else if("function"===typeof h.selectFeatures)l=h.selectFeatures(c),l.addCallback(function(){return h.getSelectedFeatures()});else{l=new n;var r=t.filter(h.graphics,function(d){return d&&d.visible&&A.intersects(d.geometry)});l.resolve(r)}return l});r&&(a=new n,a.callback([r]),b.splice(0,0,a));if(!t.some(b,function(d){return-1===d.fired})){var f=
r?1:0;t.forEach(y,function(d){f=-1!==d.declaredClass.indexOf("ArcGISImageServiceLayer")?f+d.getVisibleRasters().length:f+d.getSelectedFeatures().length});if(!f)return}l.setFeatures(b);l.show(d.mapPoint,{closestFirst:e})}}}function Ga(d,h){var l=h.mapOptions||{},r;l.infoWindow||(r=new L({visibleWhenEmpty:!1},e.create("div")),l.infoWindow=r);q.isDefined(l.showInfoWindowOnClick)||h.usePopupManager||(l.showInfoWindowOnClick=!1);d=new E(d,l);v.connect(d,"onLayersAddResult",Ja);return d}function Oa(d,h,
l,r,y,a){var H,b,A,c;r.map?(H=r.map,b=r.clickEventHandle,A=r.clickEventListener,c=r.errors):(H=Ga(r,y),y.ignorePopups||y.disableClickBehavior||y.usePopupManager||(b=v.connect(H,"onClick",ca),A=ca));H.addLayers(d);y.ignorePopups||y.usePopupManager||Pa(d,H,y._clazz);var e=c||[];t.forEach(h,function(d){d.errors&&(e=e.concat(d.errors))},this);H.loaded?a.callback({map:H,itemInfo:l,errors:e,clickEventHandle:b,clickEventListener:A}):v.connect(H,"onLoad",function(){a.callback({map:H,itemInfo:l,errors:e,clickEventHandle:b,
clickEventListener:A})})}function ja(d,h,l,r,y){var a=[];t.forEach(y,function(d){g.isArray(d.layerObject)?t.forEach(d.layerObject,function(d){a.push(d)}):a.push(d.layerObject)});if("BingMapsAerial"===y[0].type||"BingMapsRoad"===y[0].type||"BingMapsHybrid"===y[0].type)var H=setInterval(function(){if(y[0].layerObject&&y[0].layerObject.loaded)clearInterval(H),Ua(d,h,l,r,y,a);else if(y[0].errors){clearInterval(H);var b="";y[0].errors&&y[0].errors.length&&(b=" ("+y[0].errors[0].message+")");r.errback(Error(O.arcgis.utils.baseLayerError+
b))}},10);else if(!a[0]&&y[0].baseMapLayer){var b="";y[0].errors&&y[0].errors.length&&(b=" ("+y[0].errors[0].message+")");r.errback(Error(O.arcgis.utils.baseLayerError+b))}else Ua(d,h,l,r,y,a)}function Ua(d,h,l,r,y,a){try{var H=l.mapOptions||{};l.mapOptions=H;var b=d.item,A=d.itemData;!H.backgroundColor&&A.background&&A.background.color&&null!=A.background.color[0]&&(H.backgroundColor=w.toDojoColor(A.background.color));a=t.filter(a,q.isDefined);if(b)if(b.extent&&b.extent.length)if(H.extent)Oa(a,y,
d,h,l,r);else{var c=new F(b.extent[0][0],b.extent[0][1],b.extent[1][0],b.extent[1][1],new z({wkid:4326})),e=a[0].spatialReference;4326===e.wkid?(H.extent=c,Oa(a,y,d,h,l,r)):102100===e.wkid||102113===e.wkid||3857===e.wkid?(c.xmin=Math.max(c.xmin,-180),c.xmax=Math.min(c.xmax,180),c.ymin=Math.max(c.ymin,-89.99),c.ymax=Math.min(c.ymax,89.99),H.extent=D.geographicToWebMercator(c),Oa(a,y,d,h,l,r)):l.geometryServiceURL||x.defaults.geometryService?(l.geometryServiceURL?new Q(l.geometryServiceURL):x.defaults.geometryService).project([c],
e,function(b){b=b[0];H.extent=H.extent||b;Oa(a,y,d,h,l,r)},function(){Oa(a,y,d,h,l,r)}):r.errback(Error(O.arcgis.utils.geometryServiceError))}else Oa(a,y,d,h,l,r);else Oa(a,y,d,h,l,r)}catch(kb){r.errback(kb)}}function Qa(d){var h=[];t.forEach(d.operationalLayers,function(d){d.featureCollection?h.push({featureCollection:d.featureCollection,visibility:d.visibility,title:d.title}):d.layerObject&&h.push({layer:d.layerObject,visibility:d.visibility,title:d.title})});return h}function na(d){var h=[],l=
d.baseMap.baseMapLayers;d.operationalLayers&&(l=l.concat(d.operationalLayers));t.forEach(l,function(d){var l={};if(d.featureCollection&&"CSV"!==d.type)!0===d.featureCollection.showLegend&&t.forEach(d.featureCollection.layers,function(r){if(!1!==r.showLegend){var y=r.layerObject.renderer;l={layer:r.layerObject,title:d.title,defaultSymbol:y&&y.defaultSymbol&&y.defaultLabel?!0:!1};1<d.featureCollection.layers.length&&(l.title+=" - "+r.layerDefinition.name);h.push(l)}});else if(d.baseMapLayer&&!0===d.showLegend&&
d.layerObject||!d.baseMapLayer&&!1!==d.showLegend&&d.layerObject&&!(d.layerObject instanceof T&&d.layerObject.mode===T.MODE_SELECTION)){var r=d.layerObject.renderer,y=d.layerObject.declaredClass,r=!r||r&&r.defaultSymbol&&r.defaultLabel?!0:!1;if(10.1>d.layerObject.version&&("esri.layers.ArcGISDynamicMapServiceLayer"===y||"esri.layers.ArcGISTiledMapServiceLayer"===y)||"esri.layers.ArcGISImageServiceLayer"===y)r=!0;l={layer:d.layerObject,title:d.title,defaultSymbol:r};d.layers&&(y=t.map(t.filter(d.layers,
function(d){return!1===d.showLegend}),function(d){return d.id}),y.length&&(l.hideLayers=y));h.push(l)}});return h}function fb(d,h){function l(d,h){t.forEach(d,function(d,l){switch(d){case "../layers/ArcGISDynamicMapServiceLayer":ka=h[l];break;case "../layers/ArcGISImageServiceLayer":ia=h[l];break;case "../layers/ArcGISImageServiceVectorLayer":qa=h[l];break;case "../layers/CSVLayer":ga=h[l];break;case "../layers/DynamicLayerInfo":ha=h[l];break;case "../layers/GeoRSSLayer":Y=h[l];break;case "../layers/ImageParameters":sb=
h[l];break;case "../layers/ImageServiceParameters":Sa=h[l];break;case "../layers/KMLLayer":Za=h[l];break;case "../layers/LabelClass":xb=h[l];break;case "../layers/LayerDrawingOptions":Ya=h[l];break;case "../layers/MosaicRule":ub=h[l];break;case "../layers/OpenStreetMapLayer":pb=h[l];break;case "../layers/RasterFunction":tb=h[l];break;case "../layers/StreamLayer":yb=h[l];break;case "../layers/TileInfo":bb=h[l];break;case "../layers/VectorTileLayer":lb=h[l];break;case "../virtualearth/VETiledLayer":Ra=
h[l];break;case "../layers/WebTiledLayer":wb=h[l];break;case "../layers/WFSLayer":mb=h[l];break;case "../layers/WMSLayer":vb=h[l];break;case "../layers/WMSLayerInfo":qb=h[l]}})}var r=new n;d=d.itemData;h=[];d.baseMap&&d.baseMap.baseMapLayers&&(h=h.concat(d.baseMap.baseMapLayers));d.operationalLayers&&(h=h.concat(d.operationalLayers));d=t.map(h,function(d){return d&&d.layerType});var y=[],a=[];h=!1;for(var H=0;H<d.length;H++){switch(d[H]){case "ArcGISFeatureLayer":-1===t.indexOf(y,"../layers/LabelClass")&&
y.push("../layers/LabelClass");break;case "ArcGISImageServiceLayer":case "ArcGISTiledImageServiceLayer":-1===t.indexOf(y,"../layers/ArcGISImageServiceLayer")&&(y.push("../layers/ArcGISImageServiceLayer"),a.push("../layers/ImageServiceParameters"),a.push("../layers/MosaicRule"),a.push("../layers/RasterFunction"));break;case "ArcGISImageServiceVectorLayer":-1===t.indexOf(y,"../layers/ArcGISImageServiceVectorLayer")&&(y.push("../layers/ArcGISImageServiceVectorLayer"),a.push("../layers/ImageServiceParameters"),
a.push("../layers/MosaicRule"),a.push("../layers/RasterFunction"));break;case "ArcGISMapServiceLayer":case "ArcGISTiledMapServiceLayer":-1===t.indexOf(y,"../layers/ArcGISDynamicMapServiceLayer")&&(y.push("../layers/ArcGISDynamicMapServiceLayer"),a.push("../layers/DynamicLayerInfo"),a.push("../layers/ImageParameters"),a.push("../layers/LayerDrawingOptions"));break;case "ArcGISStreamLayer":-1===t.indexOf(y,"../layers/StreamLayer")&&y.push("../layers/StreamLayer");break;case "BingMapsAerial":case "BingMapsHybrid":case "BingMapsRoad":-1===
t.indexOf(y,"../virtualearth/VETiledLayer")&&y.push("../virtualearth/VETiledLayer");break;case "CSV":-1===t.indexOf(y,"../layers/CSVLayer")&&(y.push("../layers/CSVLayer"),a.push("./csv"));break;case "GeoRSS":-1===t.indexOf(y,"../layers/GeoRSSLayer")&&y.push("../layers/GeoRSSLayer");break;case "KML":-1===t.indexOf(y,"../layers/KMLLayer")&&y.push("../layers/KMLLayer");break;case "OpenStreetMap":-1===t.indexOf(y,"../layers/OpenStreetMapLayer")&&y.push("../layers/OpenStreetMapLayer");break;case "VectorTileLayer":-1===
t.indexOf(y,"../layers/VectorTileLayer")&&y.push("../layers/VectorTileLayer");break;case "WebTiledLayer":-1===t.indexOf(y,"../layers/WebTiledLayer")&&(y.push("../layers/WebTiledLayer"),a.push("../layers/TileInfo"));break;case "WFS":-1===t.indexOf(y,"../layers/WFSLayer")&&y.push("../layers/WFSLayer");break;case "WMS":-1===t.indexOf(y,"../layers/WMSLayer")&&(y.push("../layers/WMSLayer"),a.push("../layers/WMSLayerInfo"));break;default:h=!0}if(h)break}h&&(y=Gb,a=Hb);y.length?p(y,function(){l(y,arguments);
a.length?p(a,function(){l(a,arguments);r.resolve()}):r.resolve()}):r.resolve();return r}function Z(d,h,r,y){var a=y.itemData;a.baseMap&&a.baseMap.baseMapLayers&&a.baseMap.baseMapLayers.length&&(a.baseMap.baseMapLayers[0].firstLayer=!0);var H=h.layerMixins,b=H&&H.length;if(b){var A=function(d){for(var h=0;h<b;h++){var l=H[h];if(l.mixin)if(l.hasOwnProperty("id")){if(d.id===l.id){g.mixin(d,l.mixin);break}}else if(d.url===l.url){g.mixin(d,l.mixin);break}}};t.forEach(a.baseMap&&a.baseMap.baseMapLayers,
A);t.forEach(a.operationalLayers,A)}fb(y,h).then(function(){return l(y,h)}).then(function(){return aa(y,h)}).then(function(h){var l=h[0],y=h[1];if(l.itemData.operationalLayers&&0!==l.itemData.operationalLayers.length){var a=new n,H=l.itemData.baseMap.baseMapLayers.slice(),b=t.filter(l.itemData.baseMap.baseMapLayers,function(d){return!d.isReference});h={item:l.item,itemData:{baseMap:{baseMapLayers:b}}};l.itemData.baseMap.baseMapLayers=t.filter(l.itemData.baseMap.baseMapLayers,function(d){return d.isReference});
X(h,y).addCallback(function(h){fa(h.itemData,y).addCallback(g.hitch(null,ja,h,d,y,a))});a.then(function(d){X(l,y).addCallback(function(h){fa(h.itemData,y,d.map.spatialReference,b,d.map).addCallback(function(l){h.itemData.baseMap.baseMapLayers=H;ja(h,d,y,r,l)})})},g.hitch(r,r.errback))}else X(l,y).addCallback(function(h){fa(h.itemData,y).addCallback(g.hitch(null,ja,h,d,y,r))})})}function sa(d,h){"undefined"===typeof h&&(h=!0);R._arcgisUrl&&0<R._arcgisUrl.length&&(R.arcgisUrl=R._arcgisUrl);var l=R.arcgisUrl+
"/"+d,r={},y=new n;C({url:l,content:{f:"json"},callbackParamName:"callback",load:function(d){r.item=d;h?C({url:l+"/data",content:{f:"json"},callbackParamName:"callback",load:function(d){r.itemData=d;y.callback(r)},error:function(d){y.errback(d)}}):y.callback(r)},error:function(d){y.errback(d)}});return y}var R,ka,ia,qa,ga,ha,Y,sb,Sa,Za,xb,Ya,ub,pb,tb,yb,bb,lb,Ra,wb,mb,vb,qb,Gb="../layers/ArcGISDynamicMapServiceLayer ../layers/ArcGISImageServiceLayer ../layers/ArcGISImageServiceVectorLayer ../layers/CSVLayer ../layers/GeoRSSLayer ../layers/KMLLayer ../layers/LabelClass ../layers/OpenStreetMapLayer ../layers/StreamLayer ../layers/VectorTileLayer ../virtualearth/VETiledLayer ../layers/WebTiledLayer ../layers/WFSLayer ../layers/WMSLayer".split(" "),
Hb="./csv ../layers/DynamicLayerInfo ../layers/ImageParameters ../layers/ImageServiceParameters ../layers/LayerDrawingOptions ../layers/MosaicRule ../layers/RasterFunction ../layers/TileInfo ../layers/WMSLayerInfo".split(" ");R={arcgisUrl:B.getProtocolForWebResource()+"//www.arcgis.com/sharing/rest/content/items",getItem:sa,createMap:function(d,h,l){var r=new n;l=l||{};var y=l.infoTemplateClass;l._clazz=y&&(g.isObject(y)?y:g.getObject(y))||J;g.isString(d)?sa(d).addCallback(g.hitch(null,Z,h,l,r)).addErrback(g.hitch(r,
r.errback)):Z(h,l,r,d);r.addCallback(function(d){var h=d.map;h&&(h.tables=g.getObject("itemInfo.itemData.tables",!1,d)||[])});return r},getLayerList:function(d){return d&&d.itemInfo&&d.itemInfo.itemData?Qa(d.itemInfo.itemData):[]},getLegendLayers:function(d){return d&&d.itemInfo&&d.itemInfo.itemData?na(d.itemInfo.itemData):[]},_arcgisUrl:null,_getItemProps:X,_getItemData:W,_getBingKey:U,_portalUrlResponse:d,_portalUrlFailure:h,_processFSItemProperties:V,_processSSItemProperties:A,_getLayers:fa,_preBuildLayerObjects:ua,
_buildLayerObjects:ya,_preCreateMap:ja,_getMapSR:la,_createMap:Oa,_addSelectionLayers:Pa,_createSelectionFeatureLayers:Ma,_getServiceInfo:oa,_getFeatureCollectionItem:ra,_mergeFeatureCollectionItem:pa,_projectFeatureCollection:Ia,_getLayersInfo:Da,_initLayer:xa,_loadAsCached:ea,_loadAsDynamic:N,_processPopups:y,_onLayersAddResult:Ja,_sameSpatialReferenceAsBasemap:ma,_sameTilingSchemeAsBasemap:wa,_showPopup:ca,_calculateClickTolerance:Ta,_getVisibleFeatureLayers:va,_updateLayerScaleInfo:Fa,_checkUrl:ba,
_isHostedService:H,_isAgolService:P,_getLegendLayers:na};g.setObject("arcgis.utils",R,c);return R})},"dojo/_base/url":function(){define(["./kernel"],function(p){var g=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,t=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,v=function(){for(var n=arguments,m=[n[0]],u=1;u<n.length;u++)if(n[u]){var k=new v(n[u]+""),m=new v(m[0]+"");if(""==k.path&&!k.scheme&&!k.authority&&!k.query)null!=k.fragment&&(m.fragment=k.fragment),k=m;else if(!k.scheme&&
(k.scheme=m.scheme,!k.authority&&(k.authority=m.authority,"/"!=k.path.charAt(0)))){for(var m=(m.path.substring(0,m.path.lastIndexOf("/")+1)+k.path).split("/"),f=0;f<m.length;f++)"."==m[f]?f==m.length-1?m[f]="":(m.splice(f,1),f--):0<f&&(1!=f||""!=m[0])&&".."==m[f]&&".."!=m[f-1]&&(f==m.length-1?(m.splice(f,1),m[f-1]=""):(m.splice(f-1,2),f-=2));k.path=m.join("/")}m=[];k.scheme&&m.push(k.scheme,":");k.authority&&m.push("//",k.authority);m.push(k.path);k.query&&m.push("?",k.query);k.fragment&&m.push("#",
k.fragment)}this.uri=m.join("");n=this.uri.match(g);this.scheme=n[2]||(n[1]?"":null);this.authority=n[4]||(n[3]?"":null);this.path=n[5];this.query=n[7]||(n[6]?"":null);this.fragment=n[9]||(n[8]?"":null);null!=this.authority&&(n=this.authority.match(t),this.user=n[3]||null,this.password=n[4]||null,this.host=n[6]||n[7],this.port=n[9]||null)};v.prototype.toString=function(){return this.uri};return p._Url=v})},"dojo/DeferredList":function(){define(["./_base/kernel","./_base/Deferred","./_base/array"],
function(p,g,t){p.DeferredList=function(p,n,m,u,k){var f=[];g.call(this);var e=this;0!==p.length||n||this.resolve([0,[]]);var b=0;t.forEach(p,function(a,c){function x(a,q){f[c]=[a,q];b++;b===p.length&&e.resolve(f)}a.then(function(a){n?e.resolve([c,a]):x(!0,a)},function(a){m?e.reject(a):x(!1,a);if(u)return null;throw a;})})};p.DeferredList.prototype=new g;p.DeferredList.prototype.gatherResults=function(g){g=new p.DeferredList(g,!1,!0,!1);g.addCallback(function(g){var m=[];t.forEach(g,function(u){m.push(u[1])});
return m});return g};return p.DeferredList})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(p,g,t,v,n,m,u,k,f){var e=g.getObject("dojox.gfx",!0),b=e._base={};e._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};e._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+
b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};e._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};b._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,c;v("ie")&&(c=n.doc.documentElement.style.fontSize||"",c||(n.doc.documentElement.style.fontSize="100%"));var e=k.create("div",{style:{position:"absolute",
left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},n.body());for(b in a)e.style.fontSize=b,a[b]=16*Math.round(12*e.offsetHeight/16)/12/1E3;v("ie")&&(n.doc.documentElement.style.fontSize=c);n.body().removeChild(e);return a};var a=null;b._getCachedFontMeasurements=function(c){if(c||!a)a=b._getFontMeasurements();return a};var c=null,x={};b._getTextBox=function(a,b,e){var q,w,m=arguments.length,z;c||(c=k.create("div",
{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},n.body()));q=c;q.className="";w=q.style;w.borderWidth="0";w.margin="0";w.padding="0";w.outline="0";if(1<m&&b)for(z in b)z in x||(w[z]=b[z]);2<m&&e&&(q.className=e);q.innerHTML=a;q.getBoundingClientRect?(w=q.getBoundingClientRect(),w={l:w.left,t:w.top,w:w.width||w.right-w.left,h:w.height||w.bottom-w.top}):w=f.getMarginBox(q);q.innerHTML="";return w};b._computeTextLocation=function(a,b,c,e){var f={};switch(a.align){case "end":f.x=
a.x-b;break;case "middle":f.x=a.x-b/2;break;default:f.x=a.x}f.y=a.y-c*(e?.75:1);return f};b._computeTextBoundingBox=function(a){if(!e._base._isRendered(a))return{x:0,y:0,width:0,height:0};var c;c=a.getShape();var f=a.getFont()||e.defaultFont;a=a.getTextWidth();f=e.normalizedLength(f.size);c=b._computeTextLocation(c,a,f,!0);return{x:c.x,y:c.y,width:a,height:f}};b._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var w=0;b._getUniqueId=function(){var a;do a=p._scopeName+
"xUnique"+ ++w;while(u.byId(a));return a};var q=v("pointer-events")?"touchAction":v("MSPointer")?"msTouchAction":null;b._fixMsTouchAction=q?function(a){a.rawNode.style[q]="none"}:function(){};g.mixin(e,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",
x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,
color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var c=a[b];if(c)return new c;c=a[b]=new Function;c.prototype=e["default"+b];return new c}}(),normalizeColor:function(a){return a instanceof t?a:new t(a)},normalizeParameters:function(a,b){var c;if(b){var e={};for(c in a)c in b&&!(c in e)&&(a[c]=
b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return g.delegate(a);var e={};for(c in a)c in e||(e[c]=g.clone(c in b?b[c]:a[c]));return e},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var e=c.indexOf(".");0<=e&&5<c.length-e&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=e.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=
a[0];b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var f=4;0>c&&("/"==a[4]?f=6:"/"==a[4].charAt(0)&&(f=5));f<a.length&&(b.family=a.slice(f).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/12},pt2px:function(a){return a*e.px_in_pt()},px2pt:function(a){return a/e.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=e.px_in_pt(),c=parseFloat(a);
switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*e.mm_in_pt*b;case "cm":return c*e.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?e[a]:a;b&&(m.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),
function(a){e[a]=b[a]}),"string"==typeof a?e.renderer=a:m.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return e.renderer=e[a]&&e[a].Surface===e.Surface?a:null}))}});return e})},"esri/config":function(){define(["dojo/_base/config","dojo/topic","dojo/has","./kernel"],function(p,g,t,v){t=function(){return this}();v={defaults:{screenDPI:96,geometryService:null,kmlService:null,map:{width:400,height:400,layerNamePrefix:"layer",graphicsLayerNamePrefix:"graphicsLayer",slider:{left:"30px",
top:"30px",width:null,height:"200px"},sliderLabel:{tick:5,labels:null,style:"width:2em; font-family:Verdana; font-size:75%;"},sliderChangeImmediate:!0,zoomSymbol:{color:[0,0,0,64],outline:{color:[255,0,0,255],width:1.25,style:"esriSLSSolid"},style:"esriSFSSolid"},zoomDuration:500,zoomRate:25,zoomAnimationThrottled:!1,panDuration:350,panRate:25,logoLink:"http://www.esri.com"},autoSpatialIndexing:t.Worker&&!1,io:{errorHandler:function(n,m){g.publish("esri.Error",[n])},proxyUrl:null,alwaysUseProxy:!1,
useCors:"with-credentials",corsEnabledServers:[/^https?:\/\/.+\.arcgis\.com(\/|$)/i,"server.arcgisonline.com","services.arcgisonline.com","www.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","tiles.arcgis.com","tiles1.arcgis.com","tiles2.arcgis.com","tiles3.arcgis.com","tiles4.arcgis.com","basemaps.arcgis.com","basemapsbeta.arcgis.com","elevation3d.arcgis.com","services.arcgis.com","services1.arcgis.com","services2.arcgis.com","services3.arcgis.com","services4.arcgis.com","services5.arcgis.com",
"services6.arcgis.com","services7.arcgis.com","services8.arcgis.com","services9.arcgis.com","cdn.arcgis.com","cdn-a.arcgis.com","cdn-b.arcgis.com","static.arcgis.com","utility.arcgis.com","utility.arcgisonline.com","geocode.arcgis.com","geoenrich.arcgis.com","qaext.arcgis.com","staticqa.arcgis.com","tilesqa.arcgis.com","servicesqa.arcgis.com","servicesqa1.arcgis.com","servicesqa2.arcgis.com","servicesqa3.arcgis.com","geocodeqa.arcgis.com","geoenrichqa.arcgis.com","dev.arcgis.com","devext.arcgis.com",
"localvtiles.arcgis.com","staticdev.arcgis.com","tilesdevext.arcgis.com","elevation3ddev.arcgis.com","servicesdev.arcgis.com","servicesdev1.arcgis.com","servicesdev2.arcgis.com","servicesdev3.arcgis.com","geocodedev.arcgis.com","geoenrichdev.arcgis.com","basemapsdev.arcgis.com","basemapsbetadev.arcgis.com"],corsDetection:t.cordova?!1:!0,corsDetectionTimeout:15,corsStatus:{},webTierAuthServers:[],proxyRules:[],postLength:2E3,timeout:6E4,useWorkers:"on-request",maxRequestWorkers:5,httpsDomains:"arcgis.com arcgisonline.com esrikr.com premiumservices.blackbridge.com esripremium.accuweather.com gbm.digitalglobe.com firstlook.digitalglobe.com msi.digitalglobe.com".split(" ")},
workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}}}};p.noGlobals||(t.esriConfig=v);return v})},"esri/Color":function(){define(["dojo/_base/declare","dojo/_base/Color","dojo/has","./kernel"],function(p,g,t,v){p=p([g],{declaredClass:"esri.Color"});p.toJsonColor=function(g){return g&&[g.r,g.g,g.b,1<g.a?g.a:Math.round(255*g.a)]};p.toDojoColor=function(n){return n&&new g([n[0],n[1],n[2],n[3]/255])};v="named blendColors fromRgb fromHex fromArray fromString".split(" ");for(t=0;t<v.length;t++)p[v[t]]=
g[v[t]];return p})},"esri/request":function(){define("require dojo/_base/array dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/_base/url dojo/_base/xhr dojo/request/xhr ./core/request/script dojo/request/iframe dojo/dom-construct dojo/io-query ./kernel ./config ./sniff ./lang ./urlUtils ./deferredUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){function E(a){a=new m(a);return(a.host+(a.port?":"+a.port:"")).toLowerCase()}function B(a){return this._xhr?this._xhr.getResponseHeader(a):
null}function G(b,c){var A=a.objectToQuery(b.content);A&&(b.url+=(-1===b.url.indexOf("?")?"?":"\x26")+A);if(2E3<b.url.length){if("data:"!==b.url.toLowerCase().slice(0,5))return b=new v,b.reject(n.mixin(Error(),{message:"When using responseType 'image', URL length cannot exceed 2000 characters."})),b;if(3E6<b.url.length)return b=new v,b.reject(n.mixin(Error(),{message:"When using responseType 'image', data URL length cannot exceed 3000000 characters."})),b}var e=new Image;c.allowImageDataAccess&&(e.crossOrigin=
b.withCredentials?"use-credentials":"anonymous");var f=!1,l=new v(function(d){f=!0;e.onload=e.onerror=e.onabort=null;e.src=""});c=function(d){e.onload=e.onerror=e.onabort=null;f||l.reject(Error("Unable to load the resource"))};e.onload=function(){e.onload=e.onerror=e.onabort=null;f||l.resolve(this)};e.onerror=c;e.onabort=c;e.alt="";e.src=b.url;return l}function F(x,m,A,z){var B=!1,l=!1,d=!1,h,r;q.isDefined(m)&&(n.isObject(m)?(B=!!m.useProxy,l=!!m.usePost,d=!!m.returnProgress,h=m.crossOrigin):B=!!m);
x=n.mixin({},x);x._ssl&&(x.url=x.url.replace(/^http:/i,"https:"));10>w("ie")&&!O.test(x.url)&&(x.url=encodeURI(x.url));var y=x.content,H=x.url,P=A&&x.form,F=Q;h=q.isDefined(h)?h:F.useCors;x.load=function(d){var h;d&&(d.error?(h=n.mixin(Error(),d.error),h.log=!!t.isDebug):"error"===d.status&&(h=n.mixin(Error(),d),h.log=!!t.isDebug),h&&(x.failOk=!h.log,q.isDefined(h.httpCode)||(h.httpCode=h.code)));return h||d};x.error=function(d,h){h&&h.xhr&&h.xhr.abort();d instanceof Error||(d=n.mixin(Error(),d));
d.log=!!t.isDebug;x.failOk=!d.log;F.errorHandler(d,h);return d};x._token&&(x.content=x.content||{},x.content.token=x._token);var D=0,E;y&&H&&(E=a.objectToQuery(y),D=E.length+H.length+1,w("esri-url-encodes-apostrophe")&&(D=E.replace(/'/g,"%27").length+H.length+1));x.timeout=q.isDefined(x.timeout)?x.timeout:F.timeout;x.handleAs=x.handleAs||"json";try{var p,I,K=h&&C.canUseXhr(x.url)&&!/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i.test(x.url),J=C.hasSameOrigin(x.url,window.location.href)||K,L=l||A||
D>F.postLength?!0:!1,S=J||-1===x.handleAs.indexOf("json")||!x.callbackParamName||A?!1:!0,X=C.getProxyRule(x.url)||F.alwaysUseProxy||B||!("image"===x.handleAs&&!m.allowImageDataAccess||S&&!L||J)?!0:!1;A&&!w("esri-file-upload")&&!X&&K&&(X=!0);if(X)if(p=C.getProxyUrl(H,h),I=p.path,p._xo&&(K=!0),!L&&I.length+1+D>F.postLength&&(L=!0),x.url=I+"?"+H,L)x.content=n.mixin(p.query||{},y);else{var W=a.objectToQuery(n.mixin(p.query||{},y));W&&(x.url+="?"+W);x.content=null}if(!S||L||X){var V=x.headers;!K||V&&V.hasOwnProperty("X-Requested-With")||
(V=x.headers=V||{},V["X-Requested-With"]=null);if(A){var U=x.callbackParamName||"callback.html",ra=x.callbackElementName||"textarea",pa,Ia,fa,za,Fa=P.elements?P.elements.length:0,Ma;if(y=x.content)for(pa in y.token&&-1<H.toLowerCase().indexOf("/sharing/servers/")&&(H+=(-1===H.indexOf("?")?"?":"\x26")+"token\x3d"+y.token,x.url=X?I+"?"+H:H,delete y.token),y)if(fa=y[pa],q.isDefined(fa)){Ia=null;for(za=0;za<Fa;za++)if(Ma=P.elements[za],Ma.name===pa){Ia=Ma;break}Ia?Ia.value=fa:z?P.append(pa,fa):P.appendChild(b.create("input",
{type:"hidden",name:pa,value:fa}))}if(w("esri-file-upload")){g.forEach(P.elements,function(d){d.name===U&&P.removeChild(d)});var Da=z?P:new FormData(P);if(11<=w("safari")&&"entries"in Da&&"delete"in Da){z=[];for(var Pa=Da.entries(),Ja=Pa.next();!Ja.done;){var Ta=Ja.value;Ta[1]instanceof File&&""===Ta[1].name&&z.push(Ta[0]);Ja=Pa.next()}z.forEach(function(d){Da.delete(d)})}x.contentType=!1;x.postData=Da;delete x.form}else{P.enctype="multipart/form-data";9>w("ie")&&(P.encoding="multipart/form-data");
P.method="post";g.some(P.elements,function(d){return d.name===U})||P.appendChild(b.create("input",{type:"hidden",name:U,value:ra}));if(-1!==H.toLowerCase().indexOf("addattachment")||-1!==H.toLowerCase().indexOf("updateattachment"))H+=(-1===H.indexOf("?")?"?":"\x26")+U+"\x3d"+ra,x.url=X?I+"?"+H:H;delete x.content}}if(K&&!x.hasOwnProperty("withCredentials")&&"with-credentials"===Q.useCors){var H=X?I:H,ca=C.canUseXhr(H,!0),Ga=-1<ca?Q.corsEnabledServers[ca]:null;if(Ga&&Ga.hasOwnProperty("withCredentials"))Ga.withCredentials&&
(x.withCredentials=!0);else if(c.id){var Oa=c.id.findServerInfo(H);Oa&&Oa.webTierAuth&&(x.withCredentials=!0)}}x=M?M(x):x;if("image"===x.handleAs)return G(x,m);if(L){if(A&&!w("esri-file-upload")){r=new v(function(){ja.cancel()});var ja=e.post(x.url,x).then(function(d){r.resolve(d)}).otherwise(function(d){r.reject(d)});r.addCallback(function(d){return x.load(d)});r.addErrback(function(d){return x.error(d)});return r}!X&&w("safari")&&(x.url+=(-1===x.url.indexOf("?")?"?":"\x26")+"_ts\x3d"+(new Date).getTime()+
T++);if(d){x.uploadProgress=!0;x.data=x.postData;x.query=x.content;r=new v(function(){Ua.cancel()});var Ua=k.post(x.url,x).then(function(d){r.resolve(d)},function(d){r.reject(d)},function(d){r.progress({transferType:d.transferType,loaded:d.loaded,total:d.total})});r.addCallback(function(d){return x.load(d)});r.addErrback(function(d){return x.error(d)});return r}return u.post(x)}return u.get(x)}x=M?M(x):x;x.jsonp=x.callbackParamName;x.query=x.content;r=new v(function(){Qa.cancel()});var Qa=f.get(x.url,
x).then(function(d){r.resolve(d)}).otherwise(function(d){r.reject(d)});r.addCallback(function(d){return x.load(d)});r.addErrback(function(d){return x.error(d)});return r}catch(na){return r=new v,r.errback(x.error(na)),r}}function D(a){var b=Q.corsStatus,A=C.canUseXhr(a,!0);-1<A&&Q.corsEnabledServers.splice(A,1);var c=new v;c.reject({log:!!t.isDebug});b[E(a)]=c.promise;return A}function I(a){var b=Q.corsStatus;try{var A=E(a);if(Q.corsDetection&&Q.useCors&&w("esri-cors")&&a&&-1!==a.toLowerCase().indexOf("/rest/services")&&
!C.hasSameOrigin(a,window.location.href)&&!C.canUseXhr(a)){if(b[A]&&!b[A].isCanceled())return b[A];var c=new v(z._dfdCanceller);b[A]=c.promise;var e=u.get({url:a.substring(0,a.toLowerCase().indexOf("/rest/")+6)+"info",content:{f:"json"},failOk:!0,handleAs:"json",headers:{"X-Requested-With":null},timeout:1E3*Q.corsDetectionTimeout});c._pendingDfd=e;e.then(function(l){l?(C.canUseXhr(a)||Q.corsEnabledServers.push(A),c.resolve()):c.reject()},function(l){c.reject(l)});return c.promise}}catch(l){console.log("esri._detectCors: an unknown error occurred while detecting CORS support")}return W}
function K(a,b,A,e){function f(h){h._pendingDfd=F(A,e,x,H);if(!h._pendingDfd){h.ioArgs=h._pendingDfd&&h._pendingDfd.ioArgs;var l=Error("Deferred object is missing");l.log=!!t.isDebug;h.errback(l);h._pendingDfd=null;return h}h._pendingDfd.addCallback(function(d){if(!d)return d;var l=h._pendingDfd&&h._pendingDfd.ioArgs&&h._pendingDfd.ioArgs.xhr;if(!l)return d;if(l=l.getResponseHeader("Content-Type"))if(l=l.toLowerCase(),-1===l.indexOf("text/plain")&&-1===l.indexOf("application/json"))return d;if(d instanceof
ArrayBuffer&&750>=d.byteLength)l=new Blob([d]);else if(d instanceof Blob&&750>=d.size)l=d;else return d;var r=new v,y=new FileReader;y.readAsText(l);y.onloadend=function(){var h;if(!y.error)try{var l=JSON.parse(y.result);l.error&&(h=l.error)}catch(Ea){}h?(h=n.mixin(Error(),h),h.log=!!t.isDebug,null==h.httpCode&&(h.httpCode=h.code),r.reject(h)):r.resolve(d)};return r.promise}).addCallback(function(d){h.ioArgs=h._pendingDfd&&h._pendingDfd.ioArgs;e.returnFullResponse&&(d={data:d,_xhr:h.ioArgs&&h.ioArgs.xhr,
getHeader:B});h.callback(d);h._pendingDfd=null}).addErrback(function(l){var r,y,a;l&&(r=l.code,y=l.subcode,a=(a=l.messageCode)&&a.toUpperCase());if(l&&403==r&&(4==y||l.message&&-1<l.message.toLowerCase().indexOf("ssl")&&-1===l.message.toLowerCase().indexOf("permission"))){if(!A._ssl){A._ssl=A._sslFromServer=!0;K(h,!0,A,e);return}}else if(l&&415==l.status){if(D(A.url),!A._err415){A._err415=1;K(h,!0,A,e);return}}else if(c.id&&-1!==g.indexOf(c.id._errorCodes,r)&&!c.id._isPublic(A.url)&&!d&&(403!=r||
-1===g.indexOf(S,a)&&(!q.isDefined(y)||2==y&&A._token))){h._pendingDfd=c.id.getCredential(A.url,{token:A._token,error:l});h._pendingDfd.addCallback(function(d){A._token=d.token;A._credential=d;A._ssl=A._sslFromServer||d.ssl;K(h,!0,A,e)}).addErrback(function(d){h.errback(d);h._pendingDfd=null});return}h.ioArgs=h._pendingDfd&&h._pendingDfd.ioArgs;h.isFulfilled()||h.errback(l);h._pendingDfd=null}).then(null,null,function(d){h.progress(d)})}var l=A.form,d=e.disableIdentityLookup,h=e._preLookup,r=!1;if(w("esri-workers")&&
!1!==Q.useWorkers)if(!0===e.useWorkers||!0===Q.useWorkers)r=!0;else if(e.workerOptions){var y=e.workerOptions;if(y.callback||y.worker&&y.worker.worker instanceof Worker)r=!0}var H=l&&w("esri-file-upload")&&l instanceof FormData,x=l&&(l.elements?g.some(l.elements,function(d){return"file"===d.type}):H),k=-1!==A.url.toLowerCase().indexOf("token\x3d")||A.content&&A.content.token||x&&g.some(l.elements,function(d){return"token"===d.name})?1:0;if(!b){a.addCallback(function(d){if((/\/sharing\/rest\/accounts\/self/i.test(A.url)||
/\/sharing\/rest\/portals\/self/i.test(A.url))&&!k&&!A._token&&d.user&&d.user.username){Q.webTierAuthServers.push(E(A.url));d=Q.corsEnabledServers;var h=C.canUseXhr(A.url,!0),l={host:E(A.url),withCredentials:!0};if(-1===h)d.push(l);else{var r=d[h];r instanceof RegExp?(l.host=r,d.splice(h,1,l)):"object"===typeof r?r.withCredentials=!0:d.splice(h,1,l)}}if(d=A._credential)if(h=(h=c.id.findServerInfo(d.server))&&h.owningSystemUrl)h=h.replace(/\/?$/,"/sharing"),(d=c.id.findCredential(h,d.userId))&&-1===
c.id._getIdenticalSvcIdx(h,d)&&d.resources.splice(0,0,h)});a.addBoth(function(d){delete A._credential;!d||w("ie")&&d.nodeType||(d._ssl=A._ssl)});var m=A.load,z=A.error;m&&a.addCallback(function(d){var h=a._pendingDfd,h=h&&h.ioArgs;return m.call(h&&h.args,d,h)});z&&a.addErrback(function(d){var h=a._pendingDfd,h=h&&h.ioArgs;return z.call(h&&h.args,d,h)})}!c.id||k||A._token||c.id._isPublic(A.url)||d&&!h||!(b=c.id.findCredential(A.url))||(A._token=b.token,A._ssl=b.ssl);r?e.workerOptions&&e.workerOptions.worker?
(L||(L=u),u=e.workerOptions.worker,f(a)):p(["./workers/RequestClient"],function(d){L||(L=u);if(e.workerOptions){var h=e.workerOptions;u=d.getClient(h.callback,h.cbFunction)}else u=d.getClient();f(a)}):(L&&(u=L,L=null),f(a));return a}function J(a,b){a.url=C.fixUrl(a.url);b=b||{};var A=new v(z._dfdCanceller),c=I(a.url);A._pendingDfd=c;c.always(function(c){c&&"cancel"===c.dojoType?A.reject(c):K(A,!1,a,b)});return A}var L=null,M,Q=x.defaults.io,S=["COM_0056","COM_0057"],T=0,O=/%[0-9A-F]{2}/i,W=function(){var a=
new v;a.resolve();return a.promise}();J._makeRequest=F;J._processRequest=K;J._disableCors=D;J._detectCors=I;J.setRequestPreCallback=function(a){M=a};return J})},"esri/core/request/script":function(){define("require exports dojo/Deferred dojo/request/script dojo/text!./iframe.html ../sniff".split(" "),function(p,g,t,v,n,m){function u(){var a=document.createElement("iframe");a.name="esri_core_jsonp_iframe";a.style.display="none";a.setAttribute("sandbox","allow-scripts");if(!m("ff")&&"srcdoc"in a){var b=
p.toUrl("dojo/dojo.js"),c=n.replace("../../../dojo/dojo.js",b),b=b.slice(0,-7),c=c.replace("../../../dojo/",b);a.srcdoc=c}else c=p.toUrl("./iframe.html"),"http:"===window.location.protocol&&0===c.indexOf("https:")&&(c=c.replace("https:","http:")),a.src=c;document.body.appendChild(a);return a}function k(){var a=new MessageChannel;a.port1.addEventListener("message",f);a.port1.start();return a}function f(a){var e=a.data;if("ready"===e){for(var e=0,f=w;e<f.length;e++)a=f[e],b(a,c);w=null}else if(a=q[e.id])delete q[e.id],
e.isError?a.dfd.reject(Error(e.message)):a.dfd.resolve(e.response)}function e(a,b){a.addEventListener("load",function(){a.contentWindow.postMessage("init","*",[b.port2])})}function b(a,b){q[a.message.id]=a;b.port1.postMessage(a.message)}Object.defineProperty(g,"__esModule",{value:!0});var a,c,x=0,w=[],q={};g.get=function(f,z){if(!m("esri-script-sandbox"))return v.get(f,z);var g=null;z&&(g={jsonp:z.jsonp,preventCache:z.preventCache,query:z.query,timeout:z.timeout});z=new t(function(){if(w){var a=w.indexOf(B);
-1<a&&w.splice(a,1)}else B.message.id in q&&delete q[B.message.id]});var B={dfd:z,message:{id:"id"+(++x+Math.random()),url:f,options:g}};a||(a=u(),c=k(),e(a,c));w?w.push(B):b(B,c);return z.promise}})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(p,g,t,v){var n;n=function(e,b,a){v(e,{sync:!!b,headers:{"X-Requested-With":null}}).then(a)};var m={},u=function(e){if(e){e=e.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var b=e.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);
b&&(e=b[1])}else e="";return e},k={},f={};p.cache=function(e,b,a){var c;"string"==typeof e?/\//.test(e)?(c=e,a=b):c=g.toUrl(e.replace(/\./g,"/")+(b?"/"+b:"")):(c=e+"",a=b);e=void 0!=a&&"string"!=typeof a?a.value:a;a=a&&a.sanitize;if("string"==typeof e)return m[c]=e,a?u(e):e;if(null===e)return delete m[c],null;c in m||n(c,!0,function(a){m[c]=a});return a?u(m[c]):m[c]};return{dynamic:!0,normalize:function(e,b){e=e.split("!");var a=e[0];return(/^\./.test(a)?b(a):a)+(e[1]?"!"+e[1]:"")},load:function(e,
b,a){e=e.split("!");var c=1<e.length,x=e[0],w=b.toUrl(e[0]);e="url:"+w;var q=k,g=function(b){a(c?u(b):b)};x in m?q=m[x]:b.cache&&e in b.cache?q=b.cache[e]:w in m&&(q=m[w]);if(q===k)if(f[w])f[w].push(g);else{var z=f[w]=[g];n(w,!b.async,function(a){m[x]=m[w]=a;for(var b=0;b<z.length;)z[b++](a);delete f[w]})}else g(q)}}})},"dojo/request":function(){define(["./request/default!"],function(p){return p})},"dojo/request/default":function(){define(["exports","require","../has"],function(p,g,t){var v=t("config-requestProvider");
v||(v="./xhr");p.getPlatformDefaultId=function(){return"./xhr"};p.load=function(n,m,u,k){g(["platform"==n?"./xhr":v],function(f){u(f)})}})},"esri/core/sniff":function(){define(["../sniff"],function(p){return p})},"esri/sniff":function(){define(["dojo/_base/sniff","dojo/global","./kernel"],function(p,g,t){var v=p("ff"),n=p("ie"),m=void 0===n&&7<=p("trident"),u=p("edge"),k=p("webkit"),f=p("opera"),e=p("chrome"),b=p("safari"),a=navigator.userAgent,c;(c=a.match(/(iPhone|iPad|CPU)\s+OS\s+(\d+\_\d+)/i))&&
p.add("esri-iphone",parseFloat(c[2].replace("_",".")));(c=a.match(/Android\s+(\d+(\.\d+)*)/i))&&p.add("esri-android",parseFloat(c[1]));(c=a.match(/Fennec\/(\d+\.\d+)/i))&&p.add("esri-fennec",parseFloat(c[1]));0<=a.indexOf("BlackBerry")&&0<=a.indexOf("WebKit")&&p.add("esri-blackberry",1);p.add("esri-touch",p("esri-iphone")||p("esri-android")||p("esri-blackberry")||6<=p("esri-fennec")||(v||k)&&(document.createTouch||"ontouchstart"in g||g.TouchEvent&&0<navigator.maxTouchPoints)?!0:!1);(c=a.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i))&&
p.add("esri-mobile",!!c);p.add("esri-pointer",navigator.pointerEnabled||navigator.msPointerEnabled||!(!u||!g.PointerEvent));t._getDOMAccessor=function(a){var b="";v?b="Moz":k?b="Webkit":n?b="ms":f&&(b="O");return b+a.charAt(0).toUpperCase()+a.substr(1)};p.add("esri-phonegap",!!g.cordova);p.add("esri-cors",p("esri-phonegap")||g.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest);p.add("esri-file-upload",g.FormData&&g.FileList?!0:!1);p.add("esri-script-sandbox",function(){return"MessageChannel"in
g&&"HTMLIFrameElement"in g&&"sandbox"in HTMLIFrameElement.prototype});p.add("esri-secure-context",function(){if("isSecureContext"in g)return g.isSecureContext;if(g.location&&g.location.origin)return 0===g.location.origin.indexOf("https:")});p.add("esri-wasm","WebAssembly"in g);p.add("esri-workers",g.Worker?!0:!1);p.add("esri-featurelayer-webgl",!1);if(a=p("esri-featurelayer-webgl")){var x=p("esri-mobile");c=x?1:2;x=x?1:3;"object"===typeof a?(a.maxDrillLevel=null==a.maxDrillLevel?c:a.maxDrillLevel,
a.maxRecordCountFactor=null==a.maxRecordCountFactor?x:a.maxRecordCountFactor,a.enablePBFQuery=null==a.enablePBFQuery?!0:a.enablePBFQuery):p.add("esri-featurelayer-webgl",{maxDrillLevel:c,maxRecordCountFactor:x,enablePBFQuery:!0},null,!0)}p.add("esri-featurelayer-webgl-labeling",!1);p.add("esri-pbf",!n||10<=n);p.add("esri-featurelayer-pbf",!0);p.add("esri-transforms",m||u||9<=n||3.5<=v||4<=e||3.1<=b||10.5<=f||3.2<=p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transitions",m||u||10<=n||4<=v||
4<=e||3.1<=b||10.5<=f||3.2<=p("esri-iphone")||2.1<=p("esri-android"));p.add("esri-transforms3d",m||u||10<=v||12<=e||4<=b||3.2<=p("esri-iphone")||3<=p("esri-android"));p.add("esri-url-encodes-apostrophe",function(){if(!g.document)return!1;var a=g.document.createElement("a");a.href="?'";return-1<a.href.indexOf("?%27")});3>p("esri-android")&&(p.add("esri-transforms",!1,!1,!0),p.add("esri-transitions",!1,!1,!0),p.add("esri-transforms3d",!1,!1,!0));p.add("esri-will-change",p("esri-transforms")&&(52<=e||
11.1<=b));t._css=function(a){var c=p("esri-transforms3d");void 0!==a&&null!==a?c=a:c&&(e||b&&!p("esri-iphone"))&&(c=!1);var w=c?"translate3d(":"translate(",x=c?e?",-1px)":",0px)":")",m=c?"scale3d(":"scale(",u=c?",1)":")",g=c?"rotate3d(0,0,1,":"rotate(",F=c?"matrix3d(":"matrix(",D=c?",0,0,":",",I=c?",0,0,0,0,1,0,":",",t=c?",0,1)":")";return{names:{transition:k&&"-webkit-transition"||v&&"MozTransition"||f&&"OTransition"||n&&"msTransition"||"transition",transform:k&&"-webkit-transform"||v&&"MozTransform"||
f&&"OTransform"||n&&"msTransform"||"transform",transformName:k&&"-webkit-transform"||v&&"-moz-transform"||f&&"-o-transform"||n&&"-ms-transform"||"transform",origin:k&&"-webkit-transform-origin"||v&&"MozTransformOrigin"||f&&"OTransformOrigin"||n&&"msTransformOrigin"||"transformOrigin",endEvent:k&&"webkitTransitionEnd"||v&&"transitionend"||f&&"oTransitionEnd"||n&&"MSTransitionEnd"||"transitionend"},translate:function(a,b){return w+a+"px,"+b+"px"+x},scale:function(a){return m+a+","+a+u},rotate:function(a){return g+
a+"deg)"},matrix:function(a){return F+a.xx+","+a.xy+D+a.yx+","+a.yy+I+a.dx.toFixed(10)+(v&&59>=v?"px,":",")+a.dy.toFixed(10)+(v&&59>=v?"px":"")+t},getScaleFromMatrix:function(a){if(!a)return 1;a=a.toLowerCase();var b=-1<a.indexOf("matrix3d")?"matrix3d(":"matrix(";return Number(a.substring(b.length,a.indexOf(",")))}}};return p})},"dojo/request/iframe":function(){define("module require ./watch ./util ./handlers ../_base/lang ../io-query ../query ../has ../dom ../dom-construct ../_base/window ../NodeList-dom ../NodeList-manipulate".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){function c(a){return!this.isFulfilled()}function x(a){return!!this._finished}function w(a,b){if(!b)try{var c=a.options,e=C.doc(C._frame),f=c.handleAs;if("html"!==f){if("xml"===f)if("html"===e.documentElement.tagName.toLowerCase()){k("a",e.documentElement).orphan();var q=e.documentElement.innerText||e.documentElement.textContent,q=q.replace(/>\s+</g,"\x3e\x3c");a.text=m.trim(q)}else a.data=e;else a.text=e.getElementsByTagName("textarea")[0].value;n(a)}else a.data=
e}catch(L){b=L}b?this.reject(b):this._finished?this.resolve(a):this.reject(Error("Invalid dojo/request/iframe request state"))}function q(a){this._callNext()}function C(a,b,e){var f=v.parseArgs(a,v.deepCreate(B,b),!0);a=f.url;b=f.options;if("GET"!==b.method&&"POST"!==b.method)throw Error(b.method+" not supported by dojo/request/iframe");C._frame||(C._frame=C.create(C._iframeName,E+"();"));a=v.deferred(f,null,c,x,w,q);a._callNext=function(){this._calledNext||(this._calledNext=!0,C._currentDfd=null,
C._fireNextRequest())};a._legacy=e;C._dfdQueue.push(a);C._fireNextRequest();t(a);return e?a:a.promise}var z=p.id.replace(/[\/\.\-]/g,"_"),E=z+"_onload";a.global[E]||(a.global[E]=function(){var a=C._currentDfd;if(a){var c=e.byId(a.response.options.form)||a._tmpForm;if(c){for(var f=a._contentToClean,q=0;q<f.length;q++)for(var w=f[q],x=0;x<c.childNodes.length;x++){var k=c.childNodes[x];if(k.name===w){b.destroy(k);break}}a._originalAction&&c.setAttribute("action",a._originalAction);a._originalMethod&&
(c.setAttribute("method",a._originalMethod),c.method=a._originalMethod);a._originalTarget&&(c.setAttribute("target",a._originalTarget),c.target=a._originalTarget)}a._tmpForm&&(b.destroy(a._tmpForm),delete a._tmpForm);a._finished=!0}else C._fireNextRequest()});var B={method:"POST"};C.create=function(c,e,q){if(a.global[c])return a.global[c];if(a.global.frames[c])return a.global.frames[c];q||(f("config-useXDomain")&&!f("config-dojoBlankHtmlUrl")&&console.warn("dojo/request/iframe: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set dojoConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
q=f("config-dojoBlankHtmlUrl")||g.toUrl("dojo/resources/blank.html"));e=b.place('\x3ciframe id\x3d"'+c+'" name\x3d"'+c+'" src\x3d"'+q+'" onload\x3d"'+e+'" style\x3d"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden"\x3e',a.body());return a.global[c]=e};C.doc=function(b){if(b.contentDocument)return b.contentDocument;var c=b.name;if(c){var e=a.doc.getElementsByTagName("iframe");if(b.document&&e[c].contentWindow&&e[c].contentWindow.document)return e[c].contentWindow.document;
if(a.doc.frames[c]&&a.doc.frames[c].document)return a.doc.frames[c].document}return null};C.setSrc=function(b,c,e){b=a.global.frames[b.name];b.contentWindow&&(b=b.contentWindow);try{e?b.location.replace(c):b.location=c}catch(I){console.log("dojo/request/iframe.setSrc: ",I)}};C._iframeName=z+"_IoIframe";C._notifyStart=function(){};C._dfdQueue=[];C._currentDfd=null;C._fireNextRequest=function(){var c;try{if(!C._currentDfd&&C._dfdQueue.length){do c=C._currentDfd=C._dfdQueue.shift();while(c&&(c.canceled||
c.isCanceled&&c.isCanceled())&&C._dfdQueue.length);if(!c||c.canceled||c.isCanceled&&c.isCanceled())C._currentDfd=null;else{var f=c.response,q=f.options,w=c._contentToClean=[],x=e.byId(q.form),g=v.notify,B=q.data||null,n;c._legacy||"POST"!==q.method||x?"GET"===q.method&&x&&-1<f.url.indexOf("?")&&(n=f.url.slice(f.url.indexOf("?")+1),B=m.mixin(u.queryToObject(n),B)):x=c._tmpForm=b.create("form",{name:z+"_form",style:{position:"absolute",top:"-1000px",left:"-1000px"}},a.body());if(x){if(!c._legacy){var E=
x;do E=E.parentNode;while(E&&E!==a.doc.documentElement);E||(x.style.position="absolute",x.style.left="-1000px",x.style.top="-1000px",a.body().appendChild(x));x.name||(x.name=z+"_form")}if(B){var E=function(a,c){b.create("input",{type:"hidden",name:a,value:c},x);w.push(a)},p;for(p in B){var t=B[p];if(m.isArray(t)&&1<t.length)for(n=0;n<t.length;n++)E(p,t[n]);else{var O=k("input[name\x3d'"+p+"']",x);-1==O.indexOf()?E(p,t):O.val(t)}}}var W=x.getAttributeNode("action"),U=x.getAttributeNode("method"),V=
x.getAttributeNode("target");f.url&&(c._originalAction=W?W.value:null,W?W.value=f.url:x.setAttribute("action",f.url));c._legacy?U&&U.value||(U?U.value=q.method:x.setAttribute("method",q.method)):(c._originalMethod=U?U.value:null,U?U.value=q.method:x.setAttribute("method",q.method));c._originalTarget=V?V.value:null;V?V.value=C._iframeName:x.setAttribute("target",C._iframeName);x.target=C._iframeName;g&&g.emit("send",f,c.promise.cancel);C._notifyStart(f);x.submit()}else q="",f.options.data&&(q=f.options.data,
"string"!==typeof q&&(q=u.objectToQuery(q))),E=f.url+(-1<f.url.indexOf("?")?"\x26":"?")+q,g&&g.emit("send",f,c.promise.cancel),C._notifyStart(f),C.setSrc(C._frame,E,!0)}}}catch(A){c.reject(A)}};v.addCommonMethods(C,["GET","POST"]);return C})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(p,g,t,v,n){function m(f){for(;f.childNodes[0]&&1==f.childNodes[0].nodeType;)f=f.childNodes[0];return f}function u(f,
e){"string"==typeof f?(f=v.toDom(f,e&&e.ownerDocument),11==f.nodeType&&(f=f.childNodes[0])):1==f.nodeType&&f.parentNode&&(f=f.cloneNode(!1));return f}var k=p.NodeList;g.extend(k,{_placeMultiple:function(f,e){f="string"==typeof f||f.nodeType?p(f):f;for(var b=[],a=0;a<f.length;a++)for(var c=f[a],x=this.length,w=x-1,q;q=this[w];w--)0<a&&(q=this._cloneNode(q),b.unshift(q)),w==x-1?v.place(q,c,e):c.parentNode.insertBefore(q,c),c=q;b.length&&(b.unshift(0),b.unshift(this.length-1),Array.prototype.splice.apply(this,
b));return this},innerHTML:function(f){return arguments.length?this.addContent(f,"only"):this[0].innerHTML},text:function(f){if(arguments.length){for(var e=0,b;b=this[e];e++)1==b.nodeType&&n.set(b,"textContent",f);return this}for(var a="",e=0;b=this[e];e++)a+=n.get(b,"textContent");return a},val:function(f){if(arguments.length){for(var e=g.isArray(f),b=0,a;a=this[b];b++){var c=a.nodeName.toUpperCase(),x=a.type,w=e?f[b]:f;if("SELECT"==c)for(c=a.options,x=0;x<c.length;x++){var q=c[x];q.selected=a.multiple?
-1!=t.indexOf(f,q.value):q.value==w}else"checkbox"==x||"radio"==x?a.checked=a.value==w:a.value=w}return this}if((a=this[0])&&1==a.nodeType){f=a.value||"";if("SELECT"==a.nodeName.toUpperCase()&&a.multiple){f=[];c=a.options;for(x=0;x<c.length;x++)q=c[x],q.selected&&f.push(q.value);f.length||(f=null)}return f}},append:function(f){return this.addContent(f,"last")},appendTo:function(f){return this._placeMultiple(f,"last")},prepend:function(f){return this.addContent(f,"first")},prependTo:function(f){return this._placeMultiple(f,
"first")},after:function(f){return this.addContent(f,"after")},insertAfter:function(f){return this._placeMultiple(f,"after")},before:function(f){return this.addContent(f,"before")},insertBefore:function(f){return this._placeMultiple(f,"before")},remove:k.prototype.orphan,wrap:function(f){if(this[0]){f=u(f,this[0]);for(var e=0,b;b=this[e];e++){var a=this._cloneNode(f);b.parentNode&&b.parentNode.replaceChild(a,b);m(a).appendChild(b)}}return this},wrapAll:function(f){if(this[0]){f=u(f,this[0]);this[0].parentNode.replaceChild(f,
this[0]);f=m(f);for(var e=0,b;b=this[e];e++)f.appendChild(b)}return this},wrapInner:function(f){if(this[0]){f=u(f,this[0]);for(var e=0;e<this.length;e++){var b=this._cloneNode(f);this._wrap(g._toArray(this[e].childNodes),null,this._NodeListCtor).wrapAll(b)}}return this},replaceWith:function(f){f=this._normalize(f,this[0]);for(var e=0,b;b=this[e];e++)this._place(f,b,"before",0<e),b.parentNode.removeChild(b);return this},replaceAll:function(f){f=p(f);for(var e=this._normalize(this,this[0]),b=0,a;a=
f[b];b++)this._place(e,a,"before",0<b),a.parentNode.removeChild(a);return this},clone:function(){for(var f=[],e=0;e<this.length;e++)f.push(this._cloneNode(this[e]));return this._wrap(f,this,this._NodeListCtor)}});k.prototype.html||(k.prototype.html=k.prototype.innerHTML);return k})},"esri/urlUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/url dojo/global dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(p,g,t,v,n,m,u,k,f,e){var b={},a=
k.defaults.io,c=/^[a-z][a-z0-9\+\-\.]*:/i,x=/^\s*http:/i,w=/^\s*https:/i,q=/:\d+$/,C=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i;b.isHTTP=function(a){var b=v.location.protocol;return null==a?"http:"===b||"https:"===b:a?"https:"===b:"http:"===b};b.getProtocolForWebResource=function(a){return b.isHTTP()?v.location.protocol:a?"https:":"http:"};b.urlToObject=function(a){var b={},c=new t(a),e=a.indexOf("?");null===c.query?b={path:a,query:null}:(b.path=a.substring(0,e),b.query=n.queryToObject(c.query));
c.fragment&&(b.hash=c.fragment,null===c.query&&(b.path=b.path.substring(0,b.path.length-(c.fragment.length+1))));return b};b.getProxyUrl=function(c,f){var q=p.isString(c)?0===p.trim(c).toLowerCase().indexOf("https:"):c,w=a.proxyUrl,x,k=e.io.proxyNotSet;p.isString(c)&&(c=b.getProxyRule(c))&&(w=c.proxyUrl);if(!w)throw console.log(k),Error(k);q&&!1!==f&&0!==v.location.href.toLowerCase().indexOf("https:")&&(f=w,0!==f.toLowerCase().indexOf("http")&&(f=b.getAbsoluteUrl(f)),f=f.replace(/^http:/i,"https:"),
b.canUseXhr(f)&&(w=f,x=1));w=b.urlToObject(w);w._xo=x;return w};b.addProxy=function(c){var e=b.getProxyRule(c),f;e?f=b.urlToObject(e.proxyUrl):a.alwaysUseProxy&&(f=b.getProxyUrl());f&&(e=b.urlToObject(c),c=f.path+"?"+e.path,(f=n.objectToQuery(p.mixin(f.query||{},e.query)))&&(c+="?"+f));return c};b.addProxyRule=function(c){var e=c.urlPrefix=b.urlToObject(c.urlPrefix).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),f=a.proxyRules,q,w=f.length,x,k=w;for(q=0;q<w;q++)if(x=f[q].urlPrefix,
0===e.indexOf(x)){if(e.length===x)return-1;k=q;break}else 0===x.indexOf(e)&&(k=q+1);f.splice(k,0,c);return k};b.getProxyRule=function(c){var e=a.proxyRules,f=e.length,q=b.urlToObject(c).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),w;for(c=0;c<f;c++)if(0===q.indexOf(e[c].urlPrefix)){w=e[c];break}return w};b.hasSameOrigin=function(a,b,c){a=a.toLowerCase();b=b.toLowerCase();var e=v.location.href.toLowerCase();a=0===a.indexOf("http")?new t(a):e=new t(e);b=0===b.indexOf("http")?
new t(b):p.isString(e)?new t(e):e;return(c||a.scheme===b.scheme)&&a.host===b.host&&a.port===b.port};b.canUseXhr=function(c,e){var q=f("esri-phonegap")?!0:!1,w=b.hasSameOrigin,x=a.corsEnabledServers,k,m=-1;!q&&f("esri-cors")&&x&&x.length&&(q=g.some(x,function(a,b){a=!a||"object"!==typeof a||a instanceof RegExp?a:a.host;if(a instanceof RegExp){if(a.test(c))return m=b,!0}else if(a&&(k=0!==a.trim().toLowerCase().indexOf("http"),w(c,k?"http://"+a:a)||k&&w(c,"https://"+a)))return m=b,!0;return!1}));return e?
m:q};b.getAbsoluteUrl=function(a){var e=b.getProtocolForWebResource();return p.isString(a)&&!c.test(a)?0===a.indexOf("//")?e+a:0===a.indexOf("/")?e+"//"+v.location.host+a:m._appBaseUrl+a:a};b.fixUrl=function(a){a=p.trim(a);a=b.getAbsoluteUrl(a);a=b.normalizeSlashes(a);a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2");a=b.downgradeToHTTP(a);return a=b.upgradeToHTTPS(a)};b.normalize=function(a){return b.fixUrl(a)};b.normalizeSlashes=function(a){if(/^https?:\/\//i.test(a)){var b,c,e=a.indexOf("?");
-1<e?(b=a.slice(0,e),c=a.slice(e+1)):b=a;a=b.replace(/\/{2,}/g,"/");a=a.replace("/","//");c&&(a+="?"+c)}return a};b.downgradeToHTTP=function(a){return b.isHTTP(!1)&&w.test(a)&&b.hasSameOrigin(v.location.href,a,!0)&&!b.canUseXhr(a)?a.replace(w,"http:"):a};b.upgradeToHTTPS=function(c){var e=a.httpsDomains,f=b.isHTTP(!1),w=b.isHTTP(!0);if(!x.test(c))return c;c=p.trim(c);var k=c.indexOf("/",7),k=-1===k?c:c.slice(0,k),k=k.toLowerCase().slice(7);if(q.test(k))if(u.endsWith(k,":80"))k=k.slice(0,-3),c=c.replace(":80",
"");else return c;if(f&&k===v.location.host&&(!C.test(c)||!b.canUseXhr(c)))return c;f=!1;if(w&&k===v.location.host)f=!0;else if(e)for(var m=0;m<e.length;m++){var g=e[m];if(k===g||u.endsWith(k,"."+g)){f=!0;break}}f||!w||a.alwaysUseProxy||b.getProxyRule(c)||(f=!0);f&&(c=c.replace(x,"https:"));return c};return b})},"esri/deferredUtils":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(p,g,t){return{_dfdCanceller:function(g){g.canceled=!0;var n=g._pendingDfd,m;g.isFulfilled()||!n||
n.isFulfilled()||(n.cancel(),m=n.results&&n.results[1]);g._pendingDfd=null;return m},_fixDfd:function(g){var n=g.then;g.then=function(m,u,k){if(m){var f=m;m=function(e){return e&&e._argsArray?f.apply(null,e):f(e)}}return n.call(this,m,u,k)};return g},_resDfd:function(g,n,m){var u=n.length;1===u?m?g.errback(n[0]):g.callback(n[0]):1<u?(n._argsArray=!0,g.callback(n)):g.callback()}}})},"esri/SpatialReference":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/has","./kernel","./lang"],function(p,
g,t,v,n){function m(){}t=[-2.0037508342788905E7,2.0037508342788905E7];v=[-2.0037508342787E7,2.0037508342787E7];p=p(null,{declaredClass:"esri.SpatialReference",constructor:function(m){m&&(n.isObject(m)?n.mixin(this,m):n.isString(m)?this.wkt=m:this.wkid=m)},wkid:null,wkt:null,_info:{102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:t,origin:v,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:t,origin:v,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:t,origin:v,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:t,origin:v,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",${Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",${Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}},_isWebMercator:function(){return-1!==g.indexOf([102113,102100,3857,3785],this.wkid)},_isWrappable:function(){return-1!==g.indexOf([102113,102100,3857,3785,4326],this.wkid)},_getInfo:function(){return this.wkid?this._info[this.wkid]:null},_canProject:function(m){var k=!1;m&&(k=this.isWebMercator()&&4326===m.wkid||m.isWebMercator()&&4326===this.wkid);return k},isWebMercator:function(){return this._isWebMercator()},equals:function(m){var k=!1;m&&(this===m&&
(k=!0),this.wkid||m.wkid?k=this.wkid===m.wkid||this.isWebMercator()&&m.isWebMercator()||this.wkid===m.latestWkid||m.wkid===this.latestWkid:this.wkt&&m.wkt&&(k=this.wkt.toUpperCase()===m.wkt.toUpperCase()));return k},toJson:function(){var m=null;null!=this.wkid?m={wkid:this.wkid}:null!=this.wkt&&(m={wkt:this.wkt});m&&null!=this.latestWkid&&(m.latestWkid=this.latestWkid);return m}});m.prototype=p.prototype;p.simpleConstructor=m;return p})},"esri/map":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/event dojo/on dojo/aspect dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/a11yclick dijit/registry ./kernel ./config ./sniff ./lang ./_coremap ./MapNavigationManager dojo/i18n!./nls/jsapi".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I){var K={up:"panUp",right:"panRight",down:"panDown",left:"panLeft"},J={upperRight:"panUpperRight",lowerRight:"panLowerRight",lowerLeft:"panLowerLeft",upperLeft:"panUpperLeft"},L=v.connect,M=v.disconnect,Q=c.create,S=w.set,T=n.hitch,O=x.getMarginBox,W=g.deprecated,U=n.mixin,V=0;return t(F,{declaredClass:"esri.Map",constructor:function(a,b){b=b||{};U(this,{_slider:null,_navDiv:null,_mapParams:U({attributionWidth:.45,slider:!0,nav:!1,logo:!0,sliderStyle:"small",
sliderPosition:"top-left",sliderOrientation:"vertical",autoResize:!0},b)});U(this,{isMapNavigation:null!=b.isMapNavigation?b.isMapNavigation:!0,isDoubleClickZoom:null!=b.isDoubleClickZoom?b.isDoubleClickZoom:!0,isClickRecenter:null!=b.isClickRecenter?b.isClickRecenter:!0,isPan:null!=b.isPan?b.isPan:!0,isRubberBandZoom:null!=b.isRubberBandZoom?b.isRubberBandZoom:!0,isPinchZoom:null!=b.isPinchZoom?b.isPinchZoom:!0,isKeyboardNavigation:null!=b.isKeyboardNavigation?b.isKeyboardNavigation:!0,isScrollWheel:null!=
b.isScrollWheel?b.isScrollWheel:!0,isShiftDoubleClickZoom:!1,isScrollWheelZoom:!1,isPanArrows:!1,isZoomSlider:!1});n.isFunction(z._css)&&(z._css=z._css(this._mapParams.force3DTransforms),this.force3DTransforms=this._mapParams.force3DTransforms);a=B("esri-transforms")&&B("esri-transitions");this.navigationMode=this._mapParams.navigationMode||a&&"css-transforms"||"classic";"css-transforms"!==this.navigationMode||a||(this.navigationMode="classic");this.fadeOnZoom=G.isDefined(this._mapParams.fadeOnZoom)?
this._mapParams.fadeOnZoom:"css-transforms"===this.navigationMode;"css-transforms"!==this.navigationMode&&(this.fadeOnZoom=!1);this.setMapCursor("default");this.smartNavigation=b&&b.smartNavigation;if(!(G.isDefined(this.smartNavigation)||!B("mac")||B("esri-touch")||B("esri-pointer")||3.5>=B("ff"))){var c=navigator.userAgent.match(/Mac\s+OS\s+X\s+([\d]+)(\.|\_)([\d]+)\D/i);c&&G.isDefined(c[1])&&G.isDefined(c[3])&&(a=parseInt(c[1],10),c=parseInt(c[3],10),this.smartNavigation=10<a||10===a&&6<=c)}this.showAttribution=
G.isDefined(this._mapParams.showAttribution)?this._mapParams.showAttribution:!0;this._onLoadHandler_connect=L(this,"onLoad",this,"_onLoadInitNavsHandler");var l=Q("div",{class:"esriControlsBR"+(this._mapParams.nav?" withPanArrows":"")},this.root);if(this.showAttribution)if(a=n.getObject("esri.dijit.Attribution",!1))this._initAttribution(a,l);else{var d=V++,h=this;this._rids&&this._rids.push(d);p(["./dijit/Attribution"],function(r){var y=h._rids?m.indexOf(h._rids,d):-1;-1!==y&&(h._rids.splice(y,1),
h._initAttribution(r,l))})}this._mapParams.logo&&(a={},6===B("ie")&&(a.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/logo-med.png")+"')"),this._ogol=Q("div",{style:a,tabIndex:"0",title:"Esri"},l),this._setLogoSize(),this._onMapResizeLogo_connect=L(this,"onResize",this,"_setLogoSize"),this._ogol_connect=L(this._ogol,q,this,"_openLogoLink"));this.navigationManager=new D(this);b&&b.basemap&&(this._onLoadFix=!0,this.setBasemap(b.basemap),
this._onLoadFix=!1);if(this.autoResize=this._mapParams.autoResize)b=this._getEnclosingResizableWidget(this.container)||window,a=this.resize,this._rszSignal=k.pausable(b,"resize",a),this._oriSignal=k.pausable(window,"orientationchange",a),f.after(b,"resize",a,!0),this._startResizeTimer()},_startResizeTimer:function(){clearTimeout(this._persistentTimer);this._persistentTimer=setTimeout(this._timedResize,2*this.resizeDelay)},_getEnclosingResizableWidget:function(a){var b=C.getEnclosingWidget(a);return b?
b.resize?b:this._getEnclosingResizableWidget(a.parentNode):b},_setLogoSize:function(){this._ogol&&(25E4>this.root.clientWidth*this.root.clientHeight?(a.remove(this._ogol,"logo-med"),a.add(this._ogol,"logo-sm")):(a.remove(this._ogol,"logo-sm"),a.add(this._ogol,"logo-med")))},_initAttribution:function(b,c){c=Q("span",{class:"esriAttribution"},c,"first");S(c,"maxWidth",Math.floor(this.width*this._mapParams.attributionWidth)+"px");this._connects.push(L(c,q,function(){a.contains(this,"esriAttributionOpen")?
a.remove(this,"esriAttributionOpen"):this.scrollWidth>this.clientWidth&&a.add(this,"esriAttributionOpen")}));this.attribution=new b({map:this},c)},_cleanUp:function(){this.disableMapNavigation();this.navigationManager.destroy();var a=this._slider;a&&a.destroy&&!a._destroyed&&a.destroy();var a=this._navDiv,b=this.attribution;a&&c.destroy(a);b&&b.destroy();this._connects.push(this._slider_connect,this._ogol_connect,this._rszSignal,this._oriSignal);m.forEach(this._connects,M);clearInterval(this._persistentTimer);
this.attribution=this.navigationManager=this._rids=this._connects=this._slider_connect=this._ogol_connect=this._rszSignal=this._oriSignal=this._persistentTimer=null;this.inherited("_cleanUp",arguments)},_isPanningOrZooming:function(){return this.__panning||this.__zooming},_canZoom:function(a){var b=this.getLevel();return!this.__tileInfo||!(b===this.getMinZoom()&&0>a||b===this.getMaxZoom()&&0<a)},_onLoadInitNavsHandler:function(){this._evalMapNavigation();this._createNav();if("small"===this._mapParams.sliderStyle||
!this._createSlider)this._createSimpleSlider();else if(this._mapParams.slider){var a=-1!==this._getSliderClass(!0).indexOf("Horizontal"),a=[a?"dijit.form.HorizontalSlider":"dijit.form.VerticalSlider",a?"dijit.form.HorizontalRule":"dijit.form.VerticalRule",a?"dijit.form.HorizontalRuleLabels":"dijit.form.VerticalRuleLabels"];if(m.some(a,function(l){return!n.getObject(l,!1)})){var a=m.map(a,function(l){return l.replace(/\./g,"/")}),b=V++,c=this;this._rids&&this._rids.push(b);p(a,function(){var l=c._rids?
m.indexOf(c._rids,b):-1;-1!==l&&(c._rids.splice(l,1),c._createSlider.apply(c,arguments))})}else a=m.map(a,function(l){return n.getObject(l,!1)}),this._createSlider.apply(this,a)}M(this._onLoadHandler_connect)},_createNav:function(){if(this._mapParams.nav){var b,c,e,l=a.add,d=this.id;this._navDiv=Q("div",{id:d+"_navdiv"},this.root);l(this._navDiv,"navDiv");var h=this.width/2,r=this.height/2,y;for(e in K)c=K[e],b=Q("div",{id:d+"_pan_"+e},this._navDiv),l(b,"fixedPan "+c),"up"===e||"down"===e?(y=parseInt(O(b).w,
10)/2,S(b,{left:h-y+"px",zIndex:30})):(y=parseInt(O(b).h,10)/2,S(b,{top:r-y+"px",zIndex:30})),this._connects.push(L(b,"onclick",T(this,this[c])));this._onMapResizeNavHandler_connect=L(this,"onResize",this,"_onMapResizeNavHandler");for(e in J)c=J[e],b=Q("div",{id:d+"_pan_"+e,style:{zIndex:30}},this._navDiv),l(b,"fixedPan "+c),this._connects.push(L(b,"onclick",T(this,this[c])));this.isPanArrows=!0}},_onMapResizeNavHandler:function(a,b,c){a=this.id;b/=2;c/=2;var l=e.byId,d,h,r;for(d in K)h=l(a+"_pan_"+
d),"up"===d||"down"===d?(r=parseInt(O(h).w,10)/2,S(h,"left",b-r+"px")):(r=parseInt(O(h).h,10)/2,S(h,"top",c-r+"px"))},_createSimpleSlider:function(){if(this._mapParams.slider){var b=this._slider=Q("div",{id:this.id+"_zoom_slider",class:this._getSliderClass(),style:{zIndex:30}}),c=Q("div",{class:"esriSimpleSliderIncrementButton",tabIndex:"0",role:"button"},b),f=Q("div",{class:"esriSimpleSliderDecrementButton",tabIndex:"0",role:"button"},b);this._addZoomButtonTooltips(c,f);this._incButton=c;this._decButton=
f;this._simpleSliderZoomHandler(null,null,null,this.getLevel());var l=I.widgets.zoomSlider;this._addZoomButtonIcon(c,"+",l.zoomIn);this._addZoomButtonIcon(f,"\x26minus;",l.zoomOut);8>B("ie")&&a.add(f,"dj_ie67Fix");this._connects.push(L(c,q,this,this._simpleSliderChangeHandler));this._connects.push(L(f,q,this,this._simpleSliderChangeHandler));(-1<this.getMaxZoom()||-1<this.getMinZoom())&&this._connects.push(L(this,"onZoomEnd",this,this._simpleSliderZoomHandler));10>B("ie")&&e.setSelectable(b,!1);this.root.appendChild(b);
this.isZoomSlider=!0}},_simpleSliderChangeHandler:function(a){u.stop(a);a=-1!==a.currentTarget.className.indexOf("IncrementButton")?!0:!1;this._extentUtil({numLevels:a?1:-1})},_simpleSliderZoomHandler:function(b,c,e,l){var d;b=this._incButton;c=this._decButton;-1<l&&l===this.getMaxZoom()?d=b:-1<l&&l===this.getMinZoom()&&(d=c);d?(a.add(d,"esriSimpleSliderDisabledButton"),a.remove(d===b?c:b,"esriSimpleSliderDisabledButton")):(a.remove(b,"esriSimpleSliderDisabledButton"),a.remove(c,"esriSimpleSliderDisabledButton"))},
_getSliderClass:function(a){a=a?"Large":"Simple";var b=this._mapParams.sliderOrientation,c=this._mapParams.sliderPosition||"",b=b&&"horizontal"===b.toLowerCase()?"esri"+a+"SliderHorizontal":"esri"+a+"SliderVertical";if(c)switch(c.toLowerCase()){case "top-left":c="esri"+a+"SliderTL";break;case "top-right":c="esri"+a+"SliderTR";break;case "bottom-left":c="esri"+a+"SliderBL";break;case "bottom-right":c="esri"+a+"SliderBR"}return"esri"+a+"Slider "+b+" "+c},_addZoomButtonIcon:function(a,b,e){c.create("span",
{"aria-hidden":"true",role:"presentation",innerHTML:b},a);c.create("span",{class:"esriIconFallbackText",innerHTML:e},a)},_addZoomButtonTooltips:function(a,c){var A=I.widgets.zoomSlider;b.set(a,"title",A.zoomIn);b.set(c,"title",A.zoomOut)},_createSlider:function(a,b,c){if(this._mapParams.slider){var l=Q("div",{id:this.id+"_zoom_slider"},this.root),d=E.defaults.map,h=this._getSliderClass(!0),r=-1!==h.indexOf("Horizontal"),y=this.getNumLevels();if(0<y){var H,A,e=this._mapParams.sliderLabels,f=!!e,q=
!1!==e;if(q){var w=r?"bottomDecoration":"rightDecoration";if(!e)for(e=[],d=0;d<y;d++)e[d]="";m.forEach([{class:"esriLargeSliderTicks",container:w,count:y,dijitClass:b},{class:f&&"esriLargeSliderLabels",container:w,count:y,labels:e,dijitClass:c}],function(d){var h=Q("div"),r=d.dijitClass;delete d.dijitClass;l.appendChild(h);r===b?H=new r(d,h):A=new r(d,h)})}a=this._slider=new a({id:l.id,class:h,minimum:this.getMinZoom(),maximum:this.getMaxZoom(),discreteValues:y,value:this.getLevel(),clickSelect:!0,
intermediateChanges:!0,style:"z-index:30;"},l);a.startup();q&&(H.startup(),A.startup());this._slider_connect=L(a,"onChange",this,"_onSliderChangeHandler");this._connects.push(L(this,"onExtentChange",this,"_onExtentChangeSliderHandler"));this._connects.push(L(a._movable,"onFirstMove",this,"_onSliderMoveStartHandler"))}else{a=this._slider=new a({id:l.id,class:h,minimum:0,maximum:2,discreteValues:3,value:1,clickSelect:!0,intermediateChanges:d.sliderChangeImmediate,style:"height:50px; z-index:30;"},l);
c=a.domNode.firstChild.childNodes;for(d=1;3>=d;d++)S(c[d],"visibility","hidden");a.startup();this._slider_connect=L(a,"onChange",this,"_onDynSliderChangeHandler");this._connects.push(L(this,"onExtentChange",this,"_onExtentChangeDynSliderHandler"))}d=a.incrementButton;c=a.decrementButton;r?this._addZoomButtonTooltips(d,c):this._addZoomButtonTooltips(c,d);d.style.outline="none";c.style.outline="none";a.sliderHandle.style.outline="none";a._onKeyPress=function(){};if(r=a._movable){var x=r.onMouseDown;
r.onMouseDown=function(d){9>B("ie")&&1!==d.button||x.apply(this,arguments)}}this.isZoomSlider=!0}},_onSliderMoveStartHandler:function(){M(this._slider_connect);M(this._slidermovestop_connect);this._slider_connect=L(this._slider,"onChange",this,"_onSliderChangeDragHandler");this._slidermovestop_connect=L(this._slider._movable,"onMoveStop",this,"_onSliderMoveEndHandler")},_onSliderChangeDragHandler:function(a){this._extentUtil({targetLevel:a})},_onSliderMoveEndHandler:function(){M(this._slider_connect);
M(this._slidermovestop_connect)},_onSliderChangeHandler:function(a){this.setLevel(a)},_updateSliderValue:function(a,b){M(this._slider_connect);var c=this._slider,l=c._onChangeActive;c._onChangeActive=!1;c.set("value",a);c._onChangeActive=l;this._slider_connect=L(c,"onChange",this,b)},_onExtentChangeSliderHandler:function(a,b,c,l){M(this._slidermovestop_connect);this._updateSliderValue(l.level,"_onSliderChangeHandler")},_onDynSliderChangeHandler:function(a){this._extentUtil({numLevels:0<a?1:-1})},
_onExtentChangeDynSliderHandler:function(){this._updateSliderValue(1,"_onDynSliderChangeHandler")},_openLogoLink:function(a){window.open(E.defaults.map.logoLink,"_blank");u.stop(a)},enableMapNavigation:function(){this.isMapNavigation||(this.isMapNavigation=!0,this._evalMapNavigation())},disableMapNavigation:function(){this.isMapNavigation&&(this.isMapNavigation=!1,this._evalMapNavigation())},_evalMapNavigation:function(){this.isMapNavigation?this.navigationManager.enableNavigation():this.navigationManager.disableNavigation()},
_evalNavigationFeature:function(a){if(this.isMapNavigation&&this["is"+a])this.navigationManager["enable"+a]();else this.navigationManager["disable"+a]()},enableDoubleClickZoom:function(){this.isDoubleClickZoom||(this.isDoubleClickZoom=!0,this._evalNavigationFeature("DoubleClickZoom"))},disableDoubleClickZoom:function(){this.isDoubleClickZoom&&(this.isDoubleClickZoom=!1,this._evalNavigationFeature("DoubleClickZoom"))},enableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom||(W(this.declaredClass+
": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.enableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=!0)},disableShiftDoubleClickZoom:function(){this.isShiftDoubleClickZoom&&(W(this.declaredClass+": Map.(enable/disable)ShiftDoubleClickZoom deprecated. Shift-Double-Click zoom behavior will not be supported.",null,"v2.0"),this.navigationManager.disableShiftDoubleClickZoom(),this.isShiftDoubleClickZoom=
!1)},enableClickRecenter:function(){this.isClickRecenter||(this.isClickRecenter=!0,this._evalNavigationFeature("ClickRecenter"))},disableClickRecenter:function(){this.isClickRecenter&&(this.isClickRecenter=!1,this._evalNavigationFeature("ClickRecenter"))},enablePan:function(){this.isPan||(this.isPan=!0,this._evalNavigationFeature("Pan"))},disablePan:function(){this.isPan&&(this.isPan=!1,this._evalNavigationFeature("Pan"))},enableRubberBandZoom:function(){this.isRubberBandZoom||(this.isRubberBandZoom=
!0,this._evalNavigationFeature("RubberBandZoom"))},disableRubberBandZoom:function(){this.isRubberBandZoom&&(this.isRubberBandZoom=!1,this._evalNavigationFeature("RubberBandZoom"))},enablePinchZoom:function(){this.isPinchZoom||(this.isPinchZoom=!0,this._evalNavigationFeature("PinchZoom"))},disablePinchZoom:function(){this.isPinchZoom&&(this.isPinchZoom=!1,this._evalNavigationFeature("PinchZoom"))},enableKeyboardNavigation:function(){this.isKeyboardNavigation||(this.isKeyboardNavigation=!0,this._evalNavigationFeature("KeyboardNavigation"))},
disableKeyboardNavigation:function(){this.isKeyboardNavigation&&(this.isKeyboardNavigation=!1,this._evalNavigationFeature("KeyboardNavigation"))},enableScrollWheel:function(){this.isScrollWheel||(this.isScrollWheel=!0,this._evalNavigationFeature("ScrollWheel"))},disableScrollWheel:function(){this.isScrollWheel&&(this.isScrollWheel=!1,this._evalNavigationFeature("ScrollWheel"))},enableScrollWheelZoom:function(){this.isScrollWheelZoom||(this.navigationManager.enableScrollWheelZoom(),this.isScrollWheelZoom=
!0)},disableScrollWheelZoom:function(){this.isScrollWheelZoom&&(this.navigationManager.disableScrollWheelZoom(),this.isScrollWheelZoom=!1)},enableScrollWheelPan:function(){this.isScrollWheelPan||this.navigationManager.enableScrollWheelPan()},disableScrollWheelPan:function(){this.isScrollWheelPan&&this.navigationManager.disableScrollWheelPan()},showPanArrows:function(){this._navDiv&&(this._navDiv.style.display="block",this.isPanArrows=!0)},hidePanArrows:function(){this._navDiv&&(this._navDiv.style.display=
"none",this.isPanArrows=!1)},showZoomSlider:function(){this._slider&&(S(this._slider.domNode||this._slider,"visibility","inherit"),this.isZoomSlider=!0)},hideZoomSlider:function(){this._slider&&(S(this._slider.domNode||this._slider,"visibility","hidden"),this.isZoomSlider=!1)},onClick:function(a){a.graphic||(a.graphic=this.syncHitTestForWebGL(a))}})})},"dijit/a11yclick":function(){define(["dojo/keys","dojo/mouse","dojo/on","dojo/touch"],function(p,g,t,v){function n(k){if((k.keyCode===p.ENTER||k.keyCode===
p.SPACE)&&!/input|button|textarea/i.test(k.target.nodeName))for(k=k.target;k;k=k.parentNode)if(k.dojoClick)return!0}var m;t(document,"keydown",function(k){n(k)?(m=k.target,k.preventDefault()):m=null});t(document,"keyup",function(k){n(k)&&k.target==m&&(m=null,t.emit(k.target,"click",{cancelable:!0,bubbles:!0,ctrlKey:k.ctrlKey,shiftKey:k.shiftKey,metaKey:k.metaKey,altKey:k.altKey,_origType:k.type}))});var u=function(k,f){k.dojoClick=!0;return t(k,"click",f)};u.click=u;u.press=function(k,f){var e=t(k,
v.press,function(a){("mousedown"!=a.type||g.isLeft(a))&&f(a)}),b=t(k,"keydown",function(a){a.keyCode!==p.ENTER&&a.keyCode!==p.SPACE||f(a)});return{remove:function(){e.remove();b.remove()}}};u.release=function(k,f){var e=t(k,v.release,function(a){("mouseup"!=a.type||g.isLeft(a))&&f(a)}),b=t(k,"keyup",function(a){a.keyCode!==p.ENTER&&a.keyCode!==p.SPACE||f(a)});return{remove:function(){e.remove();b.remove()}}};u.move=v.move;return u})},"dojo/touch":function(){define("./_base/kernel ./aspect ./dom ./dom-class ./_base/lang ./on ./has ./mouse ./domReady ./_base/window".split(" "),
function(p,g,t,v,n,m,u,k,f,e){function b(a,b,c){return w&&c?function(a,b){return m(a,c,b)}:C?function(c,e){var f=m(c,b,function(a){e.call(this,a);L=(new Date).getTime()}),q=m(c,a,function(a){(!L||(new Date).getTime()>L+1E3)&&e.call(this,a)});return{remove:function(){f.remove();q.remove()}}}:function(b,c){return m(b,a,c)}}function a(a){do if(void 0!==a.dojoClick)return a;while(a=a.parentNode)}function c(b,c,f){if(!k.isRight(b)){var q=a(b.target);if(E=!b.target.disabled&&q&&q.dojoClick)if(G=(B="useTarget"==
E)?q:b.target,B&&b.preventDefault(),F=b.changedTouches?b.changedTouches[0].pageX-e.global.pageXOffset:b.clientX,D=b.changedTouches?b.changedTouches[0].pageY-e.global.pageYOffset:b.clientY,I=("object"==typeof E?E.x:"number"==typeof E?E:0)||4,K=("object"==typeof E?E.y:"number"==typeof E?E:0)||4,!z){b=function(a){e.doc.addEventListener(a,function(b){var c=b.target;E&&!b._dojo_click&&(new Date).getTime()<=J+1E3&&("INPUT"!=c.tagName||!v.contains(c,"dijitOffScreen"))&&(b.stopPropagation(),b.stopImmediatePropagation&&
b.stopImmediatePropagation(),"click"==a&&("INPUT"!=c.tagName||"radio"==c.type&&(v.contains(c,"dijitCheckBoxInput")||v.contains(c,"mblRadioButton"))||"checkbox"==c.type&&(v.contains(c,"dijitCheckBoxInput")||v.contains(c,"mblCheckBox")))&&"TEXTAREA"!=c.tagName&&"AUDIO"!=c.tagName&&"VIDEO"!=c.tagName&&b.preventDefault())},!0)};var w=function(a){E=B?t.isDescendant(e.doc.elementFromPoint(a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX,a.changedTouches?a.changedTouches[0].pageY-
e.global.pageYOffset:a.clientY),G):E&&(a.changedTouches?a.changedTouches[0].target:a.target)==G&&Math.abs((a.changedTouches?a.changedTouches[0].pageX-e.global.pageXOffset:a.clientX)-F)<=I&&Math.abs((a.changedTouches?a.changedTouches[0].pageY-e.global.pageYOffset:a.clientY)-D)<=K};z=!0;e.doc.addEventListener(c,function(a){k.isRight(a)||(w(a),B&&a.preventDefault())},!0);e.doc.addEventListener(f,function(a){if(!k.isRight(a)&&(w(a),E)){var b=function(d){var h=document.createEvent("MouseEvents");h._dojo_click=
!0;h.initMouseEvent(d,!0,!0,a.view,a.detail,e.screenX,e.screenY,e.clientX,e.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);return h};J=(new Date).getTime();var c=B?G:a.target;"LABEL"===c.tagName&&(c=t.byId(c.getAttribute("for"))||c);var e=a.changedTouches?a.changedTouches[0]:a,f=b("mousedown"),l=b("mouseup"),d=b("click");setTimeout(function(){m.emit(c,"mousedown",f);m.emit(c,"mouseup",l);m.emit(c,"click",d);J=(new Date).getTime()},0)}},!0);b("click");b("mousedown");b("mouseup")}}}var x=5>
u("ios"),w=u("pointer-events")||u("MSPointer"),q=function(){var a={},b;for(b in{down:1,move:1,up:1,cancel:1,over:1,out:1})a[b]=u("MSPointer")?"MSPointer"+b.charAt(0).toUpperCase()+b.slice(1):"pointer"+b;return a}(),C=u("touch-events"),z,E,B=!1,G,F,D,I,K,J,L,M;u("touch")&&(w?f(function(){e.doc.addEventListener(q.down,function(a){c(a,q.move,q.up)},!0)}):f(function(){function a(a){var b=n.delegate(a,{bubbles:!0});6<=u("ios")&&(b.touches=a.touches,b.altKey=a.altKey,b.changedTouches=a.changedTouches,b.ctrlKey=
a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.targetTouches=a.targetTouches);return b}M=e.body();e.doc.addEventListener("touchstart",function(a){L=(new Date).getTime();var b=M;M=a.target;m.emit(b,"dojotouchout",{relatedTarget:M,bubbles:!0});m.emit(M,"dojotouchover",{relatedTarget:b,bubbles:!0});c(a,"touchmove","touchend")},!0);m(e.doc,"touchmove",function(b){L=(new Date).getTime();var c=e.doc.elementFromPoint(b.pageX-(x?0:e.global.pageXOffset),b.pageY-(x?0:e.global.pageYOffset));c&&(M!==c&&
(m.emit(M,"dojotouchout",{relatedTarget:c,bubbles:!0}),m.emit(c,"dojotouchover",{relatedTarget:M,bubbles:!0}),M=c),m.emit(c,"dojotouchmove",a(b))||b.preventDefault())});m(e.doc,"touchend",function(b){L=(new Date).getTime();var c=e.doc.elementFromPoint(b.pageX-(x?0:e.global.pageXOffset),b.pageY-(x?0:e.global.pageYOffset))||e.body();m.emit(c,"dojotouchend",a(b))})}));g={press:b("mousedown","touchstart",q.down),move:b("mousemove","dojotouchmove",q.move),release:b("mouseup","dojotouchend",q.up),cancel:b(k.leave,
"touchcancel",w?q.cancel:null),over:b("mouseover","dojotouchover",q.over),out:b("mouseout","dojotouchout",q.out),enter:k._eventHandler(b("mouseover","dojotouchover",q.over)),leave:k._eventHandler(b("mouseout","dojotouchout",q.out))};return p.touch=g})},"dijit/registry":function(){define(["dojo/_base/array","dojo/_base/window","./main"],function(p,g,t){var v={},n={},m={length:0,add:function(m){if(n[m.id])throw Error("Tried to register widget with id\x3d\x3d"+m.id+" but that id is already registered");
n[m.id]=m;this.length++},remove:function(m){n[m]&&(delete n[m],this.length--)},byId:function(m){return"string"==typeof m?n[m]:m},byNode:function(m){return n[m.getAttribute("widgetId")]},toArray:function(){var m=[],k;for(k in n)m.push(n[k]);return m},getUniqueId:function(m){var k;do k=m+"_"+(m in v?++v[m]:v[m]=0);while(n[k]);return"dijit"==t._scopeName?k:t._scopeName+"_"+k},findWidgets:function(m,k){function f(b){for(b=b.firstChild;b;b=b.nextSibling)if(1==b.nodeType){var a=b.getAttribute("widgetId");
a?(a=n[a])&&e.push(a):b!==k&&f(b)}}var e=[];f(m);return e},_destroyAll:function(){t._curFocus=null;t._prevFocus=null;t._activeStack=[];p.forEach(m.findWidgets(g.body()),function(m){m._destroyed||(m.destroyRecursive?m.destroyRecursive():m.destroy&&m.destroy())})},getEnclosingWidget:function(m){for(;m;){var k=1==m.nodeType&&m.getAttribute("widgetId");if(k)return n[k];m=m.parentNode}return null},_hash:n};return t.registry=m})},"dijit/main":function(){define(["dojo/_base/kernel"],function(p){return p.dijit})},
"esri/_coremap":function(){define("require module dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/_base/event dojo/_base/unload dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/sniff dijit/registry dojox/gfx/matrix ./kernel ./config ./basemaps ./lang ./Evented ./fx ./deferredUtils ./tileUtils ./urlUtils ./PluginTarget ./Color ./arcade/Dictionary ./geometry/Point ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./geometry/scaleUtils ./geometry/screenUtils ./geometry/webMercatorUtils ./layers/GraphicsLayer ./layers/TileInfo ./layers/LOD ./layers/ArcGISTiledMapServiceLayer ./layers/MapImageLayer ./layers/OpenStreetMapLayer ./layers/VectorTileLayer ./layers/support/webglUtils ./dijit/Popup ./plugins/popupManager dojo/uacss".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U,V,A,X,aa,l,d,h,r,y,H,P,ba,ea,va){function N(d,l){var y=d.lods;y.sort(function(d,h){return d.scale>h.scale?-1:d.scale<h.scale?1:0});var a=[],y=k.filter(y,function(d){if(-1===Ea(a,d.scale))return a.push(d.scale),!0}),b=l.lods=[],c;k.forEach(y,function(d,h){c=b[h]=new r(d);c.level=h});l.tileInfo=new h(oa(d,{lods:b}))}var Ca,ma=aa.toMapPoint,wa=aa.toScreenPoint,xa=n.connect,ya=n.disconnect,la=u.hitch,ua=q.set,Ea=k.indexOf,oa=
u.mixin,ra=0,pa=G.defaults.map,Ia=pa.layerNamePrefix,fa=pa.graphicsLayerNamePrefix,za=new RegExp("^"+Ia+"(\\d+)$"),Fa=new RegExp("^"+fa+"(\\d+)$"),Ma=function(){},Da=0,Pa=ea.isWebGLEnabled();return v([I,Q],{declaredClass:"esri._CoreMap",tables:null,resizeDelay:300,invalidExtent:"Map does not have a valid extent.",invalidGeometry:"Geometry (wkid: ${geometry}) cannot be converted to spatial reference of the map (wkid: ${map})",unknownBasemap:'Unable to find basemap definition for: "${basemapName}". Try one of these: ${list}',
invalidBasemap:'Unable to add basemap: "${basemapName}".',unknownLayerType:'Unknown basemap layer type: "${type}" found in basemap definition for: "${basemapName}".',visible:!0,webglEnabled:Pa,_eventMap:{"basemap-change":!0,"extent-change":["extent","delta","levelChange","lod"],"layer-add":["layer"],"layer-add-result":["layer","error"],"layer-remove":["layer"],"layer-reorder":["layer","index"],"layer-resume":["layer"],"layer-suspend":["layer"],"layers-add-result":["layers"],"layers-removed":!0,"layers-reordered":["layerIds"],
load:["map"],pan:["extent","delta"],"pan-end":["extent","delta"],"pan-start":["extent","screenPoint"],reposition:["x","y"],resize:["extent","width","height"],scale:["matrix","immediate"],"time-extent-change":["timeExtent"],"before-unload":["map"],unload:["map"],"update-end":["error"],"update-start":!0,zoom:["extent","zoomFactor","anchor"],"zoom-end":["extent","zoomFactor","anchor","level"],"zoom-start":["extent","zoomFactor","anchor","level"],click:!0,"dbl-click":!0,"key-down":!0,"key-up":!0,"mouse-down":!0,
"mouse-drag":!0,"mouse-drag-end":!0,"mouse-drag-start":!0,"mouse-move":!0,"mouse-out":!0,"mouse-over":!0,"mouse-up":!0,"mouse-wheel":!0,"basic-tap":!0,"double-tap":!0,"pinch-end":!0,"pinch-move":!0,"pinch-start":!0,"processed-double-tap":!0,"processed-tap":!0,"swipe-end":!0,"swipe-move":!0,"swipe-start":!0,tap:!0,"two-finger-tap":!0},constructor:function(d,h){h=h||{};this.registerConnectEvents();oa(this,{_internalLayerIds:[],_layers:[],_layerDivs:[],_layerSize:0,_connects:[],_layerAddPromises:{},
_zoomAnimDiv:null,_zoomAnim:null,_layersDiv:null,_firstLayerId:null,_delta:null,_cursor:null,_ratioW:1,_ratioH:1,_params:null,_minResolution:0,_maxResolution:0,cursor:null,layerIds:[],graphicsLayerIds:[],graphics:null,_labels:null,loaded:!1,__panning:!1,__zooming:!1,__container:null,root:null,__LOD:null,__tileInfo:null,__visibleRect:null,__visibleDelta:null,_rids:[],_webglContextOwners:[]});var l=this.container=b.byId(d),r=this.id=a.get(l,"id")||z.getUniqueId(this.declaredClass);c.add(l,"map");var y=
w.getContentBox(l);d=c.add;var H=x.create;this.position=new W(0,0);this._reposition();var A=this.width=0<y.w?y.w:pa.width,f=this.height=0<y.h?y.h:pa.height,q=this.root=H("div",{id:r+"_root",style:{width:A+"px",height:f+"px",direction:"ltr"}});d(q,"esriMapContainer");y=this.__container=H("div",{id:r+"_container"},q);ua(y,"position","absolute");d(y,"esriMapContainer");l.appendChild(q);h=this._params=oa({slider:!0,nav:!1,zoom:-1,minZoom:-1,maxZoom:-1,scale:-1,minScale:0,maxScale:0,showInfoWindowOnClick:!0,
displayGraphicsOnPan:!0,wrapAround180:!0,fitExtent:!1,optimizePanAnimation:!0},h);this.setWebGLEnabled(null!=h.webglEnabled?h.webglEnabled:this.webglEnabled);this.maxWebGLContexts=null!=h.maxWebGLContexts?h.maxWebGLContexts:-1;this.wrapAround180=h.wrapAround180;this.optimizePanAnimation=h.optimizePanAnimation;this.setBackgroundColor(h.backgroundColor);D.isDefined(h.resizeDelay)&&(this.resizeDelay=h.resizeDelay);h.lods&&(N({rows:512,cols:512,dpi:96,format:"JPEG",compressionQuality:75,origin:{x:-180,
y:90},spatialReference:{wkid:4326},lods:h.lods},h),this.__tileInfo=h.tileInfo);this.extent=h.extent;this._extentUtil({mapCenter:h.center,targetLevel:h.zoom,targetScale:h.scale});this.__visibleRect=new V(0,0,A,f);this.__visibleDelta=new V(0,0,A,f);r=this._layersDiv=H("div",{id:r+"_layers"});d(r,"esriMapLayers");y.appendChild(r);this._zoomAnimDiv=H("div",{style:{position:"absolute"}});h.infoWindow?this.infoWindow=h.infoWindow:(d=this.infoWindow=new va(h.popupOptions,H("div")),d.startup(),d._ootb=!0,
ua(d.domNode,"zIndex",40));if(h.showLabels){var P=this;p(["./layers/LabelLayer"],function(d){Ca=d;P._createLabelLayer()});this.on("load",function(){P._createLabelLayer()})}this.addPlugin(this._getAbsMid("./plugins/popupManager"),{enabled:h.showInfoWindowOnClick});this._zoomStartHandler=la(this,this._zoomStartHandler);this._zoomingHandler=la(this,this._zoomingHandler);this._zoomEndHandler=la(this,this._zoomEndHandler);this._panningHandler=la(this,this._panningHandler);this._panEndHandler=la(this,this._panEndHandler);
this._endTranslate=la(this,this._endTranslate);this._timedResize=la(this,this._timedResize);this._execResize=la(this,this._execResize);this._processLabelLayers=la(this,this._processLabelLayers);this._updateLabelLayers=la(this,this._updateLabelLayers);this.resize=la(this,this.resize);e.addOnWindowUnload(this,this.destroy)},_getAbsMid:function(d){return p.toAbsMid?p.toAbsMid(d):g.id.replace(/\/[^\/]*$/ig,"/")+d},_cleanUp:function(){var d=this.infoWindow;d&&(d._ootb&&d.destroy?d.destroy():d.unsetMap(this),
delete this.infoWindow);ya(this._tsTimeExtentChange_connect);this.removePlugin("./plugins/popupManager");x.destroy(this.root);this.root=null},_addLayer:function(h,l,r){if(h.id){var y=h.id.match(h instanceof d?Fa:za);y&&y[1]&&(y=Number(y[1]),ra<=y&&(ra=y+1))}var a=h.id||(h instanceof d?fa:Ia)+ra++;h.id=a;this._layers[a]=h;var b,c;if(l===this.layerIds||l===this.graphicsLayerIds)b=this._layerSize,this._layerSize++;h._isRefLayer="top"===r;r=!D.isDefined(r)||0>r||r>l.length||"top"===r?l.length:r;0===b&&
(this._firstLayerId=a);if(!h._isRefLayer)for(;(c=this.getLayer(l[r-1]))&&c._isRefLayer;)r--;l.splice(r,0,a);var H=la(this,this._addLayerHandler),A=this;r=this._connects;y=function(){h.loaded?A._onLoadFix?(A._onLoadFix=!1,setTimeout(function(){H(h)},0)):H(h):(A["_"+a+"_addtoken_load"]=xa(h,"onLoad",A,"_addLayerHandler"),A["_"+a+"_addtoken_err"]=xa(h,"onError",A,function(d){H(h,d,l)}))};this.loaded||0===b||h.loaded&&-1===Ea(this.graphicsLayerIds,a)?y():r.push(xa(this,"onLoad",y));return h},_forgetLayer:function(d){d=
d.id;ya(this["_"+d+"_addtoken_load"]);ya(this["_"+d+"_addtoken_err"]);var h=this._layerAddPromises[d];h&&(delete this._layerAddPromises[d],h.cancel())},_addLayerHandler:function(d,h,l){h?this._attachLayerToMap(d,h,l):d._prepareToAttach?(this._layerAddPromises[d.id]=d._prepareToAttach(this)).always(u.hitch(this,function(h){h&&"cancel"===h.dojoType||this._attachLayerToMap(d,null,l)})):d.declaredClass&&-1<d.declaredClass.toLowerCase().indexOf("vectortilelayer")&&!this.isWebGLContextAvailable()?(h=Error("Too many WebGL contexts. Unable to add the layer: ",
d.url),this._attachLayerToMap(d,h,this.layerIds)):this._attachLayerToMap(d,h,l)},_attachLayerToMap:function(h,l,r){var y=this.id,a=h.id,b=Ea(h instanceof d?this.graphicsLayerIds:this.layerIds,a),c=b,H=!1,A=this._params;this._forgetLayer(h);if(l)delete this._layers[a],-1!==b&&(r.splice(b,1),this.onLayerAddResult(h,l));else{-1===b&&(b=Ea(this._internalLayerIds,a),c=20+b,H=!0);if(a===this._firstLayerId){l=h.spatialReference;r=this.extent&&this.extent.spatialReference;!r||r.equals(l)||!h.tileInfo&&h.url||
(r=null);r=this.spatialReference=r||l;this.wrapAround180=this.wrapAround180&&r&&r._isWrappable()?!0:!1;h.tileInfo&&(this.__tileInfo?(l=this.__tileInfo.lods,this.__tileInfo=oa({},h.tileInfo),this.__tileInfo.lods=l):(N(oa({},h.tileInfo),A),this.__tileInfo=A.tileInfo));if(this.wrapAround180){l=this.__tileInfo;r=r._getInfo();if(!l||Math.abs(r.origin[0]-l.origin.x)>r.dx)this.wrapAround180=!1;this.wrapAround180&&l&&L._addFrameInfo(l,r)}A.units=h.units;if((l=this.__tileInfo&&this.__tileInfo.lods)&&l.length){r=
A.minScale;var b=A.maxScale,e=-1,f=-1,q=!1,w=!1,x;for(x=0;x<l.length;x++)0<r&&!q&&r>=l[x].scale&&(e=l[x].level,q=!0),0<b&&!w&&b>=l[x].scale&&(f=0<x?l[x-1].level:-1,w=!0);-1===A.minZoom&&(A.minZoom=0===r?l[0].level:e);-1===A.maxZoom&&(A.maxZoom=0===b?l[l.length-1].level:f);for(x=0;x<l.length;x++)A.minZoom===l[x].level&&(A.minScale=l[x].scale,this._minResolution=l[x].resolution),A.maxZoom===l[x].level&&(A.maxScale=l[x].scale,this._maxResolution=l[x].resolution)}else A.minZoom=A.maxZoom=A.zoom=-1}h instanceof
d?(this._gc||(this._gc=new d._GraphicsContainer,this._gc._setMap(this,this._layersDiv).id=y+"_gc"),this._attachGraphicsLayer(h).id=y+"_"+a):(c=h._setMap(this,this._layersDiv,c,this.__LOD),c.id=y+"_"+a,this._layerDivs[a]=c,this._reorderLayers(this.layerIds),H||-1===h.declaredClass.indexOf("VETiledLayer")||this._onBingLayerAdd(h));a===this._firstLayerId&&(this.graphics=new d({id:y+"_graphics",displayOnPan:A.displayGraphicsOnPan}),this._addLayer(this.graphics,this._internalLayerIds,20));if(h===this.graphics){r=
this._layers[this._firstLayerId];y=A.zoom;c=A.scale;l=A.center;r=r.initialExtent||r.fullExtent;this._firstLayerId=null;this.extent&&(this.extent=this._convertGeometry(this,this.extent));!this.extent&&r&&(l&&(l=this._convertGeometry(r,l)),l&&(r=r.centerAt(l),l=null));if(l=this.extent||r&&new U(r.toJson()))-1<y?l=this.__getExtentForLevel(y,null,l).extent:0<c&&(l=X.getExtentForScale(this,c,l));if(!l){console.log("Map: "+this.invalidExtent);return}A=this._fixExtent(l,A.fitExtent);this.extent=A.extent;
this.__LOD=A.lod;this.__setExtent(this.extent);this.loaded=!0;this.attr("data-loaded","");this.infoWindow.setMap(this);this.onLoad(this)}H||(this.onLayerAdd(h),this.onLayerAddResult(h));ya(this[a+"_addLayerHandler_connect"])}},_convertGeometry:function(d,h){d=d&&d.spatialReference;var r=h&&h.spatialReference;d&&r&&!d.equals(r)&&(d._canProject(r)?d.isWebMercator()?h=l.geographicToWebMercator(h):4326===d.wkid&&(h=l.webMercatorToGeographic(h,!0)):(console.log("Map: "+D.substitute({geometry:r.wkid||r.wkt,
map:d.wkid||d.wkt},this.invalidGeometry)),h=null));return h},_attachGraphicsLayer:function(d){var h=d.id;d=d._setMap(this,this._gc._surface);this._layerDivs[h]=d;this._reorderLayers(this.graphicsLayerIds);return d},_detachGraphicsLayer:function(d){d.loaded&&d.getMap()&&d._unsetMap(this,this._gc._surface)},_reorderLayers:function(d){var h=this.onLayerReorder,l=x.place,r=this._layerDivs,y=this._layers,a=this._gc?this._gc._surface.getEventSource():null;if(d===this.graphicsLayerIds)k.forEach(d,function(d,
l){var a=r[d];d=y[d];a&&(this._gc._reorderLayer(d,a,l),h(d,l))},this);else{var b=this.graphics,c=b?b.id:null,H=this._layersDiv,A;k.forEach(d,function(d,a){A=r[d];d!==c&&A&&(l(A,H,a),h(y[d],a))});this._mapImageLyr&&this._placeMapImageLyr();a&&(a=9>C("ie")?a.parentNode:a,l(a,a.parentNode,"last"))}this.onLayersReordered([].concat(d))},_zoomStartHandler:function(){this.__zoomStart(this._zoomAnimDiv.startingExtent,this._zoomAnimDiv.anchor)},_zoomingHandler:function(d){var h=parseFloat(d.left),l=parseFloat(d.top);
d=new U(h,l-parseFloat(d.height),h+parseFloat(d.width),l,this.spatialReference);h=this.extent.getWidth()/d.getWidth();this.__zoom(d,h,this._zoomAnimDiv.anchor)},_zoomEndHandler:function(){var d=this._zoomAnimDiv,h=d.extent,l=this.extent.getWidth()/h.getWidth(),r=d.anchor,y=d.newLod,a=d.levelChange;d.extent=d.anchor=d.levelChange=d.startingExtent=d.newLod=this._delta=this._zoomAnim=null;this.__zoomEnd(h,l,r,y,a)},_panningHandler:function(d){if(isNaN(parseFloat(d.left))||isNaN(parseFloat(d.top))){var h=
Math.round,l=this._panAnim.node;d.left=-1*(this._delta.x-h(this.width/2))+"px";d.top=-1*(this._delta.y-h(this.height/2))+"px";q.set(l,"left",d.left);q.set(l,"top",d.top)}d=new W(parseFloat(d.left),parseFloat(d.top));h=this.toMap(d);this.onPan(this.extent.offset(this.extent.xmin-h.x,this.extent.ymax-h.y),d)},_panEndHandler:function(d){this.__panning=!1;var h=Math.round;d=new W(-h(parseFloat(d.style.left)),-h(parseFloat(d.style.top)));var h=d.x,l=d.y,r=this.__visibleRect,y=this.__visibleDelta;r.x+=
-h;r.y+=-l;y.x+=-h;y.y+=-l;ua(this._zoomAnimDiv,{left:"0px",top:"0px"});var r=this.extent,y=this._ratioW,a=this._ratioH,r=new U(r.xmin+h/y,r.ymin-l/a,r.xmax+h/y,r.ymax-l/a,this.spatialReference);d.setX(-d.x);d.setY(-d.y);this._delta=this._panAnim=null;this._updateExtent(r);this.onPanEnd(r,d);this._fireExtChg([r,d,!1,this.__LOD])},_fixExtent:function(d,h){for(var l=this._reshapeExtent(d),r=1.25;!0===h&&(l.extent.getWidth()<d.getWidth()||l.extent.getHeight()<d.getHeight())&&0<l.lod.level&&3>=r;)l=this._reshapeExtent(d.expand(r)),
r+=.25;return l},_getFrameWidth:function(){var d=-1,h=this.spatialReference._getInfo();this.__LOD?(h=this.__LOD._frameInfo)&&(d=h[3]):h&&(d=Math.round(2*h.valid[1]/(this.extent.getWidth()/this.width)));return d},_fixAspectRatio:function(d){var h=d.getWidth(),l=d.getHeight(),r=h/l,y=this.width/this.height,a=0,b=0;this.width>this.height?h>l?y>r?a=l*y-h:b=h/y-l:a=l*y-h:this.width<this.height?h<l?y>r?a=l*y-h:b=h/y-l:b=h/y-l:h<l?a=l-h:h>l&&(b=h/y-l);a&&(d.xmin-=a/2,d.xmax+=a/2);b&&(d.ymin-=b/2,d.ymax+=
b/2);return d},_reshapeExtent:function(d){d=this._fixAspectRatio(d);return this._getAdjustedExtent(d)},_getAdjustedExtent:function(d){if(this.__tileInfo)return L.getCandidateTileInfo(this,this.__tileInfo,d);var h=X.getScale(this,d),l=this.getMinScale(),r=this.getMaxScale();!l||h<=l?!r||h>=r||(d=X.getExtentForScale(this,r,d)):d=X.getExtentForScale(this,l,d);return{extent:d}},_onBingLayerAdd:function(d){this["__"+d.id+"_vis_connect"]=n.connect(d,"onVisibilityChange",this,"_toggleBingLogo");this._toggleBingLogo(d.visible)},
_onBingLayerRemove:function(d){n.disconnect(this["__"+d.id+"_vis_connect"]);delete this["__"+d.id+"_vis_connect"];var h=k.some(this.layerIds,function(h){return(d=this._layers[h])&&d.visible&&-1!==d.declaredClass.indexOf("VETiledLayer")},this);this._toggleBingLogo(h)},_toggleBingLogo:function(d){d&&!this._bingLogo?(d={left:this._mapParams&&this._mapParams.nav?"25px":""},6===C("ie")&&(d.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+p.toUrl("./images/map/bing-logo-lg.png")+
"')"),d=this._bingLogo=x.create("div",{style:d},this.root),c.add(d,"bingLogo-lg")):!d&&this._bingLogo&&(x.destroy(this._bingLogo),delete this._bingLogo)},__panStart:function(d,h){var l=this._zoomAnim,r=this._panAnim;if(l&&l._active)l.stop(),l._fire("onEnd",[l.node]);else if(r&&r._active){r.stop();this._panAnim=null;h=r.curve.getValue(r._getStep());d=Math.round(parseFloat(h.left));h=Math.round(parseFloat(h.top));l=this.navigationManager._dragOrigin;this.__pan(d,h);l&&(l.x-=d,l.y-=h);return}this.__panning=
!0;this.onPanStart(this.extent,new W(d,h))},__pan:function(d,h){var l=this.extent,r=this._ratioW,y=this._ratioH;this.onPan(new U(l.xmin-d/r,l.ymin+h/y,l.xmax-d/r,l.ymax+h/y,this.spatialReference),new W(d,h))},__panEnd:function(d,h){var l=this.__visibleRect,r=this.__visibleDelta;l.x+=d;l.y+=h;r.x+=d;r.y+=h;var l=new W(d,h),r=this.extent,y=this._ratioW,a=this._ratioH,r=new U(r.xmin-d/y,r.ymin+h/a,r.xmax-d/y,r.ymax+h/a,this.spatialReference);this.__panning=!1;this._updateExtent(r);this.onPanEnd(r,l);
this._fireExtChg([r,l,!1,this.__LOD])},__zoomStart:function(d,h){this.__zooming=!0;this.onZoomStart(d,1,h,this.__LOD?this.__LOD.level:null)},__zoom:function(d,h,l){this.onZoom(d,h,l)},__zoomEnd:function(d,h,l,r,y){ua(this._layersDiv,{left:"0px",top:"0px"});this._delta=new W(0,0);this.__visibleRect.x=this.__visibleRect.y=0;d=new U(d);this.__LOD=r;this._ratioW=this.width/d.getWidth();this._ratioH=this.height/d.getHeight();var a=this._delta;this._delta=null;this.__zooming=!1;this._updateExtent(d,y);
this.onZoomEnd(d,h,l,r?r.level:null);this._fireExtChg([d,a,y,r])},_extentUtil:function(d,h,l,r,y){var a=new m,b,c,H,A,e,f,q,w,x,P,k=this.width,g=this.height,z,B,C;d&&(b=d.numLevels,c=d.targetLevel,z=D.isDefined(c),H=d.factor,A=d.mapAnchor,e=d.screenAnchor,f=d.mapCenter,B=d.levelOrFactor,q=d.targetScale,w=D.isDefined(q)&&0<q);h&&(x=h.dx,P=h.dy,f=h.mapCenter);u.isArray(f)&&(f=new O(f));var n=this._panAnim;h=(d=this._stopAnim())?d.divExtent:this.extent;var F=this.__tileInfo,ba=this._params;if(!this.loaded){if(l)h&&
(l=this._convertGeometry(h,l)),l&&(this.extent=l,ba.zoom=ba.scale=-1,ba.center=null);else if(f||z||w){if(f)if(h){if(f=this._convertGeometry(h,f))this.extent=h.centerAt(f),ba.center=null}else ba.center=f;z&&-1<c?(ba.zoom=c,ba.scale=-1):w&&(ba.scale=q,ba.zoom=-1)}a.resolve();return a}if(f&&(f=this._convertGeometry(this,f),!f)||A&&(A=this._convertGeometry(this,A),!A)||l&&(l=this._convertGeometry(this,l),!l))return a.reject(),a;n&&A&&e&&(A=ma(this.extent,k,g,e));d&&A&&e&&(A=ma(d.divExtent,k,g,e));z&&
(F?(b=this.getMinZoom(),z=this.getMaxZoom(),c<b?c=b:c>z&&(c=z),b=c-(d?d.level:this.getLevel())):(b=0<c?-1:1,C=B?c:null));if(!l)if(D.isDefined(b))F?(k=d?d.level:this.getLevel(),k=this.__getExtentForLevel(k+b,f,h).extent):(k=(d?d.end:this.extent).expand(C||(0<b?.5*b:2*-b)),C&&f&&(k=k.centerAt(f))),k&&(f?l=k:(x=A||h.getCenter(),g=k.getWidth(),P=k.getHeight(),k=x.x>=h.xmin&&x.x<=h.xmax?(x.x-h.xmin)/h.getWidth():.5,l=x.y>=h.ymin&&x.y<=h.ymax?(x.y-h.ymin)/h.getHeight():.5,k=x.x-k*g,x=x.y-l*P,l=new U(k,
x,k+g,x+P,this.spatialReference)));else if(w)l=X.getExtentForScale(this,q,h);else if(D.isDefined(H))l=h.expand(H);else if(x||P)d?(l=d.end,A=l.getCenter(),C=wa(l,k,g,A),C.x+=x,C.y+=P,C=ma(l,k,g,C),l=l.offset(C.x-A.x,C.y-A.y)):(x=new W(k/2+x,g/2+P),x=ma(h,k,g,x),g=h.getWidth(),P=h.getHeight(),k=x.x-g/2,x=x.y-P/2,l=new U(k,x,k+g,x+P,this.spatialReference));l||(f?(h=d?d.end:h,g=h.getWidth(),P=h.getHeight(),k=f.x-g/2,x=f.y-P/2,l=new U(k,x,k+g,x+P,this.spatialReference)):d&&(l=d.end));l?(this._extentDfd&&
-1===this._extentDfd.fired&&(this._extentDfd.then(null,Ma),this._extentDfd.reject()),this._extentDfd=a,this.__setExtent(l,null,e,r,d,y)):a.reject();return a},__setExtent:function(d,h,l,r,y,a){try{if(this._firstLayerId)this.extent=d;else{var b=!0,c=this.spatialReference,H=y?y.divExtent:this.extent,e=this._fixExtent(d,r||!1);d=e.extent;var f=d.getWidth(),q=d.getHeight(),w=Math.round;if(H)var x=w(1E6*H.getWidth()),P=w(1E6*f),k=w(1E6*H.getHeight()),m=w(1E6*q),b=x!==P||k!==m;var g,z,C=y&&y.rect,u=y&&y.divExtent;
if(pa.zoomDuration&&b&&H){u=u||new U(H);C=C||{left:H.xmin,top:H.ymax,width:H.getWidth(),height:H.getHeight()};z={left:d.xmin,top:d.ymax,width:f,height:q};var B=new O(d.xmin,d.ymax,c),n=new O(d.xmin,d.ymin,c),F=new O(this.extent.xmin,this.extent.ymax,c),ba=new O(this.extent.xmin,this.extent.ymin,c);(g=A.getLineIntersection(F,B,ba,n,c))||y||(b=!1)}this._ratioW=this.width/f;this._ratioH=this.height/q;var D=this._zoomAnimDiv;if(b)if(ua(this._layersDiv,{left:"0px",top:"0px"}),h=new W(0,0),this.__visibleRect.x=
this.__visibleRect.y=0,C&&z){this._delta=h;D.id="_zAD";D.startingExtent=u;D.extent=d;D.levelChange=b;D.newLod=e.lod;D.anchor=l?l:!g&&y?y.anchor:wa(this.extent,this.width,this.height,g);var p=this.extent.getWidth()/d.getWidth();pa.zoomAnimationThrottled&&1024<(1>p?1/p:p)?(this.__zoomStart(u,D.anchor),this.__zoom(u,1,D.anchor),this._fireOnScale(1,D.anchor,!0),this.__zoomEnd(d,p,D.anchor,e.lod,b)):(this._zoomAnim=K.resize({node:D,start:C,end:z,duration:pa.zoomDuration,rate:pa.zoomRate,beforeBegin:y?
null:this._zoomStartHandler,onAnimate:this._zoomingHandler,onEnd:this._zoomEndHandler}).play(),this._fireOnScale(p,D.anchor,a))}else this._updateExtent(d,b,a),this._fireExtChg([this.extent,h,b,this.__LOD=e.lod]);else if(!this.__panning)if(!1===this.loaded||a)this._updateExtent(d,b,a),this._fireExtChg([this.extent,h,b,this.__LOD=e.lod]);else{this.__panning=!0;C=(new V(0,0,this.width,this.height,this.spatialReference)).getCenter();C.x=w(C.x);C.y=w(C.y);var E=this._delta=this.toScreen(d.getCenter()),
G=Math.abs(C.x-E.x),I=Math.abs(C.y-E.y);this.optimizePanAnimation&&(G>2*this.width||I>2*this.height)?(this.__panStart(0,0),this.__pan(0,0),this.__visibleRect.x=this.__visibleRect.y=this.__visibleDelta.x=this.__visibleDelta.y=0,this.__panning=!1,this._delta=null,this._updateExtent(d,!1,a),this.onPanEnd(this.extent,new W(0,0)),this._fireExtChg([this.extent,new W(0,0),!0,this.__LOD])):(this.onPanStart(this.extent,new W(0,0)),this._panAnim=K.slideTo({node:D,left:C.x-E.x,top:C.y-E.y,duration:pa.panDuration,
rate:pa.panRate,onAnimate:this._panningHandler,onEnd:this._panEndHandler}),this._panAnim.play())}}}catch(Ra){console.log(Ra.stack),console.error(Ra)}},_fireOnScale:function(d,h,l){if("css-transforms"===this.navigationMode){var r=this.__visibleDelta;this.onScale(E.scaleAt(d,{x:-1*(this.width/2-(h.x-r.x)),y:-1*(this.height/2-(h.y-r.y))}),l)}},_stopAnim:function(){var d=this._zoomAnim,h=this._panAnim;if(d&&d._active){d.stop();var h=d.curve.getValue(d._getStep()),l=parseFloat(h.left),r=parseFloat(h.top),
d=d.node;return{anchor:d.anchor,start:d.startingExtent,end:d.extent,level:d.newLod&&d.newLod.level,rect:h,divExtent:new U(l,r-parseFloat(h.height),l+parseFloat(h.width),r,this.spatialReference)}}h&&h._active&&(h.stop(),h._fire("onEnd",[h.node]))},__getExtentForLevel:function(d,h,l){var r=this.__tileInfo,r=r&&r.lods;d=D.isDefined(d)?d:0;l=l||this.extent;h=h||l&&l.getCenter();if(r){if(h){l=this.getMinZoom();var y=this.getMaxZoom();d>y&&(d=y);d<l&&(d=l);d=r[d];r=this.width*d.resolution/2;l=this.height*
d.resolution/2;return{extent:new U(h.x-r,h.y-l,h.x+r,h.y+l,h.spatialReference),lod:d}}}else if(l)return{extent:l.expand(!d||1>d?1:d).centerAt(h)};console.log("Map: "+this.invalidExtent)},_jobs:0,_incr:function(){1===++this._jobs&&(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart())},_decr:function(){var d=--this._jobs;d?0>d&&(this._jobs=0):(this.updating=!1,this.attr("data-updating"),this.onUpdateEnd())},_fireEvent:function(d,h){this[d]&&this[d].apply(this,h)},_updateExtent:function(d,
h,l){this.extent=d;d=this.spatialReference;this._viewInfo={view:new T({viewingMode:"map",scale:this.getScale()}),sr:d,version:h?++Da:Da};(h||l)&&this._setClipRect();this._calcGeographicExtent()},_calcGeographicExtent:function(){var d=this.spatialReference;d&&(d.isWebMercator()?this.geographicExtent=l.webMercatorToGeographic(this._getAvailExtent(),!0):4326===d.wkid&&(this.geographicExtent=new U(this._getAvailExtent().toJson())))},_fireExtChg:function(d){this.attr("data-zoom",this.getZoom());this.attr("data-scale",
this.getScale());this._fireEvent("onExtentChange",d);if(d=this._extentDfd)delete this._extentDfd,d.resolve()},attr:function(d,h){var l=this.container;l&&(null==h?l.removeAttribute(d):l.setAttribute(d,h));return this},onUpdateStart:function(){},onUpdateEnd:function(){},onLoad:function(){this._setClipRect();this._calcGeographicExtent()},onBeforeUnload:function(){},onUnload:function(){},onExtentChange:function(d,h,l){},onTimeExtentChange:function(){},onWebGLEnabledChange:function(){},onLayerAdd:function(){},
onLayerAddResult:function(){},onLayersAddResult:function(){},onLayerRemove:function(){},onLayersRemoved:function(){},onLayerReorder:function(){},onLayersReordered:function(){},onLayerSuspend:function(){},onLayerResume:function(){},onPanStart:function(){},onPan:function(){},onPanEnd:function(){},onScale:function(){},onZoomStart:function(){},onZoom:function(){},onZoomEnd:function(){},onResize:function(){this._setClipRect()},onReposition:function(){},destroy:function(){this._destroyed||(this.onBeforeUnload(this),
this.removeAllLayers(),this.releaseAllWebGLContexts(),this._cleanUp(),clearTimeout(this._resizeTimerHandle),this._gc&&this._gc._cleanUp(),this._destroyed=!0,this.onUnload(this))},setCursor:function(d){ua(this.__container,"cursor",this.cursor=d)},setMapCursor:function(d){this.setCursor(this._cursor=d)},resetMapCursor:function(){this.setCursor(this._cursor)},setBackgroundColor:function(d){d&&!d.declaredClass&&(d=new S(d));this.backgroundColor=d||null;var h="";d&&(h=9>C("ie")?d.toHex():"rgba("+d.toRgba().join(",")+
")");q.set(this.root,{backgroundColor:h})},setInfoWindow:function(d){var h=this.infoWindow;h&&h.unsetMap(this);this.infoWindow=d;this.loaded&&d&&d.setMap(this)},setInfoWindowOnClick:function(d){this._params.showInfoWindowOnClick=d;this.popupManager&&this.popupManager.set("enabled",d)},getInfoWindowAnchor:function(d){return this.infoWindow&&this.infoWindow._getAnchor&&this.infoWindow._getAnchor(d)||"upperright"},toScreen:function(d,h){return wa(this.extent,this.width,this.height,d,h)},toMap:function(d){return ma(this.extent,
this.width,this.height,d)},addLayer:function(h,l){h&&!this.getLayer(h.id)&&this._addLayer(h,h instanceof d?this.graphicsLayerIds:this.layerIds,l);return h},addLayers:function(d){var h=[],l=d.length,r,y,a=d.length;r=n.connect(this,"onLayerAddResult",function(y,a){-1!==k.indexOf(d,y)&&(l--,h.push({layer:y,success:!a,error:a}),l||(n.disconnect(r),this.onLayersAddResult(h)))});for(y=0;y<a;y++)this.addLayer(d[y]);return this},removeLayer:function(h,l){var r=h.id,y=h instanceof d?this.graphicsLayerIds:
this.layerIds,a=Ea(y,r);0<=a&&(this._forgetLayer(h),y.splice(a,1),h instanceof d?this._detachGraphicsLayer(h):h.loaded&&(h.getMap()&&h._unsetMap(this,this._layersDiv),-1!==h.declaredClass.indexOf("VETiledLayer")&&this._onBingLayerRemove(h)),delete this._layers[r],delete this._layerDivs[r],l||this._reorderLayers(y),this.onLayerRemove(h))},removeAllLayers:function(){var d=this.layerIds,h;for(h=d.length-1;0<=h;h--)this.removeLayer(this._layers[d[h]],1);d=this.graphicsLayerIds;for(h=d.length-1;0<=h;h--)this.removeLayer(this._layers[d[h]],
1);this.onLayersRemoved()},reorderLayer:function(h,l){u.isString(h)&&(t.deprecated(this.declaredClass+": Map.reorderLayer(/*String*/ id, /*Number*/ index) deprecated. Use Map.reorderLayer(/*Layer*/ layer, /*Number*/ index).",null,"v2.0"),h=this.getLayer(h));var r=h.id,y=h instanceof d?this.graphicsLayerIds:this.layerIds;0>l?l=0:l>=y.length&&(l=y.length-1);h=Ea(y,r);-1!==h&&h!==l&&(y.splice(h,1),y.splice(l,0,r),this._reorderLayers(y))},getLayer:function(d){return this._layers[d]},setWebGLEnabled:function(d){var h=
this.webglEnabled;this.webglEnabled=(d||!1)&&Pa;if(h!==this.webglEnabled)this.onWebGLEnabledChange()},isWebGLContextAvailable:function(){return ea.isContextAvailable()&&(-1===this.maxWebGLContexts||0<this.maxWebGLContexts&&this._webglContextOwners.length<this.maxWebGLContexts)},ownsWebGLContext:function(d){return-1!==k.indexOf(this._webglContextOwners,d)},acquireWebGLContext:function(d){return-1!==k.indexOf(this._webglContextOwners,d)?!0:this.isWebGLContextAvailable()?(ea.acquireContext(d),this._webglContextOwners.push(d),
!0):!1},releaseWebGLContext:function(d){var h=k.indexOf(this._webglContextOwners,d);-1!==h&&this._webglContextOwners.splice(h,1);ea.releaseContext(d)},releaseAllWebGLContexts:function(){var d=this._webglContextOwners.slice(0);k.forEach(d,function(d){this.releaseWebGLContext(d)},this)},syncHitTestForWebGL:function(d){var h,l=d.screenPoint;d=this.graphicsLayerIds.slice(0).reverse();k.some(d,function(d){d=this.getLayer(d);d.loaded&&!d.suspended&&d.hasWebGLSurface()&&(h=d._div.syncHitTest(l.x,l.y));return!!h},
this);return h},setExtent:function(d,h){d=new U(d.toJson());var l=d.getWidth(),r=d.getHeight();return 0===l&&0===r?this.centerAt(new O({x:d.xmin,y:d.ymin,spatialReference:d.spatialReference&&d.spatialReference.toJson()})):this._extentUtil(null,null,d,h)},getTargetExtent:function(d){if(d)return d=new U(d.toJson()),0!==d.getWidth()&&0!==d.getHeight()&&(d=(d=this._convertGeometry(this,d))&&this._fixExtent(d).extent),d},centerAt:function(d){return this._extentUtil(null,{mapCenter:d})},centerAndZoom:function(d,
h){return this._extentUtil({targetLevel:h,mapCenter:d,levelOrFactor:!0})},getScale:function(){return this.__LOD?this.__LOD.scale:X.getScale(this)},getResolution:function(){return this.__LOD?this.__LOD.resolution:this.extent?this.extent.getWidth()/this.width:0},getResolutionInMeters:function(){return this.getResolution()*X.getUnitValueForSR(this.spatialReference)},getResolutionForPopup:function(){var d=this.getResolution(),h=this.getResolutionInMeters(),l=h/16;return 10>=l?0:d/h*l},getMinResolution:function(){return this._minResolution},
getMaxResolution:function(){return this._maxResolution},getMinScale:function(){return this._params.minScale},getMaxScale:function(){return this._params.maxScale},getViewInfo:function(){return this._viewInfo},setScale:function(d){return this._extentUtil({targetScale:d})},getLayersVisibleAtScale:function(d){var h=[];(d=d||this.getScale())&&k.forEach(this.layerIds.concat(this.graphicsLayerIds),function(l){l=this.getLayer(l);l.isVisibleAtScale(d)&&h.push(l)},this);return h},getNumLevels:function(){var d=
this.getMinZoom(),h=this.getMaxZoom();return d===h&&0>d?0:h-d+1},getLevel:function(){return this.__LOD?this.__LOD.level:-1},setLevel:function(d){if(-1<d)return this._extentUtil({targetLevel:d})},getZoom:function(){return this.getLevel()},setZoom:function(d){return this.setLevel(d)},getMinZoom:function(){return this._params.minZoom},getMaxZoom:function(){return this._params.maxZoom},setBasemap:function(d){var h;u.isObject(d)?(h=d,d=h.title):h=F&&F[d];if(h){this._basemapDfd&&-1===this._basemapDfd.fired&&
this._basemapDfd.cancel();var l=[],r=[],a=0;k.forEach(h.baseMapLayers||h.layers,function(h){var b,c={id:h.id,displayLevels:h.displayLevels,opacity:D.isDefined(h.opacity)?h.opacity:null,visible:D.isDefined(h.visibility)?h.visibility:null};if(h.type)switch(h.type){case "OpenStreetMap":b=new P(c);break;case "VectorTile":b=M.normalize(h.url);b=new ba(b,c);break;default:console.log("Map.setBasemap: "+D.substitute({basemapName:d,type:h.type},this.unknownLayerType))}else b=M.normalize(h.url),b=new y(b,c);
b&&(l.push(b),r.push(h),h.isReference||a++)},this);if(l.length&&a){var b={basemapName:d,infos:r,layers:l};if(this.loaded){var c=this,H=new m(J._dfdCanceller),A=function(d){H._pendingLayers--;d=k.indexOf(b.layers,this);-1<d&&(d=H._layerEvents[d])&&(n.disconnect(d[0]),n.disconnect(d[1]));0>=H._pendingLayers&&(delete H._layerEvents,delete c._basemapDfd,0>H.fired&&H.callback(b))};this._basemapDfd=H;H._pendingLayers=0;H._layerEvents={};k.forEach(l,function(d,h){d&&(H._pendingLayers++,d.loaded?A(d):H._layerEvents[h]=
[n.connect(d,"onLoad",d,A),n.connect(d,"onError",d,A)])});H.addCallback(la(this,this._basemapLoaded))}else this._basemapLoaded(b)}else console.log("Map.setBasemap: "+D.substitute({basemapName:d},this.invalidBasemap))}else{h=[];for(var e in F)h.push(e);console.log("Map.setBasemap: "+D.substitute({basemapName:d,list:h.join(",")},this.unknownBasemap))}},_basemapLoaded:function(d){var h=d.layers,l=d.infos,r=0,y=!0,a;this.loaded&&(k.forEach(h,function(d,h){d.loaded&&(l[h].isReference||r++)}),y=r);y&&(this.basemapLayerIds&&
(a={basemapName:this._basemap,infos:F&&F[this._basemap]&&F[this._basemap].baseMapLayers},a.basemapName||(k.forEach(this.basemapLayerIds,function(d){if(this.getLayer(d)instanceof P)return a.basemapName="osm",a.infos=F&&F.osm&&F.osm.baseMapLayers,!1},this),a.basemapName||(a=null))),this._removeBasemap(),this._basemap=d.basemapName,this.basemapLayerIds=this._addBasemap(h,l),this.attr("data-basemap",this.getBasemap()),this.emit("basemap-change",{current:d,previous:a}))},_addBasemap:function(d,h){var l=
[],r=[],y=0;k.forEach(d,function(d,a){h[a].isReference?l.push(d):(this.addLayer(d,y++),r.push(d.id))},this);l.length&&k.forEach(l,function(d){d.attr("data-reference",!0);this.addLayer(d,"top");r.push(d.id)},this);return r},_removeBasemap:function(){var d=this.basemapLayerIds,h;d&&d.length&&k.forEach(d,function(d){(h=this.getLayer(d))&&this.removeLayer(h)},this)},getBasemap:function(){return this._basemap||""},translate:function(d,h){d=d||0;h=h||0;if(!this._txTimer){this._tx=this._ty=0;var l=this.toScreen(this.extent.getCenter());
this.__panStart(l.x,l.y)}this._tx+=d;this._ty+=h;this.__pan(this._tx,this._ty);clearTimeout(this._txTimer);this._txTimer=setTimeout(this._endTranslate,150)},_endTranslate:function(){clearTimeout(this._txTimer);this._txTimer=null;var d=this._tx,h=this._ty;this._tx=this._ty=0;this.__panEnd(d,h)},setTimeExtent:function(d){d=(this.timeExtent=d)?new d.constructor(d.toJson()):null;this.onTimeExtentChange(d)},setTimeSlider:function(d){this.timeSlider&&(ya(this._tsTimeExtentChange_connect),this.timeSlider=
this._tsTimeExtentChange_connect=null);d&&(this.timeSlider=d,this.setTimeExtent(d.getCurrentTimeExtent()),this._tsTimeExtentChange_connect=xa(d,"onTimeExtentChange",this,"setTimeExtent"))},setVisibility:function(d){if(this.visible!==d){this.visible=d;d||(this._display=this.container.style.display);this.container.style.display=d?this._display:"none";if(this.autoResize){var h=d?"resume":"pause";this._rszSignal[h]();this._oriSignal[h]()}d&&this.resize()}return this},resize:function(d){clearTimeout(this._resizeTimerHandle);
this._destroyed||(!0===d?this._execResize():this._resizeTimerHandle=setTimeout(this._execResize,this.resizeDelay))},_timedResize:function(){this._resizeTimerHandle||this._execResize()},_execResize:function(){clearTimeout(this._resizeTimerHandle);this._resizeTimerHandle=null;this.reposition();this._resize();this.autoResize&&this._startResizeTimer()},_resize:function(){var d=this.width,h=this.height,l=q.get(this.container,"display"),r=w.getContentBox(this.container);if(!("none"===l||0>=r.w||0>=r.h||
d===r.w&&h===r.h)){if(l=this._zoomAnim||this._panAnim)l.stop(),l._fire("onEnd",[l.node]);ua(this.root,{width:(this.width=r.w)+"px",height:(this.height=r.h)+"px"});r=this.width;l=this.height;this.attribution&&this.attribution.domNode&&q.set(this.attribution.domNode,"maxWidth",Math.floor(r*this._mapParams.attributionWidth)+"px");this.__visibleRect.update(this.__visibleRect.x,this.__visibleRect.y,r,l);this.__visibleDelta.update(this.__visibleDelta.x,this.__visibleDelta.y,r,l);var y=new V(this.extent),
d=(new V(y.x,y.y,r/d*y.width,l/h*y.height,this.spatialReference)).getExtent();this.onResize(d,r,l);this._extentUtil(null,null,d,null,!0)}},reposition:function(){var d=this.position,h=d.x,l=d.y;this._reposition();d=this.position;if(h!==d.x||l!==d.y)this.onReposition(d.x,d.y)},_reposition:function(){var d=w.position(this.container,!0),h=w.getPadBorderExtents(this.container);this.position.update(d.x+h.l,d.y+h.t)},_setClipRect:function(){delete this._clip;var d=7>=C("ie")||void 0===C("ie")&&7<=C("trident")?
"rect(auto,auto,auto,auto)":"auto";if(this.wrapAround180){var h=this.width,l=this.height,r=this._getFrameWidth(),y=h-r;0<y&&(d=y/2,d="rect(0px,"+(d+r)+"px,"+l+"px,"+d+"px)",l=this.extent.getWidth(),h=r/h*l,this._clip=[(l-h)/2,h])}ua(this.__container,"clip",d)},_getAvailExtent:function(){var d=this.extent,h=this._clip;if(h){if(!d._clip){var l=new V(d);l.width=h[1];l.x+=h[0];d._clip=l.getExtent()}return d._clip}return d},_fixedPan:function(d,h){return this._extentUtil(null,{dx:d,dy:h})},panUp:function(){return this._fixedPan(0,
-.75*this.height)},panUpperRight:function(){return this._fixedPan(.75*this.width,-.75*this.height)},panRight:function(){return this._fixedPan(.75*this.width,0)},panLowerRight:function(){return this._fixedPan(.75*this.width,.75*this.height)},panDown:function(){return this._fixedPan(0,.75*this.height)},panLowerLeft:function(){return this._fixedPan(-.75*this.width,.75*this.height)},panLeft:function(){return this._fixedPan(-.75*this.width,0)},panUpperLeft:function(){return this._fixedPan(-.75*this.width,
-.75*this.height)},enableSnapping:function(d){d=d||{};if("esri.SnappingManager"===d.declaredClass)this.snappingManager=d;else{var h=ra++,l=this;this._rids&&this._rids.push(h);p(["./SnappingManager"],function(r){var y=l._rids?k.indexOf(l._rids,h):-1;-1!==y&&(l._rids.splice(y,1),l.snappingManager=new r(u.mixin({map:l},d)))})}return this.snappingManager},disableSnapping:function(){this.snappingManager&&this.snappingManager.destroy();this.snappingManager=null},_createLabelLayer:function(){!this._labels&&
Ca&&this.loaded&&(this._labels=new Ca({id:"_internal_LabelLayer"}),this._labels._setMap(this,this._gc._surface),this._processLabelLayers(),this.on("layers-reordered",this._processLabelLayers))},_processLabelLayers:function(){null==this._labelProcessor&&(this._labelProcessor=setTimeout(this._updateLabelLayers,0))},_updateLabelLayers:function(){this._labelProcessor=null;this._labels&&(this._labels.removeAllFeatureLayers(),k.forEach(this.graphicsLayerIds,function(d){d=this.getLayer(d);"function"===typeof d.applyEdits?
this._labels.addFeatureLayer(d):"esri.layers.WFSLayer"===d.declaredClass&&this._labels.addFeatureLayer(d)},this))},_getMapImageLyr:function(){this.loaded&&!this._mapImageLyr&&(this._mapImageLyr=new H,this._mapImageLyr._setMap(this,this._layersDiv),this._placeMapImageLyr());return this._mapImageLyr},_placeMapImageLyr:function(){for(var d=this.layerIds,h=this._layerDivs,l=!1,r,y,a=d.length-1;0<=a;a--)if(r=d[a],y=this.getLayer(r),r=h[r],y&&r&&!y._isReference){x.place(this._mapImageLyr._div,r,"after");
l=!0;break}l||x.place(this._mapImageLyr._div,this._layersDiv,"first")}})})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(p,g){var t=p.matrix={},v={};t._degToRad=function(g){return v[g]||(v[g]=Math.PI*g/180)};t._radToDeg=function(g){return g/Math.PI*180};t.Matrix2D=function(n){if(n)if("number"==typeof n)this.xx=this.yy=n;else if(n instanceof Array){if(0<n.length){for(var m=t.normalize(n[0]),u=1;u<n.length;++u){var k=m,f=t.normalize(n[u]),m=new t.Matrix2D;m.xx=k.xx*f.xx+
k.xy*f.yx;m.xy=k.xx*f.xy+k.xy*f.yy;m.yx=k.yx*f.xx+k.yy*f.yx;m.yy=k.yx*f.xy+k.yy*f.yy;m.dx=k.xx*f.dx+k.xy*f.dy+k.dx;m.dy=k.yx*f.dx+k.yy*f.dy+k.dy}g.mixin(this,m)}}else g.mixin(this,n)};g.extend(t.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});g.mixin(t,{identity:new t.Matrix2D,flipX:new t.Matrix2D({xx:-1}),flipY:new t.Matrix2D({yy:-1}),flipXY:new t.Matrix2D({xx:-1,yy:-1}),translate:function(g,m){return 1<arguments.length?new t.Matrix2D({dx:g,dy:m}):new t.Matrix2D({dx:g.x,dy:g.y})},scale:function(g,m){return 1<
arguments.length?new t.Matrix2D({xx:g,yy:m}):"number"==typeof g?new t.Matrix2D({xx:g,yy:g}):new t.Matrix2D({xx:g.x,yy:g.y})},rotate:function(g){var m=Math.cos(g);g=Math.sin(g);return new t.Matrix2D({xx:m,xy:-g,yx:g,yy:m})},rotateg:function(g){return t.rotate(t._degToRad(g))},skewX:function(g){return new t.Matrix2D({xy:Math.tan(g)})},skewXg:function(g){return t.skewX(t._degToRad(g))},skewY:function(g){return new t.Matrix2D({yx:Math.tan(g)})},skewYg:function(g){return t.skewY(t._degToRad(g))},reflect:function(g,
m){1==arguments.length&&(m=g.y,g=g.x);var u=g*g,k=m*m,f=u+k,e=2*g*m/f;return new t.Matrix2D({xx:2*u/f-1,xy:e,yx:e,yy:2*k/f-1})},project:function(g,m){1==arguments.length&&(m=g.y,g=g.x);var u=g*g,k=m*m,f=u+k,e=g*m/f;return new t.Matrix2D({xx:u/f,xy:e,yx:e,yy:k/f})},normalize:function(g){return g instanceof t.Matrix2D?g:new t.Matrix2D(g)},isIdentity:function(g){return 1==g.xx&&0==g.xy&&0==g.yx&&1==g.yy&&0==g.dx&&0==g.dy},clone:function(g){var m=new t.Matrix2D,u;for(u in g)"number"==typeof g[u]&&"number"==
typeof m[u]&&m[u]!=g[u]&&(m[u]=g[u]);return m},invert:function(g){g=t.normalize(g);var m=g.xx*g.yy-g.xy*g.yx;return g=new t.Matrix2D({xx:g.yy/m,xy:-g.xy/m,yx:-g.yx/m,yy:g.xx/m,dx:(g.xy*g.dy-g.yy*g.dx)/m,dy:(g.yx*g.dx-g.xx*g.dy)/m})},_multiplyPoint:function(g,m,u){return{x:g.xx*m+g.xy*u+g.dx,y:g.yx*m+g.yy*u+g.dy}},multiplyPoint:function(g,m,u){g=t.normalize(g);return"number"==typeof m&&"number"==typeof u?t._multiplyPoint(g,m,u):t._multiplyPoint(g,m.x,m.y)},multiplyRectangle:function(g,m){var u=t.normalize(g);
m=m||{x:0,y:0,width:0,height:0};if(t.isIdentity(u))return{x:m.x,y:m.y,width:m.width,height:m.height};g=t.multiplyPoint(u,m.x,m.y);var k=t.multiplyPoint(u,m.x,m.y+m.height),f=t.multiplyPoint(u,m.x+m.width,m.y);m=t.multiplyPoint(u,m.x+m.width,m.y+m.height);var u=Math.min(g.x,k.x,f.x,m.x),e=Math.min(g.y,k.y,f.y,m.y);return{x:u,y:e,width:Math.max(g.x,k.x,f.x,m.x)-u,height:Math.max(g.y,k.y,f.y,m.y)-e}},multiply:function(g){for(var m=t.normalize(g),u=1;u<arguments.length;++u){var k=m,f=t.normalize(arguments[u]),
m=new t.Matrix2D;m.xx=k.xx*f.xx+k.xy*f.yx;m.xy=k.xx*f.xy+k.xy*f.yy;m.yx=k.yx*f.xx+k.yy*f.yx;m.yy=k.yx*f.xy+k.yy*f.yy;m.dx=k.xx*f.dx+k.xy*f.dy+k.dx;m.dy=k.yx*f.dx+k.yy*f.dy+k.dy}return m},_sandwich:function(g,m,u){return t.multiply(t.translate(m,u),g,t.translate(-m,-u))},scaleAt:function(g,m,u,k){switch(arguments.length){case 4:return t._sandwich(t.scale(g,m),u,k);case 3:return"number"==typeof u?t._sandwich(t.scale(g),m,u):t._sandwich(t.scale(g,m),u.x,u.y)}return t._sandwich(t.scale(g),m.x,m.y)},rotateAt:function(g,
m,u){return 2<arguments.length?t._sandwich(t.rotate(g),m,u):t._sandwich(t.rotate(g),m.x,m.y)},rotategAt:function(g,m,u){return 2<arguments.length?t._sandwich(t.rotateg(g),m,u):t._sandwich(t.rotateg(g),m.x,m.y)},skewXAt:function(g,m,u){return 2<arguments.length?t._sandwich(t.skewX(g),m,u):t._sandwich(t.skewX(g),m.x,m.y)},skewXgAt:function(g,m,u){return 2<arguments.length?t._sandwich(t.skewXg(g),m,u):t._sandwich(t.skewXg(g),m.x,m.y)},skewYAt:function(g,m,u){return 2<arguments.length?t._sandwich(t.skewY(g),
m,u):t._sandwich(t.skewY(g),m.x,m.y)},skewYgAt:function(g,m,u){return 2<arguments.length?t._sandwich(t.skewYg(g),m,u):t._sandwich(t.skewYg(g),m.x,m.y)}});p.Matrix2D=t.Matrix2D;return t})},"esri/basemaps":function(){define(["require","dojo/has","./kernel","dojo/i18n!./nls/jsapi"],function(p,g,t,v){return{streets:{title:v.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"d8855ee4d3d74413babfb0f41203b168",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer"}]},
satellite:{title:v.basemaps.satellite,thumbnailUrl:p.toUrl("./images/basemap/satellite.jpg"),itemId:"86de95d4e0244cba80f0fa2c9403a7b2",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}]},hybrid:{title:v.basemaps.hybrid,thumbnailUrl:p.toUrl("./images/basemap/hybrid.jpg"),itemId:"413fd05bbd7342f5991d5ec96f4f8b18",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",
isReference:!0}]},terrain:{title:v.basemaps.terrain,thumbnailUrl:p.toUrl("./images/basemap/terrain.jpg"),itemId:"aab054ab883c4a4094c72e949566ad40",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",isReference:!0}]},topo:{title:v.basemaps.topo,thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"6e03e8c26aad4b9c92a87c1063ddb0e3",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer"}]},
gray:{title:v.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),itemId:"8b3b470883a744aeb60e5fff0a319ce7",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",isReference:!0}]},"dark-gray":{title:v.basemaps["dark-gray"],thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"da65bacab5bd4defb576f839b6b28098",
baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer"},{url:"https://services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",isReference:!0}]},oceans:{title:v.basemaps.oceans,thumbnailUrl:p.toUrl("./images/basemap/oceans.jpg"),itemId:"48b8cec7ebf04b5fbdcaf70d09daff21",baseMapLayers:[{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{url:"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",
isReference:!0}]},"national-geographic":{title:v.basemaps["national-geographic"],thumbnailUrl:p.toUrl("./images/basemap/national-geographic.jpg"),itemId:"509e2d6b034246d692a461724ae2d62c",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer"}]},osm:{title:v.basemaps.osm,thumbnailUrl:p.toUrl("./images/basemap/osm.jpg"),itemId:"5d2bfa736f8448b3a1708e1f6be23eed",baseMapLayers:[{type:"OpenStreetMap"}]},"dark-gray-vector":{title:v.basemaps["dark-gray"],
thumbnailUrl:p.toUrl("./images/basemap/dark-gray.jpg"),itemId:"c11ce4f7801740b2905eb03ddc963ac8",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/c11ce4f7801740b2905eb03ddc963ac8/resources/styles/root.json",type:"VectorTile"}]},"gray-vector":{title:v.basemaps.gray,thumbnailUrl:p.toUrl("./images/basemap/gray.jpg"),itemId:"8a2cba3b0ebf4140b7c0dc5ee149549a",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/8a2cba3b0ebf4140b7c0dc5ee149549a/resources/styles/root.json",
type:"VectorTile"}]},"streets-vector":{title:v.basemaps.streets,thumbnailUrl:p.toUrl("./images/basemap/streets.jpg"),itemId:"de26a3cf4cc9451298ea173c4b324736",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",type:"VectorTile"}]},"topo-vector":{title:v.basemaps.topo,thumbnailUrl:p.toUrl("./images/basemap/topo.jpg"),itemId:"7dc6cea0b1764a1f9af2e679f642f0f5",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",
type:"VectorTile"}]},"streets-night-vector":{title:v.basemaps["streets-night-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-night.jpg"),itemId:"86f556a2d1fd468181855a35e344567f",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",type:"VectorTile"}]},"streets-relief-vector":{title:v.basemaps["streets-relief-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-relief.jpg"),itemId:"b266e6d17fc345b498345613930fbd76",
baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",type:"VectorTile"}]},"streets-navigation-vector":{title:v.basemaps["streets-navigation-vector"],thumbnailUrl:p.toUrl("./images/basemap/streets-navigation.jpg"),itemId:"63c47b7177f946b49902c24129b87252",baseMapLayers:[{url:"https://www.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",type:"VectorTile"}]}}})},"esri/Evented":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/Evented dojo/has ./kernel".split(" "),
function(p,g,t,v,n,m){return p([v],{declaredClass:"esri.Evented",registerConnectEvents:function(){var m=this.constructor,k=this.constructor._meta.parents,f=[{}],e={},b,a,c=function(a,b){g.isArray(a)||(a=[a]);for(var e=0;e<a.length;e++){var f=a[e];f._meta&&f._meta.parents&&c(f._meta.parents,b);f.prototype._eventMap&&b.push(g.mixin({},f.prototype._eventMap))}return b};if(!m._onMap){c(k,f);f.push(this._eventMap);k=g.mixin.apply(this,f);for(b in this)/^on\w/.test(b)&&g.isFunction(this[b])&&(f=this._hyphenLower(b).toLowerCase(),
k[f]||(e[f]={method:b}));for(a in k)b=this._onCamelCase(a),e[a]={method:b,argKeys:k[a]};m._onMap=e;return m._onMap}},on:function(m,k){if(-1<m.indexOf(",")){for(var f=m.split(/\s*,\s*/),e=f.length,b=[];e--;)b.push(this.on(f[e],k));b.remove=function(){for(var a=0;a<b.length;a++)b[a].remove()};return b}var f=this.constructor._onMap||this.registerConnectEvents(),e="string"==typeof m&&m.toLowerCase(),a=this._onCamelCase(e),c=f&&f[e];return(a=c&&c.method||this[a]&&g.isFunction(this[a])&&a)?c&&g.isArray(c.argKeys)?
(f=this._onArr2Obj(k,f[e].argKeys),t.after(this,a,f,!0)):t.after(this,a,function(a){a=a||{};a.target||(a.target=this);k.call(this,a)},!0):this.inherited(arguments)},emit:function(m,k){var f,e,b,a,c=m.toLowerCase();a=this._onCamelCase(m);var x=this.constructor._onMap||this.registerConnectEvents();a=(b=x&&x[c]&&x[c].method||g.isFunction(this[a])&&a)&&this[b];b&&x&&x[c]&&this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},x[c].argKeys)(k);k=k||{};k.target||(k.target=this);a&&(f=e&&e.length?
e:[k],f=a.apply(this,f));this.inherited(arguments,[m,k]);return f},_onObj2Arr:function(m,k){if(k){var f=this;return function(e){var b,a=[],c=k.length;for(b=0;b<c;b++)a[b]=e[k[b]];m.apply(f,a)}}return m},_onArr2Obj:function(m,k){if(k){var f=this;return function(){var e,b={},a=arguments.length;for(e=0;e<a;e++)b[k[e]]=arguments[e];b.target||(b.target=f);m.call(f,b)}}return m},_hyphenLower:function(m){return m.replace(/^on/,"").replace(/[A-Z](?=[a-z])/g,function(k,f){return(f?"-":"")+k.toLowerCase()})},
_onCamelCase:function(m){return"on"+m.substr(0,1).toUpperCase()+m.substr(1).replace(/\-([a-z])/g,function(k,f){return f.toUpperCase()})}})})},"esri/fx":function(){define("dojo/_base/connect dojo/_base/fx dojo/_base/lang dojo/dom dojo/dom-geometry dojo/dom-style dojo/fx dojo/has ./kernel".split(" "),function(p,g,t,v,n,m,u,k,f){return{animateRange:function(e){var b=e.range;return new g.Animation(t.mixin({curve:new g._Line(b.start,b.end)},e))},resize:function(e){var b=e.node=v.byId(e.node),a=e.start,
c=e.end;a||(a=n.getMarginBox(b),b=n.getPadBorderExtents(b),a=e.start={left:a.l+b.l,top:a.t+b.t,width:a.w-b.w,height:a.h-b.h});c||(c=e.anchor?e.anchor:{x:a.left,y:a.top},b=e.size,c=e.end={left:a.left-(b.width-a.width)*(c.x-a.left)/a.width,top:a.top-(b.height-a.height)*(c.y-a.top)/a.height,width:b.width,height:b.height});return g.animateProperty(t.mixin({properties:{left:{start:a.left,end:c.left},top:{start:a.top,end:c.top},width:{start:a.width,end:c.width},height:{start:a.height,end:c.height}}},e))},
slideTo:function(e){var b=e.node=v.byId(e.node),a=m.getComputedStyle,c=null,f=null,w=function(){return function(){var e="absolute"==b.style.position?"absolute":"relative";c="absolute"==e?b.offsetTop:parseInt(a(b).top)||0;f="absolute"==e?b.offsetLeft:parseInt(a(b).left)||0;"absolute"!=e&&"relative"!=e&&(e=n.position(b,!0),c=e.y,f=e.x,b.style.position="absolute",b.style.top=c+"px",b.style.left=f+"px")}}();w();e=g.animateProperty(t.mixin({properties:{top:{start:c,end:e.top||0},left:{start:f,end:e.left||
0}}},e));p.connect(e,"beforeBegin",e,w);return e},flash:function(e){e=t.mixin({end:"#f00",duration:500,count:1},e);e.duration/=2*e.count;var b=v.byId(e.node),a=e.start;a||(a=m.getComputedStyle(b).backgroundColor);var c=e.end,f=[],w=e.count,b={node:b,duration:e.duration};for(e=0;e<w;e++)f.push(g.animateProperty(t.mixin({properties:{backgroundColor:{start:a,end:c}}},b))),f.push(g.animateProperty(t.mixin({properties:{backgroundColor:{start:c,end:a}}},b)));return u.chain(f)}}})},"dojo/fx":function(){define("./_base/lang ./Evented ./_base/kernel ./_base/array ./aspect ./_base/fx ./dom ./dom-style ./dom-geometry ./ready require".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){t.isAsync||e(0,function(){b(["./fx/Toggler"])});t=t.fx={};e={_fire:function(a,b){this[a]&&this[a].apply(this,b||[]);return this}};var a=function(a){this._index=-1;this._animations=a||[];this._current=this._onAnimateCtx=this._onEndCtx=null;this.duration=0;v.forEach(this._animations,function(a){a&&("undefined"!=typeof a.duration&&(this.duration+=a.duration),a.delay&&(this.duration+=a.delay))},this)};a.prototype=new g;p.extend(a,{_onAnimate:function(){this._fire("onAnimate",
arguments)},_onEnd:function(){this._onAnimateCtx.remove();this._onEndCtx.remove();this._onAnimateCtx=this._onEndCtx=null;this._index+1==this._animations.length?this._fire("onEnd"):(this._current=this._animations[++this._index],this._onAnimateCtx=n.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0),this._onEndCtx=n.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0),this._current.play(0,!0))},play:function(a,b){this._current||(this._current=this._animations[this._index=0]);if(!b&&"playing"==
this._current.status())return this;var c=n.after(this._current,"beforeBegin",p.hitch(this,function(){this._fire("beforeBegin")}),!0),e=n.after(this._current,"onBegin",p.hitch(this,function(a){this._fire("onBegin",arguments)}),!0),f=n.after(this._current,"onPlay",p.hitch(this,function(a){this._fire("onPlay",arguments);c.remove();e.remove();f.remove()}));this._onAnimateCtx&&this._onAnimateCtx.remove();this._onAnimateCtx=n.after(this._current,"onAnimate",p.hitch(this,"_onAnimate"),!0);this._onEndCtx&&
this._onEndCtx.remove();this._onEndCtx=n.after(this._current,"onEnd",p.hitch(this,"_onEnd"),!0);this._current.play.apply(this._current,arguments);return this},pause:function(){if(this._current){var a=n.after(this._current,"onPause",p.hitch(this,function(b){this._fire("onPause",arguments);a.remove()}),!0);this._current.pause()}return this},gotoPercent:function(a,b){this.pause();var c=this.duration*a;this._current=null;v.some(this._animations,function(a,b){if(c<=a.duration)return this._current=a,this._index=
b,!0;c-=a.duration;return!1},this);this._current&&this._current.gotoPercent(c/this._current.duration);b&&this.play();return this},stop:function(a){if(this._current){if(a){for(;this._index+1<this._animations.length;++this._index)this._animations[this._index].stop(!0);this._current=this._animations[this._index]}var b=n.after(this._current,"onStop",p.hitch(this,function(a){this._fire("onStop",arguments);b.remove()}),!0);this._current.stop()}return this},status:function(){return this._current?this._current.status():
"stopped"},destroy:function(){this.stop();this._onAnimateCtx&&this._onAnimateCtx.remove();this._onEndCtx&&this._onEndCtx.remove()}});p.extend(a,e);t.chain=function(b){return new a(p.isArray(b)?b:Array.prototype.slice.call(b,0))};var c=function(a){this._animations=a||[];this._connects=[];this.duration=this._finished=0;v.forEach(a,function(a){var b=a.duration;a.delay&&(b+=a.delay);this.duration<b&&(this.duration=b);this._connects.push(n.after(a,"onEnd",p.hitch(this,"_onEnd"),!0))},this);this._pseudoAnimation=
new m.Animation({curve:[0,1],duration:this.duration});var b=this;v.forEach("beforeBegin onBegin onPlay onAnimate onPause onStop onEnd".split(" "),function(a){b._connects.push(n.after(b._pseudoAnimation,a,function(){b._fire(a,arguments)},!0))})};p.extend(c,{_doAction:function(a,b){v.forEach(this._animations,function(c){c[a].apply(c,b)});return this},_onEnd:function(){++this._finished>this._animations.length&&this._fire("onEnd")},_call:function(a,b){var c=this._pseudoAnimation;c[a].apply(c,b)},play:function(a,
b){this._finished=0;this._doAction("play",arguments);this._call("play",arguments);return this},pause:function(){this._doAction("pause",arguments);this._call("pause",arguments);return this},gotoPercent:function(a,b){var c=this.duration*a;v.forEach(this._animations,function(a){a.gotoPercent(a.duration<c?1:c/a.duration,b)});this._call("gotoPercent",arguments);return this},stop:function(a){this._doAction("stop",arguments);this._call("stop",arguments);return this},status:function(){return this._pseudoAnimation.status()},
destroy:function(){this.stop();v.forEach(this._connects,function(a){a.remove()})}});p.extend(c,e);t.combine=function(a){return new c(p.isArray(a)?a:Array.prototype.slice.call(a,0))};t.wipeIn=function(a){var b=a.node=u.byId(a.node),c=b.style,e;a=m.animateProperty(p.mixin({properties:{height:{start:function(){e=c.overflow;c.overflow="hidden";if("hidden"==c.visibility||"none"==c.display)return c.height="1px",c.display="",c.visibility="",1;var a=k.get(b,"height");return Math.max(a,1)},end:function(){return b.scrollHeight}}}},
a));var f=function(){c.height="auto";c.overflow=e};n.after(a,"onStop",f,!0);n.after(a,"onEnd",f,!0);return a};t.wipeOut=function(a){var b=(a.node=u.byId(a.node)).style,c;a=m.animateProperty(p.mixin({properties:{height:{end:1}}},a));n.after(a,"beforeBegin",function(){c=b.overflow;b.overflow="hidden";b.display=""},!0);var e=function(){b.overflow=c;b.height="auto";b.display="none"};n.after(a,"onStop",e,!0);n.after(a,"onEnd",e,!0);return a};t.slideTo=function(a){var b=null,c=null,e=function(a){return function(){var e=
k.getComputedStyle(a),q=e.position;b="absolute"==q?a.offsetTop:parseInt(e.top)||0;c="absolute"==q?a.offsetLeft:parseInt(e.left)||0;"absolute"!=q&&"relative"!=q&&(e=f.position(a,!0),b=e.y,c=e.x,a.style.position="absolute",a.style.top=b+"px",a.style.left=c+"px")}}(a.node=u.byId(a.node));e();a=m.animateProperty(p.mixin({properties:{top:a.top||0,left:a.left||0}},a));n.after(a,"beforeBegin",e,!0);return a};return t})},"esri/tileUtils":function(){define(["dojo/_base/array","dojo/has","./kernel","./geometry/Point",
"./geometry/Extent"],function(p,g,t,v,n){return{_addFrameInfo:function(m,g){var k,f,e=2*g.origin[1],b=g.origin[0],a=m.origin.x,c=m.width,x;p.forEach(m.lods,function(w){k=Math.round(e/w.resolution);f=Math.ceil(k/c);x=Math.floor((b-a)/(c*w.resolution));w._frameInfo||(w._frameInfo=[f,x,x+f-1,k])})},getContainingTileCoords:function(m,g,k){var f=m.origin;k=k.resolution;return{row:Math.floor((f.y-g.y)/(m.height*k)),col:Math.floor((g.x-f.x)/(m.width*k))}},getCandidateTileInfo:function(m,g,k){var f;f=m.width;
for(var e=m.height,b=k.xmax-k.xmin,a=k.ymax-k.ymin,c=m.__tileInfo===g,x=c?m.getMinZoom():-1,c=c?m.getMaxZoom():-1,w=-1,q=g.lods,C=Math.abs,z,u,B,c=-1<c?c:q.length-1,x=-1<x?x:0;x<=c;x++)if(u=q[x])if(B=b>a?C(a-e*u.resolution):C(b-f*u.resolution),0>w||B<=w)z=u,w=B;else break;f=z;z=f.resolution;e=(k.xmin+k.xmax)/2;b=(k.ymin+k.ymax)/2;a=m.width/2*z;z*=m.height/2;e=new n(e-a,b-z,e+a,b+z,k.spatialReference);k=new v(e.xmin,e.ymax,k.spatialReference);c=f.resolution;a=g.width;b=g.height;g=g.origin;m=m.__visibleDelta;
z=Math.floor;q=a*c;C=b*c;c=z((g.y-k.y)/C);w=z((k.x-g.x)/q);x=g.y-c*C;g=z(Math.abs((k.x-(g.x+w*q))*a/q))+m.x;m=z(Math.abs((k.y-x)*b/C))+m.y;return{tile:{point:k,coords:{row:c,col:w},offsets:{x:g,y:m}},lod:f,extent:e}},getTileExtent:function(m,g,k,f){var e=m.origin;g=m.lods[g].resolution;var b=m.width,a=m.height;return new n(f*g*b+e.x,e.y-(k+1)*g*a,(f+1)*g*b+e.x,e.y-k*g*a,m.spatialReference)}}})},"esri/geometry/Point":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ../srUtils".split(" "),
function(p,g,t,v,n,m,u,k){function f(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function e(a,b,c){a=a/6378137*57.29577951308232;return c?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function b(){}function a(){}function c(a){var b=a._json;a._unquantizeFn?
(b=a._unquantizeFn({x:b.x,y:b.y}),a._xVal=b.x,a._yVal=b.y,a._unquantizeFn=null):(a._xVal=b.x,a._yVal=b.y);a._json=null}p=p(u,{declaredClass:"esri.geometry.Point",type:"point",x:0,y:0,constructor:function(a,b,c){g.isArray(a)?(this.x=a[0],this.y=a[1],this.spatialReference=b):n.isObject(a)?(n.mixin(this,a),null!=this.latitude&&(this.y=this.latitude),null!=this.longitude&&(this.x=this.longitude),this.spatialReference&&(this.spatialReference=k.createSpatialReference(this.spatialReference))):(this.x=a,
this.y=b,this.spatialReference=c);this.verifySR()},offset:function(a,b){return new this.constructor(this.x+a,this.y+b,this.spatialReference)},setX:function(a){this.x=a;this.clearCache();return this},setY:function(a){this.y=a;this.clearCache();return this},setLongitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setX(f(a,this.y)[0]):4326===b.wkid&&this.setX(a));return this},setLatitude:function(a){var b=this.spatialReference;b&&(b._isWebMercator()?this.setY(f(this.x,a)[1]):
4326===b.wkid&&this.setY(a));return this},getLongitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=e(this.x,this.y)[0]:4326===a.wkid&&(b=this.x));return b},getLatitude:function(){var a=this.spatialReference,b;a&&(a._isWebMercator()?b=e(this.x,this.y)[1]:4326===a.wkid&&(b=this.y));return b},update:function(a,b){this.x=a;this.y=b;this.clearCache();return this},normalize:function(){var a=this.x,b=this.spatialReference;if(b){var c=b._getInfo();c&&(a=this._normalizeX(a,c))}return new this.constructor(a,
this.y,b)},_normalizeX:function(a,b){var c=b.valid[0],e=b.valid[1];b=2*e;a>e?(c=Math.ceil(Math.abs(a-e)/b),a-=c*b):a<c&&(c=Math.ceil(Math.abs(a-c)/b),a+=c*b);return a},toJson:function(){var a={x:this.x,y:this.y},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});b.prototype=p.prototype;a.prototype=new b;Object.defineProperty(a.prototype,"x",{get:function(){this._json&&c(this);return this._xVal},set:function(a){this._xVal=a}});Object.defineProperty(a.prototype,"y",{get:function(){this._json&&
c(this);return this._yVal},set:function(a){this._yVal=a}});a.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._json=b};p.simpleConstructor=b;p.accessorConstructor=a;p.lngLatToXY=f;p.xyToLngLat=e;p.defaultProps={type:"point",x:0,y:0};p.metersPerDegree=6378137*Math.PI/180;return p})},"esri/geometry/Geometry":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../SpatialReference"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.geometry.Geometry",
spatialReference:null,type:null,cache:void 0,setSpatialReference:function(m){this.spatialReference=m;return this},verifySR:function(){this.spatialReference||this.setSpatialReference(new n(4326))},getExtent:function(){return null},clearCache:function(){this.cache=void 0},getCacheValue:function(m){return this.cache&&this.cache[m]},setCacheValue:function(m,g){this.cache||(this.cache={});this.cache[m]=g}})})},"esri/srUtils":function(){define(["./SpatialReference","./ImageSpatialReference","./kernel",
"./sniff","dojo/_base/lang"],function(p,g,t,v,n){function m(m){var k=!1;m&&(m.ics||m.icsid)&&(k=!0);return k}return{isICS:m,createSpatialReference:function(u){var k=null;u&&(k=m(u)?new g(u):new p(u));return k}}})},"esri/ImageSpatialReference":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./lang ./SpatialReference".split(" "),function(p,g,t,v,n,m){return p(m,{declaredClass:"esri.ImageSpatialReference",constructor:function(m){m&&g.isObject(m)&&g.mixin(this,m)},icsid:null,icsns:null,
ics:null,_isWebMercator:function(){return!1},_isWrappable:function(){return!1},equals:function(m){var k=!1;if(m)if(this.icsid&&m.icsid){if(k=this.icsid===m.icsid,this.icsns||m.icsns)k=k&&this.icsns===m.icsns}else this.ics&&m.ics&&(k=this.ics===m.ics);return k},toJson:function(m){var k=null,f=n.isDefined;m=f(m)?m:!0;f(this.icsid)?(k={icsid:this.icsid},f(this.icsns)&&(k.icsns=this.icsns)):f(this.ics)&&(k={ics:this.ics});f(this.url)&&f(k)&&m&&(k.url=this.url);return k}})})},"esri/geometry/Extent":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./webMercatorUtils ./mathUtils ../srUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){function c(){}var x=p(k,{declaredClass:"esri.geometry.Extent",type:"extent",xmin:0,ymin:0,xmax:0,ymax:0,constructor:function(b,c,e,f,x){m.isObject(b)?(m.mixin(this,b),this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference))):this.update(b,c,e,f,x);this.verifySR()},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-this.ymin)},getCenter:function(){return new f((this.xmin+this.xmax)/
2,(this.ymin+this.ymax)/2,this.spatialReference)},getTopLeft:function(){return new f(this.xmin,this.ymax,this.spatialReference)},getTopRight:function(){return new f(this.xmax,this.ymax,this.spatialReference)},getBottomLeft:function(){return new f(this.xmin,this.ymin,this.spatialReference)},getBottomRight:function(){return new f(this.xmax,this.ymin,this.spatialReference)},centerAt:function(a){var b=this.getCenter(),c=a.x-b.x;a=a.y-b.y;return new x(this.xmin+c,this.ymin+a,this.xmax+c,this.ymax+a,this.spatialReference)},
update:function(a,b,c,e,f){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=e;this.spatialReference=f;this.clearCache();return this},offset:function(a,b){return new x(this.xmin+a,this.ymin+b,this.xmax+a,this.ymax+b,this.spatialReference)},expand:function(a){var b=(1-a)/2;a=this.getWidth()*b;b*=this.getHeight();return new x(this.xmin+a,this.ymin+b,this.xmax-a,this.ymax-b,this.spatialReference)},intersects:function(a){if(!a)return!1;var b=a.type,c=this.spatialReference,f=a.spatialReference;c&&f&&!c.equals(f)&&
c._canProject(f)&&(a=c.isWebMercator()?e.geographicToWebMercator(a):e.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);t.isArray(a)||(a=[a]);return a},shiftCentralMeridian:function(){return this._normalize(!0)},bisect:function(){var a=
this.spatialReference,b=a&&a._getInfo(),c=[],e=0;if(b&&this._isOutOfBounds(b)){var f=this,e=f.xmin,k=f.ymin,m=f.ymax,g=b.valid[0],n=b.valid[1];f.getWidth()>2*n&&(f=f.getCenter(),f=new x(f.x-n,k,f.x+n,m,new u(a.toJson())));var e=f.xmin-e,p=this._normalizeX(f.xmin,b),b=this._normalizeX(f.xmax,b);p.frameId===b.frameId?c.push(new x(p.x,k,b.x,m,new u(a.toJson()))):c.push(new x(p.x,k,n,m,new u(a.toJson())),new x(g,k,b.x,m,new u(a.toJson())))}else c.push(this.getExtent());return{extents:c,marginLeft:e}},
_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c,e,f,w=!1;this.xmin<=a.xmin?(b=a.xmin,this.xmax<b?w=!0:e=Math.min(this.xmax,a.xmax)-b):(b=this.xmin,a.xmax<b?w=!0:e=Math.min(this.xmax,a.xmax)-b);this.ymin<=a.ymin?(c=a.ymin,this.ymax<c?w=!0:f=Math.min(this.ymax,a.ymax)-c):(c=this.ymin,a.ymax<c?w=!0:f=Math.min(this.ymax,a.ymax)-c);return w?null:new x(b,c,b+e,c+f,this.spatialReference)},_intersectsPolygon:function(a){var b=
[this.xmin,this.ymax],c=[this.xmax,this.ymax],e=[this.xmin,this.ymin],w=[this.xmax,this.ymin],x=[b,c,e,w],b=[[e,b],[b,c],[c,w],[w,e]],e=a.rings,w=e.length,k,m=new f(0,0,this.spatialReference);k=x.length;for(c=0;c<k;c++)if(m.update(x[c][0],x[c][1]),a.contains(m))return!0;m.setSpatialReference(a.spatialReference);for(var g,u,c=0;c<w;c++)if(x=e[c],k=x.length){g=x[0];m.update(g[0],g[1]);if(this.contains(m))return!0;for(a=1;a<k;a++){u=x[a];m.update(u[0],u[1]);if(this.contains(m)||this._intersectsLine([g,
u],b))return!0;g=u}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,e=a.paths,w=e.length,x,k,m,g,u=new f(0,0,a.spatialReference);for(a=0;a<w;a++)if(x=e[a],k=x.length){m=x[0];u.update(m[0],m[1]);if(this.contains(u))return!0;for(c=1;c<k;c++){g=x[c];u.update(g[0],g[1]);if(this.contains(u)||this._intersectsLine([m,g],
b))return!0;m=g}}return!1},_intersectsLine:function(a,c){var e=b._getLineIntersection2,f,q=c.length;for(f=0;f<q;f++)if(e(a,c[f]))return!0;return!1},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,e=a.spatialReference,b=a.x;a=a.y;c&&e&&!c.equals(e)&&c._canProject(e)&&(a=c.isWebMercator()?f.lngLatToXY(b,a):f.xyToLngLat(b,a,!0),b=a[0],a=a[1]);return b>=this.xmin&&b<=this.xmax&&a>=this.ymin&&a<=this.ymax}return"extent"===b?this._containsExtent(a):!1},_containsExtent:function(a){var b=
a.xmin,c=a.ymin,e=a.xmax,w=a.ymax,x=a.spatialReference;a=new f(b,c,x);b=new f(b,w,x);w=new f(e,w,x);c=new f(e,c,x);return this.contains(a)&&this.contains(b)&&this.contains(w)&&this.contains(c)?!0:!1},union:function(a){return new x(Math.min(this.xmin,a.xmin),Math.min(this.ymin,a.ymin),Math.max(this.xmax,a.xmax),Math.max(this.ymax,a.ymax),this.spatialReference)},getExtent:function(){var a=this.spatialReference;return new x(this.xmin,this.ymin,this.xmax,this.ymax,a&&new u(a.toJson()))},_shiftCM:function(a){var b=
this.getCacheValue("_shifted");if(!b){var b=new x(this.toJson()),c=b.spatialReference;if(a=a||c._getInfo()){var f=this._getCM(a);if(f){var w=c._isWebMercator()?e.webMercatorToGeographic(f):f;b.xmin-=f.x;b.xmax-=f.x;c._isWebMercator()||(w.x=this._normalizeX(w.x,a).x);b.setSpatialReference(new u(m.substitute({Central_Meridian:w.x},4326===c.wkid?a.altTemplate:a.wkTemplate)))}}this.setCacheValue("_shifted",b)}return b},_getCM:function(a){var b;this._isOutOfBounds(a)&&(b=this.getCenter());return b},_isOutOfBounds:function(a){var b=
a.valid[0];a=a.valid[1];var c=this.xmin,e=this.xmax;return!(c>=b&&c<=a&&e>=b&&e<=a)},_normalize:function(a,b,c){var e=new x(this.toJson()),f=e.spatialReference;if(f&&(c=c||f._getInfo())){var q=g.map(this._getParts(c),function(a){return a.extent});return 2<q.length?a?this._shiftCM(c):e.update(c.valid[0],e.ymin,c.valid[1],e.ymax,f):2===q.length?a?this._shiftCM(c):b?q:{rings:g.map(q,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]}),spatialReference:f}:
q[0]||e}return e},_getParts:function(a){var b=this.getCacheValue("_parts");if(!b){var b=[],c=this.xmin,e=this.xmax,f=this.ymin,w=this.ymax,k=this.spatialReference,m=this.getWidth(),g=c,u=e,n=0,p=0,v,t;a=a||k._getInfo();v=a.valid[0];t=a.valid[1];p=this._normalizeX(c,a);c=p.x;n=p.frameId;p=this._normalizeX(e,a);e=p.x;p=p.frameId;a=c===e&&0<m;if(m>2*t){m=new x(g<u?c:e,f,t,w,k);c=new x(v,f,g<u?e:c,w,k);t=new x(0,f,t,w,k);f=new x(v,f,0,w,k);k=[];v=[];m.contains(t)&&k.push(n);m.contains(f)&&v.push(n);c.contains(t)&&
k.push(p);c.contains(f)&&v.push(p);for(w=n+1;w<p;w++)k.push(w),v.push(w);b.push({extent:m,frameIds:[n]},{extent:c,frameIds:[p]},{extent:t,frameIds:k},{extent:f,frameIds:v})}else c>e||a?b.push({extent:new x(c,f,t,w,k),frameIds:[n]},{extent:new x(v,f,e,w,k),frameIds:[p]}):b.push({extent:new x(c,f,e,w,k),frameIds:[n]});this.setCacheValue("_parts",b)}return b},_normalizeX:function(a,b){var c=0,e=b.valid[0],f=b.valid[1];b=2*f;a>f?(c=Math.ceil(Math.abs(a-f)/b),a-=c*b):a<e&&(c=Math.ceil(Math.abs(a-e)/b),
a+=c*b,c=-c);return{x:a,frameId:c}},toJson:function(){var a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});c.prototype=x.prototype;x.simpleConstructor=c;x.defaultProps={type:"extent",xmin:0,ymin:0,xmax:0,ymax:0};return x})},"esri/geometry/webMercatorUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has ../kernel ../SpatialReference ./Point".split(" "),function(p,g,t,v,n,m){function u(f,e,b,a){if("point"===
f.type){var c=e(f.x,f.y,a);return new f.constructor(c[0],c[1],new n(b))}if("extent"===f.type){var c=e(f.xmin,f.ymin,a),x=e(f.xmax,f.ymax,a);return new f.constructor(c[0],c[1],x[0],x[1],new n(b))}if("polyline"===f.type||"polygon"===f.type){var c="polyline"===f.type,w=[],q;p.forEach(c?f.paths:f.rings,function(b){w.push(q=[]);p.forEach(b,function(b){q.push(e(b[0],b[1],a))})});return c?new f.constructor({paths:w,spatialReference:new n(b)}):new f.constructor({rings:w,spatialReference:new n(b)})}if("multipoint"===
f.type){var k=[];p.forEach(f.points,function(b){k.push(e(b[0],b[1],a))});return new f.constructor({points:k,spatialReference:new n(b)})}}function k(f,e){f=f&&(null!=f.wkid?f:f.spatialReference);e=e&&(null!=e.wkid?e:e.spatialReference);return f&&e?e.equals(f)?!0:e._canProject(f):!1}return{canProject:k,project:function(f,e){var b=f&&f.spatialReference;e=e&&(null!=e.wkid?e:e.spatialReference);b&&e?b.equals(e)?f=new f.constructor(f.toJson()):k(b,e)?e.isWebMercator()?f=u(f,m.lngLatToXY,{wkid:102100}):
4326===e.wkid&&(f=u(f,m.xyToLngLat,{wkid:4326})):f=null:f=null;return f},lngLatToXY:m.lngLatToXY,xyToLngLat:m.xyToLngLat,metersPerDegree:m.metersPerDegree,geographicToWebMercator:function(f){return u(f,m.lngLatToXY,{wkid:102100})},webMercatorToGeographic:function(f,e){return u(f,m.xyToLngLat,{wkid:4326},e)}}})},"esri/geometry/mathUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,g,t,v){function n(k,f,e){return k instanceof v?new v(k.x+e*(f.x-k.x),k.y+e*(f.y-
k.y)):[k[0]+e*(f[0]-k[0]),k[1]+e*(f[1]-k[1])]}function m(k,f){return 1E-8>Math.abs(k-f)}function u(k,f,e,b){var a,c=m(k[0],f[0])?1E10:(k[1]-f[1])/(k[0]-f[0]),x=m(e[0],b[0])?1E10:(e[1]-b[1])/(e[0]-b[0]),w=k[1]-c*k[0],q=e[1]-x*e[0];if(m(c,x)){if(m(w,q)){if(m(k[0],f[0]))if(Math.min(k[1],f[1])<Math.max(e[1],b[1])||Math.max(k[1],f[1])>Math.min(e[1],b[1]))k=(k[1]+f[1]+e[1]+b[1]-Math.min(k[1],f[1],e[1],b[1])-Math.max(k[1],f[1],e[1],b[1]))/2,a=(k-w)/c;else return null;else if(Math.min(k[0],f[0])<Math.max(e[0],
b[0])||Math.max(k[0],f[0])>Math.min(e[0],b[0]))a=(k[0]+f[0]+e[0]+b[0]-Math.min(k[0],f[0],e[0],b[0])-Math.max(k[0],f[0],e[0],b[0]))/2,k=c*a+w;else return null;return[a,k]}return null}m(c,1E10)?(a=k[0],k=x*a+q):m(x,1E10)?(a=e[0],k=c*a+w):(a=-(w-q)/(c-x),k=k[1]===f[1]?k[1]:e[1]===b[1]?e[1]:c*a+w);return[a,k]}return{getLength:function(k,f){var e=f.x-k.x;k=f.y-k.y;return Math.sqrt(e*e+k*k)},_getLength:function(k,f){var e=f[0]-k[0];k=f[1]-k[1];return Math.sqrt(e*e+k*k)},getPointOnLine:n,getMidpoint:function(k,
f){return n(k,f,.5)},_equals:m,_getLineIntersection:u,getLineIntersection:function(k,f,e,b,a){(k=u([k.x,k.y],[f.x,f.y],[e.x,e.y],[b.x,b.y]))&&(k=new v(k[0],k[1],a));return k},_getLineIntersection2:function(k,f){var e=k[0],b=k[1],a=f[0],c=f[1];f=e[0];e=e[1];k=b[0];var b=b[1],x=a[0],w=a[1],a=c[0]-x,x=f-x,q=k-f,c=c[1]-w,w=e-w,m=b-e,g=c*q-a*m;if(0===g)return!1;a=(a*w-c*x)/g;x=(q*w-m*x)/g;return 0<=a&&1>=a&&0<=x&&1>=x?[f+a*(k-f),e+a*(b-e)]:!1},_pointLineDistance:function(k,f){var e=f[0],b=f[1];f=e[0];
var a=e[1],e=k[0];k=k[1];var c=b[0]-f,x=b[1]-a,w=e-f,q=k-a,b=Math.sqrt,m=Math.pow,g=b(m(c,2)+m(x,2)),w=(w*c+q*x)/(g*g),a=a+w*x;return b(m(e-(f+w*c),2)+m(k-a,2))}}})},"esri/PluginTarget":function(){define("require dojo/aspect dojo/_base/array dojo/_base/lang dojo/Deferred dojo/when".split(" "),function(p,g,t,v,n,m){function u(){g.after(this.constructor._meta,"ctor",this._pluginsHandler,!0);this._plugins={}}u.prototype={addPlugin:function(k,f){var e=this,b=this._plugins,a=new n;try{p([k],function(c){k in
b?a.resolve({id:b[k].declaredId||k.replace(/\//g,".")}):(b[k]=c,m(c.add(e,f),function(){var b={id:c.declaredId||k.replace(/\//g,".")};e.emit("plugin-add",b);a.resolve(b)},function(b){a.reject(b)}))})}catch(c){a.reject(c)}return a.promise},removePlugin:function(k){if(k in this._plugins){var f=this._plugins[k];f.remove(this);delete this._plugins[k];this.emit("plugin-remove",{id:f.declaredId||k.replace(/\//g,".")})}},_pluginsHandler:function(){var k=this;t.some(arguments,function(f){if(f&&f.plugins&&
f.plugins instanceof Array){f=f.plugins;var e,b,a;for(a=0;a<f.length;a++)e=f[a],b=e instanceof Object?e.id:e,k.addPlugin(b,e.options);return!0}})}};return u})},"esri/arcade/Dictionary":function(){define(["require","exports","./ImmutableArray","./languageUtils","../geometry/Geometry"],function(p,g,t,v,n){return function(){function m(g){this.declaredClass="esri.arcade.Dictionary";this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=g instanceof m?g.attributes:void 0===g?{}:null===g?
{}:g}m.prototype.field=function(m){var k=m.toLowerCase();m=this.attributes[m];if(void 0!==m)return m;for(var f in this.attributes)if(f.toLowerCase()===k)return this.attributes[f];throw Error("Field not Found");};m.prototype.setField=function(m,k){if(this.immutable)throw Error("Dictionary is Immutable");var f=m.toLowerCase();if(void 0===this.attributes[m])for(var e in this.attributes)if(e.toLowerCase()===f){this.attributes[e]=k;return}this.attributes[m]=k};m.prototype.hasField=function(m){var k=m.toLowerCase();
if(void 0!==this.attributes[m])return!0;for(var f in this.attributes)if(f.toLowerCase()===k)return!0;return!1};m.prototype.keys=function(){var m=[],k;for(k in this.attributes)m.push(k);return m=m.sort()};m.prototype.castToText=function(){var m="",k;for(k in this.attributes){""!==m&&(m+=",");var f=this.attributes[k];null==f?m+=JSON.stringify(k)+":null":v.isBoolean(f)||v.isNumber(f)||v.isString(f)?m+=JSON.stringify(k)+":"+JSON.stringify(f):f instanceof n?m+=JSON.stringify(k)+":"+v.toStringExplicit(f):
f instanceof t?m+=JSON.stringify(k)+":"+v.toStringExplicit(f):f instanceof Array?m+=JSON.stringify(k)+":"+v.toStringExplicit(f):f instanceof Date?m+=JSON.stringify(k)+":"+JSON.stringify(f):null!==f&&"object"===typeof f&&void 0!==f.castToText&&(m+=JSON.stringify(k)+":"+f.castToText())}return"{"+m+"}"};return m}()})},"esri/arcade/ImmutableArray":function(){define(["require","exports"],function(p,g){return function(){function g(g){void 0===g&&(g=[]);this._elements=g}g.prototype.length=function(){return this._elements.length};
g.prototype.get=function(g){return this._elements[g]};g.prototype.toArray=function(){for(var g=[],n=0;n<this.length();n++)g.push(this.get(n));return g};return g}()})},"esri/arcade/languageUtils":function(){define("require exports dojo/number ../moment ./FunctionWrapper ./ImmutableArray ./ImmutablePathArray ./ImmutablePointArray ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){function w(l,
d,h){if(""===d||null===d||void 0===d||d===h||d===h)return l;do l=l.replace(d,h);while(-1!==l.indexOf(d));return l}function q(l){return l instanceof X||l instanceof n||l instanceof aa}function C(l){return z(l)||B(l)||D(l)||E(l)||null===l||l===g.voidOperation||"number"===typeof l?!0:!1}function z(l){return"string"===typeof l||l instanceof String}function E(l){return"boolean"===typeof l}function B(l){return"number"===typeof l}function G(l){return l instanceof Array}function F(l){return l instanceof m}
function D(l){return l instanceof Date}function I(l,d){if(!1===isNaN(l)){if(void 0===d||null===d||""===d)return l.toString();d=w(d,"\u2030","");d=w(d,"\u00a4","");return t.format(l,{pattern:d})}return l.toString()}function K(l,d){l=v(l);return void 0===d||null===d||""===d?l.format():l.format(J(d))}function J(l){return l.replace(/(LTS)|L|l/g,function(d){return"["+d+"]"})}function L(l,d,h){switch(h){case "\x3e":return l>d;case "\x3c":return l<d;case "\x3e\x3d":return l>=d;case "\x3c\x3d":return l<=
d}return!1}function M(l,d){if(l===d||null===l&&d===g.voidOperation||null===d&&l===g.voidOperation)return!0;if(D(l)&&D(d))return l.getTime()===d.getTime();if(l instanceof u||l instanceof k)return l.equalityTest(d);if(l instanceof a&&d instanceof a){var h=void 0,r=void 0,h=l.getCacheValue("_arcadeCacheId"),r=d.getCacheValue("_arcadeCacheId");if(void 0!==h&&null!==h)return h===r}return void 0!==l&&void 0!==d&&null!==l&&null!==d&&"object"===typeof l&&"object"===typeof d&&(l._arcadeCacheId===d._arcadeCacheId&&
void 0!==l._arcadeCacheId&&null!==l._arcadeCacheId||l._underlyingGraphic===d._underlyingGraphic&&void 0!==l._underlyingGraphic&&null!==l._underlyingGraphic)?!0:!1}function Q(l,d){if(z(l))return l;if(null===l)return"";if(B(l))return I(l,d);if(E(l))return l.toString();if(D(l))return K(l,d);if(l instanceof e)return JSON.stringify(l.toJson());if(G(l)){d=[];for(var h=0;h<l.length;h++)d[h]=T(l[h]);return"["+d.join(",")+"]"}if(l instanceof m){d=[];for(h=0;h<l.length();h++)d[h]=T(l.get(h));return"["+d.join(",")+
"]"}return null!==l&&"object"===typeof l&&void 0!==l.castToText?l.castToText():q(l)?"object, Function":""}function S(l,d){if(z(l))return l;if(null===l)return"";if(B(l))return I(l,d);if(E(l))return l.toString();if(D(l))return K(l,d);if(l instanceof e)return l instanceof f?'{"xmin":'+l.xmin.toString()+',"ymin":'+l.ymin.toString()+","+(l.hasZ?'"zmin":'+l.zmin.toString()+",":"")+(l.hasM?'"mmin":'+l.mmin.toString()+",":"")+'"xmax":'+l.xmax.toString()+',"ymax":'+l.ymax.toString()+","+(l.hasZ?'"zmax":'+
l.zmax.toString()+",":"")+(l.hasM?'"mmax":'+l.mmax.toString()+",":"")+'"spatialReference":'+U(l.spatialReference)+"}":U(l.toJson(),function(d,h){return d.key===h.key?0:"spatialReference"===d.key?1:"spatialReference"===h.key||d.key<h.key?-1:d.key>h.key?1:0});if(G(l)){d=[];for(var h=0;h<l.length;h++)d[h]=T(l[h]);return"["+d.join(",")+"]"}if(l instanceof m){d=[];for(h=0;h<l.length();h++)d[h]=T(l.get(h));return"["+d.join(",")+"]"}return null!==l&&"object"===typeof l&&void 0!==l.castToText?l.castToText():
q(l)?"object, Function":""}function T(l){return null===l?"null":E(l)||B(l)||z(l)?JSON.stringify(l):l instanceof e||l instanceof m||l instanceof Array?S(l):l instanceof Date?JSON.stringify(K(l,"")):null!==l&&"object"===typeof l&&void 0!==l.castToText?l.castToText():"null"}function O(l,d){return B(l)?l:null===l||""===l?0:D(l)?NaN:E(l)?l?1:0:G(l)||""===l||void 0===l?NaN:void 0!==d&&z(l)?(d=w(d,"\u2030",""),d=w(d,"\u00a4",""),t.parse(l,{pattern:d})):l===g.voidOperation?0:Number(l)}function W(l,d){var h;
d.fields.some(function(d){d.name===l&&(h=d.domain);return!!h});return h}function U(l,d){d||(d={});"function"===typeof d&&(d={cmp:d});var h="boolean"===typeof d.cycles?d.cycles:!1,r=d.cmp&&function(d){return function(h){return function(l,r){return d({key:l,value:h[l]},{key:r,value:h[r]})}}}(d.cmp),a=[];return function P(d){d&&d.toJson&&"function"===typeof d.toJson&&(d=d.toJson());if(void 0!==d){if("number"===typeof d)return isFinite(d)?""+d:"null";if("object"!==typeof d)return JSON.stringify(d);var l,
y;if(Array.isArray(d)){y="[";for(l=0;l<d.length;l++)l&&(y+=","),y+=P(d[l])||"null";return y+"]"}if(null===d)return"null";if(-1!==a.indexOf(d)){if(h)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var b=a.push(d)-1,c=Object.keys(d).sort(r&&r(d));y="";for(l=0;l<c.length;l++){var A=c[l],e=P(d[A]);e&&(y&&(y+=","),y+=JSON.stringify(A)+":"+e)}a.splice(b,1);return"{"+y+"}"}}(l)}function V(l,d){if(d instanceof a)l.push([d.x,d.y]);else throw Error("Invalid Argument");
}Object.defineProperty(g,"__esModule",{value:!0});p=function(){return function(l){this.value=l}}();g.ReturnResultE=p;var A=function(){return function(l){this.value=l}}();g.ImplicitResultE=A;var X=function(){return function(l){this.fn=l}}();g.NativeFunctionE=X;var aa=function(){return function(l){this.fn=l}}();g.SizzleFunctionE=aa;g.NativeFunction=X;g.ImplicitResult=A;g.ReturnResult=p;g.SizzleFunction=aa;g.voidOperation={type:"VOID"};g.breakResult={type:"BREAK"};g.continueResult={type:"CONTINUE"};
g.multiReplace=w;g.isFunctionParameter=q;g.isSimpleType=C;g.defaultUndefined=function(l,d){return void 0===l?d:l};g.isString=z;g.isBoolean=E;g.isNumber=B;g.isArray=G;g.isFeatureSet=function(l){return!0===(l&&l.declaredRootClass&&"esri.arcade.featureset.support.FeatureSet"===l.declaredRootClass)};g.isFeatureSetCollection=function(l){return!0===(l&&l.declaredRootClass&&"esri.arcade.featureSetCollection"===l.declaredRootClass)};g.isImmutableArray=F;g.isDate=D;g.pcCheck=function(l,d,h){if(l.length<d||
l.length>h)throw Error("Function called with wrong number of Parameters");};g.generateUUID=function(){var l=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var h=(l+16*Math.random())%16|0;l=Math.floor(l/16);return("x"===d?h:h&3|8).toString(16)})};g.formatNumber=I;g.formatDate=K;g.standardiseDateFormat=J;g.greaterThanLessThan=function(l,d,h){if(null===l){if(null===d||d===g.voidOperation)return L(null,null,h);if(B(d))return L(0,d,h);if(z(d)||E(d))return L(0,
O(d),h);if(D(d))return L(0,d.getTime(),h)}if(l===g.voidOperation){if(null===d||d===g.voidOperation)return L(null,null,h);if(B(d))return L(0,d,h);if(z(d)||E(d))return L(0,O(d),h);if(D(d))return L(0,d.getTime(),h)}else if(B(l)){if(B(d))return L(l,d,h);if(E(d))return L(l,O(d),h);if(null===d||d===g.voidOperation)return L(l,0,h);if(z(d))return L(l,O(d),h);if(D(d))return L(l,d.getTime(),h)}else if(z(l)){if(z(d))return L(Q(l),Q(d),h);if(D(d))return L(O(l),d.getTime(),h);if(B(d))return L(O(l),d,h);if(null===
d||d===g.voidOperation)return L(O(l),0,h);if(E(d))return L(O(l),O(d),h)}else if(D(l)){if(D(d))return L(l,d,h);if(null===d||d===g.voidOperation)return L(l.getTime(),0,h);if(B(d))return L(l.getTime(),d,h);if(E(d)||z(d))return L(l.getTime(),O(d),h)}else if(E(l)){if(E(d))return L(l,d,h);if(B(d))return L(O(l),O(d),h);if(D(d))return L(O(l),d.getTime(),h);if(null===d||d===g.voidOperation)return L(O(l),0,h);if(z(d))return L(O(l),O(d),h)}return!M(l,d)||"\x3c\x3d"!==h&&"\x3e\x3d"!==h?!1:!0};g.equalityTest=
M;g.toString=Q;g.toNumberArray=function(l){var d=[];if(!1===G(l))return null;if(l instanceof m){for(var h=0;h<l.length();h++)d[h]=O(l.get(h));return d}for(h=0;h<l.length;h++)d[h]=O(l[h]);return d};g.toStringExplicit=S;g.toNumber=O;g.toDate=function(l,d){return D(l)?l:z(l)&&(l=v(l,[void 0===d||null===d||""===d?v.ISO_8601:d]),l.isValid())?l.toDate():null};g.toDateM=function(l,d){return D(l)?v(l):z(l)&&(l=v(l,[void 0===d||null===d||""===d?v.ISO_8601:d]),l.isValid())?l:null};g.toBoolean=function(l){return E(l)?
l:z(l)?(l=l.toLowerCase(),"true"===l?!0:!1):B(l)?0===l||isNaN(l)?!1:!0:!1};g.fixSpatialReference=function(l,d){if(null===l||void 0===l)return null;if(null===l.spatialReference||void 0===l.spatialReference)l.spatialReference=d;return l};g.fixNullGeometry=function(l){return null===l?null:l instanceof a?"NaN"===l.x||null===l.x||isNaN(l.x)?null:l:l instanceof c?0===l.rings.length?null:l:l instanceof x?0===l.paths.length?null:l:l instanceof b?0===l.points.length?null:l:l instanceof f?"NaN"===l.xmin||null===
l.xmin||isNaN(l.xmin)?null:l:null};g.getDomainValue=function(l,d){if(!l||!l.domain)return null;var h=null;d="string"===l.field.type||"esriFieldTypeString"===l.field.type?Q(d):O(d);for(var r=0;r<l.domain.codedValues.length;r++){var a=l.domain.codedValues[r];a.code===d&&(h=a)}return null===h?null:h.name};g.getDomainCode=function(l,d){if(!l||!l.domain)return null;var h=null;d=Q(d);for(var r=0;r<l.domain.codedValues.length;r++){var a=l.domain.codedValues[r];a.name===d&&(h=a)}return null===h?null:h.code};
g.getDomain=function(l,d,h,r){void 0===h&&(h=null);if(!d||!d.fields)return null;for(var a=null,b=0;b<d.fields.length;b++){var c=d.fields[b];c.name.toLowerCase()===l.toString().toLowerCase()&&(a=c)}if(null===a)return null;var A,e;r||(r=h&&d.typeIdField&&h._field(d.typeIdField));null!=r&&d.types.some(function(h){return h.id===r?((A=h.domains&&h.domains[a.name])&&"inherited"===A.type&&(A=W(a.name,d),e=!0),!0):!1});e||A||(A=W(l,d));return{field:a,domain:A}};g.stableStringify=U;g.autoCastFeatureToGeometry=
function(l){if(null===l)return null;for(var d=[],h=0;h<l.length;h++){var r=l[h];r&&r.declaredClass&&"esri.arcade.Feature"===r.declaredClass?d.push(r.geometry()):d.push(r)}return d};g.autoCastArrayOfPointsToPolygon=function(l,d){if(G(l)||F(l)){var h=!1,r=!1,a=[];if(G(l)){for(var b=0;b<l.length;b++){var A=l[b];V(a,A)}0<a.length&&(d=l[0].spatialReference,h=l[0].hasZ,r=l[0].hasM)}else if(l instanceof k)a=l._elements,0<a.length&&(h=l._hasZ,r=l._hasM,d=l.get(0).spatialReference);else if(F(l)){for(var b=
0,e=l.toArray();b<e.length;b++)A=e[b],V(a,A);0<a.length&&(d=l.get(0).spatialReference,h=!0===l.get(0).hasZ,r=!0===l.get(0).hasM)}else throw Error("Invalid Argument");if(0===a.length)return null;!1===(new c({rings:[],spatialReference:{wkid:4326}})).isClockwise(a)&&(a=a.slice(0).reverse());return new c({rings:[a],spatialReference:d,hasZ:h,hasM:r})}return l};g.autoCastArrayOfPointsToPolyline=function(l,d){if(G(l)||F(l)){var h=!1,r=!1,a=[];if(G(l)){for(var b=0;b<l.length;b++){var c=l[b];V(a,c)}0<a.length&&
(d=l[0].spatialReference,h=!0===l[0].hasZ,r=!0===l[0].hasM)}else if(l instanceof k)a=l._elements,0<a.length&&(h=l._hasZ,r=l._hasM,d=l.get(0).spatialReference);else if(F(l)){for(var b=0,A=l.toArray();b<A.length;b++)c=A[b],V(a,c);0<a.length&&(d=l.get(0).spatialReference,h=!0===l.get(0).hasZ,r=!0===l.get(0).hasM)}return 0===a.length?null:new x({paths:[a],spatialReference:d,hasZ:h,hasM:r})}return l};g.autoCastArrayOfPointsToMultiPoint=function(l,d){if(G(l)||F(l)){var h=!1,r=!1,a=[];if(G(l)){for(var c=
0;c<l.length;c++){var A=l[c];V(a,A)}0<a.length&&(d=l[0].spatialReference,h=!0===l[0].hasZ,r=!0===l[0].hasM)}else if(l instanceof k)a=l._elements,0<a.length&&(h=l._hasZ,r=l._hasM,d=l.get(0).spatialReference);else if(F(l)){for(var c=0,e=l.toArray();c<e.length;c++)A=e[c],V(a,A);0<a.length&&(d=l.get(0).spatialReference,h=!0===l.get(0).hasZ,r=!0===l.get(0).hasM)}return 0===a.length?null:new b({points:a,spatialReference:d,hasZ:h,hasM:r})}return l};g.toStringArray=function(l,d){void 0===d&&(d=!1);var h=
[];if(null===l)return h;if(!0===G(l)){for(var r=0;r<l.length;r++){var a=Q(l[r]);""===a&&!0!==d||h.push(a)}return h}if(l instanceof m){for(r=0;r<l.length();r++)a=Q(l.get(r)),""===a&&!0!==d||h.push(a);return h}return C(l)?(a=Q(l),""===a&&!0!==d||h.push(a),h):[]}})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(p,g,t){return t})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(p,g,t,v){Object.defineProperty(g,
"__esModule",{value:!0});var n={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bs:1,ca:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-il":1,"en-nz":1,es:1,"es-do":1,"es-us":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hi:1,hr:1,hu:1,id:1,it:1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,uk:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-tw":1};g.load=function(m,g,k){m=t.locale;var f=m in n;if(!f){var e=
m.split("-");1<e.length&&e[0]in n&&(m=e[0],f=!0)}f?g(["moment/locale/"+m],function(){k(v)}):k(v)}})},"moment/moment":function(){(function(p,g){"object"===typeof exports&&"undefined"!==typeof module?module.exports=g():"function"===typeof define&&define.amd?define(g):p.moment=g()})(this,function(){function p(){return Xb.apply(null,arguments)}function g(d){return d instanceof Array||"[object Array]"===Object.prototype.toString.call(d)}function t(d){return null!=d&&"[object Object]"===Object.prototype.toString.call(d)}
function v(d){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(d).length;for(var h in d)if(d.hasOwnProperty(h))return!1;return!0}function n(d){return void 0===d}function m(d){return"number"===typeof d||"[object Number]"===Object.prototype.toString.call(d)}function u(d){return d instanceof Date||"[object Date]"===Object.prototype.toString.call(d)}function k(d,h){var l=[],r;for(r=0;r<d.length;++r)l.push(h(d[r],r));return l}function f(d,h){return Object.prototype.hasOwnProperty.call(d,
h)}function e(d,h){for(var l in h)f(h,l)&&(d[l]=h[l]);f(h,"toString")&&(d.toString=h.toString);f(h,"valueOf")&&(d.valueOf=h.valueOf);return d}function b(d,h,l,r){return fb(d,h,l,r,!0).utc()}function a(d){null==d._pf&&(d._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1});return d._pf}function c(d){if(null==d._isValid){var h=a(d),l=Wb.call(h.parsedDateParts,
function(d){return null!=d}),l=!isNaN(d._d.getTime())&&0>h.overflow&&!h.empty&&!h.invalidMonth&&!h.invalidWeekday&&!h.weekdayMismatch&&!h.nullInput&&!h.invalidFormat&&!h.userInvalidated&&(!h.meridiem||h.meridiem&&l);d._strict&&(l=l&&0===h.charsLeftOver&&0===h.unusedTokens.length&&void 0===h.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(d))return l;d._isValid=l}return d._isValid}function x(d){var h=b(NaN);null!=d?e(a(h),d):a(h).userInvalidated=!0;return h}function w(d,h){var l,r,y;n(h._isAMomentObject)||
(d._isAMomentObject=h._isAMomentObject);n(h._i)||(d._i=h._i);n(h._f)||(d._f=h._f);n(h._l)||(d._l=h._l);n(h._strict)||(d._strict=h._strict);n(h._tzm)||(d._tzm=h._tzm);n(h._isUTC)||(d._isUTC=h._isUTC);n(h._offset)||(d._offset=h._offset);n(h._pf)||(d._pf=a(h));n(h._locale)||(d._locale=h._locale);if(0<Nb.length)for(l=0;l<Nb.length;l++)r=Nb[l],y=h[r],n(y)||(d[r]=y);return d}function q(d){w(this,d);this._d=new Date(null!=d._d?d._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Ob&&(Ob=!0,p.updateOffset(this),
Ob=!1)}function C(d){return d instanceof q||null!=d&&null!=d._isAMomentObject}function z(d){return 0>d?Math.ceil(d)||0:Math.floor(d)}function E(d){d=+d;var h=0;0!==d&&isFinite(d)&&(h=z(d));return h}function B(d,h,l){var r=Math.min(d.length,h.length),a=Math.abs(d.length-h.length),y=0,b;for(b=0;b<r;b++)(l&&d[b]!==h[b]||!l&&E(d[b])!==E(h[b]))&&y++;return y+a}function G(d){!1===p.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+d)}function F(d,
h){var l=!0;return e(function(){null!=p.deprecationHandler&&p.deprecationHandler(null,d);if(l){for(var r=[],a,y=0;y<arguments.length;y++){a="";if("object"===typeof arguments[y]){a+="\n["+y+"] ";for(var b in arguments[0])a+=b+": "+arguments[0][b]+", ";a=a.slice(0,-2)}else a=arguments[y];r.push(a)}G(d+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+Error().stack);l=!1}return h.apply(this,arguments)},h)}function D(d,h){null!=p.deprecationHandler&&p.deprecationHandler(d,h);Yb[d]||(G(h),Yb[d]=
!0)}function I(d){return d instanceof Function||"[object Function]"===Object.prototype.toString.call(d)}function K(d,h){var l=e({},d),r;for(r in h)f(h,r)&&(t(d[r])&&t(h[r])?(l[r]={},e(l[r],d[r]),e(l[r],h[r])):null!=h[r]?l[r]=h[r]:delete l[r]);for(r in d)f(d,r)&&!f(h,r)&&t(d[r])&&(l[r]=e({},l[r]));return l}function J(d){null!=d&&this.set(d)}function L(d,h){var l=d.toLowerCase();kb[l]=kb[l+"s"]=kb[h]=d}function M(d){return"string"===typeof d?kb[d]||kb[d.toLowerCase()]:void 0}function Q(d){var h={},
l,r;for(r in d)f(d,r)&&(l=M(r))&&(h[l]=d[r]);return h}function S(d){var h=[],l;for(l in d)h.push({unit:l,priority:Na[l]});h.sort(function(d,h){return d.priority-h.priority});return h}function T(d,h,l){var r=""+Math.abs(d);return(0<=d?l?"+":"":"-")+Math.pow(10,Math.max(0,h-r.length)).toString().substr(1)+r}function O(d,h,l,r){var a=r;"string"===typeof r&&(a=function(){return this[r]()});d&&(rb[d]=a);h&&(rb[h[0]]=function(){return T(a.apply(this,arguments),h[1],h[2])});l&&(rb[l]=function(){return this.localeData().ordinal(a.apply(this,
arguments),d)})}function W(d){return d.match(/\[[\s\S]/)?d.replace(/^\[|\]$/g,""):d.replace(/\\/g,"")}function U(d){var h=d.match($b),l,r;l=0;for(r=h.length;l<r;l++)h[l]=rb[h[l]]?rb[h[l]]:W(h[l]);return function(l){var a="",y;for(y=0;y<r;y++)a+=I(h[y])?h[y].call(l,d):h[y];return a}}function V(d,h){if(!d.isValid())return d.localeData().invalidDate();h=A(h,d.localeData());Pb[h]=Pb[h]||U(h);return Pb[h](d)}function A(d,h){function l(d){return h.longDateFormat(d)||d}var r=5;for(Eb.lastIndex=0;0<=r&&Eb.test(d);)d=
d.replace(Eb,l),Eb.lastIndex=0,--r;return d}function X(d,h,l){Rb[d]=I(h)?h:function(d,r){return d&&l?l:h}}function aa(d,h){return f(Rb,d)?Rb[d](h._strict,h._locale):new RegExp(l(d))}function l(h){return d(h.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(d,h,l,r,a){return h||l||r||a}))}function d(d){return d.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function h(d,h){var l,r=h;"string"===typeof d&&(d=[d]);m(h)&&(r=function(d,l){l[h]=E(d)});for(l=0;l<d.length;l++)Sb[d[l]]=r}
function r(d,l){h(d,function(d,h,r,a){r._w=r._w||{};l(d,r._w,r,a)})}function y(d){return 0===d%4&&0!==d%100||0===d%400}function H(d,h){return function(l){return null!=l?(ba(this,d,l),p.updateOffset(this,h),this):P(this,d)}}function P(d,h){return d.isValid()?d._d["get"+(d._isUTC?"UTC":"")+h]():NaN}function ba(d,h,l){if(d.isValid()&&!isNaN(l))if("FullYear"===h&&y(d.year())&&1===d.month()&&29===d.date())d._d["set"+(d._isUTC?"UTC":"")+h](l,d.month(),ea(l,d.month()));else d._d["set"+(d._isUTC?"UTC":"")+
h](l)}function ea(d,h){if(isNaN(d)||isNaN(h))return NaN;var l=(h%12+12)%12;return 1===l?y(d+(h-l)/12)?29:28:31-l%7%2}function va(d,h){var l;if(!d.isValid())return d;if("string"===typeof h)if(/^\d+$/.test(h))h=E(h);else if(h=d.localeData().monthsParse(h),!m(h))return d;l=Math.min(d.date(),ea(d.year(),h));d._d["set"+(d._isUTC?"UTC":"")+"Month"](h,l);return d}function N(d){return null!=d?(va(this,d),p.updateOffset(this,!0),this):P(this,"Month")}function Ca(){function h(d,h){return h.length-d.length}
var l=[],r=[],a=[],y,c;for(y=0;12>y;y++)c=b([2E3,y]),l.push(this.monthsShort(c,"")),r.push(this.months(c,"")),a.push(this.months(c,"")),a.push(this.monthsShort(c,""));l.sort(h);r.sort(h);a.sort(h);for(y=0;12>y;y++)l[y]=d(l[y]),r[y]=d(r[y]);for(y=0;24>y;y++)a[y]=d(a[y]);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+a.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+l.join("|")+")","i")}function ma(d,h,l,r,a,y,b){h=
new Date(d,h,l,r,a,y,b);100>d&&0<=d&&isFinite(h.getFullYear())&&h.setFullYear(d);return h}function wa(d){var h=new Date(Date.UTC.apply(null,arguments));100>d&&0<=d&&isFinite(h.getUTCFullYear())&&h.setUTCFullYear(d);return h}function xa(d,h,l){l=7+h-l;return-((7+wa(d,0,l).getUTCDay()-h)%7)+l-1}function ya(d,h,l,r,a){l=(7+l-r)%7;r=xa(d,r,a);r=1+7*(h-1)+l+r;0>=r?(h=d-1,d=(y(h)?366:365)+r):r>(y(d)?366:365)?(h=d+1,d=r-(y(d)?366:365)):(h=d,d=r);return{year:h,dayOfYear:d}}function la(d,h,l){var r=xa(d.year(),
h,l),r=Math.floor((d.dayOfYear()-r-1)/7)+1;1>r?(d=d.year()-1,h=r+ua(d,h,l)):r>ua(d.year(),h,l)?(h=r-ua(d.year(),h,l),d=d.year()+1):(d=d.year(),h=r);return{week:h,year:d}}function ua(d,h,l){var r=xa(d,h,l);h=xa(d+1,h,l);return((y(d)?366:365)-r+h)/7}function Ea(d,h,l){var r,a;d=d.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;7>r;++r)a=b([2E3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(a,"").toLocaleLowerCase(),
this._shortWeekdaysParse[r]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(a,"").toLocaleLowerCase();if(l)h="dddd"===h?Ha.call(this._weekdaysParse,d):"ddd"===h?Ha.call(this._shortWeekdaysParse,d):Ha.call(this._minWeekdaysParse,d);else if("dddd"===h){h=Ha.call(this._weekdaysParse,d);if(-1!==h)return h;h=Ha.call(this._shortWeekdaysParse,d);if(-1!==h)return h;h=Ha.call(this._minWeekdaysParse,d)}else if("ddd"===h){h=Ha.call(this._shortWeekdaysParse,d);if(-1!==h)return h;
h=Ha.call(this._weekdaysParse,d);if(-1!==h)return h;h=Ha.call(this._minWeekdaysParse,d)}else{h=Ha.call(this._minWeekdaysParse,d);if(-1!==h)return h;h=Ha.call(this._weekdaysParse,d);if(-1!==h)return h;h=Ha.call(this._shortWeekdaysParse,d)}return-1!==h?h:null}function oa(){function h(d,h){return h.length-d.length}var l=[],r=[],a=[],y=[],c,H,A,e;for(c=0;7>c;c++)H=b([2E3,1]).day(c),A=this.weekdaysMin(H,""),e=this.weekdaysShort(H,""),H=this.weekdays(H,""),l.push(A),r.push(e),a.push(H),y.push(A),y.push(e),
y.push(H);l.sort(h);r.sort(h);a.sort(h);y.sort(h);for(c=0;7>c;c++)r[c]=d(r[c]),a[c]=d(a[c]),y[c]=d(y[c]);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+y.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+l.join("|")+")","i")}function ra(){return this.hours()%12||12}function pa(d,h){O(d,0,0,function(){return this.localeData().meridiem(this.hours(),
this.minutes(),h)})}function Ia(d,h){return h._meridiemParse}function fa(d){return d?d.toLowerCase().replace("_","-"):d}function za(d){var h=null;if(!Ka[d]&&"undefined"!==typeof module&&module&&module.exports)try{h=zb._abbr,require("./locale/"+d),Fa(h)}catch(Wc){}return Ka[d]}function Fa(d,h){d&&((h=n(h)?Da(d):Ma(d,h))?zb=h:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+d+" not found. Did you forget to load it?"));return zb._abbr}function Ma(d,h){if(null!==h){var l;l=dc;h.abbr=
d;if(null!=Ka[d])D("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),l=Ka[d]._config;else if(null!=h.parentLocale)if(null!=Ka[h.parentLocale])l=Ka[h.parentLocale]._config;else if(l=za(h.parentLocale),null!=l)l=l._config;else return Ab[h.parentLocale]||(Ab[h.parentLocale]=[]),Ab[h.parentLocale].push({name:d,
config:h}),null;Ka[d]=new J(K(l,h));Ab[d]&&Ab[d].forEach(function(d){Ma(d.name,d.config)});Fa(d);return Ka[d]}delete Ka[d];return null}function Da(d){var h;d&&d._locale&&d._locale._abbr&&(d=d._locale._abbr);if(!d)return zb;if(!g(d)){if(h=za(d))return h;d=[d]}a:{h=0;for(var l,r,a,y;h<d.length;){y=fa(d[h]).split("-");l=y.length;for(r=(r=fa(d[h+1]))?r.split("-"):null;0<l;){if(a=za(y.slice(0,l).join("-"))){d=a;break a}if(r&&r.length>=l&&B(y,r,!0)>=l-1)break;l--}h++}d=zb}return d}function Pa(d){var h;
(h=d._a)&&-2===a(d).overflow&&(h=0>h[cb]||11<h[cb]?cb:1>h[$a]||h[$a]>ea(h[Wa],h[cb])?$a:0>h[La]||24<h[La]||24===h[La]&&(0!==h[Xa]||0!==h[db]||0!==h[nb])?La:0>h[Xa]||59<h[Xa]?Xa:0>h[db]||59<h[db]?db:0>h[nb]||999<h[nb]?nb:-1,a(d)._overflowDayOfYear&&(h<Wa||h>$a)&&(h=$a),a(d)._overflowWeeks&&-1===h&&(h=mc),a(d)._overflowWeekday&&-1===h&&(h=nc),a(d).overflow=h);return d}function Ja(d,h,l){return null!=d?d:null!=h?h:l}function Ta(d){var h,l=[],r;if(!d._d){r=new Date(p.now());r=d._useUTC?[r.getUTCFullYear(),
r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()];if(d._w&&null==d._a[$a]&&null==d._a[cb]){var b,c,H,A,e,f;b=d._w;if(null!=b.GG||null!=b.W||null!=b.E){if(e=1,f=4,c=Ja(b.GG,d._a[Wa],la(Z(),1,4).year),H=Ja(b.W,1),A=Ja(b.E,1),1>A||7<A)h=!0}else if(e=d._locale._week.dow,f=d._locale._week.doy,H=la(Z(),e,f),c=Ja(b.gg,d._a[Wa],H.year),H=Ja(b.w,H.week),null!=b.d){if(A=b.d,0>A||6<A)h=!0}else if(null!=b.e){if(A=b.e+e,0>b.e||6<b.e)h=!0}else A=e;1>H||H>ua(c,e,f)?a(d)._overflowWeeks=!0:
null!=h?a(d)._overflowWeekday=!0:(h=ya(c,H,A,e,f),d._a[Wa]=h.year,d._dayOfYear=h.dayOfYear)}if(null!=d._dayOfYear){h=Ja(d._a[Wa],r[Wa]);if(d._dayOfYear>(y(h)?366:365)||0===d._dayOfYear)a(d)._overflowDayOfYear=!0;h=wa(h,0,d._dayOfYear);d._a[cb]=h.getUTCMonth();d._a[$a]=h.getUTCDate()}for(h=0;3>h&&null==d._a[h];++h)d._a[h]=l[h]=r[h];for(;7>h;h++)d._a[h]=l[h]=null==d._a[h]?2===h?1:0:d._a[h];24===d._a[La]&&0===d._a[Xa]&&0===d._a[db]&&0===d._a[nb]&&(d._nextDay=!0,d._a[La]=0);d._d=(d._useUTC?wa:ma).apply(null,
l);l=d._useUTC?d._d.getUTCDay():d._d.getDay();null!=d._tzm&&d._d.setUTCMinutes(d._d.getUTCMinutes()-d._tzm);d._nextDay&&(d._a[La]=24);d._w&&"undefined"!==typeof d._w.d&&d._w.d!==l&&(a(d).weekdayMismatch=!0)}}function ca(d){var h,l;h=d._i;var r=oc.exec(h)||pc.exec(h),y,b,c,H;if(r){a(d).iso=!0;h=0;for(l=Ib.length;h<l;h++)if(Ib[h][1].exec(r[1])){b=Ib[h][0];y=!1!==Ib[h][2];break}if(null==b)d._isValid=!1;else{if(r[3]){h=0;for(l=Tb.length;h<l;h++)if(Tb[h][1].exec(r[3])){c=(r[2]||" ")+Tb[h][0];break}if(null==
c){d._isValid=!1;return}}if(y||null==c){if(r[4])if(qc.exec(r[4]))H="Z";else{d._isValid=!1;return}d._f=b+(c||"")+(H||"");ja(d)}else d._isValid=!1}}else d._isValid=!1}function Ga(d){var h=rc.exec(d._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(h){var l=h[3],r=h[2],y=h[5],b=h[6],c=h[7],H=parseInt(h[4],10),l=[49>=H?2E3+H:999>=H?1900+H:H,ec.indexOf(l),parseInt(r,10),parseInt(y,10),parseInt(b,10)];c&&l.push(parseInt(c,10));a:{if(c=h[1])if(c=fc.indexOf(c),
r=(new Date(l[0],l[1],l[2])).getDay(),c!==r){a(d).weekdayMismatch=!0;c=d._isValid=!1;break a}c=!0}c&&(d._a=l,(c=h[8])?h=sc[c]:h[9]?h=0:(h=parseInt(h[10],10),c=h%100,h=(h-c)/100*60+c),d._tzm=h,d._d=wa.apply(null,d._a),d._d.setUTCMinutes(d._d.getUTCMinutes()-d._tzm),a(d).rfc2822=!0)}else d._isValid=!1}function Oa(d){var h=tc.exec(d._i);null!==h?d._d=new Date(+h[1]):(ca(d),!1===d._isValid&&(delete d._isValid,Ga(d),!1===d._isValid&&(delete d._isValid,p.createFromInputFallback(d))))}function ja(d){if(d._f===
p.ISO_8601)ca(d);else if(d._f===p.RFC_2822)Ga(d);else{d._a=[];a(d).empty=!0;var h=""+d._i,l,r,y,b,c,H=h.length,e=0;y=A(d._f,d._locale).match($b)||[];for(l=0;l<y.length;l++){b=y[l];if(r=(h.match(aa(b,d))||[])[0])c=h.substr(0,h.indexOf(r)),0<c.length&&a(d).unusedInput.push(c),h=h.slice(h.indexOf(r)+r.length),e+=r.length;if(rb[b]){if(r?a(d).empty=!1:a(d).unusedTokens.push(b),c=d,null!=r&&f(Sb,b))Sb[b](r,c._a,c,b)}else d._strict&&!r&&a(d).unusedTokens.push(b)}a(d).charsLeftOver=H-e;0<h.length&&a(d).unusedInput.push(h);
12>=d._a[La]&&!0===a(d).bigHour&&0<d._a[La]&&(a(d).bigHour=void 0);a(d).parsedDateParts=d._a.slice(0);a(d).meridiem=d._meridiem;h=d._a;l=La;H=d._locale;y=d._a[La];e=d._meridiem;null!=e&&(null!=H.meridiemHour?y=H.meridiemHour(y,e):null!=H.isPM&&((H=H.isPM(e))&&12>y&&(y+=12),H||12!==y||(y=0)));h[l]=y;Ta(d);Pa(d)}}function Ua(d){if(!d._d){var h=Q(d._i);d._a=k([h.year,h.month,h.day||h.date,h.hour,h.minute,h.second,h.millisecond],function(d){return d&&parseInt(d,10)});Ta(d)}}function Qa(d){var h=d._i,
l=d._f;d._locale=d._locale||Da(d._l);if(null===h||void 0===l&&""===h)return x({nullInput:!0});"string"===typeof h&&(d._i=h=d._locale.preparse(h));if(C(h))return new q(Pa(h));if(u(h))d._d=h;else if(g(l)){var r,y,b;if(0===d._f.length)a(d).invalidFormat=!0,d._d=new Date(NaN);else{for(h=0;h<d._f.length;h++)if(l=0,r=w({},d),null!=d._useUTC&&(r._useUTC=d._useUTC),r._f=d._f[h],ja(r),c(r)&&(l+=a(r).charsLeftOver,l+=10*a(r).unusedTokens.length,a(r).score=l,null==b||l<b))b=l,y=r;e(d,y||r)}}else l?ja(d):na(d);
c(d)||(d._d=null);return d}function na(d){var h=d._i;n(h)?d._d=new Date(p.now()):u(h)?d._d=new Date(h.valueOf()):"string"===typeof h?Oa(d):g(h)?(d._a=k(h.slice(0),function(d){return parseInt(d,10)}),Ta(d)):t(h)?Ua(d):m(h)?d._d=new Date(h):p.createFromInputFallback(d)}function fb(d,h,l,r,a){var y={};if(!0===l||!1===l)r=l,l=void 0;if(t(d)&&v(d)||g(d)&&0===d.length)d=void 0;y._isAMomentObject=!0;y._useUTC=y._isUTC=a;y._l=l;y._i=d;y._f=h;y._strict=r;d=new q(Pa(Qa(y)));d._nextDay&&(d.add(1,"d"),d._nextDay=
void 0);return d}function Z(d,h,l,r){return fb(d,h,l,r,!1)}function sa(d,h){var l,r;1===h.length&&g(h[0])&&(h=h[0]);if(!h.length)return Z();l=h[0];for(r=1;r<h.length;++r)if(!h[r].isValid()||h[r][d](l))l=h[r];return l}function R(d){for(var h in d)if(-1===Ha.call(Bb,h)||null!=d[h]&&isNaN(d[h]))return!1;h=!1;for(var l=0;l<Bb.length;++l)if(d[Bb[l]]){if(h)return!1;parseFloat(d[Bb[l]])!==E(d[Bb[l]])&&(h=!0)}return!0}function ka(d){d=Q(d);var h=d.year||0,l=d.quarter||0,r=d.month||0,a=d.week||d.isoWeek||
0,y=d.day||0,b=d.hour||0,c=d.minute||0,H=d.second||0,A=d.millisecond||0;this._isValid=R(d);this._milliseconds=+A+1E3*H+6E4*c+36E5*b;this._days=+y+7*a;this._months=+r+3*l+12*h;this._data={};this._locale=Da();this._bubble()}function ia(d){return d instanceof ka}function qa(d){return 0>d?-1*Math.round(-1*d):Math.round(d)}function ga(d,h){O(d,0,0,function(){var d=this.utcOffset(),l="+";0>d&&(d=-d,l="-");return l+T(~~(d/60),2)+h+T(~~d%60,2)})}function ha(d,h){d=(h||"").match(d);if(null===d)return null;
d=((d[d.length-1]||[])+"").match(uc)||["-",0,0];h=+(60*d[1])+E(d[2]);return 0===h?0:"+"===d[0]?h:-h}function Y(d,h){return h._isUTC?(h=h.clone(),d=(C(d)||u(d)?d.valueOf():Z(d).valueOf())-h.valueOf(),h._d.setTime(h._d.valueOf()+d),p.updateOffset(h,!1),h):Z(d).local()}function sb(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Sa(d,h){var l=d,r=null;ia(d)?l={ms:d._milliseconds,d:d._days,M:d._months}:m(d)?(l={},h?l[h]=d:l.milliseconds=d):(r=vc.exec(d))?(l="-"===r[1]?-1:1,l={y:0,d:E(r[$a])*
l,h:E(r[La])*l,m:E(r[Xa])*l,s:E(r[db])*l,ms:E(qa(1E3*r[nb]))*l}):(r=wc.exec(d))?(l="-"===r[1]?-1:1,l={y:Za(r[2],l),M:Za(r[3],l),w:Za(r[4],l),d:Za(r[5],l),h:Za(r[6],l),m:Za(r[7],l),s:Za(r[8],l)}):null==l?l={}:"object"===typeof l&&("from"in l||"to"in l)&&(r=Z(l.from),l=Z(l.to),r.isValid()&&l.isValid()?(l=Y(l,r),r.isBefore(l)?l=xb(r,l):(l=xb(l,r),l.milliseconds=-l.milliseconds,l.months=-l.months),r=l):r={milliseconds:0,months:0},l={},l.ms=r.milliseconds,l.M=r.months);l=new ka(l);ia(d)&&f(d,"_locale")&&
(l._locale=d._locale);return l}function Za(d,h){d=d&&parseFloat(d.replace(",","."));return(isNaN(d)?0:d)*h}function xb(d,h){var l={milliseconds:0,months:0};l.months=h.month()-d.month()+12*(h.year()-d.year());d.clone().add(l.months,"M").isAfter(h)&&--l.months;l.milliseconds=+h-+d.clone().add(l.months,"M");return l}function Ya(d,h){return function(l,r){var a;null===r||isNaN(+r)||(D(h,"moment()."+h+"(period, number) is deprecated. Please use moment()."+h+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),
a=l,l=r,r=a);l=Sa("string"===typeof l?+l:l,r);ub(this,l,d);return this}}function ub(d,h,l,r){var a=h._milliseconds,y=qa(h._days);h=qa(h._months);d.isValid()&&(r=null==r?!0:r,h&&va(d,P(d,"Month")+h*l),y&&ba(d,"Date",P(d,"Date")+y*l),a&&d._d.setTime(d._d.valueOf()+a*l),r&&p.updateOffset(d,y||h))}function pb(d,h){var l=12*(h.year()-d.year())+(h.month()-d.month()),r=d.clone().add(l,"months");0>h-r?(d=d.clone().add(l-1,"months"),h=(h-r)/(r-d)):(d=d.clone().add(l+1,"months"),h=(h-r)/(d-r));return-(l+h)||
0}function tb(d){if(void 0===d)return this._locale._abbr;d=Da(d);null!=d&&(this._locale=d);return this}function yb(){return this._locale}function bb(d,h){O(0,[d,d.length],0,h)}function lb(d,h,l,r,a){var y;if(null==d)return la(this,r,a).year;y=ua(d,r,a);h>y&&(h=y);d=ya(d,h,l,r,a);d=wa(d.year,0,d.dayOfYear);this.year(d.getUTCFullYear());this.month(d.getUTCMonth());this.date(d.getUTCDate());return this}function Ra(d,h){h[nb]=E(1E3*("0."+d))}function wb(d){return d}function mb(d,h,l,r){var a=Da();h=b().set(r,
h);return a[l](h,d)}function vb(d,h,l){m(d)&&(h=d,d=void 0);d=d||"";if(null!=h)return mb(d,h,l,"month");var r=[];for(h=0;12>h;h++)r[h]=mb(d,h,l,"month");return r}function qb(d,h,l,r){"boolean"!==typeof d&&(l=h=d,d=!1);m(h)&&(l=h,h=void 0);h=h||"";var a=Da();d=d?a._week.dow:0;if(null!=l)return mb(h,(l+d)%7,r,"day");a=[];for(l=0;7>l;l++)a[l]=mb(h,(l+d)%7,r,"day");return a}function Gb(d,h,l,r){h=Sa(h,l);d._milliseconds+=r*h._milliseconds;d._days+=r*h._days;d._months+=r*h._months;return d._bubble()}function Hb(d){return 0>
d?Math.floor(d):Math.ceil(d)}function gb(d){return function(){return this.as(d)}}function jb(d){return function(){return this.isValid()?this._data[d]:NaN}}function lc(d,h,l,r,a){return a.relativeTime(h||1,!!l,d,r)}function ob(d){return(0<d)-(0>d)||+d}function Db(){if(!this.isValid())return this.localeData().invalidDate();var d=Ub(this._milliseconds)/1E3,h=Ub(this._days),l=Ub(this._months),r,a;r=z(d/60);a=z(r/60);d%=60;r%=60;var y=z(l/12),l=l%12,d=d?d.toFixed(3).replace(/\.?0+$/,""):"",b=this.asSeconds();
if(!b)return"P0D";var c=0>b?"-":"",H=ob(this._months)!==ob(b)?"-":"",A=ob(this._days)!==ob(b)?"-":"",b=ob(this._milliseconds)!==ob(b)?"-":"";return c+"P"+(y?H+y+"Y":"")+(l?H+l+"M":"")+(h?A+h+"D":"")+(a||r||d?"T":"")+(a?b+a+"H":"")+(r?b+r+"M":"")+(d?b+d+"S":"")}var Xb,Wb;Wb=Array.prototype.some?Array.prototype.some:function(d){for(var h=Object(this),l=h.length>>>0,r=0;r<l;r++)if(r in h&&d.call(this,h[r],r,h))return!0;return!1};var Nb=p.momentProperties=[],Ob=!1,Yb={};p.suppressDeprecationWarnings=
!1;p.deprecationHandler=null;var Zb;Zb=Object.keys?Object.keys:function(d){var h,l=[];for(h in d)f(d,h)&&l.push(h);return l};var kb={},Na={},$b=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Eb=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pb={},rb={},bc=/\d/,Va=/\d\d/,cc=/\d{3}/,Qb=/\d{4}/,Fb=/[+-]?\d{6}/,Ba=/\d\d?/,ac=/\d\d\d\d?/,gc=/\d\d\d\d\d\d?/,Jb=/\d{1,3}/,
Vb=/\d{1,4}/,Kb=/[+-]?\d{1,6}/,xc=/\d+/,Lb=/[+-]?\d+/,yc=/Z|[+-]\d\d:?\d\d/gi,Mb=/Z|[+-]\d\d(?::?\d\d)?/gi,Cb=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Rb={},Sb={},Wa=0,cb=1,$a=2,La=3,Xa=4,db=5,nb=6,mc=7,nc=8;O("Y",0,0,function(){var d=this.year();return 9999>=d?""+d:"+"+d});O(0,["YY",2],0,function(){return this.year()%100});O(0,["YYYY",4],0,"year");O(0,["YYYYY",5],0,"year");O(0,["YYYYYY",
6,!0],0,"year");L("year","y");Na.year=1;X("Y",Lb);X("YY",Ba,Va);X("YYYY",Vb,Qb);X("YYYYY",Kb,Fb);X("YYYYYY",Kb,Fb);h(["YYYYY","YYYYYY"],Wa);h("YYYY",function(d,h){h[Wa]=2===d.length?p.parseTwoDigitYear(d):E(d)});h("YY",function(d,h){h[Wa]=p.parseTwoDigitYear(d)});h("Y",function(d,h){h[Wa]=parseInt(d,10)});p.parseTwoDigitYear=function(d){return E(d)+(68<E(d)?1900:2E3)};var hc=H("FullYear",!0),Ha;Ha=Array.prototype.indexOf?Array.prototype.indexOf:function(d){var h;for(h=0;h<this.length;++h)if(this[h]===
d)return h;return-1};O("M",["MM",2],"Mo",function(){return this.month()+1});O("MMM",0,0,function(d){return this.localeData().monthsShort(this,d)});O("MMMM",0,0,function(d){return this.localeData().months(this,d)});L("month","M");Na.month=8;X("M",Ba);X("MM",Ba,Va);X("MMM",function(d,h){return h.monthsShortRegex(d)});X("MMMM",function(d,h){return h.monthsRegex(d)});h(["M","MM"],function(d,h){h[cb]=E(d)-1});h(["MMM","MMMM"],function(d,h,l,r){r=l._locale.monthsParse(d,r,l._strict);null!=r?h[cb]=r:a(l).invalidMonth=
d});var ic=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ec="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");O("w",["ww",2],"wo","week");O("W",["WW",2],"Wo","isoWeek");L("week","w");L("isoWeek","W");Na.week=5;Na.isoWeek=5;X("w",Ba);X("ww",Ba,Va);X("W",Ba);X("WW",Ba,Va);r(["w","ww","W","WW"],function(d,h,l,r){h[r.substr(0,1)]=E(d)});O("d",0,"do","day");O("dd",0,0,function(d){return this.localeData().weekdaysMin(this,d)});O("ddd",0,0,function(d){return this.localeData().weekdaysShort(this,d)});O("dddd",
0,0,function(d){return this.localeData().weekdays(this,d)});O("e",0,0,"weekday");O("E",0,0,"isoWeekday");L("day","d");L("weekday","e");L("isoWeekday","E");Na.day=11;Na.weekday=11;Na.isoWeekday=11;X("d",Ba);X("e",Ba);X("E",Ba);X("dd",function(d,h){return h.weekdaysMinRegex(d)});X("ddd",function(d,h){return h.weekdaysShortRegex(d)});X("dddd",function(d,h){return h.weekdaysRegex(d)});r(["dd","ddd","dddd"],function(d,h,l,r){r=l._locale.weekdaysParse(d,r,l._strict);null!=r?h.d=r:a(l).invalidWeekday=d});
r(["d","e","E"],function(d,h,l,r){h[r]=E(d)});var fc="Sun Mon Tue Wed Thu Fri Sat".split(" ");O("H",["HH",2],0,"hour");O("h",["hh",2],0,ra);O("k",["kk",2],0,function(){return this.hours()||24});O("hmm",0,0,function(){return""+ra.apply(this)+T(this.minutes(),2)});O("hmmss",0,0,function(){return""+ra.apply(this)+T(this.minutes(),2)+T(this.seconds(),2)});O("Hmm",0,0,function(){return""+this.hours()+T(this.minutes(),2)});O("Hmmss",0,0,function(){return""+this.hours()+T(this.minutes(),2)+T(this.seconds(),
2)});pa("a",!0);pa("A",!1);L("hour","h");Na.hour=13;X("a",Ia);X("A",Ia);X("H",Ba);X("h",Ba);X("k",Ba);X("HH",Ba,Va);X("hh",Ba,Va);X("kk",Ba,Va);X("hmm",ac);X("hmmss",gc);X("Hmm",ac);X("Hmmss",gc);h(["H","HH"],La);h(["k","kk"],function(d,h,l){d=E(d);h[La]=24===d?0:d});h(["a","A"],function(d,h,l){l._isPm=l._locale.isPM(d);l._meridiem=d});h(["h","hh"],function(d,h,l){h[La]=E(d);a(l).bigHour=!0});h("hmm",function(d,h,l){var r=d.length-2;h[La]=E(d.substr(0,r));h[Xa]=E(d.substr(r));a(l).bigHour=!0});h("hmmss",
function(d,h,l){var r=d.length-4,y=d.length-2;h[La]=E(d.substr(0,r));h[Xa]=E(d.substr(r,2));h[db]=E(d.substr(y));a(l).bigHour=!0});h("Hmm",function(d,h,l){l=d.length-2;h[La]=E(d.substr(0,l));h[Xa]=E(d.substr(l))});h("Hmmss",function(d,h,l){l=d.length-4;var r=d.length-2;h[La]=E(d.substr(0,l));h[Xa]=E(d.substr(l,2));h[db]=E(d.substr(r))});var zc=H("Hours",!0),dc={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",
sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),
monthsShort:ec,week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:fc,meridiemParse:/[ap]\.?m?\.?/i},Ka={},Ab={},zb,oc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pc=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
qc=/Z|[+-]\d\d(?::?\d\d)?/,Ib=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Tb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",
/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],tc=/^\/?Date\((\-?\d+)/i,rc=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,sc={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};p.createFromInputFallback=F("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
function(d){d._d=new Date(d._i+(d._useUTC?" UTC":""))});p.ISO_8601=function(){};p.RFC_2822=function(){};var Ac=F("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var d=Z.apply(null,arguments);return this.isValid()&&d.isValid()?d<this?this:d:x()}),Bc=F("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var d=Z.apply(null,arguments);return this.isValid()&&d.isValid()?d>this?this:
d:x()}),Bb="year quarter month week day hour minute second millisecond".split(" ");ga("Z",":");ga("ZZ","");X("Z",Mb);X("ZZ",Mb);h(["Z","ZZ"],function(d,h,l){l._useUTC=!0;l._tzm=ha(Mb,d)});var uc=/([\+\-]|\d\d)/gi;p.updateOffset=function(){};var vc=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,wc=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Sa.fn=ka.prototype;Sa.invalid=
function(){return Sa(NaN)};var Cc=Ya(1,"add"),Dc=Ya(-1,"subtract");p.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";p.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var jc=F("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(d){return void 0===d?this.localeData():this.locale(d)});O(0,["gg",2],0,function(){return this.weekYear()%100});O(0,["GG",2],0,function(){return this.isoWeekYear()%100});bb("gggg","weekYear");
bb("ggggg","weekYear");bb("GGGG","isoWeekYear");bb("GGGGG","isoWeekYear");L("weekYear","gg");L("isoWeekYear","GG");Na.weekYear=1;Na.isoWeekYear=1;X("G",Lb);X("g",Lb);X("GG",Ba,Va);X("gg",Ba,Va);X("GGGG",Vb,Qb);X("gggg",Vb,Qb);X("GGGGG",Kb,Fb);X("ggggg",Kb,Fb);r(["gggg","ggggg","GGGG","GGGGG"],function(d,h,l,r){h[r.substr(0,2)]=E(d)});r(["gg","GG"],function(d,h,l,r){h[r]=p.parseTwoDigitYear(d)});O("Q",0,"Qo","quarter");L("quarter","Q");Na.quarter=7;X("Q",bc);h("Q",function(d,h){h[cb]=3*(E(d)-1)});
O("D",["DD",2],"Do","date");L("date","D");Na.date=9;X("D",Ba);X("DD",Ba,Va);X("Do",function(d,h){return d?h._dayOfMonthOrdinalParse||h._ordinalParse:h._dayOfMonthOrdinalParseLenient});h(["D","DD"],$a);h("Do",function(d,h){h[$a]=E(d.match(Ba)[0])});var kc=H("Date",!0);O("DDD",["DDDD",3],"DDDo","dayOfYear");L("dayOfYear","DDD");Na.dayOfYear=4;X("DDD",Jb);X("DDDD",cc);h(["DDD","DDDD"],function(d,h,l){l._dayOfYear=E(d)});O("m",["mm",2],0,"minute");L("minute","m");Na.minute=14;X("m",Ba);X("mm",Ba,Va);
h(["m","mm"],Xa);var Ec=H("Minutes",!1);O("s",["ss",2],0,"second");L("second","s");Na.second=15;X("s",Ba);X("ss",Ba,Va);h(["s","ss"],db);var Fc=H("Seconds",!1);O("S",0,0,function(){return~~(this.millisecond()/100)});O(0,["SS",2],0,function(){return~~(this.millisecond()/10)});O(0,["SSS",3],0,"millisecond");O(0,["SSSS",4],0,function(){return 10*this.millisecond()});O(0,["SSSSS",5],0,function(){return 100*this.millisecond()});O(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});O(0,["SSSSSSS",
7],0,function(){return 1E4*this.millisecond()});O(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});O(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});L("millisecond","ms");Na.millisecond=16;X("S",Jb,bc);X("SS",Jb,Va);X("SSS",Jb,cc);var hb;for(hb="SSSS";9>=hb.length;hb+="S")X(hb,xc);for(hb="S";9>=hb.length;hb+="S")h(hb,Ra);var Gc=H("Milliseconds",!1);O("z",0,0,"zoneAbbr");O("zz",0,0,"zoneName");var da=q.prototype;da.add=Cc;da.calendar=function(d,h){d=d||Z();var l=Y(d,this).startOf("day"),
l=p.calendarFormat(this,l)||"sameElse";h=h&&(I(h[l])?h[l].call(this,d):h[l]);return this.format(h||this.localeData().calendar(l,this,Z(d)))};da.clone=function(){return new q(this)};da.diff=function(d,h,l){var r;if(!this.isValid())return NaN;d=Y(d,this);if(!d.isValid())return NaN;r=6E4*(d.utcOffset()-this.utcOffset());h=M(h);switch(h){case "year":h=pb(this,d)/12;break;case "month":h=pb(this,d);break;case "quarter":h=pb(this,d)/3;break;case "second":h=(this-d)/1E3;break;case "minute":h=(this-d)/6E4;
break;case "hour":h=(this-d)/36E5;break;case "day":h=(this-d-r)/864E5;break;case "week":h=(this-d-r)/6048E5;break;default:h=this-d}return l?h:z(h)};da.endOf=function(d){d=M(d);if(void 0===d||"millisecond"===d)return this;"date"===d&&(d="day");return this.startOf(d).add(1,"isoWeek"===d?"week":d).subtract(1,"ms")};da.format=function(d){d||(d=this.isUtc()?p.defaultFormatUtc:p.defaultFormat);d=V(this,d);return this.localeData().postformat(d)};da.from=function(d,h){return this.isValid()&&(C(d)&&d.isValid()||
Z(d).isValid())?Sa({to:this,from:d}).locale(this.locale()).humanize(!h):this.localeData().invalidDate()};da.fromNow=function(d){return this.from(Z(),d)};da.to=function(d,h){return this.isValid()&&(C(d)&&d.isValid()||Z(d).isValid())?Sa({from:this,to:d}).locale(this.locale()).humanize(!h):this.localeData().invalidDate()};da.toNow=function(d){return this.to(Z(),d)};da.get=function(d){d=M(d);return I(this[d])?this[d]():this};da.invalidAt=function(){return a(this).overflow};da.isAfter=function(d,h){d=
C(d)?d:Z(d);if(!this.isValid()||!d.isValid())return!1;h=M(h)||"millisecond";return"millisecond"===h?this.valueOf()>d.valueOf():d.valueOf()<this.clone().startOf(h).valueOf()};da.isBefore=function(d,h){d=C(d)?d:Z(d);if(!this.isValid()||!d.isValid())return!1;h=M(h)||"millisecond";return"millisecond"===h?this.valueOf()<d.valueOf():this.clone().endOf(h).valueOf()<d.valueOf()};da.isBetween=function(d,h,l,r){d=C(d)?d:Z(d);h=C(h)?h:Z(h);if(!(this.isValid()&&d.isValid()&&h.isValid()))return!1;r=r||"()";return("("===
r[0]?this.isAfter(d,l):!this.isBefore(d,l))&&(")"===r[1]?this.isBefore(h,l):!this.isAfter(h,l))};da.isSame=function(d,h){d=C(d)?d:Z(d);if(!this.isValid()||!d.isValid())return!1;h=M(h)||"millisecond";if("millisecond"===h)return this.valueOf()===d.valueOf();d=d.valueOf();return this.clone().startOf(h).valueOf()<=d&&d<=this.clone().endOf(h).valueOf()};da.isSameOrAfter=function(d,h){return this.isSame(d,h)||this.isAfter(d,h)};da.isSameOrBefore=function(d,h){return this.isSame(d,h)||this.isBefore(d,h)};
da.isValid=function(){return c(this)};da.lang=jc;da.locale=tb;da.localeData=yb;da.max=Bc;da.min=Ac;da.parsingFlags=function(){return e({},a(this))};da.set=function(d,h){if("object"===typeof d){d=Q(d);h=S(d);for(var l=0;l<h.length;l++)this[h[l].unit](d[h[l].unit])}else if(d=M(d),I(this[d]))return this[d](h);return this};da.startOf=function(d){d=M(d);switch(d){case "year":this.month(0);case "quarter":case "month":this.date(1);case "week":case "isoWeek":case "day":case "date":this.hours(0);case "hour":this.minutes(0);
case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===d&&this.weekday(0);"isoWeek"===d&&this.isoWeekday(1);"quarter"===d&&this.month(3*Math.floor(this.month()/3));return this};da.subtract=Dc;da.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};da.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}};
da.toDate=function(){return new Date(this.valueOf())};da.toISOString=function(d){if(!this.isValid())return null;var h=(d=!0!==d)?this.clone().utc():this;return 0>h.year()||9999<h.year()?V(h,d?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):I(Date.prototype.toISOString)?d?this.toDate().toISOString():(new Date(this.valueOf()+6E4*this.utcOffset())).toISOString().replace("Z",V(h,"Z")):V(h,d?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")};da.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+
this._i+" */)";var d="moment",h="";this.isLocal()||(d=0===this.utcOffset()?"moment.utc":"moment.parseZone",h="Z");var d="["+d+'("]',l=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(d+l+"-MM-DD[T]HH:mm:ss.SSS"+(h+'[")]'))};da.toJSON=function(){return this.isValid()?this.toISOString():null};da.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};da.unix=function(){return Math.floor(this.valueOf()/1E3)};da.valueOf=function(){return this._d.valueOf()-
6E4*(this._offset||0)};da.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};da.year=hc;da.isLeapYear=function(){return y(this.year())};da.weekYear=function(d){return lb.call(this,d,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)};da.isoWeekYear=function(d){return lb.call(this,d,this.isoWeek(),this.isoWeekday(),1,4)};da.quarter=da.quarters=function(d){return null==d?Math.ceil((this.month()+1)/
3):this.month(3*(d-1)+this.month()%3)};da.month=N;da.daysInMonth=function(){return ea(this.year(),this.month())};da.week=da.weeks=function(d){var h=this.localeData().week(this);return null==d?h:this.add(7*(d-h),"d")};da.isoWeek=da.isoWeeks=function(d){var h=la(this,1,4).week;return null==d?h:this.add(7*(d-h),"d")};da.weeksInYear=function(){var d=this.localeData()._week;return ua(this.year(),d.dow,d.doy)};da.isoWeeksInYear=function(){return ua(this.year(),1,4)};da.date=kc;da.day=da.days=function(d){if(!this.isValid())return null!=
d?this:NaN;var h=this._isUTC?this._d.getUTCDay():this._d.getDay();if(null!=d){var l=this.localeData();"string"===typeof d&&(isNaN(d)?(d=l.weekdaysParse(d),d="number"===typeof d?d:null):d=parseInt(d,10));return this.add(d-h,"d")}return h};da.weekday=function(d){if(!this.isValid())return null!=d?this:NaN;var h=(this.day()+7-this.localeData()._week.dow)%7;return null==d?h:this.add(d-h,"d")};da.isoWeekday=function(d){if(!this.isValid())return null!=d?this:NaN;if(null!=d){var h=this.localeData();d="string"===
typeof d?h.weekdaysParse(d)%7||7:isNaN(d)?null:d;return this.day(this.day()%7?d:d-7)}return this.day()||7};da.dayOfYear=function(d){var h=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==d?h:this.add(d-h,"d")};da.hour=da.hours=zc;da.minute=da.minutes=Ec;da.second=da.seconds=Fc;da.millisecond=da.milliseconds=Gc;da.utcOffset=function(d,h,l){var r=this._offset||0,a;if(!this.isValid())return null!=d?this:NaN;if(null!=d){if("string"===typeof d){if(d=ha(Mb,d),
null===d)return this}else 16>Math.abs(d)&&!l&&(d*=60);!this._isUTC&&h&&(a=15*-Math.round(this._d.getTimezoneOffset()/15));this._offset=d;this._isUTC=!0;null!=a&&this.add(a,"m");r!==d&&(!h||this._changeInProgress?ub(this,Sa(d-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,p.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?r:15*-Math.round(this._d.getTimezoneOffset()/15)};da.utc=function(d){return this.utcOffset(0,d)};da.local=function(d){this._isUTC&&
(this.utcOffset(0,d),this._isUTC=!1,d&&this.subtract(15*-Math.round(this._d.getTimezoneOffset()/15),"m"));return this};da.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var d=ha(yc,this._i);null!=d?this.utcOffset(d):this.utcOffset(0,!0)}return this};da.hasAlignedHourOffset=function(d){if(!this.isValid())return!1;d=d?Z(d).utcOffset():0;return 0===(this.utcOffset()-d)%60};da.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||
this.utcOffset()>this.clone().month(5).utcOffset()};da.isLocal=function(){return this.isValid()?!this._isUTC:!1};da.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};da.isUtc=sb;da.isUTC=sb;da.zoneAbbr=function(){return this._isUTC?"UTC":""};da.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""};da.dates=F("dates accessor is deprecated. Use date instead.",kc);da.months=F("months accessor is deprecated. Use month instead",N);da.years=F("years accessor is deprecated. Use year instead",
hc);da.zone=F("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(d,h){return null!=d?("string"!==typeof d&&(d=-d),this.utcOffset(d,h),this):-this.utcOffset()});da.isDSTShifted=F("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!n(this._isDSTShifted))return this._isDSTShifted;var d={};w(d,this);d=Qa(d);if(d._a){var h=d._isUTC?b(d._a):Z(d._a);this._isDSTShifted=this.isValid()&&
0<B(d._a,h.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var Aa=J.prototype;Aa.calendar=function(d,h,l){d=this._calendar[d]||this._calendar.sameElse;return I(d)?d.call(h,l):d};Aa.longDateFormat=function(d){var h=this._longDateFormat[d],l=this._longDateFormat[d.toUpperCase()];if(h||!l)return h;this._longDateFormat[d]=l.replace(/MMMM|MM|DD|dddd/g,function(d){return d.slice(1)});return this._longDateFormat[d]};Aa.invalidDate=function(){return this._invalidDate};Aa.ordinal=function(d){return this._ordinal.replace("%d",
d)};Aa.preparse=wb;Aa.postformat=wb;Aa.relativeTime=function(d,h,l,r){var a=this._relativeTime[l];return I(a)?a(d,h,l,r):a.replace(/%d/i,d)};Aa.pastFuture=function(d,h){d=this._relativeTime[0<d?"future":"past"];return I(d)?d(h):d.replace(/%s/i,h)};Aa.set=function(d){var h,l;for(l in d)h=d[l],I(h)?this[l]=h:this["_"+l]=h;this._config=d;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};Aa.months=function(d,h){return d?
g(this._months)?this._months[d.month()]:this._months[(this._months.isFormat||ic).test(h)?"format":"standalone"][d.month()]:g(this._months)?this._months:this._months.standalone};Aa.monthsShort=function(d,h){return d?g(this._monthsShort)?this._monthsShort[d.month()]:this._monthsShort[ic.test(h)?"format":"standalone"][d.month()]:g(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};Aa.monthsParse=function(d,h,l){var r,a;if(this._monthsParseExact){a:{d=d.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=
[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;12>r;++r)a=b([2E3,r]),this._shortMonthsParse[r]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(a,"").toLocaleLowerCase();if(l)h="MMM"===h?Ha.call(this._shortMonthsParse,d):Ha.call(this._longMonthsParse,d);else if("MMM"===h){h=Ha.call(this._shortMonthsParse,d);if(-1!==h)break a;h=Ha.call(this._longMonthsParse,d)}else{h=Ha.call(this._longMonthsParse,d);if(-1!==h)break a;h=Ha.call(this._shortMonthsParse,d)}h=-1!==
h?h:null}return h}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(r=0;12>r;r++)if(a=b([2E3,r]),l&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),l||this._monthsParse[r]||(a="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[r]=new RegExp(a.replace(".",""),"i")),l&&"MMMM"===h&&this._longMonthsParse[r].test(d)||
l&&"MMM"===h&&this._shortMonthsParse[r].test(d)||!l&&this._monthsParse[r].test(d))return r};Aa.monthsRegex=function(d){if(this._monthsParseExact)return f(this,"_monthsRegex")||Ca.call(this),d?this._monthsStrictRegex:this._monthsRegex;f(this,"_monthsRegex")||(this._monthsRegex=Cb);return this._monthsStrictRegex&&d?this._monthsStrictRegex:this._monthsRegex};Aa.monthsShortRegex=function(d){if(this._monthsParseExact)return f(this,"_monthsRegex")||Ca.call(this),d?this._monthsShortStrictRegex:this._monthsShortRegex;
f(this,"_monthsShortRegex")||(this._monthsShortRegex=Cb);return this._monthsShortStrictRegex&&d?this._monthsShortStrictRegex:this._monthsShortRegex};Aa.week=function(d){return la(d,this._week.dow,this._week.doy).week};Aa.firstDayOfYear=function(){return this._week.doy};Aa.firstDayOfWeek=function(){return this._week.dow};Aa.weekdays=function(d,h){return d?g(this._weekdays)?this._weekdays[d.day()]:this._weekdays[this._weekdays.isFormat.test(h)?"format":"standalone"][d.day()]:g(this._weekdays)?this._weekdays:
this._weekdays.standalone};Aa.weekdaysMin=function(d){return d?this._weekdaysMin[d.day()]:this._weekdaysMin};Aa.weekdaysShort=function(d){return d?this._weekdaysShort[d.day()]:this._weekdaysShort};Aa.weekdaysParse=function(d,h,l){var r,a;if(this._weekdaysParseExact)return Ea.call(this,d,h,l);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]);for(r=0;7>r;r++)if(a=b([2E3,1]).day(r),l&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=
new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(a="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[r]=new RegExp(a.replace(".",""),"i")),l&&"dddd"===h&&this._fullWeekdaysParse[r].test(d)||l&&"ddd"===h&&this._shortWeekdaysParse[r].test(d)||
l&&"dd"===h&&this._minWeekdaysParse[r].test(d)||!l&&this._weekdaysParse[r].test(d))return r};Aa.weekdaysRegex=function(d){if(this._weekdaysParseExact)return f(this,"_weekdaysRegex")||oa.call(this),d?this._weekdaysStrictRegex:this._weekdaysRegex;f(this,"_weekdaysRegex")||(this._weekdaysRegex=Cb);return this._weekdaysStrictRegex&&d?this._weekdaysStrictRegex:this._weekdaysRegex};Aa.weekdaysShortRegex=function(d){if(this._weekdaysParseExact)return f(this,"_weekdaysRegex")||oa.call(this),d?this._weekdaysShortStrictRegex:
this._weekdaysShortRegex;f(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Cb);return this._weekdaysShortStrictRegex&&d?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};Aa.weekdaysMinRegex=function(d){if(this._weekdaysParseExact)return f(this,"_weekdaysRegex")||oa.call(this),d?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;f(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Cb);return this._weekdaysMinStrictRegex&&d?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};Aa.isPM=
function(d){return"p"===(d+"").toLowerCase().charAt(0)};Aa.meridiem=function(d,h,l){return 11<d?l?"pm":"PM":l?"am":"AM"};Fa("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(d){var h=d%10,h=1===E(d%100/10)?"th":1===h?"st":2===h?"nd":3===h?"rd":"th";return d+h}});p.lang=F("moment.lang is deprecated. Use moment.locale instead.",Fa);p.langData=F("moment.langData is deprecated. Use moment.localeData instead.",Da);var eb=Math.abs,Hc=gb("ms"),Ic=gb("s"),Jc=gb("m"),Kc=gb("h"),Lc=gb("d"),
Mc=gb("w"),Nc=gb("M"),Oc=gb("y"),Pc=jb("milliseconds"),Qc=jb("seconds"),Rc=jb("minutes"),Sc=jb("hours"),Tc=jb("days"),Uc=jb("months"),Vc=jb("years"),ib=Math.round,ab={ss:44,s:45,m:45,h:22,d:26,M:11},Ub=Math.abs,ta=ka.prototype;ta.isValid=function(){return this._isValid};ta.abs=function(){var d=this._data;this._milliseconds=eb(this._milliseconds);this._days=eb(this._days);this._months=eb(this._months);d.milliseconds=eb(d.milliseconds);d.seconds=eb(d.seconds);d.minutes=eb(d.minutes);d.hours=eb(d.hours);
d.months=eb(d.months);d.years=eb(d.years);return this};ta.add=function(d,h){return Gb(this,d,h,1)};ta.subtract=function(d,h){return Gb(this,d,h,-1)};ta.as=function(d){if(!this.isValid())return NaN;var h,l=this._milliseconds;d=M(d);if("month"===d||"year"===d)return h=this._days+l/864E5,h=this._months+4800*h/146097,"month"===d?h:h/12;h=this._days+Math.round(146097*this._months/4800);switch(d){case "week":return h/7+l/6048E5;case "day":return h+l/864E5;case "hour":return 24*h+l/36E5;case "minute":return 1440*
h+l/6E4;case "second":return 86400*h+l/1E3;case "millisecond":return Math.floor(864E5*h)+l;default:throw Error("Unknown unit "+d);}};ta.asMilliseconds=Hc;ta.asSeconds=Ic;ta.asMinutes=Jc;ta.asHours=Kc;ta.asDays=Lc;ta.asWeeks=Mc;ta.asMonths=Nc;ta.asYears=Oc;ta.valueOf=function(){return this.isValid()?this._milliseconds+864E5*this._days+this._months%12*2592E6+31536E6*E(this._months/12):NaN};ta._bubble=function(){var d=this._milliseconds,h=this._days,l=this._months,r=this._data;0<=d&&0<=h&&0<=l||0>=d&&
0>=h&&0>=l||(d+=864E5*Hb(146097*l/4800+h),l=h=0);r.milliseconds=d%1E3;d=z(d/1E3);r.seconds=d%60;d=z(d/60);r.minutes=d%60;d=z(d/60);r.hours=d%24;h+=z(d/24);d=z(4800*h/146097);l+=d;h-=Hb(146097*d/4800);d=z(l/12);r.days=h;r.months=l%12;r.years=d;return this};ta.clone=function(){return Sa(this)};ta.get=function(d){d=M(d);return this.isValid()?this[d+"s"]():NaN};ta.milliseconds=Pc;ta.seconds=Qc;ta.minutes=Rc;ta.hours=Sc;ta.days=Tc;ta.weeks=function(){return z(this.days()/7)};ta.months=Uc;ta.years=Vc;ta.humanize=
function(d){if(!this.isValid())return this.localeData().invalidDate();var h=this.localeData(),l;l=!d;var r=Sa(this).abs(),a=ib(r.as("s")),y=ib(r.as("m")),b=ib(r.as("h")),c=ib(r.as("d")),H=ib(r.as("M")),r=ib(r.as("y")),a=a<=ab.ss&&["s",a]||a<ab.s&&["ss",a]||1>=y&&["m"]||y<ab.m&&["mm",y]||1>=b&&["h"]||b<ab.h&&["hh",b]||1>=c&&["d"]||c<ab.d&&["dd",c]||1>=H&&["M"]||H<ab.M&&["MM",H]||1>=r&&["y"]||["yy",r];a[2]=l;a[3]=0<+this;a[4]=h;l=lc.apply(null,a);d&&(l=h.pastFuture(+this,l));return h.postformat(l)};
ta.toISOString=Db;ta.toString=Db;ta.toJSON=Db;ta.locale=tb;ta.localeData=yb;ta.toIsoString=F("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Db);ta.lang=jc;O("X",0,0,"unix");O("x",0,0,"valueOf");X("x",Lb);X("X",/[+-]?\d+(\.\d{1,3})?/);h("X",function(d,h,l){l._d=new Date(1E3*parseFloat(d,10))});h("x",function(d,h,l){l._d=new Date(E(d))});p.version="2.23.0";Xb=Z;p.fn=da;p.min=function(){var d=[].slice.call(arguments,0);return sa("isBefore",d)};p.max=function(){var d=
[].slice.call(arguments,0);return sa("isAfter",d)};p.now=function(){return Date.now?Date.now():+new Date};p.utc=b;p.unix=function(d){return Z(1E3*d)};p.months=function(d,h){return vb(d,h,"months")};p.isDate=u;p.locale=Fa;p.invalid=x;p.duration=Sa;p.isMoment=C;p.weekdays=function(d,h,l){return qb(d,h,l,"weekdays")};p.parseZone=function(){return Z.apply(null,arguments).parseZone()};p.localeData=Da;p.isDuration=ia;p.monthsShort=function(d,h){return vb(d,h,"monthsShort")};p.weekdaysMin=function(d,h,l){return qb(d,
h,l,"weekdaysMin")};p.defineLocale=Ma;p.updateLocale=function(d,h){if(null!=h){var l,r=dc;l=za(d);null!=l&&(r=l._config);h=K(r,h);h=new J(h);h.parentLocale=Ka[d];Ka[d]=h;Fa(d)}else null!=Ka[d]&&(null!=Ka[d].parentLocale?Ka[d]=Ka[d].parentLocale:null!=Ka[d]&&delete Ka[d]);return Ka[d]};p.locales=function(){return Zb(Ka)};p.weekdaysShort=function(d,h,l){return qb(d,h,l,"weekdaysShort")};p.normalizeUnits=M;p.relativeTimeRounding=function(d){return void 0===d?ib:"function"===typeof d?(ib=d,!0):!1};p.relativeTimeThreshold=
function(d,h){if(void 0===ab[d])return!1;if(void 0===h)return ab[d];ab[d]=h;"s"===d&&(ab.ss=h-1);return!0};p.calendarFormat=function(d,h){d=d.diff(h,"days",!0);return-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse"};p.prototype=da;p.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",
MONTH:"YYYY-MM"};return p})},"esri/arcade/FunctionWrapper":function(){define(["require","exports"],function(p,g){return function(){return function(g,p){this.context=this.definition=null;this.definition=g;this.context=p}}()})},"esri/arcade/ImmutablePathArray":function(){var p=this&&this.__extends||function(){var g=function(p,v){g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var u in m)m.hasOwnProperty(u)&&(g[u]=m[u])};return g(p,v)};return function(p,
v){function n(){this.constructor=p}g(p,v);p.prototype=null===v?Object.create(v):(n.prototype=v.prototype,new n)}}();define(["require","exports","./ImmutableArray","./ImmutablePointArray"],function(g,t,v,n){return function(m){function g(k,f,e,b,a){k=m.call(this,k)||this;k._lazyPath=[];k._hasZ=!1;k._hasM=!1;k._hasZ=e;k._hasM=b;k._spRef=f;k._cacheId=a;return k}p(g,m);g.prototype.get=function(k){if(void 0===this._lazyPath[k]){var f=this._elements[k];if(void 0===f)return;this._lazyPath[k]=new n(f,this._spRef,
this._hasZ,this._hasM,this._cacheId,k)}return this._lazyPath[k]};g.prototype.equalityTest=function(k){return k===this?!0:null===k||!1===k instanceof g?!1:k.getUniqueHash()===this.getUniqueHash()};g.prototype.getUniqueHash=function(){return this._cacheId.toString()};return g}(v)})},"esri/arcade/ImmutablePointArray":function(){var p=this&&this.__extends||function(){var g=function(p,v){g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var u in m)m.hasOwnProperty(u)&&
(g[u]=m[u])};return g(p,v)};return function(p,v){function n(){this.constructor=p}g(p,v);p.prototype=null===v?Object.create(v):(n.prototype=v.prototype,new n)}}();define(["require","exports","./ImmutableArray","../geometry/Point"],function(g,t,v,n){return function(m){function g(k,f,e,b,a,c){k=m.call(this,k)||this;k._lazyPt=[];k._hasZ=!1;k._hasM=!1;k._spRef=f;k._hasZ=e;k._hasM=b;k._cacheId=a;k._partId=c;return k}p(g,m);g.prototype.get=function(k){if(void 0===this._lazyPt[k]){var f=this._elements[k];
if(void 0===f)return;var e=this._hasZ,b=this._hasM,a=null,a=e&&!b?new n(f[0],f[1],f[2],void 0,this._spRef):b&&e?new n(f[0],f[1],void 0,f[2],this._spRef):e&&b?new n(f[0],f[1],f[2],f[3],this._spRef):new n(f[0],f[1],this._spRef);a.setCacheValue("_arcadeCacheId",this._cacheId.toString()+"-"+this._partId.toString()+"-"+k.toString());this._lazyPt[k]=a}return this._lazyPt[k]};g.prototype.equalityTest=function(k){return k===this?!0:null===k||!1===k instanceof g?!1:k.getUniqueHash()===this.getUniqueHash()};
g.prototype.getUniqueHash=function(){return this._cacheId.toString()+"-"+this._partId.toString()};return g}(v)})},"esri/geometry/Multipoint":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e){function b(){}function a(){}p=p(u,{declaredClass:"esri.geometry.Multipoint",type:"multipoint",points:null,constructor:function(a){this.points=[];a&&(a.points?n.mixin(this,a):this.spatialReference=
a,this.spatialReference&&(this.spatialReference=e.createSpatialReference(this.spatialReference)));this.verifySR()},addPoint:function(a){this.clearCache();g.isArray(a)?this.points.push(a):this.points.push([a.x,a.y]);return this},removePoint:function(a){if(this._validateInputs(a))return this.clearCache(),new k(this.points.splice(a,1)[0],this.spatialReference)},getExtent:function(){var a=this.getCacheValue("_extent");if(a)return new f(a);var a=this.points,b=a.length;if(b){var e=a[0],q,k,m=q=e[0],g=k=
e[1],B=Math.min,u=Math.max,n=this.spatialReference,D,p;for(p=0;p<b;p++)e=a[p],D=e[0],e=e[1],m=B(m,D),g=B(g,e),q=u(q,D),k=u(k,e);a={xmin:m,ymin:g,xmax:q,ymax:k,spatialReference:n?n.toJson():null};this.setCacheValue("_extent",a);return new f(a)}},_validateInputs:function(a){return null===a||0>a||a>=this.points.length?!1:!0},getPoint:function(a){if(this._validateInputs(a))return a=this.points[a],new k(a[0],a[1],this.spatialReference)},setPoint:function(a,b){if(this._validateInputs(a))return this.clearCache(),
this.points[a]=[b.x,b.y],this},toJson:function(){var a={points:n.clone2DArray(this.points)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});b.prototype=p.prototype;a.prototype=new b;Object.defineProperty(a.prototype,"points",{get:function(){this._unquantizeFn&&(this._pointsVal=this._unquantizeFn({points:n.clone2DArray(this._pointsVal)}).points,this._unquantizeFn=null);return this._pointsVal},set:function(a){this._pointsVal=a}});a.prototype.setupLazyUnquantization=function(a,
b){this._unquantizeFn=a;this._pointsVal=b.points};p.simpleConstructor=b;p.accessorConstructor=a;p.defaultProps={type:"multipoint",points:null};return p})},"esri/geometry/Polygon":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a){function c(){}function x(){}var w=p(k,{declaredClass:"esri.geometry.Polygon",type:"polygon",rings:null,constructor:function(b){this.rings=
[];this._ring=0;b&&(t.isArray(b)?this.rings=t.isArray(b[0][0])?b:[b]:b.rings?m.mixin(this,b):this.spatialReference=b,this.spatialReference&&(this.spatialReference=a.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];t.isArray(a[0])?g.forEach(a,this._addPointArr,this):g.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,
a.y])},_insertPoints:function(a,b){this.clearCache();this._ring=b;this.rings[this._ring]||(this.rings[this._ring]=[]);g.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new f(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=
[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&null!=b&&0<=b&&b<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,e=this.spatialReference;for(b=0;b<c;b++)a[b]=new f(a[b],e);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new f(this.rings[a].splice(b,1)[0],this.spatialReference)},
getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");if(a)return a=new e(a),a._partwise=b,a;a=this.rings;var c=a.length;if(c&&a[0].length){var f,w,x,k,m,g,u,n,p=k=a[0][0][0],v=m=a[0][0][1],t=Math.min,S=Math.max,T=this.spatialReference,b=[],O,W,U,V;for(g=0;g<c;g++){f=a[g];O=W=f[0]&&f[0][0];U=V=f[0]&&f[0][1];n=f.length;for(u=0;u<n;u++)w=f[u],x=w[0],w=w[1],p=t(p,x),v=t(v,w),k=S(k,x),m=S(m,w),O=t(O,x),U=t(U,w),W=S(W,x),V=S(V,w);b.push(new e({xmin:O,ymin:U,xmax:W,
ymax:V,spatialReference:T?T.toJson():null}))}a={xmin:p,ymin:v,xmax:k,ymax:m,spatialReference:T?T.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new e(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c,e=!1,q,w,x,k,m,g,u=b.length;c=this.spatialReference;q=a.spatialReference;var n=a.x;a=a.y;c&&q&&!c.equals(q)&&c._canProject(q)&&(a=c.isWebMercator()?f.lngLatToXY(n,a):f.xyToLngLat(n,a,!0),n=a[0],a=a[1]);for(g=0;g<u;g++)for(c=b[g],
x=c.length,m=k=0;m<x;m++)k++,k===x&&(k=0),q=c[m],w=c[k],(q[1]<a&&w[1]>=a||w[1]<a&&q[1]>=a)&&q[0]+(a-q[1])/(w[1]-q[1])*(w[0]-q[0])<n&&(e=!e);return e},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;var a=this.rings,b,c,e,w,x=[],k,m,u=Infinity,n=-Infinity,p=Infinity,v=-Infinity;g.forEach(a,function(a){b=c=e=0;g.forEach(a,function(f,q){q<a.length-1&&(k=a[q+1],m=f[0]*k[1]-k[0]*f[1],b+=(f[0]+k[0])*m,c+=(f[1]+k[1])*m,e+=m,f[0]<u&&(u=f[0]),f[0]>n&&(n=f[0]),f[1]<p&&(p=
f[1]),f[1]>v&&(v=f[1]))});0<e&&(e*=-1);e&&x.push([b,c,e/2])});x.sort(function(a,b){return a[2]-b[2]});b=c=void 0;x[0]&&(w=6*x[0][2],b=x[0][0]/w,c=x[0][1]/w,b<u||b>n||c<p||c>v)&&(b=c=void 0);if(void 0===b||void 0===c)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)b=a.x,c=a.y;a=isNaN(b)||isNaN(c)?null:new f(b,c,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var c,e=0,f=0,q=0,w,x,k={x:0,y:0},m={x:0,y:0},g,u=a.length,n;for(g=0;g<u-1;g++)w=a[g],
x=a[g+1],w&&x&&(k.x=w[0],k.y=w[1],m.x=x[0],m.y=x[1],c=b.getLength(k,m),0<c&&(e+=c,w=b.getMidpoint(w,x),f+=c*w[0],q+=c*w[1]));0<e?n={x:f/e,y:q/e}:a[0]&&(n={x:a[0][0],y:a[0][1]});return n},isClockwise:function(a){var b=0,c,e=a.length,f=t.isArray(a[0])?function(a,b){return a[0]*b[1]-b[0]*a[1]}:function(a,b){return a.x*b.y-b.x*a.y};for(c=0;c<e;c++)b+=f(a[c],a[(c+1)%e]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var c,e,f,q,w,x,k,m=a.rings.length,g;for(f=0;f<m;f++){for(c=0;c<a.rings[f].length-
1;c++)for(w=[[a.rings[f][c][0],a.rings[f][c][1]],[a.rings[f][c+1][0],a.rings[f][c+1][1]]],e=f+1;e<m;e++)for(q=0;q<a.rings[e].length-1;q++)if(x=[[a.rings[e][q][0],a.rings[e][q][1]],[a.rings[e][q+1][0],a.rings[e][q+1][1]]],(k=b._getLineIntersection2(w,x))&&!(k[0]===w[0][0]&&k[1]===w[0][1]||k[0]===x[0][0]&&k[1]===x[0][1]||k[0]===w[1][0]&&k[1]===w[1][1]||k[0]===x[1][0]&&k[1]===x[1][1]))return!0;q=a.rings[f].length;if(!(4>=q))for(c=0;c<q-3;c++)for(g=q-1,0===c&&(g=q-2),w=[[a.rings[f][c][0],a.rings[f][c][1]],
[a.rings[f][c+1][0],a.rings[f][c+1][1]]],e=c+2;e<g;e++)if(x=[[a.rings[f][e][0],a.rings[f][e][1]],[a.rings[f][e+1][0],a.rings[f][e+1][1]]],(k=b._getLineIntersection2(w,x))&&!(k[0]===w[0][0]&&k[1]===w[0][1]||k[0]===x[0][0]&&k[1]===x[0][1]||k[0]===w[1][0]&&k[1]===w[1][1]||k[0]===x[1][0]&&k[1]===x[1][1]))return!0}return!1},toJson:function(){var a={rings:m.clone3DArray(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});c.prototype=w.prototype;x.prototype=new c;Object.defineProperty(x.prototype,
"rings",{get:function(){this._unquantizeFn&&(this._ringsVal=this._unquantizeFn({rings:m.clone3DArray(this._ringsVal)}).rings,this._unquantizeFn=null);return this._ringsVal},set:function(a){this._ringsVal=a}});x.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._ringsVal=b.rings};w.simpleConstructor=c;w.accessorConstructor=x;w.defaultProps={type:"polygon",rings:null};w.createEllipse=function(a){var b=a.center.x,c=a.center.y,e=a.longAxis,f=a.shortAxis,q=a.numberOfPoints,x=a.map,
k,m,g;a=[];var u=2*Math.PI/q;for(m=0;m<q;m++)k=Math.cos(m*u),g=Math.sin(m*u),k=x.toMap({x:e*k+b,y:f*g+c}),a.push(k);a.push(a[0]);b=new w(x.spatialReference);b.addRing(a);return b};w.createCircle=function(a){return w.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};w.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new w({rings:g.map(b,function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,
a.ymin]]}),spatialReference:a?a.toJson():null})};return w})},"esri/geometry/Polyline":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ../srUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){function a(){}function c(){}p=p(k,{declaredClass:"esri.geometry.Polyline",type:"polyline",paths:null,constructor:function(a){this.paths=[];this._path=0;a&&(t.isArray(a)?this.paths=t.isArray(a[0][0])?a:[a]:a.paths?m.mixin(this,
a):this.spatialReference=a,this.spatialReference&&(this.spatialReference=b.createSpatialReference(this.spatialReference)));this.verifySR()},addPath:function(a){this.clearCache();this._path=this.paths.length;this.paths[this._path]=[];t.isArray(a[0])?g.forEach(a,this._addPointArr,this):g.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.paths[this._path].push(a)},_addPoint:function(a){this.paths[this._path].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._path=
b;this.paths[this._path]||(this.paths[this._path]=[]);g.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.paths.length)||null!==b&&void 0!==a&&(0>b||b>=this.paths[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new f(this.paths[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.paths[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&
null!=b&&0<=b&&b<=this.paths[a].length)return this.clearCache(),this.paths[a].splice(b,0,[c.x,c.y]),this},removePath:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.paths.splice(a,1)[0];var b,c=a.length,e=this.spatialReference;for(b=0;b<c;b++)a[b]=new f(a[b],e);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new f(this.paths[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a;a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");
if(a)return a=new e(a),a._partwise=b,a;a=this.paths;var c=a.length;if(c&&a[0].length){var f,k,m,g,u,n,D,p,v=g=a[0][0][0],t=u=a[0][0][1],L=Math.min,M=Math.max,Q=this.spatialReference,b=[],S,T,O,W;for(n=0;n<c;n++){f=a[n];S=T=f[0]&&f[0][0];O=W=f[0]&&f[0][1];p=f.length;for(D=0;D<p;D++)k=f[D],m=k[0],k=k[1],v=L(v,m),t=L(t,k),g=M(g,m),u=M(u,k),S=L(S,m),O=L(O,k),T=M(T,m),W=M(W,k);b.push(new e({xmin:S,ymin:O,xmax:T,ymax:W,spatialReference:Q?Q.toJson():null}))}a={xmin:v,ymin:t,xmax:g,ymax:u,spatialReference:Q?
Q.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new e(a);a._partwise=b;return a}},toJson:function(){var a={paths:m.clone3DArray(this.paths)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});a.prototype=p.prototype;c.prototype=new a;Object.defineProperty(c.prototype,"paths",{get:function(){this._unquantizeFn&&(this._pathsVal=this._unquantizeFn({paths:m.clone3DArray(this._pathsVal)}).paths,this._unquantizeFn=null);return this._pathsVal},
set:function(a){this._pathsVal=a}});c.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._pathsVal=b.paths};p.simpleConstructor=a;p.accessorConstructor=c;p.defaultProps={type:"polyline",paths:null};return p})},"esri/geometry/ScreenPoint":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Point"],function(p,g,t,v,n){return p(n,{declaredClass:"esri.geometry.ScreenPoint",verifySR:function(){}})})},"esri/geometry/Rect":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Geometry ./Point ./Extent ../srUtils".split(" "),
function(p,g,t,v,n,m,u,k,f){var e=p(m,{declaredClass:"esri.geometry.Rect",type:"rect",x:0,y:0,width:100,height:100,constructor:function(b,a,c,e,w){n.isObject(b)&&"extent"===b.type&&(a=b.ymax,c=b.getWidth(),e=b.getHeight(),w=b.spatialReference,b=b.xmin);n.isObject(b)?(n.mixin(this,b),this.spatialReference&&(this.spatialReference=f.createSpatialReference(this.spatialReference))):(this.x=b,this.y=a,this.width=c,this.height=e,this.spatialReference=w);this.verifySR()},getCenter:function(){return new u(this.x+
this.width/2,this.y+this.height/2,this.spatialReference)},offset:function(b,a){return new e(this.x+b,this.y+a,this.width,this.height,this.spatialReference)},intersects:function(b){return b.x+b.width<=this.x||b.y+b.height<=this.y||b.y>=this.y+this.height||b.x>=this.x+this.width?!1:!0},getExtent:function(){return new k(parseFloat(this.x),parseFloat(this.y)-parseFloat(this.height),parseFloat(this.x)+parseFloat(this.width),parseFloat(this.y),this.spatialReference)},update:function(b,a,c,e,f){this.x=b;
this.y=a;this.width=c;this.height=e;this.spatialReference=f;this.clearCache();return this}});return e})},"esri/geometry/scaleUtils":function(){define(["dojo/_base/lang","dojo/has","../kernel","../config","../WKIDUnitConversion"],function(p,g,t,v,n){var m=6370997*Math.PI/180,u=v.defaults,k={getUnitValueForSR:function(f){return this.getUnitValue(f)||m},getUnitValue:function(f){var e,b,a;f&&("object"===typeof f?(e=f.wkid,b=f.wkt):"number"===typeof f?e=f:"string"===typeof f&&(b=f));e?a=n.values[n[e]]:
b&&-1!==b.search(/^PROJCS/i)&&(f=/UNIT\[([^\]]+)\]\]$/i.exec(b))&&f[1]&&(a=parseFloat(f[1].split(",")[1]));return a},getScale:function(f,e,b){var a,c,x;1<arguments.length&&null!=e&&!e.declaredClass?(a=f,c=e,e=null,x=k.getUnitValue(b)):(a=e||f.extent,c=f.width,x=k.getUnitValue(a&&a.spatialReference));return a&&c?a.getWidth()/c*(x||m)*39.37*u.screenDPI:0},getExtentForScale:function(f,e,b){b=b||f.extent;var a;a=k.getUnitValue(f.spatialReference);return b.expand(e*f.width/(39.37*(a||m)*u.screenDPI)/b.getWidth())}};
return k})},"esri/WKIDUnitConversion":function(){define(["dojo/has","./kernel"],function(p,g){g={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),
2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,
3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,
3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,
3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,
5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,
6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,
6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,
6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,
6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,
7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,
7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8058:0,8059:0,8082:0,8083:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,
8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,
8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,
8682:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,
28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,
102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,
103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,
103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,
103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,
103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103695:2};for(p=2E3;2045>=p;p++)g[p]=0;for(p=2056;2065>=p;p++)g[p]=0;for(p=2067;2135>=p;p++)g[p]=0;for(p=2137;2154>=p;p++)g[p]=0;for(p=2161;2170>=p;p++)g[p]=0;for(p=2172;2193>=p;p++)g[p]=0;for(p=2195;2198>=p;p++)g[p]=0;for(p=2200;2203>=p;p++)g[p]=0;for(p=2205;2217>=p;p++)g[p]=0;for(p=2222;2224>=p;p++)g[p]=1;for(p=2225;2250>=p;p++)g[p]=2;for(p=2251;2253>=p;p++)g[p]=1;for(p=2257;2264>=p;p++)g[p]=2;for(p=2274;2279>=p;p++)g[p]=2;for(p=2280;2282>=
p;p++)g[p]=1;for(p=2283;2289>=p;p++)g[p]=2;for(p=2290;2292>=p;p++)g[p]=0;for(p=2308;2313>=p;p++)g[p]=0;for(p=2315;2491>=p;p++)g[p]=0;for(p=2494;2866>=p;p++)g[p]=0;for(p=2867;2869>=p;p++)g[p]=1;for(p=2870;2888>=p;p++)g[p]=2;for(p=2891;2895>=p;p++)g[p]=2;for(p=2896;2898>=p;p++)g[p]=1;for(p=2902;2908>=p;p++)g[p]=2;for(p=2915;2920>=p;p++)g[p]=2;for(p=2921;2923>=p;p++)g[p]=1;for(p=2924;2930>=p;p++)g[p]=2;for(p=2931;2962>=p;p++)g[p]=0;for(p=2964;2968>=p;p++)g[p]=2;for(p=2969;2973>=p;p++)g[p]=0;for(p=2975;2991>=
p;p++)g[p]=0;for(p=2995;3051>=p;p++)g[p]=0;for(p=3054;3079>=p;p++)g[p]=0;for(p=3081;3088>=p;p++)g[p]=0;for(p=3092;3101>=p;p++)g[p]=0;for(p=3106;3138>=p;p++)g[p]=0;for(p=3146;3151>=p;p++)g[p]=0;for(p=3153;3166>=p;p++)g[p]=0;for(p=3168;3172>=p;p++)g[p]=0;for(p=3174;3203>=p;p++)g[p]=0;for(p=3294;3358>=p;p++)g[p]=0;for(p=3367;3403>=p;p++)g[p]=0;for(p=3408;3416>=p;p++)g[p]=0;for(p=3417;3438>=p;p++)g[p]=2;for(p=3441;3446>=p;p++)g[p]=2;for(p=3447;3450>=p;p++)g[p]=0;for(p=3451;3459>=p;p++)g[p]=2;for(p=3460;3478>=
p;p++)g[p]=0;for(p=3554;3559>=p;p++)g[p]=0;for(p=3560;3570>=p;p++)g[p]=2;for(p=3571;3581>=p;p++)g[p]=0;for(p=3594;3597>=p;p++)g[p]=0;for(p=3601;3604>=p;p++)g[p]=0;for(p=3637;3639>=p;p++)g[p]=0;for(p=3665;3667>=p;p++)g[p]=0;for(p=3693;3695>=p;p++)g[p]=0;for(p=3701;3727>=p;p++)g[p]=0;for(p=3728;3739>=p;p++)g[p]=2;for(p=3740;3751>=p;p++)g[p]=0;for(p=3753;3760>=p;p++)g[p]=2;for(p=3761;3773>=p;p++)g[p]=0;for(p=3775;3777>=p;p++)g[p]=0;for(p=3779;3781>=p;p++)g[p]=0;for(p=3783;3785>=p;p++)g[p]=0;for(p=3788;3791>=
p;p++)g[p]=0;for(p=3797;3802>=p;p++)g[p]=0;for(p=3814;3816>=p;p++)g[p]=0;for(p=3825;3829>=p;p++)g[p]=0;for(p=3832;3841>=p;p++)g[p]=0;for(p=3844;3852>=p;p++)g[p]=0;for(p=3873;3885>=p;p++)g[p]=0;for(p=3890;3893>=p;p++)g[p]=0;for(p=3907;3912>=p;p++)g[p]=0;for(p=3942;3950>=p;p++)g[p]=0;for(p=3968;3970>=p;p++)g[p]=0;for(p=3973;3976>=p;p++)g[p]=0;for(p=3986;3989>=p;p++)g[p]=0;for(p=3994;3997>=p;p++)g[p]=0;for(p=4048;4051>=p;p++)g[p]=0;for(p=4056;4063>=p;p++)g[p]=0;for(p=4093;4096>=p;p++)g[p]=0;for(p=4390;4398>=
p;p++)g[p]=0;for(p=4399;4413>=p;p++)g[p]=2;for(p=4418;4433>=p;p++)g[p]=2;for(p=4455;4457>=p;p++)g[p]=2;for(p=4484;4489>=p;p++)g[p]=0;for(p=4491;4554>=p;p++)g[p]=0;for(p=4568;4589>=p;p++)g[p]=0;for(p=4652;4656>=p;p++)g[p]=0;for(p=4766;4800>=p;p++)g[p]=0;for(p=5014;5016>=p;p++)g[p]=0;for(p=5069;5072>=p;p++)g[p]=0;for(p=5105;5130>=p;p++)g[p]=0;for(p=5173;5188>=p;p++)g[p]=0;for(p=5253;5259>=p;p++)g[p]=0;for(p=5269;5275>=p;p++)g[p]=0;for(p=5292;5311>=p;p++)g[p]=0;for(p=5329;5331>=p;p++)g[p]=0;for(p=5343;5349>=
p;p++)g[p]=0;for(p=5355;5357>=p;p++)g[p]=0;for(p=5387;5389>=p;p++)g[p]=0;for(p=5459;5463>=p;p++)g[p]=0;for(p=5479;5482>=p;p++)g[p]=0;for(p=5518;5520>=p;p++)g[p]=0;for(p=5530;5539>=p;p++)g[p]=0;for(p=5550;5552>=p;p++)g[p]=0;for(p=5562;5583>=p;p++)g[p]=0;for(p=5623;5625>=p;p++)g[p]=2;for(p=5631;5639>=p;p++)g[p]=0;for(p=5649;5653>=p;p++)g[p]=0;for(p=5663;5680>=p;p++)g[p]=0;for(p=5682;5685>=p;p++)g[p]=0;for(p=5875;5877>=p;p++)g[p]=0;for(p=5921;5940>=p;p++)g[p]=0;for(p=6050;6125>=p;p++)g[p]=0;for(p=6244;6275>=
p;p++)g[p]=0;for(p=6328;6348>=p;p++)g[p]=0;for(p=6350;6356>=p;p++)g[p]=0;for(p=6366;6372>=p;p++)g[p]=0;for(p=6381;6387>=p;p++)g[p]=0;for(p=6393;6404>=p;p++)g[p]=0;for(p=6480;6483>=p;p++)g[p]=0;for(p=6511;6514>=p;p++)g[p]=0;for(p=6579;6581>=p;p++)g[p]=0;for(p=6619;6624>=p;p++)g[p]=0;for(p=6625;6627>=p;p++)g[p]=2;for(p=6628;6632>=p;p++)g[p]=0;for(p=6634;6637>=p;p++)g[p]=0;for(p=6669;6692>=p;p++)g[p]=0;for(p=6707;6709>=p;p++)g[p]=0;for(p=6720;6723>=p;p++)g[p]=0;for(p=6732;6738>=p;p++)g[p]=0;for(p=6931;6933>=
p;p++)g[p]=0;for(p=6956;6959>=p;p++)g[p]=0;for(p=7005;7007>=p;p++)g[p]=0;for(p=7057;7070>=p;p++)g[p]=2;for(p=7074;7082>=p;p++)g[p]=0;for(p=7109;7118>=p;p++)g[p]=0;for(p=7119;7127>=p;p++)g[p]=1;for(p=7374;7376>=p;p++)g[p]=0;for(p=7528;7586>=p;p++)g[p]=0;for(p=7587;7645>=p;p++)g[p]=2;for(p=7755;7787>=p;p++)g[p]=0;for(p=7791;7795>=p;p++)g[p]=0;for(p=7799;7801>=p;p++)g[p]=0;for(p=7803;7805>=p;p++)g[p]=0;for(p=7825;7831>=p;p++)g[p]=0;for(p=7845;7859>=p;p++)g[p]=0;for(p=8013;8032>=p;p++)g[p]=0;for(p=8065;8068>=
p;p++)g[p]=1;for(p=8836;8840>=p;p++)g[p]=0;for(p=8857;8859>=p;p++)g[p]=0;for(p=20002;20032>=p;p++)g[p]=0;for(p=20062;20092>=p;p++)g[p]=0;for(p=20135;20138>=p;p++)g[p]=0;for(p=20248;20258>=p;p++)g[p]=0;for(p=20348;20358>=p;p++)g[p]=0;for(p=20436;20440>=p;p++)g[p]=0;for(p=20822;20824>=p;p++)g[p]=0;for(p=20934;20936>=p;p++)g[p]=0;for(p=21035;21037>=p;p++)g[p]=0;for(p=21095;21097>=p;p++)g[p]=0;for(p=21148;21150>=p;p++)g[p]=0;for(p=21413;21423>=p;p++)g[p]=0;for(p=21473;21483>=p;p++)g[p]=0;for(p=21780;21782>=
p;p++)g[p]=0;for(p=21891;21894>=p;p++)g[p]=0;for(p=21896;21899>=p;p++)g[p]=0;for(p=22171;22177>=p;p++)g[p]=0;for(p=22181;22187>=p;p++)g[p]=0;for(p=22191;22197>=p;p++)g[p]=0;for(p=22234;22236>=p;p++)g[p]=0;for(p=22521;22525>=p;p++)g[p]=0;for(p=22991;22994>=p;p++)g[p]=0;for(p=23028;23038>=p;p++)g[p]=0;for(p=23830;23853>=p;p++)g[p]=0;for(p=23866;23872>=p;p++)g[p]=0;for(p=23877;23884>=p;p++)g[p]=0;for(p=23886;23894>=p;p++)g[p]=0;for(p=23946;23948>=p;p++)g[p]=0;for(p=24311;24313>=p;p++)g[p]=0;for(p=24342;24347>=
p;p++)g[p]=0;for(p=24370;24374>=p;p++)g[p]=10;for(p=24375;24381>=p;p++)g[p]=0;for(p=24718;24721>=p;p++)g[p]=0;for(p=24817;24821>=p;p++)g[p]=0;for(p=24877;24882>=p;p++)g[p]=0;for(p=24891;24893>=p;p++)g[p]=0;for(p=25391;25395>=p;p++)g[p]=0;for(p=25828;25838>=p;p++)g[p]=0;for(p=26191;26195>=p;p++)g[p]=0;for(p=26391;26393>=p;p++)g[p]=0;for(p=26701;26722>=p;p++)g[p]=0;for(p=26729;26799>=p;p++)g[p]=2;for(p=26801;26803>=p;p++)g[p]=2;for(p=26811;26813>=p;p++)g[p]=2;for(p=26847;26870>=p;p++)g[p]=2;for(p=26891;26899>=
p;p++)g[p]=0;for(p=26901;26923>=p;p++)g[p]=0;for(p=26929;26946>=p;p++)g[p]=0;for(p=26948;26998>=p;p++)g[p]=0;for(p=27037;27040>=p;p++)g[p]=0;for(p=27205;27232>=p;p++)g[p]=0;for(p=27258;27260>=p;p++)g[p]=0;for(p=27391;27398>=p;p++)g[p]=0;for(p=27561;27564>=p;p++)g[p]=0;for(p=27571;27574>=p;p++)g[p]=0;for(p=27581;27584>=p;p++)g[p]=0;for(p=27591;27594>=p;p++)g[p]=0;for(p=28191;28193>=p;p++)g[p]=0;for(p=28348;28358>=p;p++)g[p]=0;for(p=28402;28432>=p;p++)g[p]=0;for(p=28462;28492>=p;p++)g[p]=0;for(p=29118;29122>=
p;p++)g[p]=0;for(p=29168;29172>=p;p++)g[p]=0;for(p=29177;29185>=p;p++)g[p]=0;for(p=29187;29195>=p;p++)g[p]=0;for(p=29900;29903>=p;p++)g[p]=0;for(p=30161;30179>=p;p++)g[p]=0;for(p=30491;30494>=p;p++)g[p]=0;for(p=30729;30732>=p;p++)g[p]=0;for(p=31251;31259>=p;p++)g[p]=0;for(p=31265;31268>=p;p++)g[p]=0;for(p=31275;31279>=p;p++)g[p]=0;for(p=31281;31297>=p;p++)g[p]=0;for(p=31461;31469>=p;p++)g[p]=0;for(p=31491;31495>=p;p++)g[p]=0;for(p=31917;31922>=p;p++)g[p]=0;for(p=31965;32E3>=p;p++)g[p]=0;for(p=32001;32003>=
p;p++)g[p]=2;for(p=32005;32031>=p;p++)g[p]=2;for(p=32033;32060>=p;p++)g[p]=2;for(p=32064;32067>=p;p++)g[p]=2;for(p=32074;32077>=p;p++)g[p]=2;for(p=32081;32086>=p;p++)g[p]=0;for(p=32107;32130>=p;p++)g[p]=0;for(p=32133;32158>=p;p++)g[p]=0;for(p=32164;32167>=p;p++)g[p]=2;for(p=32180;32199>=p;p++)g[p]=0;for(p=32201;32260>=p;p++)g[p]=0;for(p=32301;32360>=p;p++)g[p]=0;for(p=32601;32662>=p;p++)g[p]=0;for(p=32664;32667>=p;p++)g[p]=2;for(p=32701;32761>=p;p++)g[p]=0;for(p=53001;53004>=p;p++)g[p]=0;for(p=53008;53019>=
p;p++)g[p]=0;for(p=53021;53032>=p;p++)g[p]=0;for(p=53034;53037>=p;p++)g[p]=0;for(p=53042;53046>=p;p++)g[p]=0;for(p=53074;53080>=p;p++)g[p]=0;for(p=54001;54004>=p;p++)g[p]=0;for(p=54008;54019>=p;p++)g[p]=0;for(p=54021;54032>=p;p++)g[p]=0;for(p=54034;54037>=p;p++)g[p]=0;for(p=54042;54046>=p;p++)g[p]=0;for(p=54048;54053>=p;p++)g[p]=0;for(p=54074;54080>=p;p++)g[p]=0;for(p=102001;102040>=p;p++)g[p]=0;for(p=102042;102063>=p;p++)g[p]=0;for(p=102065;102067>=p;p++)g[p]=0;for(p=102070;102117>=p;p++)g[p]=0;
for(p=102122;102216>=p;p++)g[p]=0;for(p=102221;102377>=p;p++)g[p]=0;for(p=102382;102388>=p;p++)g[p]=0;for(p=102389;102398>=p;p++)g[p]=2;for(p=102399;102444>=p;p++)g[p]=0;for(p=102445;102447>=p;p++)g[p]=2;for(p=102448;102458>=p;p++)g[p]=0;for(p=102459;102468>=p;p++)g[p]=2;for(p=102469;102499>=p;p++)g[p]=0;for(p=102500;102519>=p;p++)g[p]=1;for(p=102520;102524>=p;p++)g[p]=0;for(p=102525;102529>=p;p++)g[p]=2;for(p=102530;102588>=p;p++)g[p]=0;for(p=102590;102598>=p;p++)g[p]=0;for(p=102601;102603>=p;p++)g[p]=
0;for(p=102605;102628>=p;p++)g[p]=0;for(p=102629;102646>=p;p++)g[p]=2;for(p=102648;102700>=p;p++)g[p]=2;for(p=102701;102703>=p;p++)g[p]=0;for(p=102707;102730>=p;p++)g[p]=2;for(p=102733;102758>=p;p++)g[p]=2;for(p=102767;102900>=p;p++)g[p]=0;for(p=102965;102969>=p;p++)g[p]=0;for(p=102971;102973>=p;p++)g[p]=0;for(p=102975;102989>=p;p++)g[p]=0;for(p=102990;102992>=p;p++)g[p]=1;for(p=102997;103002>=p;p++)g[p]=0;for(p=103003;103008>=p;p++)g[p]=2;for(p=103009;103011>=p;p++)g[p]=0;for(p=103012;103014>=p;p++)g[p]=
2;for(p=103019;103021>=p;p++)g[p]=0;for(p=103022;103024>=p;p++)g[p]=2;for(p=103029;103031>=p;p++)g[p]=0;for(p=103032;103034>=p;p++)g[p]=2;for(p=103065;103068>=p;p++)g[p]=0;for(p=103074;103076>=p;p++)g[p]=0;for(p=103077;103079>=p;p++)g[p]=1;for(p=103080;103082>=p;p++)g[p]=0;for(p=103083;103085>=p;p++)g[p]=2;for(p=103090;103093>=p;p++)g[p]=0;for(p=103097;103099>=p;p++)g[p]=0;for(p=103100;103102>=p;p++)g[p]=2;for(p=103107;103109>=p;p++)g[p]=0;for(p=103110;103112>=p;p++)g[p]=2;for(p=103113;103116>=p;p++)g[p]=
0;for(p=103117;103120>=p;p++)g[p]=2;for(p=103153;103157>=p;p++)g[p]=0;for(p=103158;103162>=p;p++)g[p]=2;for(p=103163;103165>=p;p++)g[p]=0;for(p=103166;103168>=p;p++)g[p]=1;for(p=103169;103171>=p;p++)g[p]=2;for(p=103186;103188>=p;p++)g[p]=0;for(p=103189;103191>=p;p++)g[p]=2;for(p=103192;103195>=p;p++)g[p]=0;for(p=103196;103199>=p;p++)g[p]=2;for(p=103200;103224>=p;p++)g[p]=0;for(p=103225;103227>=p;p++)g[p]=1;for(p=103232;103237>=p;p++)g[p]=0;for(p=103238;103243>=p;p++)g[p]=2;for(p=103244;103246>=p;p++)g[p]=
0;for(p=103247;103249>=p;p++)g[p]=2;for(p=103254;103256>=p;p++)g[p]=0;for(p=103257;103259>=p;p++)g[p]=2;for(p=103264;103266>=p;p++)g[p]=0;for(p=103267;103269>=p;p++)g[p]=2;for(p=103300;103375>=p;p++)g[p]=0;for(p=103381;103383>=p;p++)g[p]=0;for(p=103384;103386>=p;p++)g[p]=1;for(p=103387;103389>=p;p++)g[p]=0;for(p=103390;103392>=p;p++)g[p]=2;for(p=103397;103399>=p;p++)g[p]=0;for(p=103400;103471>=p;p++)g[p]=2;for(p=103476;103478>=p;p++)g[p]=0;for(p=103479;103481>=p;p++)g[p]=2;for(p=103486;103488>=p;p++)g[p]=
0;for(p=103489;103491>=p;p++)g[p]=2;for(p=103492;103495>=p;p++)g[p]=0;for(p=103496;103499>=p;p++)g[p]=2;for(p=103528;103543>=p;p++)g[p]=0;for(p=103544;103548>=p;p++)g[p]=2;for(p=103549;103551>=p;p++)g[p]=0;for(p=103552;103554>=p;p++)g[p]=1;for(p=103555;103557>=p;p++)g[p]=2;for(p=103558;103560>=p;p++)g[p]=0;for(p=103571;103573>=p;p++)g[p]=0;for(p=103574;103576>=p;p++)g[p]=2;for(p=103577;103580>=p;p++)g[p]=0;for(p=103581;103583>=p;p++)g[p]=2;for(p=103600;103694>=p;p++)g[p]=0;for(p=103700;103793>=p;p++)g[p]=
2;for(p=103794;103871>=p;p++)g[p]=0;for(p=103900;103971>=p;p++)g[p]=2;return g})},"esri/geometry/screenUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/sniff ../kernel ./Point ./ScreenPoint ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(p,g,t,v,n,m,u,k,f,e){var b=function(){return 9>t("ie")?function(a,b,e,f,q,k,m,g,u){var c=[],w=Math.round,x,B=m.length,n,z,C,p,E,v;for(x=0;x<B;x++)if(n=m[x],p=g?g(n[0][0],n[0][1],u):n[0],1<(C=n.length))for(E=w((p[0]-a)*e+q),v=w((b-p[1])*
f+k),p=g?g(n[1][0],n[1][1],u):n[1],z=w((p[0]-a)*e+q),p=w((b-p[1])*f+k),c.push("M",E+","+v,"L",z+","+p),z=2;z<C;z++)p=g?g(n[z][0],n[z][1],u):n[z],E=w((p[0]-a)*e+q),v=w((b-p[1])*f+k),c.push(E+","+v);else E=w((p[0]-a)*e+q),v=w((b-p[1])*f+k),c.push("M",E+","+v);return c}:function(a,b,e,f,q,k,m,g,u,n){var c=[],w,x,B,z,C,p,E=Math.round;w=0;for(B=m?m.length:0;w<B;w++){C=m[w];c.push("M");x=0;for(z=C?C.length:0;x<z;x++)p=g?g(C[x][0],C[x][1],u):C[x],c.push(E((p[0]-a)*e+q)+","+E((b-p[1])*f+k));n||c.push("Z")}return c}}();
return{toScreenPoint:function(a,b,e,f,q){var c=a.spatialReference,w=f.spatialReference,k=f.x;f=f.y;c&&w&&!c.equals(w)&&c._canProject(w)&&(c=c.isWebMercator()?n.lngLatToXY(k,f):n.xyToLngLat(k,f,!0),k=c[0],f=c[1]);k=(k-a.xmin)*(b/a.getWidth());f=(a.ymax-f)*(e/a.getHeight());q||(k=Math.round(k),f=Math.round(f));return new m(k,f)},toScreenGeometry:function(a,b,x,w){var c=a.xmin,m=a.ymax,g=b/a.getWidth(),E=x/a.getHeight(),B=p.forEach,G=Math.round;if(w instanceof n)return new n(G((w.x-c)*g),G((m-w.y)*E));
if(w instanceof f){a=new f;var F=a.points;B(w.points,function(a,b){F[b]=[G((a[0]-c)*g),G((m-a[1])*E)]});return a}if(w instanceof e)return new e(G((w.xmin-c)*g),G((m-w.ymin)*E),G((w.xmax-c)*g),G((m-w.ymax)*g));if(w instanceof u){a=new u;var D=a.paths,I;B(w.paths,function(a,b){I=D[b]=[];B(a,function(a,b){I[b]=[G((a[0]-c)*g),G((m-a[1])*E)]})});return a}if(w instanceof k){a=new k;var v=a.rings,t;B(w.rings,function(a,b){t=v[b]=[];B(a,function(a,b){t[b]=[G((a[0]-c)*g),G((m-a[1])*E)]})});return a}},_toScreenPath:function(a,
c,e,f,q,k){var w=f instanceof u,x=a.spatialReference,m=f.spatialReference,g,C;x&&m&&!x.equals(m)&&x._canProject(m)&&(x.isWebMercator()?g=n.lngLatToXY:(g=n.xyToLngLat,C=!0));return b(a.xmin,a.ymax,c/a.getWidth(),e/a.getHeight(),q,k,w?f.paths:f.rings,g,C,w)},toMapPoint:function(a,b,e,f){return new n(a.xmin+f.x/(b/a.getWidth()),a.ymax-f.y/(e/a.getHeight()),a.spatialReference)},toMapGeometry:function(a,b,x,w){var c=a.xmin,m=a.ymax,g=a.spatialReference,E=b/a.getWidth(),B=x/a.getHeight(),G=p.forEach;if(w instanceof
n)return new n(c+w.x/E,m-w.y/B,g);if(w instanceof f){a=new f(g);var F=a.points;G(w.points,function(a,b){F[b]=[c+a[0]/E,m-a[1]/B]});return a}if(w instanceof e)return new e(c+w.xmin/E,m-w.ymin/B,c+w.xmax/E,m-w.ymax/B,g);if(w instanceof u){a=new u(g);var D=a.paths,I;G(w.paths,function(a,b){I=D[b]=[];G(a,function(a,b){I[b]=[c+a[0]/E,m-a[1]/B]})});return a}if(w instanceof k){a=new k(g);var v=a.rings,t;G(w.rings,function(a,b){t=v[b]=[];G(a,function(a,b){t[b]=[c+a[0]/E,m-a[1]/B]})});return a}}}})},"esri/layers/GraphicsLayer":function(){define("require dojo/_base/declare dojo/_base/Deferred dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/window dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/dom dojox/gfx dojox/gfx/matrix ./gfxSniff!esri-svg?dojox/gfx/filters ./layer ./support/webglUtils ./support/WebGLSurface ../kernel ../lang ../sniff ../Color ../domUtils ../symbols/MarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/utils ../geometry/Point ../geometry/ScreenPoint ../geometry/Extent ../geometry/mathUtils ../geometry/screenUtils ../PluginTarget ./gfxSniff!esri-svg?dojox/gfx/svgext".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T){var O=-1!==a.renderer.toLowerCase().indexOf("svg"),W=-1!==a.renderer.toLowerCase().indexOf("canvas"),U=W?"canvas-2d":a.renderer,V=9>B("ie");u=10===B("ie");var A=void 0===B("ie")&&7==B("trident"),X=u||A,aa=B("esri-touch"),l=!!B("chrome"),d=q.isWebGLEnabled(),h=O&&B("esri-will-change"),r=d||W;q=g(null,{declaredClass:"esri.layers._GraphicsContainer",_setMap:function(l,b){var y,c=this._connects=[];this._map=l;this._useWillChange=
this._useGlobalTransform="css-transforms"===l.navigationMode&&h;r?(y=f.create("div",{style:{position:"absolute",overflow:"visible"}},b),this._surface={getEventSource:function(){return y}},W&&(c.push(v.connect(y,"onmousedown",this,this._canvasDownHandler)),c.push(v.connect(y,"onmouseup",this,this._canvasUpHandler)),c.push(v.connect(y,"onclick",this,this._canvasClickHandler))),d&&(this._webglSurface=new C({map:l,node:y}))):(y=(this._surface=a.createSurface(b,l.width,l.height)).getEventSource(),this._useWillChange&&
e.set(y,"will-change","transform"),e.set(y=V?y.parentNode:y,{overflow:"visible",position:"absolute"}));c.push(v.connect(l,"onResize",this,"_onResizeHandler"));this._useGlobalTransform&&(c.push(v.connect(l,"onPan",this,"_onPanHandler")),c.push(v.connect(l,"onPanEnd",this,"_onPanEndHandler")),c.push(v.connect(l,"onExtentChange",this,"_onExtentChangeHandler")));return y},_reorderLayer:function(d,h,l){h=h.getEventSource();r&&"svg"===d.surfaceType&&(h=h.parentNode);f.place(h,this._surface.getEventSource(),
l)},_onPanHandler:function(d,h){var l=this._map.__visibleRect;d=l.x+h.x;h=l.y+h.y;this._panDx=d;this._panDy=h;r||e.set(this._surface.getEventSource(),z._css.names.transform,z._css.translate(d,h))},_onPanEndHandler:function(d,h){h=this._map.__visibleRect;d=h.x;h=h.y;this._panDx=d;this._panDy=h;r||e.set(this._surface.getEventSource(),z._css.names.transform,z._css.translate(d,h))},_onExtentChangeHandler:function(d,h,l,a){l&&(this._panDy=this._panDx=0,r||e.set(this._surface.getEventSource(),z._css.names.transform,
z._css.translate(0,0)))},_getTransform:function(){return{dx:this._panDx||0,dy:this._panDy||0}},_onResizeHandler:function(d,h,l){d=this._surface.getEventSource();var r=this._map,a;V&&e.set(d=d.parentNode,{width:h+"px",height:l+"px",clip:"rect(0px "+h+"px "+l+"px 0px)"});k.set(d,"width",h);k.set(d,"height",l);this._surface.declaredClass||m.forEach(d.childNodes,function(d){k.set(d,"width",h);k.set(d,"height",l)});r.loaded&&(r.graphics.suspended||(r.graphics._resized=!0),m.forEach(r.graphicsLayerIds,
function(d){a=r.getLayer(d);a.suspended||(a._resized=!0,a._childLayer&&(a._childLayer._resized=!0));a._updateSVGFilters(null,null,h,l)}),r.graphics._updateSVGFilters(null,null,h,l),r._labels&&r._labels._updateSVGFilters(null,null,h,l))},_cleanUp:function(){m.forEach(this._connects,v.disconnect,v);this._map=this._surface=null},_processEvent:function(d){var h=this._map;d.screenPoint=new L(d.pageX-h.position.x,d.pageY-h.position.y);d.mapPoint=h.toMap(d.screenPoint)},_canvasDownHandler:function(d){this._processEvent(d);
this._downPt=d.screenPoint.x+","+d.screenPoint.y},_canvasUpHandler:function(d){this._processEvent(d);this._upPt=d.screenPoint.x+","+d.screenPoint.y},_tolerance:15,_isPrimaryMatch:function(d,h,l,r){if(!d.visible||!h)return!1;var a=h.getTransformedBoundingBox(),y;return a?(y=new M(a[0].x,a[0].y,a[2].x,a[2].y),delete y.spatialReference,aa?y.intersects(l):y.contains(r)):m.some(h.children||[],function(d){a=d.getTransformedBoundingBox();y=new M(a[0].x,a[0].y,a[2].x,a[2].y);delete y.spatialReference;return aa?
y.intersects(l):y.contains(r)})},_canvasClickHandler:function(d){if(this._downPt&&this._upPt&&this._downPt===this._upPt){this._processEvent(d);var h=this._map,l=m.map(h.graphicsLayerIds,function(d){return h.getLayer(d)});l.push(h.graphics);l.reverse();var l=m.filter(l,function(d){return d.loaded&&!d.hasWebGLSurface()&&d._mouseEvents&&!d.suspended&&(!E.isDefined(d.opacity)||0<d.opacity)}),r=d.screenPoint,a=this._tolerance,y=r.x-a,b=r.y+a,c=r.x+a,a=r.y-a,A=new M(y,a,c,b),y=h.toMap(new L(y,b)),c=h.toMap(new L(c,
a)),b=y.spatialReference._getInfo(),e=new M(M.prototype._normalizeX(y.x,b).x,y.y,M.prototype._normalizeX(c.x,b).x,c.y,y.spatialReference),f;delete A.spatialReference;m.some(l,function(d){d=m.filter(d.graphics,function(d){return this._isPrimaryMatch(d,d.getDojoShape(),A,r)||!(!d._bgShape||!this._isPrimaryMatch(d,d._bgShape,A,r))},this);d.reverse();if(0<d.length){var h;m.some(d,function(d){return d.geometry&&e.intersects(d.geometry)?(h=d,!0):!1});if(h)return f=h,!0}return!1},this);f&&(l=f.getLayer())&&
(d.graphic=f,l.onClick(d))}}});w=g(w,{declaredClass:"esri.layers._GraphicsLayer",managedSuspension:!0,surfaceType:U,webglEnabled:d,renderer:null,_eventMap:{"graphic-add":["graphic"],"graphic-remove":["graphic"],"renderer-change":["renderer"]},_suspendGraphics:!1,constructor:function(d,h){d=d||{};if(n.isString(d)||n.isObject(d)&&(d.layerDefinition||d.query))d=h;this._params=n.mixin({displayOnPan:!0,drawMode:!0,styling:!0},d);h=this._params.dataAttributes;"string"===typeof h&&(h=[h]);this.styling=O?
this._params.styling:!0;this.dataAttributes=h;this.infoTemplate=d&&d.infoTemplate;this.graphics=[];this._draw=n.hitch(this,this._draw);this._refresh=n.hitch(this,this._refresh);this._acquireSVGMarker=n.hitch(this,this._acquireSVGMarker);this._evalSurfaceType=n.hitch(this,this._evalSurfaceType);this._setSurfaceType=n.hitch(this,this._setSurfaceType);this.setWebGLEnabled(null!=this._params.webglEnabled?this._params.webglEnabled:this.webglEnabled);this.registerConnectEvents()},getNode:function(){return this._div&&
this._div.getEventSource()},setDrawMode:function(d){this._params.drawMode=d},suspendGraphics:function(d){this._suspendGraphics=d;m.forEach(this.graphics,function(h){h._suspended=d})},setWebGLEnabled:function(h){var l=this.webglEnabled;this.webglEnabled=(h||!1)&&d;l!==this.webglEnabled&&(this._evalSurfaceType(),this.onWebGLEnabledChange())},hasWebGLSurface:function(){return"webgl"===this.surfaceType},_getSurfaceType:function(d){return d&&"webgl"===d.surfaceType?"webgl":U},_evalSurfaceType:function(h){d&&
(h?this._setSurfaceType():null==this._evalSurfaceTimerHandle&&(this._evalSurfaceTimerHandle=setTimeout(this._setSurfaceType,0)))},_hasPendingSurfaceEval:function(){return!!this._evalSurfaceTimerHandle},_setSurfaceType:function(){clearTimeout(this._evalSurfaceTimerHandle);this._evalSurfaceTimerHandle=null;var d=this._canUseWebGLSurface()?"webgl":U;this.surfaceType!==d?(this.surfaceType=d,this._handleSurfaceChange(),this.onSurfaceChange()):this._pendingRedraw&&this._redraw()},_handleSurfaceChange:function(){this._cancelWebGLDepsLoad();
this._webglDepsPromise=this._prepareToAttach(this._map);this._webglDepsPromise.always(n.hitch(this,function(d){this._webglDepsPromise=null;d&&"cancel"===d.dojoType||this._evalSurface()}))},_cancelWebGLDepsLoad:function(){this._webglDepsPromise&&!this._webglDepsPromise.isFulfilled()&&this._webglDepsPromise.cancel();this._webglDepsPromise=null},_evalSurface:function(){var d=this._map,h=this._div;d&&h&&this._getSurfaceType(h)!==this.surfaceType&&(d._detachGraphicsLayer(this),d._attachGraphicsLayer(this))},
_canUseWebGLSurface:function(d){d=d||this._map;return this.webglEnabled&&(!d||d.webglEnabled&&(d.ownsWebGLContext(this)||d.isWebGLContextAvailable()))&&this._params.drawMode&&this._isWebGLCompatible()},_isWebGLCompatible:function(){return!1},_prepareToAttach:function(d){var h=new t;!this.webglDeps&&this._canUseWebGLSurface(d)?p(["./support/webglDeps"],n.hitch(this,function(d){this.webglDeps=d;h.isFulfilled()||h.resolve()})):h.resolve();return h.promise},_setMap:function(d,h){this.inherited(arguments);
this._map=d;this._evalSurfaceType(!0);this._webglChangeMapHandle=d.on("webgl-enabled-change",n.hitch(this,function(){this._evalSurfaceType()}));this._wrap=d.wrapAround180;this._srInfo=d.spatialReference._getInfo();this._svgFilters={};this._lineMarkers={};if(this.hasWebGLSurface())d.acquireWebGLContext(this),this._div=d._gc._webglSurface.createRenderer(this.webglDeps.WebGLRenderer,d.width,d.height,this);else{if("svg"===this.surfaceType)if(r){h=a.createSurface(h.getEventSource(),d.width,d.height);var l=
h.getEventSource();e.set(l,{position:"absolute",overflow:"visible",pointerEvents:"none"});d._gc._useWillChange&&e.set(l,"will-change","transform");this._div=h.createGroup();e.set(this._div.getEventSource(),"pointer-events","auto")}else this._div=h.createGroup();else h=a.createSurface(h.getEventSource(),d.width,d.height),e.set(h.rawNode,"position","absolute"),this._div=h.createGroup(),this._renderProto=this._div.constructor.prototype._render,this._div._render=n.hitch(this,this._canvasRender);this._bgGroup=
this._div.createGroup()}this._div.getEventSource().id=this.id+"_layer";this._initOpacity();return this._div},_unsetMap:function(d,h){d.releaseWebGLContext(this);"webgl"===this._div.surfaceType?d._gc._webglSurface.destroyRenderer(this._div):(m.forEach(this.graphics,function(d){d._shape=null}),"svg"===this.surfaceType?r?(h=this._div.parent,this._div.clear(),h.remove(this._div),f.destroy(this._div.getEventSource()),f.destroy(h.getEventSource())):(this._div.clear(),h.remove(this._div),f.destroy(this._div.getEventSource())):
(h=this._div.getParent(),h._parent={},f.destroy(h.rawNode),h.destroy()));this._map=this._div=this._svgFilters=this._lineMarkers=null;this._pendingRedraw=!1;clearTimeout(this._wakeTimer);this._wakeTimer=null;clearTimeout(this._evalSurfaceTimerHandle);this._evalSurfaceTimerHandle=null;this._webglChangeMapHandle&&this._webglChangeMapHandle.remove();this._cancelWebGLDepsLoad();this._disableDrawConnectors();this.inherited(arguments)},_initOpacity:function(){var d=this.opacity;E.isDefined(d)&&1>d&&this.setOpacity(d,
!0)},_onZoomStartHandler:function(){this.hasWebGLSurface()||F.hide(this._div.getEventSource())},_onExtentChangeHandler:function(d,h,l,r){clearTimeout(this._wakeTimer);this._wakeTimer=null;l?(d=this._map.__visibleRect,h=this._div,this._evalSDRenderer(),this._refresh(!0),this._params._child||this._updateTransform(h,d.x,d.y,!0),this._renderProto&&h.surface.pendingRender?this._dirty=!0:this.suspended||F.show(h.getEventSource())):this._resized&&(this._resized=!1,this._refresh(!1));if(0<this.graphics.length)this.onUpdate()},
_canvasRender:function(){var d=this._div;this._dirty&&(delete this._dirty,this.suspended||F.show(d.getEventSource()));return this._renderProto.apply(d,arguments)},_refresh:function(d){if(!this.hasWebGLSurface()){var h=this.graphics,l=h.length,r,a=this._draw;for(r=0;r<l;r++)a(h[r],d)}},refresh:function(){this._refresh(!0)},_redraw:function(){this._pendingRedraw=!1;this.hasWebGLSurface()?this._div&&this._div.redraw():this._refresh(!0)},redraw:function(){this._hasPendingSurfaceEval()?this._pendingRedraw=
!0:this._redraw()},hasLocalNavigationTransform:function(){return!(this._map&&this._map._gc._useGlobalTransform)},getNavigationTransform:function(){var d={dx:0,dy:0};this._map&&(this.hasLocalNavigationTransform()?this._div&&!this.hasWebGLSurface()&&(d=this._div.getTransform()):d=this._map._gc._getTransform());return d},_onPanHandler:function(d,h){this._panDx=h.x;this._panDy=h.y;d=this._map.__visibleRect;this._updateTransform(this._div,d.x+h.x,d.y+h.y);A&&this._updateSVGMarkers()},_onPanEndUpdateHandler:function(d,
h){d=this._map.__visibleRect;this._params._child||h.x===this._panDx&&h.y===this._panDy?(this._updateSVGFilters(-d.x,-d.y),this._updateSVGMarkers()):this._updateTransform(this._div,d.x,d.y,!0);this._refresh(!1);if(this.graphics.length)this.onUpdate()},_onPanStartHandler:function(){F.hide(this._div.getEventSource())},_onPanEndHandler:function(){var d=this._map.__visibleRect,h=this._div;this._updateTransform(h,d.x,d.y,!0);this._refresh(!1);this._renderProto&&h.surface.pendingRender?this._dirty=!0:F.show(h.getEventSource());
if(this.graphics.length)this.onUpdate()},_updateTransform:function(d,h,l,a){this.hasWebGLSurface()||(this.hasLocalNavigationTransform()?d.setTransform(c.translate({x:h,y:l})):r&&e.set(this._div.parent.getEventSource(),z._css.names.transform,z._css.translate(h,l)),a&&(this._updateSVGFilters(-h,-l),this._updateSVGMarkers()))},onSuspend:function(){this.inherited(arguments);F.hide(this._div.getEventSource());clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(d){this.inherited(arguments);
d.firstOccurrence&&this._evalSDRenderer();this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(n.hitch(this,function(){this.suspended||this._map.__zooming||this._onExtentChangeHandler(null,null,!0)}),0)},_enableDrawConnectors:function(){var d=this._map,h=v.connect;this._disableDrawConnectors();this._params.displayOnPan?(this._params._child||(this._onPanHandler_connect=h(d,"onPan",this,"_onPanHandler")),this._onPanEndHandler_connect=h(d,"onPanEnd",this,"_onPanEndUpdateHandler")):
(this._onPanStartHandler_connect=h(d,"onPanStart",this,"_onPanStartHandler"),this._onPanEndHandler_connect=h(d,"onPanEnd",this,"_onPanEndHandler"));this._onZoomStartHandler_connect=h(d,"onZoomStart",this,"_onZoomStartHandler");this._onExtentChangeHandler_connect=h(d,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var d=v.disconnect;d(this._onExtentChangeHandler_connect);d(this._onZoomStartHandler_connect);d(this._onPanHandler_connect);d(this._onPanStartHandler_connect);
d(this._onPanEndHandler_connect);this._onExtentChangeHandler_connect=this._onZoomStartHandler_connect=this._onPanHandler_connect=this._onPanStartHandler_connect=this._onPanEndHandler_connect=null},_updateExtent:function(d){var h=d.geometry;if(!h)d._extent=null;else if(!(d._extent=h.getExtent())){var l,r;if("esri.geometry.Point"===h.declaredClass)l=h.x,r=h.y;else if("esri.geometry.Multipoint"===h.declaredClass)l=h.points[0][0],r=h.points[0][1];else{d._extent=null;return}d._extent=new M(l,r,l,r,h.spatialReference)}},
_intersects:function(d,h,l){var r=d.spatialReference,a=h.spatialReference,y=r&&a&&!r.equals(a)&&r._canProject(a)&&4326===a.wkid;if(this._wrap&&!l){l=[];var r=d._getFrameWidth(),b=this._srInfo,c=d._clip?d._getAvailExtent():d.extent,H,A,e,f,q=[];H=h._partwise;y&&(c=d.geographicExtent,b=a._getInfo());d=c._getParts(b);if(H&&H.length)for(h=[],a=0,y=H.length;a<y;a++)h=h.concat(H[a]._getParts(b));else h=h._getParts(b);a=0;for(y=h.length;a<y;a++)for(e=h[a],b=0,c=d.length;b<c;b++)if(f=d[b],f.extent.intersects(e.extent))for(H=
0,A=e.frameIds.length;H<A;H++)l.push((f.frameIds[0]-e.frameIds[H])*r);a=0;for(y=l.length;a<y;a++)H=l[a],m.indexOf(l,H)===a&&q.push(H);return q.length?q:null}return(y?d.geographicExtent:d.extent).intersects(h)?[0]:null},_defaultMarker:{type:"simplemarkersymbol",style:"square",size:1,xoffset:0,yoffset:0,angle:0},_draw:function(d,h){if(!this.hasWebGLSurface()&&this._params.drawMode&&this._map&&!this.suspended&&!this._map.__zooming&&!this._resized)try{var l=d._extent,r,a,y=!O||this.styling,b=O&&this.dataAttributes,
c=d.getDojoShape(),H;if(!d._suspended&&d.visible&&l&&(r=this._intersects(this._map,l,d.geometry._originOnly))&&(a=y?this._getSymbol(d):this._defaultMarker)){if(d._offsets&&d._offsets.join(",")===r.join(",")?H=!0:d._offsets=r,!c||h||!H){var A=d.geometry.type;h={graphic:d};var e=d._bgShape,f=y&&!d.symbol?this._getRenderer(d):null,q=f&&f.backgroundFillSymbol;if("point"===A)this._isInvalidShape(a,c)&&this._removeShape(d),d._shape=this._drawPoint(this._div,d.geometry,a,d.getDojoShape(),r,f,d),y&&this._symbolizePoint(d.getDojoShape(),
a,f,d);else if("multipoint"===A)this._drawMarkers(d,a,r,f),y&&this._symbolizeMarkers(d,a,f);else{var w,A=a,k,x,m;y&&(A=(w="simplemarkersymbol"===a.type||"picturemarkersymbol"===a.type||"textsymbol"===a.type?a:null)?q:a);y&&A&&-1<A.type.indexOf("fillsymbol")&&(k=this._bgGroup,m=!(!k||!w));e&&!m&&this._removeBgShape(d);if(A){!m&&(this._isInvalidShape(A,d._shape)||d._shape&&d._shape._isCentroidMarker)&&this._removeShape(d,!1);if(x=this._drawShape(d,r,k||this._div,m?e:d.getDojoShape()))x._isCentroidMarker=
!1;y&&this._symbolizeShape(x,A,f,A===q,d);d[m?"_bgShape":"_shape"]=x}if(w){(this._isInvalidShape(w,d._shape)||d._shape&&!d._shape._isCentroidMarker)&&this._removeShape(d,!1);var g=d.geometry.getCentroid();if(x=g&&this._drawPoint(this._div,g,w,d._shape,r,f,d))x._isCentroidMarker=!0,this._symbolizePoint(x,w,f,d);d._shape=x}}W||(d._bgShape&&this._initNode(d,d._bgShape,d._bgShape!==e,h,b),d._shape&&this._initNode(d,d._shape,d._shape!==c,h,b));d._applyDataAttrs();h.node=d.getNode();this.onGraphicDraw(h)}}else c&&
this._removeShape(d)}catch(Ia){this._errorHandler(Ia,d)}},_initNode:function(d,h,l,r,a){if(h=h&&h.getNode())h.e_graphic=d,this._addDataAttrs(d,a,h),l&&(r.node=h,this.onGraphicNodeAdd(r))},_removeShape:function(d,h,l){var r=d.getDojoShape(),a=r&&r.getNode();r&&!l&&(r.removeShape(),r.destroy());d._shape=d._offsets=null;!1!==h&&this._removeBgShape(d,l);if(a&&(a.e_graphic=null,!W))this.onGraphicNodeRemove({graphic:d,node:a})},_removeBgShape:function(d,h){var l=d._bgShape,r=l&&l.getNode();l&&!h&&(l.removeShape(),
l.destroy());d._bgShape=null;if(r&&(r.e_graphic=null,!W))this.onGraphicNodeRemove({graphic:d,node:r})},_addDataAttrs:function(d,h,l){var r=d.attributes,a,y=h?h.length:0,b=this._getRenderer(d);if(l&&r){for(a=0;a<y;a++)(l=h[a])&&d.attr("data-"+l,r[l]);!this.styling&&b&&(b.getBreakIndex?(h=b.getBreakIndex(d),d.attr("data-class-break",-1!==h?h:null)):b.getUniqueValueInfo&&(h=b.getUniqueValueInfo(d),d.attr("data-unique-value",h?h.value:null)))}},_drawShape:function(d,h,l,r){d=d.geometry;var a=d.type,y=
this._map,b=y.extent,c=y.width,H=y.height,y=y.__visibleRect,A=[],e,f;e="extent"===a;if("rect"===a||e)A={x:0,y:0,spatialReference:d.spatialReference},A.x=e?d.xmin:d.x,A.y=e?d.ymax:d.y,a=S.toScreenPoint(b,c,H,A),A.x=e?d.xmax:d.x+d.width,A.y=e?d.ymin:d.y+d.height,d=S.toScreenPoint(b,c,H,A),h={x:a.x-y.x+h[0],y:a.y-y.y,width:Math.abs(d.x-a.x),height:Math.abs(d.y-a.y)},0===h.width&&(h.width=1),0===h.height&&(h.height=1),r=this._drawRect(l,r,h);else if("polyline"===a||"polygon"===a){e=0;for(f=h.length;e<
f;e++)A=A.concat(S._toScreenPath(b,c,H,d,-y.x+h[e],-y.y));r=this._drawPath(l,r,A);this._rendererLimits&&("polyline"===a?this._clipPolyline(r,d):this._clipPolygon(r,d))}return r},_drawRect:function(d,h,l){return h?h.setShape(l):d.createRect(l)},_drawImage:function(d,h,l){return h?h.setShape(l):d.createImage(l)},_drawCircle:function(d,h,l){return h?h.setShape(l):d.createCircle(l)},_drawPath:function(){return V?function(d,h,l,r){l=r?l:l.join(" ");if(h)return h.setShape(l);h=d.createObject(r?a.Path:a.EsriPath,
l);d._overrideSize(h.getEventSource());return h}:function(d,h,l,r){l=r?l:l.join(" ");return h?h.setShape(l):d.createPath(l)}}(),_drawText:function(d,h,l){return h?h.setShape(l):d.createText(l)},_evalSDRenderer:function(d){var h=this._map,l=this.renderer,r,a=this._rndForScale;h&&h.loaded&&l&&l.getRendererInfo&&(r="zoom"===l.rangeType?l.getRendererInfoByZoom(h.getZoom()):l.getRendererInfoByScale(h.getScale()));this._rndForScale=r&&r.renderer;d||this._rndForScale==a||this.emit("renderer-change",{renderer:this._rndForScale})},
_getRenderer:function(d){var h=this._rndForScale||this.renderer;d&&h&&h.getObservationRenderer&&(h=h.getObservationRenderer(d));return h},_getSymbol:function(d){var h=this._getRenderer();return d.symbol||h&&h.getSymbol(d)},_getVariable:function(d,h,l){var r;d&&(r=(d=d.getVisualVariablesForType(h,l))&&d[0]);return r},_applyOpacity:function(d,h,l,r){h=h.getOpacity(r,{opacityInfo:l});null!=h&&(d=new G(d),d.a=h);return d},_symbolizeShape:function(d,h,l,r,a){var y=h.getStroke(),b=h.getFill(),c=h.type,
H,A,e=-1!==c.indexOf("linesymbol"),f=-1!==c.indexOf("fillsymbol")?null:this._getVariable(l,"sizeInfo",!1),q=this._getVariable(l,"colorInfo",!1),w=this._getVariable(l,"opacityInfo",!1),k=e?"none"!==h.style:h.outline&&"none"!==h.outline.style,x=e?null:this._getVariable(l,"sizeInfo","outline"),f=(f=r?x:x||f)?l.getSize(a,{sizeInfo:f,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null;r&&(q=w=null);(q||w)&&"picturefillsymbol"!==c&&(e?(H=y&&y.color,q&&(H=l.getColor(a,{colorInfo:q})||
H),H&&w&&(H=this._applyOpacity(H,l,w,a))):b&&b.toCss&&(A=b,q&&(A=l.getColor(a,{colorInfo:q})||A),A&&w&&(A=this._applyOpacity(A,l,w,a))));d.setStroke(!k||null==f&&!H?y:n.mixin({},y,null!=f?{width:f}:null,H&&{color:H})).setFill(A||b);e&&K.applyLineMarker(d,h,H,this._acquireSVGMarker)},_smsToPath:function(){return V?function(d,h,l,r,a,b,c,A,e){switch(h){case d.STYLE_SQUARE:return["M",a+","+c,"L",b+","+c,b+","+A,a+","+A,"X","E"];case d.STYLE_CROSS:return["M",l+","+c,"L",l+","+A,"M",a+","+r,"L",b+","+
r,"E"];case d.STYLE_X:return["M",a+","+c,"L",b+","+A,"M",a+","+A,"L",b+","+c,"E"];case d.STYLE_DIAMOND:return["M",l+","+c,"L",b+","+r,l+","+A,a+","+r,"X","E"];case d.STYLE_TARGET:return["M",a+","+c,"L",b+","+c,b+","+A,a+","+A,a+","+c,"M",a-e+","+r,"L",a+","+r,"M",l+","+(c-e),"L",l+","+c,"M",b+e+","+r,"L",b+","+r,"M",l+","+(A+e),"L",l+","+A,"E"]}}:function(d,h,l,r,a,b,c,A,e){switch(h){case d.STYLE_SQUARE:return["M",a+","+c,b+","+c,b+","+A,a+","+A,"Z"];case d.STYLE_TRIANGLE:return["M",l+","+c,b+","+
A,a+","+A,"Z"];case d.STYLE_CROSS:return["M",l+","+c,l+","+A,"M",a+","+r,b+","+r];case d.STYLE_X:return["M",a+","+c,b+","+A,"M",a+","+A,b+","+c];case d.STYLE_DIAMOND:return["M",l+","+c,b+","+r,l+","+A,a+","+r,"Z"];case d.STYLE_TARGET:return d=["M",a+","+c,b+","+c,b+","+A,a+","+A,a+","+c],e&&d.push("M",a-e+","+r,a+","+r,"M",l+","+(c-e),l+","+c,"M",b+e+","+r,b+","+r,"M",l+","+(A+e),l+","+A),d}}}(),_pathStyles:{square:1,cross:1,x:1,diamond:1,target:1},_typeMaps:{picturemarkersymbol:"image",picturefillsymbol:"path",
simplefillsymbol:"path",simplelinesymbol:"path",cartographiclinesymbol:"path",textsymbol:"text"},_isInvalidShape:function(d,h){h=h&&h.shape&&h.shape.type;var l=d&&d.type;d=d&&d.style;"rect"===h&&(h="path");l&&(d=this._typeMaps[l]||d);this._pathStyles[d]&&(d="path");return"shieldlabelsymbol"===l?!0:!(!h||!d||h===d)},_reArialFont:/\s*(^|,)\s*arial\s*(,|$)\s*/i,_fallbackFont:"Arial",_drawPoint:function(d,h,l,r,a,b,A){var y=l.type,H=this._map,e=H.__visibleRect,f=S.toScreenPoint(H.extent,H.width,H.height,
h).offset(-e.x+a[0],-e.y),e=f.x,q=f.y,w;h=[];var k,x=this._getVariable(b,"rotationInfo",!1),x=x?b.getRotationAngle(A,{rotationInfo:x}):null,m=this._getVariable(b,"sizeInfo",!1),H=m?b.getSize(A,{sizeInfo:m,shape:l.style,resolution:H.getResolutionInMeters(),scale:H.getScale()}):A.size;x&&h.push(c.rotategAt(x,f));if(0!==l.xoffset||0!==l.yoffset)k=c.translate(l.xoffset,-l.yoffset),h.push(k);0!==l.angle&&h.push(c.rotategAt(l.angle,f));if("simplemarkersymbol"===y)switch(w=l.style,b=Math.round,null!=H?k&&
(null!=k.dx&&(k.dx=k.dx/l.size*H),null!=k.dy&&(k.dy=k.dy/l.size*H)):H=l.size,w){case I.STYLE_SQUARE:case I.STYLE_TRIANGLE:case I.STYLE_CROSS:case I.STYLE_X:case I.STYLE_DIAMOND:l=isNaN(H)?16:H/2;w=this._drawPath(d,r,this._smsToPath(I,w,e,q,b(e-l),b(e+l),b(q-l),b(q+l)));break;case I.STYLE_TARGET:A=l._targetWidth/2;k=l._targetHeight/2;w=this._drawPath(d,r,this._smsToPath(I,w,e,q,b(e-A),b(e+A),b(q-k),b(q+k),l._spikeSize));break;case I.STYLE_PATH:w=this._drawPath(d,r,l.path,!0);l=w.getBoundingBox();d=
this._getScaleMatrix(l,H);1===d.xx&&1===d.yy||h.push(c.scaleAt(d.xx,d.yy,f));h.push(c.translate(-(l.x+l.width/2)+e,-(l.y+l.height/2)+q));break;default:l=isNaN(H)?16:H/2,w=this._drawCircle(d,r,{cx:e,cy:q,r:l})}else if("shieldlabelsymbol"===y)w=l.width,f=l.height,r=d.createGroup(),w=d.createImage({x:e-w/2,y:q-f/2,width:w,height:f,src:l.url}),r.add(w),null!=l.font&&(q+=.2*l.getHeight(),d=d.createText({type:"text",text:l.text,x:e,y:q,align:"middle",decoration:l.decoration,rotated:l.rotated,kerning:l.kerning}),
d.setFont(l.font),d.setFill(l.color),r.add(d)),w=r;else if("picturemarkersymbol"===y){if(null==H?(w=l.width,f=l.height):(f=H,w=l.width/l.height*f,k&&(null!=k.dx&&(k.dx=k.dx/l.width*w),null!=k.dy&&(k.dy=k.dy/l.height*f))),w=this._drawImage(d,r,{x:e-w/2,y:q-f/2,width:w,height:f,src:l.url}),O&&(d=w.getNode()))l=(l=this._getVariable(b,"opacityInfo",!1))?b.getOpacity(A,{opacityInfo:l}):null,null!=l?d.setAttribute("opacity",l):d.setAttribute("opacity",1)}else if("textsymbol"===y){if(b=l.font){w=null!=H;
A=b.family&&!this._reArialFont.test(b.family);if(w||A)b=new b.constructor(b.toJson());w&&b.setSize(H);A&&b.setFamily(b.family+","+this._fallbackFont)}w=this._drawText(d,r,{type:"text",text:l.text,x:e,y:q,align:l.getSVGAlign(),decoration:l.decoration||b&&b.decoration,rotated:l.rotated,kerning:l.kerning});b&&w.setFont(b);O&&(d=w.getNode(),e=l.getSVGBaseline(),q=l.getSVGBaselineShift(),d&&(d.setAttribute("dominant-baseline",e),q&&d.setAttribute("baseline-shift",q),this._applyHalo(w,l.haloColor,l.haloSize)))}w.setTransform(c.multiply(h));
w._wrapOffsets=a;return w},_acquireSVGMarker:function(d,h,l,r){d=this._getSVGMarkerId(h,r);var a=this._getSVGMarker(d);a||(a=K.createSVGMarker(h,d,l,r),this._div.getParent().defNode.appendChild(a),this._lineMarkers[d]=a);return a},_getSVGMarkerId:function(d,h){return"marker_"+this._map.id+"_"+d.r+"_"+d.g+"_"+d.b+"_"+h},_getSVGMarker:function(d){return this._lineMarkers[d]},_updateSVGMarkers:function(){if(O&&X){var d=this._lineMarkers,h;for(h in d){var l=d[h];l.setAttribute("id",h+"_temp");l.setAttribute("id",
h)}}},_applyHalo:function(d,h,l){var r=h&&l?this._getHaloId(h,l):null;d.setFilter(h&&l?B("webkit")||B("ff")?this._getDilateFilter(h,l,r):this._getOffsetFilter(h,l,r):null)},_getDilateFilter:function(d,h,l){var r=this._getSVGFilter(l);r||(r=this._createSVGFilter({id:l},[x.feMorphology({operator:"dilate",radius:h,result:"dilated"}),x.feFlood({"flood-color":d.toCss(!0)}),x.feComposite({in2:"dilated",operator:"in",result:"composite"}),x.feMerge("composite","SourceGraphic")]));return r},_getOffsetFilter:function(d,
h,l){var r=this._getSVGFilter(l);if(!r){d=d.toCss(!0);var r=this._offsetPrimitives,a,y=r.length,b=[],c=[];for(a=0;a<y;a++){var A=r[a],H="offset"+A.dir,e="composite"+A.dir;c.push(e);b.push(x.feOffset({dx:A.dx*h,dy:A.dy*h,"in":"SourceAlpha",result:H}),x.feFlood({"flood-color":d}),x.feComposite({in2:H,operator:"in",result:e}))}c.push("SourceGraphic");b.push(x.feMerge.apply(x.feMerge,c));r=this._createSVGFilter({id:l},b)}return r},_offsetPrimitives:[{dir:"L",dx:-1,dy:0},{dir:"TL",dx:-1,dy:-1},{dir:"T",
dx:0,dy:-1},{dir:"TR",dx:1,dy:-1},{dir:"R",dx:1,dy:0},{dir:"BR",dx:1,dy:1},{dir:"B",dx:0,dy:1},{dir:"BL",dx:-1,dy:1}],_getHaloId:function(d,h){return"halo_"+this._map.id+"_"+this.id+"_"+d.r+"_"+d.g+"_"+d.b+"_"+d.a+"_"+h},_getSVGFilter:function(d){return this._svgFilters[d]},_createSVGFilter:function(d,h){h=x.createFilter(d,h);var l=this._map,r=l.__visibleRect;h.x=-r.x;h.y=-r.y;h.width=l.width;h.height=l.height;return this._svgFilters[d.id]=h},_updateSVGFilters:function(d,h,l,r){var a=this._svgFilters,
y,c,A;for(c in a)if(y=a[c]){if(A=b.byId(c))null!=d&&A.setAttribute("x",d),null!=h&&A.setAttribute("y",h),null!=l&&A.setAttribute("width",l),null!=r&&A.setAttribute("height",r);null!=d&&(y.x=d);null!=h&&(y.y=h);null!=l&&(y.width=l);null!=r&&(y.height=r)}},_getScaleMatrix:function(d,h){var l=d.width/d.height,r=1,a=1;isNaN(h)||(1<l?(r=h/d.width,a=h/l/d.height):(a=h/d.height,r=h*l/d.width));return{xx:r,yy:a}},_symbolizePoint:function(d,h,l,r){var a=h.type,y=h.style;if("shieldlabelsymbol"!==a&&"picturemarkersymbol"!==
a){var b=h.getStroke();h=h.getFill();var y=y===I.STYLE_X||y===I.STYLE_CROSS,c=b&&b.color,A=y?c:h;if(l){var H=this._getVariable(l,"colorInfo",!1),e=this._getVariable(l,"opacityInfo",!1);H&&(A=l.getColor(r,{colorInfo:H})||A);A&&e&&(A=this._applyOpacity(A,l,e,r));A&&(y?A!==c&&(b=b?n.mixin({},b):{},b.color=A):A!==h&&(h=A))}"textsymbol"===a?d.setFill(h):"simplemarkersymbol"===a&&d.setFill(h).setStroke(b)}},_drawMarkers:function(d,h,l,r){var a=d.geometry,y=a.points,b=d.getDojoShape()||this._div.createGroup(),
c,A,H=y.length,e=[],f=0,q,w=l?l.length:0;b.children[0]&&this._isInvalidShape(h,b.children[0])&&b.clear();for(A=0;A<H;A++)for(c=y[A],q=0;q<w;q++)e[0]=l[q],this._drawPoint(b,{x:c[0],y:c[1],spatialReference:a.spatialReference},h,b.children[f++],e,r,d);h=b.children.length;if(H*l.length<h)for(A=h-1;A>=H*l.length;A--)b.children[A].removeShape();d._shape=b},_symbolizeMarkers:function(d,h,l){var r=d.getDojoShape().children,a,y=r.length;for(a=0;a<y;a++)this._symbolizePoint(r[a],h,l,d)},_errorHandler:function(d,
h){h&&(d.message="Unable to draw graphic (geometry:"+(h.geometry?h.geometry.declaredClass:null)+", symbol:"+(h.symbol?h.symbol.declaredClass:null)+"): "+d.message);this.inherited(arguments)},_rendererLimits:function(){var d,h,l;V?(d=1E5,h=-1E5,l=1E5):B("chrome")&&6>B("chrome")&&(d=8150,h=-1E4,l=1E4);if(d)return{clipLimit:d,rangeMin:h,rangeMax:l,clipBBox:[-d,-d,d,d],clipSegments:[[[-d,-d],[d,-d]],[[d,-d],[d,d]],[[d,d],[-d,d]],[[-d,d],[-d,-d]]]}}(),_clipPolyline:function(d,h){h=this._getCorners(d,h);
var l=h.br,r=this._rendererLimits,a=r.rangeMin,y=r.rangeMax,b=r.clipBBox,c=r.clipSegments,r=this._isPointWithinRange,A=this._isPointWithinBBox,e=this._getClipperIntersection,H=this._getPlaneIndex;if(!r(h.tl,a,y)||!r(l,a,y)){V&&this._createSegments(d);var f=[];m.forEach(d.segments,function(d){d=d.args;var h=d.length,l=[],r;for(r=0;r<h;r+=2){var a=[d[r],d[r+1]],y=[d[r+2],d[r+3]],q=A(a,b),w=A(y,b);if(q^w){if(w=e([a,y],c))q?(r?l.push(w[1]):l.push(a,w[1]),f.push(l),l=[]):l.push(w[1],y)}else q?r?l.push(y):
l.push(a,y):(w=H(a,b),q=H(y,b),-1!==w&&-1!==q&&w!==q&&(a=e([a,y],c,!0),0<a.length&&(a[w]||(w=a[w[0]]?w[0]:w[1]),a[q]||(q=a[q[0]]?q[0]:q[1]),y=a[w],a=a[q],y&&l.push(y),a&&(l.push(a),f.push(l),l=[]))))}f.push(l)});d.setShape(this._getPathStringFromPaths(f))}},_clipPolygon:function(d,h){h=this._getCorners(d,h);var l=h.br,r=this._rendererLimits,a=r.clipLimit,y=r.rangeMin,b=r.rangeMax,c=r.clipBBox,A=r.clipSegments,r=this._isPointWithinRange,e=this._isPointWithinBBox,H=this._getClipperIntersection,f=this._getPlaneIndex,
q=Q._pointLineDistance;r(h.tl,y,b)&&r(l,y,b)||(V&&this._createSegments(d),h=m.filter(d.segments,function(d){return d.args&&d.args.length}),h=m.map(h,function(d){var h=d.args,l=h.length,r=[];d=[];var y;for(y=0;y<l;y+=2){var b=[h[y],h[y+1]],w=[h[y+2],h[y+3]];if(y===l-2){r.push(b);break}var k=e(b,c),x=e(w,c);r.push(b);if(k^x){if(x=H([b,w],A))b=x[1],b[k?"inOut":"outIn"]=!0,r.push(b),d.push([k?"INOUT":"OUTIN",r.length-1,x[0]])}else if(!k){var k=f(b,c),P=f(w,c);-1!==k&&-1!==P&&k!==P&&(x=H([b,w],A,!0),0<
x.length?(x[k]||(k=x[k[0]]?k[0]:k[1]),x[P]||(P=x[P[0]]?P[0]:P[1]),b=x[k],w=x[P],b&&(b.outIn=!0,r.push(b),d.push(["OUTIN",r.length-1,k])),w&&(w.inOut=!0,r.push(w),d.push(["INOUT",r.length-1,P]))):n.isArray(k)&&n.isArray(P)&&(x=k.concat(P),x.sort(),"0123"===x.join("")&&(x=[],3===k[0]+k[1]?x.push([a,-a],[-a,a]):x.push([-a,-a],[a,a]),k=q(x[0],[b,w]),b=q(x[1],[b,w]),r.push(k<b?x[0]:x[1]))))}}var g=c[0],u=c[1],B=c[2],z=c[3];m.forEach(r,function(d){d[0]<g&&(d[1]>=u&&d[1]<=z?d[0]=g:(d[0]=g,d[1]=d[1]<u?u:
z))});m.forEach(r,function(d){d[1]<u&&(d[0]>=g&&d[0]<=B?d[1]=u:(d[1]=u,d[0]=d[0]<g?g:B))});m.forEach(r,function(d){d[0]>B&&(d[1]>=u&&d[1]<=z?d[0]=B:(d[0]=B,d[1]=d[1]<u?u:z))});m.forEach(r,function(d){d[1]>z&&(d[0]>=g&&d[0]<=B?d[1]=z:(d[1]=z,d[0]=d[0]<g?g:B))});h=0;l=d.length;if(0<l){do{w=d[h];y=d[(h+1)%l];if(w[2]===y[2]&&"INOUT"===w[0]&&"OUTIN"===y[0])if(b=w[1],y=y[1],b<y)for(b+=1;b<y;b++)r[b][2]=!0;else if(b>y){for(b+=1;b<r.length;b++)r[b][2]=!0;for(b=0;b<y;b++)r[b][2]=!0}h=(h+1)%l}while(0!==h)}l=
r[0];h=r[r.length-1];l[2]&&(h[2]=!0,m.some(d,function(d){return 1===d[1]?(r.splice(r.length-1,0,n.clone(r[1])),!0):!1}));r=m.filter(r,function(d){return d[2]?!1:!0});for(h=0;h<r.length-1;h++)l=r[h],(y=r[h+1])&&l[0]===y[0]&&l[1]===y[1]&&(y.outIn?l.outIn=!0:y.inOut&&(l.inOut=!0),r.splice(h+1,1));l=Math.abs;d=[];for(h=0;h<r.length-1;h++){w=r[h];b=w[0];w=w[1];k=l(b)===a;x=l(w)===a;y=r[h+1];P=y[0];y=y[1];var C=l(P)===a,F=l(y)===a;k&&F?d.push([h+1,[b,y]]):x&&C&&d.push([h+1,[P,w]])}for(h=d.length-1;0<=h;h--)y=
d[h],b=r[y[0]-1],l=r[y[0]],b.outIn||b.inOut||l.outIn||l.inOut||r.splice(y[0],0,y[1]);l=r[0];h=r[r.length-1];l[0]===h[0]&&l[1]===h[1]||r.push(l);return r}),d.setShape(this._getPathStringFromPaths(h)))},_getCorners:function(d,h){if(V){d=this._map;var l=h.getExtent(),r=l.spatialReference;h=d.toScreen(new J(l.xmin,l.ymax,r));d=d.toScreen(new J(l.xmax,l.ymin,r));return{tl:h,br:d}}d=d.getTransformedBoundingBox();return{tl:d[0],br:d[2]}},_createSegments:function(d){d.shape.path=d.vmlPath;d.segmented=!1;
d._confirmSegmented();var h=d.segments;1<h.length&&(d.segments=m.filter(h,function(d,h,l){h=l[h+1];return"M"===d.action&&h&&"L"===h.action?(d.args=d.args.concat(h.args),!0):!1}))},_getPathStringFromPaths:function(d){V?(d=m.map(d,function(d){return"m "+m.map(d,function(d,h){return(1===h?"l ":"")+d.join(",")}).join(" ")}),d.push("e")):d=m.map(d,function(d){return"M "+m.map(d,function(d){return d.join(",")}).join(" ")});return d.join(" ")},_isPointWithinBBox:function(d,h){var l=h[1],r=h[2],a=h[3],y=
d[0];d=d[1];return y>h[0]&&y<r&&d>l&&d<a?!0:!1},_isPointWithinRange:function(d,h,l){var r=d.x;d=d.y;return r<h||d<h||r>l||d>l?!1:!0},_getClipperIntersection:function(d,h,l){var r,a=Q._getLineIntersection2,y=Math.round,b={length:0};for(r=0;4>r;r++){var c=a(d,h[r]);if(c)if(c[0]=y(c[0]),c[1]=y(c[1]),l)b[r]=c,b.length++;else return[r,c]}return l?b:null},_getPlaneIndex:function(d,h){var l=d[0];d=d[1];var r=h[0],a=h[1],y=h[2];h=h[3];return l<=r?d>=a&&d<=h?3:d<a?[0,3]:[2,3]:d<=a?l>=r&&l<=y?0:l<r?[3,0]:[1,
0]:l>=y?d>=a&&d<=h?1:d<a?[0,1]:[2,1]:d>=h?l>=r&&l<=y?2:l<r?[3,2]:[1,2]:-1},onGraphicAdd:function(){},onGraphicRemove:function(){},onGraphicNodeAdd:function(){},onGraphicNodeRemove:function(){},onGraphicDraw:function(){},onGraphicsClear:function(){},onRendererChange:function(){},onOpacityChange:function(){},onInfoTemplateChange:function(){},onSurfaceChange:function(){},onWebGLEnabledChange:function(){},setInfoTemplate:function(d){this.infoTemplate=d;this._evalSurfaceType();this.onInfoTemplateChange()},
add:function(d,h){if(d._graphicsLayer===this)return d;d._suspended=this._suspendGraphics;h||this.graphics.push(d);d._graphicsLayer=this;d._sourceLayer||(d._layer&&"esri.layers.GraphicsLayer"!==d._layer.declaredClass?d._sourceLayer=d._layer:"esri.layers.GraphicsLayer"!==this.declaredClass&&(d._sourceLayer=this));d._layer=this;this.hasWebGLSurface()||(this._updateExtent(d),this._draw(d));if(!h)this.onGraphicAdd(d);return d},remove:function(d,h,r){if(!h&&!r){h=this.graphics;var a;if(-1===(a=m.indexOf(h,
d)))return null;if(!l||64<=l)h.splice(a,1);else{var y=h.length;if(y){for(;a<y;)h[a]=h[a+1],a++;h.length--}}}this.hasWebGLSurface()||d.getDojoShape()&&this._removeShape(d,null,r);d._shape=d._graphicsLayer=null;this.onGraphicRemove(d);return d},clear:function(d,h){d=this.graphics;var l,r=!V;for(l=d.length-1;0<=l;l--)this.remove(d[l],null,r);this.graphics=[];this.hasWebGLSurface()||this._destroyAllNodes();if(!h)this.onGraphicsClear()},_destroyAllNodes:function(){if(!V&&this._div){var d;this._childLayer&&
(d=this._childLayer.getNode())&&d.parentNode&&d.parentNode.removeChild(d);this._bgGroup.clear();this._div.clear();this._bgGroup=this._div.createGroup();d&&this._div.getEventSource().appendChild(d);this._initOpacity()}},clearNodes:function(){if(!this.hasWebGLSurface()){var d=this.graphics,h=d.length,l;for(l=0;l<h;l++)this._removeShape(d[l],!0,!0);this._destroyAllNodes()}},_graphicVisibilityChanged:function(d){},_setIEOpacity:function(d,h){var l=d&&d.getNode();if(l){var r=d.strokeStyle,a=l.stroke;r&&
a&&(a.opacity=r.color.a*h);d=d.fillStyle;r=l.fill;d&&r&&("tile"===r.type?e.set(l,"opacity",h):r.opacity=d.a*h)}},setOpacity:function(d,h){if(h||this.opacity!=d){var l=this._div;l&&!this.hasWebGLSurface()&&(V?(m.forEach(this.graphics,function(h){this._setIEOpacity(h._shape,d);this._setIEOpacity(h._bgShape,d)},this),l._esriIeOpacity=d,this._bgGroup._esriIeOpacity=d):"canvas-2d"===this.surfaceType?e.set(l.getEventSource(),"opacity",d):l.getEventSource().setAttribute("opacity",d));this.opacity=d;if(!h)this.onOpacityChange(d)}},
setRenderer:function(d){this.renderer=d;this._evalSDRenderer(!0);this._evalSurfaceType();this.emit("renderer-change",{renderer:this._rndForScale||d})}});g=g([w,T],{declaredClass:"esri.layers.GraphicsLayer",constructor:function(){this._processEvent=n.hitch(this,this._processEvent);this._initLayer()},_initLayer:function(){this.loaded=!0;this.onLoad(this)},_setMap:function(){var d=this.inherited("_setMap",arguments);this.enableMouseEvents();return d},_unsetMap:function(){this.disableMouseEvents();this.inherited("_unsetMap",
arguments)},_processEvent:function(d){var h=this._map,l=d.target,r;d.screenPoint=new L(d.pageX-h.position.x,d.pageY-h.position.y);for(d.mapPoint=h.toMap(d.screenPoint);l&&!(r=l.e_graphic);)l=l.parentNode;if(r)return d.graphic=r,d},_onMouseOverHandler:function(d){if(this._processEvent(d))this.onMouseOver(d)},_onMouseMoveHandler:function(d){if(this._processEvent(d))this.onMouseMove(d)},_onMouseDragHandler:function(d){if(this._processEvent(d))this.onMouseDrag(d)},_onMouseOutHandler:function(d){if(this._processEvent(d))this.onMouseOut(d)},
_onMouseDownHandler:function(d){this._downGr=this._downPt=null;this._processEvent(d)&&(v.disconnect(this._onmousemove_connect),v.disconnect(this._onmousedrag_connect),this._onmousedrag_connect=v.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseDragHandler"),this._downGr=d.graphic,this._downPt=d.screenPoint.x+","+d.screenPoint.y,this.onMouseDown(d))},_onMouseUpHandler:function(d){this._upGr=this._upPt=null;this._processEvent(d)&&(v.disconnect(this._onmousedrag_connect),v.disconnect(this._onmousemove_connect),
this._onmousemove_connect=v.connect(this._div.getEventSource(),"onmousemove",this,"_onMouseMoveHandler"),this._upGr=d.graphic,this._upPt=d.screenPoint.x+","+d.screenPoint.y,this.onMouseUp(d))},_onClickHandler:function(d){if(this._processEvent(d)){var h=this._downGr,l=this._upGr;h&&l&&h===l&&this._downPt===this._upPt&&(V&&(z._ieGraphic=d.graphic),this.onClick(d))}},_onDblClickHandler:function(d){if(this._processEvent(d))this.onDblClick(d)},onMouseOver:function(){},onMouseMove:function(){},onMouseDrag:function(){},
onMouseOut:function(){},onMouseDown:function(){},onMouseUp:function(){},onClick:function(){},onDblClick:function(){},enableMouseEvents:function(){if(!this._mouseEvents){var d=v.connect,h=this._div.getEventSource();W||(this._onmouseover_connect=d(h,"onmouseover",this,"_onMouseOverHandler"),this._onmousemove_connect=d(h,"onmousemove",this,"_onMouseMoveHandler"),this._onmouseout_connect=d(h,"onmouseout",this,"_onMouseOutHandler"),this._onmousedown_connect=d(h,"onmousedown",this,"_onMouseDownHandler"),
this._onmouseup_connect=d(h,"onmouseup",this,"_onMouseUpHandler"),this._onclick_connect=d(h,"onclick",this,"_onClickHandler"),this._ondblclick_connect=d(h,"ondblclick",this,"_onDblClickHandler"));this._mouseEvents=!0}},disableMouseEvents:function(){if(this._mouseEvents){var d=v.disconnect;d(this._onmouseover_connect);d(this._onmousemove_connect);d(this._onmousedrag_connect);d(this._onmouseout_connect);d(this._onmousedown_connect);d(this._onmouseup_connect);d(this._onclick_connect);d(this._ondblclick_connect);
this._mouseEvents=!1}}});g._GraphicsContainer=q;g._GraphicsLayer=w;return g})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(p,g,t){g.switchTo(t);return g})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(p,g,t,v,n){var m=null;t.add("vml",function(m,k,f){f.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';m="adj"in f.firstChild;f.innerHTML="";return m});return{load:function(u,
k,f){function e(){k(["dojox/gfx/"+b],function(a){p.renderer=b;m=a;f(a)})}if(m&&"force"!=u)f(m);else{var b=n.forceGfxRenderer;u=!b&&(g.isString(n.gfxRenderer)?n.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var a,c;!b&&u.length;)switch(u.shift()){case "svg":"SVGAngle"in v.global&&(b="svg");break;case "vml":t("vml")&&(b="vml");break;case "silverlight":try{t("ie")?(a=new ActiveXObject("AgControl.AgControl"),a.IsVersionSupported("1.0"))&&(c=!0):navigator.plugins["Silverlight Plug-In"]&&(c=
!0)}catch(x){c=!1}finally{a=null}c&&(b="silverlight");break;case "canvas":v.global.CanvasRenderingContext2D&&(b="canvas")}"canvas"===b&&!1!==n.canvasEvents&&(b="canvasWithEvents");n.isDebug&&console.log("gfx renderer \x3d "+b);"svg"==b&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(e):e()}}}})},"esri/layers/gfxSniff":function(){define(["dojo/has","dojox/gfx"],function(p,g){p.add("esri-svg",function(){return-1!==g.renderer.toLowerCase().indexOf("svg")});return p})},"esri/layers/layer":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/Deferred dojo/_base/json dojo/has ../Evented ../kernel ../lang ../request ../deferredUtils ../urlUtils ../SpatialReference ../geometry/Extent".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){var q=p([k],{declaredClass:"esri.layers.Layer",_eventMap:{error:["error"],load:["layer"],"opacity-change":["opacity"],"update-end":["error"],"visibility-change":["visible"]},constructor:function(a,b){this._attrs={};a&&v.isString(a)?this._url=c.urlToObject(this.url=a):(this.url=this._url=null,(b=b||a)&&(b.layerDefinition||b.query)&&(b=null));this.spatialReference=new x(4326);this.initialExtent=new w(-180,-90,180,90,new x(4326));this._map=this._div=null;this.normalization=
!0;b&&(b.id&&(this.id=b.id),this.arcgisProps=b.arcgisProps,this.parentLayer=b.parentLayer,!1===b.visible&&(this.visible=!1),e.isDefined(b.opacity)&&(this.opacity=b.opacity),e.isDefined(b.minScale)&&this.setMinScale(b.minScale),e.isDefined(b.maxScale)&&this.setMaxScale(b.maxScale),this.attributionDataUrl=b.attributionDataUrl||"",this.hasAttributionData=!!this.attributionDataUrl,e.isDefined(b.showAttribution)&&(this.showAttribution=b.showAttribution),this.className=b.className,this.refreshInterval=
b.refreshInterval||0);this._errorHandler=v.hitch(this,this._errorHandler);this._scheduledRefresh=v.hitch(this,this._scheduledRefresh);this.refresh=v.hitch(this,this.refresh);if(this.managedSuspension){var f=this._setMap;this._setMap=function(a){var b=f.apply(this,arguments);this._fireAttach(a);this.evaluateSuspension();if(this.suspended&&!a.loaded)var c=t.connect(a,"onLoad",this,function(){t.disconnect(c);c=null;this.evaluateSuspension()});return b}}this.registerConnectEvents()},id:null,visible:!0,
opacity:1,loaded:!1,loadError:null,minScale:0,maxScale:0,visibleAtMapScale:!1,suspended:!0,attached:!1,attributionDataUrl:"",hasAttributionData:!1,showAttribution:!0,refreshInterval:0,_errorHandler:function(a){this.loaded||(this.loadError=a);this.onError(a)},_setMap:function(a,b,c,e){this._map=a;this._lyrZEHandle=t.connect(a,"onZoomEnd",this,this._processMapScale);if(a.loaded)this.visibleAtMapScale=this._isMapAtVisibleScale();else var f=t.connect(a,"onLoad",this,function(){t.disconnect(f);f=null;
this._processMapScale()})},_unsetMap:function(a,b){t.disconnect(this._lyrZEHandle);this._map=this._lyrZEHandle=null;this._resumedOnce=void 0;this.suspended=!0;this._fireDetach(a)},_fireAttach:function(a){this.attached=!0;this.onAttach({map:a})},_fireDetach:function(a){this.attached=!1;this.onDetach({map:a})},_cleanUp:function(){this._map=this._div=null},_fireUpdateStart:function(){this.updating||(this.updating=!0,this.attr("data-updating",""),this.onUpdateStart(),this._map&&this._map._incr())},_fireUpdateEnd:function(a,
b){this.updating&&(this.updating=!1,this.attr("data-updating"),this._refreshRT(),this.onUpdateEnd(a,b),this._map&&this._map._decr())},_getToken:function(){var a=this._url,b=this.credential;return a&&a.query&&a.query.token||b&&b.token||void 0},_findCredential:function(){this.credential=f.id&&this._url&&f.id.findCredential(this._url.path)},_useSSL:function(){var a=this._url,b=/^http:/i;this.url&&(this.url=this.url.replace(b,"https:"));a&&a.path&&(a.path=a.path.replace(b,"https:"))},refresh:function(){},
show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setMinScale:function(a){this.setScaleRange(a)},setMaxScale:function(a){this.setScaleRange(null,a)},setScaleRange:function(a,b){var c=e.isDefined(a),f=e.isDefined(b);this.loaded||(this._hasMin=this._hasMin||c,this._hasMax=this._hasMax||f);var w=this.minScale,q=this.maxScale;this.minScale=(c?a:this.minScale)||0;this.maxScale=(f?b:this.maxScale)||0;if(w!==this.minScale||q!==this.maxScale)this.onScaleRangeChange(),this._processMapScale()},
suspend:function(){this._suspended=!0;this.evaluateSuspension()},resume:function(){this._suspended=!1;this.evaluateSuspension()},canResume:function(){return this.loaded&&this._map&&this._map.loaded&&this.visible&&this.visibleAtMapScale&&!this._suspended},evaluateSuspension:function(){this.canResume()?this.suspended&&this._resume():this.suspended||this._suspend()},_suspend:function(){this.suspended=!0;this.attr("data-suspended","");this.onSuspend();if(this._map)this._map.onLayerSuspend(this)},_resume:function(){this.suspended=
!1;this.attr("data-suspended");var a=void 0===this._resumedOnce,b=this.className,c=this._attrs,e=this.getNode(),f;if(a){this._resumedOnce=!0;if(b&&e){var w=e.getAttribute("class")||"";(new RegExp("(^|\\s)"+b+"(\\s|$)","i")).test(w)||e.setAttribute("class",w+((w?" ":"")+b))}if(c&&e)for(f in c)c.hasOwnProperty(f)&&e.setAttribute(f,c[f])}this._refreshRT();this.onResume({firstOccurrence:a});if(this._map)this._map.onLayerResume(this)},_processMapScale:function(){var a=this.visibleAtMapScale;this.visibleAtMapScale=
this._isMapAtVisibleScale();a!==this.visibleAtMapScale&&(this.onScaleVisibilityChange(),this.evaluateSuspension())},isVisibleAtScale:function(a){return a?q.prototype._isMapAtVisibleScale.apply(this,arguments):!1},_isMapAtVisibleScale:function(a,b){if(!(a||this._map&&this._map.loaded))return!1;var c=this._map;a=a||c.getScale();var e=this.minScale,f=this.maxScale,w=!e,q=!f,k;b&&(k=c.width>c.height?c.width:c.height);w||(a<=e?w=!0:b&&(w=Math.abs(e-a)/e<1/k));q||(a>=f?q=!0:b&&(q=Math.abs(f-a)/f<1/k));
return w&&q},getAttributionData:function(){var c=this.attributionDataUrl,e=new n(a._dfdCanceller);this.hasAttributionData&&c?(e._pendingDfd=b({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),e._pendingDfd.then(function(a){e.callback(a)},function(a){e.errback(a)})):(c=Error("Layer does not have attribution data"),c.log=!!g.isDebug,e.errback(c));return e},getResourceInfo:function(){var a=this.resourceInfo;return v.isString(a)?m.fromJson(a):v.clone(a)},getMap:function(){return this._map},
getNode:function(){return this._div},attr:function(a,b){var c=this.getNode();if("data-reference"===a&&11>u("ie"))return this;c&&(null==b?c.removeAttribute(a):c.setAttribute(a,b));this._attrs&&(null==b?delete this._attrs[a]:this._attrs[a]=b);return this},setRefreshInterval:function(a){var b=this.refreshInterval;this.refreshInterval=a;this._toggleRT(!1);a&&this._toggleRT(!0);if(b!==a)this.onRefreshIntervalChange();return this},_toggleRT:function(a){a&&this.refreshInterval?(clearInterval(this._refreshTimer),
this._refreshTimer=setInterval(this._scheduledRefresh,6E4*this.refreshInterval)):this._refreshTimer&&(clearInterval(this._refreshTimer),this._refreshTimer=null)},_refreshRT:function(){this._toggleRT(!1);this._toggleRT(!0)},_scheduledRefresh:function(){this.onRefreshTick();!this._map||this.suspended||this.updating||this.refresh()},setNormalization:function(a){this.normalization=a},setVisibility:function(a){this.visible!==a&&(this.visible=a,this.onVisibilityChange(this.visible),this.evaluateSuspension());
this.attr("data-hidden",a?null:"")},onLoad:function(){},onAttach:function(a){},onDetach:function(a){},onVisibilityChange:function(){},onScaleRangeChange:function(){},onScaleVisibilityChange:function(){},onSuspend:function(){},onResume:function(){},onUpdate:function(){},onUpdateStart:function(){},onUpdateEnd:function(){},onRefreshIntervalChange:function(){},onRefreshTick:function(){},onError:function(){}});return q})},"esri/layers/support/webglUtils":function(){define(["dojo/_base/lang","dojo/_base/array",
"dojo/has","../../kernel"],function(p,g,t,v){var n=!1,m=t("esri-webgl-max-contexts"),m=null!=m?m:t("esri-mobile")?8:16,u={isWebGLSupported:function(){return!!n},isWebGLEnabled:function(){return this.isWebGLSupported()&&!!t("esri-featurelayer-webgl")},createCanvas:function(k,f){var e=document.createElement("canvas");e.style.width=k+"px";e.style.height=f+"px";return e},createWebGLContext:function(k){var f;g.some(["webgl","experimental-webgl","webkit-3d","moz-webgl"],function(e){try{f=k.getContext?k.getContext(e):
null}catch(b){f=null}return!!f});return f},_contextOwners:[],isContextAvailable:function(){return-1===m||0<m&&u._contextOwners.length<m},acquireContext:function(k){return-1!==g.indexOf(u._contextOwners,k)?!0:u.isContextAvailable()?(u._contextOwners.push(k),!0):!1},releaseContext:function(k){k=g.indexOf(u._contextOwners,k);-1!==k&&u._contextOwners.splice(k,1)}},n=u.createWebGLContext(u.createCanvas());return u})},"esri/layers/support/WebGLSurface":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/_base/array","dojo/has","../../kernel"],function(p,g,t,v,n){return p(null,{map:null,node:null,renderers:null,constructor:function(m){g.mixin(this,m);this.renderers=[]},destroy:function(){t.forEach(this.renderers,function(m){m.destroy()});this.renderers=null},getEventSource:function(){return this.node},createRenderer:function(m,g,k,f){m=new m({surface:this,width:g,height:k,map:this.map,layer:f});this.renderers.push(m);return m},destroyRenderer:function(m){var g=t.indexOf(this.renderers,m);-1<
g&&(m.destroy(),this.renderers.splice(g,1))},_createNode:function(){var m=document.createElement("div");m.style.pointerEvents="auto";m.style.position="absolute";return m}})})},"esri/domUtils":function(){define(["./kernel","dojo/_base/connect","dojo/_base/lang","dojo/dom-style","dojo/has"],function(p,g,t,v,n){var m={show:function(g){if(g=m.getNode(g))g.style.display="block"},getNode:function(m){return m&&m.domNode||m},hide:function(g){if(g=m.getNode(g))g.style.display="none"},toggle:function(g){if(g=
m.getNode(g))g.style.display="none"===g.style.display?"block":"none"},documentBox:8>=n("ie")?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight},setScrollable:function(m){if(m=this.getNode(m)){var k=0,f=0,e=0,b=0,a=0,c=0;return[g.connect(m,"ontouchstart",function(x){k=x.touches[0].screenX;f=x.touches[0].screenY;e=m.scrollWidth;b=m.scrollHeight;a=m.clientWidth;c=m.clientHeight}),g.connect(m,"ontouchmove",function(x){x.preventDefault();
var w=m.firstChild;w instanceof Text&&(w=m.childNodes[1]);var q=w._currentX||0,g=w._currentY||0,q=q+(x.touches[0].screenX-k);0<q?q=0:0>q&&Math.abs(q)+a>e&&(q=-1*(e-a));w._currentX=q;g+=x.touches[0].screenY-f;0<g?g=0:0>g&&Math.abs(g)+c>b&&(g=-1*(b-c));w._currentY=g;v.set(w,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+q+"px, "+g+"px)"});k=x.touches[0].screenX;f=x.touches[0].screenY})]}}};return m})},"esri/symbols/MarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),
function(p,g,t,v,n,m){return p(m,{declaredClass:"esri.symbol.MarkerSymbol",angle:0,xoffset:0,yoffset:0,size:12,constructor:function(m){m&&g.isObject(m)&&(this.size="auto"===this.size?this.size:v.pt2px(this.size),this.xoffset=v.pt2px(this.xoffset),this.yoffset=v.pt2px(this.yoffset),this.angle&&(this.angle*=-1))},setAngle:function(m){this.angle=m;return this},setSize:function(m){this.size=m;return this},setOffset:function(m,k){this.xoffset=m;this.yoffset=k;return this},toJson:function(){var m=v.px2pt(this.size),
m=isNaN(m)?void 0:m,k=v.px2pt(this.xoffset),k=isNaN(k)?void 0:k,f=v.px2pt(this.yoffset),f=isNaN(f)?void 0:f;return g.mixin(this.inherited("toJson",arguments),{size:"auto"===this.size?this.size:m,angle:this.angle&&-1*this.angle,xoffset:k,yoffset:f})}})})},"esri/symbols/Symbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../Color".split(" "),function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.symbol.Symbol",color:new m([0,0,0,1]),type:null,constructor:function(u){u&&
g.isObject(u)&&(g.mixin(this,u),this.color&&n.isDefined(this.color[0])&&(this.color=m.toDojoColor(this.color)),(u=this.type)&&0===u.indexOf("esri")&&(this.type={esriSMS:"simplemarkersymbol",esriPMS:"picturemarkersymbol",esriSLS:"simplelinesymbol",esriCLS:"cartographiclinesymbol",esriSFS:"simplefillsymbol",esriPFS:"picturefillsymbol",esriTS:"textsymbol",esriSHD:"shieldlabelsymbol"}[u]))},setColor:function(m){this.color=m;return this},toJson:function(){return{color:m.toJsonColor(this.color)}}})})},
"esri/symbols/SimpleMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(p,g,t,v,n,m,u,k,f){var e={STYLE_CIRCLE:"circle",STYLE_SQUARE:"square",STYLE_TRIANGLE:"triangle",STYLE_CROSS:"cross",STYLE_X:"x",STYLE_DIAMOND:"diamond",STYLE_PATH:"path",STYLE_TARGET:"target"},b={style:e.STYLE_CIRCLE,color:[255,255,255,.25],size:12,angle:0,xoffset:0,yoffset:0};p=p(k,{declaredClass:"esri.symbol.SimpleMarkerSymbol",
type:"simplemarkersymbol",_styles:{circle:"esriSMSCircle",square:"esriSMSSquare",triangle:"esriSMSTriangle",cross:"esriSMSCross",x:"esriSMSX",diamond:"esriSMSDiamond",path:"esriSMSPath"},constructor:function(a,c,k,w){a?g.isString(a)?(this.style=a,c&&(this.size=c),k&&(this.outline=k),w&&(this.color=w)):(this.style=u.valueOf(this._styles,this.style),a.outline&&(this.outline=new f(a.outline))):(g.mixin(this,b),this.size=n.pt2px(this.size),this.outline=new f(this.outline),this.color=new t(this.color));
this.style||(this.style=e.STYLE_CIRCLE)},setStyle:function(a){this.style=a;return this},setPath:function(a){this.path=a;this.setStyle(e.STYLE_PATH);return this},setOutline:function(a){this.outline=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return this.color},_setDim:function(a,b,e){this._targetWidth=a;this._targetHeight=b;this._spikeSize=e},getShapeDescriptors:function(){var a,c,f,w=this.style,q=(this.size||n.pt2px(b.size))/2,k=0-q,m=0+q,
g=0-q,u=0+q;switch(w){case e.STYLE_CIRCLE:a={type:"circle",cx:0,cy:0,r:q};c=this.getFill();if(f=this.getStroke())f.style=f.style||"Solid";break;case e.STYLE_CROSS:a={type:"path",path:"M "+k+",0 L "+m+",0 M 0,"+g+" L 0,"+u+" E"};c=null;f=this.getStroke();break;case e.STYLE_DIAMOND:a={type:"path",path:"M "+k+",0 L 0,"+g+" L "+m+",0 L 0,"+u+" L "+k+",0 Z"};c=this.getFill();f=this.getStroke();break;case e.STYLE_SQUARE:a={type:"path",path:"M "+k+","+u+" L "+k+","+g+" L "+m+","+g+" L "+m+","+u+" L "+k+
","+u+" Z"};c=this.getFill();f=this.getStroke();break;case e.STYLE_TRIANGLE:a={type:"path",path:"M "+k+","+u+" L 0,"+g+" L "+m+","+u+" L "+k+","+u+" Z"};c=this.getFill();f=this.getStroke();break;case e.STYLE_X:a={type:"path",path:"M "+k+","+u+" L "+m+","+g+" M "+k+","+g+" L "+m+","+u+" E"};c=null;f=this.getStroke();break;case e.STYLE_PATH:a={type:"path",path:this.path||""},c=this.getFill(),f=this.getStroke()}return{defaultShape:a,fill:c,stroke:f}},toJson:function(){var a=this.style,b=this.outline,
e=g.mixin(this.inherited("toJson",arguments),{type:"esriSMS",style:this._styles[a]||"esriSMSCircle"});b&&(e.outline=b.toJson());"x"===a||"cross"===a?delete e.color:"target"===a&&(e.style="esriSMSSquare",delete e.color,0<this._targetHeight&&0<this._targetWidth&&(e.size=n.px2pt(Math.max(this._targetHeight,this._targetWidth))));e.path=this.path;return u.fixJson(e)}});g.mixin(p,e);p.defaultProps=b;return p})},"esri/symbols/SimpleLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./LineSymbol".split(" "),
function(p,g,t,v,n,m,u,k){var f={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot"},e={color:[0,0,0,1],style:f.STYLE_SOLID,width:1};p=p(k,{declaredClass:"esri.symbol.SimpleLineSymbol",type:"simplelinesymbol",marker:null,_styles:{solid:"esriSLSSolid",
dash:"esriSLSDash",dot:"esriSLSDot",dashdot:"esriSLSDashDot",longdashdotdot:"esriSLSDashDotDot",none:"esriSLSNull",insideframe:"esriSLSInsideFrame",shortdash:"esriSLSShortDash",shortdot:"esriSLSShortDot",shortdashdot:"esriSLSShortDashDot",shortdashdotdot:"esriSLSShortDashDotDot",longdash:"esriSLSLongDash",longdashdot:"esriSLSLongDashDot"},constructor:function(b,a,c){b?g.isString(b)?(this.style=b,a&&(this.color=a),c&&(this.width=c)):(this.style=u.valueOf(this._styles,b.style)||f.STYLE_SOLID,this.marker=
b.marker):(g.mixin(this,e),this.color=new t(this.color),this.width=n.pt2px(this.width))},setStyle:function(b){this.style=b;return this},setMarker:function(b){this.marker=b},getStroke:function(){return this.style===f.STYLE_NULL||0===this.width?null:{color:this.color,style:this.style,width:this.width}},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){return u.fixJson(g.mixin(this.inherited("toJson",
arguments),{type:"esriSLS",style:this._styles[this.style],marker:this.marker?g.clone(this.marker):void 0}))}});g.mixin(p,f);p.defaultProps=e;return p})},"esri/symbols/LineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ./Symbol".split(" "),function(p,g,t,v,n,m){return p(m,{declaredClass:"esri.symbol.LineSymbol",constructor:function(m){g.isObject(m)?this.width=v.pt2px(this.width):this.width=12},setWidth:function(m){this.width=m;return this},toJson:function(){var m=
v.px2pt(this.width),m=isNaN(m)?void 0:m;return g.mixin(this.inherited("toJson",arguments),{width:m})}})})},"esri/symbols/utils":function(){define("dojo/_base/lang dojo/_base/window dojo/has dojox/gfx ../kernel ../Color".split(" "),function(p,g,t,v,n,m){function u(a){a.removeAttribute("marker-start");a.removeAttribute("marker-end");a.removeAttribute("opacity")}function k(a,b){for(var c in b)a.setAttribute(c,b[c])}function f(a,b,e){b="url(#"+b.getAttribute("id")+")";a.rawNode.setAttribute("marker-"+
e,b)}var e=-1!==v.renderer.toLowerCase().indexOf("svg"),b=9===t("ie"),a={marker:{markerWidth:"6",markerHeight:"6",markerUnits:"strokeWidth",orient:"auto"},spear:{marker:{end:{viewBox:"0 0 25.4 23.43",refX:"20",refY:"12.76"},start:{viewBox:"-25.4 0 25.4 23.43",refX:"-20",refY:"12.76"}},path:{common:{d:"M1.63 23.43 L5.37 16.6 L5.37 8.93 L1.63 2.09 L25.4 12.76 L1.63 23.43 Z","stroke-width":"0","fill-opacity":"1"},start:{transform:"matrix(-1, 0, 0, 1, 0, 0)"}}}};return{applyLineMarker:function(a,k,w,
q){if(e&&!b){var c=a&&a.rawNode,x=k.marker;w=w||k.color;c&&"none"!==k.style&&w&&x&&"arrow"===x.style&&x.placement?c.getTotalLength&&0===c.getTotalLength()?u(c):(k=-1!==x.placement.indexOf("begin"),x=-1!==x.placement.indexOf("end"),k||x?(c.removeAttribute("stroke-opacity"),c.setAttribute("opacity",w.a),k?(k=q(a,w,"spear","start"),f(a,k,"start")):c.removeAttribute("marker-start"),x?(w=q(a,w,"spear","end"),f(a,w,"end")):c.removeAttribute("marker-end")):u(c)):c&&u(c)}},createSVGMarker:function(b,e,f,
q){f=a[f];var c=g.doc.createElementNS("http://www.w3.org/2000/svg","marker");c.setAttribute("id",e);k(c,a.marker);k(c,f.marker[q]);e=g.doc.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill",b.toCss());k(e,f.path.common);k(e,f.path[q]);c.appendChild(e);return c},create2DColorRamp:function(a){var b=a.surface.createGroup(),c=a.colors,e=a.numClasses;a=(a.size||75)/e;for(var f=0;f<e;f++)for(var k=f*a,m=0;m<e;m++){var g=c[f][m];b.createRect({x:m*a,y:k,width:a,height:a}).setFill(g).setStroke(null)}return b},
setSymbolFillColor:function(a,b){if(a)switch(b=b?new m(b):null,a.type){case "simplemarkersymbol":"cross"===a.style||"x"===a.style?a.outline&&a.outline.setColor(b):a.setColor(b);break;case "simplelinesymbol":case "cartographiclinesymbol":case "simplefillsymbol":case "shieldlabelsymbol":case "textsymbol":a.setColor(b)}}}})},"esri/layers/TileInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../SpatialReference ../geometry/Point ./LOD".split(" "),
function(p,g,t,v,n,m,u,k,f){return p(null,{declaredClass:"esri.layers.TileInfo",constructor:function(e){g.mixin(this,e);this.width=this.cols;this.height=this.rows;this._levelToLOD={};e=this.spatialReference;var b=this.origin;e&&(e=this.spatialReference=new u(e.toJson?e.toJson():e));b&&(this.origin=new k(b.toJson?b.toJson():b),!b.spatialReference&&e&&this.origin.setSpatialReference(new u(e.toJson())));this.lods=t.map(this.lods,function(a){return new f(a)});t.forEach(this.lods,function(a){this._levelToLOD[a.level]=
a},this);e=!1;var b=this.spatialReference,a=this.origin;if(b&&a){var c=b._getInfo();c&&(e=b._isWrappable()&&Math.abs(c.origin[0]-a.x)<=c.dx)}this.isWrappable=e;this._initializeUpsampleLevels()},toJson:function(){return m.fixJson({rows:this.rows,cols:this.cols,dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin&&this.origin.toJson(),spatialReference:this.spatialReference&&this.spatialReference.toJson(),lods:this.lods&&t.map(this.lods,function(e){return e.toJson()})})},
lodAt:function(e){return this._levelToLOD&&this._levelToLOD[e]||null},updateTileInfo:function(e){var b=this.lodAt(e.level),a=b.resolution*this.width,b=b.resolution*this.height;e.id=e.level+"/"+e.row+"/"+e.col;e.extent||(e.extent=[0,0,0,0]);e.extent[0]=this.origin.x+e.col*a;e.extent[1]=this.origin.y-(e.row+1)*b;e.extent[2]=e.extent[0]+a;e.extent[3]=e.extent[1]+b},upsampleTile:function(e){var b=this._upsampleLevels[e.level];if(!b||-1===b.parentLevel)return!1;e.level=b.parentLevel;e.row=Math.floor(e.row/
b.factor+.001);e.col=Math.floor(e.col/b.factor+.001);this.updateTileInfo(e);return!0},_initializeUpsampleLevels:function(){var e=this.lods;this._upsampleLevels=[];for(var b=null,a=0;a<e.length;a++){var c=e[a];this._upsampleLevels[c.level]={parentLevel:b?b.level:-1,factor:b?b.resolution/c.resolution:0};b=c}}})})},"esri/layers/LOD":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.layers.LOD",constructor:function(m){g.mixin(this,
m)},toJson:function(){return n.fixJson({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}})})},"esri/layers/ArcGISTiledMapServiceLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has dojo/io-query ../kernel ../urlUtils ../SpatialReference ./TiledMapServiceLayer ./ArcGISMapServiceLayer ./TileInfo ./TimeInfo ./TileMap".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return g([b,a],{declaredClass:"esri.layers.ArcGISTiledMapServiceLayer",
_agolAttrs:"Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" "),_isReference:!1,_referenceLayers:"Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Reference Ocean/World_Ocean_Reference Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Reference_Overlay Reference/World_Transportation".split(" "),
constructor:function(a,b){b&&(b.roundrobin&&(p.deprecated(this.declaredClass+" : Constructor option 'roundrobin' deprecated. Use option 'tileServers'."),b.tileServers=b.roundrobin),this._setTileServers(b.tileServers),this._loadCallback=b.loadCallback);this._params=t.mixin({},this._url.query);this._initLayer=t.hitch(this,this._initLayer);(a=b&&b.resourceInfo)?this._initLayer(a):(this._load=t.hitch(this,this._load),this._load())},_TILE_FORMATS:{PNG:"png",PNG8:"png",PNG24:"png",PNG32:"png",JPG:"jpg",
JPEG:"jpg",GIF:"gif"},_setTileServers:function(a){if(a&&0<a.length){this.tileServers=a;var b,c=a.length;for(b=0;b<c;b++)a[b]=f.urlToObject(a[b]).path}},_initLayer:function(a,b){this.inherited(arguments);this.resourceInfo=n.toJson(a);this.tileInfo=new c(a.tileInfo);!1!==this.resampling&&(a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?(this.resampling=!0,this.tileMap=new w(this)):this.resampling=!!a.resampling);!this.spatialReference&&this.tileInfo.spatialReference&&(this.spatialReference=new e(this.tileInfo.spatialReference.toJson()));
this.isPNG32="PNG24"===this.tileInfo.format||"PNG32"===this.tileInfo.format;a.timeInfo&&(this.timeInfo=new x(a.timeInfo));a.mensurationCapabilities&&(this.mensurationCapabilities=a.mensurationCapabilities);var k=this._url.path,q=this._loadCallback,m=f.getProtocolForWebResource(!0),g=k.match(/^https?\:\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i),g=g&&g[2];if(!this.tileServers)if(a.tileServers)this._setTileServers(a.tileServers);else{var u=-1!==
k.search(/^https?\:\/\/server\.arcgisonline\.com/i),C=-1!==k.search(/^https?\:\/\/services\.arcgisonline\.com/i);(u||C)&&this._setTileServers([k,k.replace(u?/server\.arcgisonline/i:/services\.arcgisonline/i,u?"services.arcgisonline":"server.arcgisonline")])}if(g){g=g.toLowerCase();for(k=0;k<this._agolAttrs.length;k++)if(u=this._agolAttrs[k],u.toLowerCase()===g){this.hasAttributionData=!0;this.attributionDataUrl=this.attributionDataUrl||m+"//static.arcgis.com/attribution/"+u;break}for(k=0;k<this._referenceLayers.length;k++)if(u=
this._referenceLayers[k],u.toLowerCase()===g){this._isReference=!0;break}}this.loaded=!0;this.onLoad(this);q&&(delete this._loadCallback,q(this))},getTileUrl:function(a,b,c){var e=this.tileServers,w=this._getToken(),k=this._url.query;a=(e?e[b%e.length]:this._url.path)+"/tile/"+a+"/"+b+"/"+c;a=f.upgradeToHTTPS(a);this.resampling&&!this.tileMap&&(a+="?blankTile\x3dfalse");k&&(a=this.resampling&&!this.tileMap?a+("\x26"+u.objectToQuery(k)):a+("?"+u.objectToQuery(k)));!w||k&&k.token||(a+=(-1===a.indexOf("?")?
"?":"\x26")+"token\x3d"+w);a=this.addTimestampToURL(a);return f.addProxy(a)}})})},"esri/layers/TiledMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/url dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/dom dojox/collections/ArrayList dojox/gfx/matrix ../kernel ../config ../sniff ../domUtils ../tileUtils ../geometry/Point ../geometry/Rect ../geometry/Extent ./layer".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,
a,c,x,w,q,C,z,E,B,G){return p(G,{declaredClass:"esri.layers.TiledMapServiceLayer",constructor:function(a,b){g.connect(this,"onLoad",this,"_initTiledLayer");this._lowestLevel=(this._displayLevels=b?b.displayLevels:null)?this._displayLevels[0]:0;this.resampling=b?b.resampling:void 0;this._resamplingTolerance=b?b.resamplingTolerance:null;this.exclusionAreas=b?b.exclusionAreas:null;a=t.hitch;this._addImage=a(this,this._addImage);this._tileLoadHandler=a(this,this._tileLoadHandler);this._tileErrorHandler=
a(this,this._tileErrorHandler);this._popTile=a(this,this._popTile);this._cleanUpRemovedImages=a(this,this._cleanUpRemovedImages);this._fireOnUpdateEvent=a(this,this._fireOnUpdateEvent);this._transitionEnd=a(this,this._transitionEnd);this._tileMapCallback=a(this,this._tileMapCallback)},opacity:1,isPNG32:!1,_multiple:1,isResampling:!1,_initTiledLayer:function(){var a=this.tileInfo,b=a.lods;this.resampling=null!=this.resampling?this.resampling:!1;this._tileW=a.width;this._tileH=a.height;var c=this.scales=
[],e=this._displayLevels,f=-Infinity,k=Infinity,q=this.fullExtent,x=new z(q.xmin,q.ymax),q=new z(q.xmax,q.ymin),m=C.getContainingTileCoords,g,u,n,B=b.length;for(n=0;n<B;n++)u=b[n],g=m(a,x,u),u.startTileRow=0>g.row?0:g.row,u.startTileCol=0>g.col?0:g.col,g=m(a,q,u),u.endTileRow=g.row,u.endTileCol=g.col,e&&-1===v.indexOf(e,u.level)||(c[n]=u.scale,f=u.scale>f?u.scale:f,k=u.scale<k?u.scale:k);-Infinity===f||this._hasMin||this.setMinScale(f);Infinity===k||this._hasMax||this.setMaxScale(k);this.setExclusionAreas(this.exclusionAreas);
this._patchIE=6<=w("ie")&&7>w("ie")&&(this.isPNG32||"Mixed"===a.format)},isVisibleAtScale:function(a){return a?G.prototype._isMapAtVisibleScale.call(this,a,!0):!1},_isMapAtVisibleScale:function(a){var b=this.inherited(arguments,[a,!0]);if(b){var c;c=this._map;var b=this.scales,e=c.getScale(),f=!1,k=c.width>c.height?c.width:c.height;for(c=0;c<b.length;c++)if(Math.abs(b[c]-e)/b[c]<1/k){f=!0;break}b=f}return b},_setMap:function(a,b,e,k){this.inherited(arguments);this._map=a;var w=this._div=m.create("div",
null,b),q=a.__visibleDelta,u=g.connect,n=c._css.names,B={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},z=x.defaults.map.zoomDuration;"css-transforms"===a.navigationMode?(B[n.transform]=c._css.translate(-q.x,-q.y),f.set(w,B),delete B[n.transform],B[n.transition]=n.transformName+" "+z+"ms ease",f.set(this._active=m.create("div",null,w),B),this._active._remove=0,this._passives=[]):(B.left=-q.x+"px",B.top=-q.y+"px",f.set(w,B));this._onResizeHandler_connect=u(a,"onResize",
this,"_onResizeHandler");this._opacityChangeHandler_connect=u(this,"onOpacityChange",this,"_opacityChangeHandler");q=this.tileInfo;u=q.spatialReference;n=u._getInfo();(this._wrap=a.wrapAround180&&u._isWrappable()&&Math.abs(n.origin[0]-q.origin.x)<=n.dx)&&C._addFrameInfo(q,n);this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension();if(this.suspended&&!a.loaded)var p=g.connect(a,"onLoad",this,function(){g.disconnect(p);p=null;this.setExclusionAreas(this.exclusionAreas);this.evaluateSuspension()});
return w},_unsetMap:function(a,b){this.suspended||this._suspendImpl();m.destroy(this._div);this._map=this._div=null;var c=g.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._suspendImpl()},_suspendImpl:function(){q.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors();var a=this._tiles,b=this._tileIds,c=this._loadingList,e,f,k=g.disconnect,w=m.destroy;
c&&0<c.count&&(c.forEach(function(b){if(e=a[b])k(e._onload_connect),k(e._onerror_connect),k(e._onabort_connect),e._onload_connect=e._onerror_connect=e._onabort_connect=null}),c.clear(),this._fireUpdateEnd());this._removeList.clear();for(c=b.length-1;0<=c;c--)(e=(f=b[c])&&a[f])&&w(e);if("css-transforms"===this._map.navigationMode){b=this._active;f=this._passives;var x;this._noDom=0;for(c=f.length-1;0<=c;c--)x=f[c],x._endHandle&&k(x._endHandle),x._matrix=x._multiply=x._endHandle=null,x._marked=x._remove=
0,f.splice(c,1),w(x);b._matrix=b._multiply=null;b._marked=b._remove=0}this._tileIds=this._tiles=this._tileBounds=this._ct=this._loadingList=this._removeList=this._standby=null},onResume:function(){this.inherited(arguments);this._tileIds=[];this._tiles=[];this._tileBounds=[];this._ct=null;this._removeList=new b;this._loadingList=new b;q.show(this._div);this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(t.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,
null,!0,this._map.__LOD)}),0)},_enableDrawConnectors:function(){var a=this._map,b=g.connect;if("css-transforms"===a.navigationMode){if(this._onScaleHandler_connect=b(a,"onScale",this,this._onScaleHandler),w("esri-mobile")){this._standby=[];var c=this,e=function(){c._noDom=1};this._onPanStartHandler_connect=b(a,"onPanStart",e);this._onZoomStartHandler_connect=b(a,"onZoomStart",e)}}else this._onZoomHandler_connect=b(a,"onZoom",this,"_onZoomHandler");this._onPanHandler_connect=b(a,"onPan",this,"_onPanHandler");
this._onExtentChangeHandler_connect=b(a,"onExtentChange",this,"_onExtentChangeHandler")},_disableDrawConnectors:function(){var a=g.disconnect;a(this._onPanHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onPanStartHandler_connect);a(this._onZoomStartHandler_connect);this._onPanHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=this._onExtentChangeHandler_connect=this._onPanStartHandler_connect=this._onZoomStartHandler_connect=
null},_onResizeHandler:function(a,b,c){a={width:b+"px",height:c+"px"};b=f.set;b(this._div,a);if("css-transforms"===this._map.navigationMode)for(this._active&&b(this._active,a),c=this._passives.length-1;0<=c;c--)b(this._passives[c],a)},_onExtentChangeHandler:function(b,e,w,q){e=this._map;var x=this._standby,g;clearTimeout(this._wakeTimer);this._wakeTimer=null;if(!e._isPanningOrZooming()){if("css-transforms"===e.navigationMode){if(w)for(q=this._passives.length-1;0<=q;q--)g=this._passives[q],f.set(g,
c._css.names.transition,"none"),g._marked?(this._passives.splice(q,1),g.parentNode&&g.parentNode.removeChild(g),m.destroy(g)):0<g.childNodes.length&&(g._multiply=g._multiply?a.multiply(g._matrix,g._multiply):g._matrix);this._noDom=0;if(x&&x.length)for(q=x.length-1;0<=q;q--)g=x[q],f.set(g,"visibility","inherit"),this._popTile(g),x.splice(q,1)}this._fireUpdateStart();this._rrIndex=0;q=C.getCandidateTileInfo(e,this.tileInfo,b);b=e.__visibleDelta;if(!this._ct||q.lod.level!==this._ct.lod.level||w){g=q&&
this._ct&&q.lod.level!==this._ct.lod.level;this._ct=q;var u=this._tiles,n=this._tileIds,B=this._tileBounds,z=this._removeList,p,D=n.length;this._cleanUpRemovedImages();for(q=0;q<D;q++)x=n[q],p=u[x],B[x]=n[q]=null,"css-transforms"===e.navigationMode&&g&&p.parentNode&&e.fadeOnZoom&&(p._fadeOut=g,p.parentNode._remove++),z.add(p);w&&(this._tileIds=[],this._tiles=[],this._tileBounds=[])}q=b.x;w=b.y;"css-transforms"===e.navigationMode?(x={},x[c._css.names.transform]=c._css.translate(q,w),f.set(this._div,
x)):f.set(this._div,{left:q+"px",top:w+"px"});this.__coords_dx=q;this.__coords_dy=w;this._updateImages(new E(0,0,b.width,b.height));0===this._loadingList.count?(this._cleanUpRemovedImages(),this.onUpdate(),this._fireUpdateEnd()):this._fireOnUpdate=!0;w=this._tileW;u=this._tileH;b=new E(-b.x,-b.y,b.width,b.height);for(q=this._tileIds.length-1;0<=q;q--)(x=this._tileIds[q])?(g=this._tiles[x],n=k.getMarginBox(g),n=new E(n.l,n.t,w,u),"css-transforms"===e.navigationMode&&(n.x=g._left,n.y=g._top),b.intersects(n)?
this._tileBounds[x]=n:(this._loadingList.contains(x)&&this._popTile(g),m.destroy(g),this._tileIds.splice(q,1),delete this._tileBounds[x],delete this._tiles[x])):(this._tileIds.splice(q,1),delete this._tileBounds[x],delete this._tiles[x])}},_onPanHandler:function(a,b){a=this._map;b=a.__visibleDelta.offset(b.x,b.y);this.__coords_dx=this.__coords_dy=0;"css-transforms"===a.navigationMode?(a={},a[c._css.names.transform]=c._css.translate(b.x,b.y),f.set(this._div,a),w("esri-mobile")||this._updateImages({x:-b.x,
y:-b.y,width:b.width,height:b.height})):(f.set(this._div,{left:b.x+"px",top:b.y+"px"}),this._updateImages({x:-b.x,y:-b.y,width:b.width,height:b.height}));0<this._loadingList.count&&(this._fireUpdateStart(),this._fireOnUpdate=!0)},_onScaleHandler:function(b,e){var w,k={},q=c._css.names,g=this._map,u=x.defaults.map.zoomDuration;for(w=this._passives.length-1;0<=w;w--){var n=this._passives[w];0===n.childNodes.length?(this._passives.splice(w,1),m.destroy(n)):("none"===n.style[q.transition]&&f.set(n,q.transition,
q.transformName+" "+u+"ms ease"),f.set(n,q.transition,e?"none":q.transformName+" "+u+"ms ease"),n._matrix=b,k[q.transform]=c._css.matrix(n._multiply?a.multiply(b,n._multiply):b),f.set(n,k))}this._active&&0===this._active.childNodes.length||(f.set(this._active,q.transition,e?"none":q.transformName+" "+u+"ms ease"),this._active._matrix=b,k[q.transform]=c._css.matrix(this._active._matrix),f.set(this._active,k),this._passives.push(this._active),k={position:"absolute",width:g.width+"px",height:g.height+
"px",overflow:"visible"},k[q.transition]=q.transformName+" "+u+"ms ease",f.set(this._active=m.create("div",null,this._div),k),this._active._remove=0,g.fadeOnZoom&&m.place(this._active,this._div,"first"))},_onZoomHandler:function(a,b,c){a=k.getMarginBox(this._div);c=c.offset(-a.l,-a.t);this._previousScale&&1!==b||(this._previousScale=1);var e,q=this._tileW*b,x=this._tileH*b,m=this._tileBounds,g=this._tiles,n=this._previousScale,u=this._multiple,B=f.set,z,C;if((a=w("ie"))&&8>a)v.forEach(this._tileIds,
function(l){C="";e=m[l];z=g[l].style.margin.split(" ");v.forEach(z,function(d){""!==C&&(C+=" ");d=parseFloat(d);C+=d/n*b+"px"});B(g[l],{left:e.x-(q-e.width)*(c.x-e.x)/e.width+"px",top:e.y-(x-e.height)*(c.y-e.y)/e.height+"px",margin:1!==u&&-1===C.indexOf("NaN")?C:"",zoom:b})});else{var p=q*u,A=x*u,D,F;v.forEach(this._tileIds,function(l){C="";e=m[l];D=e.x-(q-e.width)*(c.x-e.x)/e.width;F=e.y-(x-e.height)*(c.y-e.y)/e.height;z=g[l].style.margin.split(" ");v.forEach(z,function(d){""!==C&&(C+=" ");d=parseFloat(d);
C+=d/n*b+"px"});B(g[l],{left:D+"px",top:F+"px",margin:1!==u&&-1===C.indexOf("NaN")?C:"",width:p+"px",height:A+"px"})})}this._previousScale=b},_updateImages:function(a){if(this._ct){var b,c=this._tileW,e=this._tileH,f=this._ct;b=f.lod;var f=f.tile,w=f.offsets,k=f.coords,q=k.row,k=k.col,x=b.level,m=this.opacity,g=this._tileIds,u=this._loadingList,n=this._addImage,B=this._map.id,A=this.id,z=a.x,C=a.y,l=b.startTileRow,d=b.endTileRow,h=b.startTileCol,r=b.endTileCol,y=v.indexOf,H,P,p=w.x-this.__coords_dx,
F=w.y-this.__coords_dy;P=c-p+-a.x;var E=e-F+-a.y;H=Math.ceil;P=0<P?P%c:c-Math.abs(P)%c;E=0<E?E%e:e-Math.abs(E)%e;z=0<z?Math.floor((z+p)/c):H((z-(c-p))/c);C=0<C?Math.floor((C+F)/e):H((C-(e-F))/e);F=z+H((a.width-P)/c);a=C+H((a.height-E)/e);var G,t,ma;this._wrap&&(G=b._frameInfo,t=G[0],ma=G[1],G=G[2]);for(E=z;E<=F;E++)for(z=C;z<=a;z++)H=q+z,P=k+E,this._wrap&&(P<ma?(P%=t,P=P<ma?P+t:P):P>G&&(P%=t)),!this._isExcluded(x,H,P)&&H>=l&&H<=d&&P>=h&&P<=r&&(b=B+"_"+A+"_tile_"+x+"_"+z+"_"+E,-1===y(g,b)&&(u.add(b),
g.push(b),n(x,z,H,E,P,b,c,e,m,f,w)))}},_cleanUpRemovedImages:function(){var a=this._removeList,b=m.destroy,e,w=c._css.names;a.forEach(function(a){a._fadeOut||(a.style.filter="",a.style.zoom=1,b(a))});if("css-transforms"===this._map.navigationMode)for(e=this._passives.length-1;0<=e;e--){var k=this._passives[e];0===k.childNodes.length?(this._passives.splice(e,1),b(k)):this._map.fadeOnZoom&&!k._marked&&k._remove===k.childNodes.length&&(k._marked=1,2048>c._css.getScaleFromMatrix(f.get(k,w.transform))?
(f.set(k,w.transition,"opacity 0.65s"),f.set(k,"opacity",0),g.disconnect(k._endHandle),k._endHandle=g.connect(k,w.endEvent,this._transitionEnd)):this._transitionEnd({propertyName:"opacity",target:k}))}a.clear()},_transitionEnd:function(a){var b=a.target;"opacity"===a.propertyName&&(g.disconnect(b._endHandle),b._endHandle=null,a=v.indexOf(this._passives,b),-1<a&&this._passives.splice(a,1),b.parentNode&&b.parentNode.removeChild(b),m.destroy(b))},_addImage:function(a,b,e,k,w,q,x,n,B,z,C){if(this._patchIE)z=
this._tiles[q]=m.create("div"),z.id=q,u.add(z,"layerTile"),f.set(z,{left:x*k-C.x+"px",top:n*b-C.y+"px",width:x+"px",height:n+"px",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this.getTileUrl(a,e,w)+"', sizingMethod\x3d'scale')"}),1>B&&f.set(z,"opacity",B),a=z.appendChild(m.create("div")),f.set(a,{opacity:0,width:x+"px",height:n+"px"}),this._div.appendChild(z),z=null,this._loadingList.remove(q),this._fireOnUpdateEvent();else{z=this._tiles[q]=m.create("img");var p=g.connect;
z.id=q;z._uid=a+"_"+e+"_"+w;z.alt="";u.add(z,"layerTile");k=x*k-C.x;C=n*b-C.y;b=this._map;var F=c._css.names;x={width:x+"px",height:n+"px",visibility:"hidden"};"css-transforms"===b.navigationMode?(x[F.transform]=c._css.translate(k,C),f.set(z,x),z._left=k,z._top=C):(x.left=k+"px",x.top=C+"px",f.set(z,x));1>B&&f.set(z,"opacity",B);z._onload_connect=p(z,"onload",this,"_tileLoadHandler");z._onerror_connect=p(z,"onerror",t.hitch(this,"_tileErrorHandler",e,w));z._onabort_connect=p(z,"onabort",this,"_tileAbortHandler");
if(this.tileMap)this.tileMap.getTile(a,e,w,q,this._tileMapCallback);else if(q=this.getTileUrl(a,e,w,z))this._failedRequests&&this._failedRequests[q]?(f.set(z,this._failedRequests[q].css),z.src=this._failedRequests[q].src,this._multiple=parseInt(this._failedRequests[q].css.width)/this._tileW,this.isResampling=1!==this._multiple):(this._multiple=1,this.isResampling=!1,z.src=q);"css-transforms"===b.navigationMode?this._active.appendChild(z):this._div.appendChild(z);z=null}},_tileMapCallback:function(a,
b){var c;if(!this.suspended){c=this._tiles[b.id]||e.byId(b.id);var k=b.level+"_"+b.row+"_"+b.col;c&&c._uid===k?(this._multiple=2*(b.level-a.level)||1,this.isResampling=1!==this._multiple,b=this.tileMap.style(a,b),f.set(c,b),c.src=this.getTileUrl(a.level,a.row,a.col)):this._popTile(b)}},getTileUrl:function(a,b,c){},_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,addTimestampToURL:function(a){var b=this._refreshTS;b&&(a=this._reCheckTS.test(a)?a.replace(this._reReplaceTS,"$$$1"+b):a+((-1===
a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b));return a},refresh:function(){this.suspended||(this._refreshTS=(new Date).getTime(),this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD))},_popTile:function(a){var b=g.disconnect;b(a._onload_connect);b(a._onerror_connect);b(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null;this._loadingList.remove(a.id);this._fireOnUpdateEvent()},_tileLoadHandler:function(a){a=a.currentTarget;this._noDom?this._standby.push(a):
(f.set(a,"visibility","inherit"),this._popTile(a))},_tileAbortHandler:function(a){a=a.currentTarget;this.onError(Error("Unable to load tile: "+a.src));f.set(a,"visibility","hidden");this._popTile(a)},_tileErrorHandler:function(a,b,c){c=c.currentTarget;var e,k,w=!0;if(this.tileMap||!this.resampling)w=!1;else if(e=new n(c.src),e=e.path.split("/"),e=parseInt(e[e.length-3]),k=this._ct.lod.level-e+1,this._multiple=Math.pow(2,k),e===this._lowestLevel||0===this._resamplingTolerance||this._resamplingTolerance&&
Math.log(this._multiple)/Math.LN2>this._resamplingTolerance)w=!1;w?(this.isResampling=!0,this._resample(c,a,b)):(this.onError(Error("Unable to load tile: "+c.src)),f.set(c,"visibility","hidden"),this._popTile(c))},_resample:function(a,b,c){var e=(new n(a.src)).path.split("/"),k=this._multiple,q=parseInt(e[e.length-3])-1,x=parseInt(b/k),m=parseInt(c/k),e=c%k,g=b%k,x=this.getTileUrl(q,x,m);b=this.getTileUrl(q+Math.log(k)/Math.LN2,b,c);k={width:this._tileW*k+"px",height:this._tileH*k+"px",margin:"-"+
this._tileW*g+"px 0 0 "+("-"+this._tileH*e+"px")};this._failedRequests||(this._failedRequests={});this._failedRequests[b]={src:x,css:k};f.set(a,k);w("chrome")&&a.setAttribute("src",null);a.src=x},_fireOnUpdateEvent:function(){0===this._loadingList.count&&(this._cleanUpRemovedImages(),this._fireOnUpdate&&(this._fireOnUpdate=!1,this.onUpdate(),this._fireUpdateEnd()))},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=
f.set,c,e,k;if("css-transforms"===this._map.navigationMode){if(this._active)for(k=this._active.childNodes,c=k.length-1;0<=c;c--)b(k[c],"opacity",a);for(c=this._passives.length-1;0<=c;c--)for(k=this._passives[c].childNodes,e=k.length-1;0<=e;e--)b(k[e],"opacity",a)}else for(k=this._div.childNodes,c=k.length-1;0<=c;c--)b(k[c],"opacity",a)},setExclusionAreas:function(a){this.exclusionAreas=a;if(this.loaded&&this._map&&this._map.loaded){var b=this._map.spatialReference,c=this.tileInfo,e=c.origin,f=c.lods,
k=f[0].level,w=f[f.length-1].level,q,x,m,g,n,u,C,A,p;if(this.exclusionAreas&&this.exclusionAreas.length)for(this._exclusionsPerZoom=[],x=0,m=a.length;x<m;x++){if(q=a[x],(p=q.geometry)&&"extent"===p.type&&p.xmin<=p.xmax&&p.ymin<=p.ymax){if(!b.equals(p.spatialReference))if(b._canProject(p.spatialReference))b.isWebMercator()?(A=z.lngLatToXY(p.xmin,p.ymin),p=z.lngLatToXY(p.xmax,p.ymax)):(A=z.xyToLngLat(p.xmin,p.ymin,!0),p=z.xyToLngLat(p.xmax,p.ymax,!0)),p=new B(A[0],A[1],p[0],p[1],b);else continue;C=
-1;if(q.minZoom&&-1!==q.minZoom)C=q.minZoom;else if(q.minScale&&-1!==q.minScale)for(g=0,n=f.length;g<n;g++)if(f[g].scale<=q.minScale){C=f[g].level;break}C=Math.max(C,k);A=-1;if(q.maxZoom&&-1!==q.maxZoom)A=q.maxZoom;else if(q.maxScale&&-1!==q.maxScale)for(g=0,n=f.length;g<n;g++)if(f[g].scale<q.maxScale){A=f[g-1].level;break}else if(f[g].scale===q.maxScale){A=f[g].level;break}A=-1===A?w:Math.min(A,w);for(q=C;q<=A;q++){g=0;for(n=f.length;g<n;g++)if(f[g].level===q){u=f[g];break}u&&(this._exclusionsPerZoom[q]||
(this._exclusionsPerZoom[q]=[]),g=1/u.resolution/c.rows,n=1/u.resolution/c.cols,this._exclusionsPerZoom[q].push({rowFrom:Math.floor((e.y-p.ymax)*g),rowTo:Math.ceil((e.y-p.ymin)*g),colFrom:Math.floor((p.xmin-e.x)*n),colTo:Math.ceil((p.xmax-e.x)*n)}))}}}else this._exclusionsPerZoom=null;this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0,this._map.__LOD)}},_isExcluded:function(a,b,c){var e,f,k;if(!this._exclusionsPerZoom)return!1;e=this._exclusionsPerZoom[a];if(!e)return!1;f=0;for(k=
e.length;f<k;f++)if(a=e[f],b>=a.rowFrom&&b<a.rowTo&&c>=a.colFrom&&c<a.colTo)return!0;return!1}})})},"dojox/collections/ArrayList":function(){define(["dojo/_base/kernel","dojo/_base/array","./_base"],function(p,g,t){t.ArrayList=function(g){var n=[];g&&(n=n.concat(g));this.count=n.length;this.add=function(m){n.push(m);this.count=n.length};this.addRange=function(m){if(m.getIterator)for(m=m.getIterator();!m.atEnd();)this.add(m.get());else for(var g=0;g<m.length;g++)n.push(m[g]);this.count=n.length};this.clear=
function(){n.splice(0,n.length);this.count=0};this.clone=function(){return new t.ArrayList(n)};this.contains=function(m){for(var g=0;g<n.length;g++)if(n[g]==m)return!0;return!1};this.forEach=function(m,g){p.forEach(n,m,g)};this.getIterator=function(){return new t.Iterator(n)};this.indexOf=function(m){for(var g=0;g<n.length;g++)if(n[g]==m)return g;return-1};this.insert=function(m,g){n.splice(m,0,g);this.count=n.length};this.item=function(m){return n[m]};this.remove=function(m){m=this.indexOf(m);0<=
m&&n.splice(m,1);this.count=n.length};this.removeAt=function(m){n.splice(m,1);this.count=n.length};this.reverse=function(){n.reverse()};this.sort=function(m){m?n.sort(m):n.sort()};this.setByIndex=function(m,g){n[m]=g;this.count=n.length};this.toArray=function(){return[].concat(n)};this.toString=function(m){return n.join(m||",")}};return t.ArrayList})},"dojox/collections/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array"],function(p,g,t){p=g.getObject("dojox.collections",
!0);p.DictionaryEntry=function(g,n){this.key=g;this.value=n;this.valueOf=function(){return this.value};this.toString=function(){return String(this.value)}};p.Iterator=function(g){var n=0;this.element=g[n]||null;this.atEnd=function(){return n>=g.length};this.get=function(){return this.atEnd()?null:this.element=g[n++]};this.map=function(m,n){return t.map(g,m,n)};this.reset=function(){n=0;this.element=g[n]}};p.DictionaryIterator=function(g){var n=[],m={},u;for(u in g)m[u]||n.push(g[u]);var k=0;this.element=
n[k]||null;this.atEnd=function(){return k>=n.length};this.get=function(){return this.atEnd()?null:this.element=n[k++]};this.map=function(f,e){return t.map(n,f,e)};this.reset=function(){k=0;this.element=n[k]}};return p})},"esri/layers/ArcGISMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(p,g,t,v,n,m,u,k,f,e){return p(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",
infoTemplates:null,constructor:function(b,a){this.layerInfos=[];a&&(this.infoTemplates=a.infoTemplates||null);b=this._params={};if(a=this._url.query?this._url.query.token:null)b.token=a},setInfoTemplates:function(b){this.infoTemplates=b},_load:function(){u({url:this._url.path,content:g.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(b,
a){try{this._findCredential();(this.credential&&this.credential.ssl||b&&b._ssl)&&this._useSSL();this.description=b.description;this.copyright=b.copyrightText;this.spatialReference=b.spatialReference&&new k(b.spatialReference);this.initialExtent=b.initialExtent&&new f(b.initialExtent);this.fullExtent=b.fullExtent&&new f(b.fullExtent);this.units=b.units;this.maxRecordCount=b.maxRecordCount;this.maxImageHeight=b.maxImageHeight;this.maxImageWidth=b.maxImageWidth;this.supportsDynamicLayers=b.supportsDynamicLayers;
var c=this.layerInfos=[],x=b.layers,w=this._defaultVisibleLayers=[];t.forEach(x,function(a,b){c[b]=new e(a);a.defaultVisibility&&w.push(a.id)});this.visibleLayers||(this.visibleLayers=w);this.version=b.currentVersion;this.cimVersion=b.cimVersion;this.version||(this.version="capabilities"in b||"tables"in b?10:"supportedImageFormatTypes"in b?9.31:9.3);this.capabilities=b.capabilities;m.isDefined(b.minScale)&&!this._hasMin&&this.setMinScale(b.minScale);m.isDefined(b.maxScale)&&!this._hasMax&&this.setMaxScale(b.maxScale)}catch(q){this._errorHandler(q)}}})})},
"esri/layers/LayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.layers.LayerInfo",constructor:function(m){g.mixin(this,m)},toJson:function(){return n.fixJson({defaultVisibility:this.defaultVisibility,id:this.id,maxScale:this.maxScale,minScale:this.minScale,name:this.name,parentLayerId:this.parentLayerId,subLayerIds:this.subLayerIds})}})})},"esri/layers/TimeInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../TimeExtent ./TimeReference ./LayerTimeOptions".split(" "),
function(p,g,t,v,n,m,u){p=p(null,{declaredClass:"esri.layers.TimeInfo",constructor:function(k){null!==k&&(g.mixin(this,k),k.exportOptions&&(this.exportOptions=new u(k.exportOptions)),this.timeExtent=null,k.timeExtent&&2===k.timeExtent.length&&(this.timeExtent=new n(k.timeExtent)),this.timeReference=new m(k.timeReference))}});g.mixin(p,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",
UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});return p})},"esri/TimeExtent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel"],function(p,g,t,v){var n=p(null,{declaredClass:"esri.TimeExtent",constructor:function(m){if(1<arguments.length)this._create(arguments[0],arguments[1]);else if(m)if(g.isArray(m)){var n=
m[0],k=m[1];this.startTime=null===n||"null"===n?null:new Date(n);this.endTime=null===k||"null"===k?null:new Date(k)}else m instanceof Date&&this._create(m,null)},offset:function(m,g){var k=new n,f=this.startTime,e=this.endTime;f&&(k.startTime=this._getOffsettedDate(f,m,g));e&&(k.endTime=this._getOffsettedDate(e,m,g));return k},intersection:function(m){return this._intersection(this,m)},toJson:function(){var m=[],g=this.startTime;m.push(g?g.getTime():"null");g=this.endTime;m.push(g?g.getTime():"null");
return m},_create:function(m,g){this.startTime=m?new Date(m.getTime()):null;this.endTime=g?new Date(g.getTime()):null},_refData:{esriTimeUnitsMilliseconds:{getter:"getUTCMilliseconds",setter:"setUTCMilliseconds",multiplier:1},esriTimeUnitsSeconds:{getter:"getUTCSeconds",setter:"setUTCSeconds",multiplier:1},esriTimeUnitsMinutes:{getter:"getUTCMinutes",setter:"setUTCMinutes",multiplier:1},esriTimeUnitsHours:{getter:"getUTCHours",setter:"setUTCHours",multiplier:1},esriTimeUnitsDays:{getter:"getUTCDate",
setter:"setUTCDate",multiplier:1},esriTimeUnitsWeeks:{getter:"getUTCDate",setter:"setUTCDate",multiplier:7},esriTimeUnitsMonths:{getter:"getUTCMonth",setter:"setUTCMonth",multiplier:1},esriTimeUnitsYears:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:1},esriTimeUnitsDecades:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:10},esriTimeUnitsCenturies:{getter:"getUTCFullYear",setter:"setUTCFullYear",multiplier:100}},_intersection:function(m,g){if(m&&g){var k=m.startTime;m=m.endTime;
var f=g.startTime;g=g.endTime;k=k?k.getTime():-Infinity;f=f?f.getTime():-Infinity;m=m?m.getTime():Infinity;g=g?g.getTime():Infinity;var e,b;f>=k&&f<=m?e=f:k>=f&&k<=g&&(e=k);m>=f&&m<=g?b=m:g>=k&&g<=m&&(b=g);if(isNaN(e)||isNaN(b))return null;k=new n;k.startTime=-Infinity===e?null:new Date(e);k.endTime=Infinity===b?null:new Date(b);return k}return null},_getOffsettedDate:function(m,g,k){var f=this._refData;m=new Date(m.getTime());g&&k&&(f=f[k],m[f.setter](m[f.getter]()+g*f.multiplier));return m}});return n})},
"esri/layers/TimeReference":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p(null,{declaredClass:"esri.layers.TimeReference",constructor:function(n){n&&g.mixin(this,n)}})})},"esri/layers/LayerTimeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.layers.LayerTimeOptions",constructor:function(m){m&&g.mixin(this,m)},toJson:function(){return n.fixJson({timeDataCumulative:this.timeDataCumulative,
timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime})}})})},"esri/layers/TileMap":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/io-query ../request ../urlUtils ../sniff".split(" "),function(p,g,t,v,n,m,u,k){var f=k("esri-iphone");return p(null,{declaredClass:"esri.layers.TileMap",constructor:function(e){this.layer=e;this._tileMaps={}},getTile:function(e,b,a,c,f){e={id:c,level:e,row:b,col:a};b=this._getResamplingBudget();
0<b?this._process({tile:e,requestedTile:e,callback:f,resamplingBudget:b}):(f||this.callback).call(this,e,e)},statusOf:function(e,b,a){var c=this._getResamplingBudget();e={level:e,row:b,col:a};if(0===c)return 1;for(;0<=c;){b=this._tileToTileMap(e);if(!this._tileMaps[b.uid])return-1;b=this._tileMaps[b.uid];if(!b.promise.isFulfilled())return-1;if(this._isTileAvailable(e,b))return 1;e=this._parentTile(e);if(!e)break;c--}return 0},style:function(e,b){if(e.level!==b.level||e.row!==b.row||e.col!==b.col){for(var a=
this.layer.tileInfo,c=a.lods,k=a.cols,a=a.rows,w,q,m=c.length-1;!w||!q;)w||c[m].level!==e.level||(w=c[m]),q||c[m].level!==b.level||(q=c[m]),m--;c=Math.round(w.resolution/q.resolution);e=b.col%c*-1*k;b=b.row%c*-1*a;c={width:k*c+"px",height:a*c+"px",margin:b+"px 0 0 "+e+"px","will-change":"transform"};f&&(e=0===e?0:-1*e,b=0===b?0:-1*b,c.clip="rect("+b+"px,"+(e+k)+"px,"+(b+a)+"px,"+e+"px)");return c}},_process:function(e){var b=e.tile,a=this._tileToTileMap(b),c=this._parentTile(b);this._getTileMap(a).then(g.hitch(this,
function(f){a=f;this._isTileAvailable(b,a)?(e.callback||this.callback).call(this,b,e.requestedTile):0<e.resamplingBudget&&c?(e.resamplingBudget--,e.tile=c,this._process(e)):(e.callback||this.callback).call(this,e.requestedTile,e.requestedTile)}),g.hitch(this,function(){(e.callback||this.callback).call(this,e.requestedTile,e.requestedTile)}))},_getTileMap:function(e){var b,a,c,f,k=null;this._tileMaps[e.uid]?(e=this._tileMaps[e.uid],b=e.promise):(this._tileMaps[e.uid]=e,a=new v,m({url:this._getTileMapUrl(e.level,
e.row,e.col),handleAs:"json",content:{f:"json"},callbackParamName:"callback",timeout:3E3,load:function(b){g.mixin(e,b);if(e.data&&0<e.data.length){f=e.data.length;if(1===f)k=e.data[0];else for(k=e.data[0],c=1;c<f;c++)if(e.data[c]!==k){k=null;break}null!==k&&(delete e.data,e.value=k);null==e.valid&&(e.valid=!0)}a.resolve(e)},error:function(b){b&&422===b.code?(g.mixin(e,{location:{top:e.row,left:e.col,width:8,height:8},valid:!0,value:0}),a.resolve(e)):a.reject()}}),b=e.promise=a.promise);return b},
_parentTile:function(e){var b=this.layer.tileInfo.lods,a,c,f=null;t.some(b,function(b,f){return e.level===b.level?(a=b,c=f,!0):!1});0<c&&(b=b[c-1],f={id:e.id,level:b.level,row:Math.floor(e.row*a.resolution/b.resolution+.01),col:Math.floor(e.col*a.resolution/b.resolution+.01)});return f},_tileToTileMap:function(e){var b=8*Math.floor(e.row/8),a=8*Math.floor(e.col/8);return{uid:e.level+"_"+b+"_"+a,level:e.level,row:b,col:a}},_isTileAvailable:function(e,b){var a,c;b.valid?void 0!==b.value?e=b.value:(a=
b.location.left,c=b.location.top,e=(e.row-c)*b.location.width+(e.col-a),e=e<b.data.length?b.data[e]:0):e=0;return e},_getTileMapUrl:function(e,b,a){var c=this.layer,f=c.tileServers,k=c._getToken(),q=c._url.query;e=(f?f[b%f.length]:c._url.path)+"/tilemap/"+e+"/"+b+"/"+a+"/8/8";q&&(e+="?"+n.objectToQuery(q));!k||q&&q.token||(e+=(-1===e.indexOf("?")?"?":"\x26")+"token\x3d"+k);return e=c.addTimestampToURL(e)},_getResamplingBudget:function(){var e=this.layer,b=0;e.resampling&&(b=e._resamplingTolerance,
null===b||void 0===b)&&(b=e.tileInfo.lods.length);return b}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){var x=p([c],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(a){this.inherited(arguments,[null,
a]);this._mapImages=[];var b=t.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);g.connect(this,"onSuspend",this,this._onSuspend);g.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var b=this._mapImages.push(a),b=b-1;a._idx=b;a._layer=this;
this._div&&this._createImage(a,b)},removeImage:function(a){if(a){var b=a._idx,c=this._mapImages;if(c[b]===a){delete c[b];if(b=a._node)this._clearEvents(b),b.e_idx=b.e_bl=b.e_tr=b.e_l=b.e_t=b.e_w=b.e_h=null,b.parentNode&&(b.parentNode.removeChild(b),n.destroy(b));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,b,c=a.length;for(b=0;b<c;b++){var e=a[b];e&&this.removeImage(e)}this._mapImages=[]},getImages:function(){var a=this._mapImages,b=[],c,e=a.length;for(c=0;c<e;c++)a[c]&&
b.push(a[c]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var b=this._div,c,e;if(b)if(!f("ie")||8<f("ie"))m.set(b,"opacity",a);else for(e=b.childNodes,c=e.length,b=0;b<c;b++)m.set(e[b],"opacity",a)},_createImage:function(a,b){var c=n.create("img");m.set(c,{position:"absolute"});1>a.opacity?m.set(c,"opacity",a.opacity):8>=f("ie")&&m.set(c,"opacity",this.opacity);!a.rotation||
9>f("ie")||m.set(c,u._css.names.transform,u._css.rotate(360-a.rotation));a._node=c;c.e_idx=b;c.e_layer=this;c.e_load=g.connect(c,"onload",x.prototype._imageLoaded);c.e_error=g.connect(c,"onerror",x.prototype._imageError);c.e_abort=g.connect(c,"onabort",x.prototype._imageError);c.src=a.href},_imageLoaded:function(a,b){a=b||a.target||a.currentTarget;b=a.e_layer;var c=b._mapImages[a.e_idx],e=b._map;e&&(e.__zooming||e.__panning||!b._sr)?b._standby.push(a):(b._clearEvents(a),c&&c._node===a&&e&&b._attach(c))},
_imageError:function(a){a=a.target||a.currentTarget;var b=a.e_layer,c=b._mapImages[a.e_idx];b._clearEvents(a);c&&(c._node=null)},_clearEvents:function(a){var b=g.disconnect;b(a.e_load);b(a.e_error);b(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(c){var e=c.extent,f=e.spatialReference,k=this._sr,w=this._div,x=c._node,m=new b({x:e.xmin,y:e.ymin,spatialReference:f}),e=new b({x:e.xmax,y:e.ymax,spatialReference:f});k.equals(f)||(k.isWebMercator()&&4326===f.wkid?(m=a.geographicToWebMercator(m),
e=a.geographicToWebMercator(e)):f.isWebMercator()&&4326===k.wkid&&(m=a.webMercatorToGeographic(m),e=a.webMercatorToGeographic(e)));x.e_bl=m;x.e_tr=e;c.visible&&(this._setPos(x,w._left,w._top),(this._active||w).appendChild(x))},_setPos:function(a,b,c){var e=a.e_bl,f=a.e_tr,k=this._map,e=k.toScreen(e),f=k.toScreen(f);b=e.x-b;c=f.y-c;var q=Math.abs(f.x-e.x),e=Math.abs(e.y-f.y),f={width:q+"px",height:e+"px"},w=this._mapImages[a.e_idx];"css-transforms"===k.navigationMode?f[u._css.names.transform]=u._css.translate(b,
c)+(w.rotation?" "+u._css.rotate(360-w.rotation):""):(f.left=b+"px",f.top=c+"px");m.set(a,f);a.e_l=b;a.e_t=c;a.e_w=q;a.e_h=e},managedSuspension:!0,_setMap:function(a,b){this.inherited(arguments);var c=this._div=n.create("div",null,b),k=u._css.names,q={position:"absolute"},w=a.__visibleDelta;if(!f("ie")||8<f("ie"))q.opacity=this.opacity;"css-transforms"===a.navigationMode?(q[k.transform]=u._css.translate(w.x,w.y),m.set(c,q),c._left=w.x,c._top=w.y,q={position:"absolute",width:a.width+"px",height:a.height+
"px",overflow:"visible"},this._active=n.create("div",null,c),m.set(this._active,q),this._passive=n.create("div",null,c),m.set(this._passive,q)):(c._left=0,c._top=0,m.set(c,q));this._standby=[];k=this._mapImages;w=k.length;for(q=0;q<w;q++){var x=k[q];x._node||this._createImage(x,x._idx)}e.hide(c);return c},_unsetMap:function(a,b){this._disconnect();var c=this._div;if(c){var e=this._mapImages,f,k=e.length;for(f=0;f<k;f++){var q=e[f];if(q){var w=q._node;w&&(this._clearEvents(w),w.e_idx=w.e_bl=w.e_tr=
w.e_l=w.e_t=w.e_w=w.e_h=null);q._node=null}}b.removeChild(c);n.destroy(c)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();e.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());a=this._map;var b=this._div,c=a.__visibleDelta;"css-transforms"===a.navigationMode&&(b._left=c.x,b._top=c.y,m.set(b,u._css.names.transform,u._css.translate(b._left,
b._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);e.show(b)},_connect:function(a){if(!this._connections){var b=g.connect,c="css-transforms"===a.navigationMode;this._connections=[b(a,"onPanStart",this._panStart),b(a,"onPan",this._pan),b(a,"onExtentChange",this._extentChange),c&&b(a,"onZoomStart",this._zoomStart),c?b(a,"onScale",this._scale):b(a,"onZoom",this._zoom),c&&b(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(v.forEach(this._connections,g.disconnect),
this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,b){a=this._div;a._left=this._panL+b.x;a._top=this._panT+b.y;"css-transforms"===this._map.navigationMode?m.set(a,u._css.names.transform,u._css.translate(a._left,a._top)):m.set(a,{left:a._left+"px",top:a._top+"px"})},_extentChange:function(a,b,c){c?this._redraw("css-transforms"===this._map.navigationMode):b&&this._pan(a,b);this._processStandbyList()},_processStandbyList:function(){var a,
b=this._standby;if(b&&b.length)for(a=b.length-1;0<=a;a--)this._imageLoaded(null,b[a]),b.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var b=u._css.names;m.set(a,b.transition,"none");this._moveImages(a,this._active);m.set(a,b.transform,"none")}a=this._active||this._div;var b=this._div._left,c=this._div._top,e,f=a.childNodes.length,k;for(e=0;e<f;e++)k=a.childNodes[e],this._setPos(k,b,c)},_zoom:function(a,b,c){a=this._div;var e=a._left,f=a._top,k,q=a.childNodes.length,w;for(k=0;k<q;k++){w=a.childNodes[k];
var x=w.e_w*b,g=w.e_h*b,n=(c.x-e-w.e_l)*(x-w.e_w)/w.e_w,u=(c.y-f-w.e_t)*(g-w.e_h)/w.e_h,n=isNaN(n)?0:n,u=isNaN(u)?0:u;m.set(w,{left:w.e_l-n+"px",top:w.e_t-u+"px",width:x+"px",height:g+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,b){a=a.childNodes;var c;c=a.length;if(0<c)for(--c;0<=c;c--)b.appendChild(a[c])},_scale:function(a,b){var c=u._css.names,e=this._passive;m.set(e,c.transition,b?"none":c.transformName+" "+k.defaults.map.zoomDuration+"ms ease");
({})[c.transform]=u._css.matrix(a);m.set(e,c.transform,u._css.matrix(a))},_resize:function(a,b,c){m.set(this._active,{width:b+"px",height:c+"px"});m.set(this._passive,{width:b+"px",height:c+"px"})}});return x})},"esri/layers/OpenStreetMapLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../urlUtils ../SpatialReference ../geometry/Extent ./TiledMapServiceLayer ./TileInfo".split(" "),function(p,g,t,v,n,m,u,k,f){return p(k,{declaredClass:"esri.layers.OpenStreetMapLayer",
constructor:function(e){this.spatialReference=new m({wkid:102100});this.tileInfo=new f({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-2.0037508342787E7,y:2.0037508342787E7},spatialReference:{wkid:102100},lods:[{level:0,scale:5.91657527591555E8,resolution:156543.033928},{level:1,scale:2.95828763795777E8,resolution:78271.5169639999},{level:2,scale:1.47914381897889E8,resolution:39135.7584820001},{level:3,scale:7.3957190948944E7,resolution:19567.8792409999},{level:4,scale:3.6978595474472E7,
resolution:9783.93962049996},{level:5,scale:1.8489297737236E7,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},
{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:.597164283559817},{level:19,scale:1128.497176,resolution:.298582141647617}]});this.fullExtent=new u({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,
spatialReference:{wkid:102100}});this.initialExtent=new u({xmin:-2.003750834E7,ymin:-2.003750834E7,xmax:2.003750834E7,ymax:2.003750834E7,spatialReference:{wkid:102100}});this.tileServers=e&&e.tileServers||["//a.tile.openstreetmap.org","//b.tile.openstreetmap.org","//c.tile.openstreetmap.org"];this.serversLength=this.tileServers.length;this._displayLevels=e?e.displayLevels:null;this.copyright=e&&e.copyright||"Map data \u00a9 OpenStreetMap contributors, CC-BY-SA";this.loaded=!0;this.onLoad(this);(e=
e&&e.loadCallback)&&e(this)},getTileUrl:function(e,b,a){e=this.tileServers[b%this.serversLength]+"/"+e+"/"+a+"/"+b+".png";e=n.normalize(e);e=this.addTimestampToURL(e);return n.addProxy(e)}})})},"esri/layers/VectorTileLayer":function(){(function(){var p=function(){var g;try{g=window.WebGLRenderingContext}catch(f){g=!1}var p;try{for(var n=document.createElement("canvas"),m=["webgl","experimental-webgl","webkit-3d","moz-webgl"],u=null,k=0;k<m.length;++k){try{u=n.getContext(m[k])}catch(f){}if(u)break}p=
u}catch(f){p=!1}return g&&p?!0:!1}(),g=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];p&&g.push("./VectorTileLayerImpl");define(g,function(g,v,n,m,u,k){v=k?k:u.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var f=new n;f.reject(Error("esri.layers.VectorTileLayer is not supported"));f.promise.otherwise(g.hitch(this,function(e){this._errorHandler(e)}))}});v.ACCESS_TOKEN=null;v.supported=function(){return p};return v})})()},"esri/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/window dojo/Stateful dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dijit/registry ../kernel ../lang ../domUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/normalizeUtils ../InfoWindowBase ../PopupBase dojo/i18n!../nls/jsapi dojo/NodeList-dom require require".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J){return p([I,K,k],{declaredClass:"esri.dijit.Popup",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:25,marginTop:25,highlight:!0,pagingControls:!0,pagingInfo:!0,keepHighlightOnHide:!1,popupWindow:!0,titleInBody:!0,anchor:"auto",visibleWhenEmpty:!0,hideDelay:1E3,location:null,constructor:function(c,f){this.initialize();g.mixin(this,c);this.domNode=e.byId(f);f=this._nls=g.mixin({},J.widgets.popup);c=this.domNode;a.add(c,"esriPopup");(this._isRTL=
!x.isBodyLtr())&&w.set(c,"direction","rtl");b.set(c,"innerHTML","\x3cdiv class\x3d'esriPopupWrapper' style\x3d'position: absolute;'\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden' title\x3d'"+f.NLS_searching+"...'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton prev hidden' title\x3d'"+f.NLS_prevFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden' title\x3d'"+f.NLS_nextFeature+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton maximize' title\x3d'"+
f.NLS_maximize+"'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close' title\x3d'"+f.NLS_close+"'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer content'\x3e\x3cdiv class\x3d'contentPane'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'actionsPane'\x3e\x3cdiv class\x3d'actionList hidden'\x3e\x3ca title\x3d'"+f.NLS_zoomTo+"' class\x3d'action zoomTo' href\x3d'javascript:void(0);'\x3e\x3cspan\x3e"+f.NLS_zoomTo+"\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'outerPointer hidden'\x3e\x3c/div\x3e");
this._sizers=n.query(".sizer",c);f=n.query(".titlePane",c)[0];this._title=n.query(".title",f)[0];this._prevFeatureButton=n.query(".prev",f)[0];this._nextFeatureButton=n.query(".next",f)[0];this._maxButton=n.query(".maximize",f)[0];this._spinner=n.query(".spinner",f)[0];this._contentPane=n.query(".contentPane",c)[0];this._positioner=n.query(".esriPopupWrapper",c)[0];this._pointer=n.query(".pointer",c)[0];this._outerPointer=n.query(".outerPointer",c)[0];this._actionList=n.query(".actionsPane .actionList",
c)[0];this._contentUpdateHandles={};this._eventConnections=[v.connect(n.query(".close",f)[0],"onclick",this,this.hide),v.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),v.connect(this._nextFeatureButton,"onclick",this,this.selectNext),v.connect(this._maxButton,"onclick",this,this._toggleSize),v.connect(n.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature),v.connect(this,"onClearFeatures",this,this._featuresCleared),v.connect(this,"onSelectionChange",this,this._featureSelected),
v.connect(this,"onDfdComplete",this,this._updateUI)];m("esri-touch")&&(c=E.setScrollable(this._contentPane),this._eventConnections.push(c[0],c[1]));this._toggleVisibility(!1)},onMaximize:function(){},onRestore:function(){},setMap:function(a){this.inherited(arguments);c.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a);this._maxHeight=w.get(this._contentPane,"maxHeight")},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a){this.popupWindow&&
(z.isDefined(a)&&""!==a||(a="\x26nbsp;"),this.destroyDijits(this._title),this.place(a,this._title),this.isShowing&&(this.startupDijits(this._title),this.reposition()))},setContent:function(a){this.popupWindow&&(z.isDefined(a)&&""!==a||(a="\x26nbsp;"),this._destroyContent(),this.place(a,this._contentPane),this.isShowing&&(this._startupContent(),this.reposition()))},show:function(a,b){if(this.popupWindow)if(this._delayHide=!1,a){var c=this.map;a.spatialReference?(this.location=a,a=c.toScreen(a)):this.location=
c.toMap(a);var e=c._getFrameWidth();if(-1!==e&&(a.x%=e,0>a.x&&(a.x+=e),c.width>e))for(c=(c.width-e)/2;a.x<c;)a.x+=e;this._maximized?this.restore():this._setPosition(a);b&&b.closestFirst&&this.showClosestFirst(this.location);this.isShowing||(this._toggleVisibility(!0),this._followMap(),this.startupDijits(this._title),this._startupContent(),this.reposition(),this.showHighlight(),this.onShow())}else this._toggleVisibility(!0)},hide:function(){this.isShowing&&(this._toggleVisibility(!1),this._unfollowMap(),
this.keepHighlightOnHide||this.hideHighlight(),this.onHide())},resize:function(a,b){this.popupWindow&&(this._sizers.style({width:a+"px"}),w.set(this._contentPane,"maxHeight",b+"px"),this._maxHeight=b,this.isShowing&&this.reposition())},reposition:function(){this.popupWindow&&this.map&&this.location&&!this._maximized&&this.isShowing&&this._setPosition(this.map.toScreen(this.location))},addActions:function(a){return t.map(a,function(a){var b=c.create("a",{href:"javascript:void(0);",className:"action "+
a.className,title:a.title,innerHTML:a.title},this._actionList);v.connect(b,"onclick",a.callback);return{action:a,node:b}},this)},removeActions:function(a){t.forEach(a,function(a){c.destroy(a.node)})},getCurrentAnchor:function(){return this._anchor},maximize:function(){var c=this.map;if(c&&!this._maximized&&this.popupWindow){this._maximized=!0;var e=this._maxButton;a.remove(e,"maximize");a.add(e,"restore");b.set(e,"title",this._nls.NLS_restore);var e=this.marginLeft,f=this.marginTop,k=c.width-2*e,
c=c.height-2*f;w.set(this.domNode,{left:this._isRTL?null:e+"px",right:this._isRTL?e+"px":null,top:f+"px",bottom:null});w.set(this._positioner,{left:null,right:null,top:null,bottom:null});this._savedWidth=w.get(this._sizers[0],"width");this._savedHeight=w.get(this._contentPane,"maxHeight");this._sizers.style({width:k+"px"});w.set(this._contentPane,{maxHeight:c-65+"px",height:c-65+"px"});this._showPointer("");this._unfollowMap();a.add(this.domNode,"esriPopupMaximized");this.onMaximize()}},restore:function(){if(this.map&&
this._maximized&&this.popupWindow){this._maximized=!1;var c=this._maxButton;a.remove(c,"restore");a.add(c,"maximize");b.set(c,"title",this._nls.NLS_maximize);w.set(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this.location);this._followMap();a.remove(this.domNode,"esriPopupMaximized");this.onRestore()}},startup:function(){},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);
this._destroyContent();t.forEach(this._eventConnections,v.disconnect);c.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._positioner=this._pointer=this._outerPointer=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null},selectNext:function(){this.select(this.selectedIndex+1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(a,b){this._transientAnchor=
b&&b.anchor;this.inherited(arguments);this._updateUI()},clearFeatures:function(a){a||(this._transientAnchor=null);this.inherited(arguments)},postscript:null,_highlightSetter:function(a){var b=this.highlight,c=this.map;this.highlight=a;if(c&&a!==b)if(a){if(this.enableHighlight(c),a=this.features&&this.features[this.selectedIndex])this.updateHighlight(c,a),this.showHighlight()}else this.disableHighlight(c)},_pagingControlsSetter:function(a){var b=this.pagingControls,c=this.map;this.pagingControls=a;
c&&a!==b&&this._updatePagingControls()},_pagingInfoSetter:function(a){var b=this.pagingInfo,c=this.map;this.pagingInfo=a;c&&a!==b&&this.features&&this.features.length&&this._updatePagingInfo()},_popupWindowSetter:function(a){var b=this.popupWindow,c=this.map;this.popupWindow=a;c&&a!==b&&(a?(this._updateUI(),this._updateWindow()):(this.hide(),this.showHighlight()))},_anchorSetter:function(a){var b=this.anchor;this.anchor=a;this.map&&a!==b&&this.reposition()},_startupContent:function(){var a=this._contentPane;
this.startupDijits(a);t.forEach(this._getPopupRendererDijits(a),function(a){if(!this._contentUpdateHandles[a.id]){var b=a.on("content-update",g.hitch(this,function(){this.reposition()}));this._contentUpdateHandles[a.id]=b}},this)},_destroyContent:function(){var a=this._contentPane;t.forEach(this._getPopupRendererDijits(a),function(a){var b=this._contentUpdateHandles[a.id];b&&(b.remove(),delete this._contentUpdateHandles[a.id])},this);this.destroyDijits(a)},_getPopupRendererDijits:function(a){a=this.getDijits(a);
return a=t.filter(a,function(a){return a&&a.set&&/_PopupRenderer/.test(a.declaredClass)})},_featuresCleared:function(){this.setTitle("\x26nbsp;");this.setContent("\x26nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight()},_featureSelected:function(){this._updateUI();this._updateWindow()},_updateWindow:function(){var a=this.selectedIndex;if(0<=a){var b=this.features[a].getContent();if(!this.titleInBody&&b&&g.isString(b.id)){var c=q.byId(b.id);c&&c.set&&/_PopupRenderer/.test(c.declaredClass)&&
c.set("showTitle",!1)}this.setContent(b);this.updateHighlight(this.map,this.features[a]);this.showHighlight()}},_toggleVisibility:function(a){this._setVisibility(a);this.isShowing=a},_setVisibility:function(b){a.toggle(this.domNode,"esriPopupVisible",b);a.toggle(this.domNode,"esriPopupHidden",!b)},_waitAndHide:function(a){var b=this;this._delayHide=!0;setTimeout(function(){b._delayHide&&(b._delayHide=!1,b.hide())},a)},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[v.connect(a,
"onPanStart",this,this._onPanStart),v.connect(a,"onPan",this,this._onPan),v.connect(a,"onZoomStart",this,this._onZoomStart),v.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(t.forEach(a,v.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,bottom:a.bottom}},_onPan:function(a,b){var c=this._panOrigin;a=b.x;b=b.y;var e=c.left,f=c.top,k=c.right,c=c.bottom;e&&(e=parseFloat(e)+
a+"px");f&&(f=parseFloat(f)+b+"px");k&&(k=parseFloat(k)-a+"px");c&&(c=parseFloat(c)-b+"px");w.set(this.domNode,{left:e,top:f,right:k,bottom:c})},_onZoomStart:function(){this._setVisibility(!1)},_onExtentChange:function(a,b,c){c&&(this._setVisibility(!0),this.show(this._targetLocation||this.location));this._targetLocation=null},_toggleSize:function(){this._maximized?this.restore():this.maximize()},_getTargetAnchor:function(){return this._transientAnchor||this.anchor},_setPosition:function(a){var b=
a.x,c=a.y;a=this.offsetX||0;var e=this.offsetY||0,f=0,k=0,q=this.map,m=q.position.x,g=q.position.y,A=q.width,n=q.height,q="Left",B="bottom",l="right",d="top",h=x.getContentBox(this._positioner),r=h.w/2,y=h.h/2,H=w.get(this._sizers[0],"height")+this._maxHeight+w.get(this._sizers[2],"height"),P=H/2,z=0,C=0,p=A,D=n,F=b,E=c,G=this._getTargetAnchor().toLowerCase();if("auto"===G){if(G=u.getBox)G=G(),z=Math.max(G.l,m),p=Math.min(G.l+G.w,m+A),C=Math.max(G.t,g),D=Math.min(G.t+G.h,g+n),F+=m,E+=g;m=E-C>=H;g=
D-E>=H;A=p-F>=h.w;h=F-z>=h.w;E-C>P&&D-E>=P&&(A?(B="",q="Left",d="",l="right"):h&&(B="",q="Right",d="",l="left"));q&&B&&F-z>r&&p-F>=r&&(m?(q="",B="bottom",l="",d="top"):g&&(q="",B="top",l="",d="bottom"));q&&B&&(A&&m?(q="Left",B="bottom",l="right",d="top"):A&&g?(q="Left",B="top",l="right",d="bottom"):h&&g?(q="Right",B="top",l="left",d="bottom"):h&&m&&(q="Right",B="bottom",l="left",d="top"));this._anchor=d&&l?d+"-"+l:d||l}else B=q="",-1!==G.indexOf("top")?B="bottom":-1!==G.indexOf("bottom")&&(B="top"),
-1!==G.indexOf("left")?q="Right":-1!==G.indexOf("right")&&(q="Left"),this._anchor=this._getTargetAnchor();l=B+q;switch(l){case "top":case "bottom":k=14;break;case "Left":case "Right":f=13;break;case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":k=14,f=-16}w.set(this.domNode,{left:b+"px",top:c+"px",right:null,bottom:null});b={left:null,right:null,top:null,bottom:null};q?b[q.toLowerCase()]=f+a+"px":b.left=-r+"px";B?b[B]=k+e+"px":b.top=-y+"px";w.set(this._positioner,b);this._showPointer(l)},
_showPointer:function(b){a.remove(this._pointer,"top bottom right left topLeft topRight bottomRight bottomLeft hidden".split(" "));a.remove(this._outerPointer,["right","left","hidden"]);"Right"===b||"Left"===b?(b=b.toLowerCase(),a.add(this._outerPointer,b)):a.add(this._pointer,b)},_setPagerCallbacks:function(a,b,c){if(this.pagingControls&&(a!==this||this._pagerScope&&this._pagerScope!==this)&&a!==this._pagerScope){this._pagerScope=a;a===this&&(b=this.selectPrevious,c=this.selectNext);var e=this._eventConnections;
v.disconnect(e[1]);v.disconnect(e[2]);b&&(e[1]=v.connect(this._prevFeatureButton,"onclick",a,b));c&&(e[2]=v.connect(this._nextFeatureButton,"onclick",a,c))}},_getLocation:function(a){var b,c,e=a&&a.geometry;if(e)switch(e.type){case "point":b=e;a.isAggregate()&&(a=a.getChildGraphics(),c=a[0],a=(c=c.geometry&&c.geometry.spatialReference)&&new F({points:t.map(a,function(a){a=a.geometry;return[a.x,a.y]}),spatialReference:c.toJson()}),c=D.getDenormalizedExtent(a));break;case "multipoint":b=e.getPoint(0);
c=D.getDenormalizedExtent(e);break;case "polyline":case "polygon":b=e.getPoint(0,0),c=D.getDenormalizedExtent(e)}return[b,c]},_zoomToFeature:function(a){a.preventDefault();var b=this.features,c=this.selectedIndex;a=this.map;if(b)if(c=this._getLocation(b[c]),b=c[0],c=c[1],b||(b=this.location),c&&c.intersects(this.location)||(this.location=b),c&&c.getWidth()&&c.getHeight())a.setExtent(c,!0);else{var e=a.getNumLevels(),c=a.getLevel(),f=a.getMaxZoom(),k=this.zoomFactor||1;0<e?c!==f&&(e=c+k,e>f&&(e=f),
a.navigationManager._wheelZoom({value:e-c,mapPoint:b},!0)):a.navigationManager._wheelZoom({value:1/Math.pow(2,k)*2,mapPoint:b},!0)}},_updatePagingControls:function(){var b=this._prevFeatureButton,c=this._nextFeatureButton,e=this.selectedIndex,f=this.features?this.features.length:0;this.pagingControls&&1<f?(0===e?a.add(b,"hidden"):a.remove(b,"hidden"),e===f-1?a.add(c,"hidden"):a.remove(c,"hidden")):(a.add(b,"hidden"),a.add(c,"hidden"))},_updatePagingInfo:function(){var a=this.features?this.features.length:
0,b=this._nls,c="\x26nbsp;";this.pagingInfo&&1<a&&b.NLS_pagingInfo&&(c=z.substitute({index:this.selectedIndex+1,total:a},b.NLS_pagingInfo));a&&(b=this.getSelectedFeature(),a=b.getInfoTemplate(),b=b.getTitle(),a&&!/esri\.InfoTemplate/.test(a.declaredClass)&&this.titleInBody||!b||(c=b+("\x26nbsp;"===c?"":" "+c)));this.setTitle(c)},_updateUI:function(){if(this.popupWindow){var b=this.features,c=this.deferreds,e=b?b.length:0,f=this._spinner,k=this._actionList,q=this._nls;this._updatePagingControls();
this._updatePagingInfo();e?a.remove(k,"hidden"):a.add(k,"hidden");c&&c.length?b?a.remove(f,"hidden"):this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+q.NLS_searching+"...\x3c/div\x3e"):a.add(f,"hidden");e||c&&c.length?this._delayHide=!1:(this.setContent("\x3cdiv style\x3d'text-align: center;'\x3e"+q.NLS_noInfo+".\x3c/div\x3e"),this.visibleWhenEmpty||this._waitAndHide(this.hideDelay))}}})})},"dojo/window":function(){define("./_base/lang ./sniff ./_base/window ./dom ./dom-geometry ./dom-style ./dom-construct".split(" "),
function(p,g,t,v,n,m,u){g.add("rtl-adjust-position-for-verticalScrollBar",function(f,e){f=t.body(e);e=u.create("div",{style:{overflow:"scroll",overflowX:"visible",direction:"rtl",visibility:"hidden",position:"absolute",left:"0",top:"0",width:"64px",height:"64px"}},f,"last");var b=u.create("div",{style:{overflow:"hidden",direction:"ltr"}},e,"last"),a=0!=n.position(b).x;e.removeChild(b);f.removeChild(e);return a});g.add("position-fixed-support",function(f,e){f=t.body(e);e=u.create("span",{style:{visibility:"hidden",
position:"fixed",left:"1px",top:"1px"}},f,"last");var b=u.create("span",{style:{position:"fixed",left:"0",top:"0"}},e,"last"),a=n.position(b).x!=n.position(e).x;e.removeChild(b);f.removeChild(e);return a});var k={getBox:function(f){f=f||t.doc;var e="BackCompat"==f.compatMode?t.body(f):f.documentElement,b=n.docScroll(f);if(g("touch")){var a=k.get(f);f=a.innerWidth||e.clientWidth;e=a.innerHeight||e.clientHeight}else f=e.clientWidth,e=e.clientHeight;return{l:b.x,t:b.y,w:f,h:e}},get:function(f){if(g("ie")&&
k!==document.parentWindow){f.parentWindow.execScript("document._parentWindow \x3d window;","Javascript");var e=f._parentWindow;f._parentWindow=null;return e}return f.parentWindow||f.defaultView},scrollIntoView:function(f,e){try{f=v.byId(f);var b=f.ownerDocument||t.doc,a=t.body(b),c=b.documentElement||a.parentNode,k=g("ie")||g("trident"),w=g("webkit");if(f!=a&&f!=c)if(!(g("mozilla")||k||w||g("opera")||g("trident")||g("edge"))&&"scrollIntoView"in f)f.scrollIntoView(!1);else{var q="BackCompat"==b.compatMode,
u=Math.min(a.clientWidth||c.clientWidth,c.clientWidth||a.clientWidth),z=Math.min(a.clientHeight||c.clientHeight,c.clientHeight||a.clientHeight),b=w||q?a:c,p=e||n.position(f),B=f.parentNode;e=function(a){return 6>=k||7==k&&q?!1:g("position-fixed-support")&&"fixed"==m.get(a,"position").toLowerCase()};var G=this,w=function(a,b,c){"BODY"==a.tagName||"HTML"==a.tagName?G.get(a.ownerDocument).scrollBy(b,c):(b&&(a.scrollLeft+=b),c&&(a.scrollTop+=c))};if(!e(f))for(;B;){B==a&&(B=b);var F=n.position(B),D=e(B),
I="rtl"==m.getComputedStyle(B).direction.toLowerCase();if(B==b)F.w=u,F.h=z,b==c&&(k||g("trident"))&&I&&(F.x+=b.offsetWidth-F.w),F.x=0,F.y=0;else{var K=n.getPadBorderExtents(B);F.w-=K.w;F.h-=K.h;F.x+=K.l;F.y+=K.t;var J=B.clientWidth,L=F.w-J;0<J&&0<L&&(I&&g("rtl-adjust-position-for-verticalScrollBar")&&(F.x+=L),F.w=J);J=B.clientHeight;L=F.h-J;0<J&&0<L&&(F.h=J)}D&&(0>F.y&&(F.h+=F.y,F.y=0),0>F.x&&(F.w+=F.x,F.x=0),F.y+F.h>z&&(F.h=z-F.y),F.x+F.w>u&&(F.w=u-F.x));var M=p.x-F.x,Q=p.y-F.y,S=M+p.w-F.w,T=Q+p.h-
F.h,O,W;0<S*M&&(B.scrollLeft||B==b||B.scrollWidth>B.offsetHeight)&&(O=Math[0>M?"max":"min"](M,S),I&&(8==k&&!q||5<=g("trident"))&&(O=-O),W=B.scrollLeft,w(B,O,0),O=B.scrollLeft-W,p.x-=O);0<T*Q&&(B.scrollTop||B==b||B.scrollHeight>B.offsetHeight)&&(O=Math.ceil(Math[0>Q?"max":"min"](Q,T)),W=B.scrollTop,w(B,0,O),O=B.scrollTop-W,p.y-=O);B=B!=b&&!D&&B.parentNode}}}catch(U){console.error("scrollIntoView: "+U),f.scrollIntoView(!1)}}};p.setObject("dojo.window",k);return k})},"dojo/Stateful":function(){define(["./_base/declare",
"./_base/lang","./_base/array","./when"],function(p,g,t,v){return p("dojo.Stateful",null,{_attrPairNames:{},_getAttrNames:function(g){var m=this._attrPairNames;return m[g]?m[g]:m[g]={s:"_"+g+"Setter",g:"_"+g+"Getter"}},postscript:function(g){g&&this.set(g)},_get:function(g,m){return"function"===typeof this[m.g]?this[m.g]():this[g]},get:function(g){return this._get(g,this._getAttrNames(g))},set:function(g,m){if("object"===typeof g){for(var n in g)g.hasOwnProperty(n)&&"_watchCallbacks"!=n&&this.set(n,
g[n]);return this}n=this._getAttrNames(g);var k=this._get(g,n);n=this[n.s];var f;"function"===typeof n?f=n.apply(this,Array.prototype.slice.call(arguments,1)):this[g]=m;if(this._watchCallbacks){var e=this;v(f,function(){e._watchCallbacks(g,k,m)})}return this},_changeAttrValue:function(g,m){var n=this.get(g);this[g]=m;this._watchCallbacks&&this._watchCallbacks(g,n,m);return this},watch:function(g,m){var n=this._watchCallbacks;if(!n)var k=this,n=this._watchCallbacks=function(e,b,a,c){var f=function(c){if(c){c=
c.slice();for(var f=0,w=c.length;f<w;f++)c[f].call(k,e,b,a)}};f(n["_"+e]);c||f(n["*"])};m||"function"!==typeof g?g="_"+g:(m=g,g="*");var f=n[g];"object"!==typeof f&&(f=n[g]=[]);f.push(m);g={};g.unwatch=g.remove=function(){var e=t.indexOf(f,m);-1<e&&f.splice(e,1)};return g}})})},"esri/geometry/normalizeUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/has ../kernel ../config ../deferredUtils ./Extent ./Polyline ./Polygon ./webMercatorUtils ./jsonUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){function c(a,b){return Math.ceil((a-b)/(2*b))}function x(a,b){var c=a.paths||a.rings,e,f,k=c.length,q;for(e=0;e<k;e++)for(q=c[e].length,f=0;f<q;f++){var w=a.getPoint(e,f);a.setPoint(e,f,w.offset(b,0))}return a}function w(a,b){if(!(a instanceof f||a instanceof e))throw console.error("_straightLineDensify: the input geometry is neither polyline nor polygon"),Error("_straightLineDensify: the input geometry is neither polyline nor polygon");var c=a instanceof f,k=[],
q;p.forEach(c?a.paths:a.rings,function(a){k.push(q=[]);q.push([a[0][0],a[0][1]]);var c,e,f,w,x,g,A,m,n,l,d,h;for(x=0;x<a.length-1;x++){c=a[x][0];e=a[x][1];f=a[x+1][0];w=a[x+1][1];A=Math.sqrt((f-c)*(f-c)+(w-e)*(w-e));m=(w-e)/A;n=(f-c)/A;l=A/b;if(1<l){for(g=1;g<=l-1;g++)h=g*b,d=n*h+c,h=m*h+e,q.push([d,h]);g=(A+Math.floor(l-1)*b)/2;d=n*g+c;h=m*g+e;q.push([d,h])}q.push([f,w])}});return c?new f({paths:k,spatialReference:a.spatialReference}):new e({rings:k,spatialReference:a.spatialReference})}function q(a,
c,e){c&&(a=w(a,1E6),a=b.webMercatorToGeographic(a,!0));e&&(a=x(a,e));return a}function C(a,b,e){var f=a.x||a[0],k;f>b?(k=c(f,b),a.x?a=a.offset(-2*k*b,0):a[0]=f+-2*k*b):f<e&&(k=c(f,e),a.x?a=a.offset(-2*k*e,0):a[0]=f+-2*k*e);return a}function z(a,b){var e=-1;p.forEach(b.cutIndexes,function(f,k){var q=b.geometries[k];p.forEach(q.rings||q.paths,function(a,b){p.some(a,function(e){if(!(180>e[0])){e=0;var f,k=a.length,w;for(f=0;f<k;f++)w=a[f][0],e=w>e?w:e;e=Number(e.toFixed(9));e=-360*c(e,180);k=a.length;
for(f=0;f<k;f++)w=q.getPoint(b,f),q.setPoint(b,f,w.offset(e,0))}return!0})});f===e?q.rings?p.forEach(q.rings,function(b){a[f]=a[f].addRing(b)}):p.forEach(q.paths,function(b){a[f]=a[f].addPath(b)}):(e=f,a[f]=q)});return a}function E(k,w,g,n){var u=new t;u.addCallbacks(g,n);w=w||m.defaults.geometryService;var B=[],D=[],F,G,E,v,I,A,K,aa,l=0;p.forEach(k,function(d){if(d)if(F||(F=d.spatialReference,G=F._getInfo(),v=(E=F._isWebMercator())?2.0037508342788905E7:180,I=E?-2.0037508342788905E7:-180,A=E?102100:
4326,K=new f({paths:[[[v,I],[v,v]]],spatialReference:{wkid:A}}),aa=new f({paths:[[[I,I],[I,v]]],spatialReference:{wkid:A}})),G){var h=a.fromJson(d.toJson()),r=d.getExtent();"point"===d.type?B.push(C(h,v,I)):"multipoint"===d.type?(h.points=p.map(h.points,function(d){return C(d,v,I)}),B.push(h)):"extent"===d.type?(h=r._normalize(null,null,G),B.push(h.rings?new e(h):h)):r?(d=2*c(r.xmin,I)*v,h=0===d?h:x(h,d),r=r.offset(d,0),r.intersects(K)&&r.xmax!==v?(l=r.xmax>l?r.xmax:l,h=q(h,E),D.push(h),B.push("cut")):
r.intersects(aa)&&r.xmin!==I?(l=2*r.xmax*v>l?2*r.xmax*v:l,h=q(h,E,360),D.push(h),B.push("cut")):B.push(h)):B.push(h)}else B.push(d);else B.push(d)});g=new f;n=c(l,v);for(var d=-90,h=n;0<n;){var r=-180+360*n;g.addPath([[r,d],[r,-1*d]]);d*=-1;n--}0<D.length&&0<h?w?w.cut(D,g,function(d){D=z(D,d);var h=[];p.forEach(B,function(d,l){"cut"===d&&(d=D.shift(),k[l].rings&&1<k[l].rings.length&&d.rings.length>=k[l].rings.length?(B[l]="simplify",h.push(d)):B[l]=!0===E?b.geographicToWebMercator(d):d)});0<h.length?
w.simplify(h,function(d){p.forEach(B,function(h,l){"simplify"===h&&(B[l]=!0===E?b.geographicToWebMercator(d.shift()):d.shift())});u.callback(B)},function(d){u.errback(d)}):u.callback(B)},function(d){u.errback(d)}):u.errback(Error("esri.geometry.normalizeCentralMeridian: 'geometryService' argument is missing.")):(p.forEach(B,function(d,h){"cut"===d&&(d=D.shift(),B[h]=!0===E?b.geographicToWebMercator(d):d)}),u.callback(B));return u}function B(a,b,c,e){var f=!1,k;g.isObject(a)&&a&&(g.isArray(a)?a.length&&
((k=a[0]&&a[0].declaredClass)&&-1!==k.indexOf("Graphic")?(a=p.map(a,function(a){return a.geometry}),f=a.length?!0:!1):k&&-1!==k.indexOf("esri.geometry.")&&(f=!0)):(k=a.declaredClass)&&-1!==k.indexOf("FeatureSet")?(a=p.map(a.features||[],function(a){return a.geometry}),f=a.length?!0:!1):k&&-1!==k.indexOf("esri.geometry.")&&(f=!0));f&&b.push({index:c,property:e,value:a})}function G(a,b){var c=[];p.forEach(b,function(b){var e=b.i,f=a[e];b=b.p;var k;if(g.isObject(f)&&f)if(b)if("*"===b[0])for(k in f)f.hasOwnProperty(k)&&
B(f[k],c,e,k);else p.forEach(b,function(a){B(g.getObject(a,!1,f),c,e,a)});else B(f,c,e)});return c}function F(a,b){var c=0,e={};p.forEach(b,function(b){var f=b.index,k=b.property,q=b.value,w=q.length||1,x=a.slice(c,c+w);g.isArray(q)||(x=x[0]);c+=w;delete b.value;k?(e[f]=e[f]||{},e[f][k]=x):e[f]=x});return e}function D(a){for(var b=[],c=0,e=0,f=Math.min,k=Math.max,q=0;q<a.length;q++){for(var w=a[q],x=null,g=0;g<w.length;g++)x=w[g],b.push(x),0===g?e=c=x[0]:(c=f(c,x[0]),e=k(e,x[0]));x&&b.push([(c+e)/
2,0])}return b}return{normalizeCentralMeridian:E,_foldCutResults:z,_prepareGeometryForCut:q,_offsetMagnitude:c,_pointNormalization:C,_updatePolyGeometry:x,_straightLineDensify:w,_createWrappers:function(a){var b=g.isObject(a)?a.prototype:g.getObject(a+".prototype");p.forEach(b.__msigns,function(a){var c=b[a.n];b[a.n]=function(){var b=this,e=[],f,k=new t(u._dfdCanceller);a.f&&u._fixDfd(k);for(f=0;f<a.c;f++)e[f]=arguments[f];var q={dfd:k};e.push(q);var w,x=[],g;b.normalization&&!b._isTable&&(w=G(e,
a.a),p.forEach(w,function(a){x=x.concat(a.value)}),x.length&&(g=E(x)));g?(k._pendingDfd=g,g.addCallbacks(function(a){k.canceled||(q.assembly=F(a,w),k._pendingDfd=c.apply(b,e))},function(c){var f=b.declaredClass;f&&-1!==f.indexOf("FeatureLayer")?b._resolve([c],null,e[a.e],k,!0):b._errorHandler(c,e[a.e],k)})):k._pendingDfd=c.apply(b,e);return k}})},_disassemble:G,_addToBucket:B,_reassemble:F,getDenormalizedExtent:function(a){if(!a)return null;var b=a.getExtent();if(!b)return null;var c=a.spatialReference&&
a.spatialReference._getInfo();if(!c)return b;var e=c.valid[0],c=c.valid[1],f=2*c,q=b.getWidth(),w=b.xmax,x=b.xmin;if("extent"===a.type||0===q||q<=c||q>f||w<e||x>c)return b;var g;switch(a.type){case "polygon":if(1<a.rings.length)g=D(a.rings);else return b;break;case "polyline":if(1<a.paths.length)g=D(a.paths);else return b;break;case "multipoint":g=a.points}a=Math.min;for(var e=Math.max,f=new k(b.toJson()),m=0;m<g.length;m++){var n=g[m][0];0>n?(n+=c,x=e(n,x)):(n-=c,w=a(n,w))}f.xmin=w;f.xmax=x;return f.getWidth()<
q?(f.xmin-=c,f.xmax-=c,f):b}}})},"esri/geometry/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ../lang ./Point ./Polyline ./Polygon ./Multipoint ./Extent".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a,b,c){var e=a.rings||a.paths,f,k,q,w,x,g,m,n;f=0;for(k=e.length;f<k;f++)for(x=e[f],q=0,w=x.length;q<w;q++)g=x[q],0<q?(m+=g[0],n+=g[1]):(m=g[0],n=g[1]),g[0]=b(m),g[1]=c(n);return a}var b={esriGeometryPoint:function(a,b,c){a.x=b(a.x);a.y=c(a.y);return a},esriGeometryPolyline:e,esriGeometryPolygon:e,
esriGeometryEnvelope:function(a,b,c){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax);return a},esriGeometryMultipoint:function(a,b,c){var e=a.points,f,k,q,w,x;f=0;for(k=e.length;f<k;f++)q=e[f],0<f?(w+=q[0],x+=q[1]):(w=q[0],x=q[1]),q[0]=b(w),q[1]=c(x);return a}},a={esriGeometryPoint:function(a,b,c){a.x=b(a.x);a.y=c(a.y);return a}},c={createInstance:function(a,b){a=new a;b&&v.mixin(a,b);return a},fromJson:function(a){if(void 0!==a.x&&void 0!==a.y)return new n(a);if(void 0!==a.paths)return new m(a);
if(void 0!==a.rings)return new u(a);if(void 0!==a.points)return new k(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new f(a)},getJsonType:function(a){return a instanceof n?"esriGeometryPoint":a instanceof m?"esriGeometryPolyline":a instanceof u?"esriGeometryPolygon":a instanceof f?"esriGeometryEnvelope":a instanceof k?"esriGeometryMultipoint":null},getGeometryType:function(a){return"esriGeometryPoint"===a?n:"esriGeometryPolyline"===a?m:"esriGeometryPolygon"===a?u:
"esriGeometryEnvelope"===a?f:"esriGeometryMultipoint"===a?k:null},supportsLazyUnquantization:function(a){return"esriGeometryPoint"===a||"esriGeometryPolyline"===a||"esriGeometryPolygon"===a||"esriGeometryMultipoint"===a},unquantizeFunction:function(a,c){if(a&&c){var e=c.translate[0],f=c.translate[1],k=c.scale[0],w=c.scale[1],x=function(a){return a*k+e},g=function(a){return f-a*w},m=b[a];return function(a){return a?m(a,x,g):null}}},unquantize:function(a,b,e){if(b=c.unquantizeFunction(b,e)){var f=a.length;
for(e=0;e<f;e++)b(a[e].geometry)}},quantizeFunction:function(b,c){if(b&&"esriGeometryPoint"===b&&c){var e=c.translate[0],f=c.translate[1],k=c.scale[0],w=c.scale[1],x=function(a){return Math.round((a-e)/k)},g=function(a){return Math.round((f-a)/w)},m=a[b];return function(a){return a?m(a,x,g):null}}},quantize:function(a,b,e){if(b=c.quantizeFunction(b,e)){var f=a.length;for(e=0;e<f;e++)b(a[e].geometry)}}};return c})},"esri/InfoWindowBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Deferred dojo/dom-construct dojo/has dijit/registry ./kernel ./lang ./geometry/ScreenPoint".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p(null,{declaredClass:"esri.InfoWindowBase",constructor:function(){var a=g.hitch;this.__set_title=a(this,this.__set_title);this.__err_title=a(this,this.__err_title);this.__set_content=a(this,this.__set_content);this.__err_content=a(this,this.__err_content)},setMap:function(a){this.map=a},unsetMap:function(a){delete this.map},setTitle:function(){},setContent:function(){},show:function(){},hide:function(){},resize:function(){},onShow:function(){},onHide:function(){},
place:function(a,b){e.isDefined(a)?g.isObject(a)?m.place(a,b,"only"):b.innerHTML=a:b.innerHTML=""},startupDijits:function(a){this._processDijits(a)},destroyDijits:function(a){this._processDijits(a,!0)},getDijits:function(a){var b=[];a&&1===a.children.length&&(a=a.children[0])&&(b=(b=k.byNode(a))?[b]:k.findWidgets(a));return b},_processDijits:function(a,b){a=this.getDijits(a);t.forEach(a,function(a){if(b){if(a._started&&!a._destroyed)try{a.destroyRecursive?a.destroyRecursive():a.destroy&&a.destroy()}catch(w){console.debug("An error occurred when destroying a widget embedded within InfoWindow: "+
w.message)}}else if(!a._started)try{a.startup()}catch(w){console.debug("An error occurred when starting a widget embedded within InfoWindow: "+w.message)}})},__registerMapListeners:function(){this.__unregisterMapListeners();var a=this.map;this.__handles=[v.connect(a,"onPan",this,this.__onMapPan),v.connect(a,"onZoomStart",this,this.__onMapZmStart),v.connect(a,"onExtentChange",this,this.__onMapExtChg)]},__unregisterMapListeners:function(){var a=this.__handles;a&&(t.forEach(a,v.disconnect,v),this.__handles=
null)},__onMapPan:function(a,b){this.move(b,!0)},__onMapZmStart:function(){this.__mcoords=this.mapCoords||this.map.toMap(new b(this.coords));this.hide(null,!0)},__onMapExtChg:function(a,b,e){a=this.map;var c=this.mapCoords;c?this.show(c,null,!0):(b=e?a.toScreen(this.__mcoords):this.coords.offset(b&&b.x||0,b&&b.y||0),this.show(b,null,!0))},__setValue:function(a,b){this[a].innerHTML="";var c="_dfd"+a,f=this[c];f&&-1===f.fired&&(f.cancel(),this[c]=null);e.isDefined(b)&&(b instanceof n?(this[c]=b,b.addCallbacks(this["__set"+
a],this["__err"+a])):this.__render(a,b))},__set_title:function(a){this._dfd_title=null;this.__render("_title",a)},__err_title:function(a){this._dfd_title=null},__set_content:function(a){this._dfd_content=null;this.__render("_content",a)},__err_content:function(a){this._dfd_content=null},__render:function(a,b){var c=this[a];this.place(b,c);this.isShowing&&(this.startupDijits(c),"_title"===a&&this._adjustContentArea&&this._adjustContentArea())}})})},"esri/PopupBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Color dojo/_base/Deferred dojo/has ./kernel ./graphic ./geometry/Point ./geometry/jsonUtils ./geometry/mathUtils ./geometry/webMercatorUtils ./symbols/SimpleMarkerSymbol ./symbols/SimpleLineSymbol ./symbols/CartographicLineSymbol ./symbols/SimpleFillSymbol ./tasks/query ./Evented require".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){function E(a){return"sizeInfo"===a.type}return p(z,{declaredClass:"esri.PopupBase",_featureLayers:{},_updateEndHandles:[],_mapLevelChangeHandle:null,_evtMap:{"set-features":!0,"clear-features":!0,"selection-change":!0,"dfd-complete":!0},onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;this.on("clear-features",g.hitch(this,this._resetUpdateEndListeners));
this.on("dfd-complete",g.hitch(this,this._processFeatures));this.on("set-features",g.hitch(this,this._processFeatures));this.on("selection-change",g.hitch(this,this._checkFeatureResolution))},cleanup:function(){this.features=this.deferreds=null;this._resetUpdateEndListeners();this._untrackMapLevelChange()},setFeatures:function(a){if(a&&a.length){this.clearFeatures(!0);var b,c;a[0]instanceof n?c=a:b=a;b?this._updateFeatures(null,b):(this.deferreds=c,c=c.slice(0),t.forEach(c,function(a){a.addBoth(g.hitch(this,
this._updateFeatures,a))},this))}},clearFeatures:function(a){this.features=this.deferreds=this._marked=null;this.count=0;var b=this.selectedIndex;this.selectedIndex=-1;if(-1<b)this.onSelectionChange();this.onClearFeatures({isIntermediate:!!a})},getSelectedFeature:function(){var a=this.features;if(a)return a[this.selectedIndex]},select:function(a){0>a||a>=this.count||(this.selectedIndex=a,this.onSelectionChange())},enableHighlight:function(a){this._highlighted=a.graphics.add(new k(new f(0,0,a.spatialReference)));
this._highlighted.attr("data-popup-highlight","");this._highlighted.hide();this._trackMapLevelChange(a);this.markerSymbol||(a=this.markerSymbol=new c,a.setStyle(c.STYLE_TARGET),a._setDim(16,16,0),a.setOutline(new w(x.STYLE_SOLID,new v([0,255,255]),2,w.CAP_ROUND,w.JOIN_ROUND)),a.setColor(new v([0,0,0,0])));this.lineSymbol||(this.lineSymbol=new x(x.STYLE_SOLID,new v([0,255,255]),2));this.fillSymbol||(this.fillSymbol=new q(q.STYLE_NULL,new x(x.STYLE_SOLID,new v([0,255,255]),2),new v([0,0,0,0])));this.clusterFillSymbol||
(this.clusterFillSymbol=new q(q.STYLE_SOLID,new x(x.STYLE_SOLID,new v([0,255,255]),1.33),null))},disableHighlight:function(a){var b=this._highlighted;b&&(b.hide(),a.graphics.remove(b),delete this._highlighted);this._untrackMapLevelChange();this.markerSymbol=this.lineSymbol=this.fillSymbol=null},showHighlight:function(){var a=this.features&&this.features[this.selectedIndex];this._highlighted&&a&&a.geometry&&this._highlighted.show()},hideHighlight:function(){this._highlighted&&this._highlighted.hide()},
updateHighlight:function(a,b){var c=b.geometry,f=this._highlighted;if(c&&f){f.hide();!f._graphicsLayer&&a&&a.graphics.add(f);f.setGeometry(e.fromJson(c.toJson()));var k;switch(c.type){case "point":case "multipoint":var q=b.getLayer(),w=b.symbol||q&&q._getSymbol(b);if(q&&w){var x,g,c=w.xoffset||0,m=w.yoffset||0,n=w.angle||0;switch(w.type){case "simplemarkersymbol":x=g=w.size||0;break;case "picturemarkersymbol":x=w.width||0;g=w.height||0;break;case "textsymbol":x=g=w.font&&w.font.size||0}k=b.symbol?
null:q._getRenderer(b);(q=this._getSizeInfo(k))?a=b=k.getSize(b,{sizeInfo:q,shape:w.style,resolution:a&&a.getResolutionInMeters&&a.getResolutionInMeters()}):null!=b.size?a=b=b.size:(a=x,b=g);k=this.markerSymbol;a&&b&&(c&&(c=c/x*a),m&&(m=m/g*b),k._setDim(a+4,b+4,0));k.setOffset(c,m);k.setAngle(n)}break;case "polyline":k=this.lineSymbol;break;case "polygon":k=this.fillSymbol}f.setSymbol(k)}else f&&f.hide()},showClosestFirst:function(c){var e=this.features;if(e&&e.length){if(1<e.length){var f,k=Infinity,
q=-1,w,x=b.getLength,g,m=c.spatialReference,n,u;c=c.normalize();for(f=e.length-1;0<=f;f--)if(w=e[f].geometry){n=w.spatialReference;g=0;try{u="point"===w.type?w:w.getExtent().getCenter(),u=u.normalize(),m&&n&&!m.equals(n)&&m._canProject(n)&&(u=m.isWebMercator()?a.geographicToWebMercator(u):a.webMercatorToGeographic(u)),g=x(c,u)}catch(T){}0<g&&g<k&&(k=g,q=f)}0<q&&(e.splice(0,0,e.splice(q,1)[0]),this.select(0))}}else this.deferreds&&(this._marked=c)},_trackMapLevelChange:function(a){this._untrackMapLevelChange();
this._mapLevelChangeHandle=a.on("extent-change",g.hitch(this,function(a){a.levelChange&&this._checkFeatureResolution()}))},_untrackMapLevelChange:function(){this._mapLevelChangeHandle&&(this._mapLevelChangeHandle.remove(),this._mapLevelChangeHandle=null)},_unbind:function(a){a=t.indexOf(this.deferreds,a);if(-1!==a)return this.deferreds.splice(a,1),this.deferreds.length?1:(this.deferreds=null,2)},_fireComplete:function(a){var b=this._marked;b&&(this._marked=null,this.showClosestFirst(b));this.onDfdComplete(a)},
_updateFeatures:function(a,b){if(a){if(this.deferreds&&(a=this._unbind(a)))if(b&&b instanceof Error){if(this._fireComplete(b),2===a)this.onSetFeatures()}else if(b&&b.length)if(this.features){if(b=t.filter(b,function(a){return-1===t.indexOf(this.features,a)},this),this.features=this.features.concat(b),this.count=this.features.length,this._fireComplete(),2===a)this.onSetFeatures()}else{this.features=b;this.count=b.length;this.selectedIndex=0;this._fireComplete();if(2===a)this.onSetFeatures();this.select(0)}else if(this._fireComplete(),
2===a)this.onSetFeatures()}else this.features=b,this.count=b.length,this.selectedIndex=0,this.onSetFeatures(),this.select(0)},_getSizeInfo:function(a){return a?a.sizeInfo||t.filter(a.visualVariables,E)[0]:null},_resetUpdateEndListeners:function(){this._featureLayers={};t.forEach(this._updateEndHandles,function(a){a.remove()});this._updateEndHandles=[]},_processFeatures:function(){t.forEach(this.features,function(a){(a=a.getLayer())&&!this._featureLayers[a.id]&&(1===a.currentMode||0===a.currentMode&&
6===a.mode)&&a.objectIdField&&a.hasXYFootprint&&a.queryFeatures&&(this._featureLayers[a.id]=a,a=a.on("update-end",g.hitch(this,this._fLyrUpdateEndHandler)),this._updateEndHandles.push(a))},this)},_fLyrUpdateEndHandler:function(a){if(!a.error){var b=this,c=a.target,e=c.getSelectedFeatures(),f=0===c.currentMode&&6===c.mode,k={},q=[];t.forEach(this.features,function(a){if(a.getLayer()===c){var b=a.attributes[c.objectIdField];k[b]=a;q.push(b)}});q.length&&(a=new C,a.objectIds=q,c.queryFeatures(a,function(a){t.forEach(a.features,
function(a){var b=k[a.attributes[c.objectIdField]],q=!1;b.geometry!==a.geometry||c.hasWebGLSurface()?(b.setGeometry(a.geometry),q=!0):f&&e&&-1!==t.indexOf(e,a)&&(q=!0);q&&this._highlighted&&b===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry)},b)}))}},_checkFeatureResolution:function(){var a=this.getSelectedFeature(),b=this.map;if(a&&b){var c=a.getLayer();if(c){var e=a.getResolution();2===c.currentMode&&a.geometry&&e&&e>b.getResolution()&&(b=b.getResolutionForPopup(),(c=this._refetchFeature(a,
b,c))&&c.then(g.hitch(this,this._updateFeatureResolution,a,b)))}}},_refetchFeature:function(a,b,c){if(a=this._createQueryForCustomResolution(a,b,c))return c.queryFeatures(a).then(function(a){return a&&a.features[0]})},_createQueryForCustomResolution:function(a,b,c){c=c.objectIdField;var e=a.attributes,e=e&&c&&e[c];if(null==e)return null;var f=new C;f.objectIds=[e];f.maxAllowableOffset=b;f.outFields=[c];f.outSpatialReference=a.geometry.spatialReference;return f},_updateFeatureResolution:function(a,
b,c){a.getResolution()!==b&&(a.setResolution(b),a.setGeometry(c.geometry),this._highlighted&&a===this.getSelectedFeature()&&this._highlighted.setGeometry(a.geometry))}})})},"esri/graphic":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./domUtils ./lang ./InfoTemplate ./geometry/jsonUtils ./symbols/jsonUtils".split(" "),function(p,g,t,v,n,m,u,k,f){function e(){}p=p(null,{declaredClass:"esri.Graphic",constructor:function(b,a,c,e){this._construct();b&&!b.declaredClass?(this.geometry=
b.geometry?k.fromJson(b.geometry):null,this.symbol=b.symbol?f.fromJson(b.symbol):null,this.attributes=b.attributes||null,this.infoTemplate=b.infoTemplate?new u(b.infoTemplate):null):(this.geometry=b,this.symbol=a,this.attributes=c,this.infoTemplate=e)},_geomVersion:0,_resolution:null,_shape:null,_bgShape:null,_dataAttrs:null,_layer:null,_sourceLayer:null,_graphicsLayer:null,_parentGraphic:null,_suspended:!1,size:null,visible:!0,_aggregationSourceLayer:null,_aggregationInfo:null,_computedAttributes:null,
_computedVersion:null,_computedGeomVersion:null,getParentGraphic:function(){return this._parentGraphic},setParentGraphic:function(b){this._parentGraphic=b},setSize:function(b){this.size=b;return this},getAggregationSourceLayer:function(){return this._aggregationSourceLayer},setAggregationSourceLayer:function(b){this._aggregationSourceLayer=b;return this},isAggregate:function(){return!!this._aggregationInfo},getAggregationInfo:function(){return this._aggregationInfo},setAggregationInfo:function(b){this._aggregationInfo=
b;return this},getChildGraphics:function(){var b=this.getAggregationSourceLayer();return b?b.getChildGraphics(this):[]},getDojoShape:function(){return this._shape},getShapes:function(){var b=[];this._shape&&b.push(this._shape);this._bgShape&&b.push(this._bgShape);return b},getNode:function(){var b=this._shape&&this._shape.getNode();return b&&b.nodeType?b:null},getNodes:function(){var b=this.getShapes(),a,c,e=b.length,f=[];for(c=0;c<e;c++)(a=b[c]&&b[c].getNode())&&a.nodeType&&f.push(a);return f},getLayer:function(){return this._layer},
getSourceLayer:function(){return this._sourceLayer||this._layer},clone:function(){var b=new this.constructor(this.toJson());b.visible=this.visible;b._layer=this._layer;b._sourceLayer=this._sourceLayer;b._aggregationSourceLayer=this._aggregationSourceLayer;b._aggregationInfo=this._aggregationInfo;b._resolution=this._resolution;return b},draw:function(){var b=this._graphicsLayer;b&&b._draw(this,!0);return this},setGeometry:function(b){this.geometry=b;this._geomVersion++;var a=this._graphicsLayer;a&&
(a._updateExtent(this),this.draw(),b&&"polyline"===b.type&&a._updateSVGMarkers());return this},setResolution:function(b){this._resolution=b;return this},getResolution:function(){return this._resolution},setSymbol:function(b,a){var c=this._graphicsLayer,e=this._shape;this.symbol=b;c&&(a&&e&&c._removeShape(this),this.draw());return this},setAttributes:function(b){this.attributes=b;this.clearCache();return this},setInfoTemplate:function(b){this.infoTemplate=b;return this},getInfoTemplate:function(){return this._getEffInfoTemplate()},
_getEffInfoTemplate:function(){var b=this.getLayer();return this.infoTemplate||b&&b.infoTemplate},getTitle:function(){var b=this.getInfoTemplate(),a=b&&b.title;if(g.isFunction(a))a=a.call(b,this);else if(g.isString(a))var c=(b=this.getLayer())&&b._getDateOpts,a=m.substitute(this.attributes,a,{first:!0,dateFormat:c&&c.call(b)});return a},getContent:function(){var b=this.getInfoTemplate(),a=b&&b.content;if(g.isFunction(a))a=a.call(b,this);else if(g.isString(a))var c=(b=this.getLayer())&&b._getDateOpts,
a=m.substitute(this.attributes,a,{dateFormat:c&&c.call(b)});return a},attr:function(b,a){null==a||this._dataAttrs||(this._dataAttrs={});this._dataAttrs&&(this._dataAttrs[b]=a,this._setDataAttr(b,a));return this},_isSuspended:function(){return this._suspended},_suspend:function(){this._suspended=!0;this.draw()},_resume:function(){this._suspended=!1;this.draw()},show:function(){this.visible=!0;this.attr("data-hidden");var b,a,c;if(this.getShapes().length)for(b=this.getNodes(),c=b.length,a=0;a<c;a++)n.show(b[a]);
else this.draw();(b=this._graphicsLayer)&&b._graphicVisibilityChanged(this);return this},hide:function(){this.visible=!1;this.attr("data-hidden","");var b=this._graphicsLayer,a,c,e;if(b){if("canvas-2d"===b.surfaceType)b._removeShape(this);else if(a=this.getNodes(),e=a.length)for(c=0;c<e;c++)n.hide(a[c]);b._graphicVisibilityChanged(this)}return this},toJson:function(){var b={};this.geometry&&(b.geometry=this.geometry.toJson());this.attributes&&(b.attributes=g.mixin({},this.attributes));this.symbol&&
(b.symbol=this.symbol.toJson());this.infoTemplate&&(b.infoTemplate=this.infoTemplate.toJson());return b},_setDataAttr:function(b,a){var c=this.getNodes(),e,f=c.length;for(e=0;e<f;e++)this._setDOMDataAttr(c[e],b,a)},_setDOMDataAttr:function(b,a,c){null==c?b.removeAttribute(a):b.setAttribute(a,c)},_applyDataAttrs:function(){var b=this._dataAttrs;if(b){var a=this.getNodes(),c,e=a.length;for(c=0;c<e;c++)for(var f in b)this._setDOMDataAttr(a[c],f,b[f])}},_getViewInfo:function(b){return(b=(b=b||this.getLayer())&&
b.getMap())&&b.getViewInfo()},evaluateExpression:function(b,a){return this._getDataValue(b._attributeDef,b._attributeCache,null,null,b,a)},_getDataValue:function(b,a,c,e,f,k){var q=a.id,w=this.attributes,g=b.field,x=a.isNumeric,m=null;if(q){var n=this._computedAttributes,u=this._computedVersion,p=this._computedGeomVersion;e=this._getViewInfo(e);var v=!(!f||!f.async),t=k&&k.skipCache||v,L=!k||!1!==k.strictReturnType,M=a.dependsOnView||a.isJSFunc,Q=a.dependsOnGeometry;n||(n=this._computedAttributes=
{});M&&!u&&(u=this._computedVersion={});Q&&!p&&(p=this._computedGeomVersion={});var S=M&&u[q]!==e.version||Q&&p[q]!==this._geomVersion,m=n[q];if(void 0===m||S||t)m=null,a.hasExpr?m=f?f.evaluate(k&&k.context):c.executeFunction(a.compiledFunc,c.createExecContext(this,e)):a.isJSFunc?m=g(this,b):w&&(m=w[g],x&&this._isValidNumber(m)&&(a=b.normalizationType||"field",c=m,m=null,f=b.normalizationTotal,b=w[b.normalizationField],"log"===a&&0!==c?m=Math.log(c)*Math.LOG10E:"percent-of-total"===a&&this._isValidNumber(f)&&
0!==f?m=c/f*100:"field"===a&&this._isValidNumber(b)&&0!==b&&(m=c/b))),L&&(v?x&&(this._construct(),m=m.then(this._sanitizeNumericValue)):m=this._sanitizeValue(m,x)),t||(n[q]=m,M&&(u[q]=e.version),Q&&(p[q]=this._geomVersion))}else w&&(m=this._sanitizeValue(w[g],x));return m},_sanitizeValue:function(b,a){a&&!this._isValidNumber(b)&&(b=null);return b},_sanitizeNumericValue:function(b){return this._sanitizeValue(b,!0)},_construct:function(){this._constructed||(this._sanitizeNumericValue=g.hitch(this,this._sanitizeNumericValue),
this._constructed=!0)},_isValidNumber:function(b){return"number"===typeof b&&!isNaN(b)&&Infinity!==b&&-Infinity!==b},clearCache:function(b){if(null!=b){var a=this._computedAttributes,c=this._computedVersion,e=this._computedGeomVersion;a&&(a[b]=void 0);c&&(c[b]=void 0);e&&(e[b]=void 0)}else this._computedAttributes=this._computedVersion=this._computedGeomVersion=null}});p.prototype.getShape=p.prototype.getDojoShape;e.prototype=p.prototype;p.simpleConstructor=e;return p})},"esri/InfoTemplate":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","./kernel","./lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.InfoTemplate",constructor:function(m,n){m&&g.isObject(m)&&!g.isFunction(m)?g.mixin(this,m):(this.title=m||"${*}",this.content=n||"${*}")},setTitle:function(g){this.title=g;return this},setContent:function(g){this.content=g;return this},toJson:function(){return n.fixJson({title:this.title,content:this.content})}})})},"esri/symbols/jsonUtils":function(){define("dojo/_base/lang dojo/has ../kernel ./SimpleMarkerSymbol ./PictureMarkerSymbol ./SimpleLineSymbol ./CartographicLineSymbol ./SimpleFillSymbol ./PictureFillSymbol ./TextSymbol".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return{fromJson:function(b){var a=null;switch(b.type){case "esriSMS":a=new v(b);break;case "esriPMS":a=new n(b);break;case "esriTS":a=new e(b);break;case "esriSLS":a=void 0!==b.cap?new u(b):new m(b);break;case "esriCLS":a=new u(b);break;case "esriSFS":a=new k(b);break;case "esriPFS":a=new f(b)}return a},getShapeDescriptors:function(b){return b&&b.getShapeDescriptors?b.getShapeDescriptors():{defaultShape:null,fill:null,stroke:null}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol".split(" "),
function(p,g,t,v,n,m,u,k){var f={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(k,{declaredClass:"esri.symbol.PictureMarkerSymbol",type:"picturemarkersymbol",constructor:function(e,b,a){e?g.isString(e)?(this.url=e,b&&(this.width=b),a&&(this.height=a)):(this.width=v.pt2px(e.width),this.height=v.pt2px(e.height),b=e.imageData,9>t("ie")||!b||(a=this.url,this.url="data:"+(e.contentType||"image")+";base64,"+b,this.imageData=a)):(g.mixin(this,f),this.width=v.pt2px(this.width),this.height=v.pt2px(this.height))},
getStroke:function(){return null},getFill:function(){return null},setWidth:function(e){this.width=e;return this},setHeight:function(e){this.height=e;return this},setUrl:function(e){e!==this.url&&(delete this.imageData,delete this.contentType);this.url=e;return this},getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var e=this.url,b=
this.imageData;if(0===e.indexOf("data:"))var a=e,e=b,b=a.indexOf(";base64,")+8,b=a.substr(b);!g.isString(e)||0!==e.indexOf("/")&&0!==e.indexOf("//")&&0!==e.indexOf("./")&&0!==e.indexOf("../")||(e=u.getAbsoluteUrl(e));var a=v.px2pt(this.width),a=isNaN(a)?void 0:a,c=v.px2pt(this.height),c=isNaN(c)?void 0:c,e=m.fixJson(g.mixin(this.inherited("toJson",arguments),{type:"esriPMS",url:e,imageData:b,contentType:this.contentType,width:a,height:c}));delete e.color;delete e.size;e.imageData||delete e.imageData;
return e}});p.defaultProps=f;return p})},"esri/symbols/CartographicLineSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./SimpleLineSymbol".split(" "),function(p,g,t,v,n,m,u,k){var f={STYLE_SOLID:"solid",STYLE_DASH:"dash",STYLE_DOT:"dot",STYLE_DASHDOT:"dashdot",STYLE_DASHDOTDOT:"longdashdotdot",STYLE_NULL:"none",STYLE_INSIDE_FRAME:"insideframe",STYLE_SHORTDASH:"shortdash",STYLE_SHORTDOT:"shortdot",STYLE_SHORTDASHDOT:"shortdashdot",
STYLE_SHORTDASHDOTDOT:"shortdashdotdot",STYLE_LONGDASH:"longdash",STYLE_LONGDASHDOT:"longdashdot",CAP_BUTT:"butt",CAP_ROUND:"round",CAP_SQUARE:"square",JOIN_MITER:"miter",JOIN_ROUND:"round",JOIN_BEVEL:"bevel"},e={color:[0,0,0,1],style:f.STYLE_SOLID,width:1,cap:f.CAP_BUTT,join:f.JOIN_MITER,miterLimit:10};p=p(k,{declaredClass:"esri.symbol.CartographicLineSymbol",type:"cartographiclinesymbol",_caps:{butt:"esriLCSButt",round:"esriLCSRound",square:"esriLCSSquare"},_joins:{miter:"esriLJSMiter",round:"esriLJSRound",
bevel:"esriLJSBevel"},constructor:function(b,a,c,f,k,q){b?g.isString(b)?(this.style=b,a&&(this.color=a),void 0!==c&&(this.width=c),f&&(this.cap=f),k&&(this.join=k),void 0!==q&&(this.miterLimit=q)):(this.cap=u.valueOf(this._caps,b.cap),this.join=u.valueOf(this._joins,b.join),this.width=n.pt2px(b.width),this.miterLimit=n.pt2px(b.miterLimit)):(g.mixin(this,e),this.color=new t(this.color),this.width=n.pt2px(this.width),this.miterLimit=n.pt2px(this.miterLimit))},setCap:function(b){this.cap=b;return this},
setJoin:function(b){this.join=b;return this},setMiterLimit:function(b){this.miterLimit=b;return this},getStroke:function(){return g.mixin(this.inherited("getStroke",arguments),{cap:this.cap,join:this.join===f.JOIN_MITER?this.miterLimit:this.join})},getFill:function(){return null},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -15,0 L 15,0 E"},fill:null,stroke:this.getStroke()}},toJson:function(){var b=n.px2pt(this.miterLimit),b=isNaN(b)?void 0:b;return u.fixJson(g.mixin(this.inherited("toJson",
arguments),{type:"esriCLS",cap:this._caps[this.cap],join:this._joins[this.join],miterLimit:b}))}});g.mixin(p,f);p.defaultProps=e;return p})},"esri/symbols/SimpleFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has dojox/gfx/_base ../kernel ../lang ./FillSymbol ./SimpleLineSymbol require".split(" "),function(p,g,t,v,n,m,u,k,f,e){var b={STYLE_SOLID:"solid",STYLE_NULL:"none",STYLE_HORIZONTAL:"horizontal",STYLE_VERTICAL:"vertical",STYLE_FORWARD_DIAGONAL:"forwarddiagonal",
STYLE_BACKWARD_DIAGONAL:"backwarddiagonal",STYLE_CROSS:"cross",STYLE_DIAGONAL_CROSS:"diagonalcross",STYLE_FORWARDDIAGONAL:"forwarddiagonal",STYLE_BACKWARDDIAGONAL:"backwarddiagonal",STYLE_DIAGONALCROSS:"diagonalcross"},a={style:b.STYLE_SOLID,color:[0,0,0,.25]};p=p(k,{declaredClass:"esri.symbol.SimpleFillSymbol",type:"simplefillsymbol",_styles:{solid:"esriSFSSolid",none:"esriSFSNull",horizontal:"esriSFSHorizontal",vertical:"esriSFSVertical",forwarddiagonal:"esriSFSForwardDiagonal",backwarddiagonal:"esriSFSBackwardDiagonal",
cross:"esriSFSCross",diagonalcross:"esriSFSDiagonalCross"},constructor:function(b,e,k){b?g.isString(b)?(this.style=b,void 0!==e&&(this.outline=e),void 0!==k&&(this.color=k)):this.style=u.valueOf(this._styles,b.style):(g.mixin(this,a),this.outline=new f(this.outline),this.color=new t(this.color))},setStyle:function(a){this.style=a;return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){var a=this.style;return a===b.STYLE_NULL?null:a===b.STYLE_SOLID?this.color:
g.mixin({},n.defaultPattern,{src:e.toUrl("../images/symbol/sfs/"+a+".png"),width:10,height:10})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){return u.fixJson(g.mixin(this.inherited("toJson",arguments),{type:"esriSFS",style:this._styles[this.style]}))}});g.mixin(p,b);p.defaultProps=a;return p})},"esri/symbols/FillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ./Symbol ./SimpleLineSymbol".split(" "),
function(p,g,t,v,n,m){return p(n,{declaredClass:"esri.symbol.FillSymbol",constructor:function(n){n&&g.isObject(n)&&n.outline&&(this.outline=new m(n.outline))},setOutline:function(g){this.outline=g;return this},toJson:function(){var g=this.inherited("toJson",arguments);this.outline&&(g.outline=this.outline.toJson());return g}})})},"esri/symbols/PictureFillSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./FillSymbol".split(" "),
function(p,g,t,v,n,m,u,k){var f={xoffset:0,yoffset:0,width:12,height:12};p=p(k,{declaredClass:"esri.symbol.PictureFillSymbol",type:"picturefillsymbol",xscale:1,yscale:1,xoffset:0,yoffset:0,constructor:function(e,b,a,c){e?g.isString(e)?(this.url=e,void 0!==b&&(this.outline=b),void 0!==a&&(this.width=a),void 0!==c&&(this.height=c)):(this.xoffset=v.pt2px(e.xoffset),this.yoffset=v.pt2px(e.yoffset),this.width=v.pt2px(e.width),this.height=v.pt2px(e.height),b=e.imageData,9>t("ie")||!b||(a=this.url,this.url=
"data:"+(e.contentType||"image")+";base64,"+b,this.imageData=a)):(g.mixin(this,f),this.width=v.pt2px(this.width),this.height=v.pt2px(this.height))},setWidth:function(e){this.width=e;return this},setHeight:function(e){this.height=e;return this},setOffset:function(e,b){this.xoffset=e;this.yoffset=b;return this},setUrl:function(e){e!==this.url&&(delete this.imageData,delete this.contentType);this.url=e;return this},setXScale:function(e){this.xscale=e;return this},setYScale:function(e){this.yscale=e;
return this},getStroke:function(){return this.outline&&this.outline.getStroke()},getFill:function(){return g.mixin({},v.defaultPattern,{src:this.url,width:this.width*this.xscale,height:this.height*this.yscale,x:this.xoffset,y:this.yoffset})},getShapeDescriptors:function(){return{defaultShape:{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"},fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var e=this.url,b=this.imageData;if(0===e.indexOf("data:"))var a=e,e=b,b=a.indexOf(";base64,")+
8,b=a.substr(b);!g.isString(e)||0!==e.indexOf("/")&&0!==e.indexOf("//")&&0!==e.indexOf("./")&&0!==e.indexOf("../")||(e=u.getAbsoluteUrl(e));var a=v.px2pt(this.width),a=isNaN(a)?void 0:a,c=v.px2pt(this.height),c=isNaN(c)?void 0:c,f=v.px2pt(this.xoffset),f=isNaN(f)?void 0:f,k=v.px2pt(this.yoffset),k=isNaN(k)?void 0:k,e=m.fixJson(g.mixin(this.inherited("toJson",arguments),{type:"esriPFS",url:e,imageData:b,contentType:this.contentType,width:a,height:c,xoffset:f,yoffset:k,xscale:this.xscale,yscale:this.yscale}));
e.imageData||delete e.imageData;return e}});p.defaultProps=f;return p})},"esri/symbols/TextSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Symbol ./Font".split(" "),function(p,g,t,v,n,m,u,k,f){var e={type:"textsymbol",x:0,y:0,text:"",rotated:!1,kerning:!0,color:[0,0,0,1],font:v.defaultFont,angle:0,xoffset:0,yoffset:0,horizontalAlignment:"center"},b={start:"left",middle:"center",end:"right"},a={left:"start",center:"middle",right:"end",
justify:"start"},c={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},x=document.createElement("canvas");p=p(k,{declaredClass:"esri.symbol.TextSymbol",angle:0,xoffset:0,yoffset:0,constructor:function(a,b,c){g.mixin(this,e);this.font=new f(this.font);this.color=new u(this.color);a&&(g.isObject(a)?(g.mixin(this,a),this.color&&m.isDefined(this.color[0])&&(this.color=u.toDojoColor(this.color)),this.type="textsymbol",this.font=new f(this.font),this.xoffset=v.pt2px(this.xoffset),
this.yoffset=v.pt2px(this.yoffset),this.angle&&(this.angle*=-1),this.haloSize&&(this.haloSize=v.pt2px(this.haloSize)),this.haloColor&&(this.haloColor=u.toDojoColor(this.haloColor))):(this.text=a,b&&(this.font=b),c&&(this.color=c)));this.setAlign(this.align||this.getSVGAlign())},setFont:function(a){this.font=a;return this},setSize:function(a){this.font.size=a;return this},setAngle:function(a){this.angle=a;return this},setOffset:function(a,b){this.xoffset=a;this.yoffset=b;return this},setHaloColor:function(a){this.haloColor=
a;return this},setHaloSize:function(a){this.haloSize=a;return this},setAlign:function(a){this.align=a;this.setHorizontalAlignment(a&&b[a.toLowerCase()]||"center");return this},setHorizontalAlignment:function(a){this.horizontalAlignment=a;return this},getSVGAlign:function(){var b=this.horizontalAlignment;return b=b&&a[b.toLowerCase()]||"middle"},setVerticalAlignment:function(a){this.verticalAlignment=a;return this},getSVGBaseline:function(){var a=this.verticalAlignment;return a&&c[a.toLowerCase()]||
"alphabetic"},getSVGBaselineShift:function(){return"bottom"===this.verticalAlignment?"super":null},setDecoration:function(a){this.decoration=a;this.font||this.setFont(new f);this.font.setDecoration(a);return this},setRotated:function(a){this.rotated=a;return this},setKerning:function(a){this.kerning=a;return this},setText:function(a){this.text=a;return this},getStroke:function(){return null},getFill:function(){return this.color},getWidth:function(){var a=x&&x.getContext&&x.getContext("2d");if(a){var b=
this.font;a.font=(b.style?b.style:v.defaultFont.style)+" "+(b.weight?b.weight:v.defaultFont.weight)+" "+(b.size?b.size:v.defaultFont.size)+"px "+(b.family?b.family:v.defaultFont.family);return a.measureText(this.text).width}var a=this.getHeight(),b=0,c,e;for(c=0;c<this.text.length;c++)e=this.text.charAt(c),b=e==e.toUpperCase()?b+.7*a:b+.5*a;return b},getHeight:function(){return v.normalizedLength(this.font.size)},getShapeDescriptors:function(){var a=this.font,b;a&&(b={},a.size&&(b.size=a.size),a.style&&
(b.style=a.style),a.variant&&(b.variant=a.variant),a.decoration&&(b.decoration=a.decoration),a.weight&&(b.weight=a.weight),a.family&&(b.family=a.family));return{defaultShape:{type:"text",text:this.text,x:0,y:this.getHeight()/4,align:"middle",decoration:this.decoration||a&&a.decoration,rotated:this.rotated,kerning:this.kerning},font:b,fill:this.getFill(),stroke:this.getStroke()}},toJson:function(){var a=v.px2pt(this.xoffset),b=v.px2pt(this.yoffset),c=v.px2pt(this.haloSize),a=isNaN(a)?void 0:a,b=isNaN(b)?
void 0:b,c=isNaN(c)?void 0:c;return m.fixJson(g.mixin(this.inherited("toJson",arguments),{type:"esriTS",backgroundColor:this.backgroundColor,borderLineColor:this.borderLineColor,borderLineSize:this.borderLineSize,haloSize:c,haloColor:this.haloColor&&u.toJsonColor(this.haloColor),verticalAlignment:this.verticalAlignment,horizontalAlignment:this.horizontalAlignment,rightToLeft:this.rightToLeft,width:this.width,angle:this.angle&&-1*this.angle,xoffset:a,yoffset:b,text:this.text,rotated:this.rotated,kerning:this.kerning,
font:this.font.toJson()}))}});g.mixin(p,{ALIGN_START:"start",ALIGN_MIDDLE:"middle",ALIGN_END:"end",DECORATION_NONE:"none",DECORATION_UNDERLINE:"underline",DECORATION_OVERLINE:"overline",DECORATION_LINETHROUGH:"line-through"});p.defaultProps=e;return p})},"esri/symbols/Font":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang".split(" "),function(p,g,t,v,n,m){p=p(null,{declaredClass:"esri.symbol.Font",constructor:function(m,k,f,e,b){m?g.isObject(m)?g.mixin(this,
m):(this.size=m,parseFloat(this.size)==this.size&&(this.size+="px"),void 0!==k&&(this.style=k),void 0!==f&&(this.variant=f),void 0!==e&&(this.weight=e),void 0!==b&&(this.family=b)):g.mixin(this,v.defaultFont);parseFloat(this.size)==this.size&&(this.size+="pt");9>t("ie")&&this.size&&g.isString(this.size)&&-1<this.size.indexOf("em")&&(this.size=v.pt2px(12*parseFloat(this.size))+"px");this.size=this._convert2PxSize(this.size)},setSize:function(g){this.size=this._convert2PxSize(g);return this},_convert2PxSize:function(m){var k;
parseFloat(m)==m?k=m:g.isString(m)&&(-1<m.indexOf("pt")?k=v.pt2px(parseFloat(m)):-1<m.indexOf("px")?k=parseFloat(m):-1<m.indexOf("em")?k=v.pt2px(12*parseFloat(m)):-1<m.indexOf("%")&&(k=v.pt2px(.12*parseFloat(m))));return k},setStyle:function(g){this.style=g;return this},setVariant:function(g){this.variant=g;return this},setWeight:function(g){this.weight=g;return this},setFamily:function(g){this.family=g;return this},setDecoration:function(g){this.decoration=g;return this},toJson:function(){return m.fixJson({size:v.px2pt(this.size),
style:this.style,decoration:this.decoration,weight:this.weight,family:this.family})}});g.mixin(p,{STYLE_NORMAL:"normal",STYLE_ITALIC:"italic",STYLE_OBLIQUE:"oblique",VARIANT_NORMAL:"normal",VARIANT_SMALLCAPS:"small-caps",WEIGHT_NORMAL:"normal",WEIGHT_BOLD:"bold",WEIGHT_BOLDER:"bolder",WEIGHT_LIGHTER:"lighter"});return p})},"esri/tasks/query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils ./SpatialRelationship require require require".split(" "),
function(p,g,t,v,n,m,u,k){var f=p(null,{declaredClass:"esri.tasks.Query",constructor:function(){this.spatialRelationship=f.SPATIAL_REL_INTERSECTS},text:null,where:"",geometry:null,groupByFieldsForStatistics:null,objectIds:null,returnGeometry:!1,returnCentroid:null,returnDistinctValues:!1,returnExceededLimitFeatures:null,maxRecordCountFactor:null,orderByFields:null,outSpatialReference:null,outFields:null,outStatistics:null,timeExtent:null,relationParam:null,pixelSize:null,distance:null,units:null,
resultOffset:null,resultRecordCount:null,resultType:null,sqlFormat:null,quantizationParameters:null,_units:{meters:"esriSRUnit_Meter",kilometers:"esriSRUnit_Kilometer",feet:"esriSRUnit_Foot",miles:"esriSRUnit_StatuteMile","nautical-miles":"esriSRUnit_NauticalMile","us-nautical-miles":"esriSRUnit_USNauticalMile"},toJson:function(e){var b={text:this.text,where:this.where,returnGeometry:this.returnGeometry,spatialRel:this.spatialRelationship,maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision,
sqlFormat:this.sqlFormat},a=e&&e.geometry||this.geometry,c=this.objectIds,k=this.outFields,w=this.outSpatialReference,q=this.groupByFieldsForStatistics,g=this.orderByFields,m=this.outStatistics;e=this.distance;a&&(b.geometry=a,b.geometryType=u.getJsonType(a),b.inSR=a.spatialReference.wkid||v.toJson(a.spatialReference.toJson()));c&&(b.objectIds=c.join(","));k&&(b.outFields=k.join(","));null!=this.returnCentroid&&(b.returnCentroid=this.returnCentroid);this.returnDistinctValues&&(b.returnDistinctValues=
!0);null!=this.returnExceededLimitFeatures&&(b.returnExceededLimitFeatures=this.returnExceededLimitFeatures);null!=this.maxRecordCountFactor&&(b.maxRecordCountFactor=this.maxRecordCountFactor);q&&(b.groupByFieldsForStatistics=q.join(","));g&&(b.orderByFields=g.join(","));if(m){var n=[];t.forEach(m,function(a){n.push(a.toJson())});b.outStatistics=v.toJson(n)}w?b.outSR=w.wkid||v.toJson(w.toJson()):a&&(b.outSR=a.spatialReference.wkid||v.toJson(a.spatialReference.toJson()));a=this.timeExtent;b.time=a?
a.toJson().join(","):null;(a=this.relationParam)&&this.spatialRelationship===f.SPATIAL_REL_RELATION&&(b.relationParam=a);e&&(b.distance=this.distance,this.hasOwnProperty("units")?b.units=this._units[this.units]||this._units.meters:(console.warn("esri/tasks/query::no distance unit provided, defaulting to meters"),b.units=this._units.meters));this.hasOwnProperty("start")&&(b.resultOffset=this.start,b.resultRecordCount=10,""===b.where&&(b.where="1\x3d1"));this.hasOwnProperty("num")&&(b.resultRecordCount=
this.num);b.resultType=this.resultType;b.pixelSize=this.pixelSize?v.toJson(this.pixelSize.toJson()):null;b.multipatchOption=this.multipatchOption;this.quantizationParameters&&(b.quantizationParameters=v.toJson(this.quantizationParameters));b._ts=this._ts;return b}});g.mixin(f,k);return f})},"esri/tasks/SpatialRelationship":function(){define(["dojo/_base/lang","dojo/has","../kernel"],function(p,g,t){return{SPATIAL_REL_INTERSECTS:"esriSpatialRelIntersects",SPATIAL_REL_CONTAINS:"esriSpatialRelContains",
SPATIAL_REL_CROSSES:"esriSpatialRelCrosses",SPATIAL_REL_ENVELOPEINTERSECTS:"esriSpatialRelEnvelopeIntersects",SPATIAL_REL_INDEXINTERSECTS:"esriSpatialRelIndexIntersects",SPATIAL_REL_OVERLAPS:"esriSpatialRelOverlaps",SPATIAL_REL_TOUCHES:"esriSpatialRelTouches",SPATIAL_REL_WITHIN:"esriSpatialRelWithin",SPATIAL_REL_RELATION:"esriSpatialRelRelation"}})},"esri/plugins/popupManager":function(){define(["../PopupManager"],function(p){return{add:function(g,t){g.popupManager||(g.popupManager=new p(t),g.popupManager.setMap(g))},
remove:function(g){var p=g.popupManager;p&&(p.unsetMap(),g.popupManager=void 0)}}})},"esri/PopupManager":function(){define("./geometry/Extent ./geometry/ScreenPoint ./kernel ./layerUtils ./tasks/query dijit/registry dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/has dojo/on dojo/promise/all dojo/Stateful require".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){var q;return k(x,{declaredClass:"esri.PopupManager",enabled:!1,map:null,_mapClickHandle:null,_featureLayersCache:{},
constructor:function(a){this._mapClickHandler=e.hitch(this,this._mapClickHandler)},setMap:function(a){if(this.map)if(a!==this.map)this.unsetMap();else return;this.map=a;this._setupClickHandler()},unsetMap:function(){this.map&&(this.map=null);this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null)},getMapLayer:function(a){var b;if(a&&(b=a.getLayer())&&(a=b.id,this._featureLayersCache[a])){var c=a.lastIndexOf("_");-1<c&&(a=a.substring(0,c),b=this.map.getLayer(a))}return b},_enabledSetter:function(a){this.enabled=
a;this._setupClickHandler()},_setupClickHandler:function(){this._mapClickHandle&&(this._mapClickHandle.remove(),this._mapClickHandle=null);this.enabled&&this.map&&(this._mapClickHandle=this.map.on("click",this._mapClickHandler))},_mapClickHandler:function(a){var b=this.map.infoWindow,c=a.graphic;b&&this.map.loaded&&(b.clearFeatures&&b.setFeatures?this._showPopup(a):c&&c.getInfoTemplate()&&this._showInfoWindow(c,a.mapPoint))},_showPopup:function(a){var b=this.map,c=b.infoWindow,e=this,k=[],q=[b.graphics].concat(u.map(b.graphicsLayerIds,
b.getLayer,b));u.forEach(q,function(a){a&&a.loaded&&a.infoTemplate&&!a.suspended&&k.push(a)});var w=[];u.forEach(b.layerIds,function(a){(a=b.getLayer(a))&&a.loaded&&!a.suspended&&(e._isImageServiceLayer(a)&&a.infoTemplate?k.push(a):"esri.layers.WMSLayer"===a.declaredClass&&a.getFeatureInfoURL?k.push(a):"esri.layers.ArcGISDynamicMapServiceLayer"!==a.declaredClass&&"esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!a.infoTemplates||w.push(a))});var m=b.getResolutionForPopup();this._getSubLayerFeatureLayers(w,
m).then(function(q){k=k.concat(q);q=a.graphic&&a.graphic.getParentGraphic()||a.graphic;var w=null;q&&q.getInfoTemplate()&&!e._isImageServiceLayer(q.getLayer())&&(w=q);if(k.length||w){var x=e._calculateClickTolerance(k),B=a.screenPoint;q=b.toMap(new g(B.x-x,B.y+x));var x=b.toMap(new g(B.x+x,B.y-x)),z=new p(q.x,q.y,x.x,x.y,b.spatialReference);if(z=z.intersects(b.extent)){var C=new n,D=!!w,F=!0;q=u.map(k,function(c){C.timeExtent=c.useMapTime?b.timeExtent:null;var k=e._isReductionEnabled(c);c=k?c.getFeatureReductionLayer():
c;var q,A=e._featureLayersCache[c.id];if(e._isImageServiceLayer(c))C.geometry=a.mapPoint,F=!1,q=c.queryVisibleRasters(C,{rasterAttributeTableFieldPrefix:"Raster.",returnDomainValues:!0}),q.addCallback(function(){var a=c.getVisibleRasters();D=D||0<a.length;return a});else if("esri.layers.WMSLayer"===c.declaredClass){q=new f;var g=c._getPopupGraphic(b,a.screenPoint);g?(q.resolve([g]),D=!0):q.resolve([])}else A||"function"===typeof c.queryFeatures&&(0===c.currentMode||1===c.currentMode)?(C.geometry=
z,q=c.queryFeatures(C),q.addCallback(function(a){var l=[];u.forEach(a.features,function(d){d.visible&&(l.push(d),A&&d.setResolution(m))});D=D||0<l.length;return l})):(q=new f,g=u.filter(c.graphics,function(a){return a&&a.visible&&z.intersects(a.geometry)}),k&&e._isParentLayer(c,w)&&(k=e._findGraphicById(g,w,"cluster_id"))&&(w=k),D=D||0<g.length,q.resolve(g));return q});w&&(x=new f,x.resolve([w]),q.unshift(x));u.some(q,function(a){return!a.isFulfilled()})||D?(c.setFeatures(q),c.show(a.mapPoint,{closestFirst:F})):
(c.hide(),c.clearFeatures())}}})},_getSubLayerFeatureLayers:function(b,e,k){e=e||null;var g=k||new f,m=[];k=b.length;var x=this.map.getScale(),n=!1,z=this,p=0;a:for(;p<k;p++){var C=b[p],E=C.dynamicLayerInfos||C.layerInfos;if(E){var t=null;C._params&&(C._params.layers||C._params.dynamicLayers)&&(t=C.visibleLayers);for(var t=v._getVisibleLayers(E,t),Q=v._getLayersForScale(x,E),S=E.length,T=0;T<S;T++){var O=E[T],W=O.id,U=C.infoTemplates[W];if(!O.subLayerIds&&U&&U.infoTemplate&&-1<u.indexOf(t,W)&&-1<
u.indexOf(Q,W)){if(!q){n=!0;break a}var V=C.id+"_"+W,A=this._featureLayersCache[V];A&&A.loadError||(A||((A=U.layerUrl)||(A=O.source?this._getLayerUrl(C.url,"/dynamicLayer"):this._getLayerUrl(C.url,W)),A=new q(A,{parentLayer:C,id:V,drawMode:!1,mode:q.MODE_SELECTION,outFields:this._getOutFields(U.infoTemplate),resourceInfo:U.resourceInfo,source:O.source}),this._featureLayersCache[V]=A),A.setDefinitionExpression(C.layerDefinitions&&C.layerDefinitions[W]),A.setGDBVersion(C.gdbVersion),A.setInfoTemplate(U.infoTemplate),
A.setMaxAllowableOffset(e),A.setUseMapTime(!!C.useMapTime),C.layerDrawingOptions&&C.layerDrawingOptions[W]&&C.layerDrawingOptions[W].renderer&&A.setRenderer(C.layerDrawingOptions[W].renderer),m.push(A))}}}}if(n){var X=new f;w(["./layers/FeatureLayer"],function(l){q=l;X.resolve()});X.then(function(){z._getSubLayerFeatureLayers(b,e,g)})}else{var aa=[];u.forEach(m,function(l){if(!l.loaded){var d=new f;a.once(l,"load, error",function(){d.resolve()});aa.push(d.promise)}});aa.length?c(aa).then(function(){m=
u.filter(m,function(l){return!l.loadError&&l.isVisibleAtScale(x)});g.resolve(m)}):(m=u.filter(m,function(l){return l.isVisibleAtScale(x)}),g.resolve(m))}return g.promise},_getLayerUrl:function(a,b){var c=a.indexOf("?");return-1===c?a+"/"+b:a.substring(0,c)+"/"+b+a.substring(c)},_getOutFields:function(a){var b;a.info&&"esri.dijit.PopupTemplate"===a.declaredClass?(b=[],u.forEach(a.info.fieldInfos,function(a){var c=a.fieldName&&a.fieldName.toLowerCase();c&&"shape"!==c&&0!==c.indexOf("relationships/")&&
b.push(a.fieldName)})):b=["*"];return b},_calculateClickTolerance:function(a){var b=6,c,e;u.forEach(a,function(a){if(c=a.renderer)"esri.renderer.SimpleRenderer"===c.declaredClass?((e=c.symbol)&&e.xoffset&&(b=Math.max(b,Math.abs(e.xoffset))),e&&e.yoffset&&(b=Math.max(b,Math.abs(e.yoffset)))):"esri.renderer.UniqueValueRenderer"!==c.declaredClass&&"esri.renderer.ClassBreaksRenderer"!==c.declaredClass||u.forEach(c.infos,function(a){(e=a.symbol)&&e.xoffset&&(b=Math.max(b,Math.abs(e.xoffset)));e&&e.yoffset&&
(b=Math.max(b,Math.abs(e.yoffset)))})});return b},_showInfoWindow:function(a,b){var c=this.map.infoWindow,f=a.geometry;b=f&&"point"===f.type?f:b;f=a.getContent();c.setTitle(a.getTitle());f&&e.isString(f.id)&&(a=m.byId(f.id))&&a.set&&/_PopupRenderer/.test(a.declaredClass)&&a.set("showTitle",!1);c.setContent(f);c.show(b)},_findGraphicById:function(a,b,c){var e,f=(b=b.attributes)&&b[c];u.some(a,function(a){var b=a.attributes;b&&b[c]===f&&(e=a);return!!e});return e},_isParentLayer:function(a,b){b=b&&
b.getLayer();return a&&b===a},_isReductionEnabled:function(a){return a&&a.isFeatureReductionActive&&a.isFeatureReductionActive()},_isImageServiceLayer:function(a){return"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass}})})},"esri/layerUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/has","./kernel"],function(p,g,t,v,n){return{_serializeLayerDefinitions:function(m,n){var k=[],f=/[:;]/;if(m&&
(g.forEach(m,function(b,a){b&&(k.push([a,b]),!n&&f.test(b)&&(n=!0))}),0<k.length)){var e;n?(e={},g.forEach(k,function(b){e[b[0]]=b[1]}),e=t.toJson(e)):(e=[],g.forEach(k,function(b){e.push(b[0]+":"+b[1])}),e=e.join(";"));return e}return null},_serializeTimeOptions:function(m,n){if(m){var k=[];g.forEach(m,function(f,e){f&&(f=f.toJson(),n&&-1!==g.indexOf(n,e)&&(f.useTime=!1),k.push('"'+e+'":'+t.toJson(f)))});if(k.length)return"{"+k.join(",")+"}"}},_getVisibleLayers:function(m,n){var k=[],f,e;if(!m)return k;
if(n)for(k=n.concat(),e=0;e<m.length;e++)n=m[e],f=g.indexOf(m,n.id),n.subLayerIds&&-1<f&&(k.splice(f,1),k=k.concat(n.subLayerIds));else k=this._getDefaultVisibleLayers(m);return k},_getDefaultVisibleLayers:function(m){var n=[],k;if(!m)return n;for(k=0;k<m.length;k++)0<=m[k].parentLayerId&&-1===g.indexOf(n,m[k].parentLayerId)&&g.some(m,function(f){return f.id===m[k].parentLayerId})||m[k].defaultVisibility&&n.push(m[k].id);return n},_getLayersForScale:function(m,n){var k=[];if(0<m&&n){var f;for(f=0;f<
n.length;f++)if(!(0<=n[f].parentLayerId&&-1===g.indexOf(k,n[f].parentLayerId)&&g.some(n,function(a){return a.id===n[f].parentLayerId}))&&0<=n[f].id){var e=!0,b=n[f].maxScale,a=n[f].minScale;if(0<b||0<a)0<b&&0<a?e=b<=m&&m<=a:0<b?e=b<=m:0<a&&(e=m<=a);e&&k.push(n[f].id)}}return k}}})},"dojo/uacss":function(){define(["./dom-geometry","./_base/lang","./domReady","./sniff","./_base/window"],function(p,g,t,v,n){var m=n.doc.documentElement;n=v("ie");var u=v("trident"),k=v("opera"),f=Math.floor,e=v("ff"),
b=p.boxModel.replace(/-/,""),k={dj_quirks:v("quirks"),dj_opera:k,dj_khtml:v("khtml"),dj_webkit:v("webkit"),dj_safari:v("safari"),dj_chrome:v("chrome"),dj_edge:v("edge"),dj_gecko:v("mozilla"),dj_ios:v("ios"),dj_android:v("android")};n&&(k.dj_ie=!0,k["dj_ie"+f(n)]=!0,k.dj_iequirks=v("quirks"));u&&(k.dj_trident=!0,k["dj_trident"+f(u)]=!0);e&&(k["dj_ff"+f(e)]=!0);k["dj_"+b]=!0;var a="",c;for(c in k)k[c]&&(a+=c+" ");m.className=g.trim(m.className+" "+a);t(function(){if(!p.isBodyLtr()){var b="dj_rtl dijitRtl "+
a.replace(/ /g,"-rtl ");m.className=g.trim(m.className+" "+b+"dj_rtl dijitRtl "+a.replace(/ /g,"-rtl "))}});return v})},"esri/MapNavigationManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/event dojo/mouse dojo/keys dijit/focus ./kernel ./MouseEvents ./TouchEvents ./PointerEvents ./config ./sniff ./lang ./fx ./graphic ./tileUtils ./geometry/ScreenPoint ./geometry/Extent ./geometry/Rect ./geometry/mathUtils ./symbols/SimpleFillSymbol".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){var I=v.connect,K=v.disconnect,J=x("chrome"),L=x("safari"),M=[u.NUMPAD_PLUS,61,187,u.NUMPAD_MINUS,173,189,u.UP_ARROW,u.NUMPAD_8,u.RIGHT_ARROW,u.NUMPAD_6,u.DOWN_ARROW,u.NUMPAD_2,u.LEFT_ARROW,u.NUMPAD_4,u.PAGE_UP,u.NUMPAD_9,u.PAGE_DOWN,u.NUMPAD_3,u.END,u.NUMPAD_1,u.HOME,u.NUMPAD_7];return p(null,{declaredClass:"esri.MapNavigationManager",eventModel:"",constructor:function(f,k){this.map=f;g.mixin(this,k);k=f.__container;x("esri-pointer")?(this.pointerEvents=
new a(k,{map:f}),this.eventModel="pointer"):x("esri-touch")?(x("ios")||(this.mouseEvents=new e(k,{map:f})),this.touchEvents=new b(k,{map:f,mouseEvents:this.mouseEvents}),this.eventModel="touch"):(this.mouseEvents=new e(k,{map:f}),this.eventModel="mouse");this._zoomRect=new C(null,new D(c.defaults.map.zoomSymbol));this._keyDx=this._keyDy=0;this._adjustPinch=g.hitch(this,this._adjustPinch);this._adjustPinchEnd=g.hitch(this,this._adjustPinchEnd)},_panInit:function(a){var b=this.mouseEvents;m.isLeft(a)&&
this.map.isPan&&!a.shiftKey&&(this._dragOrigin=new E(0,0),g.mixin(this._dragOrigin,a.screenPoint),K(this._panStartHandle),K(this._panHandle),K(this._panEndHandle),this._panStartHandle=I(b,"onMouseDragStart",this,this._panStart),this._panHandle=I(b,"onMouseDrag",this,this._pan),this._panEndHandle=I(b,"onMouseUp",this,this._panEnd),J||L)&&(a.preventDefault(),k.curNode&&k.curNode.blur())},_panStart:function(a){this.map.setCursor("move");this.map.__panStart(a.screenPoint.x,a.screenPoint.y)},_pan:function(a){this.map.__pan(a.screenPoint.x-
this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)},_panEnd:function(a){K(this._panStartHandle);K(this._panHandle);K(this._panEndHandle);this._panStartHandle=this._panHandle=this._panEndHandle=null;var b=this.map;b.__panning&&(b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y),b.resetMapCursor())},_zoomInit:function(a){var b=this.map,c=this.pointerEvents||this.mouseEvents;(m.isLeft(a)||a.pointerType)&&b.isRubberBandZoom&&a.shiftKey&&(b.setCursor("crosshair"),this._dragOrigin=
g.mixin({},a.screenPoint),this._zoomDir=a.ctrlKey||a.metaKey?-1:1,this.pointerEvents?(this._zoomHandle=I(c,"onSwipeMove",this,this._zoom),this._zoomEndHandle=I(c,"onSwipeEnd",this,this._zoomEnd)):(this._zoomHandle=I(c,"onMouseDrag",this,this._zoom),this._zoomEndHandle=I(c,"onMouseUp",this,this._zoomEnd)),J&&a.preventDefault())},_zoom:function(a){var b=this.map,c=this._normalizeRect(a).offset(b.__visibleRect.x,b.__visibleRect.y);a=b.graphics;var e=this._zoomRect;e.geometry||b.setCursor("crosshair");
e.geometry&&a.remove(e,!0);var f=b.toMap(new E(c.x,c.y)),c=b.toMap(new E(c.x+c.width,c.y+c.height)),c=new G(f.x,f.y,c.x-f.x,f.y-c.y,b.spatialReference);c._originOnly=!0;e.setGeometry(c);a.add(e,!0)},_zoomEnd:function(a){var b=this._zoomRect,c=this.map,e=c.extent,f=c.spatialReference;K(this._zoomHandle);K(this._zoomEndHandle);this._zoomHandle=this._zoomEndHandle=null;if(c._canZoom(this._zoomDir)&&b.getDojoShape()){c.graphics.remove(b);b.geometry=null;a=this._normalizeRect(a);a.x+=c.__visibleRect.x;
a.y+=c.__visibleRect.y;if(-1===this._zoomDir){var k=e.getWidth();a=(k*c.width/a.width-k)/2;f=new B(e.xmin-a,e.ymin-a,e.xmax+a,e.ymax+a,f)}else e=c.toMap({x:a.x,y:a.y+a.height}),a=c.toMap({x:a.x+a.width,y:a.y}),f=new B(e.x,e.y,a.x,a.y,f);c._extentUtil(null,null,f)}b.getDojoShape()&&c.graphics.remove(b,!0);this._zoomDir=0;c.resetMapCursor()},_wheelZoom:function(a,b){var c=this.map;if(!b){if(c.smartNavigation&&!a.shiftKey&&!c._isPanningOrZooming()){c.disableScrollWheelZoom();this._setScrollWheelPan(!0);
this._wheelPan(a);return}b=a.timeStamp;if(!w.isDefined(b)||0>=b)b=(new Date).getTime();if(100>(this._mwts?b-this._mwts:b))return;this._mwts=b}c._canZoom(a.value)&&c._extentUtil({numLevels:a.value,mapAnchor:a.mapPoint,screenAnchor:a.screenPoint})},_wheelPan:function(a){var b=this.map;if(a.shiftKey&&!b._isPanningOrZooming())this._setScrollWheelPan(!1),b.enableScrollWheelZoom(),this._wheelZoom(a);else{var c=0,e=0;x("ff")?a.axis===a.HORIZONTAL_AXIS?c=-a.detail:e=-a.detail:(c=a.wheelDeltaX,e=a.wheelDeltaY);
b.translate(c,e)}},_setScrollWheelPan:function(a){this.map.isScrollWheelPan=a;this.mouseEvents.enableMouseWheel(a);K(this._mwMacHandle);this._mwMacHandle=null;a&&(this._mwMacHandle=I(this.mouseEvents,"onMouseWheel",this,this._wheelPan))},_recenter:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&this.map.centerAt(a.mapPoint)},_recenterZoom:function(a){a.shiftKey&&!this.map._isPanningOrZooming()&&(a.value=a.ctrlKey||a.metaKey?-1:1,this._wheelZoom(a,!0))},_dblClickZoom:function(a){this.map._isPanningOrZooming()||
(a.value=1,this._wheelZoom(a,!0))},_twoFingerTap:function(a){this.map._isPanningOrZooming()||(a.value=-1,this._wheelZoom(a,!0))},_keyDown:function(a){var b=a.keyCode,c=this.map;if(-1!==t.indexOf(M,b)){if(b===u.NUMPAD_PLUS||61===b||187===b)c._extentUtil({numLevels:1});else if(b===u.NUMPAD_MINUS||173===b||189===b)c._extentUtil({numLevels:-1});else{c.__panning||c.__panStart(0,0);switch(b){case u.UP_ARROW:case u.NUMPAD_8:this._keyDy+=10;break;case u.RIGHT_ARROW:case u.NUMPAD_6:this._keyDx-=10;break;case u.DOWN_ARROW:case u.NUMPAD_2:this._keyDy-=
10;break;case u.LEFT_ARROW:case u.NUMPAD_4:this._keyDx+=10;break;case u.PAGE_UP:case u.NUMPAD_9:this._keyDx-=10;this._keyDy+=10;break;case u.PAGE_DOWN:case u.NUMPAD_3:this._keyDx-=10;this._keyDy-=10;break;case u.END:case u.NUMPAD_1:this._keyDx+=10;this._keyDy-=10;break;case u.HOME:case u.NUMPAD_7:this._keyDx+=10;this._keyDy+=10;break;default:return}c.__pan(this._keyDx,this._keyDy)}n.stop(a)}},_keyEnd:function(a){var b=this.map;b.__panning&&a.keyCode!==u.SHIFT&&(b.__panEnd(this._keyDx,this._keyDy),
this._keyDx=this._keyDy=0)},_swipeInit:function(a){var b=this.map,b=b._zoomAnim||b._panAnim;if(a.shiftKey)return!1;b&&b._active&&(b.stop(),b._fire("onEnd",[b.node]));this._dragOrigin=new E(0,0);g.mixin(this._dragOrigin,a.screenPoint);K(this._swipeHandle);K(this._swipeEndHandle);this._swipeHandle=I(this.touchEvents||this.pointerEvents,"onSwipeMove",this,this._swipe);this._swipeEndHandle=I(this.touchEvents||this.pointerEvents,"onSwipeEnd",this,this._swipeEnd)},_swipe:function(a){var b=this.map;b.__panning?
(this._panX=a.screenPoint.x,this._panY=a.screenPoint.y,b.__pan(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y)):(b.setCursor("move"),b.__panStart(a.screenPoint.x,a.screenPoint.y))},_swipeEnd:function(a){K(this._swipeHandle);K(this._swipeEndHandle);this._swipeHandle=this._swipeEndHandle=null;var b=this.map;b.__panning&&(b.resetMapCursor(),b.__panEnd(a.screenPoint.x-this._dragOrigin.x,a.screenPoint.y-this._dragOrigin.y))},_pinchInit:function(a){var b=this.map,c=b._zoomAnim||b._panAnim;
c&&c._active?(c.stop(),c._fire("onEnd",[c.node])):b.__panning&&(a.screenPoint=new E(this._panX,this._panY),a.mapPoint=b.toMap(a.screenPoint),this._swipeEnd(a));K(this._pinchHandle);K(this._pinchEndHandle);this._pinchHandle=I(this.touchEvents||this.pointerEvents,"onPinchMove",this,this._pinch);this._pinchEndHandle=I(this.touchEvents||this.pointerEvents,"onPinchEnd",this,this._pinchEnd)},_pinch:function(a){var b=this.map;if(a.screenPoints){this.currLength=F.getLength(a.screenPoints[0],a.screenPoints[1]);
var c;b.__zooming?(c=this.currLength/this._length,this._zoomStartExtent=this.__scaleExtent(b.extent,c,this._dragOrigin),b.__zoom(this._zoomStartExtent,c,this._dragOrigin)):(this._dragOrigin=new E((a.screenPoints[0].x+a.screenPoints[1].x)/2,(a.screenPoints[0].y+a.screenPoints[1].y)/2),this._length=this.currLength,b.__zoomStart(b.extent,this._dragOrigin));this._pinchScale=c;b._fireOnScale(this.currLength/this._length,this._dragOrigin,!0)}},_pinchEnd:function(a){a=this.map;K(this._pinchHandle);K(this._pinchEndHandle);
this._pinchHandle=this._pinchEndHandle=null;this._pinchScale=0;if(a.__zooming&&null===a._zoomAnim){var b=this.currLength/this._length,e=a.extent.getWidth();this._zoomAnimAnchor=a.toMap(this._dragOrigin);this._zoomStartExtent=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor);if(a.__tileInfo){var f=z.getCandidateTileInfo(a,a.__tileInfo,this._zoomStartExtent),k=a.__getExtentForLevel(f.lod.level,this._zoomAnimAnchor),w=a.getMinZoom(),g=a.getMaxZoom(),A=k.extent,k=k.lod,m=e/A.getWidth(),x=f.lod.level;
1>b?m>b&&x--:m<b&&x++;x<w?x=w:x>g&&(x=g);x!==f.lod.level&&(k=a.__getExtentForLevel(x,this._zoomAnimAnchor),A=k.extent,k=k.lod);this._zoomEndExtent=A;this._zoomEndLod=k;a._zoomAnim=q.animateRange({range:{start:e/this._zoomStartExtent.getWidth(),end:m},duration:c.defaults.map.zoomDuration,rate:c.defaults.map.zoomRate,onAnimate:this._adjustPinch,onEnd:this._adjustPinchEnd});a._zoomAnim.play();a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin)}else this._zoomEndExtent=
this._zoomStartExtent,a._fireOnScale(a.extent.getWidth()/this._zoomEndExtent.getWidth(),this._dragOrigin),this._adjustPinchEnd()}},_adjustPinch:function(a){var b=this.__scaleExtent(this.map.extent,a,this._zoomAnimAnchor);this.map.__zoom(b,a,this._dragOrigin)},_adjustPinchEnd:function(){var a=this.map,b=a.extent.getWidth()/this._zoomEndExtent.getWidth(),c=this.__scaleExtent(a.extent,1/b,this._zoomAnimAnchor),e=this._dragOrigin,f=this._zoomEndLod;this._zoomStartExtent=this._zoomEndExtent=this._zoomEndLod=
this._dragOrigin=a._zoomAnim=this._zoomAnimAnchor=null;a.__zoomEnd(c,b,e,f,!0)},__scaleExtent:function(a,b,c){c=c||a.getCenter();b=a.expand(b);var e=a.xmin-(b.getWidth()-a.getWidth())*(c.x-a.xmin)/a.getWidth();c=a.ymax-(b.getHeight()-a.getHeight())*(c.y-a.ymax)/a.getHeight();return new B(e,c-b.getHeight(),e+b.getWidth(),c,a.spatialReference)},_normalizeRect:function(a){a=a.screenPoint;var b=this._dragOrigin.x,c=this._dragOrigin.y;a=new G((a.x<b?a.x:b)-this.map.__visibleRect.x,(a.y<c?a.y:c)-this.map.__visibleRect.y,
Math.abs(a.x-b),Math.abs(a.y-c));delete a.spatialReference;0===a.width&&(a.width=1);0===a.height&&(a.height=1);return a},setImmediateClick:function(a){switch(this.eventModel){case "mouse":this.mouseEvents.setImmediateClick(a);break;case "touch":this.touchEvents.setImmediateTap(a);this.mouseEvents&&this.mouseEvents.setImmediateClick(a);break;case "pointer":this.pointerEvents.setImmediateTap(a)}},enablePan:function(){this.disablePan();switch(this.eventModel){case "mouse":this._panInitHandle=I(this.mouseEvents,
"onMouseDown",this,this._panInit);break;case "touch":this._panInitHandle=I(this.mouseEvents,"onMouseDown",this,this._panInit);this._swipeInitHandle=I(this.touchEvents,"onSwipeStart",this,this._swipeInit);break;case "pointer":this._swipeInitHandle=I(this.pointerEvents,"onSwipeStart",this,this._swipeInit)}},disablePan:function(){K(this._panInitHandle);this._panInitHandle=null;K(this._swipeInitHandle);this._swipeInitHandle=null},enableRubberBandZoom:function(){this.disableRubberBandZoom();this._zoomInitHandle=
this.pointerEvents?I(this.pointerEvents,"onSwipeStart",this,this._zoomInit):I(this.mouseEvents,"onMouseDown",this,this._zoomInit)},disableRubberBandZoom:function(){K(this._zoomInitHandle);this._zoomInitHandle=null},enablePinchZoom:function(){this.disablePinchZoom();if("touch"===this.eventModel||"pointer"===this.eventModel)this._pinchInitHandle=I(this.touchEvents||this.pointerEvents,"onPinchStart",this,this._pinchInit)},disablePinchZoom:function(){K(this._pinchInitHandle);this._pinchInitHandle=null},
enableScrollWheelZoom:function(){this.disableScrollWheelZoom();this._wheelHandle=I(this.mouseEvents||this.pointerEvents,"onMouseWheel",this,this._wheelZoom)},disableScrollWheelZoom:function(){K(this._wheelHandle);this._wheelHandle=null},enableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&(this.disableScrollWheelPan(),this._setScrollWheelPan(!0))},disableScrollWheelPan:function(){var a=this.map;a&&a.loaded&&a.smartNavigation&&this._setScrollWheelPan(!1)},enableDoubleClickZoom:function(){this.disableDoubleClickZoom();
switch(this.eventModel){case "mouse":this._dblClickHandle=I(this.mouseEvents,"onDblClick",this,this._dblClickZoom);break;case "touch":this._dblClickHandle=I(this.mouseEvents,"onDblClick",this,this._dblClickZoom);this._dblTapHandle=I(this.touchEvents,"onDoubleTap",this,this._dblClickZoom);this._zoomOutHandle=I(this.touchEvents,"onTwoFingerTap",this,this._twoFingerTap);break;case "pointer":this._dblTapHandle=I(this.pointerEvents,"onDoubleTap",this,this._dblClickZoom),this._zoomOutHandle=I(this.pointerEvents,
"onTwoFingerTap",this,this._twoFingerTap)}},disableDoubleClickZoom:function(){K(this._dblClickHandle);K(this._zoomOutHandle);this._dblTapHandle&&K(this._dblTapHandle);this._dblClickHandle=this._zoomOutHandle=this._dblTapHandle=null},enableShiftDoubleClickZoom:function(){this.disableShiftDoubleClickZoom();this._sDblClickHandle=I(this.pointerEvents||this.mouseEvents,"onDblClick",this,this._recenterZoom)},disableShiftDoubleClickZoom:function(){K(this._sDblClickHandle);this._sDblClickHandle=null},enableClickRecenter:function(){this.disableClickRecenter();
this._recenterHandle=I(this.pointerEvents||this.mouseEvents,"onClick",this,this._recenter)},disableClickRecenter:function(){K(this._recenterHandle);this._recenterHandle=null},enableKeyboardNavigation:function(){this.disableKeyboardNavigation();this._keyHandle=I(this.pointerEvents||this.mouseEvents,"onKeyDown",this,this._keyDown);this._keyEndHandle=I(this.pointerEvents||this.mouseEvents,"onKeyUp",this,this._keyEnd)},disableKeyboardNavigation:function(){K(this._keyHandle);K(this._keyEndHandle);this._keyHandle=
this._keyEndHandle=null},enableScrollWheel:function(){var a=this.map;a&&(a.smartNavigation?this.enableScrollWheelPan():a.enableScrollWheelZoom())},disableScrollWheel:function(){var a=this.map;a&&(a.disableScrollWheelZoom(),a.smartNavigation&&this.disableScrollWheelPan())},enableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),
a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},disableNavigation:function(){var a=this.map;a&&a.loaded&&(a._evalNavigationFeature("DoubleClickZoom"),a._evalNavigationFeature("ClickRecenter"),a._evalNavigationFeature("Pan"),a._evalNavigationFeature("RubberBandZoom"),a._evalNavigationFeature("PinchZoom"),a._evalNavigationFeature("KeyboardNavigation"),a._evalNavigationFeature("ScrollWheel"))},destroy:function(){this.touchEvents&&this.touchEvents.destroy();this.mouseEvents&&
this.mouseEvents.destroy();this.pointerEvents&&this.pointerEvents.destroy();var a,b=[this._panInitHandle,this._panStartHandle,this._panHandle,this._panEndHandle,this._zoomInitHandle,this._zoomHandle,this._zoomEndHandle,this._wheelHandle,this._mwMacHandle,this._dblClickHandle,this._zoomOutHandle,this._recenterHandle,this._sDblClickHandle,this._dblTapHandle,this._keyHandle,this._keyEndHandle,this._swipeInitHandle,this._swipeHandle,this._swipeEndHandle,this._pinchInitHandle,this._pinchHandle,this._pinchEndHandle];
for(a=0;a<b.length;a++)K(b[a]);this.map=this.touchEvents=this.mouseEvents=this.eventModel=this.pointerEvents=this._zoomRect=this._dragOrigin=this._panInitHandle=this._panStartHandle=this._panHandle=this._panEndHandle=this._zoomInitHandle=this._zoomHandle=this._zoomEndHandle=this._wheelHandle=this._mwMacHandle=this._dblClickHandle=this._zoomOutHandle=this._recenterHandle=this._sDblClickHandle=this._dblTapHandle=this._keyHandle=this._keyEndHandle=this._swipeInitHandle=this._swipeHandle=this._swipeEndHandle=
this._pinchInitHandle=this._pinchHandle=this._pinchEndHandle=null}})})},"dijit/focus":function(){define("dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/Evented dojo/_base/lang dojo/on dojo/domReady dojo/sniff dojo/Stateful dojo/_base/window dojo/window ./a11y ./registry ./main".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){var z,E,B=new (g([a,u],{curNode:null,activeStack:[],constructor:function(){var a=k.hitch(this,function(a){t.isDescendant(this.curNode,
a)&&this.set("curNode",null);t.isDescendant(this.prevNode,a)&&this.set("prevNode",null)});p.before(m,"empty",a);p.before(m,"destroy",a)},registerIframe:function(a){return this.registerWin(a.contentWindow,a)},registerWin:function(a,c){var e=this,k=a.document&&a.document.body;if(k){var q=b("pointer-events")?"pointerdown":b("MSPointer")?"MSPointerDown":b("touch-events")?"mousedown, touchstart":"mousedown",g=f(a.document,q,function(a){a&&a.target&&null==a.target.parentNode||e._onTouchNode(c||a.target,
"mouse")}),m=f(k,"focusin",function(a){if(a.target.tagName){var b=a.target.tagName.toLowerCase();"#document"!=b&&"body"!=b&&(w.isFocusable(a.target)?e._onFocusNode(c||a.target):e._onTouchNode(c||a.target))}}),x=f(k,"focusout",function(a){e._onBlurNode(c||a.target)});return{remove:function(){g.remove();m.remove();x.remove();k=g=m=x=null}}}},_onBlurNode:function(a){a=(new Date).getTime();a<z+100||(this._clearFocusTimer&&clearTimeout(this._clearFocusTimer),this._clearFocusTimer=setTimeout(k.hitch(this,
function(){this.set("prevNode",this.curNode);this.set("curNode",null)}),0),this._clearActiveWidgetsTimer&&clearTimeout(this._clearActiveWidgetsTimer),a<E+100||(this._clearActiveWidgetsTimer=setTimeout(k.hitch(this,function(){delete this._clearActiveWidgetsTimer;this._setStack([])}),0)))},_onTouchNode:function(a,b){E=(new Date).getTime();this._clearActiveWidgetsTimer&&(clearTimeout(this._clearActiveWidgetsTimer),delete this._clearActiveWidgetsTimer);n.contains(a,"dijitPopup")&&(a=a.firstChild);var e=
[];try{for(;a;){var f=v.get(a,"dijitPopupParent");if(f)a=q.byId(f).domNode;else if(a.tagName&&"body"==a.tagName.toLowerCase()){if(a===c.body())break;a=x.get(a.ownerDocument).frameElement}else{var k=a.getAttribute&&a.getAttribute("widgetId"),w=k&&q.byId(k);!w||"mouse"==b&&w.get("disabled")||e.unshift(k);a=a.parentNode}}}catch(M){}this._setStack(e,b)},_onFocusNode:function(a){a&&9!=a.nodeType&&(z=(new Date).getTime(),this._clearFocusTimer&&(clearTimeout(this._clearFocusTimer),delete this._clearFocusTimer),
this._onTouchNode(a),a!=this.curNode&&(this.set("prevNode",this.curNode),this.set("curNode",a)))},_setStack:function(a,b){var c=this.activeStack,e=c.length-1,f=a.length-1;if(a[f]!=c[e]){this.set("activeStack",a);var k;for(k=e;0<=k&&c[k]!=a[k];k--)if(e=q.byId(c[k]))e._hasBeenBlurred=!0,e.set("focused",!1),e._focusManager==this&&e._onBlur(b),this.emit("widget-blur",e,b);for(k++;k<=f;k++)if(e=q.byId(a[k]))e.set("focused",!0),e._focusManager==this&&e._onFocus(b),this.emit("widget-focus",e,b)}},focus:function(a){if(a)try{a.focus()}catch(D){}}}));
e(function(){var a=B.registerWin(x.get(document));b("ie")&&f(window,"unload",function(){a&&(a.remove(),a=null)})});C.focus=function(a){B.focus(a)};for(var G in B)/^_/.test(G)||(C.focus[G]="function"==typeof B[G]?k.hitch(B,G):B[G]);B.watch(function(a,b,c){C.focus[a]=c});return B})},"dijit/a11y":function(){define("dojo/_base/array dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/sniff ./main".split(" "),function(p,g,t,v,n,m,u){var k={_isElementShown:function(f){var e=v.get(f);return"hidden"!=
e.visibility&&"collapsed"!=e.visibility&&"none"!=e.display&&"hidden"!=t.get(f,"type")},hasDefaultTabStop:function(f){switch(f.nodeName.toLowerCase()){case "a":return t.has(f,"href");case "area":case "button":case "input":case "object":case "select":case "textarea":return!0;case "iframe":var e;try{var b=f.contentDocument;if("designMode"in b&&"on"==b.designMode)return!0;e=b.body}catch(a){try{e=f.contentWindow.document.body}catch(c){return!1}}return e&&("true"==e.contentEditable||e.firstChild&&"true"==
e.firstChild.contentEditable);default:return"true"==f.contentEditable}},effectiveTabIndex:function(f){if(!t.get(f,"disabled"))return t.has(f,"tabIndex")?+t.get(f,"tabIndex"):k.hasDefaultTabStop(f)?0:void 0},isTabNavigable:function(f){return 0<=k.effectiveTabIndex(f)},isFocusable:function(f){return-1<=k.effectiveTabIndex(f)},_getTabNavigable:function(f){function e(a){return a&&"input"==a.tagName.toLowerCase()&&a.type&&"radio"==a.type.toLowerCase()&&a.name&&a.name.toLowerCase()}function b(a){return u[e(a)]||
a}var a,c,g,w,q,n,u={},p=k._isElementShown,B=k.effectiveTabIndex,v=function(b){for(b=b.firstChild;b;b=b.nextSibling)if(!(1!=b.nodeType||9>=m("ie")&&"HTML"!==b.scopeName)&&p(b)){var f=B(b);if(0<=f){if(0==f)a||(a=b),c=b;else if(0<f){if(!g||f<w)w=f,g=b;if(!q||f>=n)n=f,q=b}f=e(b);t.get(b,"checked")&&f&&(u[f]=b)}"SELECT"!=b.nodeName.toUpperCase()&&v(b)}};p(f)&&v(f);return{first:b(a),last:b(c),lowest:b(g),highest:b(q)}},getFirstInTabbingOrder:function(f,e){f=k._getTabNavigable(g.byId(f,e));return f.lowest?
f.lowest:f.first},getLastInTabbingOrder:function(f,e){f=k._getTabNavigable(g.byId(f,e));return f.last?f.last:f.highest}};n.mixin(u,k);return k})},"esri/MouseEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/_base/connect dojo/_base/event ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,g,t,v,n,m,u,k,f,e){var b=n.connect,a=n.disconnect;return p([k],{declaredClass:"esri.MouseEvents",doubleClickDuration:300,minWheelValue:1,
maxWheelValue:1,mozWheelDivisor:-1!==v("mac")?1:3,wheelDivisor:2>v("chrome")?360:120,preventPageScroll:!0,map:null,constructor:function(a,e){this.node=a;t.mixin(this,e);e=function(a){m.stop(a);return!1};v("mozilla")&&g.style(a,"MozUserSelect","none");this._handles=[b(a,"onselectstart",e),b(a,"ondragstart",e),b(a,"onmouseenter",this,this._onMouseEnterHandler),b(a,"onmouseleave",this,this._onMouseLeaveHandler),b(a,"onmousedown",this,this._onMouseDownHandler),b(a,"onclick",this,this._onClickHandler),
b(a,"ondblclick",this,this._onDblClickHandler)];this._onMouseMoveHandler_connect=b(a,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=b(a,"onmouseup",this,this._onMouseUpHandler);this._fireClickEvent=t.hitch(this,this._fireClickEvent);this._initialDuration=this.doubleClickDuration;this.preventPageScroll=(a=this.map)?a.isScrollWheelZoom||a.isScrollWheelPan:this.preventPageScroll;this.enableMouseWheel(!1)},_fire:function(a,b){if(!this._preventClick||"onClick"!==a&&"onDblClick"!==
a){if(this[a])this[a](b);if(this.map&&this.map[a])this.map[a](b)}},_processEvent:function(a){a=m.fix(a,a.target);var b=this.map,c=b&&b.position;c&&("DOMMouseScroll"===a.type&&3>v("ff")?a.screenPoint=new e(window.scrollX+a.screenX-c.x,window.scrollY+a.screenY-c.y):a.screenPoint=new e(a.pageX-c.x,a.pageY-c.y),a.mapPoint=b.extent?b.toMap(a.screenPoint):new f);a.numPoints=0;return a},_onMouseEnterHandler:function(c){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=b(document,
"onkeydown",this,this._onKeyDownHandler);this._onKeyUp_connect=b(document,"onkeyup",this,this._onKeyUpHandler);this._fire("onMouseOver",this._processEvent(c))},_onMouseLeaveHandler:function(b){a(this._onKeyDown_connect);a(this._onKeyUp_connect);this._onKeyDown_connect=this._onKeyUp_connect=null;this._fire("onMouseOut",this._processEvent(b))},_onMouseMoveHandler:function(a){this._dragEnd?this._dragEnd=!1:this._fire("onMouseMove",this._processEvent(a))},_onMouseDownHandler:function(c){a(this._onMouseMoveHandler_connect);
this._onMouseMoveHandler_connect=null;this.node.setCapture&&this.node.setCapture(!1);a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=b(document,"onmousemove",this,this._onMouseDragHandler);this._startX=c.pageX;this._startY=c.pageY;this._fire("onMouseDown",this._processEvent(c))},_onMouseUpHandler:function(c){var e=this.node;e.releaseCapture&&e.releaseCapture();a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=null;a(this._onMouseMoveHandler_connect);this._onMouseMoveHandler_connect=
b(e,"onmousemove",this,this._onMouseMoveHandler);this._fire("onMouseUp",this._processEvent(c))},_onMouseDragHandler:function(c){a(this._onMouseDragHandler_connect);this._onMouseDragHandler_connect=b(document,"onmousemove",this,this._onMouseDraggingHandler);a(this._onMouseUpHandler_connect);this._onMouseUpHandler_connect=b(document,"onmouseup",this,this._onDragMouseUpHandler);this._docLeaveConnect=b(document,"onmouseout",this,this._onDocMouseOut);this._fire("onMouseDragStart",this._processEvent(c))},
_onMouseDraggingHandler:function(a){m.stop(a);this._fire("onMouseDrag",this._processEvent(a))},_onDragMouseUpHandler:function(c){var e=this.node;e.releaseCapture&&e.releaseCapture();this._dragEnd=!0;a(this._docLeaveConnect);a(this._onMouseDragHandler_connect);a(this._onMouseUpHandler_connect);this._docLeaveConnect=this._onMouseDragHandler_connect=null;this._onMouseMoveHandler_connect=b(e,"onmousemove",this,this._onMouseMoveHandler);this._onMouseUpHandler_connect=b(e,"onmouseup",this,this._onMouseUpHandler);
c=this._processEvent(c);this._fire("onMouseDragEnd",c);this._fire("onMouseUp",c)},_onDocMouseOut:function(a){var b=9>v("ie")?a.toElement:a.relatedTarget,c=b&&b.nodeName.toLowerCase();(!b||(v("chrome")||v("safari"))&&"html"===c)&&this._onDragMouseUpHandler(a)},_onClickHandler:function(a){a=this._processEvent(a);if(a.pageX===this._startX&&a.pageY===this._startY){clearTimeout(this._clickTimer);var b={},c="movementX"in a,e;for(e in a)if(!c||"webkitMovementX"!==e&&"webkitMovementY"!==e)b[e]=a[e];this._clickEvent=
b;this._clickTimer=setTimeout(this._fireClickEvent,this.doubleClickDuration)}},_fireClickEvent:function(){clearTimeout(this._clickTimer);9>v("ie")&&(this._clickEvent.graphic=u._ieGraphic,delete u._ieGraphic);this._fire("onClick",this._clickEvent)},_onDblClickHandler:function(a){clearTimeout(this._clickTimer);this._fire("onDblClick",this._processEvent(a))},_onMouseWheelHandler:function(a){var b=this.map;(b?b.isScrollWheelZoom||b.isScrollWheelPan:this.preventPageScroll)&&m.stop(a);var b=v("ff")||v("mozilla")?
-a.detail/this.mozWheelDivisor:a.wheelDelta/this.wheelDivisor,c=Math.abs(b),c=c<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;a.value=0>b?-c:c;this._fire("onMouseWheel",this._processEvent(a))},_onKeyDownHandler:function(a){this._fire("onKeyDown",a)},_onKeyUpHandler:function(a){this._fire("onKeyUp",a)},enableMouseWheel:function(c){a(this._scrollHandle);this._scrollHandle=b(this.node,v("ff")||v("mozilla")?c?"MozMousePixelScroll":"DOMMouseScroll":"onmousewheel",this,this._onMouseWheelHandler)},
setImmediateClick:function(a){this.doubleClickDuration=a?0:this._initialDuration},preventClickEvents:function(a){this._preventClick=a},destroy:function(){var b=this._handles.concat([this._onMouseMoveHandler_connect,this._onMouseUpHandler_connect,this._onMouseDragHandler_connect,this._scrollHandle,this._onKeyDown_connect,this._onKeyUp_connect,this._docLeaveConnect]),e;for(e=0;e<b.length;e++)a(b[e]);clearTimeout(this._clickTimer);this.node=this.map=this._handles=this._clickEvent=this._onMouseMoveHandler_connect=
this._onMouseUpHandler_connect=this._onMouseDragHandler_connect=this._scrollHandle=this._onKeyDown_connect=this._onKeyUp_connect=this._docLeaveConnect=null}})})},"esri/TouchEvents":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/sniff dojo/dom ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,g,t,v,n,m,u,k,f){return p([u],{declaredClass:"esri.TouchEvents",tapRadius:8,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,map:null,
constructor:function(e,b){this.node=e;t.mixin(this,b);g.setSelectable(e,!1);this._touchStart=t.hitch(this,this._touchStart);this._touchMove=t.hitch(this,this._touchMove);this._touchEnd=t.hitch(this,this._touchEnd);this._touchCancel=t.hitch(this,this._touchCancel);this._fireClickEvent=t.hitch(this,this._fireClickEvent);e.addEventListener("touchstart",this._touchStart,!1);e.addEventListener("touchmove",this._touchMove,!1);e.addEventListener("touchend",this._touchEnd,!1);e.addEventListener("touchcancel",
this._touchCancel,!1);this.map&&v("ios")&&(this._mouseOver=t.hitch(this,this._mouseOver),this._mouseOut=t.hitch(this,this._mouseOut),this._mouseDown=t.hitch(this,this._mouseDown),this._mouseUp=t.hitch(this,this._mouseUp),this._mouseClick=t.hitch(this,this._mouseClick),e.addEventListener("mouseover",this._mouseOver,!1),e.addEventListener("mouseout",this._mouseOut,!1),e.addEventListener("mousedown",this._mouseDown,!1),e.addEventListener("mouseup",this._mouseUp,!1),e.addEventListener("click",this._mouseClick,
!1));this._numTouches=0;this._nodeTouches=[];this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_touchStart:function(e){var b=this._touches,a,c=e.changedTouches.length,f,k,q,g,m=(new Date).getTime();this._touchStartTS=m;if(!(v("android")&&v("safari")&&1===e.targetTouches.length&&e.touches.length===e.targetTouches.length&&e.targetTouches.length===e.changedTouches.length&&0===e.changedTouches[0].identifier&&b[e.changedTouches[0].identifier])){this._addTouch(e);for(a=0;a<c;a++)f=e.changedTouches[a],
k=b[f.identifier]={},k.startX=f.pageX,k.startY=f.pageY,k.startTS=m,-1===this._touchIds.indexOf(f.identifier)&&this._touchIds.push(f.identifier);this._swipeActive&&(q=this._nodeTouches[0]);this._pinchActive&&(g=this._nodeTouches[1]);1===this._numTouches?this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,q))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(e,[q,g]))):2===this._numTouches?this._swipeActive&&(q&&(k=b[this._touchIds[0]],
k.startX=q.pageX,k.startY=q.pageY,k.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,q))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,q))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(e,[q,g])))}},_touchMove:function(e){e.preventDefault();this._updateTouch(e);var b=this._touches,a,c=e.changedTouches.length,f,k,q,g;if(!(v("android")&&v("safari")&&1===e.targetTouches.length&&e.touches.length===
e.targetTouches.length&&e.targetTouches.length===e.changedTouches.length&&0===e.changedTouches[0].identifier&&b[e.changedTouches[0].identifier]&&1<this._touchIds.length)){for(a=0;a<c;a++)if(f=e.changedTouches[a],k=b[f.identifier])q=Math.abs(f.pageX-k.startX),f=Math.abs(f.pageY-k.startY),!k.moved&&(q>=this.tapRadius||f>=this.tapRadius)&&(k.moved=k.absMoved=!0),g=g?g:k.moved;1===this._numTouches?(b=e.changedTouches[0],this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(e,b)):g&&(this._swipeActive=
!0,this._fire("onSwipeStart",this._processTouchEvent(e,b)))):2===this._numTouches&&(a=this._nodeTouches[0],c=this._nodeTouches[1],this._pinchActive?this._fire("onPinchMove",this._processTouchEvent(e,[a,c])):g&&(g=b[a.identifier],k=b[c.identifier],b=Math.abs(g.startX-k.startX),g=Math.abs(g.startY-k.startY),k=Math.abs(a.pageX-c.pageX),q=Math.abs(a.pageY-c.pageY),Math.abs(Math.sqrt(k*k+q*q)-Math.sqrt(b*b+g*g))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(e,
[a,c])))))}},_touchEnd:function(e){this._removeTouch(e);var b=this._touches,a=e.changedTouches,c,f=a.length,k,q,g=(new Date).getTime(),m=this._touchIds;for(c=0;c<f;c++)if(q=b[a[c].identifier])q.absMoved&&(k=!0),q.pageX=a[c].pageX,q.pageY=a[c].pageY,q.endTS=g;if(0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(e,a[0]));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(e,
a));else{if(!k){f=Infinity;k=-Infinity;var g=Infinity,n=-Infinity,u=this.tapStartTolerance,p=[],F=!0;for(c=0;c<m.length;c++)q=b[m[c]],p.push(q),q.startTS<f&&(f=q.startTS),q.startTS>k&&(k=q.startTS),q.endTS<g&&(g=q.endTS),q.endTS>n&&(n=q.endTS),delete b[m[c]];1===p.length&&a[0]&&(b=Math.abs(a[0].pageY-p[0].startY),Math.abs(a[0].pageX-p[0].startX)>=this.tapRadius||b>=this.tapRadius)&&(F=!1);F&&Math.abs(k-f)<=u&&Math.abs(n-g)<=u&&this._basicTap(e,p)}}else 1===this._numTouches&&this._pinchActive&&(c=
this._nodeTouches[0],q=b[c.identifier],q.startX=c.pageX,q.startY=c.pageY,this._pinchActive=q.moved=!1,this._fire("onPinchEnd",this._processTouchEvent(e,[a[0],c])))},_touchCancel:function(e){this._numTouches&&this._touchEnd(e)},_basicTap:function(e,b){var a=(new Date).getTime(),c=this;e=this._processTouchEvent(e,b);this._taps.push({touchInfos:b,ts:a,event:e});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",e);clearTimeout(this._tapTimer);this._immediate?this._analyzeTap(!0):this._tapTimer=
setTimeout(function(){var a=c;c=null;clearTimeout(a._tapTimer);a._analyzeTap()},2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration)},_analyzeTap:function(e){var b=this._taps,a=b[0],c=b[1],f=a.touchInfos,k=c&&c.touchInfos;b.length&&(e||(this._taps=[]),a&&c?f.length===k.length?c.ts-a.ts<=this.doubleTapDuration?(1===f.length?(e=Math.abs(f[0].startX-k[0].startX),f=Math.abs(f[0].startY-k[0].startY),f=e<=this.doubleTapRadius&&f<=this.doubleTapRadius):f=!0,f?this._processedDoubleTap(b):
this._processedTap(c)):this._processedTap(c):this._processedTap(c):this._processedTap(a||c))},_processedTap:function(e){var b=e.event;this._fire("onProcessedTap",b);1===e.touchInfos.length?this._fire("onTap",this._fixEvent(b)):2===e.touchInfos.length&&this._fire("onTwoFingerTap",b)},_processedDoubleTap:function(e){var b=1===e[1].touchInfos.length,a;b&&(a=[this._fixEvent(e[0].event),this._fixEvent(e[1].event)],a[1].relatedEvents=a);e=[e[0].event,e[1].event];e[1].relatedEvents=e;this._fire("onProcessedDoubleTap",
e[1]);b&&(this._fire("onDoubleTap",a[1]),this._fire("onDblClick",a[1]))},_addTouch:function(e){var b=e.changedTouches,a=this._nodeTouches,c,f,k;this._numTouches+=b.length;for(e=0;e<b.length;e++){f=a.length;k=!1;for(c=0;c<f&&!(k=a[c].identifier===b[e].identifier);c++);k?this._numTouches--:a.push(b[e])}for(e=a.length-1;0<=e;e--)n.isDescendant(a[e].target,document.body)||(a.splice(e,1),this._numTouches--);0>this._numTouches&&(this._numTouches=0)},_removeTouch:function(e){var b=[],a=[],c=e.changedTouches,
f=this._nodeTouches;this._numTouches-=c.length;0>this._numTouches&&(this._numTouches=0);for(e=0;e<c.length;e++)b.push(c[e].identifier);for(e=f.length-1;0<=e;e--)-1!==b.indexOf(f[e].identifier)&&a.push(f.splice(e,1)[0]);return a},_updateTouch:function(e){var b=[],a,c=e.changedTouches,f=this._nodeTouches;for(e=0;e<c.length;e++)b.push(c[e].identifier);for(e=0;e<f.length;e++)a=b.indexOf(f[e].identifier),-1!==a&&f.splice(e,1,c[a])},_mouseOver:function(e){this._fire("onMouseOver",this._processMouseEvent(e))},
_mouseOut:function(e){this._fire("onMouseOut",this._processMouseEvent(e))},_mouseDown:function(e){this._fire("onMouseDown",this._processMouseEvent(e))},_mouseUp:function(e){this._fire("onMouseUp",this._processMouseEvent(e))},_mouseClick:function(e){clearTimeout(this._clickTimer);300<(new Date).getTime()-this._touchStartTS?this._fire("onClick",this._processMouseEvent(e)):(this._clickEvent=e,this._clickTimer=setTimeout(this._fireClickEvent,this.doubleTapDuration))},_fireClickEvent:function(){clearTimeout(this._clickTimer);
this._fire("onClick",this._processMouseEvent(this._clickEvent))},_fire:function(e,b){"onDblClick"===e&&clearTimeout(this._clickTimer);if("onDblClick"===e&&this.mouseEvents){this.mouseEvents.preventClickEvents(!0);var a=this;setTimeout(function(){a.mouseEvents.preventClickEvents(!1)},350)}if(this[e])this[e](b);if(this.map&&this.map[e])this.map[e](b)},_fixEvent:function(e){var b={},a;for(a in e)b[a]=e[a];this.map&&(b.screenPoint=b.screenPoints[0],b.mapPoint=b.mapPoints[0]);return b},_processTouchEvent:function(e,
b){var a=this.map,c=a&&a.position,g=0;if(c&&b)if(t.isArray(b)){var w,q;e.screenPoints=[];e.mapPoints=[];for(w=0;w<b.length;w++)b[w]?(q=new f(b[w].pageX-c.x,b[w].pageY-c.y),e.screenPoints.push(q),e.mapPoints.push(a.extent?a.toMap(q):new k)):g++}else e.screenPoint=new f(b.pageX-c.x,b.pageY-c.y),e.mapPoint=a.extent?a.toMap(e.screenPoint):new k;e.numPoints=b?t.isArray(b)?b.length-g:1:0;return e},_processMouseEvent:function(e){var b=this.map,a=b&&b.position;a&&(e.screenPoint=new f(e.pageX-a.x,e.pageY-
a.y),e.mapPoint=b.extent?b.toMap(e.screenPoint):new k);return e},setImmediateTap:function(e){this._immediate=e},destroy:function(){var e=this.node;e.removeEventListener("touchstart",this._touchStart,!1);e.removeEventListener("touchmove",this._touchMove,!1);e.removeEventListener("touchend",this._touchEnd,!1);e.removeEventListener("touchcancel",this._touchCancel,!1);this.map&&(e.removeEventListener("mouseover",this._mouseOver,!1),e.removeEventListener("mouseout",this._mouseOut,!1),e.removeEventListener("mousedown",
this._mouseDown,!1),e.removeEventListener("mouseup",this._mouseUp,!1),e.removeEventListener("click",this._mouseClick,!1));g.setSelectable(e,!0);clearTimeout(this._tapTimer);clearTimeout(this._clickTimer);this.node=this.map=this._numTouches=this._nodeTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/PointerEvents":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./kernel ./Evented ./geometry/Point ./geometry/ScreenPoint".split(" "),function(p,g,t,v,n,m,
u,k){return p([m],{declaredClass:"esri.PointerEvents",tapRadius:8,clickRadius:2,doubleTapRadius:10,tapStartTolerance:50,doubleTapDuration:300,minWheelValue:1,maxWheelValue:1,mozWheelDivisor:-1!==v("mac")?1:3,wheelDivisor:120,preventPageScroll:!0,_dragging:!1,constructor:function(f,e){this.node=f;g.mixin(this,e);void 0!==f.style.msTouchAction?f.style.msTouchAction="none":void 0!==f.style.touchAction&&(f.style.touchAction="none");e=navigator.msPointerEnabled;var b=function(a){a.preventDefault()};f.addEventListener("selectstart",
b,!1);f.addEventListener("dragstart",b,!1);this._pointerDown=g.hitch(this,this._pointerDown);this._pointerMove=g.hitch(this,this._pointerMove);this._pointerUp=g.hitch(this,this._pointerUp);this._pointerCancel=g.hitch(this,this._pointerCancel);f.addEventListener(e?"MSPointerDown":"pointerdown",this._pointerDown,!1);f.addEventListener(e?"MSPointerMove":"pointermove",this._pointerMove,!1);f.addEventListener(e?"MSPointerUp":"pointerup",this._pointerUp,!1);f.addEventListener(e?"MSPointerCancel":"pointercancel",
this._pointerCancel,!1);this.map&&(this._mouseOver=g.hitch(this,this._mouseOver),this._mouseOut=g.hitch(this,this._mouseOut),this._mouseLeave=g.hitch(this,this._mouseLeave),this._mouseDown=g.hitch(this,this._mouseDown),this._mouseUp=g.hitch(this,this._mouseUp),this._mouseClick=g.hitch(this,this._mouseClick),this._mouseWheel=g.hitch(this,this._mouseWheel),this._mouseMove=g.hitch(this,this._mouseMove),this._mouseEnter=g.hitch(this,this._mouseEnter),this._onKeyDown=g.hitch(this,this._onKeyDown),this._onKeyUp=
g.hitch(this,this._onKeyUp),f.addEventListener("mouseover",this._mouseOver,!1),f.addEventListener("mouseout",this._mouseOut,!1),f.addEventListener("mouseleave",this._mouseLeave,!1),f.addEventListener("mousedown",this._mouseDown,!1),f.addEventListener("mouseup",this._mouseUp,!1),f.addEventListener("click",this._mouseClick,!1),f.addEventListener("mousewheel",this._mouseWheel,!1),f.addEventListener("mousemove",this._mouseMove,!1),f.addEventListener("mouseenter",this._mouseEnter,!1));this._numTouches=
0;this._touches={};this._touchIds=[];this._taps=[];this._immediate=!1},_pointerDown:function(f){if(-1<t.indexOf(this._touchIds,f.pointerId))this._pointerUp(f);else{var e=this._touches,b=f.target,a=f.pointerId,c=this._touchIds,k,g=(new Date).getTime();k=e[a]={};k.pointerId=a;k.startX=k.pageX=f.pageX;k.startY=k.pageY=f.pageY;k.startTS=g;c.push(a);this._numTouches++;b.setPointerCapture?b.setPointerCapture(a):b.msSetPointerCapture&&b.msSetPointerCapture(a);b=e[c[0]];e=e[c[1]];1!==this._numTouches&&(2===
this._numTouches?this._swipeActive&&(b&&(b.startX=b.pageX,b.startY=b.pageY,b.moved=!1),this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,b))):this._swipeActive?(this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,b))):this._pinchActive&&(this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,[b,e]))))}},_pointerMove:function(f){var e=this._touches,b=this._touchIds,a,c,k;if((a=e[f.pointerId])&&(a.pageX!==f.pageX||a.pageY!==f.pageY))if(a.pageX=
f.pageX,a.pageY=f.pageY,c=Math.abs(a.pageX-a.startX),k=Math.abs(a.pageY-a.startY),!a.moved&&(c>=this.tapRadius||k>=this.tapRadius)&&(a.moved=a.absMoved=!0),1===this._numTouches)this._swipeActive?this._fire("onSwipeMove",this._processTouchEvent(f,f)):a.moved&&(this._swipeActive=!0,this._fire("onSwipeStart",this._processTouchEvent(f,f)));else if(2===this._numTouches)if(a=e[b[0]],e=e[b[1]],this._pinchActive)this._fire("onPinchMove",this._processTouchEvent(f,[a,e]));else if(a.moved||e.moved){b=Math.abs(a.startX-
e.startX);c=Math.abs(a.startY-e.startY);k=Math.abs(a.pageX-e.pageX);var g=Math.abs(a.pageY-e.pageY);Math.abs(Math.sqrt(k*k+g*g)-Math.sqrt(b*b+c*c))>=2*this.tapRadius&&(this._pinchActive=!0,this._fire("onPinchStart",this._processTouchEvent(f,[a,e])))}},_pointerUp:function(f){var e=this._touches,b,a=this.node,c=f.target,k=f.pointerId,g=this._touchIds,q=g.slice(0),m=t.map(q,function(a){return e[a]}),n=(new Date).getTime();if(b=e[k])if(b.pageX=f.pageX,b.pageY=f.pageY,b.endTS=n,this._numTouches--,c.releasePointerCapture?
c.releasePointerCapture(k):c.msReleasePointerCapture&&c.msReleasePointerCapture(k),0===this._numTouches)if(this._touches={},this._touchIds=[],this._swipeActive)this._swipeActive=!1,this._fire("onSwipeEnd",this._processTouchEvent(f,f));else if(this._pinchActive)this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,f));else{if(!b.absMoved){var c=Infinity,k=-Infinity,g=Infinity,n=-Infinity,u=this.tapStartTolerance,B;for(B=0;B<q.length;B++)b=m[B],b.startTS<c&&(c=b.startTS),b.startTS>
k&&(k=b.startTS),b.endTS<g&&(g=b.endTS),b.endTS>n&&(n=b.endTS);Math.abs(k-c)<=u&&Math.abs(n-g)<=u&&this._basicTap(f,m)}}else 1===this._numTouches&&this._pinchActive&&(g.splice(t.indexOf(g,f.pointerId),1),delete e[f.pointerId],b=e[g[0]],b.startX=b.pageX,b.startY=b.pageY,b.moved=!1,document.msElementsFromPoint&&(q=document.msElementsFromPoint(b.pageX,b.pageY),t.some(q,function(b){return b===a})||(this._touches={},this._touchIds=[],this._numTouches=0)),this._pinchActive=!1,this._fire("onPinchEnd",this._processTouchEvent(f,
[f,b])))},_pointerCancel:function(f){this._numTouches&&this._pointerUp(f)},_basicTap:function(f,e){var b=(new Date).getTime(),a=this,c=this._immediate;f=this._processTouchEvent(f,e);this._taps.push({touchInfos:e,ts:b,event:f});2<this._taps.length&&this._taps.shift();this._fire("onBasicTap",f);clearTimeout(this._tapTimer);f=2===this._taps.length?this.doubleTapDuration/2:this.doubleTapDuration;this._tapTimer=setTimeout(function(){var b=a;a=null;clearTimeout(b._tapTimer);b._analyzeTap(c)},c?0:f)},_analyzeTap:function(f){var e=
this._taps,b=e[0],a=e[1],c=b.touchInfos,k=a&&a.touchInfos;e.length&&(f||(this._taps=[]),b&&a?c.length===k.length?a.ts-b.ts<=this.doubleTapDuration?(1===c.length?(f=Math.abs(c[0].startX-k[0].startX),c=Math.abs(c[0].startY-k[0].startY),c=f<=this.doubleTapRadius&&c<=this.doubleTapRadius):c=!0,c?this._processedDoubleTap(e):this._processedTap(a)):this._processedTap(a):this._processedTap(a):this._processedTap(b||a))},_processedTap:function(f){var e=f.event;this._fire("onProcessedTap",e);1===f.touchInfos.length?
this._fire("onTap",this._fixEvent(e)):2===f.touchInfos.length&&this._fire("onTwoFingerTap",e)},_processedDoubleTap:function(f){var e=1===f[1].touchInfos.length,b;e&&(b=[this._fixEvent(f[0].event),this._fixEvent(f[1].event)],b[1].relatedEvents=b);f=[f[0].event,f[1].event];f[1].relatedEvents=f;this._fire("onProcessedDoubleTap",f[1]);e&&(this._fire("onDoubleTap",b[1]),this._fire("onDblClick",b[1]))},_mouseOver:function(f){this._fire("onMouseOver",this._processMouseEvent(f))},_mouseMove:function(f){this._dragging?
this._fire("onMouseDrag",this._processMouseEvent(f)):this._fire("onMouseMove",this._processMouseEvent(f))},_mouseOut:function(f){this._fire("onMouseOut",this._processMouseEvent(f))},_mouseLeave:function(f){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseOut",this._processMouseEvent(f))},_mouseDown:function(f){this._downX=f.pageX;this._downY=f.pageY;this._fire("onMouseDown",this._processMouseEvent(f));0===f.button&&
(this._dragging=!0,this._fire("onMouseDragStart",this._processMouseEvent(f)))},_mouseUp:function(f){this._dragging&&(this._dragging=!1,this._fire("onMouseDragEnd",this._processMouseEvent(f)));this._fire("onMouseUp",this._processMouseEvent(f))},_mouseClick:function(f){Math.abs(f.pageX-this._downX)<=this.clickRadius&&Math.abs(f.pageY-this._downY)<=this.clickRadius&&this._fire("onClick",this._processMouseEvent(f))},_mouseWheel:function(f){var e=this.map;(e?e.isScrollWheelZoom||e.isScrollWheelPan:this.preventPageScroll)&&
f.preventDefault();var e=f.wheelDelta?f.wheelDelta/this.wheelDivisor:-f.detail/this.mozWheelDivisor,b=Math.abs(e),b=b<=this.minWheelValue?this.minWheelValue:this.maxWheelValue;f.value=0>e?-b:b;this._fire("onMouseWheel",this._processMouseEvent(f))},_mouseEnter:function(f){document.removeEventListener("keydown",this._onKeyDown,!1);document.removeEventListener("keyup",this._onKeyUp,!1);document.addEventListener("keydown",this._onKeyDown,!1);document.addEventListener("keyup",this._onKeyUp,!1);this._fire("onMouseEnter",
this._processMouseEvent(f))},_onKeyDown:function(f){this._fire("onKeyDown",f)},_onKeyUp:function(f){this._fire("onKeyUp",f)},_fire:function(f,e){if(this[f])this[f](e);if(this.map&&this.map[f])this.map[f](e)},_fixEvent:function(f){var e={},b;for(b in f)e[b]=f[b];e.preventDefault=function(){f.preventDefault()};e.stopPropagation=function(){f.stopPropagation()};this.map&&(e.screenPoint=e.screenPoints[0],e.mapPoint=e.mapPoints[0]);return e},_processTouchEvent:function(f,e){var b=this.map,a=b&&b.position,
c=0;if(a&&e)if(g.isArray(e)){var m,w;f.screenPoints=[];f.mapPoints=[];for(m=0;m<e.length;m++)e[m]?(w=new k(e[m].pageX-a.x,e[m].pageY-a.y),f.screenPoints.push(w),f.mapPoints.push(b.extent?b.toMap(w):new u)):c++}else f.screenPoint=new k(e.pageX-a.x,e.pageY-a.y),f.mapPoint=b.extent?b.toMap(f.screenPoint):new u;f.numPoints=e?g.isArray(e)?e.length-c:1:0;return f},_processMouseEvent:function(f){var e=this.map,b=e&&e.position;b&&(f.screenPoint=new k(f.pageX-b.x,f.pageY-b.y),f.mapPoint=e.extent?e.toMap(f.screenPoint):
new u);return f},setImmediateTap:function(f){this._immediate=f},destroy:function(){var f=this.node;f.removeEventListener("MSPointerDown",this._pointerDown,!1);f.removeEventListener("MSPointerMove",this._pointerMove,!1);f.removeEventListener("MSPointerUp",this._pointerUp,!1);f.removeEventListener("MSPointerCancel",this._pointerCancel,!1);this.map&&(f.removeEventListener("mouseover",this._mouseOver,!1),f.removeEventListener("mousemove",this._mouseMove,!1),f.removeEventListener("mouseout",this._mouseOut,
!1),f.removeEventListener("mouseleave",this._mouseLeave,!1),f.removeEventListener("mousedown",this._mouseDown,!1),f.removeEventListener("mouseup",this._mouseUp,!1),f.removeEventListener("click",this._mouseClick,!1),f.removeEventListener("mouseenter",this._mouseEnter,!1));clearTimeout(this._tapTimer);this.node=this.map=this._numTouches=this._touches=this._touchIds=this._taps=null}})})},"esri/renderers/jsonUtils":function(){define("dojo/_base/array dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../Color ../symbols/jsonUtils ./SimpleRenderer ./UniqueValueRenderer ./ClassBreaksRenderer ./VectorFieldRenderer ./DotDensityRenderer ./ScaleDependentRenderer ./TimeClassBreaksAger ./TimeRampAger ./TemporalRenderer ./HeatmapRenderer ./StretchRenderer".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){return{fromJson:function(a){var c;switch(a.type||""){case "simple":c=new k(a);break;case "uniqueValue":c=new f(a);break;case "classBreaks":c=new e(a);break;case "vectorField":c=new b(a);break;case "scaleDependent":c=this._scaleDependentFromJson(a);break;case "dotDensity":c=this._dotDensityFromJson(a);break;case "temporal":c=this._temporalFromJson(a);break;case "heatmap":c=this._heatmapFromJson(a);break;case "rasterStretch":c=new z(a)}return c},_scaleDependentFromJson:function(a){var b=
{},e=a.minScale;b.rendererInfos=p.map(a.rendererInfos,function(a){var b=a.maxScale;a={minScale:e,maxScale:b,renderer:a.renderer&&this.fromJson(a.renderer)};e=b;return a},this);return new c(b)},_dotDensityFromJson:function(b){b.backgroundColor&&g.isArray(b.backgroundColor)&&(b.backgroundColor=m.toDojoColor(b.backgroundColor));0<b.dotSize&&(b.dotSize=v.pt2px(b.dotSize));b.fields&&p.forEach(b.fields,function(a){a&&g.isArray(a.color)&&(a.color=m.toDojoColor(a.color))});b.legendOptions&&(b.legendOptions.backgroundColor&&
g.isArray(b.legendOptions.backgroundColor)&&(b.legendOptions.backgroundColor=m.toDojoColor(b.legendOptions.backgroundColor)),b.legendOptions.outline&&(b.legendOptions.outline=u.fromJson(b.legendOptions.outline)));b.outline&&(b.outline=u.fromJson(b.outline));return new a(b)},_temporalFromJson:function(a){var b,c,e;a=a||{};b=this.fromJson(a.observationRenderer);c=a.latestObservationRenderer?this.fromJson(a.latestObservationRenderer):null;e=a.trackRenderer?this.fromJson(a.trackRenderer):null;a=this._agerFromJson(a.observationAger);
return new q(b,c,e,a)},_agerFromJson:function(a){var b;a=a||{};a.colorRange||a.sizeRange||a.alphaRange?b=this._timeRampFromJson(a):a.agerClassBreakInfos&&(b=this._timeClassBreaksFromJson(a));return b},_timeRampFromJson:function(a){var b,c,e;a.colorRange&&1<a.colorRange.length&&(b=[m.toDojoColor(a.colorRange[0]),m.toDojoColor(a.colorRange[1])]);a.sizeRange&&1<a.sizeRange.length&&(c=[a.sizeRange[0],a.sizeRange[1]]);a.alphaRange&&1<a.alphaRange.length&&(e=[a.alphaRange[0]/255,a.alphaRange[1]/255]);return new w(b,
c,e)},_timeClassBreaksFromJson:function(a){var b=a.agerClassBreakInfos,c,e,f=[],k;c=x.UNIT_DAYS;switch(a.timeUnits){case "esriTimeUnitsSeconds":c=x.UNIT_SECONDS;break;case "esriTimeUnitsMilliseconds":c=x.UNIT_MILLISECONDS;break;case "esriTimeUnitsHours":c=x.UNIT_HOURS;break;case "esriTimeUnitsMinutes":c=x.UNIT_MINUTES;break;case "esriTimeUnitsMonths":c=x.UNIT_MONTHS;break;case "esriTimeUnitsWeeks":c=x.UNIT_WEEKS;break;case "esriTimeUnitsYears":c=x.UNIT_YEARS}for(k=0;k<b.length;k+=1)a=b[k],e={minAge:0,
maxAge:a.oldestAge||Infinity},a.color&&(e.color=m.toDojoColor(a.color)),a.alpha&&(e.alpha=a.alpha/255),e.size=a.size,f[k]=e;return new x(f,c)},_heatmapFromJson:function(a){var b=a.colorStops;b&&b instanceof Array&&p.forEach(b,function(a){a.color=m.toDojoColor(a.color)});return new C(a)}}})},"esri/renderers/SimpleRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer".split(" "),function(p,g,t,v,n,m,u){return p(u,{declaredClass:"esri.renderer.SimpleRenderer",
constructor:function(k){if(k&&!k.declaredClass){var f=k;this.symbol=(k=f.symbol)&&(k.declaredClass?k:m.fromJson(k));this.label=f.label;this.description=f.description}else this.symbol=k},getSymbol:function(k){return this.symbol},toJson:function(){var k=g.mixin(this.inherited(arguments),{type:"simple",label:this.label,description:this.description,symbol:this.symbol&&this.symbol.toJson()});return n.fixJson(k)}})})},"esri/renderers/Renderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojox/gfx/_base ../kernel ../Color ../layers/support/attributeUtils ../support/expressionUtils ../arcadeProfiles/visualizationProfile".split(" "),
function(p,g,t,v,n,m,u,k,f,e){var b=Math.PI;return p(null,{declaredClass:"esri.renderer.Renderer",constructor:function(a){this._cache={};if(a&&!a.declaredClass){this.rotationInfo=a.rotationInfo;if(!this.rotationInfo){var b=a.rotationType,e=a.rotationExpression;if(b||e)this.rotationInfo={type:b,expression:e}}this.setRotationInfo(this.rotationInfo);this.setSizeInfo(this._readSizeInfo(a.sizeInfo));this.setColorInfo(this._readColorInfo(a.colorInfo));this.setOpacityInfo(this._readOpacityInfo(a.transparencyInfo));
this.setVisualVariables(this._readVariables(a.visualVariables));this.setAuthoringInfo(a.authoringInfo)}this.getSymbol=g.hitch(this,this.getSymbol)},getSymbol:function(a){},_readSizeInfo:function(a){if(a){var b=a.minSize,e=a.maxSize;b&&(a.minSize="number"===typeof b?n.pt2px(b):this._readSizeInfo(b));e&&(a.maxSize="number"===typeof e?n.pt2px(e):this._readSizeInfo(e));a.stops&&t.forEach(a.stops,function(a){a.size&&"number"===typeof a.size&&(a.size=n.pt2px(a.size))})}return a},_readColorInfo:function(a){a&&
(t.forEach(a.colors,function(b,e){g.isArray(b)&&(a.colors[e]=u.toDojoColor(b))}),t.forEach(a.stops,function(b,e){b.color&&g.isArray(b.color)&&(a.stops[e].color=u.toDojoColor(b.color))}));return a},_readOpacityInfo:function(a){var b;a&&(b=g.mixin({},a),b.transparencyValues&&(b.opacityValues=t.map(b.transparencyValues,function(a){return 1-a/100}),delete b.transparencyValues),b.stops&&(b.stops=t.map(b.stops,function(a){a=g.mixin({},a);a.opacity=1-a.transparency/100;delete a.transparency;return a})));
return b},_readVariables:function(a){a&&(a=t.map(a,function(a){"sizeInfo"===a.type?a=this._readSizeInfo(a):"colorInfo"===a.type?a=this._readColorInfo(a):"transparencyInfo"===a.type&&(a=this._readOpacityInfo(a),a.type="opacityInfo");return a},this));return a},setAuthoringInfo:function(a){this.authoringInfo=a},setRotationInfo:function(a){if(a=this.rotationInfo="string"===typeof a?{field:a}:a){if(a.expression&&!g.isFunction(a.expression)&&!a.field){var b=a.expression.match(this.rotationRE);b&&b[1]&&
(a.field=b[1])}a.rotationType=a.type}this._cache.rotationInfo=this._processRotationInfo(a);return this},rotationRE:/^\[([^\]]+)\]$/i,_processRotationInfo:function(a){return this._createCache(a)},getRotationAngle:function(a,b){var c=this._getVarInfo(b&&b.rotationInfo,"rotationInfo");b=c.variable;var c=this._cache[c.cacheKey],e="arithmetic"===this._getRotationType(b),f=c&&c.hasExpr,k=null;if(b.field||f)k=this._getDataValue(a,b,null,c),null!=k&&(k=(k+(e?-90:0))*(e?-1:1));return k},_getRotationType:function(a){return a&&
("rotationInfo"===a.type?a.rotationType:a.type)},_getDataValue:function(a,b,e,k,q){k||(k=this._getVarInfo(b,e),b=k.variable,k=this._cache[k.cacheKey],"sizeInfo"===e&&(k=k.root));return a._getDataValue(b,k,f,q)},setVisualVariables:function(a){var b=this._cache;t.forEach(this.visualVariables,function(a,c){b.hasOwnProperty(c)&&(b[c]=null)},this);this.visualVariables=a;t.some(a,function(a){return!!a.target})&&a.sort(function(a,b){return a.target===b.target?0:a.target?1:-1});t.forEach(a,function(a,c){"colorInfo"===
a.type?b[c]=this._processColorInfo(a):"opacityInfo"===a.type?b[c]=this._processOpacityInfo(a):"sizeInfo"===a.type?b[c]=this._processSizeInfo(a):"rotationInfo"===a.type&&(b[c]=this._processRotationInfo(a))},this);return this},getVisualVariableValues:function(a){var b=this.visualVariables,e;b&&(e=t.map(b,function(b){var c;switch(b.type){case "sizeInfo":c=this.getSize(a,{sizeInfo:b});break;case "colorInfo":c=this.getColor(a,{colorInfo:b});break;case "opacityInfo":c=this.getOpacity(a,{opacityInfo:b});
break;case "rotationInfo":c=this.getRotationAngle(a,{rotationInfo:b})}return{variable:b,value:c}},this));return e},getFieldsUsedInExpressions:function(){var a=[];t.forEach(this._getCacheObjects(),function(b){b.syntaxTree&&(a=a.concat(f.extractFieldNames(b.syntaxTree)))});a.sort();return t.filter(a,function(b,e){return 0===e||a[e-1]!==b})},hasGeometryOperations:function(){return t.some(this._getCacheObjects(),function(a){return a.syntaxTree?f.hasGeometryOperations(a.syntaxTree):!1})},initializeArcadeEngine:function(){var a=
[];t.forEach(this._getCacheObjects(),function(b){b.syntaxTree&&a.push(b.syntaxTree)});return e.initialize(a)},hasVisualVariables:function(a,b){return a?!!this.getVisualVariablesForType(a,b):!!(this.getVisualVariablesForType("sizeInfo",b)||this.getVisualVariablesForType("colorInfo",b)||this.getVisualVariablesForType("opacityInfo",b)||this.getVisualVariablesForType("rotationInfo",b))},getVisualVariablesForType:function(a,b){var c=this.visualVariables,e;!b&&this[a]?("rotationInfo"===a&&(this[a].rotationType=
this[a].type),e=[this[a]]):c&&(e=t.filter(c,function(c){return c.type===a&&("string"===typeof b?c.target===b:!1===b?!c.target:!0)}))&&0===e.length&&(e=void 0);return e},setSizeInfo:function(a){this.sizeInfo=this.proportionalSymbolInfo=a;this._cache.sizeInfo=this._processSizeInfo(a);return this},_processSizeInfo:function(a){return a&&{root:this._createCache(a),minSize:this._createCache(a.minSize),maxSize:this._createCache(a.maxSize)}},_convertExpressionToArcade:function(a){a&&a.expression&&(a.valueExpression=
"$view.scale")},_getVarInfo:function(a,b){var c;a&&a.type===b?(c=t.indexOf(this.visualVariables,a),a=this.visualVariables[c]):(c=b,a=this[b]);return{variable:a,cacheKey:c}},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);return this},getSize:function(a,b){var c=this._getVarInfo(b&&b.sizeInfo,"sizeInfo"),e=c.variable,c=this._cache[c.cacheKey],f=null;if(e)var k=e.minSize,f=e.maxSize,k="object"===typeof k&&k?this._getSize(a,k,c&&c.minSize,b):k,f="object"===typeof f&&f?this._getSize(a,f,c&&
c.maxSize,b):f,f=this._getSize(a,e,c&&c.root,b,[k,f]);return f},_getSize:function(a,c,e,f,k){var q=c.stops,g=0,m=e&&e.hasExpr,w=e&&e.ipData,x=e&&e.isScaleDriven,n="object"===typeof a&&!!a,u="number"===typeof a?a:null;if(c.field||x||m){var p=f&&f.scale,m=k?k[0]:c.minSize;k=k?k[1]:c.maxSize;var v=c.minDataValue,t=c.maxDataValue,L=c.valueUnit||"unknown",M=c.valueRepresentation,Q=c.scaleBy,S=f&&f.shape;x?u=p:"number"!==typeof u&&n&&(u=this._getDataValue(a,c,null,e));if(!this._isValidNumber(u))return null;
if(q)m=this._lookupData(u,w),u=m[0],k=m[1],u===k?g=q[u].size:(u=q[u].size,q=q[k].size,g=u+(q-u)*m[2]);else if(null!=m&&null!=k&&null!=v&&null!=t)u<=v?g=m:u>=t?g=k:(q=(u-v)/(t-v),"area"===Q&&S?(m=(u="circle"===S)?b*Math.pow(m/2,2):m*m,q=m+q*((u?b*Math.pow(k/2,2):k*k)-m),g=u?2*Math.sqrt(q/b):Math.sqrt(q)):g=m+q*(k-m));else if("unknown"===L)null!=m&&null!=v&&(m&&v?(q=u/v,g="circle"===S?2*Math.sqrt(q*Math.pow(m/2,2)):"square"===S||"diamond"===S||"image"===S?Math.sqrt(q*Math.pow(m,2)):q*m):g=u+(m||v),
g=g<m?m:g,null!=k&&g>k&&(g=k));else{q=(f&&f.resolution?f.resolution:1)*this._meterIn[L];if("area"===M)g=Math.sqrt(u/b)/q,g*=2;else if(g=u/q,"radius"===M||"distance"===M)g*=2;null!=m&&g<m&&(g=m);null!=k&&g>k&&(g=k)}}else g=q&&q[0]&&q[0].size,null==g&&(g=c.minSize);return g=isNaN(g)?0:g},getSizeRangeAtScale:function(a,b){var c;a=this._getVarInfo(a,"sizeInfo");var e=this._cache[a.cacheKey],f={scale:b};if((a=a.variable)&&b){var k=a.minSize;b=a.maxSize;var g=a.stops;g&&g.length?(a=g[0].size,e=g[g.length-
1].size):(a="object"===typeof k&&k?this._getSize({},k,e&&e.minSize,f):k,e="object"===typeof b&&b?this._getSize({},b,e&&e.maxSize,f):b);if(null!=a||null!=e)a>e&&(c=e,e=a,a=c),c={minSize:a,maxSize:e}}return c},setColorInfo:function(a){this.colorInfo=a;this._cache.colorInfo=this._processColorInfo(a);return this},_createCache:function(a,b){if(b=k.createAttributeCache(a,b))b.ipData=this._interpolateData(a);return b},_getCacheObjects:function(a){var b;a=a||this._cache;var e=[];for(b in a){var f=a[b];a.hasOwnProperty(b)&&
f&&"object"===typeof f&&(f.hasOwnProperty("idSource")?e.push(f):e=e.concat(this._getCacheObjects(f)))}return e},_processColorInfo:function(a){a&&(t.forEach(a.colors,function(b,e){g.isArray(b)&&(a.colors[e]=new u(b))}),t.forEach(a.stops,function(b,e){b.color&&g.isArray(b.color)&&(a.stops[e].color=new u(b.color))}));return this._createCache(a)},getColor:function(a,b){b=this._getVarInfo(b&&b.colorInfo,"colorInfo");return this._getColorComponent(a,b.variable,this._cache[b.cacheKey])},setOpacityInfo:function(a){this.opacityInfo=
a;this._cache.opacityInfo=this._processOpacityInfo(a);return this},_processOpacityInfo:function(a){return this._createCache(a)},getOpacity:function(a,b){b=this._getVarInfo(b&&b.opacityInfo,"opacityInfo");return this._getColorComponent(a,b.variable,this._cache[b.cacheKey],!0)},_getColorComponent:function(a,b,e,f,k){var c="number"===typeof a?a:null,q=e&&e.hasExpr,g=e&&e.ipData,m;b&&b.field||q?("number"!==typeof c&&"object"===typeof a&&a&&(c=this._getDataValue(a,b,null,e)),this._isValidNumber(c)||(c=
null),null!=c&&(m=f?this._getOpacity(c,b,g):this._getColor(c,b,g))):b&&(a=b.stops,f?(m=a&&a[0]&&a[0].opacity,null==m&&(m=b.opacityValues&&b.opacityValues[0])):m=a&&a[0]&&a[0].color||b.colors&&b.colors[0]);k&&(k.data=c,k.value=m);return k||m},_isValidNumber:function(a){return"number"===typeof a&&!isNaN(a)&&Infinity!==a&&-Infinity!==a},_interpolateData:function(a){var b;if(a)if(a.colors||a.opacityValues){var e=(a.colors||a.opacityValues).length,f=a.minDataValue,k=(a.maxDataValue-f)/(e-1);b=[];for(a=
0;a<e;a++)b[a]=f+a*k}else a.stops&&(b=t.map(a.stops,function(a){return a.value}));return b},_getOpacity:function(a,b,e){a=this._lookupData(a,e);var c;b=b||this.opacityInfo;a&&(e=a[0],c=a[1],e===c?c=this._getOpacValue(b,e):(e=this._getOpacValue(b,e),b=this._getOpacValue(b,c),c=e+(b-e)*a[2]));return c},_getOpacValue:function(a,b){return a.opacityValues?a.opacityValues[b]:a.stops[b].opacity},_getColor:function(a,b,e){a=this._lookupData(a,e);var c;b=b||this.colorInfo;a&&(c=a[0],e=a[1],c=c===e?this._getColorObj(b,
c):u.blendColors(this._getColorObj(b,c),this._getColorObj(b,e),a[2]));return c},_getColorObj:function(a,b){return a.colors?a.colors[b]:a.stops[b].color},_lookupData:function(a,b){var c;if(b){var e=0,f=b.length-1;t.some(b,function(b,c){if(a<b)return f=c,!0;e=c;return!1});c=[e,f,(a-b[e])/(b[f]-b[e])]}return c},_meterIn:{inches:1/.0254,feet:1/.3048,yards:1/.9144,miles:1/1609.344,"nautical-miles":1/1852,millimeters:1E3,centimeters:100,decimeters:10,meters:1,kilometers:.001,"decimal-degrees":180/20015077},
_writeSizeInfo:function(a){if(a){a=g.mixin({},a);this._convertExpressionToArcade(a);var b=a.minSize,e=a.maxSize;b&&(a.minSize="number"===typeof b?n.px2pt(b):this._writeSizeInfo(b));e&&(a.maxSize="number"===typeof e?n.px2pt(e):this._writeSizeInfo(e));if(b=a.legendOptions)if(a.legendOptions=g.mixin({},b),b=b.customValues)a.legendOptions.customValues=b.slice(0);a.stops&&(a.stops=t.map(a.stops,function(a){a=g.mixin({},a);a.size&&"number"===typeof a.size&&(a.size=n.px2pt(a.size));return a}))}return a},
_writeColorInfo:function(a){a&&(a=g.mixin({},a),a.colors&&(a.colors=t.map(a.colors,function(a){return u.toJsonColor(a)})),a.stops&&(a.stops=t.map(a.stops,function(a){a=g.mixin({},a);a.color&&(a.color=u.toJsonColor(a.color));return a})),a.legendOptions&&(a.legendOptions=g.mixin({},a.legendOptions)));return a},_writeOpacityInfo:function(a){var b;a&&(b=g.mixin({},a),b.opacityValues&&(b.transparencyValues=t.map(b.opacityValues,function(a){return 100*(1-a)}),delete b.opacityValues),b.stops&&(b.stops=t.map(b.stops,
function(a){a=g.mixin({},a);a.transparency=100*(1-a.opacity);delete a.opacity;return a})),b.legendOptions&&(b.legendOptions=g.mixin({},b.legendOptions)));return b},toJson:function(a){var b=this.visualVariables,e=g.clone(this.authoringInfo),f=a&&a.useLegacyRotationProperties,k=(a=(a=this.getVisualVariablesForType("rotationInfo",!1))&&a[0])&&a.field,m;a&&(a===this.rotationInfo||f)&&(m=a.expression||k&&(g.isFunction(k)?k:"["+k+"]"));b&&(b=t.map(b,function(a){"sizeInfo"===a.type?a=this._writeSizeInfo(a):
"colorInfo"===a.type?a=this._writeColorInfo(a):"opacityInfo"===a.type?(a=this._writeOpacityInfo(a),a.type="transparencyInfo"):"rotationInfo"===a.type&&(a=f?null:g.mixin({},a));return a},this),b=t.filter(b,function(a){return null!=a}));e&&t.forEach(e.visualVariables,function(a){"opacityInfo"===a.type&&(a.type="transparencyInfo")});return{rotationType:m&&(this._getRotationType(a)||"geographic"),rotationExpression:m,colorInfo:this._writeColorInfo(this.colorInfo),transparencyInfo:this._writeOpacityInfo(this.opacityInfo),
sizeInfo:this._writeSizeInfo(this.sizeInfo),visualVariables:b,authoringInfo:e}}})})},"esri/layers/support/attributeUtils":function(){define("dojo/_base/lang dojo/has dojox/encoding/digests/_base dojox/encoding/digests/MD5 ../../kernel ../../support/expressionUtils".split(" "),function(p,g,t,v,n,m){var u={viewScaleRE:/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,getAttributeId:function(k){return"string"===typeof k?v(k,t.outputTypes.Hex):null},getAttributeIdSource:function(k){if(!k)return null;var f=
k.field,e=k.valueExpression,b=null;if(e)b=e;else if(p.isFunction(f))b=f.toString();else if(f){var a=(e=k.normalizationField)?"field":k.normalizationType;k=parseFloat(k.normalizationTotal);if(a)if(a=a.toLowerCase(),b=f.toLowerCase()+",norm:"+a,e)b+=","+e.toLowerCase();else if("percent-of-total"===a){f=k;if("number"!==typeof f||isNaN(f)||Infinity===f||-Infinity===f||0===k)k=null;b+=","+k}}return b},createAttributeCache:function(k,f){if(!k)return null;var e=k.valueExpression,b=m.createSyntaxTree(e),
a=u.getAttributeIdSource(k);return{attributeInfo:k,isNumeric:!f,idSource:a,id:u.getAttributeId(a),hasExpr:!!e,compiledFunc:m.createFunction(b),syntaxTree:b,isScaleDriven:!!k.expression||u.viewScaleRE.test(e),dependsOnView:b?m.dependsOnView(b):!1,dependsOnGeometry:b?m.hasGeometryOperations(b):!1,isJSFunc:p.isFunction(k.field)}}};return u})},"dojox/encoding/digests/_base":function(){define(["dojo/_base/lang"],function(p){p=p.getObject("dojox.encoding.digests",!0);p.outputTypes={Base64:0,Hex:1,String:2,
Raw:3};p.addWords=function(g,p){var v=(g&65535)+(p&65535);return(g>>16)+(p>>16)+(v>>16)<<16|v&65535};p.stringToWord=function(g){for(var p=[],v=0,n=8*g.length;v<n;v+=8)p[v>>5]|=(g.charCodeAt(v/8)&255)<<v%32;return p};p.wordToString=function(g){for(var p=[],v=0,n=32*g.length;v<n;v+=8)p.push(String.fromCharCode(g[v>>5]>>>v%32&255));return p.join("")};p.wordToHex=function(g){for(var p=[],v=0,n=4*g.length;v<n;v++)p.push("0123456789abcdef".charAt(g[v>>2]>>v%4*8+4&15)+"0123456789abcdef".charAt(g[v>>2]>>
v%4*8&15));return p.join("")};p.wordToBase64=function(g){for(var p=[],v=0,n=4*g.length;v<n;v+=3)for(var m=(g[v>>2]>>v%4*8&255)<<16|(g[v+1>>2]>>(v+1)%4*8&255)<<8|g[v+2>>2]>>(v+2)%4*8&255,u=0;4>u;u++)8*v+6*u>32*g.length?p.push("\x3d"):p.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(m>>6*(3-u)&63));return p.join("")};p.stringToUtf8=function(g){for(var p="",v=-1,n,m;++v<g.length;)n=g.charCodeAt(v),m=v+1<g.length?g.charCodeAt(v+1):0,55296<=n&&56319>=n&&56320<=m&&57343>=
m&&(n=65536+((n&1023)<<10)+(m&1023),v++),127>=n?p+=String.fromCharCode(n):2047>=n?p+=String.fromCharCode(192|n>>>6&31,128|n&63):65535>=n?p+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):2097151>=n&&(p+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return p};return p})},"dojox/encoding/digests/MD5":function(){define(["./_base"],function(p){function g(k,f){return k<<f|k>>>32-f}function t(k,f,e,b,a,c){return p.addWords(g(p.addWords(p.addWords(f,k),p.addWords(b,c)),
a),e)}function v(k,f,e,b,a,c,g){return t(f&e|~f&b,k,f,a,c,g)}function n(k,f,e,b,a,c,g){return t(f&b|e&~b,k,f,a,c,g)}function m(k,f,e,b,a,c,g){return t(e^(f|~b),k,f,a,c,g)}function u(k,f){k[f>>5]|=128<<f%32;k[(f+64>>>9<<4)+14]=f;f=1732584193;for(var e=-271733879,b=-1732584194,a=271733878,c=0;c<k.length;c+=16){var g=f,w=e,q=b,u=a;f=v(f,e,b,a,k[c+0],7,-680876936);a=v(a,f,e,b,k[c+1],12,-389564586);b=v(b,a,f,e,k[c+2],17,606105819);e=v(e,b,a,f,k[c+3],22,-1044525330);f=v(f,e,b,a,k[c+4],7,-176418897);a=v(a,
f,e,b,k[c+5],12,1200080426);b=v(b,a,f,e,k[c+6],17,-1473231341);e=v(e,b,a,f,k[c+7],22,-45705983);f=v(f,e,b,a,k[c+8],7,1770035416);a=v(a,f,e,b,k[c+9],12,-1958414417);b=v(b,a,f,e,k[c+10],17,-42063);e=v(e,b,a,f,k[c+11],22,-1990404162);f=v(f,e,b,a,k[c+12],7,1804603682);a=v(a,f,e,b,k[c+13],12,-40341101);b=v(b,a,f,e,k[c+14],17,-1502002290);e=v(e,b,a,f,k[c+15],22,1236535329);f=n(f,e,b,a,k[c+1],5,-165796510);a=n(a,f,e,b,k[c+6],9,-1069501632);b=n(b,a,f,e,k[c+11],14,643717713);e=n(e,b,a,f,k[c+0],20,-373897302);
f=n(f,e,b,a,k[c+5],5,-701558691);a=n(a,f,e,b,k[c+10],9,38016083);b=n(b,a,f,e,k[c+15],14,-660478335);e=n(e,b,a,f,k[c+4],20,-405537848);f=n(f,e,b,a,k[c+9],5,568446438);a=n(a,f,e,b,k[c+14],9,-1019803690);b=n(b,a,f,e,k[c+3],14,-187363961);e=n(e,b,a,f,k[c+8],20,1163531501);f=n(f,e,b,a,k[c+13],5,-1444681467);a=n(a,f,e,b,k[c+2],9,-51403784);b=n(b,a,f,e,k[c+7],14,1735328473);e=n(e,b,a,f,k[c+12],20,-1926607734);f=t(e^b^a,f,e,k[c+5],4,-378558);a=t(f^e^b,a,f,k[c+8],11,-2022574463);b=t(a^f^e,b,a,k[c+11],16,1839030562);
e=t(b^a^f,e,b,k[c+14],23,-35309556);f=t(e^b^a,f,e,k[c+1],4,-1530992060);a=t(f^e^b,a,f,k[c+4],11,1272893353);b=t(a^f^e,b,a,k[c+7],16,-155497632);e=t(b^a^f,e,b,k[c+10],23,-1094730640);f=t(e^b^a,f,e,k[c+13],4,681279174);a=t(f^e^b,a,f,k[c+0],11,-358537222);b=t(a^f^e,b,a,k[c+3],16,-722521979);e=t(b^a^f,e,b,k[c+6],23,76029189);f=t(e^b^a,f,e,k[c+9],4,-640364487);a=t(f^e^b,a,f,k[c+12],11,-421815835);b=t(a^f^e,b,a,k[c+15],16,530742520);e=t(b^a^f,e,b,k[c+2],23,-995338651);f=m(f,e,b,a,k[c+0],6,-198630844);a=
m(a,f,e,b,k[c+7],10,1126891415);b=m(b,a,f,e,k[c+14],15,-1416354905);e=m(e,b,a,f,k[c+5],21,-57434055);f=m(f,e,b,a,k[c+12],6,1700485571);a=m(a,f,e,b,k[c+3],10,-1894986606);b=m(b,a,f,e,k[c+10],15,-1051523);e=m(e,b,a,f,k[c+1],21,-2054922799);f=m(f,e,b,a,k[c+8],6,1873313359);a=m(a,f,e,b,k[c+15],10,-30611744);b=m(b,a,f,e,k[c+6],15,-1560198380);e=m(e,b,a,f,k[c+13],21,1309151649);f=m(f,e,b,a,k[c+4],6,-145523070);a=m(a,f,e,b,k[c+11],10,-1120210379);b=m(b,a,f,e,k[c+2],15,718787259);e=m(e,b,a,f,k[c+9],21,-343485551);
f=p.addWords(f,g);e=p.addWords(e,w);b=p.addWords(b,q);a=p.addWords(a,u)}return[f,e,b,a]}p.MD5=function(k,f){f=f||p.outputTypes.Base64;k=u(p.stringToWord(k),8*k.length);switch(f){case p.outputTypes.Raw:return k;case p.outputTypes.Hex:return p.wordToHex(k);case p.outputTypes.String:return p.wordToString(k);default:return p.wordToBase64(k)}};p.MD5._hmac=function(k,f,e){e=e||p.outputTypes.Base64;var b=p.stringToWord(f);16<b.length&&(b=u(b,8*f.length));var a=[];f=[];for(var c=0;16>c;c++)a[c]=b[c]^909522486,
f[c]=b[c]^1549556828;k=u(a.concat(p.stringToWord(k)),512+8*k.length);k=u(f.concat(k),640);switch(e){case p.outputTypes.Raw:return k;case p.outputTypes.Hex:return p.wordToHex(k);case p.outputTypes.String:return p.wordToString(k);default:return p.wordToBase64(k)}};return p.MD5})},"esri/support/expressionUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../kernel ../arcade/arcade ../arcade/Feature".split(" "),function(p,g,t,v,n,m,u){var k={vars:{$feature:"any",$view:"any"}},
f=/^\$feature\./i,e={_getSyntaxTree:function(b){return"string"===typeof b?e.createSyntaxTree(b):b},createSyntaxTree:function(b){var a;try{a=b?m.parseScript(b):null}catch(c){a=null}return a},createFunction:function(b,a){a=a||p.clone(k);b=e._getSyntaxTree(b);var c;try{c=b?m.compileScript(b,a):null}catch(x){console.log("expressionUtils.createFunction: compilation failed. "+(x.message||"")),c=null}return c},createExecContext:function(b,a){return{vars:{$feature:b?u.createFromGraphic(b):new u,$view:a&&
a.view},spatialReference:a&&a.sr}},evalSyntaxTree:function(b,a){var c;try{c=m.executeScript(b,a,a.spatialReference)}catch(x){c=null}return c},executeFunction:function(b,a){var c;try{c=b?b(a,a.spatialReference):null}catch(x){c=null}return c},executeAsyncFunction:function(b,a){var c;try{c=b?b(a,a.spatialReference):(new v).reject(Error("expressionUtils.executeAsyncFunction: Invalid argument. compiledFunc is missing."))}catch(x){c=(new v).reject(x)}return c},extractFieldNames:function(b){b=e._getSyntaxTree(b);
b=m.extractFieldLiterals(b);var a=[];g.forEach(b,function(b){f.test(b)&&(b=b.replace(f,""),a.push(b))});a.sort();return g.filter(a,function(b,e){return 0===e||a[e-1]!==b})},dependsOnView:function(b){return e.hasVariable(b,"$view")},hasGeometryOperations:function(b){return(b=e._getSyntaxTree(b))?m.scriptUsesGeometryEngine(b):!1},enableGeometryOperations:function(){return m.enableGeometrySupport()},hasVariable:function(b,a){return(b=e._getSyntaxTree(b))?m.referencesMember(b,a):!1},hasFunction:function(b,
a){return(b=e._getSyntaxTree(b))?m.referencesFunction(b,a):!1},createFeatureSetFromLayer:function(b,a){a=a||{};var c=m.featureSetUtils();return c?c.constructFeatureSet(b,a.spatialReference,a.outFields,a.returnGeometry,a.cache):null},createFeatureSetFromLayerUrl:function(b,a){a=a||{};var c=m.featureSetUtils();return c?c.constructFeatureSetFromUrl(b,a.spatialReference,a.outFields,a.returnGeometry,a.cache):null},createFeatureSetCollectionFromMap:function(b,a){var c=m.featureSetUtils();return c?c.createFeatureSetCollectionFromMap(b,
b.spatialReference,a&&a.cache):null},createFeatureSetCollectionFromServiceUrl:function(b,a){a=a||{};var c=m.featureSetUtils();return c?c.createFeatureSetCollectionFromService(b,a.spatialReference,a.cache):null},hasFeatureSetOperations:function(b){return(b=e._getSyntaxTree(b))?m.scriptUsesFeatureSet(b):!1},enableFeatureSetOperations:function(){return m.enableFeatureSetSupport().then(function(){var b=m.featureSetUtils();b&&b.initialiseMetaDataCache()})},enableAsyncOperations:function(){return m.enableAsyncSupport()}};
return e})},"esri/arcade/arcade":function(){define("require exports ./arcadeCompiler ./arcadeRuntime ./parser ./treeAnalysis dojo/has ./polyfill/promiseUtils".split(" "),function(p,g,t,v,n,m,u,k){function f(a,b){if(null===D)throw Error("Async Arcade must be enabled for this script");return u("csp-restrictions")||!1===B?function(b,c){return D.executeScript(a,b,c)}:t.compileScript(a,b,!0)}function e(a,b){void 0===b&&(b=[]);return n.parseScript(a,b)}function b(a,b,c){if(!0===b.useAsync||!0===a.isAsync){if(null===
D)throw Error("Async Arcade must be enabled for this script");return D.executeScript(a,b,c)}return v.executeScript(a,b,c)}function a(a,b){return v.referencesMember(a,b)}function c(a,b){void 0===b&&(b=[]);void 0===a.usesGeometry&&m.findScriptDependencies(a,b);return!0===a.usesGeometry}function x(){return K?K:K=k.create(function(a,b){p(["../geometry/geometryEngine","./functions/geomsync"],function(b,c){F=!0;c.setGeometryEngine(b);a(!0)},function(a){b(a)})})}function w(){return null!==J?J:J=t.enableAsyncSupport().then(function(){return k.create(function(a,
b){p(["./arcadeAsyncRuntime"],function(c){try{D=c;c=0;for(var e=I;c<e.length;c++){var f=e[c];D.extend(f);t.extend(f,"async")}I=null;a(!0)}catch(U){b(U)}},b)})})}function q(){return D?!0:!1}function C(){return L?L:L=w().then(function(){return k.create(function(a,b){p(["./featureSetUtils","./functions/featuresetbase","./functions/featuresetgeom","./functions/featuresetstats","./functions/featuresetstring"],function(c,e,f,k,q){try{M=c,D.extend([e,f,k,q]),t.extend([e,f,k,q],"async"),G=!0,a(!0)}catch(A){b(A)}},
b)})})}function z(a,b){void 0===b&&(b=[]);void 0===a.usesFeatureSet&&m.findScriptDependencies(a,b);return!0===a.usesFeatureSet}function E(b,c){if(c)for(var e=0;e<c.length;e++)if(a(b,c[e]))return!0;return!1}Object.defineProperty(g,"__esModule",{value:!0});var B=function(){if(u("csp-restrictions"))return!1;try{return(new Function("function* test() {}; return true"))()}catch(Q){return!1}}(),G=!1,F=!1,D=null,I=[];g.compileScript=function(a,b){return!0===b.useAsync||!0===a.isAsync?f(a,b):u("csp-restrictions")?
function(b,c){return v.executeScript(a,b,c)}:t.compileScript(a,b)};g.extend=function(a){v.extend(a);t.extend(a,"sync");null===D?I.push(a):(t.extend(a,"async"),D.extend(a))};g.parseScript=e;g.validateScript=function(a,b,c){void 0===c&&(c="");return n.validateScript(a,b,c)};g.scriptCheck=function(a,b,c,e){void 0===e&&(e="");return n.scriptCheck(a,b,c,e)};g.parseAndExecuteScript=function(a,c,e,f){void 0===f&&(f=[]);a=n.parseScript(a,f);return b(a,c,e)};g.executeScript=b;g.referencesMember=a;g.referencesFunction=
function(a,b){return v.referencesFunction(a,b)};g.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return n.extractFieldLiterals(a,b)};g.scriptUsesGeometryEngine=c;var K=null;g.enableGeometrySupport=x;var J=null;g.enableAsyncSupport=w;g.isFeatureSetSupportEnabled=function(){return G};g.isAsyncEnabled=q;g.isGeometryEnabled=function(){return F};var L=null;g.enableFeatureSetSupport=C;g.scriptUsesFeatureSet=z;g.scriptIsAsync=function(a,b){void 0===b&&(b=[]);void 0===a.isAsync&&m.findScriptDependencies(a,
b);return!0===a.isAsync};g.loadScriptDependencies=function(a,b,f,g){void 0===f&&(f=[]);void 0===g&&(g=!1);return k.create(function(m,n){var u="string"===typeof a?e(a):a,A=[];u&&(!1===F&&(c(u)||g)&&A.push(x()),!1===q()&&(!0===u.isAsync||b)&&A.push(w()),!1===G&&(z(u)||E(u,f))&&A.push(C()));A?k.all(A).then(function(){m(!0)},n):m(!0)})};g.scriptTouchesGeometry=function(a){if(c(a))return!0;a=m.findFunctionCalls(a,!0);return-1<a.indexOf("geometry")||-1<a.indexOf("feature")?!0:!1};var M=null;g.featureSetUtils=
function(){return M}})},"esri/arcade/arcadeCompiler":function(){define("require exports ./Attachment ./Dictionary ./Feature ./ImmutablePathArray ./ImmutablePointArray ./languageUtils ./treeAnalysis ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ./polyfill/promiseUtils ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../SpatialReference".split(" "),function(p,
g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){function I(d,h,a){try{return a(d,null,h)}catch(ua){throw ua;}}function K(d){return d instanceof Error?q.reject(d):q.reject(Error(d))}function J(a,l){try{switch(l.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return T(a,l);case "VariableDeclaration":for(var r=[],b=0;b<l.declarations.length;b++)r.push(J(a,l.declarations[b]));return r.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":return S(a,
l);case "FunctionDeclaration":var y=l.id.name.toLowerCase(),c={isAsync:a.isAsync,applicationCache:void 0===a.applicationCache?null:a.applicationCache,spatialReference:a.spatialReference,console:a.console,lrucache:a.lrucache,services:a.services,symbols:a.symbols,mangleMap:a.mangleMap,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter+1,globalScope:a.globalScope};if(64<c.depthCounter)throw Error("Exceeded maximum function depth");for(var r="new lc.SizzleFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; \n   var lscope \x3d runtimeCtx.localStack[runtimeCtx.localStack.length-1];\n",
e=0;e<l.params.length;e++){var A=l.params[e].name.toLowerCase(),H=d(A,a);c.localScope._SymbolsMap[A]=H;c.mangleMap[A]=H;r+="lscope['"+H+"']\x3darguments["+e.toString()+"];\n"}!0===a.isAsync?(r=r+"return lang.__awaiter(this, void 0, void 0, function* () {\n"+(S(c,l.body)+"\n return lastStatement; "),r+="});  }, runtimeCtx))\n lastStatement \x3d lc.voidOperation; \n"):(r+=S(c,l.body)+"\n return lastStatement; }, runtimeCtx))",r+="\n lastStatement \x3d lc.voidOperation; \n");void 0!==a.globalScope[y]?
b="gscope['"+y+"']\x3d"+r:void 0!==a.globalScope._SymbolsMap[y]?b="gscope['"+a.globalScope._SymbolsMap[y]+"']\x3d"+r:(H=d(y,a),a.globalScope._SymbolsMap[y]=H,a.mangleMap[y]=H,b="gscope['"+H+"']\x3d"+r);return b;case "ReturnStatement":var k;k=null===l.argument?"return lc.voidOperation":"return "+J(a,l.argument)+"";return k;case "IfStatement":if("AssignmentExpression"===l.test.type||"UpdateExpression"===l.test.type)throw Error(f.nodeErrorMessage(l.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));
var q=J(a,l.test),g=h(a),m="var "+g+" \x3d "+q+";\n if ("+g+" \x3d\x3d\x3d true) {\n"+Q(a,l.consequent)+"\n }\n",m=null!==l.alternate?m+("else if ("+g+"\x3d\x3d\x3dfalse)   { \n"+Q(a,l.alternate)+"}\n"):m+("else if ("+g+"\x3d\x3d\x3dfalse) { \n lastStatement \x3d lc.voidOperation;\n }\n");return m+="else { lang.error({type: '"+l.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION'); \n}\n";case "ExpressionStatement":var w;w="AssignmentExpression"===l.expression.type?"lastStatement \x3d lc.voidOperation; "+
J(a,l.expression)+"; \n ":"lastStatement \x3d "+J(a,l.expression)+"; ";return w;case "AssignmentExpression":return M(a,l);case "UpdateExpression":return L(a,l);case "BreakStatement":return"break";case "ContinueStatement":return"continue";case "ForStatement":r="lastStatement \x3d lc.voidOperation; \n";null!==l.init&&(r+=J(a,l.init)+"; ");var x=h(a),P=h(a),r=r+("var "+x+" \x3d true; ")+"\n do { ";null!==l.update&&(r+=" if ("+x+"\x3d\x3d\x3dfalse) {\n "+J(a,l.update)+"  \n}\n "+x+"\x3dfalse; \n");null!==
l.test&&(r+="var "+P+" \x3d "+J(a,l.test)+"; ",r+="if ("+P+"\x3d\x3d\x3dfalse) { break; } else if ("+P+"!\x3d\x3dtrue) { lang.error({type: '"+l.type+"'},'RUNTIME','CANNOT_USE_NONBOOLEAN_IN_CONDITION');   }\n");r+=J(a,l.body);null!==l.update&&(r+="\n "+J(a,l.update));return r+("\n"+x+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation; ");case "ForInStatement":var n=h(a),u=h(a),B=h(a),z="var "+n+" \x3d "+J(a,l.right)+";\n";"VariableDeclaration"===l.left.type&&(z+=J(a,l.left));var p=
"VariableDeclaration"===l.left.type?l.left.declarations[0].id.name:l.left.name,p=p.toLowerCase(),r="";null!==a.localScope&&(void 0!==a.localScope[p]?r="lscope['"+p+"']":void 0!==a.localScope._SymbolsMap[p]&&(r="lscope['"+a.localScope._SymbolsMap[p]+"']"));""===r&&(void 0!==a.globalScope[p]?r="gscope['"+p+"']":void 0!==a.globalScope._SymbolsMap[p]&&(r="gscope['"+a.globalScope._SymbolsMap[p]+"']"));z=z+("if ("+n+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n ")+("else if (lc.isArray("+
n+") || lc.isString("+n+")) {")+("var "+u+"\x3d"+n+".length; \n")+("for(var "+B+"\x3d0; "+B+"\x3c"+u+"; "+B+"++) {\n");z+=r+"\x3d"+B+";\n";z+=J(a,l.body);z+="\n}\n";z+=" lastStatement \x3d lc.voidOperation; \n";z+=" \n}\n";z+="else if (lc.isImmutableArray("+n+")) {";z=z+("var "+u+"\x3d"+n+".length(); \n")+("for(var "+B+"\x3d0; "+B+"\x3c"+u+"; "+B+"++) {\n");z+=r+"\x3d"+B+";\n";z+=J(a,l.body);z+="\n}\n";z+=" lastStatement \x3d lc.voidOperation; \n";z+=" \n}\n";z+="else if (( "+n+" instanceof lang.Dictionary) || ( "+
n+" instanceof lang.Feature)) {";z=z+("var "+u+"\x3d"+n+".keys(); \n")+("for(var "+B+"\x3d0; "+B+"\x3c"+u+".length; "+B+"++) {\n");z+=r+"\x3d"+u+"["+B+"];\n";z+=J(a,l.body);z+="\n}\n";z+=" lastStatement \x3d lc.voidOperation; \n";z+=" \n}\n";a.isAsync&&(z+="else if (lc.isFeatureSet("+n+")) {",z=z+("var "+u+"\x3d"+n+".iterator(runtimeCtx.progressTracker); \n")+("for(var "+B+"\x3dlang. graphicToFeature( yield "+u+".next(),"+n+"); "+B+"!\x3dnull; "+B+"\x3dlang. graphicToFeature( yield "+u+".next(),"+
n+")) {\n")+(r+"\x3d"+B+";\n"),z+=J(a,l.body),z+="\n}\n",z+=" lastStatement \x3d lc.voidOperation; \n",z+=" \n}\n");return z+"else { lastStatement \x3d lc.voidOperation; } \n";case "Identifier":return W(a,l);case "MemberExpression":var C;try{r=void 0,r=!0===l.computed?J(a,l.property):"'"+l.property.name+"'",C="lang.member("+J(a,l.object)+","+r+")"}catch(ia){throw ia;}return C;case "Literal":return null===l.value||void 0===l.value?"null":JSON.stringify(l.value);case "ThisExpression":throw Error(f.nodeErrorMessage(l,
"RUNTIME","NOTSUPPORTED"));case "CallExpression":try{if("Identifier"!==l.callee.type)throw Error(f.nodeErrorMessage(l,"RUNTIME","ONLYNODESSUPPORTED"));var ba=l.callee.name.toLowerCase(),b="";null!==a.localScope&&(void 0!==a.localScope[ba]?b="lscope['"+ba+"']":void 0!==a.localScope._SymbolsMap[ba]&&(b="lscope['"+a.localScope._SymbolsMap[ba]+"']"));""===b&&(void 0!==a.globalScope[ba]?b="gscope['"+ba+"']":void 0!==a.globalScope._SymbolsMap[ba]&&(b="gscope['"+a.globalScope._SymbolsMap[ba]+"']"));if(""!==
b){y="[";for(c=0;c<l.arguments.length;c++)0<c&&(y+=", "),y+=J(a,l.arguments[c]);y+="]";r=a.isAsync?"(yield lang.callfunc("+b+","+y+",runtimeCtx) )":"lang.callfunc("+b+","+y+",runtimeCtx)"}else throw Error(f.nodeErrorMessage(l,"RUNTIME","NOTFOUND"));}catch(ia){throw ia;}return r;case "UnaryExpression":var D;try{D="lang.unary("+J(a,l.argument)+",'"+l.operator+"')"}catch(ia){throw ia;}return D;case "BinaryExpression":var v;try{v="lang.binary("+J(a,l.left)+","+J(a,l.right)+",'"+l.operator+"')"}catch(ia){throw ia;
}return v;case "LogicalExpression":var F;try{if("AssignmentExpression"===l.left.type||"UpdateExpression"===l.left.type)throw Error(f.nodeErrorMessage(l.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===l.right.type||"UpdateExpression"===l.right.type)throw Error(f.nodeErrorMessage(l.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("\x26\x26"===l.operator||"||"===l.operator)F="(lang.logicalCheck("+J(a,l.left)+") "+l.operator+" lang.logicalCheck("+J(a,l.right)+
"))";else throw Error(f.nodeErrorMessage(l,"RUNTIME","ONLYORORAND"));}catch(ia){throw ia;}return F;case "ConditionalExpression":throw Error(f.nodeErrorMessage(l,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{r=[];for(b=0;b<l.elements.length;b++)"Literal"===l.elements[b].type?r.push(J(a,l.elements[b])):r.push("lang.aCheck("+J(a,l.elements[b])+",'ArrayExpression')");e="["+r.join(",")+"]"}catch(ia){throw ia;}return e;case "ObjectExpression":r="lang.dictionary([";for(b=0;b<l.properties.length;b++){var G=
l.properties[b],E="Identifier"===G.key.type?"'"+G.key.name+"'":J(a,G.key),t=J(a,G.value);0<b&&(r+=",");r+="lang.strCheck("+E+",'ObjectExpression'),lang.aCheck("+t+", 'ObjectExpression')"}return r+"])";case "Property":throw Error("Should not get here");case "Array":throw Error(f.nodeErrorMessage(l,"RUNTIME","NOTSUPPORTED"));default:throw Error(f.nodeErrorMessage(l,"RUNTIME","UNREOGNISED"));}}catch(ia){throw ia;}}function L(d,h){var a=null,l="";if("MemberExpression"===h.argument.type)return a=J(d,h.argument.object),
l=!0===h.argument.computed?J(d,h.argument.property):"'"+h.argument.property.name+"'","lang.memberupdate("+a+","+l+",'"+h.operator+"',"+h.prefix+")";a=h.argument.name.toLowerCase();if(null!==d.localScope){if(void 0!==d.localScope[a])return"lang.update(lscope, '"+a+"','"+h.operator+"',"+h.prefix+")";if(void 0!==d.localScope._SymbolsMap[a])return"lang.update(lscope, '"+d.localScope._SymbolsMap[a]+"','"+h.operator+"',"+h.prefix+")"}if(void 0!==d.globalScope[a])return"lang.update(gscope, '"+a+"','"+h.operator+
"',"+h.prefix+")";if(void 0!==d.globalScope._SymbolsMap[a])return"lang.update(gscope, '"+d.globalScope._SymbolsMap[a]+"','"+h.operator+"',"+h.prefix+")";throw Error("Variable not recognised");}function M(d,h){var a=J(d,h.right),l=null,r="";if("MemberExpression"===h.left.type)return l=J(d,h.left.object),r=!0===h.left.computed?J(d,h.left.property):"'"+h.left.property.name+"'","lang.assignmember("+l+","+r+",'"+h.operator+"',"+a+")";l=h.left.name.toLowerCase();if(null!==d.localScope){if(void 0!==d.localScope[l])return"lscope['"+
l+"']\x3dlang.assign("+a+",'"+h.operator+"', lscope['"+l+"'])";if(void 0!==d.localScope._SymbolsMap[l])return"lscope['"+d.localScope._SymbolsMap[l]+"']\x3dlang.assign("+a+",'"+h.operator+"', lscope['"+d.localScope._SymbolsMap[l]+"'])"}if(void 0!==d.globalScope[l])return"gscope['"+l+"']\x3dlang.assign("+a+",'"+h.operator+"', gscope['"+l+"'])";if(void 0!==d.globalScope._SymbolsMap[l])return"gscope['"+d.globalScope._SymbolsMap[l]+"']\x3dlang.assign("+a+",'"+h.operator+"', gscope['"+d.globalScope._SymbolsMap[l]+
"'])";throw Error("Variable not recognised");}function Q(d,h){return"BlockStatement"===h.type?J(d,h):"ReturnStatement"===h.type||"BreakStatement"===h.type||"ContinueStatement"===h.type?J(d,h)+"; ":"UpdateExpression"===h.type?"lastStatement \x3d "+J(d,h)+"; ":"ExpressionStatement"===h.type?J(d,h):"ObjectExpression"===h.type?"lastStatement \x3d "+J(d,h)+"; ":J(d,h)+"; "}function S(d,h){for(var a="",l=0;l<h.body.length;l++)a="ReturnStatement"===h.body[l].type?a+(J(d,h.body[l])+"; \n"):"BreakStatement"===
h.body[l].type?a+(J(d,h.body[l])+"; \n"):"ContinueStatement"===h.body[l].type?a+(J(d,h.body[l])+"; \n"):"UpdateExpression"===h.body[l].type?a+("lastStatement \x3d "+J(d,h.body[l])+"; \n"):"ObjectExpression"===h.body[l].type?a+("lastStatement \x3d "+J(d,h.body[l])+"; \n"):a+(J(d,h.body[l])+" \n");return a}function T(h,a){var l=null===a.init?null:J(h,a.init);l===k.voidOperation&&(l=null);a=a.id.name.toLowerCase();if(null!==h.localScope){if(void 0!==h.localScope[a])return"lscope['"+a+"']\x3d"+l+"; ";
if(void 0!==h.localScope._SymbolsMap[a])return"lscope['"+h.localScope._SymbolsMap[a]+"']\x3d"+l+"; ";var r=d(a,h);h.localScope._SymbolsMap[a]=r;h.mangleMap[a]=r;return"lscope['"+r+"']\x3d"+l+"; "}if(void 0!==h.globalScope[a])return"gscope['"+a+"']\x3d"+l+"; ";if(void 0!==h.globalScope._SymbolsMap[a])return"gscope['"+h.globalScope._SymbolsMap[a]+"']\x3d"+l+"; ";r=d(a,h);h.globalScope._SymbolsMap[a]=r;h.mangleMap[a]=r;return"gscope['"+r+"']\x3d"+l+"; "}function O(d,h,a){h=h.toLowerCase();switch(h){case "hasz":return d=
d.hasZ,void 0===d?!1:d;case "hasm":return d=d.hasM,void 0===d?!1:d;case "spatialreference":return h=d.spatialReference._arcadeCacheId,void 0===h&&(a=!0,Object.freeze&&Object.isFrozen(d.spatialReference)&&(a=!1),a&&(ba++,h=d.spatialReference._arcadeCacheId=ba)),d=new v({wkt:d.spatialReference.wkt,wkid:d.spatialReference.wkid}),void 0!==h&&(d._arcadeCacheId="SPREF"+h.toString()),d}switch(d.type){case "extent":switch(h){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return d=
d[h],void 0!==d?d:null;case "type":return"Extent"}break;case "polygon":switch(h){case "rings":return h=d.getCacheValue("_arcadeCacheId"),void 0===h&&(ba++,h=ba,d.setCacheValue("_arcadeCacheId",h)),d=new m(d.rings,d.spatialReference,!0===d.hasZ,!0===d.hasM,h);case "type":return"Polygon"}break;case "point":switch(h){case "x":case "y":case "z":case "m":return void 0!==d[h]?d[h]:null;case "type":return"Point"}break;case "polyline":switch(h){case "paths":return h=d.getCacheValue("_arcadeCacheId"),void 0===
h&&(ba++,h=ba,d.setCacheValue("_arcadeCacheId",h)),d=new m(d.paths,d.spatialReference,!0===d.hasZ,!0===d.hasM,h);case "type":return"Polyline"}break;case "multipoint":switch(h){case "points":return h=d.getCacheValue("_arcadeCacheId"),void 0===h&&(ba++,h=ba,d.setCacheValue("_arcadeCacheId",h)),d=new u(d.points,d.spatialReference,!0===d.hasZ,!0===d.hasM,h,1);case "type":return"Multipoint"}}throw Error(f.nodeErrorMessage(a,"RUNTIME","PROPERTYNOTFOUND"));}function W(d,h){try{var a=h.name.toLowerCase();
if(null!==d.localScope){if(void 0!==d.localScope[a])return"lscope['"+a+"']";if(void 0!==d.localScope._SymbolsMap[a])return"lscope['"+d.localScope._SymbolsMap[a]+"']"}if(void 0!==d.globalScope[a])return"gscope['"+a+"']";if(void 0!==d.globalScope._SymbolsMap[a])return"gscope['"+d.globalScope._SymbolsMap[a]+"']";throw Error(f.nodeErrorMessage(h,"RUNTIME","VARIABLENOTFOUND"));}catch(ua){throw ua;}}function U(d){return null===d?"":k.isArray(d)||k.isImmutableArray(d)?"Array":k.isDate(d)?"Date":k.isString(d)?
"String":k.isBoolean(d)?"Boolean":k.isNumber(d)?"Number":d instanceof t?"Attachment":d instanceof v?"Dictionary":d instanceof n?"Feature":d instanceof B?"Point":d instanceof G?"Polygon":d instanceof F?"Polyline":d instanceof E?"Multipoint":d instanceof C?"Extent":k.isFunctionParameter(d)?"Function":k.isFeatureSet(d)?"FeatureSet":k.isFeatureSetCollection(d)?"FeatureSetCollection":d===k.voidOperation?"":"number"===typeof d&&isNaN(d)?"Number":"Unrecognised Type"}function V(d,h,a,l){try{if(k.equalityTest(h[a],
l))return h[a+1];var r=h.length-a;return 1===r?h[a]:2===r?null:3===r?h[a+2]:V(d,h,a+2,l)}catch(oa){throw oa;}}function A(d,h,a,l){try{if(!0===l)return h[a+1];if(3===h.length-a)return h[a+2];var r=h[a+2];if(!1===k.isBoolean(r))throw Error("WHEN needs boolean test conditions");return A(d,h,a+2,r)}catch(oa){throw oa;}}function X(d,h){var a=d.length,l=Math.floor(a/2);if(0===a)return[];if(1===a)return[d[0]];var r=X(d.slice(0,l),h);d=X(d.slice(l,a),h);for(a=[];0<r.length||0<d.length;)0<r.length&&0<d.length?
(l=h(r[0],d[0]),isNaN(l)&&(l=0),0>=l?(a.push(r[0]),r=r.slice(1)):(a.push(d[0]),d=d.slice(1))):0<r.length?(a.push(r[0]),r=r.slice(1)):0<d.length&&(a.push(d[0]),d=d.slice(1));return a}function aa(d,h){try{var a=d.length,r=Math.floor(a/2);if(0===a)return q.resolve([]);if(1===a)return q.resolve([d[0]]);var b=[aa(d.slice(0,r),h),aa(d.slice(r,a),h)];return q.all(b).then(function(d){return l(d[0],d[1],h,[])})}catch(oa){return q.reject(oa)}}function l(d,h,a,r){return q.create(function(b,y){0<d.length||0<
h.length?0<d.length&&0<h.length?a(d[0],h[0]).then(function(c){try{isNaN(c)&&(c=1),0>=c?(r.push(d[0]),d=d.slice(1)):(r.push(h[0]),h=h.slice(1)),l(d,h,a,r).then(function(d){b(d)},y)}catch(pa){y(pa)}},y):0<d.length?(r.push(d[0]),d=d.slice(1),l(d,h,a,r).then(function(d){b(d)},y)):0<h.length&&(r.push(h[0]),h=h.slice(1),l(d,h,a,r).then(function(d){b(d)},y)):b(r)})}function d(d,h){h.symbols.symbolCounter++;return"_T"+h.symbols.symbolCounter.toString()}function h(d){d.symbols.symbolCounter++;return"_Tvar"+
d.symbols.symbolCounter.toString()}function r(d,h,a){var l={};d||(d={});a||(a={});l._SymbolsMap={};l.textformatting=1;l.infinity=1;l.pi=1;for(var r in h)l[r]=1;for(r in a)l[r]=1;for(r in d)l[r]=1;return l}function y(d,h){for(var a={mode:h,compiled:!0,functions:{},signatures:[],failDefferred:K,standardFunction:I,standardFunctionAsync:I,evaluateIdentifier:H},l=0;l<d.length;l++)d[l].registerFunctions(a);if("sync"===h){for(var r in a.functions)ea[r]=new k.NativeFunction(a.functions[r]),Ca.prototype[r]=
ea[r];for(l=0;l<a.signatures.length;l++)f.addFunctionDeclaration(a.signatures[l],"sync")}else{for(r in a.functions)va[r]=new k.NativeFunction(a.functions[r]),ma.prototype[r]=va[r];for(l=0;l<a.signatures.length;l++)f.addFunctionDeclaration(a.signatures[l],"async")}}function H(d,h){h=h.name;if("_SymbolsMap"===h)throw"Illegal";if(0<d.localStack.length){if("_t"!==h.substr(0,2).toLowerCase()&&void 0!==d.localStack[d.localStack.length-1][h])return d.localStack[d.localStack.length-1][h];var a=d.mangleMap[h];
if(void 0!==a&&void 0!==d.localStack[d.localStack.length-1][a])return d.localStack[d.localStack.length-1][a]}if("_t"!==h.substr(0,2).toLowerCase()&&void 0!==d.globalScope[h]||1===d.globalScope._SymbolsMap[h])return d.globalScope[h];h=d.mangleMap[h];if(void 0!==h)return d.globalScope[h]}function P(d){console.log(d)}Object.defineProperty(g,"__esModule",{value:!0});var ba=0,ea={};e.registerFunctions(ea,I);w.registerFunctions(ea,I);c.registerFunctions(ea,I);b.registerFunctions(ea,I);x.registerFunctions(ea,
I);ea["typeof"]=function(d,h){return I(d,h,function(d,h,a){k.pcCheck(a,1,1);d=U(a[0]);if("Unrecognised Type"===d)throw Error("Unrecognised Type");return d})};ea.iif=function(d,h){try{return I(d,h,function(d,h,a){k.pcCheck(a,3,3);if(!1===k.isBoolean(a[0]))throw Error("IF Function must have a boolean test condition");return a[0]?a[1]:a[2]})}catch(la){throw la;}};ea.decode=function(d,h){try{return I(d,h,function(h,a,l){if(2>l.length)throw Error("Missing Parameters");if(2===l.length)return l[1];if(0===
(l.length-1)%2)throw Error("Must have a default value result.");return V(d,l,1,l[0])})}catch(la){throw la;}};ea.when=function(d,h){try{return I(d,h,function(h,a,l){if(3>l.length)throw Error("Missing Parameters");if(0===l.length%2)throw Error("Must have a default value result.");h=l[0];if(!1===k.isBoolean(h))throw Error("WHEN needs boolean test conditions");return A(d,l,0,h)})}catch(la){throw la;}};ea.top=function(d,h){return I(d,h,function(d,h,a){k.pcCheck(a,2,2);if(k.isArray(a[0]))return k.toNumber(a[1])>=
a[0].length?a[0].slice(0):a[0].slice(0,k.toNumber(a[1]));if(k.isImmutableArray(a[0]))return k.toNumber(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,k.toNumber(a[1]));throw Error("Top cannot accept this parameter type");})};ea.first=function(d,h){return I(d,h,function(d,h,a){k.pcCheck(a,1,1);return k.isArray(a[0])?0===a[0].length?null:a[0][0]:k.isImmutableArray(a[0])?0===a[0].length()?null:a[0].get(0):null})};ea.sort=function(d,h){return I(d,h,function(h,a,l){k.pcCheck(l,1,2);a=l[0];k.isImmutableArray(a)&&
(a=a.toArray());if(!1===k.isArray(a))throw Error("Illegal Argument");if(1<l.length){if(!1===k.isFunctionParameter(l[1]))throw Error("Illegal Argument");var r=function(d,a){return wa.callfunc(l[1],[d,a],h)};return d.isAsync?aa(a,r):a=X(a,function(d,h){return r(d,h)})}if(0===a.length)return[];for(var b={},y=0;y<a.length;y++){var c=U(a[y]);""!==c&&(b[c]=!0)}if(!0===b.Array||!0===b.Dictionary||!0===b.Feature||!0===b.Point||!0===b.Polygon||!0===b.Polyline||!0===b.Multipoint||!0===b.Extent||!0===b.Function)return a.slice(0);
var y=0,c="",e;for(e in b)y++,c=e;return a=1<y||"String"===c?X(a,function(d,h){if(null===d||void 0===d||d===k.voidOperation)return null===h||void 0===h||h===k.voidOperation?0:1;if(null===h||void 0===h||h===k.voidOperation)return-1;d=k.toString(d);h=k.toString(h);return d<h?-1:d===h?0:1}):"Number"===c?X(a,function(d,h){return d-h}):"Boolean"===c?X(a,function(d,h){return d===h?0:h?-1:1}):"Date"===c?X(a,function(d,h){return h-d}):a.slice(0)})};var va={},N;for(N in ea)va[N]=new k.NativeFunction(ea[N]);
a.registerFunctions(ea,I);for(N in ea)ea[N]=new k.NativeFunction(ea[N]);var Ca=function(){};Ca.prototype=ea;var ma=function(){};ma.prototype=va;g.functionHelper={fixSpatialReference:k.fixSpatialReference,parseArguments:function(d,h){for(var a=[],l=0;l<h.arguments.length;l++)a.push(J(d,h.arguments[l]));return a},standardFunction:I};g.extend=y;g.executeScript=function(d,h,a){return d(h,a)};g.extractFieldLiterals=function(d,h){void 0===h&&(h=!1);return f.findFieldLiterals(d,h)};g.validateScript=function(d,
h){return f.validateScript(d,h,"sync")};g.referencesMember=function(d,h){return f.referencesMember(d,h)};g.referencesFunction=function(d,h){return f.referencesFunction(d,h)};var wa={error:function(d,h,a){throw Error(f.nodeErrorMessage(d,h,a));},__awaiter:function(d,h,a,l){return q.create(function(a,r){function b(d){try{c(l.next(d))}catch(za){r(za)}}function y(d){try{c(l["throw"](d))}catch(za){r(za)}}function c(d){d.done?a(d.value):d.value&&k.isFeatureSet(d.value)?b(d.value):d.value&&d.value.then?
d.value.then(b,y):b(d.value)}c((l=l.apply(d,h||[])).next())})},functionDepthchecker:function(d,h){return function(){h.depthCounter++;h.localStack.push([]);if(64<h.depthCounter)throw Error("Exceeded maximum function depth");var a=d.apply(this,arguments);h.depthCounter--;--h.localStack.length;return a}},aCheck:function(d,h){if(k.isFunctionParameter(d))throw Error(f.nodeErrorMessage({type:h},"RUNTIME","FUNCTIONCONTEXTILLEGAL"));return d===k.voidOperation?null:d},Dictionary:v,Feature:n,dictionary:function(d){for(var h=
{},a=0;a<d.length;a+=2){if(k.isFunctionParameter(d[a+1]))throw Error("Illegal Argument");if(!1===k.isString(d[a]))throw Error("Illegal Argument");h[d[a].toString()]=d[a+1]===k.voidOperation?null:d[a+1]}d=new v(h);d.immutable=!1;return d},strCheck:function(d,h){if(!1===k.isString(d))throw Error("Illegal Argument");return d},unary:function(d,h){if(k.isBoolean(d)){if("!"===h)return!d;if("-"===h)return-1*k.toNumber(d);if("+"===h)return 1*k.toNumber(d);throw Error(f.nodeErrorMessage({type:"UnaryExpression",
operator:h,prefix:null,argument:null},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===h)return-1*k.toNumber(d);if("+"===h)return 1*k.toNumber(d);throw Error(f.nodeErrorMessage({type:"UnaryExpression",operator:h,prefix:null,argument:null},"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));},logicalCheck:function(d){if(!1===k.isBoolean(d))throw Error(f.nodeErrorMessage({type:"LogicalExpression",operator:null,left:null,right:null},"RUNTIME","ONLYORORAND"));return d},logical:function(d,h,a){if(k.isBoolean(d)&&
k.isBoolean(h))switch(a){case "||":return d||h;case "\x26\x26":return d&&h}throw Error(f.nodeErrorMessage({type:"LogicalExpression",operator:null,left:null,right:null},"RUNTIME","ONLYORORAND"));},binary:function(d,h,a){switch(a){case "\x3d\x3d":return k.equalityTest(d,h);case "\x3d":return k.equalityTest(d,h);case "!\x3d":return!k.equalityTest(d,h);case "\x3c":return k.greaterThanLessThan(d,h,a);case "\x3e":return k.greaterThanLessThan(d,h,a);case "\x3c\x3d":return k.greaterThanLessThan(d,h,a);case "\x3e\x3d":return k.greaterThanLessThan(d,
h,a);case "+":return k.isString(d)||k.isString(h)?k.toString(d)+k.toString(h):k.toNumber(d)+k.toNumber(h);case "-":return k.toNumber(d)-k.toNumber(h);case "*":return k.toNumber(d)*k.toNumber(h);case "/":return k.toNumber(d)/k.toNumber(h);case "%":return k.toNumber(d)%k.toNumber(h);default:throw Error(f.nodeErrorMessage({type:"BinaryExpression",operator:a,left:d,right:h},"RUNTIME","OPERATORNOTRECOGNISED"));}},assign:function(d,h,a){switch(h){case "\x3d":return d===k.voidOperation?null:d;case "/\x3d":return k.toNumber(a)/
k.toNumber(d);case "*\x3d":return k.toNumber(a)*k.toNumber(d);case "-\x3d":return k.toNumber(a)-k.toNumber(d);case "+\x3d":return k.isString(a)||k.isString(d)?k.toString(a)+k.toString(d):k.toNumber(a)+k.toNumber(d);case "%\x3d":return k.toNumber(a)%k.toNumber(d);default:throw Error(f.nodeErrorMessage({type:"AssignmentExpression",operator:h,left:null,right:null},"RUNTIME","OPERATORNOTRECOGNISED"));}},update:function(d,h,a,l){var r=k.toNumber(d[h]);d[h]="++"===a?r+1:r-1;return!1===l?r:"++"===a?r+1:
r-1},graphicToFeature:function(d,h){return null===d?null:n.createFromGraphicLikeObject(d.geometry,d.attributes,h)},memberupdate:function(d,h,a,l){var r;if(k.isArray(d))if(k.isNumber(h)){0>h&&(h=d.length+h);if(0>h||h>=d.length)throw Error("Assignment outside of array bounds");r=k.toNumber(d[h]);d[h]="++"===a?r+1:r-1}else throw Error("Invalid Parameter");else if(d instanceof v){if(!1===k.isString(h))throw Error("Dictionary accessor must be a string");if(!0===d.hasField(h))r=k.toNumber(d.field(h)),d.setField(h,
"++"===a?r+1:r-1);else throw Error("Invalid Parameter");}else if(d instanceof n){if(!1===k.isString(h))throw Error("Feature accessor must be a string");if(!0===d.hasField(h))r=k.toNumber(d.field(h)),d.setField(h,"++"===a?r+1:r-1);else throw Error("Invalid Parameter");}else{if(k.isImmutableArray(d))throw Error("Array is Immutable");throw Error("Invalid Parameter");}return!1===l?r:"++"===a?r+1:r-1},assignmember:function(d,h,a,l){if(k.isArray(d))if(k.isNumber(h)){0>h&&(h=d.length+h);if(0>h||h>d.length)throw Error("Assignment outside of array bounds");
if(h===d.length&&"\x3d"!==a)throw Error("Invalid Parameter");d[h]=this.assign(l,a,d[h])}else throw Error("Invalid Parameter");else if(d instanceof v){if(!1===k.isString(h))throw Error("Dictionary accessor must be a string");if(!0===d.hasField(h))d.setField(h,this.assign(l,a,d.field(h)));else{if("\x3d"!==a)throw Error("Invalid Parameter");d.setField(h,this.assign(l,a,null))}}else if(d instanceof n){if(!1===k.isString(h))throw Error("Feature accessor must be a string");if(!0===d.hasField(h))d.setField(h,
this.assign(l,a,d.field(h)));else{if("\x3d"!==a)throw Error("Invalid Parameter");d.setField(h,this.assign(l,a,null))}}else{if(k.isImmutableArray(d))throw Error("Array is Immutable");throw Error("Invalid Parameter");}},member:function(d,h){if(null===d)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","NOTFOUND"));if(d instanceof v||d instanceof n){if(k.isString(h))return d.field(h);throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,
property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(d instanceof z){if(k.isString(h))return O(d,h,"MemberExpression");throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(k.isArray(d)){if(k.isNumber(h)&&isFinite(h)&&Math.floor(h)===h){0>h&&(h=d.length+h);if(h>=d.length||0>h)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return d[h]}throw Error(f.nodeErrorMessage({type:"MemberExpression",
object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(k.isString(d)){if(k.isNumber(h)&&isFinite(h)&&Math.floor(h)===h){0>h&&(h=d.length+h);if(h>=d.length||0>h)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return d[h]}throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));}if(k.isImmutableArray(d)&&k.isNumber(h)&&isFinite(h)&&Math.floor(h)===
h){0>h&&(h=d.length()+h);if(h>=d.length()||0>h)throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","OUTOFBOUNDS"));return d.get(h)}throw Error(f.nodeErrorMessage({type:"MemberExpression",object:null,property:null,computed:null},"RUNTIME","INVALIDTYPE"));},callfunc:function(d,h,a){return d instanceof k.NativeFunction?d.fn(a,h):d instanceof k.SizzleFunction?d.fn.apply(this,h):d.apply(this,h)}};g.compileScript=function(d,h,a){void 0===h&&(h=null);
void 0===a&&(a=!1);null===h&&(h={vars:{},customfunctions:{}});h={isAsync:a,globalScope:r(h.vars,a?va:ea,h.customfunctions),localScope:null,mangleMap:{},console:P,lrucache:h.lrucache,services:h.services,symbols:{symbolCounter:0}};d=J(h,d.body[0].body);""===d&&(d="lc.voidOperation; ");h={lc:k,lang:wa,mangles:h.mangleMap,postProcess:function(d){d instanceof k.ReturnResult&&(d=d.value);d instanceof k.ImplicitResult&&(d=d.value);d===k.voidOperation&&(d=null);if(d===k.breakResult)throw Error("Cannot return BREAK");
if(d===k.continueResult)throw Error("Cannot return CONTINUE");if(k.isFunctionParameter(d))throw Error("Cannot return FUNCTION");return d},prepare:function(d,h,a){h||(h=new D({wkid:102100}));var l=d.vars,r=d.customfunctions,b=a?new ma:new Ca;l||(l={});r||(r={});var y=new v({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});y.immutable=!1;b._SymbolsMap={textformatting:1,infinity:1,pi:1};b.textformatting=y;b.infinity=Number.POSITIVE_INFINITY;b.pi=Math.PI;for(var c in r)b[c]=
r[c],b._SymbolsMap[c]=1;for(c in l)b._SymbolsMap[c]=1,b[c]=l[c]&&"esri.Graphic"===l[c].declaredClass?n.createFromGraphic(l[c]):l[c];return{localStack:[],isAsync:a,mangleMap:this.mangles,spatialReference:h,globalScope:b,progressTracker:void 0===d.progressTracker||null===d.progressTracker?q.createDeferred().promise:d.progressTracker,localScope:null,services:d.services,console:d.console?d.console:P,lrucache:d.lrucache,symbols:{symbolCounter:0},depthCounter:1,applicationCache:void 0===d.applicationCache?
null:d.applicationCache}}};return(new Function("context","spatialReference",a?"var runtimeCtx\x3dthis.prepare(context, spatialReference, true);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \nreturn lang.__awaiter(this, void 0, void 0, function* () {\n\n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n return lang.__awaiter(this, void 0, void 0, function* () {\n"+d+"\n return lastStatement; }); } \n return this.postProcess(yield mainBody()); }); ":
"var runtimeCtx\x3dthis.prepare(context, spatialReference, false);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+d+"\n return lastStatement; } \n return this.postProcess(mainBody()); ")).bind(h)};g.enableAsyncSupport=function(){return q.create(function(d,h){p(["./functions/geomasync"],function(h){y([h],"async");d(!0)},function(d){h(d)})})}})},"esri/arcade/Attachment":function(){var p=this&&
this.__extends||function(){var g=function(p,v){g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var n in m)m.hasOwnProperty(n)&&(g[n]=m[n])};return g(p,v)};return function(p,v){function n(){this.constructor=p}g(p,v);p.prototype=null===v?Object.create(v):(n.prototype=v.prototype,new n)}}();define(["require","exports","./Dictionary"],function(g,t,v){return function(g){function m(m,k,f,e,b){var a=g.call(this)||this;a.attachmentUrl=b;a.immutable=
!1;a.setField("id",m);a.setField("name",k);a.setField("contenttype",f);a.setField("size",e);a.immutable=!0;return a}p(m,g);return m}(v)})},"esri/arcade/Feature":function(){define("require exports ../core/tsSupport/assignHelper ./Dictionary ./ImmutableArray ./languageUtils ../geometry/Geometry ../geometry/Point ../geometry/jsonUtils".split(" "),function(p,g,t,v,n,m,u,k,f){return function(){function e(){this.declaredClass="esri.arcade.Feature";this._layer=this.attributes=this._geometry=null;this.immutable=
this.immutable=this._datesfixed=!0}e.createFromGraphic=function(b){var a=new e;a._geometry=b.geometry?b.geometry:null;a.attributes=void 0===b.attributes?{}:null===b.attributes?{}:b.attributes;b._sourceLayer?(a._layer=b._sourceLayer,a._datesfixed=!1):b._layer?(a._layer=b._layer,a._datesfixed=!1):b.layer&&(a._layer=b.layer,a._datesfixed=!1);return a};e.createFromArcadeFeature=function(b){var a=new e;a._datesfixed=b._datesfixed;a.attributes=b.attributes;a._geometry=b._geometry;b._layer&&(a._layer=b._layer);
return a};e.createFromArcadeDictionary=function(b){var a=new e;a.attributes=b.field("attributes");null!==a.attributes?a.attributes instanceof v?(a.attributes=a.attributes.attributes,null===a.attributes&&(a.attributes={})):a.attributes={}:a.attributes={};a._geometry=b.field("geometry");null!==a._geometry&&(a._geometry instanceof v?a._geometry=e.parseGeometryFromDictionary(a._geometry):a._geometry instanceof u||(a._geometry=null));return a};e.createFromGraphicLikeObject=function(b,a,c){void 0===c&&
(c=null);var f=new e;null===a&&(a={});f.attributes=a;f._geometry=b?b:null;f._layer=c;f._layer&&(f._datesfixed=!1);return f};e.prototype.repurposeFromGraphicLikeObject=function(b,a,c){void 0===c&&(c=null);null===a&&(a={});this.attributes=a;this._geometry=b?b:null;this._datesfixed=(this._layer=c)?!1:!0};e.prototype.castToText=function(){var b="",a;for(a in this.attributes){""!==b&&(b+=",");var c=this.attributes[a];null==c?b+=JSON.stringify(a)+":null":m.isBoolean(c)||m.isNumber(c)||m.isString(c)?b+=
JSON.stringify(a)+":"+JSON.stringify(c):c instanceof u?b+=JSON.stringify(a)+":"+m.toStringExplicit(c):c instanceof n?b+=JSON.stringify(a)+":"+m.toStringExplicit(c):c instanceof Array?b+=JSON.stringify(a)+":"+m.toStringExplicit(c):c instanceof Date?b+=JSON.stringify(a)+":"+JSON.stringify(c):null!==c&&"object"===typeof c&&void 0!==c.castToText&&(b+=JSON.stringify(a)+":"+c.castToText())}return'{"geometry":'+(null===this.geometry()?"null":m.toStringExplicit(this.geometry()))+',"attributes":{'+b+"}}"};
e.prototype._fixDates=function(){for(var b=[],a=0;a<this._layer.fields.length;a++){var c=this._layer.fields[a];"date"!==c.type&&"esriFieldTypeDate"!==c.type||b.push(c.name)}0<b.length&&this._fixDateFields(b);this._datesfixed=!0};e.prototype._fixDateFields=function(b){this.attributes=t({},this.attributes);for(var a=0;a<b.length;a++){var c=this.attributes[b[a]];if(null!==c)if(void 0===c)for(var e in this.attributes){if(e.toLowerCase()===b[a]){c=this.attributes[e];null===c||c instanceof Date||(this.attributes[e]=
new Date(c));break}}else c instanceof Date||(this.attributes[b[a]]=new Date(c))}};e.prototype.geometry=function(){if(null===this._geometry)return this._geometry;this._geometry instanceof u||(this._geometry=f.fromJson(this._geometry));return this._geometry};e.prototype.field=function(b){!1===this._datesfixed&&this._fixDates();var a=b.toLowerCase();b=this.attributes[b];if(void 0!==b)return b;for(var c in this.attributes)if(c.toLowerCase()===a)return this.attributes[c];if(this._hasFieldDefinition(a))return null;
throw Error("Field not Found");};e.prototype._hasFieldDefinition=function(b){if(null===this._layer)return!1;for(var a=0;a<this._layer.fields.length;a++)if(this._layer.fields[a].name.toLowerCase()===b)return!0;return!1};e.prototype._field=function(b){!1===this._datesfixed&&this._fixDates();var a=b.toLowerCase();b=this.attributes[b];if(void 0!==b)return b;for(var c in this.attributes)if(c.toLowerCase()===a)return this.attributes[c];return null};e.prototype.setField=function(b,a){if(this.immutable)throw Error("Feature is Immutable");
if(!1===m.isSimpleType(a))throw Error("Illegal Value Assignment to Feature");var c=b.toLowerCase();if(void 0===this.attributes[b])for(var e in this.attributes)if(e.toLowerCase()===c){this.attributes[e]=a;return}this.attributes[b]=a};e.prototype.hasField=function(b){var a=b.toLowerCase();if(void 0!==this.attributes[b])return!0;for(var c in this.attributes)if(c.toLowerCase()===a)return!0;return this._hasFieldDefinition(a)?!0:!1};e.prototype.keys=function(){var b=[],a={},c;for(c in this.attributes)b.push(c),
a[c.toLowerCase()]=1;if(null!==this._layer)for(c=0;c<this._layer.fields.length;c++){var e=this._layer.fields[c];1!==a[e.name.toLowerCase()]&&b.push(e.name)}return b=b.sort()};e.parseGeometryFromDictionary=function(b){b=e.convertDictionaryToJson(b,!0);void 0!==b.spatialreference&&(b.spatialReference=b.spatialreference,delete b.spatialreference);void 0!==b.rings&&(b.rings=this.fixPathArrays(b.rings,!0===b.hasZ,!0===b.hasM));void 0!==b.paths&&(b.paths=this.fixPathArrays(b.paths,!0===b.hasZ,!0===b.hasM));
void 0!==b.points&&(b.points=this.fixPointArrays(b.points,!0===b.hasZ,!0===b.hasM));return f.fromJson(b)};e.fixPathArrays=function(b,a,c){var e=[];if(b instanceof Array)for(var f=0;f<b.length;f++)e.push(this.fixPointArrays(b[f],a,c));else if(b instanceof n)for(f=0;f<b.length();f++)e.push(this.fixPointArrays(b.get(f),a,c));return e};e.fixPointArrays=function(b,a,c){var e=[];if(b instanceof Array)for(var f=0;f<b.length;f++){var q=b[f];q instanceof k?a&&c?e.push([q.x,q.y,q.z,q.m]):a?e.push([q.x,q.y,
q.z]):c?e.push([q.x,q.y,q.m]):e.push([q.x,q.y]):q instanceof n?e.push(q.toArray()):e.push(q)}else if(b instanceof n)for(f=0;f<b.length();f++)q=b.get(f),q instanceof k?a&&c?e.push([q.x,q.y,q.z,q.m]):a?e.push([q.x,q.y,q.z]):c?e.push([q.x,q.y,q.m]):e.push([q.x,q.y]):q instanceof n?e.push(q.toArray()):e.push(q);return e};e.convertDictionaryToJson=function(b,a){void 0===a&&(a=!1);var c={},f;for(f in b.attributes){var k=b.attributes[f];k instanceof v&&(k=e.convertDictionaryToJson(k));a?c[f.toLowerCase()]=
k:c[f]=k}return c};e.parseAttributesFromDictionary=function(b){var a={},c;for(c in b.attributes){var e=b.attributes[c];if(m.isSimpleType(e))a[c]=e;else throw Error("Illegal Argument");}return a};e.fromJson=function(b){var a=null;null!==b.geometry&&void 0!==b.geometry&&(a=f.fromJson(b.geometry));var c={};if(null!==b.attributes&&void 0!==b.attributes)for(var k in b.attributes){var g=b.attributes[k];if(null===g)c[k]=g;else if(m.isString(g)||m.isNumber(g)||m.isBoolean(g)||m.isDate(g))c[k]=g;else throw Error("Illegal Argument");
}return e.createFromGraphicLikeObject(a,c,null)};e.prototype.domainValueLookup=function(b,a,c){if(null===this._layer||!this._layer.fields)return null;c=m.getDomain(b,this._layer,this,c);if(void 0===a)try{a=this.field(b)}catch(x){return null}return m.getDomainValue(c,a)};e.prototype.domainCodeLookup=function(b,a,c){if(null===this._layer||!this._layer.fields)return null;if(void 0===a){try{a=this.field(b)}catch(x){return null}return a}b=m.getDomain(b,this._layer,this,c);return m.getDomainCode(b,a)};
return e}()})},"esri/core/tsSupport/assignHelper":function(){define([],function(){return Object.assign||function(p){for(var g,t=1,v=arguments.length;t<v;t++){g=arguments[t];for(var n in g)Object.prototype.hasOwnProperty.call(g,n)&&(p[n]=g[n])}return p}})},"esri/arcade/treeAnalysis":function(){define(["require","exports"],function(p,g){function t(a,b,c,e){return"0"!==a.min&&c.length<Number(a.min)||"*"!==a.max&&c.length>Number(a.max)?-2:1}function v(a,b,c){if(null!==c.localScope&&void 0!==c.localScope[a.toLowerCase()]){var e=
c.localScope[a.toLowerCase()];if("FormulaFunction"===e.type||"any"===e.type)return void 0===e.signature&&(e.signature={min:"0",max:"*"}),t(e.signature,a,b,c)}return void 0!==c.globalScope[a.toLowerCase()]&&(e=c.globalScope[a.toLowerCase()],"FormulaFunction"===e.type||"any"===e.type)?(void 0===e.signature&&(e.signature={min:"0",max:"*"}),t(e.signature,a,b,c)):-1}function n(a,b){if(a)for(var c=0;c<a.length;c++)m(a[c],b)}function m(a,b){if(a&&!1!==b(a))switch(a.type){case "ArrayExpression":n(a.elements,
b);break;case "AssignmentExpression":case "BinaryExpression":m(a.left,b);m(a.right,b);break;case "BlockStatement":n(a.body,b);break;case "CallExpression":m(a.callee,b);n(a.arguments,b);break;case "ConditionalExpression":m(a.test,b);m(a.alternate,b);m(a.consequent,b);break;case "DoWhileStatement":m(a.test,b);m(a.body,b);break;case "ExpressionStatement":m(a.expression,b);break;case "ForInStatement":m(a.left,b);m(a.right,b);m(a.body,b);break;case "ForStatement":m(a.init,b);m(a.test,b);m(a.update,b);
m(a.body,b);break;case "FunctionDeclaration":case "FunctionDeclaration":case "FunctionExpression":m(a.id,b);n(a.params,b);m(a.body,b);break;case "IfStatement":m(a.test,b);m(a.consequent,b);m(a.alternate,b);break;case "LogicalExpression":m(a.left,b);m(a.right,b);break;case "MemberExpression":m(a.object,b);m(a.property,b);break;case "NewExpression":m(a.callee,b);n(a.arguments,b);break;case "ObjectExpression":n(a.properties,b);break;case "Program":n(a.body,b);break;case "Property":m(a.key,b);m(a.value,
b);break;case "ReturnStatement":m(a.argument,b);break;case "UnaryExpression":m(a.argument,b);break;case "UpdateExpression":m(a.argument,b);break;case "VariableDeclaration":n(a.declarations,b);break;case "VariableDeclarator":m(a.id,b),m(a.init,b)}}function u(a,b){void 0===b&&(b=!0);var e=c(a,"SYNTAX","UNREOGNISED");try{switch(a.type){case "VariableDeclarator":return null!==a.init&&"FunctionExpression"===a.init.type?c(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR"):"Identifier"!==a.id.type?c(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER"):
null!==a.init?u(a.init,!1):"";case "VariableDeclaration":for(var f=0;f<a.declarations.length;f++)if(e=u(a.declarations[f],b),""!==e)return e;return"";case "ForInStatement":e=u(a.left,b);if(""!==e)break;if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return c(a,"SYNTAX","ONLY1VAR");if(null!==a.left.declarations[0].init)return c(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return c(a,"SYNTAX","LEFTNOTVAR");e=u(a.right,b);if(""!==e)break;e=u(a.body,b);if(""!==
e)break;return"";case "ForStatement":if(null!==a.test&&(e=u(a.test,b),""!==e))break;if(null!==a.init&&(e=u(a.init,b),""!==e))break;if(null!==a.update&&(e=u(a.update,b),""!==e))break;if(null!==a.body&&(e=u(a.body,b),""!==e))break;return"";case "ContinueStatement":return"";case "EmptyStatement":return"";case "BreakStatement":return"";case "IfStatement":e=u(a.test,b);if(""!==e)break;if(null!==a.consequent&&(e=u(a.consequent,!1),""!==e))break;if(null!==a.alternate&&(e=u(a.alternate,!1),""!==e))break;
return"";case "BlockStatement":for(var k=[],f=0;f<a.body.length;f++)"EmptyStatement"!==a.body[f].type&&k.push(a.body[f]);a.body=k;for(f=0;f<a.body.length;f++)if(e=u(a.body[f],b),""!==e)return e;return"";case "FunctionDeclaration":return!1===b?c(a,"SYNTAX","GLOBALFUNCTIONSONLY"):"Identifier"!==a.id.type?c(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"):u(a.body,!1);case "ReturnStatement":return null!==a.argument?u(a.argument,b):"";case "UpdateExpression":return"Identifier"!==a.argument.type&&"MemberExpression"!==
a.argument.type?c(a,"SYNTAX","ASSIGNMENTTOVARSONLY"):u(a.argument,b);case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==a.left.type)return c(a,"SYNTAX","ASSIGNMENTTOVARSONLY");e=u(a.left,b);if(""!==e)break;switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;default:return c(a,"SYNTAX","OPERATORNOTRECOGNISED")}return u(a.right,!1);case "ExpressionStatement":return u(a.expression,!1);case "Identifier":e="";break;case "MemberExpression":e=
u(a.object,b);if(""!==e)break;return!0===a.computed?u(a.property,b):"";case "Literal":return"";case "CallExpression":if("Identifier"!==a.callee.type)return c(a,"SYNTAX","ONLYNODESSUPPORTED");e="";for(f=0;f<a.arguments.length;f++)if(e=u(a.arguments[f],b),""!==e)return e;return"";case "UnaryExpression":e=u(a.argument,b);break;case "BinaryExpression":e=u(a.left,b);if(""!==e)break;e=u(a.right,b);if(""!==e)break;switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;
default:return c(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "LogicalExpression":e=u(a.left,b);if(""!==e)break;e=u(a.right);if(""!==e)break;switch(a.operator){case "\x26\x26":case "||":break;default:return c(a,"SYNTAX","OPERATORNOTRECOGNISED")}return"";case "ConditionalExpression":return c(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":e="";for(f=0;f<a.elements.length&&(e=u(a.elements[f],b),""===e);f++);break;case "ObjectExpression":e="";for(f=0;f<a.properties.length;f++){e="";if(null!==
a.properties[f].key&&("Literal"!==a.properties[f].key.type&&"Identifier"!==a.properties[f].key.type&&(e=c(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[f].key.type)){var k=a.properties[f].key,q="value"in k?k.value:null;"string"===typeof q||q instanceof String||(e=c(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===e&&(e=u(a.properties[f],b));if(""!==e)break}break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return c(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==
a.key.type&&(e=u(a.key,b),""!==e))break;e=u(a.value,b)}return e}catch(L){throw L;}}function k(a,f){var q=c(a,"SYNTAX","UNREOGNISED"),g=null,m="";try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type)return c(a,"SYNTAX","FUNCTIONVARIABLEDECLARATOR");var w=null===a.init?"":k(a.init,f);if(""!==w)return w;"Identifier"===a.id.type&&(null===f.localScope?f.globalScope[a.id.name.toLowerCase()]={type:"any"}:f.localScope[a.id.name.toLowerCase()]={type:"any"});return"";
case "FunctionDeclaration":g=e(a.id.name.toLowerCase(),a,f);m=b(a,f);if(""!==m)return m;if(null!==f.localScope)return c(a,"SYNTAX","GLOBALFUNCTIONSONLY");g.isnative=!1;f.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[g]};return"";case "VariableDeclaration":for(var q="",x=0;x<a.declarations.length&&(q=k(a.declarations[x],f),""===q);x++);break;case "IfStatement":q=k(a.test,f);if(""!==q)break;if("AssignmentExpression"===a.test.type||"UpdateExpression"===a.test.type)return c(a.test,
"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");if(null!==a.consequent&&(q=k(a.consequent,f),""!==q))break;if(null!==a.alternate&&(q=k(a.alternate,f),""!==q))break;return"";case "EmptyStatement":return"";case "BlockStatement":for(x=0;x<a.body.length;x++)if(q=k(a.body[x],f),""!==q)return q;return"";case "ReturnStatement":return null!==a.argument?k(a.argument,f):"";case "ForInStatement":if("VariableDeclaration"===a.left.type){if(1<a.left.declarations.length)return c(a,"SYNTAX","ONLY1VAR");if(null!==
a.left.declarations[0].init)return c(a,"SYNTAX","CANNOTDECLAREVAL")}else if("Identifier"!==a.left.type)return c(a,"SYNTAX","LEFTNOTVAR");q=k(a.left,f);if(""!==q)break;q=k(a.right,f);if(""!==q)break;q=k(a.body,f);if(""!==q)break;return"";case "ForStatement":if(null!==a.init&&(q=k(a.init,f),""!==q))break;if(null!==a.test&&(q=k(a.test,f),""!==q))break;if(null!==a.body&&(q=k(a.body,f),""!==q))break;if(null!==a.update&&(q=k(a.update,f),""!==q))break;return"";case "BreakStatement":return"";case "ContinueStatement":return"";
case "UpdateExpression":if("Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type)return c(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var n=!1;if("MemberExpression"===a.argument.type)return k(a.argument,f);null!==f.localScope&&void 0!==f.localScope[a.argument.name.toLowerCase()]&&(n=!0);void 0!==f.globalScope[a.argument.name.toLowerCase()]&&(n=!0);return!1===n?"Identifier "+a.argument.name+" has not been declared.":"";case "AssignmentExpression":if("Identifier"!==a.left.type&&"MemberExpression"!==
a.left.type)return c(a,"SYNTAX","ASSIGNMENTTOVARSONLY");var u=k(a.right,f);if(""!==u)return u;n=!1;if("MemberExpression"===a.left.type)return u=k(a.left,f),""!==u?u:"";null!==f.localScope&&void 0!==f.localScope[a.left.name.toLowerCase()]&&(n=!0);void 0!==f.globalScope[a.left.name.toLowerCase()]&&(n=!0);return!1===n?"Identifier "+a.left.name+" has not been declared.":"";case "ExpressionStatement":return k(a.expression,f);case "Identifier":var B=a.name.toLowerCase();if(null!==f.localScope&&void 0!==
f.localScope[B])return"";q=void 0!==f.globalScope[B]?"":c(a,"SYNTAX","VARIABLENOTFOUND");break;case "MemberExpression":q=k(a.object,f);if(""!==q)break;return!0===a.computed?k(a.property,f):"";case "Literal":return"";case "CallExpression":if("Identifier"!==a.callee.type)return c(a,"SYNTAX","ONLYNODESSUPPORTED");q="";for(x=0;x<a.arguments.length;x++)if(q=k(a.arguments[x],f),""!==q)return q;var z=v(a.callee.name,a.arguments,f);-1===z&&(q=c(a,"SYNTAX","NOTFOUND"));-2===z&&(q=c(a,"SYNTAX","WRONGSIGNATURE"));
break;case "UnaryExpression":q=k(a.argument,f);break;case "BinaryExpression":q=k(a.left,f);if(""!==q)break;q=k(a.right,f);if(""!==q)break;return"";case "LogicalExpression":q=k(a.left,f);if(""!==q)break;if("AssignmentExpression"===a.left.type||"UpdateExpression"===a.left.type)return c(a.left,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION");q=k(a.right,f);if(""!==q)break;return"AssignmentExpression"===a.right.type||"UpdateExpression"===a.right.type?c(a.right,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"):
"";case "ConditionalExpression":return c(a,"SYNTAX","NOTSUPPORTED");case "ArrayExpression":q="";for(x=0;x<a.elements.length&&(q=k(a.elements[x],f),""===q);x++);break;case "ObjectExpression":q="";for(x=0;x<a.properties.length;x++){q="";if(null!==a.properties[x].key&&("Literal"!==a.properties[x].key.type&&"Identifier"!==a.properties[x].key.type&&(q=c(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING")),"Literal"===a.properties[x].key.type)){var p=a.properties[x].key,C="value"in p?p.value:null;"string"===typeof C||
C instanceof String||(q=c(a,"SYNTAX","OBJECTPROPERTYMUSTBESTRING"))}""===q&&(q=k(a.properties[x],f));if(""!==q)break}break;case "Property":if("Literal"!==a.key.type&&"Identifier"!==a.key.type)return c(a,"SYNTAX","ONLYLITERAL");if("Identifier"!==a.key.type&&(q=k(a.key,f),""!==q))break;q=k(a.value,f)}return q}catch(U){throw U;}}function f(a,b){var c=!1,e=b.toLowerCase();m(a,function(a){if(c)return!1;"Identifier"===a.type&&a.name&&a.name.toLowerCase()===e&&(c=!0);return!0});return c}function e(a,b,c){c=
[];if(void 0!==b.params&&null!==b.params)for(var e=0;e<b.params.length;e++)c.push("any");return{name:a,return:"any",params:c}}function b(a,b){b={globalScope:b.globalScope,localScope:{}};for(var c=0;c<a.params.length;c++)b.localScope[a.params[c].name.toLowerCase()]={type:"any"};return k(a.body,b)}function a(a,b,c,e){var f={};if(void 0===a||null===a)a={};if(void 0===c||null===c)c={};f.infinity={type:"any"};f.textformatting={type:"any"};f.pi={type:"any"};for(var k in b)"sync"===e&&void 0!==b[k].min?
f[k]={type:"FormulaFunction",signature:{min:b[k].min,max:b[k].max}}:"sync"!==e&&void 0!==b[k].fmin&&(f[k]={type:"FormulaFunction",signature:{min:b[k].fmin,max:b[k].fmax}});for(b=0;b<c.length;b++)k=c[b],f[k.name]={type:"FormulaFunction",signature:k};for(k in a)f[k]=a[k],f[k].type="any";return f}function c(a,b,c){var e="";switch(b){case "SYNTAX":e="Syntax Error: ";break;case "RUNTIME":e="Runtime Error: ";break;default:e="Syntax Error: "}try{switch(a.type){case "IfStatement":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=
" Assignments not be made in logical tests";break;case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "UpdateExpression":case "AssignmentExpression":switch(c){case "CANNOT_USE_ASSIGNMENT_IN_CONDITION":e+=" Assignments not be made in logical tests";break;case "ASSIGNMENTTOVARSONLY":e+=" Assignments can only be made to identifiers"}break;case "ExpressionStatement":e+=" Assignments can only be made to identifiers";break;case "FunctionDeclaration":switch(c){case "GLOBALFUNCTIONSONLY":e+=
" Functions cannot be declared as variables";break;case "FUNCTIONMUSTHAVEIDENTIFIER":e+=" Function Definition must have an identifier"}break;case "VariableDeclaration":e+=" Only 1 variable can be declared at a time";break;case "VariableDeclarator":switch(c){case "FUNCTIONVARIABLEDECLARATOR":e+=" Functions cannot be declared as variables";break;case "VARIABLEMUSTHAVEIDENTIFIER":e+=" Variable Definition must have an identifier"}break;case "Identifier":e+=" Identifier Not Found. ";e+=a.name;break;case "ObjectExpression":switch(c){case "OBJECTPROPERTYMUSTBESTRING":e+=
" Property name must be a string"}break;case "ForStatement":switch(c){case "CANNOT_USE_NONBOOLEAN_IN_CONDITION":e+=" Non Boolean used as Condition"}break;case "ForInStatement":switch(c){case "ONLY1VAR":e+=" Can only declare 1 var for use with IN";break;case "CANNOTDECLAREVAL":e+=" Can only declare value for use with IN";break;case "LEFTNOVAR":e+="Must provide a variable to iterate with.";break;case "VARIABLENOTDECLARED":e+="Variable must be declared before it is used..";break;case "CANNOTITERATETHISTYPE":e+=
"This type cannot be used in an IN loop"}break;case "MemberExpression":switch(c){case "PROPERTYNOTFOUND":e+="Cannot find member property. ";e+=!1===a.computed?"Identifier"===a.property.type?a.property.name:"":"";break;case "OUTOFBOUNDS":e+="Out of Bounds. ";e+=!1===a.computed?"Identifier"===a.property.type?a.property.name:"":"";break;case "NOTFOUND":e+="Cannot call member method on null. ";e+=!1===a.computed?"Identifier"===a.property.type?a.property.name:"":"";break;case "INVALIDTYPE":e+="Cannot call member property on object of this type. ",
e+=!1===a.computed?"Identifier"===a.property.type?a.property.name:"":""}break;case "Property":switch(c){case "ONLYLITERAL":e+="Property names must be literals or identifiers"}break;case "Literal":break;case "CallExpression":switch(c){case "WRONGSIGNATURE":e+="Function signature does not match: ";e+="Identifier"===a.callee.type?a.callee.name:"";break;case "ONLYNODESUPPORTED":e+="Functions must be declared.";e+="Identifier"===a.callee.type?a.callee.name:"";break;case "NOTAFUNCTION":e+="Not a Function: ";
e+="Identifier"===a.callee.type?a.callee.name:"";break;case "NOTFOUND":e+="Function Not Found: "+("Identifier"===a.callee.type?a.callee.name:"")}break;case "UnaryExpression":switch(c){case "NOTSUPPORTEDUNARYOPERATOR":e+="Operator "+a.operator+" not allowed in this context. Only ! can be used with boolean, and - with a number";break;case "NOTSUPPORTEDTYPE":e+="Unary operator "+a.operator+" cannot be used with this argument."}case "BinaryExpression":switch(c){case "OPERATORNOTRECOGNISED":e+="Binary Operator not recognised "+
a.operator}break;case "LogicalExpression":switch(c){case "ONLYBOOLEAN":e+="Operator "+a.operator+" cannot be used. Only || or \x26\x26 are allowed values";break;case "ONLYORORAND":e+="Logical Expression "+a.operator+" being applied to parameters that are not boolean."}break;case "ConditionalExpression":e+="Conditional statements not supported.";break;case "ArrayExpression":switch(c){case "FUNCTIONCONTEXTILLEGAL":e+=" Cannot Put Function inside Array."}break;default:e+="Expression contains unrecognised code structures."}}catch(K){throw K;
}return e}function x(a,b,e){return{line:a.loc.start.line,character:a.loc.start.column,reason:c(a,b,e)}}function w(a,b,c,e,f){void 0===f&&(f=!0);b={globalScope:b.globalScope,localScope:{}};for(f=0;f<a.params.length;f++)b.localScope[a.params[f].name.toLowerCase()]={type:"any"};q(a.body,b,c,e,!1)}function q(a,b,c,f,k){void 0===k&&(k=!0);if(null===a)throw Error("Unnexpexted Expression Syntax");var g=null;try{switch(a.type){case "VariableDeclarator":if(null!==a.init&&"FunctionExpression"===a.init.type){f.push(x(a,
"SYNTAX","FUNCTIONVARIABLEDECLARATOR"));break}"Identifier"!==a.id.type?f.push(x(a,"SYNTAX","VARIABLEMUSTHAVEIDENTIFIER")):(a.id.name.toLowerCase(),null===b.localScope?b.globalScope[a.id.name.toLowerCase()]={type:"any"}:b.localScope[a.id.name.toLowerCase()]={type:"any"});null!==a.init&&q(a.init,b,c,f,k);break;case "FunctionDeclaration":!1===k&&f.push(x(a,"SYNTAX","GLOBALFUNCTIONSONLY"));"Identifier"!==a.id.type&&f.push(x(a,"SYNTAX","FUNCTIONMUSTHAVEIDENTIFIER"));g=e("",a,b);w(a,b,c,f,k);null!==b.localScope&&
f.push(x(a,"SYNTAX","GLOBALFUNCTIONSONLY"));g.isnative=!1;"Identifier"===a.id.type&&(b.globalScope[a.id.name.toLowerCase()]={type:"FormulaFunction",signature:[g]});break;case "VariableDeclaration":for(var m=0;m<a.declarations.length;m++)q(a.declarations[m],b,c,f,k);break;case "IfStatement":null!==a.test&&(q(a.test,b,c,f,k),"AssignmentExpression"!==a.test.type&&"UpdateExpression"!==a.test.type||f.push(x(a.test,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION")));null!==a.consequent&&q(a.consequent,b,c,
f,k);null!==a.alternate&&q(a.alternate,b,c,f,k);break;case "EmptyStatement":break;case "BlockStatement":if(null!==a.body)for(m=0;m<a.body.length;m++)q(a.body[m],b,c,f,k);break;case "ReturnStatement":null!==a.argument&&q(a.argument,b,c,f,k);break;case "ForInStatement":"VariableDeclaration"===a.left.type?(1<a.left.declarations.length&&f.push(x(a,"SYNTAX","ONLY1VAR")),null!==a.left.declarations[0].init&&f.push(x(a,"SYNTAX","CANNOTDECLAREVAL"))):"Identifier"!==a.left.type&&f.push(x(a,"SYNTAX","LEFTNOTVAR"));
q(a.left,b,c,f,k);q(a.right,b,c,f,k);q(a.body,b,c,f,k);break;case "ForStatement":null!==a.init&&q(a.init,b,c,f,k);null!==a.test&&q(a.test,b,c,f,k);null!==a.body&&q(a.body,b,c,f,k);null!==a.update&&q(a.update,b,c,f,k);break;case "BreakStatement":break;case "ContinueStatement":break;case "UpdateExpression":"Identifier"!==a.argument.type&&"MemberExpression"!==a.argument.type?f.push(x(a,"SYNTAX","ASSIGNMENTTOVARSONLY")):("Identifier"===a.argument.type&&(g=!1,!1===c&&(null!==b.localScope&&void 0!==b.localScope[a.argument.name.toLowerCase()]&&
(g=!0),void 0!==b.globalScope[a.argument.name.toLowerCase()]&&(g=!0),!1===g&&f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.argument.name+" has not been declared."}))),"MemberExpression"===a.argument.type&&q(a.argument,b,c,f,k));break;case "AssignmentExpression":"Identifier"!==a.left.type&&"MemberExpression"!==a.left.type&&f.push(x(a,"SYNTAX","ASSIGNMENTTOVARSONLY"));switch(a.operator){case "\x3d":case "/\x3d":case "*\x3d":case "%\x3d":case "+\x3d":case "-\x3d":break;
default:f.push(x(a,"SYNTAX","OPERATORNOTRECOGNISED"))}q(a.right,b,c,f,k);g=!1;"Identifier"===a.left.type&&(null!==b.localScope&&void 0!==b.localScope[a.left.name.toLowerCase()]&&(g=!0),void 0!==b.globalScope[a.left.name.toLowerCase()]&&(g=!0),!1===c&&!1===g&&f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Identifier "+a.left.name+" has not been declared."}));"MemberExpression"===a.left.type&&q(a.left,b,c,f,k);break;case "ExpressionStatement":q(a.expression,
b,c,f,k);break;case "Identifier":var n=a.name.toLowerCase();if(null!==b.localScope&&void 0!==b.localScope[n])break;if(void 0!==b.globalScope[n])break;!1===c&&f.push(x(a,"SYNTAX","VARIABLENOTFOUND"));break;case "MemberExpression":q(a.object,b,c,f,k);!0===a.computed&&q(a.property,b,c,f,k);break;case "Literal":return"";case "CallExpression":"Identifier"!==a.callee.type&&f.push(x(a,"SYNTAX","ONLYNODESSUPPORTED"));for(m=0;m<a.arguments.length;m++)q(a.arguments[m],b,c,f,k);if("Identifier"===a.callee.type){var u=
v(a.callee.name,a.arguments,b);!1===c&&-1===u&&f.push(x(a,"SYNTAX","NOTFOUND"));-2===u&&f.push(x(a,"SYNTAX","WRONGSIGNATURE"))}break;case "UnaryExpression":q(a.argument,b,c,f,k);break;case "BinaryExpression":q(a.left,b,c,f,k);q(a.right,b,c,f,k);switch(a.operator){case "\x3d\x3d":case "!\x3d":case "\x3c":case "\x3c\x3d":case "\x3e":case "\x3e\x3d":case "+":case "-":case "*":case "/":case "%":break;default:f.push(x(a,"SYNTAX","OPERATORNOTRECOGNISED"))}break;case "LogicalExpression":switch(a.operator){case "\x26\x26":case "||":break;
default:f.push(x(a,"SYNTAX","OPERATORNOTRECOGNISED"))}q(a.left,b,c,f,k);"AssignmentExpression"!==a.left.type&&"UpdateExpression"!==a.left.type||f.push(x(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));q(a.right,b,c,f,k);"AssignmentExpression"!==a.right.type&&"UpdateExpression"!==a.right.type||f.push(x(a,"SYNTAX","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));break;case "ConditionalExpression":f.push(x(a,"SYNTAX","NOTSUPPORTED"));break;case "ArrayExpression":for(m=0;m<a.elements.length;m++)q(a.elements[m],
b,c,f,k);break;case "ObjectExpression":for(m=0;m<a.properties.length;m++)q(a.properties[m],b,c,f,k);break;case "Property":"Literal"!==a.key.type&&"Identifier"!==a.key.type&&f.push(x(a,"SYNTAX","ONLYLITERAL"));"Literal"===a.key.type&&q(a.key,b,c,f,k);q(a.value,b,c,f,k);break;default:f.push(x(a,"SYNTAX","UNRECOGNISED"))}}catch(S){f.push({line:null===a?0:a.loc.start.line,character:null===a?0:a.loc.start.column,reason:"Unnexpected Syntax"})}}function C(a,b){var c=[];m(a,function(a){"CallExpression"===
a.type&&"Identifier"===a.callee.type&&c.push(a.callee.name.toLowerCase());return!0});return c}Object.defineProperty(g,"__esModule",{value:!0});g.functionDecls={concatenate:{min:"0",max:"*"},split:{min:"2",max:"4"},guid:{min:"0",max:"1"},today:{min:"0",max:"0"},urlencode:{min:"1",max:"1"},now:{min:"0",max:"0"},timestamp:{min:"0",max:"0"},day:{min:"1",max:"1"},month:{min:"1",max:"1"},year:{min:"1",max:"1"},hour:{min:"1",max:"1"},second:{min:"1",max:"1"},millisecond:{min:"1",max:"1"},minute:{min:"1",
max:"1"},weekday:{min:"1",max:"1"},toutc:{min:"1",max:"1"},tolocal:{min:"1",max:"1"},date:{min:"0",max:"7"},datediff:{min:"2",max:"3"},dateadd:{min:"2",max:"3"},trim:{min:"1",max:"1"},text:{min:"1",max:"2"},left:{min:"2",max:"2"},right:{min:"2",max:"2"},mid:{min:"2",max:"3"},upper:{min:"1",max:"1"},proper:{min:"1",max:"2"},lower:{min:"1",max:"1"},find:{min:"2",max:"3"},iif:{min:"3",max:"3"},decode:{min:"2",max:"*"},when:{min:"2",max:"*"},defaultvalue:{min:"2",max:"2"},isempty:{min:"1",max:"1"},domaincode:{min:"2",
max:"4"},domainname:{min:"2",max:"4"},polygon:{min:"1",max:"1"},point:{min:"1",max:"1"},polyline:{min:"1",max:"1"},extent:{min:"1",max:"1"},multipoint:{min:"1",max:"1"},ringisclockwise:{min:"1",max:"1"},geometry:{min:"1",max:"1"},count:{min:"0",max:"*"},number:{min:"1",max:"2"},acos:{min:"1",max:"1"},asin:{min:"1",max:"1"},atan:{min:"1",max:"1"},atan2:{min:"2",max:"2"},ceil:{min:"1",max:"2"},floor:{min:"1",max:"2"},round:{min:"1",max:"2"},cos:{min:"1",max:"1"},exp:{min:"1",max:"1"},log:{min:"1",max:"1"},
min:{min:"0",max:"*"},constrain:{min:"3",max:"3"},console:{min:"0",max:"*"},max:{min:"0",max:"*"},pow:{min:"2",max:"2"},random:{min:"0",max:"0"},sqrt:{min:"1",max:"1"},sin:{min:"1",max:"1"},tan:{min:"1",max:"1"},abs:{min:"1",max:"1"},isnan:{min:"1",max:"1"},stdev:{min:"0",max:"*"},average:{min:"0",max:"*"},mean:{min:"0",max:"*"},sum:{min:"0",max:"*"},variance:{min:"0",max:"*"},distinct:{min:"0",max:"*"},first:{min:"1",max:"1"},top:{min:"2",max:"2"},boolean:{min:"1",max:"1"},dictionary:{min:"0",max:"*"},
typeof:{min:"1",max:"1"},reverse:{min:"1",max:"1"},replace:{min:"3",max:"4"},sort:{min:"1",max:"2"},feature:{min:"1",max:"*"},haskey:{min:"2",max:"2"},indexof:{min:"2",max:"2"},disjoint:{min:"2",max:"2"},intersects:{min:"2",max:"2"},touches:{min:"2",max:"2"},crosses:{min:"2",max:"2"},within:{min:"2",max:"2"},contains:{min:"2",max:"2"},overlaps:{min:"2",max:"2"},equals:{min:"2",max:"2"},relate:{min:"3",max:"3"},intersection:{min:"2",max:"2"},union:{min:"1",max:"2"},difference:{min:"2",max:"2"},symmetricdifference:{min:"2",
max:"2"},clip:{min:"2",max:"2"},cut:{min:"2",max:"2"},area:{min:"1",max:"2"},areageodetic:{min:"1",max:"2"},length:{min:"1",max:"2"},lengthgeodetic:{min:"1",max:"2"},distance:{min:"2",max:"3"},densify:{min:"2",max:"3"},densifygeodetic:{min:"2",max:"3"},generalize:{min:"2",max:"4"},buffer:{min:"2",max:"3"},buffergeodetic:{min:"2",max:"3"},offset:{min:"2",max:"6"},rotate:{min:"2",max:"3"},issimple:{min:"1",max:"1"},simplify:{min:"1",max:"1"},centroid:{min:"1",max:"1"},multiparttosinglepart:{min:"1",
max:"1"},setgeometry:{min:"2",max:"2"}};for(var z in g.functionDecls)g.functionDecls[z].fmin=g.functionDecls[z].min,g.functionDecls[z].fmax=g.functionDecls[z].max;var E="featureset featuresetbyid featuresetbyname featuresetbyurl attachments featuresetbyportalitem".split(" "),B="disjoint intersects touches crosses within contains overlaps equals relate intersection union difference symmetricdifference clip cut area areageodetic length lengthgeodetic distance densify densifygeodetic generalize buffer buffergeodetic offset rotate issimple simplify multiparttosinglepart".split(" ");
g.addFunctionDeclaration=function(a,b){var c=g.functionDecls[a.name.toLowerCase()];void 0===c?"sync"===b?g.functionDecls[a.name.toLowerCase()]={min:a.min,max:a.max}:g.functionDecls[a.name.toLowerCase()]={fmin:a.min,fmax:a.max}:"sync"===b?(c.min=a.min,c.max=a.max):(c.fmin=a.min,c.fmax=a.max)};g.checkFunctionSignature=t;g.findFunction=v;g.walk=m;g.validateLanguageNode=u;g.testValidityOfExpression=k;g.referencesMember=f;g.referencesFunction=function(a,b){var c=!1,e=b.toLowerCase();m(a,function(a){return c?
!1:"CallExpression"===a.type&&"Identifier"===a.callee.type&&a.callee.name&&a.callee.name.toLowerCase()===e?(c=!0,!1):!0});return c};g.findFieldLiterals=function(a,b){var c=[];m(a,function(a){if("MemberExpression"!==a.type||"Identifier"!==a.object.type)return!0;!1===a.computed&&a.object&&a.object.name&&a.property&&"Identifier"===a.property.type&&a.property.name?c.push(a.object.name.toLowerCase()+"."+a.property.name.toLowerCase()):a.object&&a.object.name&&a.property&&"Literal"===a.property.type&&"string"===
typeof a.property.value&&c.push(a.object.name.toLowerCase()+"."+a.property.value.toString().toLowerCase());return!1});return c};g.extractFunctionDeclaration=e;g.validateFunction=b;g.constructGlobalScope=a;g.validateScript=function(b,c,e,f){void 0===e&&(e="async");void 0===f&&(f=g.functionDecls);c={globalScope:a(c.vars,f,c.customFunctions,e),localScope:null};return k(b.body[0].body,c)};g.validateLanguage=function(a){return"BlockStatement"!==a.body[0].body.type?"Invalid formula content.":u(a.body[0].body)};
g.nodeErrorMessage=c;g.makeError=x;g.extractAllIssuesInFunction=w;g.extractAllIssues=q;g.checkScript=function(b,c,e,f,k){void 0===f&&(f="async");void 0===k&&(k=g.functionDecls);var m=[];if("BlockStatement"!==b.body[0].body.type)return[{line:0,character:0,reason:"Invalid Body"}];if(null===c||void 0===c)c={vars:{},customFunctions:[]};c={globalScope:a(c.vars,k,c.customFunctions,f),localScope:null};try{q(b.body[0].body,c,e,m)}catch(L){}return m};g.findFunctionCalls=C;g.findScriptDependencies=function(a,
b){void 0===b&&(b=[]);var c=null;if(void 0===a.usesFeatureSet){null===c&&(c=C(a,!1));a.usesFeatureSet=!1;for(var e=0;e<c.length;e++)-1<E.indexOf(c[e])&&(a.usesFeatureSet=!0,a.isAsync=!0);if(!1===a.usesFeatureSet&&b&&0<b.length)for(e=0;e<b.length;e++)if(f(a,b[e])){a.usesFeatureSet=!0;a.isAsync=!0;break}}void 0===a.isAsync&&(a.isAsync=!1);if(void 0===a.usesGeometry)for(a.usesGeometry=!1,null===c&&(c=C(a,!1)),e=0;e<c.length;e++)-1<B.indexOf(c[e])&&(a.usesGeometry=!0)};g.scriptUsesFeatureSet=function(a){a=
C(a,!1);for(var b=0;b<a.length;b++)if(-1<E.indexOf(a[b]))return!0;return!1}})},"esri/arcade/functions/date":function(){define(["require","exports","../../moment","../languageUtils"],function(p,g,t,v){function n(g){return null===g?g:isNaN(g.getTime())?null:g}Object.defineProperty(g,"__esModule",{value:!0});g.registerFunctions=function(g,u){g.today=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,0,0);e=new Date;e.setHours(0,0,0,0);return e})};g.now=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,
0,0);return new Date})};g.timestamp=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,0,0);e=new Date;return e=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())})};g.toutc=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?null:new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())})};g.tolocal=
function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?null:t.utc([e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]).toDate()})};g.day=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getDate()})};g.month=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getMonth()})};g.year=function(k,f){return u(k,f,function(e,
b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getFullYear()})};g.hour=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getHours()})};g.second=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getSeconds()})};g.millisecond=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getMilliseconds()})};g.minute=function(k,f){return u(k,f,function(e,
b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getMinutes()})};g.weekday=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,1,1);e=v.toDate(a[0]);return null===e?NaN:e.getDay()})};g.date=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,0,7);if(3===a.length)return n(new Date(v.toNumber(a[0]),v.toNumber(a[1]),v.toNumber(a[2]),0,0,0,0));if(4===a.length)return n(new Date(v.toNumber(a[0]),v.toNumber(a[1]),v.toNumber(a[2]),v.toNumber(a[3]),0,0,0));if(5===a.length)return n(new Date(v.toNumber(a[0]),
v.toNumber(a[1]),v.toNumber(a[2]),v.toNumber(a[3]),v.toNumber(a[4]),0,0));if(6===a.length)return n(new Date(v.toNumber(a[0]),v.toNumber(a[1]),v.toNumber(a[2]),v.toNumber(a[3]),v.toNumber(a[4]),v.toNumber(a[5]),0));if(7===a.length)return n(new Date(v.toNumber(a[0]),v.toNumber(a[1]),v.toNumber(a[2]),v.toNumber(a[3]),v.toNumber(a[4]),v.toNumber(a[5]),v.toNumber(a[6])));if(2===a.length){e=v.toString(a[1]);if(""===e)return null;e=v.standardiseDateFormat(e);a=t(v.toString(a[0]),e,!0);return!0===a.isValid()?
a.toDate():null}if(1===a.length){if(v.isString(a[0])&&""===a[0].replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))return null;e=v.toNumber(a[0]);return!1===isNaN(e)?n(new Date(e)):v.toDate(a[0])}if(0===a.length)return new Date})};g.datediff=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,2,3);e=v.toDateM(a[0]);b=v.toDateM(a[1]);if(null===e||null===b)return NaN;switch(v.toString(a[2]).toLowerCase()){case "days":case "day":case "d":return e.diff(b,"days",!0);case "months":case "month":return e.diff(b,
"months",!0);case "minutes":case "minute":case "m":return"M"===a[2]?e.diff(b,"months",!0):e.diff(b,"minutes",!0);case "seconds":case "second":case "s":return e.diff(b,"seconds",!0);case "milliseconds":case "millisecond":case "ms":return e.diff(b);case "hours":case "hour":case "h":return e.diff(b,"hours",!0);case "years":case "year":case "y":return e.diff(b,"years",!0);default:return e.diff(b)}})};g.dateadd=function(k,f){return u(k,f,function(e,b,a){v.pcCheck(a,2,3);e=v.toDateM(a[0]);if(null===e)return null;
b="milliseconds";switch(v.toString(a[2]).toLowerCase()){case "days":case "day":case "d":b="days";break;case "months":case "month":b="months";break;case "minutes":case "minute":case "m":b="M"===a[2]?"months":"minutes";break;case "seconds":case "second":case "s":b="seconds";break;case "milliseconds":case "millisecond":case "ms":b="milliseconds";break;case "hours":case "hour":case "h":b="hours";break;case "years":case "year":case "y":b="years"}e.add(v.toNumber(a[1]),b);return e.toDate()})}}})},"esri/arcade/functions/geometry":function(){define("require exports ../Dictionary ../Feature ../ImmutablePointArray ../languageUtils ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../geometry/jsonUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){Object.defineProperty(g,"__esModule",{value:!0});g.registerFunctions=function(g,w){g.ringisclockwise=function(a,c){return w(a,c,function(a,c,f){m.pcCheck(f,1,1);a=[];if(null===f[0])return!1;if(m.isArray(f[0])){var k=0;for(f=f[0];k<f.length;k++)if(c=f[k],c instanceof e)a.push([c.x,c.y]);else throw Error("Invalid Argument");}else if(f[0]instanceof n)a=f[0]._elements;else if(m.isImmutableArray(f[0])){for(var k=0,q=f[0].toArray();k<q.length;k++)if(c=q[k],c instanceof
e)a.push([c.x,c.y]);else throw Error("Invalid Argument");0<a.length&&(f[0].get(0),f[0].get(0))}else throw Error("Invalid Argument");return 3>a.length?!1:(new b({rings:[],spatialReference:{wkid:4326}})).isClockwise(a)})};g.polygon=function(a,e){return w(a,e,function(e,f,k){m.pcCheck(k,1,1);e=null;if(k[0]instanceof t){if(e=m.fixSpatialReference(v.parseGeometryFromDictionary(k[0]),a.spatialReference),!1===e instanceof b)throw Error("Illegal Parameter");}else e=k[0]instanceof b?c.fromJson(k[0].toJson()):
m.fixSpatialReference(new b(JSON.parse(k[0])),a.spatialReference);if(null!==e&&!1===e.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(e)})};g.polyline=function(b,e){return w(b,e,function(e,f,k){m.pcCheck(k,1,1);e=null;if(k[0]instanceof t){if(e=m.fixSpatialReference(v.parseGeometryFromDictionary(k[0]),b.spatialReference),!1===e instanceof a)throw Error("Illegal Parameter");
}else e=k[0]instanceof a?c.fromJson(k[0].toJson()):m.fixSpatialReference(new a(JSON.parse(k[0])),b.spatialReference);if(null!==e&&!1===e.spatialReference.equals(b.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(e)})};g.point=function(a,b){return w(a,b,function(b,f,k){m.pcCheck(k,1,1);b=null;if(k[0]instanceof t){if(b=m.fixSpatialReference(v.parseGeometryFromDictionary(k[0]),a.spatialReference),
!1===b instanceof e)throw Error("Illegal Parameter");}else b=k[0]instanceof e?c.fromJson(k[0].toJson()):m.fixSpatialReference(new e(JSON.parse(k[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(b)})};g.multipoint=function(a,b){return w(a,b,function(b,e,k){m.pcCheck(k,1,1);b=null;if(k[0]instanceof t){if(b=m.fixSpatialReference(v.parseGeometryFromDictionary(k[0]),
a.spatialReference),!1===b instanceof f)throw Error("Illegal Parameter");}else b=k[0]instanceof f?c.fromJson(k[0].toJson()):m.fixSpatialReference(new f(JSON.parse(k[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(b)})};g.extent=function(k,g){return w(k,g,function(g,q,w){w=m.autoCastFeatureToGeometry(w);m.pcCheck(w,1,1);g=null;
w[0]instanceof t?g=m.fixSpatialReference(v.parseGeometryFromDictionary(w[0]),k.spatialReference):w[0]instanceof e?(g={xmin:w[0].x,ymin:w[0].y,xmax:w[0].x,ymax:w[0].y,spatialReference:w[0].spatialReference.toJson()},w[0].hasZ?(g.zmin=w[0].z,g.zmax=w[0].z):w[0].hasM&&(g.mmin=w[0].m,g.mmax=w[0].m),g=c.fromJson(g)):g=w[0]instanceof b?c.fromJson(w[0].getExtent().toJson()):w[0]instanceof a?c.fromJson(w[0].getExtent().toJson()):w[0]instanceof f?c.fromJson(w[0].getExtent().toJson()):w[0]instanceof u?c.fromJson(w[0].toJson()):
m.fixSpatialReference(new u(JSON.parse(w[0])),k.spatialReference);if(null!==g&&!1===g.spatialReference.equals(k.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(g)})};g.geometry=function(a,b){return w(a,b,function(b,e,f){m.pcCheck(f,1,1);b=null;b=f[0]instanceof v?m.fixSpatialReference(f[0].geometry(),a.spatialReference):f[0]instanceof t?m.fixSpatialReference(v.parseGeometryFromDictionary(f[0]),
a.spatialReference):m.fixSpatialReference(c.fromJson(JSON.parse(f[0])),a.spatialReference);if(null!==b&&!1===b.spatialReference.equals(a.spatialReference))throw Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return m.fixNullGeometry(b)})};g.setgeometry=function(a,b){return w(a,b,function(a,b,c){m.pcCheck(c,2,2);if(c[0]instanceof v){if(!0===c[0].immutable)throw Error("Feature is Immutable");if(c[1]instanceof k||null===c[1])c[0]._geometry=c[1];
else throw Error("Illegal Argument");}else throw Error("Illegal Argument");return m.voidOperation})};g.feature=function(a,b){return w(a,b,function(b,c,e){if(0===e.length)throw Error("Missing Parameters");b=null;if(1===e.length)if(m.isString(e[0]))b=v.fromJson(JSON.parse(e[0]));else if(e[0]instanceof v)b=v.createFromArcadeFeature(e[0]);else if(e[0]instanceof k)b=v.createFromGraphicLikeObject(e[0],null,null);else if(e[0]instanceof t)b=e[0].hasField("geometry")?e[0].field("geometry"):null,c=e[0].hasField("attributes")?
e[0].field("attributes"):null,null!==b&&b instanceof t&&(b=v.parseGeometryFromDictionary(b)),null!==c&&(c=v.parseAttributesFromDictionary(c)),b=v.createFromGraphicLikeObject(b,c,null);else throw Error("Illegal Argument");else{if(2===e.length){c=b=null;if(null!==e[0])if(e[0]instanceof k)b=e[0];else if(b instanceof t)b=v.parseGeometryFromDictionary(e[0]);else throw Error("Illegal Argument");if(null!==e[1])if(e[1]instanceof t)c=v.parseAttributesFromDictionary(e[1]);else throw Error("Illegal Argument");
}else{b=null;c={};if(null!==e[0])if(e[0]instanceof k)b=e[0];else if(b instanceof t)b=v.parseGeometryFromDictionary(e[0]);else throw Error("Illegal Argument");for(var f=1;f<e.length;f+=2){var g=m.toString(e[f]),q=e[f+1];if(null===q||void 0===q||m.isString(q)||isNaN(q)||m.isDate(q)||m.isNumber(q)||m.isBoolean(q)){if(m.isFunctionParameter(q)||!1===m.isSimpleType(q))throw Error("Illegal Argument");c[g]=q===m.voidOperation?null:q}else throw Error("Illegal Argument");}}b=v.createFromGraphicLikeObject(b,
c,null)}b._geometry=m.fixSpatialReference(b.geometry(),a.spatialReference);b.immutable=!1;return b})};g.dictionary=function(a,b){return w(a,b,function(a,b,c){if(0===c.length)throw Error("Missing Parameters");if(0!==c.length%2)throw Error("Missing Parameters");a={};for(b=0;b<c.length;b+=2){var e=m.toString(c[b]),f=c[b+1];if(null===f||void 0===f||m.isString(f)||isNaN(f)||m.isDate(f)||m.isNumber(f)||m.isBoolean(f)||m.isArray(f)||m.isImmutableArray(f)){if(m.isFunctionParameter(f))throw Error("Illegal Argument");
a[e]=f===m.voidOperation?null:f}else throw Error("Illegal Argument");}c=new t(a);c.immutable=!1;return c})};g.haskey=function(a,b){return w(a,b,function(a,b,c){m.pcCheck(c,2,2);a=m.toString(c[1]);if(c[0]instanceof v||c[0]instanceof t)return c[0].hasField(a);throw Error("Illegal Argument");})};g.indexof=function(a,b){return w(a,b,function(a,b,c){m.pcCheck(c,2,2);a=c[1];if(m.isArray(c[0])){for(b=0;b<c[0].length;b++)if(m.equalityTest(a,c[0][b]))return b;return-1}if(m.isImmutableArray(c[0])){var e=c[0].length();
for(b=0;b<e;b++)if(m.equalityTest(a,c[0].get(b)))return b;return-1}throw Error("Illegal Argument");})}}})},"esri/arcade/functions/geomsync":function(){define("require exports ../../kernel ../kernel ../languageUtils ../featureset/support/shared ./centroid ../../geometry/Extent ../../geometry/Geometry ../../geometry/Multipoint ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline ../../geometry/jsonUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){function w(b){return 0===t.version.indexOf("4.")?
a.fromExtent(b):new a({spatialReference:b.spatialReference,rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]})}Object.defineProperty(g,"__esModule",{value:!0});var q=null;g.setGeometryEngine=function(a){q=a};g.registerFunctions=function(g,p){function z(a){n.pcCheck(a,2,2);if(!(a[0]instanceof f&&a[1]instanceof f||a[0]instanceof f&&null===a[1]||a[1]instanceof f&&null===a[0]||null===a[0]&&null===a[1]))throw Error("Illegal Argument");}g.disjoint=function(a,b){return p(a,
b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!0:q.disjoint(c[0],c[1])})};g.intersects=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!1:q.intersects(c[0],c[1])})};g.touches=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!1:q.touches(c[0],c[1])})};g.crosses=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);
z(c);return null===c[0]||null===c[1]?!1:q.crosses(c[0],c[1])})};g.within=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!1:q.within(c[0],c[1])})};g.contains=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!1:q.contains(c[0],c[1])})};g.overlaps=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?!1:q.overlaps(c[0],
c[1])})};g.equals=function(a,b){return p(a,b,function(a,b,c){n.pcCheck(c,2,2);return c[0]===c[1]?!0:c[0]instanceof f&&c[1]instanceof f?q.equals(c[0],c[1]):n.isDate(c[0])&&n.isDate(c[1])?c[0].getTime()===c[1].getTime():!1})};g.relate=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,3,3);if(c[0]instanceof f&&c[1]instanceof f)return q.relate(c[0],c[1],n.toString(c[2]));if(c[0]instanceof f&&null===c[1]||c[1]instanceof f&&null===c[0]||null===c[0]&&null===c[1])return!1;
throw Error("Illegal Argument");})};g.intersection=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]||null===c[1]?null:q.intersect(c[0],c[1])})};g.union=function(a,b){return p(a,b,function(b,c,e){e=n.autoCastFeatureToGeometry(e);b=[];if(0===e.length)throw Error("Function called with wrong number of Parameters");if(1===e.length)if(n.isArray(e[0]))for(e=n.autoCastFeatureToGeometry(e[0]),c=0;c<e.length;c++){if(null!==e[c]){if(!(e[c]instanceof f))throw Error("Illegal Argument");
b.push(e[c])}}else if(n.isImmutableArray(e[0]))for(e=n.autoCastFeatureToGeometry(e[0].toArray()),c=0;c<e.length;c++){if(null!==e[c]){if(!(e[c]instanceof f))throw Error("Illegal Argument");b.push(e[c])}}else{if(e[0]instanceof f)return n.fixSpatialReference(m.cloneGeometry(e[0]),a.spatialReference);if(null===e[0])return null;throw Error("Illegal Argument");}else for(c=0;c<e.length;c++)if(null!==e[c]){if(!(e[c]instanceof f))throw Error("Illegal Argument");b.push(e[c])}return 0===b.length?null:q.union(b)})};
g.difference=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null!==c[0]&&null===c[1]?m.cloneGeometry(c[0]):null===c[0]?null:q.difference(c[0],c[1])})};g.symmetricdifference=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);z(c);return null===c[0]&&null===c[1]?null:null===c[0]?m.cloneGeometry(c[1]):null===c[1]?m.cloneGeometry(c[0]):q.symmetricDifference(c[0],c[1])})};g.clip=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);
n.pcCheck(c,2,2);if(!(c[1]instanceof k)&&null!==c[1])throw Error("Illegal Argument");if(null===c[0])return null;if(!(c[0]instanceof f))throw Error("Illegal Argument");return null===c[1]?null:q.clip(c[0],c[1])})};g.cut=function(a,b){return p(a,b,function(a,b,e){e=n.autoCastFeatureToGeometry(e);n.pcCheck(e,2,2);if(!(e[1]instanceof c)&&null!==e[1])throw Error("Illegal Argument");if(null===e[0])return[];if(!(e[0]instanceof f))throw Error("Illegal Argument");return null===e[1]?[m.cloneGeometry(e[0])]:
q.cut(e[0],e[1])})};g.area=function(a,b){return p(a,b,function(b,c,e){n.pcCheck(e,1,2);e=n.autoCastFeatureToGeometry(e);if(null===e[0])return 0;if(n.isArray(e[0])||n.isImmutableArray(e[0]))return b=n.autoCastArrayOfPointsToPolygon(e[0],a.spatialReference),null===b?0:q.planarArea(b,v.convertSquareUnitsToCode(n.defaultUndefined(e[1],-1)));if(!(e[0]instanceof f))throw Error("Illegal Argument");return q.planarArea(e[0],v.convertSquareUnitsToCode(n.defaultUndefined(e[1],-1)))})};g.areageodetic=function(a,
b){return p(a,b,function(b,c,e){n.pcCheck(e,1,2);e=n.autoCastFeatureToGeometry(e);if(null===e[0])return 0;if(n.isArray(e[0])||n.isImmutableArray(e[0]))return b=n.autoCastArrayOfPointsToPolygon(e[0],a.spatialReference),null===b?0:q.geodesicArea(b,v.convertSquareUnitsToCode(n.defaultUndefined(e[1],-1)));if(!(e[0]instanceof f))throw Error("Illegal Argument");return q.geodesicArea(e[0],v.convertSquareUnitsToCode(n.defaultUndefined(e[1],-1)))})};g.length=function(a,b){return p(a,b,function(b,c,e){n.pcCheck(e,
1,2);e=n.autoCastFeatureToGeometry(e);if(null===e[0])return 0;if(n.isArray(e[0])||n.isImmutableArray(e[0]))return b=n.autoCastArrayOfPointsToPolyline(e[0],a.spatialReference),null===b?0:q.planarLength(b,v.convertLinearUnitsToCode(n.defaultUndefined(e[1],-1)));if(!(e[0]instanceof f))throw Error("Illegal Argument");return q.planarLength(e[0],v.convertLinearUnitsToCode(n.defaultUndefined(e[1],-1)))})};g.lengthgeodetic=function(a,b){return p(a,b,function(b,c,e){n.pcCheck(e,1,2);e=n.autoCastFeatureToGeometry(e);
if(null===e[0])return 0;if(n.isArray(e[0])||n.isImmutableArray(e[0]))return b=n.autoCastArrayOfPointsToPolyline(e[0],a.spatialReference),null===b?0:q.geodesicLength(b,v.convertLinearUnitsToCode(n.defaultUndefined(e[1],-1)));if(!(e[0]instanceof f))throw Error("Illegal Argument");return q.geodesicLength(e[0],v.convertLinearUnitsToCode(n.defaultUndefined(e[1],-1)))})};g.distance=function(a,b){return p(a,b,function(b,c,e){e=n.autoCastFeatureToGeometry(e);n.pcCheck(e,2,3);b=e[0];if(n.isArray(e[0])||n.isImmutableArray(e[0]))b=
n.autoCastArrayOfPointsToMultiPoint(e[0],a.spatialReference);c=e[1];if(n.isArray(e[1])||n.isImmutableArray(e[1]))c=n.autoCastArrayOfPointsToMultiPoint(e[1],a.spatialReference);if(!(b instanceof f))throw Error("Illegal Argument");if(!(c instanceof f))throw Error("Illegal Argument");return q.distance(b,c,v.convertLinearUnitsToCode(n.defaultUndefined(e[2],-1)))})};g.densify=function(b,e){return p(b,e,function(b,e,g){g=n.autoCastFeatureToGeometry(g);n.pcCheck(g,2,3);if(null===g[0])return null;if(!(g[0]instanceof
f))throw Error("Illegal Argument");b=n.toNumber(g[1]);if(isNaN(b))throw Error("Illegal Argument");if(0>=b)throw Error("Illegal Argument");return g[0]instanceof a||g[0]instanceof c?q.densify(g[0],b,v.convertLinearUnitsToCode(n.defaultUndefined(g[2],-1))):g[0]instanceof k?q.densify(w(g[0]),b,v.convertLinearUnitsToCode(n.defaultUndefined(g[2],-1))):g[0]})};g.densifygeodetic=function(b,e){return p(b,e,function(b,e,g){g=n.autoCastFeatureToGeometry(g);n.pcCheck(g,2,3);if(null===g[0])return null;if(!(g[0]instanceof
f))throw Error("Illegal Argument");b=n.toNumber(g[1]);if(isNaN(b))throw Error("Illegal Argument");if(0>=b)throw Error("Illegal Argument");return g[0]instanceof a||g[0]instanceof c?q.geodesicDensify(g[0],b,v.convertLinearUnitsToCode(n.defaultUndefined(g[2],-1))):g[0]instanceof k?q.geodesicDensify(w(g[0]),b,v.convertLinearUnitsToCode(n.defaultUndefined(g[2],-1))):g[0]})};g.generalize=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,2,4);if(null===c[0])return null;
if(!(c[0]instanceof f))throw Error("Illegal Argument");a=n.toNumber(c[1]);if(isNaN(a))throw Error("Illegal Argument");return q.generalize(c[0],a,n.toBoolean(n.defaultUndefined(c[2],!0)),v.convertLinearUnitsToCode(n.defaultUndefined(c[3],-1)))})};g.buffer=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,2,3);if(null===c[0])return null;if(!(c[0]instanceof f))throw Error("Illegal Argument");a=n.toNumber(c[1]);if(isNaN(a))throw Error("Illegal Argument");return 0===
a?m.cloneGeometry(c[0]):q.buffer(c[0],a,v.convertLinearUnitsToCode(n.defaultUndefined(c[2],-1)))})};g.buffergeodetic=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,2,3);if(null===c[0])return null;if(!(c[0]instanceof f))throw Error("Illegal Argument");a=n.toNumber(c[1]);if(isNaN(a))throw Error("Illegal Argument");return 0===a?m.cloneGeometry(c[0]):q.geodesicBuffer(c[0],a,v.convertLinearUnitsToCode(n.defaultUndefined(c[2],-1)))})};g.offset=function(b,e){return p(b,
e,function(b,e,f){f=n.autoCastFeatureToGeometry(f);n.pcCheck(f,2,6);if(null===f[0])return null;if(!(f[0]instanceof a||f[0]instanceof c))throw Error("Illegal Argument");b=n.toNumber(f[1]);if(isNaN(b))throw Error("Illegal Argument");e=n.toNumber(n.defaultUndefined(f[4],10));if(isNaN(e))throw Error("Illegal Argument");var k=n.toNumber(n.defaultUndefined(f[5],0));if(isNaN(k))throw Error("Illegal Argument");return q.offset(f[0],b,v.convertLinearUnitsToCode(n.defaultUndefined(f[2],-1)),n.toString(n.defaultUndefined(f[3],
"round")).toLowerCase(),e,k)})};g.rotate=function(c,e){return p(c,e,function(c,e,g){g=n.autoCastFeatureToGeometry(g);n.pcCheck(g,2,3);c=g[0];if(null===c)return null;if(!(c instanceof f))throw Error("Illegal Argument");c instanceof k&&(c=a.fromExtent(c));e=n.toNumber(g[1]);if(isNaN(e))throw Error("Illegal Argument");g=n.defaultUndefined(g[2],null);if(null===g)return q.rotate(c,e);if(g instanceof b)return q.rotate(c,e,g);throw Error("Illegal Argument");})};g.centroid=function(g,q){return p(g,q,function(q,
w,x){x=n.autoCastFeatureToGeometry(x);n.pcCheck(x,1,1);if(null===x[0])return null;q=x[0];if(n.isArray(x[0])||n.isImmutableArray(x[0]))q=n.autoCastArrayOfPointsToMultiPoint(x[0],g.spatialReference);if(null===q)return null;if(!(q instanceof f))throw Error("Illegal Argument");return q instanceof b?n.fixSpatialReference(m.cloneGeometry(x[0]),g.spatialReference):q instanceof a?q.getCentroid():q instanceof c?u.centroidPolyline(q):q instanceof e?u.centroidMultiPoint(q):q instanceof k?q.getCenter():null})};
g.multiparttosinglepart=function(g,w){return p(g,w,function(w,u,p){p=n.autoCastFeatureToGeometry(p);n.pcCheck(p,1,1);u=[];if(null===p[0])return null;if(!(p[0]instanceof f))throw Error("Illegal Argument");if(p[0]instanceof b||p[0]instanceof k)return[n.fixSpatialReference(m.cloneGeometry(p[0]),g.spatialReference)];w=q.simplify(p[0]);if(w instanceof a){u=[];var z=[];for(p=0;p<w.rings.length;p++)if(w.isClockwise(w.rings[p])){var B=x.fromJson({rings:[w.rings[p]],hasZ:!0===w.hasZ,hasM:!0===w.hasM,spatialReference:w.spatialReference.toJson()});
u.push(B)}else z.push({ring:w.rings[p],pt:w.getPoint(p,0)});for(w=0;w<z.length;w++)for(p=0;p<u.length;p++)if(u[p].contains(z[w].pt)){u[p].addRing(z[w].ring);break}return u}if(w instanceof c){u=[];for(p=0;p<w.paths.length;p++)z=x.fromJson({paths:[w.paths[p]],hasZ:!0===w.hasZ,hasM:!0===w.hasM,spatialReference:w.spatialReference.toJson()}),u.push(z);return u}if(p[0]instanceof e){w=n.fixSpatialReference(m.cloneGeometry(p[0]),g.spatialReference);for(p=0;p<w.points.length;p++)u.push(w.getPoint(p));return u}return null})};
g.issimple=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,1,1);if(null===c[0])return!0;if(!(c[0]instanceof f))throw Error("Illegal Argument");return q.isSimple(c[0])})};g.simplify=function(a,b){return p(a,b,function(a,b,c){c=n.autoCastFeatureToGeometry(c);n.pcCheck(c,1,1);if(null===c[0])return null;if(!(c[0]instanceof f))throw Error("Illegal Argument");return q.simplify(c[0])})}}})},"esri/arcade/kernel":function(){define(["require","exports","../geometry/Extent"],
function(p,g,t){Object.defineProperty(g,"__esModule",{value:!0});g.convertSquareUnitsToCode=function(g){if(void 0===g)return null;if("number"===typeof g)return g;switch(g.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square_meters":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 109413;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 109414;
case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 109405}return null};g.shapeExtent=function(g){if(null===g)return null;switch(g.type){case "polygon":case "multipoint":case "polyline":return g.extent;case "point":return new t({xmin:g.x,
ymin:g.y,xmax:g.x,ymax:g.y,spatialReference:g.spatialReference});case "extent":return g}return null};g.convertLinearUnitsToCode=function(g){if(void 0===g)return null;if("number"===typeof g||"number"===typeof g)return g;switch(g.toLowerCase()){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":case "square-meter":case "square-meters":return 9001;case "miles":case "mile":case "squaremile":case "squaremiles":case "square-miles":case "square-mile":return 9035;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "square-kilometers":case "square-kilometer":case "km":return 9036;
case "yard":case "yd":case "yards":case "square-yards":case "square-yard":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "square-feet":case "square-foot":case "squarefeet":case "squarefoot":return 9002}return null};g.sameGeomType=function(g,n){return g===n||"point"===g&&"esriGeometryPoint"===n||"polyline"===g&&"esriGeometryPolyline"===n||"polygon"===g&&"esriGeometryPolygon"===n||"extent"===g&&"esriGeometryEnvelope"===n||"multipoint"===g&&"esriGeometryMultipoint"===
n||"point"===n&&"esriGeometryPoint"===g||"polyline"===n&&"esriGeometryPolyline"===g||"polygon"===n&&"esriGeometryPolygon"===g||"extent"===n&&"esriGeometryEnvelope"===g||"multipoint"===n&&"esriGeometryMultipoint"===g?!0:!1}})},"esri/arcade/featureset/support/shared":function(){define("require exports ../../polyfill/promiseUtils ../../../geometry/Extent ../../../layers/Field ../../../geometry/jsonUtils".split(" "),function(p,g,t,v,n,m){function u(f){var e=null;f.domain&&(e="range"===f.domain.type?{type:"range",
range:[f.domain.minValue,f.domain.maxValue]}:{type:"codedValue",codedValues:f.domain.toJson().codedValues});return{name:f.name,type:f.type,alias:f.alias,length:f.length,editable:f.editable,nullable:f.nullable,domain:e}}function k(f){return f instanceof Date}Object.defineProperty(g,"__esModule",{value:!0});(function(f){f[f.Standardised=0]="Standardised";f[f.SqlServer=1]="SqlServer";f[f.Oracle=2]="Oracle";f[f.Postgres=3]="Postgres";f[f.PGDB=4]="PGDB";f[f.FILEGDB=5]="FILEGDB";f[f.NotEvaluated=6]="NotEvaluated"})(g.FeatureServiceDatabaseType||
(g.FeatureServiceDatabaseType={}));g.cloneField=function(f){return new n(u(f))};g.esriFieldToJson=u;g.cloneGeometry=function(f){if(null===f)return null;var e=m.fromJson(f.toJson());f.getCacheValue("_geVersion")&&e.setCacheValue("_geVersion",f.getCacheValue("_geVersion"));return e};(function(f){f[f.InFeatureSet=0]="InFeatureSet";f[f.NotInFeatureSet=1]="NotInFeatureSet";f[f.Unknown=2]="Unknown"})(g.IdState||(g.IdState={}));g.isString=function(f){return"string"===typeof f||f instanceof String};g.isBoolean=
function(f){return"boolean"===typeof f};g.isNumber=function(f){return"number"===typeof f};g.isArray=function(f){return f instanceof Array};g.isDate=k;g.equalityTest=function(f,e){return f===e?!0:k(f)&&k(e)?f.getTime()===e.getTime():!1};g.cloneAttributes=function(f){var e={},b;for(b in f)e[b]=f[b];return e};g.convertSquareUnitsToCode=function(f){if(void 0===f)return null;if("number"===typeof f)return f;switch(f.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109413;
case "kilometers":case "kilometer":case "km":return 109414}return null};g.shapeExtent=function(f){if(null===f)return null;switch(f.type){case "polygon":case "multipoint":case "polyline":return f.getExtent();case "point":return new v({xmin:f.x,ymin:f.y,xmax:f.x,ymax:f.y,spatialReference:f.spatialReference});case "extent":return f}return null};g.convertLinearUnitsToCode=function(f){if(void 0===f)return null;if("number"===typeof f||"number"===typeof f)return f;switch(f.toLowerCase()){case "meters":case "meter":return 9001;
case "miles":case "mile":return 9035;case "kilometers":case "kilometer":case "km":return 9036}return null};g.sameGeomType=function(f,e){return f===e||"point"===f&&"esriGeometryPoint"===e||"polyline"===f&&"esriGeometryPolyline"===e||"polygon"===f&&"esriGeometryPolygon"===e||"extent"===f&&"esriGeometryEnvelope"===e||"multipoint"===f&&"esriGeometryMultipoint"===e||"point"===e&&"esriGeometryPoint"===f||"polyline"===e&&"esriGeometryPolyline"===f||"polygon"===e&&"esriGeometryPolygon"===f||"extent"===e&&
"esriGeometryEnvelope"===f||"multipoint"===e&&"esriGeometryMultipoint"===f?!0:!1};g.defaultMaxRecords=1E3;g.errback=function(f){return function(e){f.reject(e)}};g.callback=function(f,e){return function(b){try{f.apply(null,arguments)}catch(a){e.reject(a)}}};g.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",
esriGeometryEnvelope:"extent",envelope:"extent"};g.toEsriGeometryType=function(f){switch(f){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};g.reduceArrayWithPromises=function(f,e,b){return t.create(function(a,b){var c=t.resolve(!0);f.reduce(function(a,b,c,f){return a.then(function(a){try{return e(a,b,c,f)}catch(B){return t.reject(B)}},
function(a){return t.reject(a)})},c).then(a,b)})};g.stableStringify=function(f,e){e||(e={});"function"===typeof e&&(e={cmp:e});var b="boolean"===typeof e.cycles?e.cycles:!1,a=e.cmp&&function(a){return function(b){return function(c,e){return a({key:c,value:b[c]},{key:e,value:b[e]})}}}(e.cmp),c=[];return function w(e){e&&e.toJson&&"function"===typeof e.toJson&&(e=e.toJson());if(void 0!==e){if("number"===typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var f,k;
if(Array.isArray(e)){k="[";for(f=0;f<e.length;f++)f&&(k+=","),k+=w(e[f])||"null";return k+"]"}if(null===e)return"null";if(-1!==c.indexOf(e)){if(b)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var g=c.push(e)-1,q=Object.keys(e).sort(a&&a(e));k="";for(f=0;f<q.length;f++){var m=q[f],n=w(e[m]);n&&(k&&(k+=","),k+=JSON.stringify(m)+":"+n)}c.splice(g,1);return"{"+k+"}"}}(f)}})},"esri/arcade/polyfill/promiseUtils":function(){define(["require","exports","dojo/Deferred",
"dojo/promise/all"],function(p,g,t,v){function n(f,e){var b=new t(e);f(function(a){return k(a).then(b.resolve)},b.reject);return b.promise}function m(f){if(f){if("function"!==typeof f.forEach){var e=Object.keys(f),b=e.map(function(a){return f[a]});return m(b).then(function(a){var b={};e.forEach(function(c,e){return b[c]=a[e]});return b})}var a=null;return n(function(b,e){var c=[],k=f.length;0===k&&b(c);f.forEach(function(f){var g={promise:f};c.push(g);f.then(function(a){g.value=a}).catch(function(a){g.error=
a}).then(function(){--k;0===k&&(a?e(Error("AbortError")):b(c))})})},function(b){a=b||"Invocation cancellation";f.forEach(function(a){return a.cancel(b)})})}}function u(f){void 0===f&&(f=void 0);var e=new t;e.resolve(f);return e.promise}function k(f){return f&&"function"===typeof f.then?f:u(f)}Object.defineProperty(g,"__esModule",{value:!0});g.all=function(f){return v(f)};g.filter=function(f,e){var b=f.slice();return v(f.map(function(a,b){return e(a,b)})).then(function(a){return b.filter(function(b,
e){return a[e]})})};g.create=n;g.createDeferred=function(f){var e=null;f=n(function(b,a){e={resolve:b,reject:a}},f);e.promise=f;e.cancel=function(){e.reject(Error("AbortError"))};return e};g.eachAlways=m;g.eachAlwaysValues=function(f){return m(f).then(function(e){return e.filter(function(b){return!!b.value}).map(function(b){return b.value})})};g.first=function(f){return f&&f.length?n(function(e,b){for(var a=0;a<f.length;a++)f[a].then(e,b)}):u()};g.reject=function(f){var e=new t;e.reject(f);return e.promise};
g.resolve=u;g.after=function(f,e){void 0===e&&(e=void 0);var b=0;return n(function(a){b=setTimeout(function(){a(e)},f)},function(){b&&(clearTimeout(b),b=0)})};g.timeout=function(f,e,b){var a=0,c=new t(f.cancel);f.then(function(b){c.isFulfilled()||(c.resolve(b),a&&(clearTimeout(a),a=0))});f.catch(function(b){c.isFulfilled()||(c.reject(b),a&&(clearTimeout(a),a=0))});a=setTimeout(function(){c.reject(b||Error("promiseUtils:timeout"))},e);return c.promise};g.wrapCallback=function(f){var e=!1;return n(function(){f(function(b){e||
u(b)})},function(){return e=!0})};g.isThenable=function(f){return f&&"function"===typeof f.then};g.when=k;g.createResolver=function(f){var e,b;f=n(function(a,f){e=a;b=f},f);var a=function(a){e(a)};a.resolve=function(a){return e(a)};a.reject=function(a){return b(a)};a.promise=f;return a}})},"esri/layers/Field":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./RangeDomain ./CodedValueDomain".split(" "),function(p,g,t,v,n,m,u){return p(null,{declaredClass:"esri.layers.Field",
constructor:function(k){if(k&&g.isObject(k)&&(this.name=k.name,this.type=k.type,this.alias=k.alias,this.length=k.length,this.editable=k.editable,this.nullable=k.nullable,this.defaultValue=k.defaultValue,this.description=k.description?JSON.parse(k.description):null,(k=k.domain)&&g.isObject(k)))switch(k.type){case "range":this.domain=new m(k);break;case "codedValue":this.domain=new u(k)}},toJson:function(){return n.fixJson({name:this.name,type:this.type,alias:this.alias,length:this.length,editable:this.editable,
nullable:this.nullable,defaultValue:this.defaultValue,description:JSON.stringify(this.description),domain:this.domain?this.domain.toJson():null})},toJSON:function(){return this.toJson()}})})},"esri/layers/RangeDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./Domain".split(" "),function(p,g,t,v,n,m){return p([m],{declaredClass:"esri.layers.RangeDomain",constructor:function(m){m&&g.isObject(m)&&(this.minValue=m.range[0],this.maxValue=m.range[1])},toJson:function(){var g=
this.inherited(arguments);g.range=[this.minValue,this.maxValue];return n.fixJson(g)}})})},"esri/layers/Domain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.layers.Domain",constructor:function(m){m&&g.isObject(m)&&(this.name=m.name,this.type=m.type)},toJson:function(){return n.fixJson({name:this.name,type:this.type})}})})},"esri/layers/CodedValueDomain":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ./Domain".split(" "),
function(p,g,t,v,n,m,u){return p([u],{declaredClass:"esri.layers.CodedValueDomain",constructor:function(k){k&&g.isObject(k)&&(this.codedValues=k.codedValues)},getName:function(k){var f;t.some(this.codedValues,function(e){e.code==k&&(f=e.name);return!!f});return f},toJson:function(){var k=this.inherited(arguments);k.codedValues=g.clone(this.codedValues);return m.fixJson(k)}})})},"esri/arcade/functions/centroid":function(){define(["require","exports","../../geometry/Point"],function(p,g,t){function v(g,
u,k){var f={x:0,y:0};u&&(f.z=0);k&&(f.m=0);for(var e=0,b=g[0],a=0;a<g.length;a++){var c=g[a],m;a:if(c.length!==b.length)m=!1;else{for(m=0;m<c.length;m++)if(c[m]!==b[m]){m=!1;break a}m=!0}if(!1===m){m=n(b,c,u);var w=c,q=u,p=k,z={x:(b[0]+w[0])/2,y:(b[1]+w[1])/2};q&&(z.z=(b[2]+w[2])/2);q&&p?z.m=(b[3]+w[3])/2:p&&(z.m=(b[2]+w[2])/2);b=z;b.x*=m;b.y*=m;f.x+=b.x;f.y+=b.y;u&&(b.z*=m,f.z+=b.z);k&&(b.m*=m,f.m+=b.m);e+=m;b=c}}0<e?(f.x/=e,f.y/=e,u&&(f.z/=e),k&&(f.m/=e)):(f.x=g[0][0],f.y=g[0][1],u&&(f.z=g[0][2]),
k&&u?f.m=g[0][3]:k&&(f.m=g[0][2]));return f}function n(g,n,k){var f=n[0]-g[0];g=n[1]-g[1];return k?(n=n[2]-n[2],Math.sqrt(f*f+g*g+n*n)):Math.sqrt(f*f+g*g)}Object.defineProperty(g,"__esModule",{value:!0});g.centroidPolyline=function(g){for(var m={x:0,y:0,spatialReference:g.spatialReference.toJson()},k={x:0,y:0,spatialReference:g.spatialReference.toJson()},f=0,e=0,b=0;b<g.paths.length;b++)if(0!==g.paths[b].length){var a;a=g.paths[b];var c=!0===g.hasZ;if(1>=a.length)a=0;else{for(var x=0,w=1;w<a.length;w++)x+=
n(a[w-1],a[w],c);a=x}0===a?(c=v(g.paths[b],!0===g.hasZ,!0===g.hasM),m.x+=c.x,m.y+=c.y,!0===g.hasZ&&(m.z+=c.z),!0===g.hasM&&(m.m+=c.m),++f):(c=v(g.paths[b],!0===g.hasZ,!0===g.hasM),k.x+=c.x*a,k.y+=c.y*a,!0===g.hasZ&&(k.z+=c.z*a),!0===g.hasM&&(k.m+=c.m*a),e+=a)}return 0<e?(k.x/=e,k.y/=e,!0===g.hasZ&&(k.z/=e),!0===g.hasM&&(k.m/=e),new t(k)):0<f?(m.x/=f,m.y/=f,!0===g.hasZ&&(k.z/=f),!0===g.hasM&&(m.m/=f),new t(m)):null};g.centroidMultiPoint=function(g){if(0===g.points.length)return null;for(var m=0,k=
0,f=0,e=0,b=0;b<g.points.length;b++){var a=g.getPoint(b);!0===a.hasZ&&(f+=a.z);!0===a.hasM&&(e+=a.m);m+=a.x;k+=a.y;e+=a.m}m={x:m/g.points.length,y:k/g.points.length,spatialReference:null};m.spatialReference=g.spatialReference.toJson();!0===g.hasZ&&(m.z=f/g.points.length);!0===g.hasM&&(m.m=e/g.points.length);return new t(m)};g.angle2D=function(g,n){var k=g.x;g=g.y;var f=n.x;n=n.y;var e=k*k+g*g;0<e&&(e=1/Math.sqrt(e));var b=f*f+n*n;0<b&&(b=1/Math.sqrt(b));k=(k*f+g*n)*e*b;return 1<k?0:-1>k?Math.PI:180*
Math.acos(k)/Math.PI};g.angleBetween2D=function(g,n,k){var f=g.x-n.x;g=g.y-n.y;var e=k.x-n.x;n=k.y-n.y;k=Math.sqrt(f*f+g*g);var b=Math.sqrt(e*e+n*n);return 180*Math.acos(f/k*(e/b)+g/k*(n/b))/Math.PI}})},"esri/arcade/functions/maths":function(){define(["require","exports","dojo/number","../languageUtils"],function(p,g,t,v){function n(g,n,k){if("undefined"===typeof k||0===+k)return Math[g](n);n=+n;k=+k;if(isNaN(n)||"number"!==typeof k||0!==k%1)return NaN;n=n.toString().split("e");n=Math[g](+(n[0]+"e"+
(n[1]?+n[1]-k:-k)));n=n.toString().split("e");return+(n[0]+"e"+(n[1]?+n[1]+k:k))}Object.defineProperty(g,"__esModule",{value:!0});g.registerFunctions=function(g,u){function k(f,e,b){f=v.toNumber(f);return isNaN(f)?f:isNaN(e)||isNaN(b)||e>b?NaN:f<e?e:f>b?b:f}g.number=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,2);b=c[0];return v.isNumber(b)?b:null===b?0:v.isDate(b)||v.isBoolean(b)?Number(b):v.isArray(b)?NaN:""===b||void 0===b?Number(b):v.isString(b)?void 0!==c[1]?(c=v.multiReplace(c[1],
"\u2030",""),c=v.multiReplace(c,"\u00a4",""),t.parse(b,{pattern:c})):Number(b.trim()):Number(b)})};g.abs=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.abs(v.toNumber(c[0]))})};g.acos=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.acos(v.toNumber(c[0]))})};g.asin=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.asin(v.toNumber(c[0]))})};g.atan=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.atan(v.toNumber(c[0]))})};
g.atan2=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,2,2);return Math.atan2(v.toNumber(c[0]),v.toNumber(c[1]))})};g.ceil=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,2);return 2===c.length?(b=v.toNumber(c[1]),isNaN(b)&&(b=0),n("ceil",v.toNumber(c[0]),-1*b)):Math.ceil(v.toNumber(c[0]))})};g.round=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,2);return 2===c.length?(b=v.toNumber(c[1]),isNaN(b)&&(b=0),n("round",v.toNumber(c[0]),-1*b)):Math.round(v.toNumber(c[0]))})};
g.floor=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,2);return 2===c.length?(b=v.toNumber(c[1]),isNaN(b)&&(b=0),n("floor",v.toNumber(c[0]),-1*b)):Math.floor(v.toNumber(c[0]))})};g.cos=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.cos(v.toNumber(c[0]))})};g.isnan=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return"number"===typeof c[0]&&isNaN(c[0])})};g.exp=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.exp(v.toNumber(c[0]))})};
g.log=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.log(v.toNumber(c[0]))})};g.pow=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,2,2);return Math.pow(v.toNumber(c[0]),v.toNumber(c[1]))})};g.random=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,0,0);return Math.random()})};g.sin=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.sin(v.toNumber(c[0]))})};g.sqrt=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.sqrt(v.toNumber(c[0]))})};
g.tan=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return Math.tan(v.toNumber(c[0]))})};g.defaultvalue=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,2,2);return null===c[0]||""===c[0]||void 0===c[0]?c[1]:c[0]})};g.isempty=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return null===c[0]||""===c[0]||void 0===c[0]?!0:!1})};g["boolean"]=function(f,e){return u(f,e,function(b,a,c){v.pcCheck(c,1,1);return v.toBoolean(c[0])})};g.constrain=function(f,e){return u(f,e,function(b,
a,c){v.pcCheck(c,3,3);b=v.toNumber(c[1]);a=v.toNumber(c[2]);if(v.isArray(c[0])){var e=[],f=0;for(c=c[0];f<c.length;f++)e.push(k(c[f],b,a));return e}if(v.isImmutableArray(c[0])){e=[];for(f=0;f<c[0].length();f++)e.push(k(c[0].get(f),b,a));return e}return k(c[0],b,a)})}}})},"esri/arcade/functions/stats":function(){define(["require","exports","../languageUtils","./fieldStats"],function(p,g,t,v){function n(g,n,k,f){if(1===f.length){if(t.isArray(f[0]))return v.calculateStat(g,f[0],-1);if(t.isImmutableArray(f[0]))return v.calculateStat(g,
f[0].toArray(),-1)}return v.calculateStat(g,f,-1)}Object.defineProperty(g,"__esModule",{value:!0});g.registerFunctions=function(g,u){g.stdev=function(k,f){return u(k,f,function(e,b,a){return n("stdev",e,b,a)})};g.variance=function(k,f){return u(k,f,function(e,b,a){return n("variance",e,b,a)})};g.average=function(k,f){return u(k,f,function(e,b,a){return n("mean",e,b,a)})};g.mean=function(k,f){return u(k,f,function(e,b,a){return n("mean",e,b,a)})};g.sum=function(k,f){return u(k,f,function(e,b,a){return n("sum",
e,b,a)})};g.min=function(k,f){return u(k,f,function(e,b,a){return n("min",e,b,a)})};g.max=function(k,f){return u(k,f,function(e,b,a){return n("max",e,b,a)})};g.distinct=function(k,f){return u(k,f,function(e,b,a){return n("distinct",e,b,a)})};g.count=function(k,f){return u(k,f,function(e,b,a){t.pcCheck(a,1,1);if(t.isArray(a[0])||t.isString(a[0]))return a[0].length;if(t.isImmutableArray(a[0]))return a[0].length();throw Error("Invalid Parameters for Count");})}}})},"esri/arcade/functions/fieldStats":function(){define(["require",
"exports","../languageUtils"],function(p,g,t){function v(g){for(var m=0,k=0;k<g.length;k++)m+=g[k];return m/g.length}function n(g){for(var m=v(g),k=0,f=0;f<g.length;f++)k+=Math.pow(m-g[f],2);return k/g.length}Object.defineProperty(g,"__esModule",{value:!0});g.decodeStatType=function(g){switch(g.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";
case "count":return"count"}return""};g.calculateStat=function(g,u,k){void 0===k&&(k=1E3);switch(g.toLowerCase()){case "distinct":a:{g=k;k=[];for(var f={},e=[],b=0;b<u.length;b++){if(void 0!==u[b]&&null!==u[b]&&u[b]!==t.voidOperation){var a=u[b];if(t.isNumber(a)||t.isString(a))void 0===f[a]&&(k.push(a),f[a]=1);else{for(var c=!1,m=0;m<e.length;m++)!0===t.equalityTest(e[m],a)&&(c=!0);!1===c&&(e.push(a),k.push(a))}}if(k.length>=g&&-1!==g){u=k;break a}}u=k}return u;case "avg":case "mean":return v(t.toNumberArray(u));
case "min":return Math.min.apply(Math,t.toNumberArray(u));case "sum":u=t.toNumberArray(u);for(k=g=0;k<u.length;k++)g+=u[k];return g;case "max":return Math.max.apply(Math,t.toNumberArray(u));case "stdev":case "stddev":return Math.sqrt(n(t.toNumberArray(u)));case "var":case "variance":return n(t.toNumberArray(u));case "count":return u.length}return 0}})},"esri/arcade/functions/string":function(){define(["require","exports","../Dictionary","../Feature","../languageUtils"],function(p,g,t,v,n){Object.defineProperty(g,
"__esModule",{value:!0});g.registerFunctions=function(g,u){g.trim=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,1);return n.toString(a[0]).trim()})};g.upper=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,1);return n.toString(a[0]).toUpperCase()})};g.proper=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,2);e=1;2===a.length&&"firstword"===n.toString(a[1]).toLowerCase()&&(e=2);b=/\s/;a=n.toString(a[0]);for(var c="",f=!0,k=0;k<a.length;k++){var g=a[k];b.test(g)?1===e&&(f=
!0):g.toUpperCase()!==g.toLowerCase()&&(f?(g=g.toUpperCase(),f=!1):g=g.toLowerCase());c+=g}return c})};g.lower=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,1);return n.toString(a[0]).toLowerCase()})};g.guid=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,0,1);if(0<a.length)switch(n.toString(a[0]).toLowerCase()){case "digits":return n.generateUUID().replace("-","").replace("-","").replace("-","").replace("-","");case "digits-hyphen":return n.generateUUID();case "digits-hyphen-parentheses":return"("+
n.generateUUID()+")"}return"{"+n.generateUUID()+"}"})};g.console=function(k,f){return u(k,f,function(e,b,a){0!==a.length&&(1===a.length?k.console(n.toString(a[0])):k.console(n.toString(a)));return n.voidOperation})};g.mid=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,2,3);e=n.toNumber(a[1]);if(isNaN(e))return"";0>e&&(e=0);if(2===a.length)return n.toString(a[0]).substr(e);b=n.toNumber(a[2]);if(isNaN(b))return"";0>b&&(b=0);return n.toString(a[0]).substr(e,b)})};g.find=function(k,f){return u(k,
f,function(e,b,a){n.pcCheck(a,2,3);e=0;if(2<a.length){e=n.toNumber(n.defaultUndefined(a[2],0));if(isNaN(e))return-1;0>e&&(e=0)}return n.toString(a[1]).indexOf(n.toString(a[0]),e)})};g.left=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,2,2);e=n.toNumber(a[1]);if(isNaN(e))return"";0>e&&(e=0);return n.toString(a[0]).substr(0,e)})};g.right=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,2,2);e=n.toNumber(a[1]);if(isNaN(e))return"";0>e&&(e=0);return n.toString(a[0]).substr(-1*e,e)})};g.split=
function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,2,4);e=n.toNumber(n.defaultUndefined(a[2],-1));b=n.toBoolean(n.defaultUndefined(a[3],!1));-1===e||null===e||!0===b?a=n.toString(a[0]).split(n.toString(a[1])):(isNaN(e)&&(e=-1),-1>e&&(e=-1),a=n.toString(a[0]).split(n.toString(a[1]),e));if(!1===b)return a;b=[];for(var c=0;c<a.length&&!(-1!==e&&b.length>=e);c++)""!==a[c]&&void 0!==a[c]&&b.push(a[c]);return b})};g.text=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,2);return n.toStringExplicit(a[0],
a[1])})};g.concatenate=function(k,f){return u(k,f,function(e,b,a){e=[];if(1>a.length)return"";if(n.isArray(a[0])){b=n.defaultUndefined(a[2],"");for(var c=0;c<a[0].length;c++)e[c]=n.toStringExplicit(a[0][c],b);return 1<a.length?e.join(a[1]):e.join("")}if(n.isImmutableArray(a[0])){b=n.defaultUndefined(a[2],"");for(c=0;c<a[0].length();c++)e[c]=n.toStringExplicit(a[0].get(c),b);return 1<a.length?e.join(a[1]):e.join("")}for(c=0;c<a.length;c++)e[c]=n.toStringExplicit(a[c]);return e.join("")})};g.reverse=
function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,1);if(n.isArray(a[0]))return e=a[0].slice(0),e.reverse(),e;if(n.isImmutableArray(a[0]))return e=a[0].toArray().slice(0),e.reverse(),e;throw Error("Invalid Parameter");})};g.replace=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,3,4);e=n.toString(a[0]);b=n.toString(a[1]);var c=n.toString(a[2]);return(4===a.length?n.toBoolean(a[3]):1)?n.multiReplace(e,b,c):e.replace(b,c)})};g.domainname=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,
2,4);if(a[0]instanceof v)return a[0].domainValueLookup(n.toString(a[1]),a[2],void 0===a[3]?void 0:n.toNumber(a[3]));throw Error("Invalid Parameter");})};g.domaincode=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,2,4);if(a[0]instanceof v)return a[0].domainCodeLookup(n.toString(a[1]),a[2],void 0===a[3]?void 0:n.toNumber(a[3]));throw Error("Invalid Parameter");})};g.urlencode=function(k,f){return u(k,f,function(e,b,a){n.pcCheck(a,1,1);if(null===a[0])return"";if(a[0]instanceof t){e="";b=0;for(var c=
a[0].keys();b<c.length;b++){var f=c[b],k=a[0].field(f);""!==e&&(e+="\x26");e=null===k?e+(encodeURIComponent(f)+"\x3d"):e+(encodeURIComponent(f)+"\x3d"+encodeURIComponent(k))}return e}return encodeURIComponent(n.toString(a[0]))})}}})},"esri/arcade/arcadeRuntime":function(){define("require exports ./Attachment ./Dictionary ./Feature ./FunctionWrapper ./ImmutablePathArray ./ImmutablePointArray ./languageUtils ./treeAnalysis ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../geometry/Extent ../geometry/Geometry ../geometry/Multipoint ../geometry/Point ../geometry/Polygon ../geometry/Polyline ../SpatialReference".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){function I(d,h){for(var a=[],l=0;l<h.arguments.length;l++)a.push(J(d,h.arguments[l]));return a}function K(d,h,a){try{return a(d,h,I(d,h))}catch(ma){throw ma;}}function J(d,h){try{switch(h.type){case "EmptyStatement":return f.voidOperation;case "VariableDeclarator":var a=null===h.init?null:J(d,h.init);a===f.voidOperation&&(a=null);if("Identifier"!==h.id.type)throw Error("Can only assign a regular variable");var l=h.id.name.toLowerCase();null!==
d.localScope?d.localScope[l]={value:a,valueset:!0,node:h.init}:d.globalScope[l]={value:a,valueset:!0,node:h.init};return f.voidOperation;case "VariableDeclaration":for(var r=0;r<h.declarations.length;r++)J(d,h.declarations[r]);return f.voidOperation;case "BlockStatement":var b;a:{for(var c=f.voidOperation,r=0;r<h.body.length;r++)if(c=J(d,h.body[r]),c instanceof f.ReturnResult||c===f.breakResult||c===f.continueResult){b=c;break a}b=c}return b;case "FunctionDeclaration":var y=h.id.name.toLowerCase();
d.globalScope[y]={valueset:!0,node:null,value:new m(h,d)};return f.voidOperation;case "ReturnStatement":var A;if(null===h.argument)A=new f.ReturnResult(f.voidOperation);else{var H=J(d,h.argument);A=new f.ReturnResult(H)}return A;case "IfStatement":var k;if("AssignmentExpression"===h.test.type||"UpdateExpression"===h.test.type)throw Error(e.nodeErrorMessage(h.test,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var g=J(d,h.test);if(!0===g)k=J(d,h.consequent);else if(!1===g)k=null!==h.alternate?J(d,
h.alternate):f.voidOperation;else throw Error(e.nodeErrorMessage(h,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));return k;case "ExpressionStatement":var q;if("AssignmentExpression"===h.expression.type||"UpdateExpression"===h.expression.type)q=J(d,h.expression);else{var w=J(d,h.expression);q=w===f.voidOperation?f.voidOperation:new f.ImplicitResult(w)}return q;case "AssignmentExpression":var x;var P=J(d,h.right),r=null,u="";if("MemberExpression"===h.left.type){r=J(d,h.left.object);!0===h.left.computed?
u=J(d,h.left.property):"Identifier"===h.left.property.type&&(u=h.left.property.name);if(f.isArray(r))if(f.isNumber(u)){0>u&&(u=r.length+u);if(0>u||u>r.length)throw Error("Assignment outside of array bounds");if(u===r.length&&"\x3d"!==h.operator)throw Error("Invalid Parameter");r[u]=M(P,h.operator,r[u],h)}else throw Error("Invalid Parameter");else if(r instanceof v){if(!1===f.isString(u))throw Error("Dictionary accessor must be a string");if(!0===r.hasField(u))r.setField(u,M(P,h.operator,r.field(u),
h));else{if("\x3d"!==h.operator)throw Error("Invalid Parameter");r.setField(u,M(P,h.operator,null,h))}}else if(r instanceof n){if(!1===f.isString(u))throw Error("Feature accessor must be a string");if(!0===r.hasField(u))r.setField(u,M(P,h.operator,r.field(u),h));else{if("\x3d"!==h.operator)throw Error("Invalid Parameter");r.setField(u,M(P,h.operator,null,h))}}else{if(f.isImmutableArray(r))throw Error("Array is Immutable");throw Error("Invalid Parameter");}x=f.voidOperation}else if(r=h.left.name.toLowerCase(),
null!==d.localScope&&void 0!==d.localScope[r])d.localScope[r]={value:M(P,h.operator,d.localScope[r].value,h),valueset:!0,node:h.right},x=f.voidOperation;else if(void 0!==d.globalScope[r])d.globalScope[r]={value:M(P,h.operator,d.globalScope[r].value,h),valueset:!0,node:h.right},x=f.voidOperation;else throw Error("Variable not recognised");return x;case "UpdateExpression":var p;var z,r=null,u="";if("MemberExpression"===h.argument.type){r=J(d,h.argument.object);!0===h.argument.computed?u=J(d,h.argument.property):
"Identifier"===h.argument.property.type&&(u=h.argument.property.name);if(f.isArray(r))if(f.isNumber(u)){0>u&&(u=r.length+u);if(0>u||u>=r.length)throw Error("Assignment outside of array bounds");z=f.toNumber(r[u]);r[u]="++"===h.operator?z+1:z-1}else throw Error("Invalid Parameter");else if(r instanceof v){if(!1===f.isString(u))throw Error("Dictionary accessor must be a string");if(!0===r.hasField(u))z=f.toNumber(r.field(u)),r.setField(u,"++"===h.operator?z+1:z-1);else throw Error("Invalid Parameter");
}else if(r instanceof n){if(!1===f.isString(u))throw Error("Feature accessor must be a string");if(!0===r.hasField(u))z=f.toNumber(r.field(u)),r.setField(u,"++"===h.operator?z+1:z-1);else throw Error("Invalid Parameter");}else{if(f.isImmutableArray(r))throw Error("Array is Immutable");throw Error("Invalid Parameter");}p=!1===h.prefix?z:"++"===h.operator?z+1:z-1}else{r="Identifier"===h.argument.type?h.argument.name.toLowerCase():"";if(!r)throw Error("Invalid identifier");if(null!==d.localScope&&void 0!==
d.localScope[r])z=f.toNumber(d.localScope[r].value),d.localScope[r]={value:"++"===h.operator?z+1:z-1,valueset:!0,node:h},p=!1===h.prefix?z:"++"===h.operator?z+1:z-1;else if(void 0!==d.globalScope[r])z=f.toNumber(d.globalScope[r].value),d.globalScope[r]={value:"++"===h.operator?z+1:z-1,valueset:!0,node:h},p=!1===h.prefix?z:"++"===h.operator?z+1:z-1;else throw Error("Variable not recognised");}return p;case "BreakStatement":return f.breakResult;case "ContinueStatement":return f.continueResult;case "ForStatement":null!==
h.init&&J(d,h.init);u={testResult:!0,lastAction:f.voidOperation};do b:{x=d;P=h;p=u;if(null!==P.test){p.testResult=J(x,P.test);if(!1===p.testResult)break b;if(!0!==p.testResult)throw Error(e.nodeErrorMessage(P,"RUNTIME","CANNOT_USE_NONBOOLEAN_IN_CONDITION"));}p.lastAction=J(x,P.body);p.lastAction===f.breakResult?p.testResult=!1:p.lastAction instanceof f.ReturnResult?p.testResult=!1:null!==P.update&&J(x,P.update)}while(!0===u.testResult);r=u.lastAction instanceof f.ReturnResult?u.lastAction:f.voidOperation;
return r;case "ForInStatement":return L(d,h);case "Identifier":return U(d,h);case "MemberExpression":return S(d,h);case "Literal":return h.value;case "CallExpression":return V(d,h);case "UnaryExpression":return T(d,h);case "BinaryExpression":return O(d,h);case "LogicalExpression":return W(d,h);case "ConditionalExpression":throw Error(e.nodeErrorMessage(h,"RUNTIME","NOTSUPPORTED"));case "ArrayExpression":try{for(r=[],u=0;u<h.elements.length;u++){var B=J(d,h.elements[u]);if(f.isFunctionParameter(B))throw Error(e.nodeErrorMessage(h,
"RUNTIME","FUNCTIONCONTEXTILLEGAL"));B===f.voidOperation?r.push(null):r.push(B)}}catch(ca){throw ca;}return r;case "ObjectExpression":r={};for(u=0;u<h.properties.length;u++){var C=J(d,h.properties[u]);if(f.isFunctionParameter(C.value))throw Error("Illegal Argument");if(!1===f.isString(C.key))throw Error("Illegal Argument");r[C.key.toString()]=C.value===f.voidOperation?null:C.value}var ba=new v(r);ba.immutable=!1;return ba;case "Property":return{key:"Identifier"===h.key.type?h.key.name:J(d,h.key),
value:J(d,h.value)};default:throw Error(e.nodeErrorMessage(h,"RUNTIME","UNREOGNISED"));}}catch(ca){throw ca;}}function L(d,h){var a=J(d,h.right);"VariableDeclaration"===h.left.type&&J(d,h.left);var l=null,r="";if("VariableDeclaration"===h.left.type){var b=h.left.declarations[0].id;"Identifier"===b.type&&(r=b.name)}else"Identifier"===h.left.type&&(r=h.left.name);if(!r)throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDVARIABLE"));null!==d.localScope&&void 0!==d.localScope[r]&&(l=d.localScope[r]);null===
l&&void 0!==d.globalScope[r]&&(l=d.globalScope[r]);if(null===l)throw Error(e.nodeErrorMessage(h,"RUNTIME","VARIABLENOTDECLARED"));if(f.isArray(a)||f.isString(a)){a=a.length;for(b=0;b<a;b++){l.value=b;r=J(d,h.body);if(r===f.breakResult)break;if(r instanceof f.ReturnResult)return r}return f.voidOperation}if(f.isImmutableArray(a)){for(b=0;b<a.length();b++){l.value=b;r=J(d,h.body);if(r===f.breakResult)break;if(r instanceof f.ReturnResult)return r}return f.voidOperation}if(a instanceof v||a instanceof
n)for(a=a.keys(),b=0;b<a.length;b++){l.value=a[b];r=J(d,h.body);if(r===f.breakResult)break;if(r instanceof f.ReturnResult)return r}else return f.voidOperation}function M(d,h,a,l){switch(h){case "\x3d":return d===f.voidOperation?null:d;case "/\x3d":return f.toNumber(a)/f.toNumber(d);case "*\x3d":return f.toNumber(a)*f.toNumber(d);case "-\x3d":return f.toNumber(a)-f.toNumber(d);case "+\x3d":return f.isString(a)||f.isString(d)?f.toString(a)+f.toString(d):f.toNumber(a)+f.toNumber(d);case "%\x3d":return f.toNumber(a)%
f.toNumber(d);default:throw Error(e.nodeErrorMessage(l,"RUNTIME","OPERATORNOTRECOGNISED"));}}function Q(d,h,a,l){h=h.toLowerCase();switch(h){case "hasz":return d=d.hasZ,void 0===d?!1:d;case "hasm":return d=d.hasM,void 0===d?!1:d;case "spatialreference":return h=d.spatialReference._arcadeCacheId,void 0===h&&(a=!0,Object.freeze&&Object.isFrozen(d.spatialReference)&&(a=!1),a&&(H++,h=d.spatialReference._arcadeCacheId=H)),d=new v({wkt:d.spatialReference.wkt,wkid:d.spatialReference.wkid}),void 0!==h&&(d._arcadeCacheId=
"SPREF"+h.toString()),d}switch(d.type){case "extent":switch(h){case "xmin":case "xmax":case "ymin":case "ymax":case "zmin":case "zmax":case "mmin":case "mmax":return d=d[h],void 0!==d?d:null;case "type":return"Extent"}break;case "polygon":switch(h){case "rings":return h=d.getCacheValue("_arcadeCacheId"),void 0===h&&(H++,h=H,d.setCacheValue("_arcadeCacheId",h)),d=new u(d.rings,d.spatialReference,!0===d.hasZ,!0===d.hasM,h);case "type":return"Polygon"}break;case "point":switch(h){case "x":case "y":case "z":case "m":return void 0!==
d[h]?d[h]:null;case "type":return"Point"}break;case "polyline":switch(h){case "paths":return h=d.getCacheValue("_arcadeCacheId"),void 0===h&&(H++,h=H,d.setCacheValue("_arcadeCacheId",h)),d=new u(d.paths,d.spatialReference,!0===d.hasZ,!0===d.hasM,h);case "type":return"Polyline"}break;case "multipoint":switch(h){case "points":return h=d.getCacheValue("_arcadeCacheId"),void 0===h&&(H++,h=H,d.setCacheValue("_arcadeCacheId",h)),d=new k(d.points,d.spatialReference,!0===d.hasZ,!0===d.hasM,h,1);case "type":return"Multipoint"}}throw Error(e.nodeErrorMessage(l,
"RUNTIME","PROPERTYNOTFOUND"));}function S(d,h){try{var a=J(d,h.object);if(null===a)throw Error(e.nodeErrorMessage(h,"RUNTIME","NOTFOUND"));if(!1===h.computed){if("Identifier"===h.property.type){if(a instanceof v||a instanceof n)return a.field(h.property.name);if(a instanceof z)return Q(a,h.property.name,d,h)}throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDTYPE"));}var l=J(d,h.property);if(a instanceof v||a instanceof n){if(f.isString(l))return a.field(l);throw Error(e.nodeErrorMessage(h,"RUNTIME",
"INVALIDTYPE"));}if(a instanceof z){if(f.isString(l))return Q(a,l,d,h);throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDTYPE"));}if(f.isArray(a)){if(f.isNumber(l)&&isFinite(l)&&Math.floor(l)===l){0>l&&(l=a.length+l);if(l>=a.length||0>l)throw Error(e.nodeErrorMessage(h,"RUNTIME","OUTOFBOUNDS"));return a[l]}throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDTYPE"));}if(f.isString(a)){if(f.isNumber(l)&&isFinite(l)&&Math.floor(l)===l){0>l&&(l=a.length+l);if(l>=a.length||0>l)throw Error(e.nodeErrorMessage(h,
"RUNTIME","OUTOFBOUNDS"));return a[l]}throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDTYPE"));}if(f.isImmutableArray(a)&&f.isNumber(l)&&isFinite(l)&&Math.floor(l)===l){0>l&&(l=a.length()+l);if(l>=a.length()||0>l)throw Error(e.nodeErrorMessage(h,"RUNTIME","OUTOFBOUNDS"));return a.get(l)}throw Error(e.nodeErrorMessage(h,"RUNTIME","INVALIDTYPE"));}catch(wa){throw wa;}}function T(d,h){try{var a=J(d,h.argument);if(f.isBoolean(a)){if("!"===h.operator)return!a;if("-"===h.operator)return-1*f.toNumber(a);
if("+"===h.operator)return 1*f.toNumber(a);throw Error(e.nodeErrorMessage(h,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}if("-"===h.operator)return-1*f.toNumber(a);if("+"===h.operator)return 1*f.toNumber(a);throw Error(e.nodeErrorMessage(h,"RUNTIME","NOTSUPPORTEDUNARYOPERATOR"));}catch(ma){throw ma;}}function O(d,h){try{var a=[J(d,h.left),J(d,h.right)],l=a[0],r=a[1];switch(h.operator){case "\x3d\x3d":return f.equalityTest(l,r);case "!\x3d":return!f.equalityTest(l,r);case "\x3c":return f.greaterThanLessThan(l,
r,h.operator);case "\x3e":return f.greaterThanLessThan(l,r,h.operator);case "\x3c\x3d":return f.greaterThanLessThan(l,r,h.operator);case "\x3e\x3d":return f.greaterThanLessThan(l,r,h.operator);case "+":return f.isString(l)||f.isString(r)?f.toString(l)+f.toString(r):f.toNumber(l)+f.toNumber(r);case "-":return f.toNumber(l)-f.toNumber(r);case "*":return f.toNumber(l)*f.toNumber(r);case "/":return f.toNumber(l)/f.toNumber(r);case "%":return f.toNumber(l)%f.toNumber(r);default:throw Error(e.nodeErrorMessage(h,
"RUNTIME","OPERATORNOTRECOGNISED"));}}catch(xa){throw xa;}}function W(d,h){try{if("AssignmentExpression"===h.left.type||"UpdateExpression"===h.left.type)throw Error(e.nodeErrorMessage(h.left,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));if("AssignmentExpression"===h.right.type||"UpdateExpression"===h.right.type)throw Error(e.nodeErrorMessage(h.right,"RUNTIME","CANNOT_USE_ASSIGNMENT_IN_CONDITION"));var a=J(d,h.left);if(f.isBoolean(a))switch(h.operator){case "||":if(!0===a)return a;var l=J(d,h.right);
if(f.isBoolean(l))return l;throw Error(e.nodeErrorMessage(h,"RUNTIME","ONLYORORAND"));case "\x26\x26":if(!1===a)return a;l=J(d,h.right);if(f.isBoolean(l))return l;throw Error(e.nodeErrorMessage(h,"RUNTIME","ONLYORORAND"));default:throw Error(e.nodeErrorMessage(h,"RUNTIME","ONLYORORAND"));}throw Error(e.nodeErrorMessage(h,"RUNTIME","ONLYBOOLEAN"));}catch(wa){throw wa;}}function U(d,h){var a;try{var l=h.name.toLowerCase();if(null!==d.localScope&&void 0!==d.localScope[l]){a=d.localScope[l];if(!0===a.valueset)return a.value;
a.value=J(d,a.node);a.valueset=!0;return a.value}if(void 0!==d.globalScope[l]){a=d.globalScope[l];if(!0===a.valueset)return a.value;a.value=J(d,a.node);a.valueset=!0;return a.value}throw Error(e.nodeErrorMessage(h,"RUNTIME","VARIABLENOTFOUND"));}catch(wa){throw wa;}}function V(d,a){try{if("Identifier"!==a.callee.type)throw Error(e.nodeErrorMessage(a,"RUNTIME","ONLYNODESSUPPORTED"));if(null!==d.localScope&&void 0!==d.localScope[a.callee.name.toLowerCase()]){var l=d.localScope[a.callee.name.toLowerCase()];
if(l.value instanceof f.NativeFunction)return l.value.fn(d,a);if(l.value instanceof m)return h(d,a,l.value.definition);throw Error(e.nodeErrorMessage(a,"RUNTIME","NOTAFUNCTION"));}if(void 0!==d.globalScope[a.callee.name.toLowerCase()]){l=d.globalScope[a.callee.name.toLowerCase()];if(l.value instanceof f.NativeFunction)return l.value.fn(d,a);if(l.value instanceof m)return h(d,a,l.value.definition);throw Error(e.nodeErrorMessage(a,"RUNTIME","NOTAFUNCTION"));}throw Error(e.nodeErrorMessage(a,"RUNTIME",
"NOTFOUND"));}catch(ma){throw ma;}}function A(d){return null==d?"":f.isArray(d)||f.isImmutableArray(d)?"Array":f.isDate(d)?"Date":f.isString(d)?"String":f.isBoolean(d)?"Boolean":f.isNumber(d)?"Number":d instanceof t?"Attachment":d instanceof v?"Dictionary":d instanceof n?"Feature":d instanceof B?"Point":d instanceof G?"Polygon":d instanceof F?"Polyline":d instanceof E?"Multipoint":d instanceof C?"Extent":f.isFunctionParameter(d)?"Function":f.isFeatureSet(d)?"FeatureSet":f.isFeatureSetCollection(d)?
"FeatureSetCollection":d===f.voidOperation?"":"number"===typeof d&&isNaN(d)?"Number":"Unrecognised Type"}function X(d,h,a,l){try{var r=J(d,h.arguments[a]);if(f.equalityTest(r,l))return J(d,h.arguments[a+1]);var b=h.arguments.length-a;return 1===b?J(d,h.arguments[a]):2===b?null:3===b?J(d,h.arguments[a+2]):X(d,h,a+2,l)}catch(ya){throw ya;}}function aa(d,h,a,l){try{if(!0===l)return J(d,h.arguments[a+1]);if(3===h.arguments.length-a)return J(d,h.arguments[a+2]);var r=J(d,h.arguments[a+2]);if(!1===f.isBoolean(r))throw Error("WHEN needs boolean test conditions");
return aa(d,h,a+2,r)}catch(xa){throw xa;}}function l(d,h){var a=d.length,r=Math.floor(a/2);if(0===a)return[];if(1===a)return[d[0]];var b=l(d.slice(0,r),h);d=l(d.slice(r,a),h);for(a=[];0<b.length||0<d.length;)0<b.length&&0<d.length?(r=h(b[0],d[0]),isNaN(r)&&(r=0),0>=r?(a.push(b[0]),b=b.slice(1)):(a.push(d[0]),d=d.slice(1))):0<b.length?(a.push(b[0]),b=b.slice(1)):0<d.length&&(a.push(d[0]),d=d.slice(1));return a}function d(d,h,a){try{var l=d.body;if(a.length!==d.params.length)throw Error("Invalid Parameter calls to function.");
for(var r=0;r<a.length;r++)h.localScope[d.params[r].name.toLowerCase()]={value:a[r],valueset:!0,node:null};var b=J(h,l);if(b instanceof f.ReturnResult)return b.value;if(b===f.breakResult)throw Error("Cannot Break from a Function");if(b===f.continueResult)throw Error("Cannot Continue from a Function");return b instanceof f.ImplicitResult?b.value:b}catch(ya){throw ya;}}function h(h,a,l){return K(h,a,function(a,r,b){a={spatialReference:h.spatialReference,applicationCache:void 0===h.applicationCache?
null:h.applicationCache,globalScope:h.globalScope,depthCounter:h.depthCounter+1,console:h.console,lrucache:h.lrucache,localScope:{}};if(64<a.depthCounter)throw Error("Exceeded maximum function depth");return d(l,a,b)})}function r(h){return function(){var a={applicationCache:void 0===h.context.applicationCache?null:h.context.applicationCache,spatialReference:h.context.spatialReference,console:h.context.console,lrucache:h.context.lrucache,localScope:{},depthCounter:h.context.depthCounter+1,globalScope:h.context.globalScope};
if(64<a.depthCounter)throw Error("Exceeded maximum function depth");return d(h.definition,a,arguments)}}function y(d){console.log(d)}Object.defineProperty(g,"__esModule",{value:!0});var H=0,P={};b.registerFunctions(P,K);q.registerFunctions(P,K);x.registerFunctions(P,K);a.registerFunctions(P,K);w.registerFunctions(P,K);c.registerFunctions(P,K);P["typeof"]=function(d,h){return K(d,h,function(d,h,a){f.pcCheck(a,1,1);d=A(a[0]);if("Unrecognised Type"===d)throw Error("Unrecognised Type");return d})};P.iif=
function(d,h){try{f.pcCheck(null===h.arguments?[]:h.arguments,3,3);var a=J(d,h.arguments[0]);if(!1===f.isBoolean(a))throw Error("IF Function must have a boolean test condition");var l=J(d,h.arguments[1]),r=J(d,h.arguments[2]);return!0===a?l:r}catch(xa){throw xa;}};P.decode=function(d,h){try{if(2>h.arguments.length)throw Error("Missing Parameters");if(2===h.arguments.length)return J(d,h.arguments[1]);if(0===(h.arguments.length-1)%2)throw Error("Must have a default value result.");var a=J(d,h.arguments[0]);
return X(d,h,1,a)}catch(ma){throw ma;}};P.when=function(d,h){try{if(3>h.arguments.length)throw Error("Missing Parameters");if(0===h.arguments.length%2)throw Error("Must have a default value result.");var a=J(d,h.arguments[0]);if(!1===f.isBoolean(a))throw Error("WHEN needs boolean test conditions");return aa(d,h,0,a)}catch(ma){throw ma;}};P.top=function(d,h){return K(d,h,function(d,h,a){f.pcCheck(a,2,2);if(f.isArray(a[0]))return f.toNumber(a[1])>=a[0].length?a[0].slice(0):a[0].slice(0,f.toNumber(a[1]));
if(f.isImmutableArray(a[0]))return f.toNumber(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,f.toNumber(a[1]));throw Error("Top cannot accept this parameter type");})};P.first=function(d,h){return K(d,h,function(d,h,a){f.pcCheck(a,1,1);return f.isArray(a[0])?0===a[0].length?null:a[0][0]:f.isImmutableArray(a[0])?0===a[0].length()?null:a[0].get(0):null})};P.sort=function(d,h){return K(d,h,function(d,h,a){f.pcCheck(a,1,2);d=a[0];f.isImmutableArray(d)&&(d=d.toArray());if(!1===f.isArray(d))throw Error("Illegal Argument");
if(1<a.length){if(!1===f.isFunctionParameter(a[1]))throw Error("Illegal Argument");var b=r(a[1]);return d=l(d,function(d,h){return b(d,h)})}if(0===d.length)return[];a={};for(h=0;h<d.length;h++){var c=A(d[h]);""!==c&&(a[c]=!0)}if(!0===a.Array||!0===a.Dictionary||!0===a.Feature||!0===a.Point||!0===a.Polygon||!0===a.Polyline||!0===a.Multipoint||!0===a.Extent||!0===a.Function)return d.slice(0);h=0;var c="",y;for(y in a)h++,c=y;return d=1<h||"String"===c?l(d,function(d,h){if(null===d||void 0===d||d===
f.voidOperation)return null===h||void 0===h||h===f.voidOperation?0:1;if(null===h||void 0===h||h===f.voidOperation)return-1;d=f.toString(d);h=f.toString(h);return d<h?-1:d===h?0:1}):"Number"===c?l(d,function(d,h){return d-h}):"Boolean"===c?l(d,function(d,h){return d===h?0:h?-1:1}):"Date"===c?l(d,function(d,h){return h-d}):d.slice(0)})};for(var ba in P)P[ba]={value:new f.NativeFunction(P[ba]),valueset:!0,node:null};var ea=function(){};ea.prototype=P;ea.prototype.infinity={value:Number.POSITIVE_INFINITY,
valueset:!0,node:null};ea.prototype.pi={value:Math.PI,valueset:!0,node:null};g.functionHelper={fixSpatialReference:f.fixSpatialReference,parseArguments:I,standardFunction:K};g.extend=function(d){for(var h={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:K,evaluateIdentifier:U,arcadeCustomFunctionHandler:r},a=0;a<d.length;a++)d[a].registerFunctions(h);for(var l in h.functions)P[l]={value:new f.NativeFunction(h.functions[l]),valueset:!0,node:null},ea.prototype[l]=P[l];for(a=0;a<
h.signatures.length;a++)e.addFunctionDeclaration(h.signatures[a],"async")};g.executeScript=function(d,h,a){a||(a=new D({wkid:102100}));var l=h.vars,r=h.customfunctions,b=new ea;l||(l={});r||(r={});var c=new v({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});c.immutable=!1;b.textformatting={value:c,valueset:!0,node:null};for(var e in r)b[e]={value:new f.NativeFunction(r[e]),native:!0,valueset:!0,node:null};for(e in l)b[e]=l[e]&&"esri.Graphic"===l[e].declaredClass?
{value:n.createFromGraphic(l[e]),valueset:!0,node:null}:{value:l[e],valueset:!0,node:null};d=J({spatialReference:a,globalScope:b,localScope:null,console:h.console?h.console:y,lrucache:h.lrucache,depthCounter:1,applicationCache:void 0===h.applicationCache?null:h.applicationCache},d.body[0].body);d instanceof f.ReturnResult&&(d=d.value);d instanceof f.ImplicitResult&&(d=d.value);d===f.voidOperation&&(d=null);if(d===f.breakResult)throw Error("Cannot return BREAK");if(d===f.continueResult)throw Error("Cannot return CONTINUE");
if(d instanceof m)throw Error("Cannot return FUNCTION");if(d instanceof f.NativeFunction)throw Error("Cannot return FUNCTION");return d};g.extractFieldLiterals=function(d,h){void 0===h&&(h=!1);return e.findFieldLiterals(d,h)};g.validateScript=function(d,h){return e.validateScript(d,h,"simple")};g.referencesMember=function(d,h){return e.referencesMember(d,h)};g.referencesFunction=function(d,h){return e.referencesFunction(d,h)};g.findFunctionCalls=function(d){return e.findFunctionCalls(d,!1)}})},"esri/arcade/parser":function(){define(["require",
"exports","./treeAnalysis","./lib/esprima"],function(p,g,t,v){Object.defineProperty(g,"__esModule",{value:!0});g.parseScript=function(g,m){void 0===m&&(m=[]);g=v.parse("function _() { "+g+"\n}");if(null===g.body||void 0===g.body)throw Error("No formula provided.");if(0===g.body.length)throw Error("No formula provided.");if(0===g.body.length)throw Error("No formula provided.");if("BlockStatement"!==g.body[0].body.type)throw Error("Invalid formula content.");var n=t.validateLanguage(g);if(""!==n)throw Error(n);
t.findScriptDependencies(g,m);return g};g.scriptCheck=function(g,m,u,k,f){var e=[];try{var b=v.parse("function _() { "+g+"\n}",{tolerant:!0,loc:!0}),a=b.errors;if(0<a.length)for(var c=0;c<a.length;c++)e.push({line:a[c].lineNumber,character:a[c].column,reason:a[c].description});var x=t.checkScript(b,m,u,k,f);for(m=0;m<x.length;m++)e.push(x[m])}catch(w){try{"Unexpected token }"===w.description?(w.index=("function _() { "+g+"\n}").length-1,e.push({line:w.lineNumber,character:w.column,reason:"Unexpected end of script"})):
e.push({line:w.lineNumber,character:w.column,reason:w.description})}catch(q){}}return e};g.extractFieldLiterals=function(g,m){void 0===m&&(m=!1);return t.findFieldLiterals(g,m)};g.validateScript=function(g,m,u){return t.validateScript(g,m,u)};g.referencesMember=function(g,m){return t.referencesMember(g,m)};g.referencesFunction=function(g,m){return t.referencesFunction(g,m)}})},"esri/arcade/lib/esprima":function(){(function(p,g){"function"===typeof define&&define.amd?define(["exports"],g):"undefined"!==
typeof exports?g(exports):g(p.esprima={})})(this,function(p){function g(d,h){if(!d)throw Error("ASSERT: "+h);}function t(d){return 48<=d&&57>=d}function v(d){return 0<="0123456789abcdefABCDEF".indexOf(d)}function n(d){return 0<="01234567".indexOf(d)}function m(d){return 10===d||13===d||8232===d||8233===d}function u(d){return 36===d||95===d||65<=d&&90>=d||97<=d&&122>=d||92===d||128<=d&&fb.NonAsciiIdentifierStart.test(String.fromCharCode(d))}function k(d){return 36===d||95===d||65<=d&&90>=d||97<=d&&
122>=d||48<=d&&57>=d||92===d||128<=d&&fb.NonAsciiIdentifierPart.test(String.fromCharCode(d))}function f(d){d=d.toLowerCase();switch(d.length){case 2:return"if"===d||"in"===d;case 3:return"var"===d||"for"===d;case 4:return"else"===d;case 5:return"break"===d;case 6:return"return"===d;case 8:return"function"===d.toLowerCase()||"continue"===d;default:return!1}}function e(d,h,a,l,r){g("number"===typeof a,"Comment must have valid position");ha.lastCommentStart>=a||(ha.lastCommentStart=a,d={type:d,value:h},
Y.range&&(d.range=[a,l]),Y.loc&&(d.loc=r),Y.comments.push(d),Y.attachComment&&(Y.leadingComments.push(d),Y.trailingComments.push(d)))}function b(d){var h,a,l;h=R-d;for(a={start:{line:ka,column:R-ia-d}};R<qa;)if(l=Z.charCodeAt(R),++R,m(l)){Y.comments&&(d=Z.slice(h+d,R-1),a.end={line:ka,column:R-ia-1},e("Line",d,h,R-1,a));13===l&&10===Z.charCodeAt(R)&&++R;++ka;ia=R;return}Y.comments&&(d=Z.slice(h+d,R),a.end={line:ka,column:R-ia},e("Line",d,h,R,a))}function a(){var d,h;for(h=0===R;R<qa;)if(d=Z.charCodeAt(R),
32===d||9===d||11===d||12===d||160===d||5760<=d&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(d))++R;else if(m(d))++R,13===d&&10===Z.charCodeAt(R)&&++R,++ka,ia=R,h=!0;else if(47===d)if(d=Z.charCodeAt(R+1),47===d)++R,++R,b(2),h=!0;else if(42===d){++R;++R;a:{var a=d=void 0,l=void 0,l=void 0;Y.comments&&(d=R-2,a={start:{line:ka,column:R-ia-2}});for(;R<qa;)if(l=Z.charCodeAt(R),m(l))13===l&&10===Z.charCodeAt(R+1)&&++R,++ka,++R,ia=R,R>=qa&&U();else{if(42===
l&&47===Z.charCodeAt(R+1)){++R;++R;Y.comments&&(l=Z.slice(d+2,R-2),a.end={line:ka,column:R-ia},e("Block",l,d,R,a));break a}++R}U()}}else break;else if(h&&45===d)if(45===Z.charCodeAt(R+1)&&62===Z.charCodeAt(R+2))R+=3,b(3);else break;else if(60===d)if("!--"===Z.slice(R+1,R+4))++R,++R,++R,++R,b(4);else break;else break}function c(d){var h,a,l=0;h="u"===d?4:2;for(d=0;d<h;++d)if(R<qa&&v(Z[R]))a=Z[R++],l=16*l+"0123456789abcdef".indexOf(a.toLowerCase());else return"";return String.fromCharCode(l)}function x(){var d,
h;d=Z.charCodeAt(R++);h=String.fromCharCode(d);92===d&&(117!==Z.charCodeAt(R)&&U(),++R,(d=c("u"))&&"\\"!==d&&u(d.charCodeAt(0))||U(),h=d);for(;R<qa;){d=Z.charCodeAt(R);if(!k(d))break;++R;h+=String.fromCharCode(d);92===d&&(h=h.substr(0,h.length-1),117!==Z.charCodeAt(R)&&U(),++R,(d=c("u"))&&"\\"!==d&&k(d.charCodeAt(0))||U(),h+=d)}return h}function w(){var d=R,h=Z.charCodeAt(R),a,l=Z[R];switch(h){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++R,
Y.tokenize&&(40===h?Y.openParenToken=Y.tokens.length:123===h&&(Y.openCurlyToken=Y.tokens.length)),{type:ca.Punctuator,value:String.fromCharCode(h),lineNumber:ka,lineStart:ia,start:d,end:R};default:if(a=Z.charCodeAt(R+1),61===a)switch(h){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return R+=2,{type:ca.Punctuator,value:String.fromCharCode(h)+String.fromCharCode(a),lineNumber:ka,lineStart:ia,start:d,end:R};case 33:case 61:return R+=2,61===Z.charCodeAt(R)&&++R,{type:ca.Punctuator,
value:Z.slice(d,R),lineNumber:ka,lineStart:ia,start:d,end:R}}}h=Z.substr(R,4);if("\x3e\x3e\x3e\x3d"===h)return R+=4,{type:ca.Punctuator,value:h,lineNumber:ka,lineStart:ia,start:d,end:R};h=h.substr(0,3);if("\x3e\x3e\x3e"===h||"\x3c\x3c\x3d"===h||"\x3e\x3e\x3d"===h)return R+=3,{type:ca.Punctuator,value:h,lineNumber:ka,lineStart:ia,start:d,end:R};h=h.substr(0,2);if(l===h[1]&&0<="+-\x3c\x3e\x26|".indexOf(l)||"\x3d\x3e"===h)return R+=2,{type:ca.Punctuator,value:h,lineNumber:ka,lineStart:ia,start:d,end:R};
if(0<="\x3c\x3e\x3d!+-*%\x26|^/".indexOf(l))return++R,{type:ca.Punctuator,value:l,lineNumber:ka,lineStart:ia,start:d,end:R};U()}function q(){var d,h,a;a=Z[R];g(t(a.charCodeAt(0))||"."===a,"Numeric literal must start with a decimal digit or a decimal point");h=R;d="";if("."!==a){d=Z[R++];a=Z[R];if("0"===d){if("x"===a||"X"===a){++R;for(d="";R<qa&&v(Z[R]);)d+=Z[R++];0===d.length&&U();u(Z.charCodeAt(R))&&U();return{type:ca.NumericLiteral,value:parseInt("0x"+d,16),lineNumber:ka,lineStart:ia,start:h,end:R}}if("b"===
a||"B"===a){++R;for(a="";R<qa;){d=Z[R];if("0"!==d&&"1"!==d)break;a+=Z[R++]}0===a.length&&U();R<qa&&(d=Z.charCodeAt(R),(u(d)||t(d))&&U());return{type:ca.NumericLiteral,value:parseInt(a,2),lineNumber:ka,lineStart:ia,start:h,end:R}}if("o"===a||"O"===a){n(a)?(a=!0,d="0"+Z[R++]):(a=!1,++R,d="");for(;R<qa&&n(Z[R]);)d+=Z[R++];a||0!==d.length||U();(u(Z.charCodeAt(R))||t(Z.charCodeAt(R)))&&U();return{type:ca.NumericLiteral,value:parseInt(d,8),octal:a,lineNumber:ka,lineStart:ia,start:h,end:R}}}for(;t(Z.charCodeAt(R));)d+=
Z[R++];a=Z[R]}if("."===a){for(d+=Z[R++];t(Z.charCodeAt(R));)d+=Z[R++];a=Z[R]}if("e"===a||"E"===a){d+=Z[R++];a=Z[R];if("+"===a||"-"===a)d+=Z[R++];if(t(Z.charCodeAt(R)))for(;t(Z.charCodeAt(R));)d+=Z[R++];else U()}u(Z.charCodeAt(R))&&U();return{type:ca.NumericLiteral,value:parseFloat(d),lineNumber:ka,lineStart:ia,start:h,end:R}}function C(){ga=null;a();T("Regular Expression language structures not supported")}function z(){a();C()}function E(){var d;d=Y.tokens[Y.tokens.length-1];if(!d)return z();if("Punctuator"===
d.type){if("]"===d.value)return w();if(")"===d.value)return d=Y.tokens[Y.openParenToken-1],!d||"Keyword"!==d.type||"if"!==d.value.toLowerCase()&&"while"!==d.value.toLowerCase()&&"for"!==d.value.toLowerCase()&&"with"!==d.value.toLowerCase()?w():z();if("}"===d.value){if(Y.tokens[Y.openCurlyToken-3]&&"Keyword"===Y.tokens[Y.openCurlyToken-3].type){if(d=Y.tokens[Y.openCurlyToken-4],!d)return w()}else if(Y.tokens[Y.openCurlyToken-4]&&"Keyword"===Y.tokens[Y.openCurlyToken-4].type){if(d=Y.tokens[Y.openCurlyToken-
5],!d)return z()}else return w();if(0<=Oa.indexOf(d.value))return w()}return z()}return"Keyword"===d.type&&"this"!==d.value?z():w()}function B(){var d;a();if(R>=qa)return{type:ca.EOF,lineNumber:ka,lineStart:ia,start:R,end:R};d=Z.charCodeAt(R);if(u(d)){var h;d=R;if(92===Z.charCodeAt(R))h=x();else a:{var l;for(h=R++;R<qa;){l=Z.charCodeAt(R);if(92===l){R=h;h=x();break a}if(k(l))++R;else break}h=Z.slice(h,R)}return{type:1===h.length?ca.Identifier:f(h)?ca.Keyword:"null"===h.toLowerCase()?ca.NullLiteral:
"true"===h.toLowerCase()||"false"===h.toLowerCase()?ca.BooleanLiteral:ca.Identifier,value:h,lineNumber:ka,lineStart:ia,start:d,end:R}}if(40===d||41===d||59===d)return w();if(39===d||34===d){var r="",b,y,e;l=!1;var A,H;A=ka;H=ia;d=Z[R];g("'"===d||'"'===d,"String literal must starts with a quote");h=R;for(++R;R<qa;)if(b=Z[R++],b===d){d="";break}else if("\\"===b)if((b=Z[R++])&&m(b.charCodeAt(0)))++ka,"\r"===b&&"\n"===Z[R]&&++R,ia=R;else switch(b){case "u":case "x":if("{"===Z[R]){++R;y=b=void 0;b=Z[R];
y=0;for("}"===b&&U();R<qa;){b=Z[R++];if(!v(b))break;y=16*y+"0123456789abcdef".indexOf(b.toLowerCase())}(1114111<y||"}"!==b)&&U();b=65535>=y?String.fromCharCode(y):String.fromCharCode((y-65536>>10)+55296,(y-65536&1023)+56320);r+=b}else e=R,(y=c(b))?r+=y:(R=e,r+=b);break;case "n":r+="\n";break;case "r":r+="\r";break;case "t":r+="\t";break;case "b":r+="\b";break;case "f":r+="\f";break;case "v":r+="\x0B";break;default:n(b)?(y="01234567".indexOf(b),0!==y&&(l=!0),R<qa&&n(Z[R])&&(l=!0,y=8*y+"01234567".indexOf(Z[R++]),
0<="0123".indexOf(b)&&R<qa&&n(Z[R])&&(y=8*y+"01234567".indexOf(Z[R++]))),r+=String.fromCharCode(y)):r+=b}else if(m(b.charCodeAt(0)))break;else r+=b;""!==d&&U();return{type:ca.StringLiteral,value:r,octal:l,startLineNumber:A,startLineStart:H,lineNumber:ka,lineStart:ia,start:h,end:R}}return 46===d?t(Z.charCodeAt(R+1))?q():w():t(d)?q():Y.tokenize&&47===d?E():w()}function G(){var d,h,l;a();d={start:{line:ka,column:R-ia}};h=B();d.end={line:ka,column:R-ia};h.type!==ca.EOF&&(l=Z.slice(h.start,h.end),d={type:Ga[h.type],
value:l,range:[h.start,h.end],loc:d},h.regex&&(d.regex={pattern:h.regex.pattern,flags:h.regex.flags}),Y.tokens.push(d));return h}function F(){var d;d=ga;R=d.end;ka=d.lineNumber;ia=d.lineStart;ga="undefined"!==typeof Y.tokens?G():B();R=d.end;ka=d.lineNumber;ia=d.lineStart;return d}function D(){var d,h,a;d=R;h=ka;a=ia;ga="undefined"!==typeof Y.tokens?G():B();R=d;ka=h;ia=a}function I(){this.line=ka;this.column=R-ia}function K(){this.start=new I;this.end=null}function J(d){this.start=d.type===ca.StringLiteral?
{line:d.startLineNumber,column:d.start-d.startLineStart}:{line:d.lineNumber,column:d.start-d.lineStart};this.end=null}function L(){R=ga.start;ga.type===ca.StringLiteral?(ka=ga.startLineNumber,ia=ga.startLineStart):(ka=ga.lineNumber,ia=ga.lineStart);Y.range&&(this.range=[R,0]);Y.loc&&(this.loc=new K)}function M(d){Y.range&&(this.range=[d.start,0]);Y.loc&&(this.loc=new J(d))}function Q(){var d,h,l,r;d=R;h=ka;l=ia;a();r=ka!==h;R=d;ka=h;ia=l;return r}function S(d,h,a){var l=Error("Line "+d+": "+a);l.index=
h;l.lineNumber=d;l.column=h-ia+1;l.description=a;return l}function T(d){var h,a;h=Array.prototype.slice.call(arguments,1);a=d.replace(/%(\d)/g,function(d,a){g(a<h.length,"Message reference must be in range");return h[a]});throw S(ka,R,a);}function O(d){var h,a;h=Array.prototype.slice.call(arguments,1);a=d.replace(/%(\d)/g,function(d,a){g(a<h.length,"Message reference must be in range");return h[a]});a=S(ka,R,a);if(Y.errors)Y.errors.push(a);else throw a;}function W(d,h){var a=na.UnexpectedToken;d&&
(a=h?h:d.type===ca.EOF?na.UnexpectedEOS:d.type===ca.Identifier?na.UnexpectedIdentifier:d.type===ca.NumericLiteral?na.UnexpectedNumber:d.type===ca.StringLiteral?na.UnexpectedString:na.UnexpectedToken);a=a.replace("%0",d?d.value:"ILLEGAL");return d&&"number"===typeof d.lineNumber?S(d.lineNumber,d.start,a):S(ka,R,a)}function U(d,h){throw W(d,h);}function V(d,h){d=W(d,h);if(Y.errors)Y.errors.push(d);else throw d;}function A(d){var h=F();h.type===ca.Punctuator&&h.value===d||U(h)}function X(){var d;Y.errors?
(d=ga,d.type===ca.Punctuator&&","===d.value?F():d.type===ca.Punctuator&&";"===d.value?(F(),V(d)):V(d,na.UnexpectedToken)):A(",")}function aa(d){var h=F();h.type===ca.Keyword&&h.value.toLowerCase()===d.toLowerCase()||U(h)}function l(d){return ga.type===ca.Punctuator&&ga.value===d}function d(d){return ga.type===ca.Keyword&&ga.value.toLowerCase()===d.toLowerCase()}function h(){var d;59===Z.charCodeAt(R)||l(";")?F():(d=ka,a(),ka===d&&(ga.type===ca.EOF||l("}")||U(ga)))}function r(d){return d.type===ja.Identifier||
d.type===ja.MemberExpression}function y(d,h){var a,l=new L;h=sa;a=Fa();sa=h;return l.finishFunctionExpression(null,d,[],a)}function H(){var d,h;d=sa;sa=!0;h=Da();h=y(h.params);sa=d;return h}function P(){var d,h=new L;d=F();return d.type===ca.StringLiteral||d.type===ca.NumericLiteral?(sa&&d.octal&&V(d,na.StrictOctalLiteral),h.finishLiteral(d)):h.finishIdentifier(d.value)}function ba(){var d,h,a,r=new L;d=ga;if(d.type===ca.Identifier)return h=P(),"get"!==d.value||l(":")||l("(")?"set"!==d.value||l(":")||
l("(")?l(":")?(F(),d=oa(),r.finishProperty("init",h,d,!1,!1)):l("(")?(d=H(),r.finishProperty("init",h,d,!0,!1)):r.finishProperty("init",h,h,!1,!0):(h=P(),A("("),d=ga,d.type!==ca.Identifier?(A(")"),V(d),d=y([])):(a=[pa()],A(")"),d=y(a,d)),r.finishProperty("set",h,d,!1,!1)):(h=P(),A("("),A(")"),d=y([]),r.finishProperty("get",h,d,!1,!1));if(d.type===ca.EOF||d.type===ca.Punctuator)U(d);else{h=P();if(l(":"))return F(),d=oa(),r.finishProperty("init",h,d,!1,!1);if(l("("))return d=H(),r.finishProperty("init",
h,d,!0,!1);U(F())}}function ea(d){var h=[],a,r,b={},c=String,y=new L;for(!0!==d&&A("{");!l("}");)d=ba(),a=d.key.type===ja.Identifier?d.key.name:c(d.key.value),r="init"===d.kind?Qa.Data:"get"===d.kind?Qa.Get:Qa.Set,a="$"+a,Object.prototype.hasOwnProperty.call(b,a)?(b[a]===Qa.Data?sa&&r===Qa.Data?O(na.StrictDuplicateProperty):r!==Qa.Data&&O(na.AccessorDataProperty):r===Qa.Data?O(na.AccessorDataProperty):b[a]&r&&O(na.AccessorGetSet),b[a]|=r):b[a]=r,h.push(d),l("}")||X();A("}");return y.finishObjectExpression(h)}
function va(){var h,a,r,b;if(l("("))return A("("),l(")")?(F(),a=Ua.ArrowParameterPlaceHolder):(++ha.parenthesisCount,a=ra(),A(")")),a;if(l("[")){a=[];var c=new L;for(A("[");!l("]");)l(",")?(F(),a.push(null)):(a.push(oa()),l("]")||A(","));F();return c.finishArrayExpression(a)}if(l("{"))return ea();h=ga.type;b=new L;if(h===ca.Identifier)r=b.finishIdentifier(F().value);else if(h===ca.StringLiteral||h===ca.NumericLiteral)sa&&ga.octal&&V(ga,na.StrictOctalLiteral),r=b.finishLiteral(F());else if(h===ca.Keyword){if(d("function")){b=
null;var y;r=[];var e=[],f,H=new L;aa("function");l("(")||(b=pa());y=Da(a);r=y.params;e=y.defaults;h=y.stricted;a=y.firstRestricted;y.message&&(c=y.message);f=sa;y=Fa();sa&&a&&U(a,c);sa&&h&&V(h,c);sa=f;return H.finishFunctionExpression(b,r,e,y)}d("this")?(F(),r=b.finishThisExpression()):U(F())}else h===ca.BooleanLiteral?(a=F(),a.value="true"===a.value.toLowerCase(),r=b.finishLiteral(a)):h===ca.NullLiteral?(a=F(),a.value=null,r=b.finishLiteral(a)):l("/")||l("/\x3d")?(r="undefined"!==typeof Y.tokens?
b.finishLiteral(z()):b.finishLiteral(C()),D()):U(F());return r}function N(){var d=[];A("(");if(!l(")"))for(;R<qa;){d.push(oa());if(l(")"))break;X()}A(")");return d}function Ca(){A(".");var d,h=new L;d=F();d.type===ca.Identifier||d.type===ca.Keyword||d.type===ca.BooleanLiteral||d.type===ca.NullLiteral||U(d);return h.finishIdentifier(d.value)}function ma(){var d;A("[");d=ra();A("]");return d}function wa(){var h,a,r=new L;aa("new");var b;g(ha.allowIn,"callee of new expression always allow in keyword.");
b=ga;for(h=d("new")?wa():va();;)if(l("["))a=ma(),h=(new M(b)).finishMemberExpression("[",h,a);else if(l("."))a=Ca(),h=(new M(b)).finishMemberExpression(".",h,a);else break;a=l("(")?N():[];return r.finishNewExpression(h,a)}function xa(){var h,a,b=ga,c,y=ha.allowIn;a=ga;ha.allowIn=!0;for(h=d("new")?wa():va();;)if(l("."))c=Ca(),h=(new M(a)).finishMemberExpression(".",h,c);else if(l("("))c=N(),h=(new M(a)).finishCallExpression(h,c);else if(l("["))c=ma(),h=(new M(a)).finishMemberExpression("[",h,c);else break;
ha.allowIn=y;ga.type!==ca.Punctuator||!l("++")&&!l("--")||Q()||(r(h)||O(na.InvalidLHSInAssignment),a=F(),h=(new M(b)).finishPostfixExpression(a.value,h));return h}function ya(){var h,a,b;ga.type!==ca.Punctuator&&ga.type!==ca.Keyword?a=xa():l("++")||l("--")?(b=ga,h=F(),a=ya(),r(a)||O(na.InvalidLHSInAssignment),a=(new M(b)).finishUnaryExpression(h.value,a)):l("+")||l("-")||l("~")||l("!")?(b=ga,h=F(),a=ya(),a=(new M(b)).finishUnaryExpression(h.value,a)):d("delete")||d("void")||d("typeof")?(b=ga,h=F(),
a=ya(),a=(new M(b)).finishUnaryExpression(h.value,a),sa&&"delete"===a.operator&&a.argument.type===ja.Identifier&&O(na.StrictDelete)):a=xa();return a}function la(d,h){var a=0;if(d.type!==ca.Punctuator&&d.type!==ca.Keyword)return 0;switch(d.value){case "||":a=1;break;case "\x26\x26":a=2;break;case "|":a=3;break;case "^":a=4;break;case "\x26":a=5;break;case "\x3d\x3d":case "!\x3d":case "\x3d\x3d\x3d":case "!\x3d\x3d":a=6;break;case "\x3c":case "\x3e":case "\x3c\x3d":case "\x3e\x3d":case "instanceof":a=
7;break;case "in":a=h?7:0;break;case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":a=8;break;case "+":case "-":a=9;break;case "*":case "/":case "%":a=11}return a}function ua(){var d,h,a,l,r,b;d=ga;h=ya();if(h===Ua.ArrowParameterPlaceHolder)return h;a=ga;l=la(a,ha.allowIn);if(0===l)return h;a.prec=l;F();d=[d,ga];b=ya();for(r=[h,a,b];0<(l=la(ga,ha.allowIn));){for(;2<r.length&&l<=r[r.length-2].prec;)b=r.pop(),a=r.pop().value,h=r.pop(),d.pop(),h=(new M(d[d.length-1])).finishBinaryExpression(a,h,b),r.push(h);
a=F();a.prec=l;r.push(a);d.push(ga);h=ya();r.push(h)}l=r.length-1;h=r[l];for(d.pop();1<l;)h=(new M(d.pop())).finishBinaryExpression(r[l-1].value,r[l-2],h),l-=2;return h}function Ea(d){var h,a,l,r,b,c,y;r=[];b=[];c=0;y={paramSet:{}};h=0;for(a=d.length;h<a;h+=1)if(l=d[h],l.type===ja.Identifier)r.push(l),b.push(null),Ma(y,l,l.name);else if(l.type===ja.AssignmentExpression)r.push(l.left),b.push(l.right),++c,Ma(y,l.left,l.left.name);else return null;y.message===na.StrictParamDupe&&(d=sa?y.stricted:y.firstRestricted,
U(d,y.message));0===c&&(b=[]);return{params:r,defaults:b,rest:null,stricted:y.stricted,firstRestricted:y.firstRestricted,message:y.message}}function oa(){var d,h,a,b,c;d=ha.parenthesisCount;h=c=ga;var y,e;e=ga;a=ua();a!==Ua.ArrowParameterPlaceHolder&&l("?")&&(F(),y=ha.allowIn,ha.allowIn=!0,h=oa(),ha.allowIn=y,A(":"),y=oa(),a=(new M(e)).finishConditionalExpression(a,h,y));if(a===Ua.ArrowParameterPlaceHolder||l("\x3d\x3e"))if(ha.parenthesisCount===d||ha.parenthesisCount===d+1)if(a.type===ja.Identifier?
b=Ea([a]):a.type===ja.AssignmentExpression?b=Ea([a]):a.type===ja.SequenceExpression?b=Ea(a.expressions):a===Ua.ArrowParameterPlaceHolder&&(b=Ea([])),b)return d=b,c=new M(c),A("\x3d\x3e"),b=sa,a=l("{")?Fa():oa(),sa&&d.firstRestricted&&U(d.firstRestricted,d.message),sa&&d.stricted&&V(d.stricted,d.message),sa=b,c.finishArrowFunctionExpression(d.params,d.defaults,a,a.type!==ja.BlockStatement);ga.type!==ca.Punctuator?d=!1:(d=ga.value,d="\x3d"===d||"*\x3d"===d||"/\x3d"===d||"%\x3d"===d||"+\x3d"===d||"-\x3d"===
d||"\x3c\x3c\x3d"===d||"\x3e\x3e\x3d"===d||"\x3e\x3e\x3e\x3d"===d||"\x26\x3d"===d||"^\x3d"===d||"|\x3d"===d);d&&(r(a)||O(na.InvalidLHSInAssignment),h=F(),d=oa(),a=(new M(c)).finishAssignmentExpression(h.value,a,d));return a}function ra(){var d,h=ga;d=oa();if(l(",")){for(d=[d];R<qa&&l(",");)F(),d.push(oa());d=(new M(h)).finishSequenceExpression(d)}return d}function pa(){var d,h=new L;d=F();d.type!==ca.Identifier&&U(d);return h.finishIdentifier(d.value)}function Ia(d){var h=null,a,r=new L;a=pa();"const"===
d?(A("\x3d"),h=oa()):l("\x3d")&&(F(),h=oa());return r.finishVariableDeclarator(a,h)}function fa(d){var h=[];do{h.push(Ia(d));if(!l(","))break;F()}while(R<qa);return h}function za(a){var b=ga.type,c,y;b===ca.EOF&&U(ga);if(b===ca.Punctuator&&"{"===ga.value){if(a){A("{");var e=ga;a=R;c=ka;y=ia;F();b=l(":");ga=e;R=a;ka=c;ia=y;if((ga.type===ca.Identifier||ga.type===ca.StringLiteral)&&b)return ea(!0);a=new L;for(c=[];R<qa&&!l("}");){y=Ja();if("undefined"===typeof y)break;c.push(y)}A("}");return a.finishBlockStatement(c)}return ea()}a=
new L;if(b===ca.Punctuator)switch(ga.value){case ";":return a=new L,A(";"),a.finishEmptyStatement();case "(":return c=ra(),h(),a.finishExpressionStatement(c)}else if(b===ca.Keyword)switch(ga.value.toLowerCase()){case "break":return c=null,aa("break"),59===Z.charCodeAt(R)?(F(),ha.inIteration||ha.inSwitch||T(na.IllegalBreak),a=a.finishBreakStatement(null)):Q()?(ha.inIteration||ha.inSwitch||T(na.IllegalBreak),a=a.finishBreakStatement(null)):(ga.type===ca.Identifier&&(c=pa(),y="$"+c.name,Object.prototype.hasOwnProperty.call(ha.labelSet,
y)||T(na.UnknownLabel,c.name)),h(),null!==c||ha.inIteration||ha.inSwitch||T(na.IllegalBreak),a=a.finishBreakStatement(c)),a;case "continue":return c=null,aa("continue"),59===Z.charCodeAt(R)?(F(),ha.inIteration||T(na.IllegalContinue),a=a.finishContinueStatement(null)):Q()?(ha.inIteration||T(na.IllegalContinue),a=a.finishContinueStatement(null)):(ga.type===ca.Identifier&&(c=pa(),y="$"+c.name,Object.prototype.hasOwnProperty.call(ha.labelSet,y)||T(na.UnknownLabel,c.name)),h(),null!==c||ha.inIteration||
T(na.IllegalContinue),a=a.finishContinueStatement(c)),a;case "for":var f,H,k;H=ha.allowIn;f=b=e=null;aa("for");A("(");if(l(";"))F();else{if(d("var")){ha.allowIn=!1;var g=new L;f=F();k=fa();f=g.finishVariableDeclaration(k,f.value);ha.allowIn=H;1===f.declarations.length&&d("in")&&(F(),c=f,y=ra(),f=null)}else ha.allowIn=!1,f=ra(),ha.allowIn=H,d("in")&&(r(f)||O(na.InvalidLHSInForIn),F(),c=f,y=ra(),f=null);"undefined"===typeof c&&A(";")}"undefined"===typeof c&&(l(";")||(b=ra()),A(";"),l(")")||(e=ra()));
A(")");k=ha.inIteration;ha.inIteration=!0;H=za(!0);ha.inIteration=k;return"undefined"===typeof c?a.finishForStatement(f,b,e,H):a.finishForInStatement(c,y,H);case "function":return Pa(a);case "if":return aa("if"),A("("),c=ra(),A(")"),y=za(!0),d("else")?(F(),b=za(!0)):b=null,a.finishIfStatement(c,y,b);case "return":return c=null,aa("return"),ha.inFunctionBody||O(na.IllegalReturn),32===Z.charCodeAt(R)&&u(Z.charCodeAt(R+1))?(c=ra(),h(),a=a.finishReturnStatement(c)):Q()?a=a.finishReturnStatement(null):
(l(";")||l("}")||ga.type===ca.EOF||(c=ra()),h(),a=a.finishReturnStatement(c)),a;case "var":return aa("var"),c=fa(),h(),a.finishVariableDeclaration(c,"var")}c=ra();if(c.type===ja.Identifier&&l(":"))return F(),b="$"+c.name,Object.prototype.hasOwnProperty.call(ha.labelSet,b)&&T(na.Redeclaration,"Label",c.name),ha.labelSet[b]=!0,y=za(!1),delete ha.labelSet[b],a.finishLabeledStatement(c,y);h();return a.finishExpressionStatement(c)}function Fa(){var d,h=[],a,r,b,c,y,e=new L;for(A("{");R<qa&&ga.type===ca.StringLiteral;){a=
ga;d=Ja();h.push(d);if(d.expression.type!==ja.Literal)break;d=Z.slice(a.start+1,a.end-1);"use strict"===d?(sa=!0,r&&V(r,na.StrictOctalLiteral)):!r&&a.octal&&(r=a)}a=ha.labelSet;r=ha.inIteration;b=ha.inSwitch;c=ha.inFunctionBody;y=ha.parenthesizedCount;ha.labelSet={};ha.inIteration=!1;ha.inSwitch=!1;ha.inFunctionBody=!0;for(ha.parenthesizedCount=0;R<qa&&!l("}");){d=Ja();if("undefined"===typeof d)break;h.push(d)}A("}");ha.labelSet=a;ha.inIteration=r;ha.inSwitch=b;ha.inFunctionBody=c;ha.parenthesizedCount=
y;return e.finishBlockStatement(h)}function Ma(d,h,a){a="$"+a;sa?Object.prototype.hasOwnProperty.call(d.paramSet,a)&&(d.stricted=h,d.message=na.StrictParamDupe):!d.firstRestricted&&Object.prototype.hasOwnProperty.call(d.paramSet,a)&&(d.firstRestricted=h,d.message=na.StrictParamDupe);d.paramSet[a]=!0}function Da(d){d={params:[],defaultCount:0,defaults:[],firstRestricted:d};A("(");if(!l(")"))for(d.paramSet={};R<qa;){var h=d,a=void 0,r=void 0,b=void 0,a=ga,r=pa();Ma(h,a,a.value);l("\x3d")&&(F(),b=oa(),
++h.defaultCount);h.params.push(r);h.defaults.push(b);if(l(")"))break;A(",")}A(")");0===d.defaultCount&&(d.defaults=[]);return{params:d.params,defaults:d.defaults,stricted:d.stricted,firstRestricted:d.firstRestricted,message:d.message}}function Pa(){var d,h=[],a=[],l,r,b,c,y,e=new L;aa("function");d=pa();l=Da(b);h=l.params;a=l.defaults;r=l.stricted;b=l.firstRestricted;l.message&&(c=l.message);y=sa;l=Fa();sa&&b&&U(b,c);sa&&r&&V(r,c);sa=y;return e.finishFunctionDeclaration(d,h,a,l)}function Ja(){if(ga.type===
ca.Keyword)return"function"===ga.value.toLowerCase()?Pa():za(!1);if(ga.type!==ca.EOF)return za(!1)}function Ta(){var d,h,a,l=[];for(d=0;d<Y.tokens.length;++d)h=Y.tokens[d],a={type:h.type,value:h.value},h.regex&&(a.regex={pattern:h.regex.pattern,flags:h.regex.flags}),Y.range&&(a.range=h.range),Y.loc&&(a.loc=h.loc),l.push(a);Y.tokens=l}var ca,Ga,Oa,ja,Ua,Qa,na,fb,Z,sa,R,ka,ia,qa,ga,ha,Y;ca={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};
Ga={};Ga[ca.BooleanLiteral]="Boolean";Ga[ca.EOF]="\x3cend\x3e";Ga[ca.Identifier]="Identifier";Ga[ca.Keyword]="Keyword";Ga[ca.NullLiteral]="Null";Ga[ca.NumericLiteral]="Numeric";Ga[ca.Punctuator]="Punctuator";Ga[ca.StringLiteral]="String";Ga[ca.RegularExpression]="RegularExpression";Oa="( { [ in typeof instanceof new return case delete throw void \x3d +\x3d -\x3d *\x3d /\x3d %\x3d \x3c\x3c\x3d \x3e\x3e\x3d \x3e\x3e\x3e\x3d \x26\x3d |\x3d ^\x3d , + - * / % ++ -- \x3c\x3c \x3e\x3e \x3e\x3e\x3e \x26 | ^ ! ~ \x26\x26 || ? : \x3d\x3d\x3d \x3d\x3d \x3e\x3d \x3c\x3d \x3c \x3e !\x3d !\x3d\x3d".split(" ");
ja={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",
FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator"};Ua={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}};
Qa={Data:1,Get:2,Set:4};na={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",
MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",
StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",
AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};fb={NonAsciiIdentifierStart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/,
NonAsciiIdentifierPart:/[\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]/};
M.prototype=L.prototype={processComment:function(){var d,h,a,l=Y.bottomRightStack,r,b,c=l[l.length-1];if(!(this.type===ja.Program&&0<this.body.length)){if(0<Y.trailingComments.length){a=[];for(r=Y.trailingComments.length-1;0<=r;--r)b=Y.trailingComments[r],b.range[0]>=this.range[1]&&(a.unshift(b),Y.trailingComments.splice(r,1));Y.trailingComments=[]}else c&&c.trailingComments&&c.trailingComments[0].range[0]>=this.range[1]&&(a=c.trailingComments,delete c.trailingComments);if(c)for(;c&&c.range[0]>=this.range[0];)d=
c,c=l.pop();if(d)d.leadingComments&&d.leadingComments[d.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=d.leadingComments,d.leadingComments=void 0);else if(0<Y.leadingComments.length)for(h=[],r=Y.leadingComments.length-1;0<=r;--r)b=Y.leadingComments[r],b.range[1]<=this.range[0]&&(h.unshift(b),Y.leadingComments.splice(r,1));h&&0<h.length&&(this.leadingComments=h);a&&0<a.length&&(this.trailingComments=a);l.push(this)}},finish:function(){Y.range&&(this.range[1]=R);Y.loc&&(this.loc.end=
new I,Y.source&&(this.loc.source=Y.source));Y.attachComment&&this.processComment()},finishArrayExpression:function(d){this.type=ja.ArrayExpression;this.elements=d;this.finish();return this},finishAssignmentExpression:function(d,h,a){this.type=ja.AssignmentExpression;this.operator=d;this.left=h;this.right=a;this.finish();return this},finishBinaryExpression:function(d,h,a){this.type="||"===d||"\x26\x26"===d?ja.LogicalExpression:ja.BinaryExpression;this.operator=d;this.left=h;this.right=a;this.finish();
return this},finishBlockStatement:function(d){this.type=ja.BlockStatement;this.body=d;this.finish();return this},finishBreakStatement:function(d){this.type=ja.BreakStatement;this.label=d;this.finish();return this},finishCallExpression:function(d,h){this.type=ja.CallExpression;this.callee=d;this.arguments=h;this.finish();return this},finishConditionalExpression:function(d,h,a){this.type=ja.ConditionalExpression;this.test=d;this.consequent=h;this.alternate=a;this.finish();return this},finishContinueStatement:function(d){this.type=
ja.ContinueStatement;this.label=d;this.finish();return this},finishEmptyStatement:function(){this.type=ja.EmptyStatement;this.finish();return this},finishExpressionStatement:function(d){this.type=ja.ExpressionStatement;this.expression=d;this.finish();return this},finishForStatement:function(d,h,a,l){this.type=ja.ForStatement;this.init=d;this.test=h;this.update=a;this.body=l;this.finish();return this},finishForInStatement:function(d,h,a){this.type=ja.ForInStatement;this.left=d;this.right=h;this.body=
a;this.each=!1;this.finish();return this},finishFunctionDeclaration:function(d,h,a,l){this.type=ja.FunctionDeclaration;this.id=d;this.params=h;this.defaults=a;this.body=l;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishFunctionExpression:function(d,h,a,l){this.type=ja.FunctionExpression;this.id=d;this.params=h;this.defaults=a;this.body=l;this.rest=null;this.expression=this.generator=!1;this.finish();return this},finishIdentifier:function(d){this.type=ja.Identifier;
this.name=d;this.finish();return this},finishIfStatement:function(d,h,a){this.type=ja.IfStatement;this.test=d;this.consequent=h;this.alternate=a;this.finish();return this},finishLiteral:function(d){this.type=ja.Literal;this.value=d.value;this.raw=Z.slice(d.start,d.end);d.regex&&(this.regex=d.regex);this.finish();return this},finishMemberExpression:function(d,h,a){this.type=ja.MemberExpression;this.computed="["===d;this.object=h;this.property=a;this.finish();return this},finishObjectExpression:function(d){this.type=
ja.ObjectExpression;this.properties=d;this.finish();return this},finishPostfixExpression:function(d,h){this.type=ja.UpdateExpression;this.operator=d;this.argument=h;this.prefix=!1;this.finish();return this},finishProgram:function(d){this.type=ja.Program;this.body=d;this.finish();return this},finishProperty:function(d,h,a,l,r){this.type=ja.Property;this.key=h;this.value=a;this.kind=d;this.method=l;this.shorthand=r;this.finish();return this},finishReturnStatement:function(d){this.type=ja.ReturnStatement;
this.argument=d;this.finish();return this},finishUnaryExpression:function(d,h){this.type="++"===d||"--"===d?ja.UpdateExpression:ja.UnaryExpression;this.operator=d;this.argument=h;this.prefix=!0;this.finish();return this},finishVariableDeclaration:function(d,h){this.type=ja.VariableDeclaration;this.declarations=d;this.kind=h;this.finish();return this},finishVariableDeclarator:function(d,h){this.type=ja.VariableDeclarator;this.id=d;this.init=h;this.finish();return this}};p.version="2.0.0-dev";p.tokenize=
function(d,h){var a,l;a=String;"string"===typeof d||d instanceof String||(d=a(d));Z=d;R=0;ka=0<Z.length?1:0;ia=0;qa=Z.length;ga=null;ha={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1};Y={};h=h||{};h.tokens=!0;Y.tokens=[];Y.tokenize=!0;Y.openParenToken=-1;Y.openCurlyToken=-1;Y.range="boolean"===typeof h.range&&h.range;Y.loc="boolean"===typeof h.loc&&h.loc;"boolean"===typeof h.comment&&h.comment&&(Y.comments=[]);"boolean"===typeof h.tolerant&&h.tolerant&&(Y.errors=
[]);try{D();if(ga.type===ca.EOF)return Y.tokens;for(F();ga.type!==ca.EOF;)try{F()}catch(Ya){if(Y.errors){Y.errors.push(Ya);break}else throw Ya;}Ta();l=Y.tokens;"undefined"!==typeof Y.comments&&(l.comments=Y.comments);"undefined"!==typeof Y.errors&&(l.errors=Y.errors)}catch(Ya){throw Ya;}finally{Y={}}return l};p.parse=function(d,h){var l,r;r=String;"string"===typeof d||d instanceof String||(d=r(d));Z=d;R=0;ka=0<Z.length?1:0;ia=0;qa=Z.length;ga=null;ha={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,
inIteration:!1,inSwitch:!1,lastCommentStart:-1};Y={};"undefined"!==typeof h&&(Y.range="boolean"===typeof h.range&&h.range,Y.loc="boolean"===typeof h.loc&&h.loc,Y.attachComment="boolean"===typeof h.attachComment&&h.attachComment,Y.loc&&null!==h.source&&void 0!==h.source&&(Y.source=r(h.source)),"boolean"===typeof h.tokens&&h.tokens&&(Y.tokens=[]),"boolean"===typeof h.comment&&h.comment&&(Y.comments=[]),"boolean"===typeof h.tolerant&&h.tolerant&&(Y.errors=[]),Y.attachComment&&(Y.range=!0,Y.comments=
[],Y.bottomRightStack=[],Y.trailingComments=[],Y.leadingComments=[]));try{var b;a();D();b=new L;sa=!1;var c;d=[];for(var y,e,f;R<qa;){y=ga;if(y.type!==ca.StringLiteral)break;c=Ja();d.push(c);if(c.expression.type!==ja.Literal)break;e=Z.slice(y.start+1,y.end-1);"use strict"===e?(sa=!0,f&&V(f,na.StrictOctalLiteral)):!f&&y.octal&&(f=y)}for(;R<qa;){c=Ja();if("undefined"===typeof c)break;d.push(c)}l=b.finishProgram(d);"undefined"!==typeof Y.comments&&(l.comments=Y.comments);"undefined"!==typeof Y.tokens&&
(Ta(),l.tokens=Y.tokens);"undefined"!==typeof Y.errors&&(l.errors=Y.errors)}catch(bb){throw bb;}finally{Y={}}return l};p.Syntax=function(){var d,h={};"function"===typeof Object.create&&(h=Object.create(null));for(d in ja)ja.hasOwnProperty(d)&&(h[d]=ja[d]);"function"===typeof Object.freeze&&Object.freeze(h);return h}()})},"esri/arcadeProfiles/visualizationProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../support/expressionUtils ./utils".split(" "),
function(p,g,t,v,n,m,u){return new (p(null,{declaredClass:"esri.arcadeProfiles.VisualizationProfile",initialize:function(k){var f=[];u.hasGeometryOperations(k)&&f.push(m.enableGeometryOperations());return n(f)}}))})},"esri/promiseList":function(){define(["dojo/_base/array","dojo/Deferred","dojo/when"],function(p,g,t){var v=p.forEach;return function(n){function m(b,e){f[e]=b;a.progress([b,e]);0===--c&&a.resolve(f)}var u,k;n instanceof Array?k=n:n&&"object"===typeof n&&(u=n);var f,e=[];if(u){k=[];for(var b in u)Object.hasOwnProperty.call(u,
b)&&(e.push(b),k.push(u[b]));f={}}else k&&(f=[]);if(!k||!k.length)return(new g).resolve(f);var a=new g;a.promise.always(function(){f=e=null});var c=k.length;v(k,function(b,c){u||e.push(c);t(b,function(b){a.isFulfilled()||m(b,e[c])},function(b){a.isFulfilled()||m(b,e[c])})});return a.promise}})},"esri/arcadeProfiles/utils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../kernel","../support/expressionUtils"],function(p,g,t,v,n){var m=/(\/(MapServer|FeatureServer)).*/ig;return{hasGeometryOperations:function(m){return g.some(m,
function(k){return k.hasGeometryOperations?k.hasGeometryOperations():n.hasGeometryOperations(k)})},hasFeatureSetOperations:function(m){return g.some(m,function(k){return k.hasFeatureSetOperations?k.hasFeatureSetOperations():n.hasFeatureSetOperations(k)})},hasVariables:function(m,k){return g.some(m,function(f){return g.some(k,function(e){return f.hasVariable?f.hasVariable(e):n.hasVariable(f,e)})})},isAsync:function(m){return g.some(m,function(k){return k.async})},getServiceUrl:function(g){return m.test(g)?
g.replace(m,"$1"):null}}})},"esri/renderers/UniqueValueRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),function(p,g,t,v,n,m,u,k,f){return p(k,{declaredClass:"esri.renderer.UniqueValueRenderer",constructor:function(e,b,a,c,f){this.values=[];this._symbols={};this.infos=[];e&&!e.declaredClass?(b=e,this.defaultSymbol=(e=b.defaultSymbol)&&(e.declaredClass?e:u.fromJson(e)),
this.attributeField=b.field1,this.attributeField2=b.field2,this.attributeField3=b.field3,this.fieldDelimiter=b.fieldDelimiter,this.defaultLabel=b.defaultLabel,this.setValueExpression(b.valueExpression),this.valueExpressionTitle=b.valueExpressionTitle,this.legendOptions=b.legendOptions,b.backgroundFillSymbol&&(this.backgroundFillSymbol=u.fromJson(b.backgroundFillSymbol)),g.forEach(b.uniqueValueInfos,this._addValueInfo,this)):(this.defaultSymbol=e,this.attributeField=b,this.attributeField2=a,this.attributeField3=
c,this.fieldDelimiter=f);this._multiple=!!this.attributeField2},addValue:function(e,b){e=t.isObject(e)?e:{value:e,symbol:b};this._addValueInfo(e)},removeValue:function(e){var b=g.indexOf(this.values,e);-1!==b&&(this.values.splice(b,1),this._hasNullKeyword=this._evalNullKeyword(this.values),delete this._symbols[e],this.infos.splice(b,1))},getUniqueValueInfo:function(e){var b=this.attributeField,a=e.attributes;if(this.valueExpression)b=this._getDataValue(e,this._uvInfo,null,this._cache.uvInfo),b=this._normalizeNullValue(b);
else if(this._multiple){e=this.attributeField2;var c=this.attributeField3,f=[];b&&f.push(this._normalizeNullValue(a[b]));e&&f.push(this._normalizeNullValue(a[e]));c&&f.push(this._normalizeNullValue(a[c]));b=f.join(this.fieldDelimiter||"")}else b=t.isFunction(b)?b(e):a[b],b=this._normalizeNullValue(b);return this._symbols[b]},setValueExpression:function(e){this.valueExpression=e;this._uvInfo={valueExpression:e};this._cache.uvInfo=this._createCache(this._uvInfo,!0)},getFieldsUsedInExpressions:function(){var e=
this.inherited(arguments);this.valueExpression&&(e=e.concat(f.extractFieldNames(this.valueExpression)));e.sort();return g.filter(e,function(b,a){return 0===a||e[a-1]!==b})},getSymbol:function(e){return(e=this.getUniqueValueInfo(e))&&e.symbol||this.defaultSymbol},_addValueInfo:function(e){var b=e.value;this.values.push(b);this._hasNullKeyword=this._evalNullKeyword(this.values);this.infos.push(e);var a=e.symbol;a&&!a.declaredClass&&(e.symbol=u.fromJson(a));this._symbols[b]=e},_nullCode:"\x3cNull\x3e",
_normalizeNullValue:function(e){return this._hasNullKeyword&&null==e?this._nullCode:e},_evalNullKeyword:function(e){var b=this.fieldDelimiter||"",a=new RegExp("(^|"+b+")("+this._nullCode+")("+b+"|$)");return g.some(e,function(b){return a.test(b)})},toJson:function(){var e=m.fixJson,b;b={type:"uniqueValue",field1:this.attributeField,field2:this.attributeField2,field3:this.attributeField3,fieldDelimiter:this.fieldDelimiter,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:t.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),defaultLabel:this.defaultLabel,uniqueValueInfos:g.map(this.infos||[],function(a){a=t.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.value+="";return e(a)})};this.backgroundFillSymbol&&(b.backgroundFillSymbol=this.backgroundFillSymbol.toJson());b=t.mixin(this.inherited(arguments),b);return e(b)}})})},"esri/renderers/ClassBreaksRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../symbols/jsonUtils ./Renderer ../support/expressionUtils".split(" "),
function(p,g,t,v,n,m,u,k,f){return p(k,{declaredClass:"esri.renderer.ClassBreaksRenderer",constructor:function(e,b){this.breaks=[];this._symbols={};this.infos=[];this.isMaxInclusive=!0;if(e&&!e.declaredClass){b=e;this.attributeField=b.field;this.setValueExpression(b.valueExpression);this.valueExpressionTitle=b.valueExpressionTitle;this.legendOptions=b.legendOptions;this.defaultSymbol=(e=b.defaultSymbol)&&(e.declaredClass?e:u.fromJson(e));this.backgroundFillSymbol=(e=b.backgroundFillSymbol)&&(e.declaredClass?
e:u.fromJson(e));this._copy(["defaultLabel","classificationMethod:rest","normalizationType:rest","normalizationField","normalizationTotal"],b,this);var a=b.minValue;(e=b.classBreakInfos)&&e[0]&&m.isDefined(e[0].classMaxValue)&&g.forEach(e,function(b){var c=b.classMaxValue;b.minValue=a;a=b.maxValue=c},this);g.forEach(e,this._addBreakInfo,this)}else this.defaultSymbol=e,this.attributeField=b},addBreak:function(e,b,a){e=t.isObject(e)?e:{minValue:e,maxValue:b,symbol:a};this._addBreakInfo(e)},removeBreak:function(e,
b){var a,c=this.breaks,f,k=c.length,g=this._symbols;for(f=0;f<k;f++)if(a=c[f],a[0]==e&&a[1]==b){c.splice(f,1);delete g[e+"-"+b];this.infos.splice(f,1);break}},clearBreaks:function(){this.breaks=[];this._symbols={};this.infos=[]},getBreakIndex:function(e){var b=this.attributeField,a=e.attributes,c=this.breaks,f=c.length,k=this.isMaxInclusive;if(this.valueExpression)e=this._getDataValue(e,this._cbInfo,null,this._cache.cbInfo);else if(t.isFunction(b))e=b(e);else{e=parseFloat(a[b]);var b=this.normalizationType,
g;if(b)if(g=parseFloat(this.normalizationTotal),a=parseFloat(a[this.normalizationField]),"log"===b)e=Math.log(e)*Math.LOG10E;else if("percent-of-total"===b&&!isNaN(g))e=e/g*100;else if("field"===b){if(isNaN(e)||isNaN(a))return-1;e/=a}}if(null!=e&&!isNaN(e)&&"number"===typeof e)for(a=0;a<f;a++)if(b=c[a],b[0]<=e&&(k?e<=b[1]:e<b[1]))return a;return-1},getBreakInfo:function(e){e=this.getBreakIndex(e);return-1!==e?this.infos[e]:null},getSymbol:function(e){return(e=this.breaks[this.getBreakIndex(e)])?this._symbols[e[0]+
"-"+e[1]]:this.defaultSymbol},setMaxInclusive:function(e){this.isMaxInclusive=e},setValueExpression:function(e){this.valueExpression=e;this._cbInfo={valueExpression:e};this._cache.cbInfo=this._createCache(this._cbInfo)},getFieldsUsedInExpressions:function(){var e=this.inherited(arguments);this.valueExpression&&(e=e.concat(f.extractFieldNames(this.valueExpression)));e.sort();return g.filter(e,function(b,a){return 0===a||e[a-1]!==b})},isContinuousRenderer:function(){var e=!1;if(this.infos&&1===this.infos.length)var b=
this.attributeField,a=this.normalizationField,c=this.valueExpression,e=this.getVisualVariablesForType("colorInfo",!1)||[],f=this.getVisualVariablesForType("sizeInfo",!1)||[],k=this.getVisualVariablesForType("opacityInfo",!1)||[],e=e.concat(f).concat(k),e=g.some(e,function(e){return(e.field===b||e.valueExpression===c)&&e.normalizationField==a});return e},_normalizationTypeEnums:[["field","esriNormalizeByField"],["log","esriNormalizeByLog"],["percent-of-total","esriNormalizeByPercentOfTotal"]],_classificationMethodEnums:[["natural-breaks",
"esriClassifyNaturalBreaks"],["equal-interval","esriClassifyEqualInterval"],["quantile","esriClassifyQuantile"],["standard-deviation","esriClassifyStandardDeviation"],["geometrical-interval","esriClassifyGeometricalInterval"],["defined-interval","esriClassifyDefinedInterval"]],_copy:function(e,b,a){g.forEach(e,function(c){var e=c.split(":"),f,k,g;1<e.length&&(c=e[0],f=this["_"+c+"Enums"],"rest"===e[1]?(k="1",g="0"):"sdk"===e[1]&&(k="0",g="1"));e=b[c];if(void 0!==e&&(a[c]=e,f&&k)){var m,n=f.length;
for(m=0;m<n;m++)if(f[m][k]===e){a[c]=f[m][g];break}}},this)},_addBreakInfo:function(e){var b=e.minValue,a=e.maxValue;this.breaks.push([b,a]);this.infos.push(e);var c=e.symbol;c&&!c.declaredClass&&(e.symbol=u.fromJson(c));this._symbols[b+"-"+a]=e.symbol},toJson:function(){var e=this.infos||[],b=m.fixJson,a=e[0]&&e[0].minValue,c=this.backgroundFillSymbol,e=t.mixin(this.inherited(arguments),{type:"classBreaks",field:this.attributeField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
legendOptions:t.clone(this.legendOptions),defaultSymbol:this.defaultSymbol&&this.defaultSymbol.toJson(),backgroundFillSymbol:c&&c.toJson(),minValue:-Infinity===a?-Number.MAX_VALUE:a,classBreakInfos:g.map(e,function(a){a=t.mixin({},a);a.symbol=a.symbol&&a.symbol.toJson();a.classMaxValue=Infinity===a.maxValue?Number.MAX_VALUE:a.maxValue;delete a.minValue;delete a.maxValue;return b(a)})});this._copy(["defaultLabel","classificationMethod:sdk","normalizationType:sdk","normalizationField","normalizationTotal"],
this,e);e.hasOwnProperty("normalizationType")&&!e.normalizationType&&delete e.normalizationType;e.hasOwnProperty("classificationMethod")&&!e.classificationMethod&&delete e.classificationMethod;return b(e)}})})},"esri/renderers/VectorFieldRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/_base/array ../kernel ../lang ../Color ./Renderer ./ClassBreaksRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/jsonUtils require".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w=p(k,{declaredClass:"esri.renderer.VectorFieldRenderer",iconFolderPath:"../images/symbol/sfs/",constructor:function(a){m.isDefined(a)||(a={});a.attributeField=a.attributeField||"Magnitude";a.rotationInfo=a.rotationInfo||this._getRotationInfo(a);p.safeMixin(this,a);this.setRotationInfo(this.rotationInfo);this.style=this.style||w.STYLE_SINGLE_ARROW;this.singleArrowSymbol&&(this.singleArrowSymbol=this.singleArrowSymbol.declaredClass?this.singleArrowSymbol:c.fromJson(this.singleArrowSymbol));
this.renderer=new f(this._getDefaultSymbol(),a.attributeField);this._updateRenderer(this.style);this.flowRepresentation=this.flowRepresentation||this.FLOW_FROM},getSymbol:function(a){return this.renderer&&this.renderer.getSymbol(a)},setVisualVariables:function(a){a=v.filter(a,function(a){if("sizeInfo"===a.type)return m.isDefined(this._updateSizeInfo(a))},this);this.inherited(arguments);return this},setSizeInfo:function(a){this._updateSizeInfo(a);this.inherited(arguments);return this},setProportionalSymbolInfo:function(a){this.setSizeInfo(a);
return this},setColorInfo:function(a){return this},_updateRenderer:function(a){return m.isDefined(this.renderer)?a===w.STYLE_SINGLE_ARROW?this._createSingleArrowRenderer():a===w.STYLE_BEAUFORT_KN?this._createBeaufortKnotsRenderer():a===w.STYLE_BEAUFORT_METER?this._createBeaufortMeterRenderer():a===w.STYLE_BEAUFORT_FEET?this._createBeaufortFeetRenderer():a===w.STYLE_BEAUFORT_MILE?this._createBeaufortMilesRenderer():a===w.STYLE_BEAUFORT_KM?this._createBeaufortKilometersRenderer():a===w.STYLE_OCEAN_CURRENT_M?
this._createCurrentMeterRenderer():a===w.STYLE_OCEAN_CURRENT_KN?this._createCurrentKnotsRenderer():a===w.STYLE_SCALAR?this._createSimpleScalarRenderer():a===w.STYLE_WIND_BARBS?this._createWindBarbsRenderer():this._createClassifiedArrowRenderer():Error("Invalid Renderer!")},_updateSizeInfo:function(a){return a&&m.isDefined(a.minSize)&&m.isDefined(a.maxSize)&&m.isDefined(a.minDataValue)&&m.isDefined(a.maxDataValue)?(this.style===w.STYLE_WIND_BARBS&&(a.minSize=a.maxSize),a.field=a.field||"Magnitude",
a.type="sizeInfo",a):null},_createClassifiedArrowRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new u([56,168,0]));var a=[0,1E-6,3.5,7,10.5,14];if(m.isDefined(this.minDataValue)&&m.isDefined(this.maxDataValue)){var b=(this.maxDataValue-this.minDataValue)/5,a=[],c,e;e=this.minDataValue;for(c=0;6>c;c++)a[c]=e,e+=b}this._addBreaks(a,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])},_createSingleArrowRenderer:function(){this.renderer.defaultSymbol=this.singleArrowSymbol||
this._getDefaultSymbol()},_createBeaufortMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new u([214,47,39]));this._addBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new u([214,47,39]));this._addBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])},_createBeaufortFeetRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];v.forEach(a,function(b,c){a[c]*=3.28084});this.renderer.defaultSymbol=this._getDefaultSymbol(new u([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],
[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortMilesRenderer:function(){var a=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];v.forEach(a,function(b,c){a[c]*=2.23694});this.renderer.defaultSymbol=this._getDefaultSymbol(new u([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createBeaufortKilometersRenderer:function(){var a=
[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];v.forEach(a,function(b,c){a[c]*=3.6});this.renderer.defaultSymbol=this._getDefaultSymbol(new u([214,47,39]));this._addBreaks(a,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])},_createCurrentMeterRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new u([177,177,177]));this._addBreaks([0,.5,1,1.5,2],[[78,26,
153],[179,27,26],[202,128,26],[177,177,177]])},_createCurrentKnotsRenderer:function(){this.renderer.defaultSymbol=this._getDefaultSymbol(new u([177,177,177]));this._addBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])},_createSimpleScalarRenderer:function(){this.renderer.defaultSymbol=new b({url:x.toUrl(this.iconFolderPath+"scalar.png"),height:20,width:20,type:"esriPMS",angle:0})},_createWindBarbsRenderer:function(){var c=
[],f,k;for(f=0;150>=f;f+=5)c.push(f);k="M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20;M25 0 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40;M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35;M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15;M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L10 15 M25 10 M25 5 L17.5 7.5".split(";");
var g=new b({url:x.toUrl(this.iconFolderPath+"windbarb.png"),height:20,width:20,type:"esriPMS",angle:0});this.renderer.defaultSymbol=g;for(f=0;f<c.length-1;f++)0===f?this.renderer.addBreak({minValue:c[f],maxValue:c[f+1],symbol:g}):this.renderer.addBreak({minValue:c[f],maxValue:c[f+1],symbol:(new e).setPath(k[f]).setOutline((new a).setWidth(1.5)).setSize(20).setColor(new u([0,0,0,255]))})},_getDefaultSymbol:function(b){return(new e).setPath("M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z").setOutline((new a).setWidth(0)).setSize(20).setColor(b||
new u([0,92,230]))},_getRotationInfo:function(a){var b=a&&a.flowRepresentation||w.FLOW_FROM,c=a&&a.rotationField||"Direction",e=w.FLOW_FROM;return{field:function(a){a=a.attributes[c];return b===e?a:a+180},type:"geographic"}},_addBreaks:function(a,b){if(!m.isDefined(this.renderer))return Error("Invalid Renderer!");if(!(a&&b&&a.length&&b.length&&a.length>=b.length))return Error("AddBreaks: Input arguments break values and colors not valid");var c;for(c=0;c<b.length;c++)this.renderer.addBreak({minValue:a[c],
maxValue:a[c+1],symbol:this._getDefaultSymbol(new u(b[c]))})},toJson:function(){var a=g.mixin(this.inherited(arguments),{type:"vectorField",style:this.style,attributeField:this.attributeField,flowRepresentation:this.flowRepresentation});this.renderer&&this.renderer.defaultSymbol&&this.style===w.STYLE_SINGLE_ARROW&&(a.singleArrowSymbol=this.renderer.defaultSymbol.toJson());return m.fixJson(a)}});g.mixin(w,{STYLE_WIND_BARBS:"wind_speed",STYLE_SINGLE_ARROW:"single_arrow",STYLE_CLASSIFIED_ARROW:"classified_arrow",
STYLE_BEAUFORT_KN:"beaufort_kn",STYLE_BEAUFORT_METER:"beaufort_m",STYLE_BEAUFORT_MILE:"beaufort_mi",STYLE_BEAUFORT_FEET:"beaufort_ft",STYLE_BEAUFORT_KM:"beaufort_km",STYLE_OCEAN_CURRENT_M:"ocean_current_m",STYLE_OCEAN_CURRENT_KN:"ocean_current_kn",STYLE_SCALAR:"simple_scalar"},{FLOW_FROM:"flow_from",FLOW_TO:"flow_to"});return w})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/has dojox/gfx/_base ../kernel ../lang ../Color ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){return p(e,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(a){this.dotSize=a.dotSize||3;this.dotValue=a.dotValue;this.fields=a.fields;this.outline=a.outline;this.backgroundColor=a.backgroundColor;this.exactCount=a.exactCount||!0;this.dotShape=a.dotShape||"square";this.legendOptions=a.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(a){var c,e;this._currentGraphic=a;if(!this._supportsCanvas)return null;this._map||(this._map=a.getLayer()._map,this._objectIdField=a.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
g.hitch(this,function(a){this._currentMapScale=this._map.getScale();this._currentResolution=a.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]])return c=this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]],e=this._getShapeProperties(a),c.setOffset(e.dx,e.dy),c;c=this._generateFieldsCount(this.fields,a.attributes,this.dotValue);e=this._getShapeProperties(a);
if(!e.width||!e.height)return null;c=new b(this._generateImageSrc(e.width,e.height,c,e.minXY,e.maxXY),this.outline,e.width,e.height);c.setOffset(e.dx,e.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][a.attributes[this._objectIdField]]=c},_generateFieldsCount:function(a,b,c){var e,f;for(f=a.length-1;0<=f;f--)e=b[a[f].name]/c,a[f].numPoints=Math.round(e);return a},_getShapeProperties:function(a){var b,e,f,k;b=a.geometry.getExtent();
b.contains(this._map.extent)&&(b=this._map.extent);f=Math.ceil(b.getWidth()/this._currentResolution);k=Math.ceil(b.getHeight()/this._currentResolution);e=this._map.toScreen(new c(b.xmin,b.ymin,b.spatialReference));b=this._map.toScreen(new c(b.xmax,b.ymax,b.spatialReference));a=a.getLayer().getNavigationTransform();return{minXY:e,maxXY:b,dx:(e.x-a.dx)%f,dy:(b.y-a.dy)%k,width:f,height:k}},_generateImageSrc:function(a,b,c,e,f,k){var g=this.dotSize,q,m,w;this._canvas?(this._canvas.width=a,this._canvas.height=
b):this._canvas=this._initCanvas(a,b);q=this._canvas.getContext("2d");if(k=k||this.backgroundColor)q.fillStyle=k.toCss(!0),q.fillRect(0,0,a,b),q.fill();for(k=c.length-1;0<=k;k--)for(q.fillStyle=c[k].color.toCss(!0),m=c[k].numPoints-1;0<=m;m--)w=this._getRandomPoint(a,b,e,f),"square"===this.dotShape?q.fillRect(w.x,w.y,g,g):"circle"===this.dotShape&&(q.beginPath(),q.arc(w.x,w.y,g/2,0,2*Math.PI,!0)),q.fill();return this._canvas.toDataURL()},_initCanvas:function(a,b){a=v.create("canvas",{id:"canvas",
width:a+"px",height:b+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);document.body.appendChild(a);return a},_getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},_getRandomPoint:function(b,c,e,f){var k={},g=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&b*c>this._exactCountMinArea){b=!1;do k.x=this._getRandomInt(e.x,f.x),k.y=this._getRandomInt(f.y,e.y),b=new a(k.x,k.y),b=this._checkPointShapeBounds(b,this.dotSize+g,this._currentGraphic.geometry),
!0===b&&(k.x-=e.x,k.y-=f.y);while(!1===b)}else k.x=this._getRandomInt(0,b),k.y=this._getRandomInt(0,c);return k},_checkPointShapeBounds:function(a,b,c){var e=null,e=!1,f=!0,k=0;do{switch(k){case 1:a.x+=b;break;case 2:a.y+=b;break;case 3:a.x-=b}e=this._map.toMap(a);e=c.contains(e);!1===e&&(f=!1);k+=1}while(3>=k&&!0===f);return e},setDotSize:function(a){0<a&&(this.dotSize=a)},setDotValue:function(a){0<a&&(this.dotValue=a)},setOutline:function(a){this.outline=a},setBackgroundColor:function(a){this.backgroundColor=
a},toJson:function(){var a=g.mixin(this.inherited(arguments),{type:"dotDensity",backgroundColor:f.toJsonColor(this.backgroundColor),dotShape:this.dotShape,dotSize:0<this.dotSize?m.px2pt(this.dotSize):0,dotValue:this.dotValue,fields:t.map(this.fields,function(a){return k.fixJson({color:f.toJsonColor(a.color),name:a.name})}),legendOptions:this.legendOptions&&k.fixJson({backgroundColor:f.toJsonColor(this.legendOptions.backgroundColor),dotCoverage:this.legendOptions.dotCoverage,outline:this.legendOptions.outline&&
this.legendOptions.outline.toJson(),valueUnit:this.legendOptions.valueUnit}),outline:this.outline&&this.outline.toJson()});return k.fixJson(a)}})})},"esri/renderers/ScaleDependentRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ./Renderer".split(" "),function(p,g,t,v,n,m,u){return p(u,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(k){this.setRendererInfos(k&&k.rendererInfos||[])},setRendererInfos:function(k){this.rendererInfos=
k;this._setRangeType();return this},getSymbol:function(k){var f=this.getRendererInfo(k);return f&&f.renderer&&f.renderer.getSymbol(k)},getRendererInfo:function(k){k=k.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(k.getZoom()):this.getRendererInfoByScale(k.getScale())},getRendererInfoByZoom:function(k){var f,e=this.rendererInfos,b,a=0;do f=e[a],k>=f.minZoom&&k<=f.maxZoom&&(b=f),a++;while(!b&&a<e.length);return b},getRendererInfoByScale:function(k){var f,e=this.rendererInfos,
b,a=0,c,g,m,q;do f=e[a],c=f.minScale,g=f.maxScale,m=!c,q=!g,!m&&k<=c&&(m=!0),!q&&k>=g&&(q=!0),m&&q&&(b=f),a++;while(!b&&a<e.length);return b},addRendererInfo:function(k){var f,e=0,b,a=this.rendererInfos,c=k.hasOwnProperty("minZoom")?"minZoom":"minScale",g=a.length;do{b=a[e];if(g===e||k[c]<b[c])a.splice(e,0,k),this._setRangeType(),f=!0;e++}while(!f&&e<g);return this},_setRangeType:function(){var k=this.rendererInfos;if(k=k&&k[0])this.rangeType=k.hasOwnProperty("minZoom")?"zoom":k.hasOwnProperty("minScale")?
"scale":""},toJson:function(){if("zoom"===this.rangeType)return null;var k=this.rendererInfos||[],f=k[0]&&k[0].minScale,k=t.mixin(this.inherited(arguments),{type:"scaleDependent",minScale:0<f?f:0,rendererInfos:g.map(k,function(e){return m.fixJson({maxScale:0<e.maxScale?e.maxScale:0,renderer:e.renderer&&e.renderer.toJson()})})});return m.fixJson(k)}})})},"esri/renderers/TimeClassBreaksAger":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has dojo/date ../kernel ../lang ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),
function(p,g,t,v,n,m,u,k,f,e){var b=p(e,{declaredClass:"esri.renderer.TimeClassBreaksAger",constructor:function(a,b){this.infos=a;this.timeUnits=b||"day";a.sort(function(a,b){return a.minAge<b.minAge?-1:a.minAge>b.minAge?1:0})},getAgedSymbol:function(a,b){var c=b.getLayer();b=b.attributes;var e=u.isDefined;a=k.fromJson(a.toJson());var f=c._map.timeExtent.endTime;if(!f)return a;var m=n.difference(new Date(b[c._startTimeField]),f,this.timeUnits);g.some(this.infos,function(b){if(m>=b.minAge&&m<=b.maxAge){var c=
b.color,f=b.size;b=b.alpha;c&&a.setColor(c);e(f)&&this._setSymbolSize(a,f);e(b)&&a.color&&(a.color.a=b);return!0}},this);return a},toJson:function(){var a={agerClassBreakInfos:[]},b,e,k;a.timeUnits=this._getRestUnits(this.timeUnits);for(b=0;b<this.infos.length;b+=1)e=this.infos[b],k={},k.oldestAge=Infinity===e.maxAge?null:e.maxAge,k.size=e.size,e.color&&(k.color=f.toJsonColor(e.color)),e.alpha&&(k.alpha=Math.round(255*e.alpha)),a.agerClassBreakInfos[b]=k;return a},_getRestUnits:function(a){var c=
"esriTimeUnitsDays";switch(a){case b.UNIT_SECONDS:c="esriTimeUnitsSeconds";break;case b.UNIT_MILLISECONDS:c="esriTimeUnitsMilliseconds";break;case b.UNIT_HOURS:c="esriTimeUnitsHours";break;case b.UNIT_MINUTES:c="esriTimeUnitsMinutes";break;case b.UNIT_MONTHS:c="esriTimeUnitsMonths";break;case b.UNIT_WEEKS:c="esriTimeUnitsWeeks";break;case b.UNIT_YEARS:c="esriTimeUnitsYears"}return c}});t.mixin(b,{UNIT_DAYS:"day",UNIT_HOURS:"hour",UNIT_MILLISECONDS:"millisecond",UNIT_MINUTES:"minute",UNIT_MONTHS:"month",
UNIT_SECONDS:"second",UNIT_WEEKS:"week",UNIT_YEARS:"year"});return b})},"esri/renderers/SymbolAger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p(null,{declaredClass:"esri.renderer.SymbolAger",getAgedSymbol:function(g,m){},_setSymbolSize:function(g,m){switch(g.type){case "simplemarkersymbol":g.setSize(m);break;case "picturemarkersymbol":g.setWidth(m);g.setHeight(m);break;case "simplelinesymbol":case "cartographiclinesymbol":g.setWidth(m);
break;case "simplefillsymbol":case "picturefillsymbol":g.outline&&g.outline.setWidth(m)}}})})},"esri/renderers/TimeRampAger":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/has ../kernel ../symbols/jsonUtils ../Color ./SymbolAger".split(" "),function(p,g,t,v,n,m,u,k){return p(k,{declaredClass:"esri.renderer.TimeRampAger",constructor:function(f,e,b){this.colorRange=f;this.sizeRange=e;this.alphaRange=b},getAgedSymbol:function(f,e){var b=e.getLayer(),a=e.attributes;f=m.fromJson(f.toJson());
var c=b._map.timeExtent;e=c.startTime;c=c.endTime;if(!e||!c)return f;e=e.getTime();c=c.getTime();b=new Date(a[b._startTimeField]);b=b.getTime();b<e&&(b=e);b=c===e?1:(b-e)/(c-e);if(e=this.sizeRange)a=e[0],c=e[1],e=Math.abs(c-a)*b,this._setSymbolSize(f,a<c?a+e:a-e);if(e=this.colorRange){var c=e[0],k=e[1],g=Math.round,a=new t,q=c.r,n=k.r;e=Math.abs(n-q)*b;a.r=g(q<n?q+e:q-e);q=c.g;n=k.g;e=Math.abs(n-q)*b;a.g=g(q<n?q+e:q-e);q=c.b;n=k.b;e=Math.abs(n-q)*b;a.b=g(q<n?q+e:q-e);c=c.a;k=k.a;e=Math.abs(k-c)*b;
a.a=c<k?c+e:c-e;f.setColor(a)}a=f.color;(e=this.alphaRange)&&a&&(c=e[0],k=e[1],e=Math.abs(k-c)*b,a.a=c<k?c+e:c-e);return f},toJson:function(){var f={};this.sizeRange&&(f.sizeRange=this.sizeRange);this.colorRange&&(f.colorRange=[u.toJsonColor(this.colorRange[0]),u.toJsonColor(this.colorRange[1])]);this.alphaRange&&(f.alphaRange=[Math.round(255*this.alphaRange[0]),Math.round(255*this.alphaRange[1])]);return f}})})},"esri/renderers/TemporalRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel","./Renderer"],function(p,g,t,v,n){return p(n,{declaredClass:"esri.renderer.TemporalRenderer",constructor:function(g,n,k,f){this.observationRenderer=g;this.latestObservationRenderer=n;this.trackRenderer=k;this.observationAger=f},getSymbol:function(g){var m=g.getLayer(),k=this.getObservationRenderer(g),f=k&&k.getSymbol(g),e=this.observationAger;m.timeInfo&&m._map.timeExtent&&k===this.observationRenderer&&e&&f&&(f=e.getAgedSymbol(f,g));return f},getObservationRenderer:function(g){return 0===
g.getLayer()._getKind(g)?this.observationRenderer:this.latestObservationRenderer||this.observationRenderer},toJson:function(){var g={type:"temporal"};g.observationRenderer=this.observationRenderer.toJson();this.latestObservationRenderer&&(g.latestObservationRenderer=this.latestObservationRenderer.toJson());this.trackRenderer&&(g.trackRenderer=this.trackRenderer.toJson());this.observationAger&&(g.observationAger=this.observationAger.toJson());return g}})})},"esri/renderers/HeatmapRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct ../sniff ../kernel ../lang ../symbols/PictureMarkerSymbol ../Color ./Renderer".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return p([e],{declaredClass:"esri.renderer.HeatmapRenderer",colors:null,blurRadius:10,maxPixelIntensity:100,minPixelIntensity:0,field:null,fieldOffset:null,colorStops:null,constructor:function(b){(this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1)?("string"==typeof b&&(b=JSON.parse(b)),g.mixin(this,b),this._canvas=null,this.colors||this.colorStops||(this.colorStops=[{ratio:0,color:"rgba(255, 140, 0, 0)"},{ratio:.75,color:"rgba(255, 140, 0, 1)"},{ratio:.9,color:"rgba(255, 0,   0, 1)"}]),
this.gradient=this._generateGradient(this.colorStops||this.colors)):console.log("The HeatmapRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(b){if(!this._supportsCanvas)return!1;var a=b.attributes.imageData;b=b.attributes.size;if(!b)return null;var c=this._getContext(b[0],b[1]),e=c.getImageData(0,0,b[0],b[1]);window.ArrayBuffer&&a instanceof ArrayBuffer?a=window.Uint8ClampedArray?new Uint8ClampedArray(a):new Uint8Array(a):a.BYTES_PER_ELEMENT&&
1!==a.BYTES_PER_ELEMENT&&(a=window.Uint8ClampedArray?new Uint8ClampedArray(a.buffer):new Uint8Array(a.buffer));if(window.CanvasPixelArray&&e.data instanceof window.CanvasPixelArray)for(var f=e.data,g=f.length;g--;)f[g]=a[g];else e.data.set(a);c.putImageData(e,0,0);return new k(c.canvas.toDataURL(),b[0],b[1])},setColors:function(b){b&&(b instanceof Array||b.colors)&&(this.gradient=this._generateGradient(b.colors||b),this.colors=b);return this},setColorStops:function(b){b&&(b instanceof Array||b.colorStops)&&
(this.gradient=this._generateGradient(b.colorStops||b),this.colorStops=b);return this},setMaxPixelIntensity:function(b){this.maxPixelIntensity=b;return this},setMinPixelIntensity:function(b){this.minPixelIntensity=b;return this},setField:function(b){this.field=b;return this},setFieldOffset:function(b){this.fieldOffset=b;return this},setBlurRadius:function(b){this.blurRadius=b;return this},getStats:function(){},getHistogramData:function(){},toJson:function(){var b=g.mixin(this.inherited(arguments),
{type:"heatmap",blurRadius:this.blurRadius,colorStops:this._colorsToStops(this.colorStops||this.colors),maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity,field:this.field});null!=this.fieldOffset&&(b.fieldOffset=this.fieldOffset);t.forEach(b.colorStops,function(a){a.color=f.toJsonColor(a.color)});return u.fixJson(b)},_getContext:function(b,a){this._canvas?(this._canvas.width=b,this._canvas.height=a):this._canvas=this._initCanvas(b,a);return this._canvas.getContext("2d")},
_initCanvas:function(b,a){var c=v.create("canvas",{id:"hm_canvas-"+Math.floor(1E3*Math.random()),style:"position: absolute; left: 0px; top: -10000px;"},null);c.width=b;c.height=a;document.body.appendChild(c);return c},_generateGradient:function(b,a){a||(a=512);b=this._colorsToStops(b);for(var c=this._getContext(1,a||512),e=c.createLinearGradient(0,0,0,a),f=0,k;f<b.length;f++)k=b[f],e.addColorStop(k.ratio,k.color.toCss(!0));c.fillStyle=e;c.fillRect(0,0,1,a);return c.getImageData(0,0,1,a).data},_colorsToStops:function(b){var a=
[];if(!b[0])return a;if(null!=b[0].ratio)a=t.map(b,function(a){return{ratio:a.ratio,color:this._toColor(a.color)}},this);else if(null!=b[0].value){var c=Infinity,a=-Infinity,e=0,f;for(f=0;f<b.length;f++){var k=b[f].value;k<c&&(c=k);k>a&&(a=k)}e=a-c;this.maxPixelIntensity=a;this.minPixelIntensity=c;a=t.map(b,function(a){var b=a.value;a=this._toColor(a.color);return{value:b,ratio:(b-c)/e,color:a}},this)}else var g=b.length-1,a=t.map(b,function(a,b){return{color:this._toColor(a),ratio:b/g}},this);return a},
_toColor:function(b){b.toRgba||b.declaredClass||(b=new f(b));return b}})})},"esri/renderers/StretchRenderer":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../layers/RasterFunction ./colorRampUtils".split(" "),function(p,g,t,v,n,m,u,k){var f={TYPE_NONE:"none",TYPE_STANDARDDEVIATION:"standardDeviation",TYPE_HISTOGRAMEQUALIZATION:"histogramEqualization",TYPE_MINMAX:"minMax",TYPE_PERCENTCLIP:"percentClip",TYPE_SIGMOID:"sigmoid"};p=p(null,{declaredClass:"esri.renderer.StretchRenderer",
constructor:function(e){e=e||{};this.stretchType=f.TYPE_NONE;this.dra=!0;this.statistics=[];this.gamma=[];this.computeGamma=this.useGamma=!1;this.sigmoidStrengthLevel=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=this.min=this.max=null;t.mixin(this,e);this.colorRamp=k.fromJson(e.colorRamp)},toJson:function(){var e={type:"rasterStretch",stretchType:this.stretchType,colorRamp:this.colorRamp&&this.colorRamp.toJson(),min:this.min,max:this.max,numberOfStandardDeviations:this.numberOfStandardDeviations,
statistics:t.clone(this.statistics),dra:this.dra,minPercent:this.minPercent,maxPercent:this.maxPercent,useGamma:this.useGamma,gamma:t.clone(this.gamma),computeGamma:this.computeGamma,sigmoidStrengthLevel:this.sigmoidStrengthLevel};return m.fixJson(e)},toRenderingRule:function(e){e=e||{};var b=new u;b.functionName="Stretch";var a=this._convertStretchTypeEnumToIndex(this.stretchType),c={StretchType:a,Statistics:this.statistics,DRA:this.dra,UseGamma:this.useGamma,Gamma:this.gamma,ComputeGamma:this.computeGamma};
m.isDefined(this.min)&&(c.Min=this.min);m.isDefined(this.min)&&(c.Max=this.max);3===a?(c.NumberOfStandardDeviations=this.numberOfStandardDeviations,b.outputPixelType="U8"):6===a?(c.MinPercent=parseFloat(this.minPercent),c.MaxPercent=parseFloat(this.maxPercent),b.outputPixelType="U8"):5===a?b.outputPixelType="U8":9===a&&(c.SigmoidStrengthLevel=this.sigmoidStrengthLevel);b.functionArguments=c;b.variableName="Raster";return this.colorRamp?(a=new u,c=k.getColorRampName(this.colorRamp),a.functionArguments=
c?{colorRamp:c}:e.convertToColormap?{Colormap:k.convertColorRampToColormap(this.colorRamp,256)}:{colorRamp:this.colorRamp.toJson()},a.variableName="Raster",a.functionName="Colormap",a.functionArguments.Raster=b,a):b},_convertStretchTypeEnumToIndex:function(e){var b=0;e===f.TYPE_STANDARDDEVIATION?b=3:e===f.TYPE_HISTOGRAMEQUALIZATION?b=4:e===f.TYPE_MINMAX?b=5:e===f.TYPE_PERCENTCLIP?b=6:e===f.TYPE_SIGMOID&&(b=9);return b},_convertStretchTypeIndexToEnum:function(e){var b=0;3===e?b=f.TYPE_STANDARDDEVIATION:
4===e?b=f.TYPE_HISTOGRAMEQUALIZATION:5===e?b=f.TYPE_MINMAX:6===e?b=f.TYPE_PERCENTCLIP:9===e&&(b=f.TYPE_SIGMOID);return b}});t.mixin(p,f);return p})},"esri/layers/RasterFunction":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){var m=p(null,{declaredClass:"esri.layers.RasterFunction",functionName:null,arguments:null,functionArguments:null,variableName:null,outputPixelType:null,_isTemplate:null,_templateJson:null,constructor:function(m){if(g.isObject(m)){this._isRFTJson(m)&&
(this._isTemplate=!0,this._templateJson=m);var k=0;this.functionName=m.rasterFunction||m.name;this.functionArguments=g.clone(m.rasterFunctionArguments||m.arguments);g.mixin(this,m);if(m=this.functionArguments)if(m.Raster=this._toRasterFunction(m.Raster),m.Raster2=this._toRasterFunction(m.Raster2),m.DEM=this._toRasterFunction(m.DEM),m.FillRaster=this._toRasterFunction(m.FillRaster),m.Rasters&&m.Rasters.length)for(k=0;k<m.Rasters.length;k++)m.Rasters[k]=this._toRasterFunction(m.Rasters[k])}},_isRFTJson:function(g){return g.name&&
g.arguments&&g.function&&g.hasOwnProperty("functionType")},_toRasterFunction:function(g){return g&&(g.rasterFunction||g.functionName)?new m(g):g},_rfToJson:function(g){g&&"esri.layers.RasterFunction"===g.declaredClass&&(g=g.toJson());return g},toJson:function(){if(this._isTemplate)return this._templateJson;var m=g.clone(this.functionArguments||this.arguments);if(m&&(m.Raster=this._rfToJson(m.Raster),m.Raster2=this._rfToJson(m.Raster2),m.DEM=this._rfToJson(m.DEM),m.FillRaster=this._rfToJson(m.FillRaster),
m.Rasters&&m.Rasters.length)){var k,f=[];for(k=0;k<m.Rasters.length;k++)f.push(this._rfToJson(m.Rasters[k]));m.Rasters=f}return n.filter({rasterFunction:this.functionName,rasterFunctionArguments:m,variableName:this.variableName,outputPixelType:this.outputPixelType?this.outputPixelType:null},function(e){if(null!==e&&void 0!==e)return!0})}});return m})},"esri/renderers/colorRampUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/store/Memory ../tasks/AlgorithmicColorRamp ../tasks/MultipartColorRamp ../Color ./colorUtils".split(" "),
function(p,g,t,v,n,m,u){function k(a,b,f){if(a){b=b||c;f=f||x;var k=null,m=a.declaredClass,q,w;if((q="string"===typeof a?a:a.name)&&g.some(f,function(a){if(a.name===q)return k=a.id,!0})&&k)return k;"esri.tasks.AlgorithmicColorRamp"===m?g.some(b,function(b){if(e(a.fromColor.toRgb(),b.fromColor)&&e(a.toColor.toRgb(),b.toColor))return k=b.id,!0},this):"esri.tasks.MultipartColorRamp"===m&&g.some(b,function(b){if(a.colorRamps&&b.colorRamps&&a.colorRamps.length===b.colorRamps.length&&(w=a.colorRamps,!g.some(b.colorRamps,
function(a,b){if(!e(w[b].fromColor.toRgb(),a.fromColor)||!e(w[b].toColor.toRgb(),a.toColor))return!0},this))){if(k)return!0;k=b.id}},this);return k}}function f(a){var b=new v,c=a.algorithm;b.fromColor=m.toDojoColor(a.fromColor);b.toColor=m.toDojoColor(a.toColor);"esriCIELabAlgorithm"===c?b.algorithm="cie-lab":"esriHSVAlgorithm"===c?b.algorithm="hsv":"esriLabLChAlgorithm"===c&&(b.algorithm="lab-lch");return b}function e(a,b){return a&&b&&a.length&&b.length&&a.length===b.length?!g.some(a,function(a,
c){if(a>b[c]+2||a<b[c]-2)return!0}):!1}function b(a,b,c){a=u.toLAB(a);b=u.toLAB(b);return u.toRGB({l:a.l*(1-c)+c*b.l,a:a.a*(1-c)+c*b.a,b:a.b*(1-c)+c*b.b})}var a={},c=[{id:"none",selected:!0},{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,
181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,
237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],
toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",
type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,
171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,
10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,
233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],
toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",
colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,
250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,
12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,
191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],
toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],
toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,
128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,
245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],x=[{name:"Aspect",id:"aspect_predefined"},{name:"Black to White",id:"blackToWhite_predefined"},{name:"Blue Bright",id:"blueBright_predefined"},{name:"Blue Light to Dark",id:"blueLightToDark_predefined"},{name:"Blue-Green Bright",id:"blueGreenBright_predefined"},{name:"Blue-Green Light to Dark",id:"blueGreenLightToDark_predefined"},
{name:"Brown Light to Dark",id:"brownLightToDark_predefined"},{name:"Brown to Blue Green Diverging, Bright",id:"brownToBlueGreenDivergingBright_predefined"},{name:"Brown to Blue Green Diverging, Dark",id:"brownToBlueGreenDivergingDark_predefined"},{name:"Coefficient Bias",id:"coefficientBias_predefined"},{name:"Cold to Hot Diverging",id:"coldToHotDiverging_predefined"},{name:"Condition Number",id:"conditionNumber_predefined"},{name:"Cyan to Purple",id:"cyanToPurple_predefined"},{name:"Cyan-Light to Blue-Dark",
id:"cyanLightToBlueDark_predefined"},{name:"Distance",id:"distance_predefined"},{id:"elevation1_predefined",name:"Elevation #1"},{id:"elevation2_predefined",name:"Elevation #2"},{id:"errors_predefined",name:"Errors"},{id:"grayLightToDark_predefined",name:"Gray Light to Dark"},{id:"greenBright_predefined",name:"Green Bright"},{id:"greenLightToDark_predefined",name:"Green Light to Dark"},{name:"Green to Blue",id:"greenToBlue_predefined"},{name:"Orange Bright",id:"orangeBright_predefined"},{name:"Orange Light to Dark",
id:"orangeLightToDark_predefined"},{id:"partialSpectrum_predefined",name:"Partial Spectrum"},{id:"partialSpectrum1Diverging_predefined",name:"Partial Spectrum 1 Diverging",type:"multipart"},{id:"partialSpectrum2Diverging_predefined",name:"Partial Spectrum 2 Diverging"},{name:"Pink to YellowGreen Diverging, Bright",id:"pinkToYellowGreenDivergingBright_predefined"},{name:"Pink to YellowGreen Diverging, Dark",id:"pinkToYellowGreenDivergingDark_predefined"},{id:"precipitation_predefined",name:"Precipitation"},
{id:"prediction_predefined",name:"Prediction"},{name:"Purple Bright",id:"purpleBright_predefined"},{id:"purpleToGreenDivergingBright_predefined",name:"Purple to Green Diverging, Bright"},{id:"purpleToGreenDivergingDark_predefined",name:"Purple to Green Diverging, Dark"},{name:"Purple-Blue Bright",id:"purpleBlueBright_predefined"},{name:"Purple-Blue Light to Dark",id:"purpleBlueLightToDark_predefined"},{name:"Purple-Red Bright",id:"purpleRedBright_predefined"},{name:"Purple-Red Light to Dark",id:"purpleRedLightToDark_predefined"},
{name:"Red Bright",id:"redBright_predefined"},{name:"Red Light to Dark",id:"redLightToDark_predefined"},{id:"redToBlueDivergingBright_predefined",name:"Red to Blue Diverging, Bright"},{id:"redToBlueDivergingDark_predefined",name:"Red to Blue Diverging, Dark"},{id:"redToGreen_predefined",name:"Red to Green"},{id:"redToGreenDivergingBright_predefined",name:"Red to Green Diverging, Bright"},{id:"redToGreenDivergingDark_predefined",name:"Red to Green Diverging, Dark"},{name:"Slope",id:"slope_predefined"},
{id:"spectrumFullBright_predefined",name:"Spectrum-Full Bright"},{id:"spectrumFullDark_predefined",name:"Spectrum-Full Dark"},{id:"spectrumFullLight_predefined",name:"Spectrum-Full Light"},{id:"surface_predefined",name:"Surface"},{id:"temperature_predefined",name:"Temperature"},{name:"White to Black",id:"whiteToBlack_predefined"},{id:"yellowToDarkRed_predefined",name:"Yellow to Dark Red"},{id:"yellowToGreenToDarkBlue_predefined",name:"Yellow to Green to Dark Blue"},{name:"Yellow to Red",id:"yellowToRed_predefined"},
{name:"Yellow-Green Bright",id:"yellowGreenBright_predefined"},{name:"Yellow-Green Light to Dark",id:"yellowGreenLightToDark_predefined"}],w=new t({data:x});p.mixin(a,{predefinedColorRamps:c,predefinedColorRampNameMap:x,getColorRampName:function(a){return(a=k(a))?(a=w.query({id:a}),a[0]?a[0].name:null):null},fromJson:function(a){var b=null;if(!a)return b;"multipart"===a.type?(b=new n,b.colorRamps=g.map(a.colorRamps,function(a){return f(a)},this)):"algorithmic"===a.type&&(b=f(a));return b},colorsEqual:e,
getColorRampId:k,convertColorRampToColormap:function(a,c){if(a&&c){for(var e=a.colorRamps?a.colorRamps.length:1,f=[],k=[],m,q,w,x,n,p=0,C=0,p=0;p<e;p++)f[p]={},f[p].start=C,f[p].end=C+1/e,C=f[p].end;for(p=0;p<c;p++)x=(p+.5)/c,g.forEach(f,function(c,e){x>=c.start&&x<c.end&&(n=(x-c.start)/(c.end-c.start),1<f.length?(m=u.getDojoColor(a.colorRamps[e].fromColor),q=u.getDojoColor(a.colorRamps[e].toColor)):(m=u.getDojoColor(a.fromColor),q=u.getDojoColor(a.toColor)),w=b(m,q,n),k.push([p,w.r,w.g,w.b]))},this);
return k}},interpolateLabColor:b});return a})},"dojo/store/Memory":function(){define(["../_base/declare","./util/QueryResults","./util/SimpleQueryEngine"],function(p,g,t){return p("dojo.store.Memory",null,{constructor:function(g){for(var n in g)this[n]=g[n];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:t,get:function(g){return this.data[this.index[g]]},getIdentity:function(g){return g[this.idProperty]},put:function(g,n){var m=this.data,u=this.index,k=this.idProperty,
k=g[k]=n&&"id"in n?n.id:k in g?g[k]:Math.random();if(k in u){if(n&&!1===n.overwrite)throw Error("Object already exists");m[u[k]]=g}else u[k]=m.push(g)-1;return k},add:function(g,n){(n=n||{}).overwrite=!1;return this.put(g,n)},remove:function(g){var n=this.index,m=this.data;if(g in n)return m.splice(n[g],1),this.setData(m),!0},query:function(p,n){return g(this.queryEngine(p,n)(this.data))},setData:function(g){g.items?(this.idProperty=g.identifier||this.idProperty,g=this.data=g.items):this.data=g;this.index=
{};for(var n=0,m=g.length;n<m;n++)this.index[g[n][this.idProperty]]=n}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(p,g,t){var v=function(n){function m(k){n[k]=function(){var f=arguments,e=t(n,function(b){Array.prototype.unshift.call(f,b);return v(p[k].apply(p,f))});if("forEach"!==k||u)return e}}if(!n)return n;var u=!!n.then;u&&(n=g.delegate(n));m("forEach");m("filter");m("map");null==n.total&&(n.total=t(n,function(k){return k.length}));
return n};g.setObject("dojo.store.util.QueryResults",v);return v})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],function(p){return function(g,t){function v(m){m=p.filter(m,g);var n=t&&t.sort;n&&m.sort("function"==typeof n?n:function(f,e){for(var b,a=0;b=n[a];a++){var c=f[b.attribute],k=e[b.attribute],c=null!=c?c.valueOf():c,k=null!=k?k.valueOf():k;if(c!=k)return!!b.descending==(null==c||c>k)?-1:1}return 0});if(t&&(t.start||t.count)){var k=m.length;m=m.slice(t.start||
0,(t.start||0)+(t.count||Infinity));m.total=k}return m}switch(typeof g){default:throw Error("Can not query with a "+typeof g);case "object":case "undefined":var n=g;g=function(g){for(var m in n){var k=n[m];if(k&&k.test){if(!k.test(g[m],g))return!1}else if(k!=g[m])return!1}return!0};break;case "string":if(!this[g])throw Error("No filter function "+g+" was found in store");g=this[g];case "function":}v.matches=g;return v}})},"esri/tasks/AlgorithmicColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../Color ./ColorRamp".split(" "),
function(p,g,t,v,n,m){return p(m,{declaredClass:"esri.tasks.AlgorithmicColorRamp",type:"algorithmic",fromColor:null,toColor:null,algorithm:null,toJson:function(){var g;switch(this.algorithm&&this.algorithm.toLowerCase()){case "cie-lab":g="esriCIELabAlgorithm";break;case "hsv":g="esriHSVAlgorithm";break;case "lab-lch":g="esriLabLChAlgorithm"}g={type:"algorithmic",algorithm:g};g.fromColor=n.toJsonColor(this.fromColor);g.toColor=n.toJsonColor(this.toColor);return g}})})},"esri/tasks/ColorRamp":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p(null,{declaredClass:"esri.tasks.ColorRamp",type:null})})},"esri/tasks/MultipartColorRamp":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../symbols/Symbol ./ColorRamp".split(" "),function(p,g,t,v,n,m){return p(m,{declaredClass:"esri.tasks.MultipartColorRamp",type:"multipart",constructor:function(){this.colorRamps=[]},addColorRamp:function(g){this.colorRamps.push(g)},toJson:function(){return{type:"multipart",
colorRamps:t.map(this.colorRamps,function(g){return g.toJson()})}}})})},"esri/renderers/colorUtils":function(){define(["dojo/_base/Color","dojo/_base/array"],function(p,g){var t={COEF_RGB2XYZ:[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],COEF_XYZ2RGB:[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],matrixProduct:function(g,m){var n=[],k,f;if(g[0].length!==m.length)throw"dimensions do not match";var e=g.length,b=g[0].length,a=0;for(k=0;k<e;k++){for(f=a=0;f<b;f++)a+=
g[k][f]*m[f];n.push(a)}return n},rgb2xyz:function(g){g=[g.r/255,g.g/255,g.b/255].map(function(g){return.04045>=g?g/12.92:Math.pow((g+.055)/1.055,2.4)});g=this.matrixProduct(this.COEF_RGB2XYZ,g);return{x:100*g[0],y:100*g[1],z:100*g[2]}},xyz2rgb:function(g){g=this.matrixProduct(this.COEF_XYZ2RGB,[g.x/100,g.y/100,g.z/100]).map(function(g){return Math.min(1,Math.max(.0031308>=g?12.92*g:1.055*Math.pow(g,1/2.4)-.055,0))});return{r:Math.round(255*g[0]),g:Math.round(255*g[1]),b:Math.round(255*g[2])}},xyz2lab:function(g){g=
[g.x/95.047,g.y/100,g.z/108.883].map(function(g){return g>Math.pow(6/29,3)?Math.pow(g,1/3):1/3*Math.pow(29/6,2)*g+4/29});return{l:116*g[1]-16,a:500*(g[0]-g[1]),b:200*(g[1]-g[2])}},lab2xyz:function(g){var m=g.l;g=[(m+16)/116+g.a/500,(m+16)/116,(m+16)/116-g.b/200].map(function(g){return g>6/29?Math.pow(g,3):3*Math.pow(6/29,2)*(g-4/29)});return{x:95.047*g[0],y:100*g[1],z:108.883*g[2]}},lab2lch:function(g){var m=g.l,n=g.a,k=g.b;g=Math.sqrt(n*n+k*k);n=Math.atan2(k,n);n=0<n?n:n+2*Math.PI;return{l:m,c:g,
h:n}},lch2lab:function(g){var m=g.c,n=g.h;return{l:g.l,a:m*Math.cos(n),b:m*Math.sin(n)}},rgb2lab:function(g){return this.xyz2lab(this.rgb2xyz(g))},lab2rgb:function(g){return this.xyz2rgb(this.lab2xyz(g))},rgb2lch:function(g){return this.lab2lch(this.xyz2lab(this.rgb2xyz(g)))},lch2rgb:function(g){return this.xyz2rgb(this.lab2xyz(this.lch2lab(g)))}},v={rgb2hsv:function(g){var m=g.r,n=g.g;g=g.b;var k=Math.max(m,n,g),f=k-Math.min(m,n,g),e;0===f?e=0:k===m?e=(n-g)/f%6:k===n?e=(g-m)/f+2:k===g&&(e=(m-n)/
f+4);0>e&&(e+=6);return{h:60*e,s:100*(0===f?0:f/k),v:100/255*k}},hsv2rgb:function(g){var m=(g.h+360)%360/60,n=g.v/100*255;g=g.s/100*n;var k=g*(1-Math.abs(m%2-1));switch(Math.floor(m)){case 0:m={r:g,g:k,b:0};break;case 1:m={r:k,g:g,b:0};break;case 2:m={r:0,g:g,b:k};break;case 3:m={r:0,g:k,b:g};break;case 4:m={r:k,g:0,b:g};break;case 5:case 6:m={r:g,g:0,b:k};break;default:m={r:0,g:0,b:0}}m.r=Math.round(m.r+n-g);m.g=Math.round(m.g+n-g);m.b=Math.round(m.b+n-g);return m}};return{toRGB:function(g){var m;
void 0!==g.r&&void 0!==g.g&&void 0!==g.b?m=g:void 0!==g.l&&void 0!==g.c&&void 0!==g.h?m=t.lch2rgb(g):void 0!==g.l&&void 0!==g.a&&void 0!==g.b?m=t.lab2rgb(g):void 0!==g.x&&void 0!==g.y&&void 0!==g.z?m=t.xyz2rgb(g):void 0!==g.h&&void 0!==g.s&&void 0!==g.v&&(m=v.hsv2rgb(g));return m},toHSV:function(g){if(void 0!==g.h&&void 0!==g.s&&void 0!==g.v)return g;g=this.toRGB(g);return v.rgb2hsv(g)},toLAB:function(g){return void 0!==g.l&&void 0!==g.a&&void 0!==g.b?g:t.rgb2lab(this.toRGB(g))},toLCH:function(g){return void 0!==
g.l&&void 0!==g.c&&void 0!==g.h?g:t.rgb2lch(this.toRGB(g))},toXYZ:function(g){return void 0!==g.x&&void 0!==g.y&&void 0!==g.z?g:t.rgb2xyz(this.toRGB(g))},getDojoColor:function(g){if(g){if(Array.isArray(g))return p.fromArray(g);if(void 0!==g.r&&void 0!==g.g&&void 0!==g.b)return g}},correctRGBLimits:function(n){var m=[n.r,n.g,n.b];g.forEach(m,function(g,k){0>m[k]?m[k]=0:255<m[k]&&(m[k]=255);m[k]=Math.floor(m[k])});return{r:m[0],g:m[1],b:m[2],a:1}}}})},"esri/dijit/PopupTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojo/dom-construct ../kernel ../InfoTemplate ../PopupInfo ./PopupRenderer".split(" "),
function(p,g,t,v,n,m,u,k){return p([m,u],{declaredClass:"esri.dijit.PopupTemplate","-chains-":{constructor:"manual"},chartTheme:null,constructor:function(f,e){g.mixin(this,e);this.initialize(f,e)},getTitle:function(f){var e;this.info&&(e=this.titleHasRelatedFields||this.titleHasAsyncExpressions?"":this._getPopupValues(f,this._fetchAttributes(f,null,this.getExpressionFieldsInTitle()),!0).title);return e||""},getContent:function(f){return this.info?(new k({template:this,graphic:f,chartTheme:this.chartTheme},
v.create("div"))).domNode:""}})})},"esri/PopupInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/i18n dojo/has dojo/Deferred dojo/sniff dojo/promise/all dojox/html/entities ./lang ./kernel ./request ./promiseList ./ArcadeExpression ./tasks/query ./tasks/QueryTask ./tasks/RelationshipQuery ./tasks/StatisticDefinition ./arcadeProfiles/popupProfile ./layers/support/attributeUtils dojo/i18n!dojo/cldr/nls/number".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,
a,c,x,w,q,C,z,E,B,G,F){return p(null,{declaredClass:"esri.PopupInfo",_reNewline:/(\n)/ig,_reExprField:/^\s*expression\//i,_reExprFieldPattern:/\{expression\/([^\}]+)\}/ig,_exprPrefix:"expression/",_relatedFieldPrefix:"relationships/",_reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,initialize:function(a,b){if(a){g.mixin(this,b);this.info=a;this.title=this.getTitle;this.content=this.getContent;this._exprCache=this._compileExpressions(this.info.expressionInfos);var c=this._fieldLabels={},e=this._fieldsMap=
{};this.info.fieldInfos&&t.forEach(this.info.fieldInfos,function(a){var b=a.fieldName.toLowerCase(),f=this._isExpressionField(b)?this.getExpressionInfo(b):null;c[b]=f?f.title:a.label;e[b]=a},this);this.titleHasRelatedFields=!(!this.info.title||-1===this.info.title.indexOf("{"+this._relatedFieldPrefix));this.titleHasAsyncExpressions=this._titleHasAsyncExpressions();this.contentHasAsyncExpressions=this._contentHasAyncExpressions()}},toJson:function(){return v.fromJson(v.toJson(this.info))},getTitle:function(){},
getContent:function(){},getFieldInfo:function(a){var b;t.some(this.info&&this.info.fieldInfos,function(c){c.fieldName===a&&(b=c);return!!b});return b},getExpressionInfo:function(a){if(a=this._getExprField(a)){a=a.toLowerCase();var b;t.some(this.info.expressionInfos,function(c){c.name.toLowerCase()===a&&(b=c);return!!b});return b}},getExpressionFieldsInTitle:function(){return this._getExprFieldsFromTemplatedString(this.info.title)},getExpressionFieldsInContent:function(){var a=this._collectExprFieldsFromTemplatedString(this.info.description,
[]);this.info.description||t.forEach(this.info.fieldInfos,function(b){b.visible&&this._collectExprField(b.fieldName,a)},this);t.forEach(this.info.mediaInfos,function(b){this._collectExprFieldsFromTemplatedString(b.title,a);this._collectExprFieldsFromTemplatedString(b.caption,a);if(b=b.value)this._collectExprFieldsFromTemplatedString(b.linkURL,a),this._collectExprFieldsFromTemplatedString(b.sourceURL,a),t.forEach(b.fields,function(b){this._collectExprField(b,a)},this),this._collectExprField(b.normalizeField,
a),this._collectExprField(b.tooltipField,a)},this);return a},getRequiredExpressionFields:function(){return this.getExpressionFieldsInTitle().concat(this.getExpressionFieldsInContent())},hasGeometryOperations:function(){return t.some(this._getArcadeExpressions(),function(a){return a.hasGeometryOperations()})},hasAsyncExpressions:function(){return t.some(this._getArcadeExpressions(),function(a){return a.async})},initializeArcadeEngine:function(){return B.initialize(this._getArcadeExpressions())},getComponents:function(a,
b){var c=this.info,e={initArcadeEngine:this.initializeArcadeEngine()};c.fieldInfos&&(c=t.filter(c.fieldInfos,function(a){return-1!==a.fieldName.indexOf(this._relatedFieldPrefix)},this))&&0<c.length&&(e.relatedInfo=this._getRelatedRecords({graphic:a,fieldsInfo:c}));this._needFullResolutionFeature(a)&&(e.fullResolutionFeature=this._getFullResolutionFeature(a));return x(e).then(g.hitch(this,function(c){c=c.fullResolutionFeature;var e=b&&b.evaluateAllExpressions,f=e?null:this.getRequiredExpressionFields();
c=(e?this.hasAsyncExpressions():this._hasAsyncExpressions(f))?this._fetchAttributesAsync(a,c,f):this._fetchAttributes(a,c,f);return x([c]).then(g.hitch(this,function(b){return this._getPopupValues(a,b[0])}))}))},getAttachments:function(a){var b=a.getSourceLayer();a=a.attributes;if(this.info.showAttachments&&b&&b.hasAttachments&&b.objectIdField&&(a=a&&a[b.objectIdField]))return b.queryAttachmentInfos(a)},_needFullResolutionFeature:function(a){return(a=a.getSourceLayer())?"function"===typeof a.getMaxAllowableOffset&&
0<a.getMaxAllowableOffset()&&this.hasGeometryOperations():!1},_getFullResolutionFeature:function(a){var b=a.getSourceLayer(),c=b.objectIdField;a=(a=a.attributes)&&c&&a[c];if(null==a)return null;var e=new q;e.where=c+"\x3d"+a;e.maxAllowableOffset=0;e.outFields=[c];this._reHostedFS.test(b.url)&&(e.resultType="coherent");return b.queryFeatures(e).then(function(a){return a.features&&a.features[0]})},_isExpressionField:function(a){return this._reExprField.test(a)},_getExprField:function(a){return this._isExpressionField(a)?
a.replace(this._reExprField,""):null},_collectExprField:function(a,b){(a=this._getExprField(a))&&b.push(a);return b},_collectExprFieldsFromTemplatedString:function(a,b){a=this._getExprFieldsFromTemplatedString(a);a.length&&Array.prototype.push.apply(b,a);return b},_getExprFieldsFromTemplatedString:function(a){a=a?a.match(this._reExprFieldPattern):null;return t.map(a,function(a){return a.replace(this._reExprFieldPattern,"$1")},this)},_titleHasAsyncExpressions:function(){return this._hasAsyncExpressions(this.getExpressionFieldsInTitle())},
_contentHasAyncExpressions:function(){return this._hasAsyncExpressions(this.getExpressionFieldsInContent())},_hasAsyncExpressions:function(a){return t.some(a,function(a){a=this._exprCache[a];return!(!a||!a.async)},this)},_compileExpressions:function(a){var b={};t.forEach(a,function(a){var c=a.returnType&&a.returnType.toLowerCase();b[a.name]=new w({expression:a.expression,returnType:"number"===c?"number":"string",profile:B})});return b},_getArcadeExpressions:function(){var a=[],b;for(b in this._exprCache)a.push(this._exprCache[b]);
return a},_fetchAttributesAsync:function(a,b,c){var e=this._fetchAttributes(a,b,c);a={};for(var f in e)(b=e[f])&&b.then&&(a[f]=b);return x(a).then(g.hitch(this,function(a){for(var b in a){var c=a[b];e[b]=c instanceof Error?null:this._processArcadeResult(c)}return e}))},_processArcadeResult:function(a){"string"===typeof a&&(a=e.encode(a));return a},_fetchAttributes:function(a,b,c){var e=g.clone(a.attributes)||{},f=b&&b.geometry,k=this._exprPrefix,m=this._exprCache;c=c||t.map(this.info.expressionInfos,
function(a){return a.name});t.forEach(c,function(b){var c=k+b;b=(b=m[b])?a.evaluateExpression(b,this._getEvalOptions(b,a,f)):null;e[c]=this._processArcadeResult(b)},this);return e},_getEvalOptions:function(a,b,c){var e=a.hasGeometryOperations(),f=b.getSourceLayer(),k=f&&(f.getMap()||f.parentLayer&&f.parentLayer.getMap());a=B.getEvalOptions({expression:a,feature:b,layer:f,map:k,spatialReference:k&&k.spatialReference});b=a.context.vars.$feature;e=!(!e||!c);b&&e&&(b._geometry=c);a.skipCache=e;return a},
_getPopupValues:function(a,c,e){c=c||this._fetchAttributes(a);var f=this.info,k=a.getSourceLayer(),m=g.clone(c),q="",w="",x,n,u,p,B,A=k&&k._getDateOpts&&k._getDateOpts().properties,A=A&&A.slice(0),z={dateFormat:{properties:A,formatter:"DateFormat"+this._insertOffset(this._dateFormats.shortDateShortTime)},format:null};if(this._relatedInfo)for(p in this._relatedInfo)if(this._relatedInfo.hasOwnProperty(p)){var C=this._relatedInfo[p],l=this._relatedLayersInfo[p];C&&(t.forEach(C.relatedFeatures,function(d){for(B in d.attributes)if(d.attributes.hasOwnProperty(B)&&
"esriRelCardinalityOneToOne"===l.relation.cardinality){var h=this._toRelatedFieldName([l.relation.id,B]);c[h]=m[h]=d.attributes[B]}},this),t.forEach(C.relatedStatsFeatures,function(d){for(B in d.attributes)if(d.attributes.hasOwnProperty(B)){var h=this._toRelatedFieldName([l.relation.id,B]);c[h]=m[h]=d.attributes[B]}},this))}for(n in m)p=this._fieldsMap[n.toLowerCase()],C=this._getLayerFieldInfo(k,n),p&&C&&(p.fieldName=C.name),m[n]=this._formatValue(m[n],n,z),A&&p&&p.format&&p.format.dateFormat&&(p=
t.indexOf(A,n),-1<p&&A.splice(p,1));if(k)for(n in A=k.typeIdField,c)c.hasOwnProperty(n)&&-1===n.indexOf(this._relatedFieldPrefix)&&(u=c[n],b.isDefined(u)&&(p=this._getDomainName(k,a,n,u),b.isDefined(p)?m[n]=p:n===A&&(p=this._getTypeName(k,a,u),b.isDefined(p)&&(m[n]=p))));f.title&&(q=this._processFieldsInLinks(this._fixTokens(f.title,k),c),q=g.trim(this._removeEmptyHref(b.substitute(m,q,z)||"")));if(e)return{title:q};f.description&&(w=this._processFieldsInLinks(this._fixTokens(f.description,k),c),
w=g.trim(this._removeEmptyHref(b.substitute(m,w,z)||"")));f.fieldInfos&&(x=[],t.forEach(f.fieldInfos,function(d){(n=d.fieldName)&&d.visible&&x.push([this._fieldLabels[n.toLowerCase()]||n,b.substitute(m,"${"+n+"}",z)||""])},this));var d,h;f.mediaInfos&&(d=[],t.forEach(f.mediaInfos,function(a){h=0;u=a.value;switch(a.type){case "image":var l=u.sourceURL,l=l&&g.trim(this._removeEmptyHref(b.substitute(c,this._fixTokens(l,k))));h=!!l;break;case "piechart":case "linechart":case "columnchart":case "barchart":var r,
l=u.normalizeField;u.fields=t.map(u.fields,function(d){return(r=this._getLayerFieldInfo(k,d))?r.name:d},this);l&&(r=this._getLayerFieldInfo(k,l),u.normalizeField=r?r.name:l);h=t.some(u.fields,function(d){return b.isDefined(c[d])||-1!==d.indexOf(this._relatedFieldPrefix)&&this._relatedInfo},this);break;default:return}if(h){a=g.clone(a);u=a.value;var l=a.title?this._processFieldsInLinks(this._fixTokens(a.title,k),c):"",e=a.caption?this._processFieldsInLinks(this._fixTokens(a.caption,k),c):"";a.title=
l?g.trim(this._removeEmptyHref(b.substitute(m,l,z)||"")):"";a.caption=e?g.trim(this._removeEmptyHref(b.substitute(m,e,z)||"")):"";if("image"===a.type)u.sourceURL=b.substitute(c,this._fixTokens(u.sourceURL,k)),u.linkURL&&(u.linkURL=g.trim(b.substitute(c,this._fixTokens(u.linkURL,k))||""));else{var f,A;t.forEach(u.fields,function(d,h){if(-1!==d.indexOf(this._relatedFieldPrefix))A=this._getRelatedChartInfos(d,u,c,z),A instanceof Array?u.fields=A:u.fields[h]=A;else{var a=c[d],a=void 0===a?null:a;f=c[u.normalizeField]||
0;a&&f&&(a/=f);u.fields[h]={y:a,tooltip:(this._fieldLabels[d.toLowerCase()]||d)+":\x3cbr/\x3e"+this._formatValue(a,d,z,!!f)}}},this)}d.push(a)}},this));return{title:q,description:w,hasDescription:!!f.description,fields:x&&x.length?x:null,mediaInfos:d&&d.length?d:null,formatted:m,editSummary:!1!==f.showLastEditInfo&&k&&k.getEditSummary?k.getEditSummary(a):""}},_getRelatedChartInfos:function(a,c,e,f){var k,g,m,q,w,x;k=[];x=this._fromRelatedFieldName(a);w=x[0];g=this._relatedInfo[w];w=this._relatedLayersInfo[w];
g&&t.forEach(g.relatedFeatures,function(g){g=g.attributes;var w,n;for(n in g)if(g.hasOwnProperty(n)&&n===x[1]){w={};q=g[n];c.normalizeField&&(m=-1!==c.normalizeField.indexOf(this._relatedFieldPrefix)?g[this._fromRelatedFieldName(c.normalizeField)[1]]:e[c.normalizeField]);q&&m&&(q/=m);if(c.tooltipField)if(-1!==c.tooltipField.indexOf(this._relatedFieldPrefix)){var A=this._fromRelatedFieldName(c.tooltipField)[1],u=b.isDefined(g[A])?this._formatValue(g[A],c.tooltipField,f,!!m):A;w.tooltip=u+":\x3cbr/\x3e"+
this._formatValue(q,A,f,!!m)}else w.tooltip=(this._fieldLabels[a.toLowerCase()]||a)+":\x3cbr/\x3e"+this._formatValue(q,c.tooltipField,f,!!m);else w.tooltip=q;w.y=q;k.push(w)}},this);return"esriRelCardinalityOneToMany"===w.relation.cardinality||"esriRelCardinalityManyToMany"===w.relation.cardinality?k:k[0]},_dateFormats:{shortDate:"(datePattern: 'M/d/y', selector: 'date')",shortDateLE:"(datePattern: 'd/M/y', selector: 'date')",longMonthDayYear:"(datePattern: 'MMMM d, y', selector: 'date')",dayShortMonthYear:"(datePattern: 'd MMM y', selector: 'date')",
longDate:"(datePattern: 'EEEE, MMMM d, y', selector: 'date')",shortDateShortTime:"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateLEShortTime:"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')",shortDateShortTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLEShortTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",shortDateLongTime:"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')",
shortDateLELongTime:"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')",shortDateLongTime24:"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')",shortDateLELongTime24:"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')",longMonthYear:"(datePattern: 'MMMM y', selector: 'date')",shortMonthYear:"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"},_dateFormatsJson:{shortDate:{datePattern:"M/d/y",
selector:"date"},shortDateLE:{datePattern:"d/M/y",selector:"date"},longMonthDayYear:{datePattern:"MMMM d, y",selector:"date"},dayShortMonthYear:{datePattern:"d MMM y",selector:"date"},longDate:{datePattern:"EEEE, MMMM d, y",selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",selector:"date and time"},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",selector:"date and time"},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",selector:"date and time"},
shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",selector:"date and time"},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",selector:"date and time"},shortDateLongTime24:{datePattern:"M/d/y",timePattern:"H:mm:ss",selector:"date and time"},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",selector:"date and time"},longMonthYear:{datePattern:"MMMM y",selector:"date"},
shortMonthYear:{datePattern:"MMM y",selector:"date"},year:{datePattern:"y",selector:"date"}},_reHref:/href\s*=\s*\"([^\"]+)\"/ig,_reHrefApos:/href\s*=\s*\'([^\']+)\'/ig,_fixTokens:function(a,b){var c=this;return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,e,f){a=c._getLayerFieldInfo(b,f);return"$"+(a?"{"+a.name+"}":e)})},_encodeAttributes:function(a){a=g.clone(a)||{};var b,c;for(b in a)(c=a[b])&&"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),a[b]=c);return a},_processFieldsInLinks:function(a,
b){var c=this._encodeAttributes(b);b=g.hitch(this,this._addValuesToHref,b,c);a&&(a=a.replace(this._reHref,b).replace(this._reHrefApos,b));return a},_addValuesToHref:function(a,c,e,f){f=f&&g.trim(f);return e=b.substitute(f&&0===f.indexOf("${")?a:c,e)},_getLayerFieldInfo:function(a,b){return a&&a.getField?a.getField(b):null},_formatValue:function(a,c,e,f){var k=this._fieldsMap[c.toLowerCase()],m=k&&k.format;c=-1!==t.indexOf(e.dateFormat.properties,c);var q="number"===typeof a&&!c&&(!m||!m.dateFormat);
if(!b.isDefined(a)||!k||!b.isDefined(m))return this._applyFormatting(a,q);var w,k=m.hasOwnProperty("places")||m.hasOwnProperty("digitSeparator"),x=m.hasOwnProperty("digitSeparator")?m.digitSeparator:!0;if(k&&!c)w={formatType:"NumberFormat",places:b.isDefined(m.places)&&(!f||0<m.places)?Number(m.places):Infinity};else if(m.dateFormat)w=g.mixin({formatType:"DateFormat",utcOffset:this.utcOffset},this._dateFormatsJson[m.dateFormat]||this._dateFormatsJson.shortDateShortTime);else return this._applyFormatting(a,
q);var n=this._applyFormatFunctions(a,w,e);k&&-1<a.constructor.toString().indexOf("Array")&&(n="",t.forEach(a,g.hitch(this,function(a,b){b&&(n+=" ");n+=this._applyFormatFunctions(a,w,e)})));k&&!x&&F.group&&(n=n.replace(new RegExp("\\"+F.group,"g"),""));c&&(n='\x3cspan class\x3d"esriDateValue"\x3e'+n+"\x3c/span\x3e");return this._applyFormatting(n,q)},_applyFormatFunctions:function(a,c,e){c&&e&&(e.format={myKey:c});a=b.substitute({myKey:a},"${myKey}",e)||"";c&&e&&(e.format=null);return a},_applyFormatting:function(a,
b){return b?this._forceLTR(a):this._applyPreWrap(a)},_forceLTR:function(a){var b=k("ie");return b&&10>=b?a:"\x3cspan class\x3d'esriNumericValue'\x3e"+a+"\x3c/span\x3e"},_applyPreWrap:function(a){return"string"===typeof a?a.replace(this._reNewline,"\x3cspan class\x3d'charNewLine'\x3e$1\x3c/span\x3e"):a},_insertOffset:function(a){a&&(a=b.isDefined(this.utcOffset)?a.replace(/\)\s*$/,", utcOffset:"+this.utcOffset+")"):a);return a},_getDomainName:function(a,b,c,e){return(a=a.getDomain&&a.getDomain(c,{feature:b}))&&
a.codedValues?a.getName(e):null},_getTypeName:function(a,b,c){return(a=a.getType&&a.getType(b))&&a.name},_getRelatedRecords:function(a){var b=a.graphic,c;this._relatedLayersInfoPromise||(this._relatedLayersInfoPromise=this._getRelatedLayersInfo(a).then(g.hitch(this,function(a){for(c in a)a.hasOwnProperty(c)&&a[c]&&(this._relatedLayersInfo[c].relatedLayerInfo=a[c])})));return this._relatedLayersInfoPromise.then(g.hitch(this,function(){return this._queryRelatedLayers(b)})).then(g.hitch(this,function(a){this._setRelatedRecords(b,
a);return a}))},_getRelatedLayersInfo:function(a){var b=a.fieldsInfo,e,k,g={};e=a.graphic.getSourceLayer();this._relatedLayersInfo||(this._relatedLayersInfo={});t.forEach(b,function(a){var b,c,f,k;b=this._fromRelatedFieldName(a.fieldName);c=b[0];b=b[1];c&&(!this._relatedLayersInfo[c]&&e&&e.relationships&&(t.some(e.relationships,function(a){if(a.id==c)return k=a,!0}),k&&(this._relatedLayersInfo[c]={relation:k,relatedFields:[],outStatistics:[]})),this._relatedLayersInfo[c]&&(this._relatedLayersInfo[c].relatedFields.push(b),
a.statisticType&&(f=new E,f.statisticType=a.statisticType,f.onStatisticField=b,f.outStatisticFieldName=b,this._relatedLayersInfo[c].outStatistics.push(f))))},this);for(k in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(k)&&this._relatedLayersInfo[k]&&(a=this._relatedLayersInfo[k].relation,a=e.url.replace(/[0-9]+$/,a.relatedTableId),this._relatedLayersInfo[k].relatedLayerUrl=a,g[k]=c({url:a,content:{f:"json"},callbackParamName:"callback"}));return f(g)},_queryRelatedLayers:function(a){var b=
{},c;for(c in this._relatedLayersInfo)this._relatedLayersInfo.hasOwnProperty(c)&&(b[c]=this._queryRelatedLayer({graphic:a,relatedInfo:this._relatedLayersInfo[c]}));return f(b)},_queryRelatedLayer:function(a){var b,c,e,k,m,w,x,n,p,B,z,v,A;b=a.graphic;c=b.getSourceLayer();e=c.url.match(/[0-9]+$/g)[0];z=a.relatedInfo;B=z.relatedLayerInfo;v=z.relatedLayerUrl;a=z.relation;t.some(B.relationships,function(a){if(a.relatedTableId===parseInt(e,10))return k=a,!0},this);k&&(m=new q,t.some(B.fields,function(a){if(a.name===
k.keyField)return n=-1!==t.indexOf(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],a.type)?"number":"string",!0}),k.relationshipTableId&&k.keyFieldInRelationshipTable?(A=new u,this._queryRelatedRecords(b,k).then(g.hitch(this,function(a){var e;(e=a[b.attributes[c.objectIdField]])?(a=t.map(e.features,function(a){return a.attributes[B.objectIdField]},this),z.outStatistics&&0<z.outStatistics.length&&B.supportsStatistics&&(p=new q,p.objectIds=a,p.outFields=
m.outFields,p.outStatistics=z.outStatistics),p&&(w=new C(v),w.execute(p).then(g.hitch(this,function(a){var d=[];d.push(e);d.push(a);A.resolve(d)})))):A.resolve()}))):(x="string"===n?k.keyField+"\x3d'"+b.attributes[a.keyField]+"'":k.keyField+"\x3d"+b.attributes[a.keyField],m.where=x,m.outFields=z.relatedFields,z.outStatistics&&0<z.outStatistics.length&&B.supportsStatistics&&(p=new q,p.where=m.where,p.outFields=m.outFields,p.outStatistics=z.outStatistics),w=new C(v),x=[],x.push(w.execute(m)),p&&x.push(w.execute(p))));
return x?f(x):A?A.promise:void 0},_setRelatedRecords:function(a,c){this._relatedInfo=[];for(var e in c)c.hasOwnProperty(e)&&c[e]&&(a=c[e],this._relatedInfo[e]={},this._relatedInfo[e].relatedFeatures=a[0].features,b.isDefined(a[1])&&(this._relatedInfo[e].relatedStatsFeatures=a[1].features))},_handlerErrorResponse:function(a,b){a.reject(b)},_fromRelatedFieldName:function(a){var b=[];-1!==a.indexOf(this._relatedFieldPrefix)&&(a=a.split("/"),b=a.slice(1));return b},_toRelatedFieldName:function(a){var b=
"";a&&0<a.length&&(b=this._relatedFieldPrefix+a[0]+"/"+a[1]);return b},_queryRelatedRecords:function(a,b){var c=a.getSourceLayer(),e=new z;e.outFields=["*"];e.relationshipId=b.id;e.objectIds=[a.attributes[c.objectIdField]];return c.queryRelatedFeatures(e)},_removeEmptyHref:function(a){return a.replace(/href=(""|'')/gi,"")}})})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(p){var g=p.getObject("dojox.html.entities",!0),t=function(g,m){var n,k;if(m._encCache&&m._encCache.regexp&&
m._encCache.mapper&&m.length==m._encCache.length)n=m._encCache.mapper,k=m._encCache.regexp;else{n={};k=["["];var f;for(f=0;f<m.length;f++)n[m[f][0]]="\x26"+m[f][1]+";",k.push(m[f][0]);k.push("]");k=new RegExp(k.join(""),"g");m._encCache={mapper:n,regexp:k,length:m.length}}return g=g.replace(k,function(e){return n[e]})},v=function(g,m){var n,k;if(m._decCache&&m._decCache.regexp&&m._decCache.mapper&&m.length==m._decCache.length)n=m._decCache.mapper,k=m._decCache.regexp;else{n={};k=["("];var f;for(f=
0;f<m.length;f++){var e="\x26"+m[f][1]+";";f&&k.push("|");n[e]=m[f][0];k.push(e)}k.push(")");k=new RegExp(k.join(""),"g");m._decCache={mapper:n,regexp:k,length:m.length}}return g=g.replace(k,function(b){return n[b]})};g.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];g.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa",
"ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5",
"Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df",
"szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9",
"ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],
["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],
["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],
["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282",
"sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002",
"ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];g.encode=function(n,m){n&&(m?n=t(n,m):(n=t(n,g.html),n=t(n,g.latin)));return n};g.decode=function(n,m){n&&(m?n=v(n,m):(n=v(n,g.html),
n=v(n,g.latin)));return n};return g})},"esri/ArcadeExpression":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ./kernel ./layers/support/attributeUtils ./support/expressionUtils".split(" "),function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.ArcadeExpression",expression:null,profile:null,returnType:null,async:null,id:null,syntaxTree:null,_traits:null,_attributeDef:null,_attributeCache:null,_compiled:!1,constructor:function(m){g.mixin(this,m);this.returnType=this.returnType||"string";
this.id=n.getAttributeId(this.expression);this._setSyntaxTree(this.profile.parse(this));this.async=this.async||this.profile.isAsync(this)},hasGeometryOperations:function(){var g=this._traits.geometryOperations;void 0===g&&(g=this._traits.geometryOperations=m.hasGeometryOperations(this.syntaxTree));return g},hasFeatureSetOperations:function(){var g=this._traits.featureSetOperations;void 0===g&&(g=this._traits.featureSetOperations=m.hasFeatureSetOperations(this.syntaxTree));return g},hasVariable:function(g){var k=
this._traits.variables;void 0===k[g]&&(k[g]=m.hasVariable(this.syntaxTree,g));return k[g]},hasFunction:function(g){var k=this._traits.functions;void 0===k[g]&&(k[g]=m.hasFunction(this.syntaxTree,g));return k[g]},evaluate:function(g){this._compile();var k=this._attributeCache.compiledFunc;return this.async?m.executeAsyncFunction(k,g):m.executeFunction(k,g)},_setSyntaxTree:function(g){this.syntaxTree=g;this._compiled=!1;this._traits={variables:{},functions:{}};this._createLegacyValueObjects()},_createLegacyValueObjects:function(){this._attributeDef=
{valueExpression:this.expression};this._attributeCache={attributeInfo:this._attributeDef,isNumeric:"number"===this.returnType,idSource:this.expression,id:this.id,hasExpr:!0,compiledFunc:null,syntaxTree:this.syntaxTree,isScaleDriven:!1,dependsOnView:this.hasVariable("$view"),dependsOnGeometry:this.hasGeometryOperations(),isJSFunc:!1}},_compile:function(){this._compiled||(this._attributeCache.compiledFunc=this.profile.compile(this),this._compiled=!0)}})})},"esri/tasks/QueryTask":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/DeferredList ../kernel ../sniff ../request ../deferredUtils ../geometry/Extent ../geometry/normalizeUtils ./Task ./FeatureSet".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){var q=f("esri-pbf"),C=g(null,{url:null,query:null,requestOptions:null,pagination:null,pageSize:null,_fetchDfd:null,_startPage:null,_result:null,constructor:function(a){this._handleSuccess=t.hitch(this,this._handleSuccess);this._handleError=t.hitch(this,this._handleError);t.mixin(this,a);null==this.pagination&&(this.pagination=!1);null==this.pageSize&&(this.pageSize=1E3)},execute:function(){var a=new n(this._canceler);this._fetchDfd=a;this._result=null;this._sendRequest();
return a.promise},_canceler:function(a){var b=a._pendingRequest,c;a.isFulfilled()||!b||b.isFulfilled()||(b.cancel(),c=b.results&&b.results[1]);a._pendingRequest=null;return c},_sendRequest:function(a){var b=this.query;this.pagination&&(this._startPage=b.resultOffset=null==a?0:a,b.resultRecordCount=this.pageSize);a=this.requestOptions;this._fetchDfd._pendingRequest=e({url:this.url,content:b,handleAs:"pbf"===b.f?"arraybuffer":"json",callbackParamName:"callback",timeout:a&&a.timeout},a);this._fetchDfd._pendingRequest.then(this._handleSuccess).otherwise(this._handleError)},
_handleSuccess:function(a){this.pagination?(a.exceededTransferLimit&&this._sendRequest(this._startPage+this.pageSize),this._result?this._result.features=this._result.features.concat(a.features):this._result=a,this._fetchDfd.progress(a),a.exceededTransferLimit||this._fetchDfd.resolve(this._result)):(this._fetchDfd.progress(a),this._fetchDfd.resolve(a))},_handleError:function(a){this._fetchDfd.reject(a)}}),z=g(x,{declaredClass:"esri.tasks.QueryTask",_eventMap:{complete:["featureSet"],"execute-for-count-complete":["count"],
"execute-for-ids-complete":["objectIds"],"execute-relationship-query-complete":["featureSets"]},constructor:function(a,b){this._handler=t.hitch(this,this._handler);this._relationshipQueryHandler=t.hitch(this,this._relationshipQueryHandler);this._executeForIdsHandler=t.hitch(this,this._executeForIdsHandler);this._countHandler=t.hitch(this,this._countHandler);this._extentHandler=t.hitch(this,this._extentHandler);this.source=b&&b.source;this.gdbVersion=b&&b.gdbVersion;this.registerConnectEvents()},__msigns:[{n:"execute",
c:4,a:[{i:0,p:["geometry"]}],e:2},{n:"rawExecute",c:2,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForIds",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForCount",c:3,a:[{i:0,p:["geometry"]}],e:2},{n:"executeForExtent",c:3,a:[{i:0,p:["geometry"]}],e:2}],onComplete:function(){},onRawExecuteComplete:function(){},onExecuteRelationshipQueryComplete:function(){},onExecuteForIdsComplete:function(){},onExecuteForCountComplete:function(){},onExecuteForExtentComplete:function(){},execute:function(a,b,c,f,k){var g=
k.assembly;a=this._encode(t.mixin({},this._url.query,{f:f&&f.format||"json"},a.toJson(g&&g[0])));var w=this._handler,x=this._errorHandler;this.source&&(f={source:this.source.toJson()},a.layer=m.toJson(f));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);var p="pbf"===a.f;if(p){var B;q||(B="QueryTask.execute: 'pbf' format is not supported in your browser.");if(B)return a=new n,a.addErrback(function(a){x(a,c,k.dfd)}),a.reject(Error(B)),a}B=this.requestOptions;B=e({url:this._url.path+"/query",content:a,
callbackParamName:"callback",handleAs:p?"arraybuffer":"json",timeout:B&&B.timeout},B);a=[B];p&&a.push(z.loadPBFReader());(new u(a)).then(function(a){k.dfd.isFulfilled()||(a=a[0],a[0]?w(a[1],p,b,c,k.dfd):x(a[1],c,k.dfd))});return B},rawExecute:function(a,b,c){b=b||{};a=this._encode(t.mixin({},this._url.query,{f:b.format||"json"},a.toJson(c.assembly&&c.assembly[0])));this.source&&(a.layer=m.toJson({source:this.source.toJson()}));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);return(new C({url:this._url.path+
"/query",query:a,requestOptions:this.requestOptions,pagination:b.pagination,pageSize:b.pageSize})).execute().then(null,null,function(a){c.dfd.progress(a)}).then(t.hitch(this,function(a){this._successHandler([a],"onRawExecuteComplete",null,c.dfd)})).otherwise(t.hitch(this,function(a){this._errorHandler(a,null,c.dfd)}))},executeRelationshipQuery:function(a,c,f){a=this._encode(t.mixin({},this._url.query,{f:"json"},a.toJson()));var k=this._relationshipQueryHandler,g=this._errorHandler;this.gdbVersion&&
(a.gdbVersion=this.gdbVersion);var m=new n(b._dfdCanceller),q=this.requestOptions;m._pendingDfd=e({url:this._url.path+"/queryRelatedRecords",content:a,callbackParamName:"callback",timeout:q&&q.timeout,load:function(a,b){k(a,b,c,f,m)},error:function(a){g(a,f,m)}},q);return m},executeForIds:function(a,b,c,f){var k=f.assembly;a=this._encode(t.mixin({},this._url.query,{f:"json",returnIdsOnly:!0},a.toJson(k&&k[0])));var g=this._executeForIdsHandler,q=this._errorHandler;this.source&&(k={source:this.source.toJson()},
a.layer=m.toJson(k));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);k=this.requestOptions;return e({url:this._url.path+"/query",content:a,callbackParamName:"callback",timeout:k&&k.timeout,load:function(a,e){g(a,e,b,c,f.dfd)},error:function(a){q(a,c,f.dfd)}},k)},executeForCount:function(a,b,c,f){var k=f.assembly;a=this._encode(t.mixin({},this._url.query,{f:"json",returnIdsOnly:!0,returnCountOnly:!0},a.toJson(k&&k[0])));var g=this._countHandler,q=this._errorHandler;this.source&&(k={source:this.source.toJson()},
a.layer=m.toJson(k));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);k=this.requestOptions;return e({url:this._url.path+"/query",content:a,callbackParamName:"callback",timeout:k&&k.timeout,load:function(a,e){g(a,e,b,c,f.dfd)},error:function(a){q(a,c,f.dfd)}},k)},executeForExtent:function(a,b,c,f){var k=f.assembly;a=this._encode(t.mixin({},this._url.query,{f:"json",returnExtentOnly:!0,returnCountOnly:!0},a.toJson(k&&k[0])));var g=this._extentHandler,q=this._errorHandler;this.source&&(k={source:this.source.toJson()},
a.layer=m.toJson(k));this.gdbVersion&&(a.gdbVersion=this.gdbVersion);k=this.requestOptions;return e({url:this._url.path+"/query",content:a,callbackParamName:"callback",timeout:k&&k.timeout,load:function(a,e){g(a,e,b,c,f.dfd)},error:function(a){q(a,c,f.dfd)}},k)},_handler:function(a,b,c,e,f){try{a&&b&&(a=z.pbfDeps.optimizedFeatures.convertToFeatureSet(z.pbfDeps.pbfQueryUtils.parsePBFFeatureQuery(a)));var k=new w(a);this._successHandler([k],"onComplete",c,f)}catch(K){this._errorHandler(K,e,f)}},_relationshipQueryHandler:function(a,
b,c,e,f){try{var k=a.geometryType,g=a.spatialReference,m={};v.forEach(a.relatedRecordGroups,function(a){var b={};b.geometryType=k;b.spatialReference=g;b.features=a.relatedRecords;b=new w(b);if(null!=a.objectId)m[a.objectId]=b;else for(var c in a)a.hasOwnProperty(c)&&"relatedRecords"!==c&&(m[a[c]]=b)});this._successHandler([m],"onExecuteRelationshipQueryComplete",c,f)}catch(L){this._errorHandler(L,e,f)}},_executeForIdsHandler:function(a,b,c,e,f){try{this._successHandler([a.objectIds],"onExecuteForIdsComplete",
c,f)}catch(I){this._errorHandler(I,e,f)}},_countHandler:function(a,b,c,e,f){try{var k,g=a.features,m=a.objectIds;if(m)k=m.length;else{if(g)throw Error("Unable to perform query. Please check your parameters.");k=a.count}this._successHandler([k],"onExecuteForCountComplete",c,f)}catch(L){this._errorHandler(L,e,f)}},_extentHandler:function(b,c,e,f,k){try{b.extent&&(b.extent=new a(b.extent)),this._successHandler([b],"onExecuteForExtentComplete",e,k)}catch(I){this._errorHandler(I,f,k)}}});z.loadPBFReader=
function(){var a=new n;z.pbfDeps?a.resolve():p(["./support/pbfDeps"],function(b){z.pbfDeps=b;a.isFulfilled()||a.resolve()});return a.promise};c._createWrappers(z);return z})},"esri/tasks/Task":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../deferredUtils ../urlUtils ../Evented".split(" "),function(p,g,t,v,n,m,u,k){return p(k,{declaredClass:"esri.tasks._Task",_eventMap:{error:["error"],complete:["result"]},constructor:function(f,e){f&&g.isString(f)&&(this._url=
u.urlToObject(this.url=f));e&&e.requestOptions&&(this.requestOptions=e.requestOptions);this.normalization=!0;this._errorHandler=g.hitch(this,this._errorHandler);this.registerConnectEvents()},_useSSL:function(){var f=this._url,e=/^http:/i;this.url&&(this.url=this.url.replace(e,"https:"));f&&f.path&&(f.path=f.path.replace(e,"https:"))},_encode:function(f,e,b){var a,c,k={},m,q;for(m in f)if("declaredClass"!==m&&(a=f[m],c=typeof a,null!==a&&void 0!==a&&"function"!==c))if(g.isArray(a))for(k[m]=[],q=a.length,
c=0;c<q;c++)k[m][c]=this._encode(a[c]);else"object"===c?a.toJson&&(c=a.toJson(b&&b[m]),"esri.tasks.FeatureSet"===a.declaredClass&&c.spatialReference&&(c.sr=c.spatialReference,delete c.spatialReference),k[m]=e?c:t.toJson(c)):k[m]=a;return k},_successHandler:function(f,e,b,a){e&&this[e].apply(this,f);b&&b.apply(null,f);a&&m._resDfd(a,f)},_errorHandler:function(f,e,b){this.onError(f);e&&e(f);b&&b.errback(f)},setNormalization:function(f){this.normalization=f},onError:function(){}})})},"esri/tasks/FeatureSet":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/Polygon ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){p=p(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(c,e){if(c){g.mixin(this,c);var f=this.features=this.features||[],m=c.spatialReference,m=this.spatialReference=b.createInstance(k.simpleConstructor,m),x=b.getGeometryType(c.geometryType);this.geometryType=c.geometryType;c.fields&&(this.fields=c.fields);c=b.supportsLazyUnquantization(this.geometryType);var n=b.unquantizeFunction(this.geometryType,this.transform),p=!!(e&&c&&n),B=x&&(p?x.accessorConstructor:
x.simpleConstructor);t.forEach(f,function(c,e){var g=b.createInstance(u.simpleConstructor),q=c.geometry;if(x&&q){var w=g.geometry=b.createInstance(B,p?null:q);w.setSpatialReference(q.spatialReference?b.createInstance(k.simpleConstructor,q.spatialReference):m);p&&w.setupLazyUnquantization(n,q)}g.symbol=c.symbol?a.fromJson(c.symbol):null;g.attributes=c.attributes;f[e]=g});p||this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var c=
{};this.displayFieldName&&(c.displayFieldName=this.displayFieldName);this.fields&&(c.fields=this.fields);this.spatialReference?c.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(c.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(c.geometryType=b.getJsonType(this.features[0].geometry)),c.features=f._encodeGraphics(this.features,a));c.geometryType=c.geometryType||this.geometryType;c.exceededTransferLimit=
this.exceededTransferLimit;c.transform=this.transform;return m.fixJson(c)},_hydrate:function(){b.unquantize(this.features,this.geometryType,this.transform);this.transform=null},quantize:function(a){if(!this.geometryType)return this.transform=null,this;var b=a.translate[0],c=a.translate[1],e=a.scale[0],f=a.scale[1],k=this.features,g=function(a,b,c){var e,f,k,g,m,q,w=[];e=0;for(f=a.length;e<f;e++)if(k=a[e],0<e){if(q=b(k[0]),k=c(k[1]),q!==g||k!==m)w.push([q-g,k-m]),g=q,m=k}else g=b(k[0]),m=c(k[1]),w.push([g,
m]);return 0<w.length?w:null},m=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y);return a};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){var e,f,k,m,q;k=a.rings||a.paths;q=[];e=0;for(f=k.length;e<f;e++)m=k[e],(m=g(m,b,c))&&q.push(m);return 0<q.length?(a.rings?a.rings=q:a.paths=q,a):null};if("esriGeometryMultipoint"===a)return function(a){var e;e=g(a.points,b,c);return 0<e.length?(a.points=e,a):null};if("esriGeometryEnvelope"===a)return function(a){return a}}(this.geometryType,
function(a){return Math.round((a-b)/e)},function(a){return Math.round((c-a)/f)}),n,u;n=0;for(u=k.length;n<u;n++)k[n].geometry&&(m(k[n].geometry)||k[n].setGeometry(null));this.transform=a;return this}});p.createGraphics=function(a){var c=a.geometryType,e=b.createInstance(k.simpleConstructor,a.spatialReference),f=b.getGeometryType(c).accessorConstructor,g=b.unquantizeFunction(c,a.transform);return t.map(a.features,function(a,c){c=b.createInstance(u.simpleConstructor);var k=a.geometry;if(k){var m=c.geometry=
b.createInstance(f);m.setSpatialReference(e);m.setupLazyUnquantization(g,k)}c.attributes=a.attributes;return c})};p.createPolygon=function(a,f,k){var c;a&&(c=b.createInstance(e.accessorConstructor),c.setSpatialReference(f),f=b.unquantizeFunction("esriGeometryPolygon",k),c.setupLazyUnquantization(f,a));return c};return p})},"esri/graphicsUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","./kernel","./geometry/Extent"],function(p,g,t,v,n){return{graphicsExtent:function(g){if(!g||
!g.length)return null;var m=null,k,f=g.length;for(k=0;k<f;k++){var e=g[k].geometry;if(e){var b=e.getExtent();b||"point"!==e.type||null==e.x||null==e.y||(b=new n(e.x,e.y,e.x,e.y,e.spatialReference));b&&(m=m?m.union(b):b)}}return 0>m.getWidth()&&0>m.getHeight()?null:m},getGeometries:function(m){return g.map(m,function(g){return g.geometry})},_encodeGraphics:function(m,n){return g.map(m,function(k,f){k=k.toJson();var e={};k.geometry&&(f=n&&n[f],e.geometry=f&&f.toJson()||k.geometry);k.attributes&&(e.attributes=
k.attributes);return e})}}})},"esri/tasks/RelationshipQuery":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/json","dojo/has","../kernel"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.tasks.RelationshipQuery",definitionExpression:"",relationshipId:null,returnGeometry:!1,objectIds:null,outSpatialReference:null,outFields:null,orderByFields:null,toJson:function(){var g={definitionExpression:this.definitionExpression,relationshipId:this.relationshipId,returnGeometry:this.returnGeometry,
maxAllowableOffset:this.maxAllowableOffset,geometryPrecision:this.geometryPrecision},n=this.objectIds,k=this.outFields,f=this.outSpatialReference,e=this.orderByFields;n&&(g.objectIds=n.join(","));k&&(g.outFields=k.join(","));f&&(g.outSR=f.wkid||t.toJson(f.toJson()));e&&(g.orderByFields=e.join(","));g._ts=this._ts;return g}})})},"esri/tasks/StatisticDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p(null,{declaredClass:"esri.tasks.StatisticDefinition",
toJson:function(){return{statisticType:this.statisticType,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount}}})})},"esri/arcadeProfiles/popupProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../support/expressionUtils ./utils".split(" "),function(p,g,t,v,n,m,u,k){return new (p(null,{declaredClass:"esri.arcadeProfiles.PopupProfile",
defaults:{globals:{featureSet:["$layer","$datastore","$map"],async:["$layer","$datastore","$map"]},context:{vars:{$feature:"any",$layer:"any",$datastore:"any",$map:"any"}}},initialize:function(f){var e=[];k.hasGeometryOperations(f)&&e.push(u.enableGeometryOperations());(k.hasFeatureSetOperations(f)||k.hasVariables(f,this.defaults.globals.featureSet))&&e.push(u.enableFeatureSetOperations());k.isAsync(f)&&e.push(u.enableAsyncOperations());return n(e)},isAsync:function(f){f=[f];return k.hasFeatureSetOperations(f)||
k.hasVariables(f,this.defaults.globals.async)},parse:function(f){return u.createSyntaxTree(f.expression)},compile:function(f){var e=g.clone(this.defaults.context);e.useAsync=f.async;return f.syntaxTree?u.createFunction(f.syntaxTree,e):null},getEvalOptions:function(f){var e=f.expression,b=f.feature,a=f.layer,c=f.map;f=f.spatialReference;var b=b&&e.hasVariable("$feature")?m.createFromGraphicLikeObject(b.geometry,b.attributes,a):null,g,w;if(a){var q={spatialReference:f};e.hasVariable("$layer")&&(g=a.getMap()?
u.createFeatureSetFromLayer(a,q):u.createFeatureSetFromLayerUrl(a.url,q));e.hasVariable("$datastore")&&(w=(w=k.getServiceUrl(a.url))?u.createFeatureSetCollectionFromServiceUrl(w,q):null)}e=c&&e.hasVariable("$map")?u.createFeatureSetCollectionFromMap(c):null;return{context:{vars:{$feature:b,$layer:g,$datastore:w,$map:e},spatialReference:f}}}}))})},"esri/dijit/PopupRenderer":function(){define("require dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/sniff dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojox/html/entities dijit/_Widget dijit/_Templated ../kernel ../lang ../urlUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){var F=0,D=G.widgets.popup,I=G.widgets.templatePicker;return g([B,w,q],{declaredClass:"esri.dijit._PopupRenderer",constructor:function(){this._nls=v.mixin({},D)},templateString:"\x3cdiv class\x3d'esriViewPopup'\x3e\x3cdiv class\x3d'statusSection hidden' dojoAttachPoint\x3d'_status'\x3e\x3c/div\x3e\x3cdiv class\x3d'mainSection'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_title'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d'_description'\x3e\x3c/div\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'attachmentsSection hidden'\x3e\x3cdiv\x3e${_nls.NLS_attach}:\x3c/div\x3e\x3cul dojoAttachPoint\x3d'_attachmentsList'\x3e\x3c/ul\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaSection hidden'\x3e\x3cdiv class\x3d'header' dojoAttachPoint\x3d'_mediaTitle'\x3e\x3c/div\x3e\x3cdiv class\x3d'hzLine'\x3e\x3c/div\x3e\x3cdiv class\x3d'caption' dojoAttachPoint\x3d'_mediaCaption'\x3e\x3c/div\x3e\x3cdiv class\x3d'gallery' dojoAttachPoint\x3d'_gallery'\x3e\x3cdiv class\x3d'mediaHandle prev' dojoAttachPoint\x3d'_prevMedia' dojoAttachEvent\x3d'onclick: _goToPrevMedia'\x3e\x3c/div\x3e\x3cdiv class\x3d'mediaHandle next' dojoAttachPoint\x3d'_nextMedia' dojoAttachEvent\x3d'onclick: _goToNextMedia'\x3e\x3c/div\x3e\x3cul class\x3d'summary'\x3e\x3cli class\x3d'image mediaCount hidden' dojoAttachPoint\x3d'_imageCount'\x3e0\x3c/li\x3e\x3cli class\x3d'image mediaIcon hidden'\x3e\x3c/li\x3e\x3cli class\x3d'chart mediaCount hidden' dojoAttachPoint\x3d'_chartCount'\x3e0\x3c/li\x3e\x3cli class\x3d'chart mediaIcon hidden'\x3e\x3c/li\x3e\x3c/ul\x3e\x3cdiv class\x3d'frame' dojoAttachPoint\x3d'_mediaFrame'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummarySection hidden' dojoAttachPoint\x3d'_editSummarySection'\x3e\x3cdiv class\x3d'break'\x3e\x3c/div\x3e\x3cdiv class\x3d'break hidden' dojoAttachPoint\x3d'_mediaBreak'\x3e\x3c/div\x3e\x3cdiv class\x3d'editSummary' dojoAttachPoint\x3d'_editSummary'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
showTitle:!0,startup:function(){this.inherited(arguments);this._showStatus(I.loading);this._contentDfd=this.template.getComponents(this.graphic).then(v.hitch(this,this._handleComponentsSuccess)).otherwise(v.hitch(this,this._handleComponentsError))},destroy:function(){this._contentDfd&&this._contentDfd.cancel();this._attachmentsDfd&&this._attachmentsDfd.cancel();this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._contentDfd=this._attachmentsDfd=null;this.inherited(arguments)},
_goToPrevMedia:function(){0>this._mediaPtr-1||(this._mediaPtr--,this._updateUI(),this._displayMedia())},_goToNextMedia:function(){this._mediaPtr+1!==this._mediaInfos.length&&(this._mediaPtr++,this._updateUI(),this._displayMedia())},_updateUI:function(){var a=this._mediaInfos,c=a.length,f=this.domNode,k=this._prevMedia,g=this._nextMedia;if(1<c){var q=0,w=0;n.forEach(a,function(a){"image"===a.type?q++:-1!==a.type.indexOf("chart")&&w++});q&&(e.set(this._imageCount,"innerHTML",q),m.query(".summary .image",
f).removeClass("hidden"));w&&(e.set(this._chartCount,"innerHTML",w),m.query(".summary .chart",f).removeClass("hidden"))}else m.query(".summary",f).addClass("hidden"),b.add(k,"hidden"),b.add(g,"hidden");a=this._mediaPtr;0===a?b.add(k,"hidden"):b.remove(k,"hidden");a===c-1?b.add(g,"hidden"):b.remove(g,"hidden");this._destroyFrame()},_displayMedia:function(){var a=this._mediaInfos[this._mediaPtr],c=a.title,f=a.caption,k=m.query(".mediaSection .hzLine",this.domNode)[0];e.set(this._mediaTitle,"innerHTML",
c);b[c?"remove":"add"](this._mediaTitle,"hidden");e.set(this._mediaCaption,"innerHTML",f);b[f?"remove":"add"](this._mediaCaption,"hidden");b[c&&f?"remove":"add"](k,"hidden");this._rid=null;if("image"===a.type)this._showImage(a);else{var g=this,c=["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip"],f=a.value.theme||this.chartTheme;v.isString(f)&&(f=f.replace(/\./gi,"/"),-1===f.indexOf("/")&&(f="dojox/charting/themes/"+f));f||(f="./Rainbow");c.push(f);try{var q=this._rid=F++;p(c,function(b,
c,e){q===g._rid&&(g._rid=null,g._showChart(a.type,a.value,b,c,e))})}catch(T){console.log("PopupRenderer: error loading modules")}}},_preventNewTab:function(a){return(a=a&&v.trim(a).toLowerCase())&&(0===a.indexOf("mailto:")||0===a.indexOf("tel:"))},_showImage:function(e){b.add(this._mediaFrame,"image");var f=c.get(this._gallery,"height"),k=e.value,g;k.linkURL&&(g=a.create("a",{href:k.linkURL,target:this._preventNewTab(k.linkURL)?"":"_blank"},this._mediaFrame));k=e.refreshInterval?this._addURLParameter(k.sourceURL,
"timestamp",Date.now()):k.sourceURL;a.create("img",{className:"esriPopupMediaImage",src:k},g||this._mediaFrame);var q=m.query(".esriPopupMediaImage",this._mediaFrame)[0];this._imageLoadHandle=t.connect(q,"onload",this,function(){this._clearImageHandles();this._imageLoaded(q,f);this._initImageRefresh(e)})},_addURLParameter:function(a,b,c){var e=-1===a.indexOf("?")?"?":"\x26";return a+e+b+"\x3d"+c},_initImageRefresh:function(a){if(a.refreshInterval){var b=6E4*a.refreshInterval;this._imageRefreshHandle=
setTimeout(v.hitch(this,function(){this._destroyFrame();this._showImage(a)}),b)}},_clearImageHandles:function(){t.disconnect(this._imageLoadHandle);this._imageLoadHandle=null;clearTimeout(this._imageRefreshHandle);this._imageRefreshHandle=null},_showChart:function(c,e,f,k,g){b.remove(this._mediaFrame,"image");f=this._chart=new f(a.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});g&&f.setTheme(g);switch(c){case "piechart":f.addPlot("default",{type:"Pie",labels:!1});f.addSeries("Series A",
e.fields);break;case "linechart":f.addPlot("default",{type:"Markers"});f.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});f.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});n.forEach(e.fields,function(a,b){a.x=b+1});f.addSeries("Series A",e.fields);break;case "columnchart":f.addPlot("default",{type:"Columns",gap:3});f.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});f.addSeries("Series A",e.fields);break;case "barchart":f.addPlot("default",{type:"Bars",
gap:3}),f.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),f.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),f.addSeries("Series A",e.fields)}this._action=new k(f);f.render()},_destroyFrame:function(){this._rid=null;this._clearImageHandles();this._chart&&(this._chart.destroy(),this._chart=null);this._action&&(this._action.destroy(),this._action=null);e.set(this._mediaFrame,"innerHTML","")},_imageLoaded:function(a,b){var e=a.height;e<b&&c.set(a,"marginTop",
Math.round((b-e)/2)+"px")},_attListHandler:function(a,b){if(a===this._attachmentsDfd){this._attachmentsDfd=null;var c="";b instanceof Error||!b||!b.length||n.forEach(b,function(a){c+="\x3cli\x3e";c+="\x3ca href\x3d'"+E.addProxy(a.url)+"' target\x3d'_blank'\x3e"+(a.name||"[No name]")+"\x3c/a\x3e";c+="\x3c/li\x3e"});e.set(this._attachmentsList,"innerHTML",c||"\x3cli\x3e"+this._nls.NLS_noAttach+"\x3c/li\x3e")}},_supportedURIInfos:[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,label:D.NLS_moreInfo},{pattern:/^\s*(tel:([^\s]+))\s*$/i,
label:"${hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"${hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,appName:"App Studio Player",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,appName:"Collector",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,appName:"Explorer",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,appName:"Navigator",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,
appName:"Survey123",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,appName:"Trek2There",label:D.NLS_openLinkInApp},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,appName:"Workforce",label:D.NLS_openLinkInApp},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,appName:"iForm",label:D.NLS_openLinkInApp},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,appName:"FlowFinity",label:D.NLS_openLinkInApp},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,appName:"Laserfische",label:D.NLS_openLinkInApp},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,appName:"Microsoft Power BI",label:D.NLS_openLinkInApp}],_findURIInfo:function(a){var b;n.some(this._supportedURIInfos,function(c){c.pattern.test(a)&&(b=c);return!!b});return b},_createLinkIfURI:function(a){var b=this._findURIInfo(a);if(b){var c=a.match(b.pattern);return a.replace(b.pattern,"\x3ca target\x3d'_blank' href\x3d'$1' title\x3d'$1'\x3e"+z.substitute({appName:b.appName,hierPart:c&&c[2]},b.label)+"\x3c/a\x3e")}return a},_showStatus:function(a){e.set(this._status,
"innerHTML",a);b.remove(this._status,"hidden");m.query(".mainSection",this.domNode).addClass("hidden")},_hideStatus:function(){e.set(this._status,"innerHTML","");b.add(this._status,"hidden");m.query(".mainSection",this.domNode).removeClass("hidden")},_handleComponentsSuccess:function(a){if(a){this._hideStatus();var c=this.showTitle?a.title:"",k=a.description,g=a.fields,q=a.mediaInfos,w=this.domNode,u=this._nls,p=this,B=this.template,z=this.graphic;this._prevMedia.title=u.NLS_prevMedia;this._nextMedia.title=
u.NLS_nextMedia;e.set(this._title,"innerHTML",c);c||b.add(this._title,"hidden");!a.hasDescription&&g&&(k="",n.forEach(g,function(a){k+="\x3ctr valign\x3d'top'\x3e";k+="\x3ctd class\x3d'attrName'\x3e"+x.encode(a[0])+"\x3c/td\x3e";k+="\x3ctd class\x3d'attrValue'\x3e"+this._createLinkIfURI(a[1])+"\x3c/td\x3e";k+="\x3c/tr\x3e"},this),k&&(k="\x3ctable class\x3d'attrTable' cellpadding\x3d'0px' cellspacing\x3d'0px'\x3e"+k+"\x3c/table\x3e"));e.set(this._description,"innerHTML",k);k||b.add(this._description,
"hidden");m.query("a",this._description).forEach(function(a){p._preventNewTab(a.href)?"_blank"===a.target&&e.remove(a,"target"):e.set(a,"target","_blank")});c&&k?m.query(".mainSection .hzLine",w).removeClass("hidden"):c||k?m.query(".mainSection .hzLine",w).addClass("hidden"):m.query(".mainSection",w).addClass("hidden");if(c=this._attachmentsDfd=B.getAttachments(z))c.addBoth(v.hitch(this,this._attListHandler,c)),e.set(this._attachmentsList,"innerHTML","\x3cli\x3e"+u.NLS_searching+"...\x3c/li\x3e"),
m.query(".attachmentsSection",w).removeClass("hidden");q&&q.length&&(m.query(".mediaSection",w).removeClass("hidden"),f.setSelectable(this._mediaFrame,!1),this._mediaInfos=q,this._mediaPtr=0,this._updateUI(),this._displayMedia());a.editSummary&&(e.set(this._editSummary,"innerHTML",a.editSummary),q&&q.length&&b.remove(this._mediaBreak,"hidden"),b.remove(this._editSummarySection,"hidden"));this.emit("content-update")}else this._showStatus(D.NLS_noInfo)},_handleComponentsError:function(a){a&&"cancel"===
a.dojoType||(console.log("PopupRenderer: error loading template",a),this._showStatus(D.NLS_noInfo))}})})},"dijit/_Widget":function(){define("dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/has dojo/_base/kernel dojo/_base/lang dojo/query dojo/ready ./registry ./_WidgetBase ./_OnDijitClickMixin ./_FocusMixin dojo/uacss ./hccss".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){function x(){}function w(a){return function(b,c,e,f){return b&&"string"==typeof c&&b[c]==x?b.on(c.substring(2).toLowerCase(),
u.hitch(e,f)):a.apply(t,arguments)}}p.around(t,"connect",w);m.connect&&p.around(m,"connect",w);p=v("dijit._Widget",[b,a,c],{onClick:x,onDblClick:x,onKeyDown:x,onKeyPress:x,onKeyUp:x,onMouseDown:x,onMouseMove:x,onMouseOut:x,onMouseOver:x,onMouseLeave:x,onMouseEnter:x,onMouseUp:x,constructor:function(a){this._toConnect={};for(var b in a)this[b]===x&&(this._toConnect[b.replace(/^on/,"").toLowerCase()]=a[b],delete a[b])},postCreate:function(){this.inherited(arguments);for(var a in this._toConnect)this.on(a,
this._toConnect[a]);delete this._toConnect},on:function(a,b){return this[this._onMap(a)]===x?t.connect(this.domNode,a.toLowerCase(),this,b):this.inherited(arguments)},_setFocusedAttr:function(a){this._focused=a;this._set("focused",a)},setAttribute:function(a,b){m.deprecated(this.declaredClass+"::setAttribute(attr, value) is deprecated. Use set() instead.","","2.0");this.set(a,b)},attr:function(a,b){return 2<=arguments.length||"object"===typeof a?this.set.apply(this,arguments):this.get(a)},getDescendants:function(){m.deprecated(this.declaredClass+
"::getDescendants() is deprecated. Use getChildren() instead.","","2.0");return this.containerNode?k("[widgetId]",this.containerNode).map(e.byNode):[]},_onShow:function(){this.onShow()},onShow:function(){},onHide:function(){},onClose:function(){return!0}});n("dijit-legacy-requires")&&f(0,function(){require(["dijit/_base"])});return p})},"dijit/_WidgetBase":function(){define("require dojo/_base/array dojo/aspect dojo/_base/config dojo/_base/connect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/_base/kernel dojo/_base/lang dojo/on dojo/ready dojo/Stateful dojo/topic dojo/_base/window ./Destroyable dojo/has!dojo-bidi?./_BidiMixin ./registry".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){function I(a){return function(b){k[b?"set":"remove"](this.domNode,a,b);this._set(a,b)}}c.add("dijit-legacy-requires",!x.isAsync);c.add("dojo-bidi",!1);c("dijit-legacy-requires")&&C(0,function(){p(["dijit/_base/manager"])});var K={};v=m("dijit._WidgetBase",[z,G],{id:"",_setIdAttr:"domNode",lang:"",_setLangAttr:I("lang"),dir:"",_setDirAttr:I("dir"),"class":"",_setClassAttr:{node:"domNode",type:"class"},_setTypeAttr:null,style:"",title:"",tooltip:"",
baseClass:"",srcNodeRef:null,domNode:null,containerNode:null,ownerDocument:null,_setOwnerDocumentAttr:function(a){this._set("ownerDocument",a)},attributeMap:{},_blankGif:v.blankGif||p.toUrl("dojo/resources/blank.gif"),textDir:"",_introspect:function(){var a=this.constructor;if(!a._setterAttrs){var b=a.prototype,c=a._setterAttrs=[],a=a._onMap={},e;for(e in b.attributeMap)c.push(e);for(e in b)/^on/.test(e)&&(a[e.substring(2).toLowerCase()]=e),/^_set[A-Z](.*)Attr$/.test(e)&&(e=e.charAt(4).toLowerCase()+
e.substr(5,e.length-9),b.attributeMap&&e in b.attributeMap||c.push(e))}},postscript:function(a,b){this.create(a,b)},create:function(a,b){this._introspect();this.srcNodeRef=u.byId(b);this._connects=[];this._supportingWidgets=[];this.srcNodeRef&&this.srcNodeRef.id&&"string"==typeof this.srcNodeRef.id&&(this.id=this.srcNodeRef.id);a&&(this.params=a,w.mixin(this,a));this.postMixInProperties();this.id||(this.id=D.getUniqueId(this.declaredClass.replace(/\./g,"_")),this.params&&delete this.params.id);this.ownerDocument=
this.ownerDocument||(this.srcNodeRef?this.srcNodeRef.ownerDocument:document);this.ownerDocumentBody=B.body(this.ownerDocument);D.add(this);this.buildRendering();var c;this.domNode&&(this._applyAttributes(),(a=this.srcNodeRef)&&a.parentNode&&this.domNode!==a&&(a.parentNode.replaceChild(this.domNode,a),c=!0),this.domNode.setAttribute("widgetId",this.id));this.postCreate();c&&delete this.srcNodeRef;this._created=!0},_applyAttributes:function(){var a={},b;for(b in this.params||{})a[b]=this._get(b);g.forEach(this.constructor._setterAttrs,
function(b){if(!(b in a)){var c=this._get(b);c&&this.set(b,c)}},this);for(b in a)this.set(b,a[b])},postMixInProperties:function(){},buildRendering:function(){this.domNode||(this.domNode=this.srcNodeRef||this.ownerDocument.createElement("div"));if(this.baseClass){var a=this.baseClass.split(" ");this.isLeftToRight()||(a=a.concat(g.map(a,function(a){return a+"Rtl"})));f.add(this.domNode,a)}},postCreate:function(){},startup:function(){this._started||(this._started=!0,g.forEach(this.getChildren(),function(a){a._started||
a._destroyed||!w.isFunction(a.startup)||(a.startup(),a._started=!0)}))},destroyRecursive:function(a){this._beingDestroyed=!0;this.destroyDescendants(a);this.destroy(a)},destroy:function(a){function b(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a)}this._beingDestroyed=!0;this.uninitialize();g.forEach(this._connects,w.hitch(this,"disconnect"));g.forEach(this._supportingWidgets,b);this.domNode&&g.forEach(D.findWidgets(this.domNode,this.containerNode),b);this.destroyRendering(a);
D.remove(this.id);this._destroyed=!0},destroyRendering:function(a){this.bgIframe&&(this.bgIframe.destroy(a),delete this.bgIframe);this.domNode&&(a?k.remove(this.domNode,"widgetId"):e.destroy(this.domNode),delete this.domNode);this.srcNodeRef&&(a||e.destroy(this.srcNodeRef),delete this.srcNodeRef)},destroyDescendants:function(a){g.forEach(this.getChildren(),function(b){b.destroyRecursive&&b.destroyRecursive(a)})},uninitialize:function(){return!1},_setStyleAttr:function(b){var c=this.domNode;w.isObject(b)?
a.set(c,b):c.style.cssText=c.style.cssText?c.style.cssText+("; "+b):b;this._set("style",b)},_attrToDom:function(a,b,c){c=3<=arguments.length?c:this.attributeMap[a];g.forEach(w.isArray(c)?c:[c],function(c){var e=this[c.node||c||"domNode"];switch(c.type||"attribute"){case "attribute":w.isFunction(b)&&(b=w.hitch(this,b));c=c.attribute?c.attribute:/^on[A-Z][a-zA-Z]*$/.test(a)?a.toLowerCase():a;e.tagName?k.set(e,c,b):e.set(c,b);break;case "innerText":e.innerHTML="";e.appendChild(this.ownerDocument.createTextNode(b));
break;case "textContent":e.textContent=b;break;case "innerHTML":e.innerHTML=b;break;case "class":f.replace(e,b,this[a]);break;case "toggleClass":f.toggle(e,c.className||a,b)}},this)},get:function(a){var b=this._getAttrNames(a);return this[b.g]?this[b.g]():this._get(a)},set:function(a,b){if("object"===typeof a){for(var c in a)this.set(c,a[c]);return this}c=this._getAttrNames(a);var e=this[c.s];if(w.isFunction(e))var f=e.apply(this,Array.prototype.slice.call(arguments,1));else{var e=this.focusNode&&
!w.isFunction(this.focusNode)?"focusNode":"domNode",k=this[e]&&this[e].tagName,g;if((g=k)&&!(g=K[k])){g=this[e];var m={},q;for(q in g)m[q.toLowerCase()]=!0;g=K[k]=m}q=g;c=a in this.attributeMap?this.attributeMap[a]:c.s in this?this[c.s]:q&&c.l in q&&"function"!=typeof b||/^aria-|^data-|^role$/.test(a)?e:null;null!=c&&this._attrToDom(a,b,c);this._set(a,b)}return f||this},_attrPairNames:{},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var c=a.replace(/^[a-z]|-[a-zA-Z]/g,function(a){return a.charAt(a.length-
1).toUpperCase()});return b[a]={n:a+"Node",s:"_set"+c+"Attr",g:"_get"+c+"Attr",l:c.toLowerCase()}},_set:function(a,b){var c=this[a];this[a]=b;!this._created||c===b||c!==c&&b!==b||(this._watchCallbacks&&this._watchCallbacks(a,c,b),this.emit("attrmodified-"+a,{detail:{prevValue:c,newValue:b}}))},_get:function(a){return this[a]},emit:function(a,b,c){b=b||{};void 0===b.bubbles&&(b.bubbles=!0);void 0===b.cancelable&&(b.cancelable=!0);b.detail||(b.detail={});b.detail.widget=this;var e,f=this["on"+a];f&&
(e=f.apply(this,c?c:[b]));this._started&&!this._beingDestroyed&&q.emit(this.domNode,a.toLowerCase(),b);return e},on:function(a,b){var c=this._onMap(a);return c?t.after(this,c,b,!0):this.own(q(this.domNode,a,b))[0]},_onMap:function(a){var b=this.constructor,c=b._onMap;if(!c){var c=b._onMap={},e;for(e in b.prototype)/^on/.test(e)&&(c[e.replace(/^on/,"").toLowerCase()]=e)}return c["string"==typeof a&&a.toLowerCase()]},toString:function(){return"[Widget "+this.declaredClass+", "+(this.id||"NO ID")+"]"},
getChildren:function(){return this.containerNode?D.findWidgets(this.containerNode):[]},getParent:function(){return D.getEnclosingWidget(this.domNode.parentNode)},connect:function(a,b,c){return this.own(n.connect(a,b,this,c))[0]},disconnect:function(a){a.remove()},subscribe:function(a,b){return this.own(E.subscribe(a,w.hitch(this,b)))[0]},unsubscribe:function(a){a.remove()},isLeftToRight:function(){return this.dir?"ltr"==this.dir.toLowerCase():b.isBodyLtr(this.ownerDocument)},isFocusable:function(){return this.focus&&
"none"!=a.get(this.domNode,"display")},placeAt:function(a,b){var c=!a.tagName&&D.byId(a);!c||!c.addChild||b&&"number"!==typeof b?(a=c&&"domNode"in c?c.containerNode&&!/after|before|replace/.test(b||"")?c.containerNode:c.domNode:u.byId(a,this.ownerDocument),e.place(this.domNode,a,b),!this._started&&(this.getParent()||{})._started&&this.startup()):c.addChild(this,b);return this},defer:function(a,b){var c=setTimeout(w.hitch(this,function(){c&&(c=null,this._destroyed||w.hitch(this,a)())}),b||0);return{remove:function(){c&&
(clearTimeout(c),c=null);return null}}}});c("dojo-bidi")&&v.extend(F);return v})},"dijit/Destroyable":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare"],function(p,g,t){return t("dijit.Destroyable",null,{destroy:function(g){this._destroyed=!0},own:function(){var v=["destroyRecursive","destroy","remove"];p.forEach(arguments,function(n){function m(){k.remove();p.forEach(f,function(e){e.remove()})}var u,k=g.before(this,"destroy",function(e){n[u](e)}),f=[];n.then?(u="cancel",n.then(m,
m)):p.forEach(v,function(e){"function"===typeof n[e]&&(u||(u=e),f.push(g.after(n,e,m,!0)))})},this);return arguments}})})},"dijit/_OnDijitClickMixin":function(){define("dojo/on dojo/_base/array dojo/keys dojo/_base/declare dojo/has ./a11yclick".split(" "),function(p,g,t,v,n,m){p=v("dijit._OnDijitClickMixin",null,{connect:function(g,k,f){return this.inherited(arguments,[g,"ondijitclick"==k?m:k,f])}});p.a11yclick=m;return p})},"dijit/_FocusMixin":function(){define(["./focus","./_WidgetBase","dojo/_base/declare",
"dojo/_base/lang"],function(p,g,t,v){v.extend(g,{focused:!1,onFocus:function(){},onBlur:function(){},_onFocus:function(){this.onFocus()},_onBlur:function(){this.onBlur()}});return t("dijit._FocusMixin",null,{_focusManager:p})})},"dijit/hccss":function(){define(["dojo/dom-class","dojo/hccss","dojo/domReady","dojo/_base/window"],function(p,g,t,v){t(function(){g("highcontrast")&&p.add(v.body(),"dijit_a11y")});return g})},"dojo/hccss":function(){define("require ./_base/config ./dom-class ./dom-style ./has ./domReady ./_base/window".split(" "),
function(p,g,t,v,n,m,u){n.add("highcontrast",function(){var k=u.doc.createElement("div");try{k.style.cssText='border: 1px solid; border-color:red green; position: absolute; height: 5px; top: -999px;background-image: url("'+(g.blankGif||p.toUrl("./resources/blank.gif"))+'");';u.body().appendChild(k);var f=v.getComputedStyle(k),e=f.backgroundImage;return f.borderTopColor==f.borderRightColor||e&&("none"==e||"url(invalid-url:)"==e)}catch(b){return console.warn("hccss: exception detecting high-contrast mode, document is likely hidden: "+
b.toString()),!1}finally{8>=n("ie")?k.outerHTML="":u.body().removeChild(k)}});m(function(){n("highcontrast")&&t.add(u.body(),"dj_a11y")});return n})},"dijit/_Templated":function(){define("./_WidgetBase ./_TemplatedMixin ./_WidgetsInTemplateMixin dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/kernel".split(" "),function(p,g,t,v,n,m,u){m.extend(p,{waiRole:"",waiState:""});return n("dijit._Templated",[g,t],{constructor:function(){u.deprecated(this.declaredClass+": dijit._Templated deprecated, use dijit._TemplatedMixin and if necessary dijit._WidgetsInTemplateMixin",
"","2.0")},_processNode:function(k,f){var e=this.inherited(arguments),b=f(k,"waiRole");b&&k.setAttribute("role",b);(b=f(k,"waiState"))&&v.forEach(b.split(/\s*,\s*/),function(a){-1!=a.indexOf("-")&&(a=a.split("-"),k.setAttribute("aria-"+a[0],a[1]))});return e}})})},"dijit/_TemplatedMixin":function(){define("dojo/cache dojo/_base/declare dojo/dom-construct dojo/_base/lang dojo/on dojo/sniff dojo/string ./_AttachMixin".split(" "),function(p,g,t,v,n,m,u,k){var f=g("dijit._TemplatedMixin",k,{templateString:null,
templatePath:null,_skipNodeCache:!1,searchContainerNode:!0,_stringRepl:function(e){var b=this.declaredClass,a=this;return u.substitute(e,this,function(c,e){"!"==e.charAt(0)&&(c=v.getObject(e.substr(1),!1,a));if("undefined"==typeof c)throw Error(b+" template:"+e);return null==c?"":"!"==e.charAt(0)?c:this._escapeValue(""+c)},this)},_escapeValue:function(e){return e.replace(/["'<>&]/g,function(b){return{"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}[b]})},buildRendering:function(){if(!this._rendered){this.templateString||
(this.templateString=p(this.templatePath,{sanitize:!0}));var e=f.getCachedTemplate(this.templateString,this._skipNodeCache,this.ownerDocument),b;if(v.isString(e)){if(b=t.toDom(this._stringRepl(e),this.ownerDocument),1!=b.nodeType)throw Error("Invalid template: "+e);}else b=e.cloneNode(!0);this.domNode=b}this.inherited(arguments);this._rendered||this._fillContent(this.srcNodeRef);this._rendered=!0},_fillContent:function(e){var b=this.containerNode;if(e&&b)for(;e.hasChildNodes();)b.appendChild(e.firstChild)}});
f._templateCache={};f.getCachedTemplate=function(e,b,a){var c=f._templateCache,k=e,g=c[k];if(g){try{if(!g.ownerDocument||g.ownerDocument==(a||document))return g}catch(q){}t.destroy(g)}e=u.trim(e);if(b||e.match(/\$\{([^\}]+)\}/g))return c[k]=e;b=t.toDom(e,a);if(1!=b.nodeType)throw Error("Invalid template: "+e);return c[k]=b};m("ie")&&n(window,"unload",function(){var e=f._templateCache,b;for(b in e){var a=e[b];"object"==typeof a&&t.destroy(a);delete e[b]}});return f})},"dojo/cache":function(){define(["./_base/kernel",
"./text"],function(p){return p.cache})},"dijit/_AttachMixin":function(){define("require dojo/_base/array dojo/_base/connect dojo/_base/declare dojo/_base/lang dojo/mouse dojo/on dojo/touch ./_WidgetBase".split(" "),function(p,g,t,v,n,m,u,k,f){var e=n.delegate(k,{mouseenter:m.enter,mouseleave:m.leave,keypress:t._keypress}),b;t=v("dijit._AttachMixin",null,{constructor:function(){this._attachPoints=[];this._attachEvents=[]},buildRendering:function(){this.inherited(arguments);this._attachTemplateNodes(this.domNode);
this._beforeFillContent()},_beforeFillContent:function(){},_attachTemplateNodes:function(a){for(var b=a;;)if(1==b.nodeType&&(this._processTemplateNode(b,function(a,b){return a.getAttribute(b)},this._attach)||this.searchContainerNode)&&b.firstChild)b=b.firstChild;else{if(b==a)break;for(;!b.nextSibling;)if(b=b.parentNode,b==a)return;b=b.nextSibling}},_processTemplateNode:function(a,b,e){var c=!0,f=this.attachScope||this,k=b(a,"dojoAttachPoint")||b(a,"data-dojo-attach-point");if(k)for(var g=k.split(/\s*,\s*/);k=
g.shift();)n.isArray(f[k])?f[k].push(a):f[k]=a,c="containerNode"!=k,this._attachPoints.push(k);if(b=b(a,"dojoAttachEvent")||b(a,"data-dojo-attach-event"))for(k=b.split(/\s*,\s*/),g=n.trim;b=k.shift();)if(b){var m=null;-1!=b.indexOf(":")?(m=b.split(":"),b=g(m[0]),m=g(m[1])):b=g(b);m||(m=b);this._attachEvents.push(e(a,b,n.hitch(f,m)))}return c},_attach:function(a,c,f){c=c.replace(/^on/,"").toLowerCase();c="dijitclick"==c?b||(b=p("./a11yclick")):e[c]||c;return u(a,c,f)},_detachTemplateNodes:function(){var a=
this.attachScope||this;g.forEach(this._attachPoints,function(b){delete a[b]});this._attachPoints=[];g.forEach(this._attachEvents,function(a){a.remove()});this._attachEvents=[]},destroyRendering:function(){this._detachTemplateNodes();this.inherited(arguments)}});n.extend(f,{dojoAttachEvent:"",dojoAttachPoint:""});return t})},"dijit/_WidgetsInTemplateMixin":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang","dojo/parser"],function(p,g,t,v,n){return t("dijit._WidgetsInTemplateMixin",
null,{_earlyTemplatedStartup:!1,contextRequire:null,_beforeFillContent:function(){if(/dojoType|data-dojo-type/i.test(this.domNode.innerHTML)){var g=this.domNode;this.containerNode&&!this.searchContainerNode&&(this.containerNode.stopParser=!0);n.parse(g,{noStart:!this._earlyTemplatedStartup,template:!0,inherited:{dir:this.dir,lang:this.lang,textDir:this.textDir},propsThis:this,contextRequire:this.contextRequire,scope:"dojo"}).then(v.hitch(this,function(g){this._startupWidgets=g;for(var k=0;k<g.length;k++)this._processTemplateNode(g[k],
function(f,e){return f[e]},function(f,e,b){return e in f?f.connect(f,e,b):f.on(e,b,!0)});this.containerNode&&this.containerNode.stopParser&&delete this.containerNode.stopParser}));if(!this._startupWidgets)throw Error(this.declaredClass+": parser returned unfilled promise (probably waiting for module auto-load), unsupported by _WidgetsInTemplateMixin.   Must pre-load all supporting widgets before instantiation.");}},_processTemplateNode:function(g,n,k){return n(g,"dojoType")||n(g,"data-dojo-type")?
!0:this.inherited(arguments)},startup:function(){p.forEach(this._startupWidgets,function(g){g&&!g._started&&g.startup&&g.startup()});this._startupWidgets=null;this.inherited(arguments)}})})},"dojo/parser":function(){define("require ./_base/kernel ./_base/lang ./_base/array ./_base/config ./dom ./_base/window ./_base/url ./aspect ./promise/all ./date/stamp ./Deferred ./has ./query ./on ./ready".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){function C(a){return eval("("+a+")")}function z(a){var b=
a._nameCaseMap,c=a.prototype;if(!b||b._extendCnt<B){var b=a._nameCaseMap={},e;for(e in c)"_"!==e.charAt(0)&&(b[e.toLowerCase()]=e);b._extendCnt=B}return b}function E(a,b){b||(b=p);var c=b._dojoParserCtorMap||(b._dojoParserCtorMap={}),e=a.join();if(!c[e]){for(var f=[],k=0,g=a.length;k<g;k++){var m=a[k];f[f.length]=c[m]=c[m]||t.getObject(m)||~m.indexOf("/")&&b(m)}a=f.shift();c[e]=f.length?a.createSubclass?a.createSubclass(f):a.extend.apply(a,f):a}return c[e]}new Date("X");var B=0;f.after(t,"extend",
function(){B++},!0);var G={_clearCache:function(){B++;_ctorMap={}},_functionFromScript:function(a,b){var c="",e="",f=a.getAttribute(b+"args")||a.getAttribute("args");b=a.getAttribute("with");f=(f||"").split(/\s*,\s*/);b&&b.length&&v.forEach(b.split(/\s*,\s*/),function(a){c+="with("+a+"){";e+="}"});return new Function(f,c+a.innerHTML+e)},instantiate:function(a,b,c){b=b||{};c=c||{};var e=(c.scope||g._scopeName)+"Type",f="data-"+(c.scope||g._scopeName)+"-",k=f+"type",m=f+"mixins",q=[];v.forEach(a,function(a){var c=
e in b?b[e]:a.getAttribute(k)||a.getAttribute(e);if(c){var f=a.getAttribute(m),c=f?[c].concat(f.split(/\s*,\s*/)):[c];q.push({node:a,types:c})}});return this._instantiate(q,b,c)},_instantiate:function(a,b,c,f){function k(a){b._started||c.noStart||v.forEach(a,function(a){"function"!==typeof a.startup||a._started||a.startup()});return a}a=v.map(a,function(a){var e=a.ctor||E(a.types,c.contextRequire);if(!e)throw Error("Unable to resolve constructor for: '"+a.types.join()+"'");return this.construct(e,
a.node,b,c,a.scripts,a.inherited)},this);return f?e(a).then(k):k(a)},construct:function(a,e,m,q,n,u){function p(a){A&&t.setObject(A,a);for(I=0;I<d.length;I++)f[d[I].advice||"after"](a,d[I].method,t.hitch(a,d[I].func),!0);for(I=0;I<h.length;I++)h[I].call(a);for(I=0;I<r.length;I++)a.watch(r[I].prop,r[I].func);for(I=0;I<y.length;I++)w(a,y[I].event,y[I].func);return a}var B=a&&a.prototype;q=q||{};var E={};q.defaults&&t.mixin(E,q.defaults);u&&t.mixin(E,u);var F;c("dom-attributes-explicit")?F=e.attributes:
c("dom-attributes-specified-flag")?F=v.filter(e.attributes,function(d){return d.specified}):(u=(/^input$|^img$/i.test(e.nodeName)?e:e.cloneNode(!1)).outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,""),F=v.map(u.split(/\s+/),function(d){var h=d.toLowerCase();return{name:d,value:"LI"==e.nodeName&&"value"==d||"enctype"==h?e.getAttribute(h):e.getAttributeNode(h).value}}));var D=q.scope||g._scopeName;u="data-"+D+"-";var G={};"dojo"!==D&&(G[u+"props"]=
"data-dojo-props",G[u+"type"]="data-dojo-type",G[u+"mixins"]="data-dojo-mixins",G[D+"type"]="dojotype",G[u+"id"]="data-dojo-id");for(var I=0,K,D=[],A,J;K=F[I++];){var aa=K.name,l=aa.toLowerCase();K=K.value;switch(G[l]||l){case "data-dojo-type":case "dojotype":case "data-dojo-mixins":break;case "data-dojo-props":J=K;break;case "data-dojo-id":case "jsid":A=K;break;case "data-dojo-attach-point":case "dojoattachpoint":E.dojoAttachPoint=K;break;case "data-dojo-attach-event":case "dojoattachevent":E.dojoAttachEvent=
K;break;case "class":E["class"]=e.className;break;case "style":E.style=e.style&&e.style.cssText;break;default:if(aa in B||(aa=z(a)[l]||aa),aa in B)switch(typeof B[aa]){case "string":E[aa]=K;break;case "number":E[aa]=K.length?Number(K):NaN;break;case "boolean":E[aa]="false"!=K.toLowerCase();break;case "function":""===K||-1!=K.search(/[^\w\.]+/i)?E[aa]=new Function(K):E[aa]=t.getObject(K,!1)||new Function(K);D.push(aa);break;default:l=B[aa],E[aa]=l&&"length"in l?K?K.split(/\s*,\s*/):[]:l instanceof
Date?""==K?new Date(""):"now"==K?new Date:b.fromISOString(K):l instanceof k?g.baseUrl+K:C(K)}else E[aa]=K}}for(F=0;F<D.length;F++)G=D[F].toLowerCase(),e.removeAttribute(G),e[G]=null;if(J)try{J=C.call(q.propsThis,"{"+J+"}"),t.mixin(E,J)}catch(H){throw Error(H.toString()+" in data-dojo-props\x3d'"+J+"'");}t.mixin(E,m);n||(n=a&&(a._noScript||B._noScript)?[]:x("\x3e script[type^\x3d'dojo/']",e));var d=[],h=[],r=[],y=[];if(n)for(I=0;I<n.length;I++)G=n[I],e.removeChild(G),m=G.getAttribute(u+"event")||G.getAttribute("event"),
q=G.getAttribute(u+"prop"),J=G.getAttribute(u+"method"),D=G.getAttribute(u+"advice"),F=G.getAttribute("type"),G=this._functionFromScript(G,u),m?"dojo/connect"==F?d.push({method:m,func:G}):"dojo/on"==F?y.push({event:m,func:G}):E[m]=G:"dojo/aspect"==F?d.push({method:J,advice:D,func:G}):"dojo/watch"==F?r.push({prop:q,func:G}):h.push(G);a=(n=a.markupFactory||B.markupFactory)?n(E,e,a):new a(E,e);return a.then?a.then(p):p(a)},scan:function(b,c){function e(d){if(!d.inherited){d.inherited={};var h=d.node,
a=e(d.parent),h={dir:h.getAttribute("dir")||a.dir,lang:h.getAttribute("lang")||a.lang,textDir:h.getAttribute(n)||a.textDir},l;for(l in h)h[l]&&(d.inherited[l]=h[l])}return d.inherited}var f=[],k=[],m={},q=(c.scope||g._scopeName)+"Type",w="data-"+(c.scope||g._scopeName)+"-",x=w+"type",n=w+"textdir",w=w+"mixins",u=b.firstChild,B=c.inherited;if(!B){var z=function(d,h){return d.getAttribute&&d.getAttribute(h)||d.parentNode&&z(d.parentNode,h)},B={dir:z(b,"dir"),lang:z(b,"lang"),textDir:z(b,n)},C;for(C in B)B[C]||
delete B[C]}C={inherited:B};for(var A,t;;)if(u)if(1!=u.nodeType)u=u.nextSibling;else if(A&&"script"==u.nodeName.toLowerCase())(B=u.getAttribute("type"))&&/^dojo\/\w/i.test(B)&&A.push(u),u=u.nextSibling;else if(t)u=u.nextSibling;else if(B=u.getAttribute(x)||u.getAttribute(q),b=u.firstChild,B||b&&(3!=b.nodeType||b.nextSibling)){t=null;if(B){var F=u.getAttribute(w);A=F?[B].concat(F.split(/\s*,\s*/)):[B];try{t=E(A,c.contextRequire)}catch(d){}t||v.forEach(A,function(d){~d.indexOf("/")&&!m[d]&&(m[d]=!0,
k[k.length]=d)});F=t&&!t.prototype._noScript?[]:null;C={types:A,ctor:t,parent:C,node:u,scripts:F};C.inherited=e(C);f.push(C)}else C={node:u,scripts:A,parent:C};A=F;t=u.stopParser||t&&t.prototype.stopParser&&!c.template;u=b}else u=u.nextSibling;else{if(!C||!C.node)break;u=C.node.nextSibling;t=!1;C=C.parent;A=C.scripts}var l=new a;k.length?(c.contextRequire||p)(k,function(){l.resolve(v.filter(f,function(d){if(!d.ctor)try{d.ctor=E(d.types,c.contextRequire)}catch(y){}for(var h=d.parent;h&&!h.types;)h=
h.parent;var a=d.ctor&&d.ctor.prototype;d.instantiateChildren=!(a&&a.stopParser&&!c.template);d.instantiate=!h||h.instantiate&&h.instantiateChildren;return d.instantiate}))}):l.resolve(f);return l.promise},_require:function(b,c){b=C("{"+b.innerHTML+"}");var e=[],f=[],k=new a;c=c&&c.contextRequire||p;for(var g in b)e.push(g),f.push(b[g]);c(f,function(){for(var a=0;a<e.length;a++)t.setObject(e[a],arguments[a]);k.resolve(arguments)});return k.promise},_scanAmd:function(b,c){var e=new a,f=e.promise;e.resolve(!0);
var k=this;x("script[type\x3d'dojo/require']",b).forEach(function(a){f=f.then(function(){return k._require(a,c)});a.parentNode.removeChild(a)});return f},parse:function(a,b){!a||"string"==typeof a||"nodeType"in a||(b=a,a=b.rootNode);var c=a?m.byId(a):u.body();b=b||{};var e=b.template?{template:!0}:{},f=[],k=this;a=this._scanAmd(c,b).then(function(){return k.scan(c,b)}).then(function(a){return k._instantiate(a,e,b,!0)}).then(function(a){return f=f.concat(a)}).otherwise(function(a){console.error("dojo/parser::parse() error",
a);throw a;});t.mixin(f,a);return f}};g.parser=G;n.parseOnLoad&&q(100,G,"parse");return G})},"dojo/date/stamp":function(){define(["../_base/lang","../_base/array"],function(p,g){var t={};p.setObject("dojo.date.stamp",t);t.fromISOString=function(p,n){t._isoRegExp||(t._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var m=t._isoRegExp.exec(p);p=null;if(m){m.shift();m[1]&&m[1]--;m[6]&&(m[6]*=1E3);n&&(n=new Date(n),g.forEach(g.map("FullYear Month Date Hours Minutes Seconds Milliseconds".split(" "),
function(f){return n["get"+f]()}),function(f,e){m[e]=m[e]||f}));p=new Date(m[0]||1970,m[1]||0,m[2]||1,m[3]||0,m[4]||0,m[5]||0,m[6]||0);100>m[0]&&p.setFullYear(m[0]||1970);var u=0,k=m[7]&&m[7].charAt(0);"Z"!=k&&(u=60*(m[8]||0)+(Number(m[9])||0),"-"!=k&&(u*=-1));k&&(u-=p.getTimezoneOffset());u&&p.setTime(p.getTime()+6E4*u)}return p};t.toISOString=function(g,n){var m=function(e){return 10>e?"0"+e:e};n=n||{};var u=[],k=n.zulu?"getUTC":"get",f="";"time"!=n.selector&&(f=g[k+"FullYear"](),f=["0000".substr((f+
"").length)+f,m(g[k+"Month"]()+1),m(g[k+"Date"]())].join("-"));u.push(f);"date"!=n.selector&&(f=[m(g[k+"Hours"]()),m(g[k+"Minutes"]()),m(g[k+"Seconds"]())].join(":"),k=g[k+"Milliseconds"](),n.milliseconds&&(f+="."+(100>k?"0":"")+m(k)),n.zulu?f+="Z":"time"!=n.selector&&(g=g.getTimezoneOffset(),n=Math.abs(g),f+=(0<g?"-":"+")+m(Math.floor(n/60))+":"+m(n%60)),u.push(f));return u.join("T")};return t})},"esri/dijit/_EventedWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/on ../Evented dijit/_WidgetBase".split(" "),
function(p,g,t,v,n,m){return p([m,n],{_onMap:function(g){var k=this.constructor._onMap,f;k&&k.FINAL||(delete this.constructor._onMap,k=this.registerConnectEvents(),k.FINAL=!0);g=g.toLowerCase();k[g]?f=this[k[g].method]:(g=this._onCamelCase(g),this[g]&&(f=g));return f},on:function(g,k){var f=this._onMap(g),e=g.replace(/\-/g,""),b="on"+e in this.domNode;return f||!b?this.inherited(arguments):this.own(v(this.domNode,e,k))[0]},emit:function(m,k,f){var e,b,a,c=m.toLowerCase(),x=this.constructor._onMap||
this.registerConnectEvents();b=this[this._onMap(c)];k=k||{};k.target||(k.target=this);b&&x&&x[c]&&(this._onObj2Arr(function(){e=Array.prototype.slice.call(arguments)},x[c].argKeys)(k),a=g.mixin({},arguments),a[2]=e,a[0]=x[c].name.replace(/^on/,""));return this.inherited(a||arguments)}})})},"esri/tasks/GeometryService":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){p=p(e,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],
"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],"union-complete":["geometry"]},constructor:function(a){a=g.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=
a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);
this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var b=[],c,e=a.length;for(c=0;c<e;c++)b.push(a[c].toJson());
return{geometryType:w.getJsonType(a[0]),geometries:b}},_decodeGeometries:function(a,b,c){var e=w.getGeometryType(b);a=a.geometries;var f=[],k={spatialReference:c.toJson()},m=g.mixin;t.forEach(a,function(a,b){f[b]=new e(m(a,k))});return f},_toProjectGeometry:function(e){var f=e.spatialReference.toJson();return e instanceof b?new c({rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]],spatialReference:f}):new a({paths:[[].concat(e.points)],spatialReference:f})},
_fromProjectedGeometry:function(a,c,e){return"esriGeometryEnvelope"===c?(a=a.rings[0],new b(a[0][0],a[0][1],a[2][0],a[2][1],e)):new x({points:a.paths[0],spatialReference:e.toJson()})},project:function(a,b,c,e){var m=g.mixin({},this._url.query,{f:"json"}),q;a.geometries?(e=c,c=b,b=a.outSR,q=a.geometries[0],m=g.mixin(m,a.toJson())):(q=a[0],m=g.mixin(m,{outSR:b.wkid||v.toJson(b.toJson()),inSR:q.spatialReference.wkid||v.toJson(q.spatialReference.toJson()),geometries:v.toJson(this._encodeGeometries(a))}));
var x=w.getJsonType(q),u=this._projectHandler,p=this._errorHandler,z=new n(f._dfdCanceller);z._pendingDfd=k({url:this._url.path+"/project",content:m,callbackParamName:"callback",load:function(a,f){u(a,f,x,b,c,e,z)},error:function(a){p(a,e,z)}});return z},_projectHandler:function(a,b,c,e,f,k,g){try{var m=this._decodeGeometries(a,c,e);this._successHandler([m],"onProjectComplete",f,g)}catch(I){this._errorHandler(I,k,g)}},onProjectComplete:function(){},simplify:function(a,b,c){var e=a[0].spatialReference,
m=g.mixin({},this._url.query,{f:"json",sr:e.wkid?e.wkid:v.toJson(e.toJson()),geometries:v.toJson(this._encodeGeometries(a))}),q=w.getJsonType(a[0]),x=this._simplifyHandler,u=this._errorHandler,p=new n(f._dfdCanceller);p._pendingDfd=k({url:this._url.path+"/simplify",content:m,callbackParamName:"callback",load:function(a,f){x(a,f,q,e,b,c,p)},error:function(a){u(a,c,p)}});return p},_simplifyHandler:function(a,b,c,e,f,k,g){try{var m=this._decodeGeometries(a,c,e);this._successHandler([m],"onSimplifyComplete",
f,g)}catch(I){this._errorHandler(I,k,g)}},onSimplifyComplete:function(){},convexHull:function(a,b,c){var e=a[0].spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(e.toJson()),geometries:v.toJson(this._encodeGeometries(a))});var m=this._convexHullHandler,q=this._errorHandler,w=new n(f._dfdCanceller);w._pendingDfd=k({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(a,f){m(a,f,e,b,c,w)},error:function(a){q(a,c,w)}});return w},_convexHullHandler:function(a,
b,c,e,f,k){try{var g=w.fromJson(a.geometry).setSpatialReference(c);this._successHandler([g],"onConvexHullComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onConvexHullComplete:function(){},union:function(a,b,c){var e=a[0].spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(e.toJson()),geometries:v.toJson(this._encodeGeometries(a))});var m=this._unionHandler,q=this._errorHandler,w=new n(f._dfdCanceller);w._pendingDfd=k({url:this._url.path+"/union",content:a,callbackParamName:"callback",
load:function(a,f){m(a,f,e,b,c,w)},error:function(a){q(a,c,w)}});return w},_unionHandler:function(a,b,c,e,f,k){try{var g=w.fromJson(a.geometry).setSpatialReference(c);this._successHandler([g],"onUnionComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onUnionComplete:function(){},autoComplete:function(a,b,c,e){var m=a[0].spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(m.toJson()),polygons:v.toJson(this._encodeGeometries(a).geometries),polylines:v.toJson(this._encodeGeometries(b).geometries)});
var q=this._autoCompleteHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(a,b){q(a,b,m,c,e,x)},error:function(a){w(a,e,x)}});return x},_autoCompleteHandler:function(a,b,e,f,k,g){try{var m=a.geometries;a=[];var q,w=m.length;for(q=0;q<w;q++)a[q]=new c({spatialReference:e,rings:m[q].rings});this._successHandler([a],"onAutoCompleteComplete",f,g)}catch(K){this._errorHandler(K,k,g)}},onAutoCompleteComplete:function(){},
reshape:function(a,b,c,e){var m=a.spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(m.toJson()),target:v.toJson({geometryType:w.getJsonType(a),geometry:a.toJson()}),reshaper:v.toJson(b.toJson())});var q=this._reshapeHandler,x=this._errorHandler,u=new n(f._dfdCanceller);u._pendingDfd=k({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(a,b){q(a,b,m,c,e,u)},error:function(a){x(a,e,u)}});return u},_reshapeHandler:function(a,b,c,e,f,k){try{var g=w.fromJson(a.geometry).setSpatialReference(c);
this._successHandler([g],"onReshapeComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onReshapeComplete:function(){},cut:function(a,b,c,e){var m=a[0].spatialReference,q=t.map(a,function(a){return a.toJson()});a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(m.toJson()),target:v.toJson({geometryType:w.getJsonType(a[0]),geometries:q}),cutter:v.toJson(b.toJson())});var x=this._cutHandler,u=this._errorHandler,p=new n(f._dfdCanceller);p._pendingDfd=k({url:this._url.path+"/cut",content:a,callbackParamName:"callback",
load:function(a,b){x(a,b,m,c,e,p)},error:function(a){u(a,e,p)}});return p},_cutHandler:function(a,b,c,e,f,k){try{var g=a.geometries,m={};m.cutIndexes=a.cutIndexes;m.geometries=[];t.forEach(g,function(a){m.geometries.push(w.fromJson(a).setSpatialReference(c))});this._successHandler([m],"onCutComplete",e,k)}catch(I){this._errorHandler(I,f,k)}},onCutComplete:function(){},intersect:function(a,b,c,e){var m=a[0].spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(m.toJson()),geometries:v.toJson(this._encodeGeometries(a)),
geometry:v.toJson({geometryType:w.getJsonType(b),geometry:b.toJson()})});var q=this._intersectHandler,x=this._errorHandler,u=new n(f._dfdCanceller);u._pendingDfd=k({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(a,b){q(a,b,m,c,e,u)},error:function(a){x(a,e,u)}});return u},_intersectHandler:function(a,b,c,e,f,k){try{var g=[];t.forEach(a.geometries,function(a){g.push(w.fromJson(a).setSpatialReference(c))});this._successHandler([g],"onIntersectComplete",e,k)}catch(D){this._errorHandler(D,
f,k)}},onIntersectComplete:function(){},difference:function(a,b,c,e){var m=a[0].spatialReference;a=g.mixin({},this._url.query,{f:"json",sr:v.toJson(m.toJson()),geometries:v.toJson(this._encodeGeometries(a)),geometry:v.toJson({geometryType:w.getJsonType(b),geometry:b.toJson()})});var q=this._differenceHandler,x=this._errorHandler,u=new n(f._dfdCanceller);u._pendingDfd=k({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(a,b){q(a,b,m,c,e,u)},error:function(a){x(a,
e,u)}});return u},_differenceHandler:function(a,b,c,e,f,k){try{var g=[];t.forEach(a.geometries,function(a){g.push(w.fromJson(a).setSpatialReference(c))});this._successHandler([g],"onDifferenceComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onDifferenceComplete:function(){},buffer:function(a,b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.outSpatialReference||a.geometries[0].spatialReference,q=this._bufferHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+
"/buffer",content:e,callbackParamName:"callback",load:function(a,e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_bufferHandler:function(a,b,e,f,k,g){try{var m=a.geometries;a=[];var q,w=m.length;for(q=0;q<w;q++)a[q]=new c({spatialReference:e,rings:m[q].rings});this._successHandler([a],"onBufferComplete",f,g)}catch(K){this._errorHandler(K,k,g)}},onBufferComplete:function(){},areasAndLengths:function(a,b,c){a=g.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._areasAndLengthsHandler,
m=this._errorHandler,q=new n(f._dfdCanceller);q._pendingDfd=k({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(a,f){e(a,f,b,c,q)},error:function(a){m(a,c,q)}});return q},_areasAndLengthsHandler:function(a,b,c,e,f){try{this._successHandler([a],"onAreasAndLengthsComplete",c,f)}catch(G){this._errorHandler(G,e,f)}},onAreasAndLengthsComplete:function(){},lengths:function(a,b,c){a=g.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._lengthsHandler,m=this._errorHandler,
q=new n(f._dfdCanceller);q._pendingDfd=k({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(a,f){e(a,f,b,c,q)},error:function(a){m(a,c,q)}});return q},_lengthsHandler:function(a,b,c,e,f){try{this._successHandler([a],"onLengthsComplete",c,f)}catch(G){this._errorHandler(G,e,f)}},onLengthsComplete:function(){},labelPoints:function(a,b,c){var e=t.map(a,function(a){return a.toJson()}),m=a[0].spatialReference,e=g.mixin({},this._url.query,{f:"json",sr:m.wkid?m.wkid:v.toJson(m.toJson()),
polygons:v.toJson(e)}),q=this._labelPointsHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/labelPoints",content:e,callbackParamName:"callback",load:function(e,f){q(e,f,a,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_labelPointsHandler:function(a,b,c,e,f,k,g){try{var m=[];t.forEach(a.labelPoints,function(a){m.push(w.fromJson(a).setSpatialReference(e))});this._successHandler([m],"onLabelPointsComplete",f,g)}catch(I){this._errorHandler(I,k,g)}},onLabelPointsComplete:function(){},
relation:function(a,b,c){a=g.mixin({},this._url.query,{f:"json"},a.toJson());var e=this._relationHandler,m=this._errorHandler,q=new n(f._dfdCanceller);q._pendingDfd=k({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(a,f){e(a,f,b,c,q)},error:function(a){m(a,c,q)}});return q},_relationHandler:function(a,b,c,e,f){try{this._successHandler([a.relations],"onRelationComplete",c,f)}catch(G){this._errorHandler(G,e,f)}},onRelationComplete:function(){},trimExtend:function(a,
b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.sr,q=this._trimExtendHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/trimExtend",content:e,callbackParamName:"callback",load:function(a,e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_trimExtendHandler:function(b,c,e,f,k,g){try{var m=b.geometries;b=[];var q,w=m.length;for(q=0;q<w;q++)b[q]=new a({spatialReference:e,paths:m[q].paths});this._successHandler([b],"onTrimExtendComplete",
f,g)}catch(K){this._errorHandler(K,k,g)}},onTrimExtendComplete:function(){},densify:function(a,b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,q=this._densifyHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/densify",content:e,callbackParamName:"callback",load:function(a,e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_densifyHandler:function(a,b,c,e,f,k){try{var g=[];t.forEach(a.geometries,function(a){g.push(w.fromJson(a).setSpatialReference(c))});
this._successHandler([g],"onDensifyComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onDensifyComplete:function(){},generalize:function(a,b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,q=this._generalizeHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/generalize",content:e,callbackParamName:"callback",load:function(a,e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_generalizeHandler:function(a,
b,c,e,f,k){try{var g=[];t.forEach(a.geometries,function(a){g.push(w.fromJson(a).setSpatialReference(c))});this._successHandler([g],"onGeneralizeComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onGeneralizeComplete:function(){},offset:function(a,b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometries[0].spatialReference,q=this._offsetHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=k({url:this._url.path+"/offset",content:e,callbackParamName:"callback",load:function(a,
e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_offsetHandler:function(a,b,c,e,f,k){try{var g=[];t.forEach(a.geometries,function(a){g.push(w.fromJson(a).setSpatialReference(c))});this._successHandler([g],"onOffsetComplete",e,k)}catch(D){this._errorHandler(D,f,k)}},onOffsetComplete:function(){},distance:function(a,b,c){var e=g.mixin({},this._url.query,{f:"json"},a.toJson()),m=a.geometry1.spatialReference,q=this._distanceHandler,w=this._errorHandler,x=new n(f._dfdCanceller);x._pendingDfd=
k({url:this._url.path+"/distance",content:e,callbackParamName:"callback",load:function(a,e){q(a,e,m,b,c,x)},error:function(a){w(a,c,x)}});return x},_distanceHandler:function(a,b,c,e,f,k){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",e,k)}catch(F){this._errorHandler(F,f,k)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,b,c){var e={};g.isObject(a.sr)?e.sr=a.sr.wkid||v.toJson(a.sr.toJson()):e.sr=a.sr;e.coordinates=v.toJson(a.coordinates);e.conversionType=a.conversionType||
"MGRS";e.conversionMode=a.conversionMode;e.numOfDigits=a.numOfDigits;e.rounding=a.rounding;e.addSpaces=a.addSpaces;a=g.mixin({},this._url.query,{f:"json"},e);var m=this._toGeoCoordinateHandler,q=this._errorHandler,w=new n(f._dfdCanceller);w._pendingDfd=k({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(a,e){m(a,e,b,c,w)},error:function(a){q(a,c,w)}});return w},_toGeoCoordinateHandler:function(a,b,c,e,f){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",
c,f)}catch(G){this._errorHandler(G,e,f)}},onToGeoCoordinateStringComplete:function(){},fromGeoCoordinateString:function(a,b,c){var e={};g.isObject(a.sr)?e.sr=a.sr.wkid||v.toJson(a.sr.toJson()):e.sr=a.sr;e.strings=v.toJson(a.strings);e.conversionType=a.conversionType||"MGRS";e.conversionMode=a.conversionMode;a=g.mixin({},this._url.query,{f:"json"},e);var m=this._fromGeoCoordinateHandler,w=this._errorHandler,q=new n(f._dfdCanceller);q._pendingDfd=k({url:this._url.path+"/fromGeoCoordinateString",content:a,
callbackParamName:"callback",load:function(a,e){m(a,e,b,c,q)},error:function(a){w(a,c,q)}});return q},_fromGeoCoordinateHandler:function(a,b,c,e,f){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",c,f)}catch(G){this._errorHandler(G,e,f)}},onFromGeoCoordinateStringComplete:function(){}});g.mixin(p,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,
UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,
UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,
UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",
UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});return p})},"esri/layers/FeatureLayer":function(){define("require module dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/date/locale dojo/io-query dojo/dom-construct dojo/i18n dojo/when dojo/global dojo/promise/all ../sniff ../kernel ../lang ../request ../config ../deferredUtils ../promiseList ../SpatialReference ../urlUtils ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/jsonUtils ../support/expressionUtils ../arcadeProfiles/labelingProfile ../tasks/QueryTask ../tasks/query ../tasks/FeatureSet ../tasks/StatisticDefinition ../geometry/Extent ../geometry/jsonUtils ../geometry/normalizeUtils ../geometry/scaleUtils ./GraphicsLayer ./Field ./TimeInfo ./TimeReference ./FeatureType ./FeatureTemplate ./FeatureEditResult ./LabelClass ./SnapshotMode ./OnDemandMode ./SelectionMode ./StreamMode ./GridLayout ./TrackManager ./HeatmapManager ./clustering/ClusterManager dojo/i18n!../nls/jsapi require".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U,V,A,X,aa,l,d,h,r,y,H,P,ba,ea,va,N,Ca,ma,wa,xa,ya,la,ua,Ea,oa){var ra=B.defaults,pa=!!q("esri-pbf"),Ia=!!q("esri-featurelayer-pbf"),fa=t(r,{declaredClass:"esri.layers.FeatureLayer",invalidParams:"query contains one or more unsupported parameters",reHostedFS:/(https?:)?\/\/services.*\.arcgis\.com/i,maxPointCountForAuto:4E3,maxRecordCountForAuto:2E3,maxVertexCountForAuto:25E4,generalizeForScale:4E3,_eventMap:{"add-attachment-complete":["result"],
"before-apply-edits":["adds","updates","deletes"],"delete-attachments-complete":["results"],"edits-complete":["adds","updates","deletes"],"query-attachment-infos-complete":["results"],"query-count-complete":["count"],"query-features-complete":["featureSet"],"query-ids-complete":["objectIds"],"query-related-features-complete":["featureSets"],"selection-complete":["features","method"],"update-end":["error","info"]},constructor:function(d,a){this._preventInit||this._initFeatureLayer(d,a)},_initFeatureLayer:function(d,
a){a=a||{};this._tileWidth=a.tileWidth||512;this._tileHeight=a.tileHeight||512;this.i18n=oa;this._featureReduction=this._featureReduction||a.featureReduction;this._featureReductionEnabled=null!=a.featureReductionEnabled?a.featureReductionEnabled:!0;this.showLabels=null!=a.showLabels?a.showLabels:!0;this._outFields=a.outFields;this._defnExpr=a.definitionExpression;this._loadCallback=a.loadCallback;this._trackIdField=a.trackIdField;this.objectIdField=a.objectIdField;var h=null!=a.resolution,l=null!=
a.maxAllowableOffset;this._maxOffset=this._optMaxOffset=h||l?h?a.resolution:a.maxAllowableOffset:this.maxAllowableOffset;this.quantize=null!=a.quantize?a.quantize:!0;this._optEditable=a.editable;this._optAutoGen=a.autoGeneralize;this.editSummaryCallback=a.editSummaryCallback;this.userId=a.userId;this.userIsAdmin=a.userIsAdmin;this.useMapTime=a.hasOwnProperty("useMapTime")?!!a.useMapTime:!0;this.source=a.source;this.gdbVersion=a.gdbVersion;this.orderByFields=a.orderByFields;this.maxPointCountForAuto=
null!=a.maxPointCountForAuto?a.maxPointCountForAuto:this.maxPointCountForAuto;this.maxRecordCountForAuto=null!=a.maxRecordCountForAuto?a.maxRecordCountForAuto:this.maxRecordCountForAuto;this.maxVertexCountForAuto=null!=a.maxVertexCountForAuto?a.maxVertexCountForAuto:this.maxVertexCountForAuto;this.generalizeForScale=null!=a.generalizeForScale?a.generalizeForScale:this.generalizeForScale;this.queryPagination=this._optQueryPagination=null!=a.queryPagination?a.queryPagination:!0;this.multipatchOption=
a.multipatchOption;this._selectedFeatures={};this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();h=z.isDefined(a.mode)?a.mode:fa.MODE_ONDEMAND;this._isStream&&(h=fa.MODE_STREAM);this.mode=h;switch(h){case fa.MODE_SNAPSHOT:this.currentMode=fa.MODE_SNAPSHOT;this._mode=new Ca(this);break;case fa.MODE_ONDEMAND:case fa.MODE_AUTO:this.currentMode=fa.MODE_ONDEMAND;this._mode=new ma(this);this.latticeTiling=a.latticeTiling;break;case fa.MODE_SELECTION:this.currentMode=fa.MODE_SELECTION;
this._mode=new wa(this);this._isSelOnly=!0;break;case fa.MODE_STREAM:this.currentMode=fa.MODE_STREAM,this._mode=new xa(this),this._isStream=!0}this._initLayer=n.hitch(this,this._initLayer);this._selectHandler=n.hitch(this,this._selectHandler);this._editable=!1;if(n.isObject(d)&&d.layerDefinition)return this._collection=!0,this.mode=this._isStream?fa.MODE_STREAM:fa.MODE_SNAPSHOT,this._isStream||this._outFields||(this._outFields=["*"]),this._initLayer(d),this;this._task=new U(this.url,{source:this.source,
gdbVersion:this.gdbVersion});d=this._url.path;this._fserver=!1;-1!==d.search(/\/FeatureServer\//i)&&(this._fserver=!0);this._checkFeatureLimit();(a=a.resourceInfo)?this._initLayer(a):(this.source&&(a={source:this.source.toJson()},this._url.query=n.mixin(this._url.query,{layer:u.toJson(a)})),this.gdbVersion&&(this._url.query=n.mixin(this._url.query,{gdbVersion:this.gdbVersion})),E({url:d,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler}));
this.registerConnectEvents()},_initLayer:function(d,a){if(d||a){this._json=d;this._findCredential();if(this.credential&&this.credential.ssl||d&&d._ssl)this._useSSL(),this._task._useSSL();this._collection&&(this._isStream||(this.currentMode=fa.MODE_SNAPSHOT,this._mode=new Ca(this)),this._featureSet=d.featureSet,this._nextId=d.nextObjectId,d=d.layerDefinition);this.version=d.currentVersion;this.version||(this.version="capabilities"in d||"drawingInfo"in d||"hasAttachments"in d||"htmlPopupType"in d||
"relationships"in d||"timeInfo"in d||"typeIdField"in d||"types"in d?10:9.3);this.geometryType=d.geometryType;d.bandCount&&d.fields&&1<d.fields.length&&(this.geometryType="esriGeometryPolygon",this._isImageService=!0);"string"!==typeof this.multipatchOption&&"esriGeometryMultiPatch"===this.geometryType&&(this.multipatchOption="xyFootprint");d.hasOwnProperty("capabilities")?(a=this.capabilities=d.capabilities)&&-1!==a.toLowerCase().indexOf("editing")?this._editable=!0:this._editable=!1:this._collection||
(this._editable=this._fserver);z.isDefined(this._optEditable)?(this._editable=this._optEditable,delete this._optEditable):"esriGeometryMultiPatch"===this.geometryType&&(this._editable=!1);this._isImageService&&(this._editable=!1);this._json=u.toJson(this._json);this.isEditable()?this._setMaxOffset(null):this._canAutoGeneralize()&&(this._autoGeneralize=z.isDefined(this._optAutoGen)?this._optAutoGen:this.mode===fa.MODE_ONDEMAND||this.mode===fa.MODE_AUTO,delete this._optAutoGen);a=d.effectiveMinScale||
d.minScale;var h=d.effectiveMaxScale||d.maxScale;!this._hasMin&&a&&this.setMinScale(a);!this._hasMax&&h&&this.setMaxScale(h);this.layerId=d.id;this.name=d.name;this.description=d.description;this.copyright=d.copyrightText;this.type=d.type;this.displayField=d.displayField;this.defaultDefinitionExpression=d.definitionExpression||(d.isView?d.viewDefinitionQuery:d.definitionQuery);this.fullExtent=new aa(d.extent);this.initialExtent=new aa(this.fullExtent.toJson());this.fullExtent.spatialReference&&(this.spatialReference=
new D(this.fullExtent.spatialReference.toJson()));this.defaultVisibility=d.defaultVisibility;this.editingInfo=d.editingInfo;if("esriGeometryPoint"===this.geometryType||"esriGeometryMultipoint"===this.geometryType)this.latticeTiling=!1;this.hasM=d.hasM||!1;this.hasZ=d.hasZ||!1;this.indexedFields=d.indexedFields;this.indexes=d.indexes;this.maxRecordCount=d.maxRecordCount;this.canModifyLayer=d.canModifyLayer;this.supportsStatistics=d.supportsStatistics;this.supportsAdvancedQueries=this._collection?!1:
d.supportsAdvancedQueries;this.supportsCalculate=d.supportsCalculate;this.supportsASyncCalculate=d.supportsASyncCalculate;this.supportsAttachmentsByUploadId=d.supportsAttachmentsByUploadId;this.supportsCoordinatesQuantization=d.supportsCoordinatesQuantization;this.supportsQuantizationEditMode=d.supportsQuantizationEditMode;this.supportsFieldDescription=d.supportsFieldDescriptionProperty;this.supportsFormatPBF=d.supportedQueryFormats?-1!==m.map(d.supportedQueryFormats.toLowerCase().split(","),n.trim).indexOf("pbf"):
!1;this.quantize=this.quantize&&this.supportsCoordinatesQuantization;this.hasLabels=d.hasLabels;this.canScaleSymbols=d.canScaleSymbols;this.supportsRollbackOnFailureParameter=this.supportsRollbackOnFailure=d.supportsRollbackOnFailure;this.syncCanReturnChanges=d.syncCanReturnChanges;this.isDataVersioned=d.isDataVersioned;this.editFieldsInfo=d.editFieldsInfo;this.ownershipBasedAccessControlForFeatures=d.ownershipBasedAccessControlForFeatures;this.editFieldsInfo&&this.ownershipBasedAccessControlForFeatures&&
(this.creatorField=this.editFieldsInfo.creatorField);this.relationships=d.relationships;this.allowGeometryUpdates=z.isDefined(d.allowGeometryUpdates)?d.allowGeometryUpdates:!0;this.allowUpdateWithoutMValues=!!d.allowUpdateWithoutMValues;this.enableZDefaults=!!d.enableZDefaults;this.zDefault=z.isDefined(d.zDefault)?d.zDefault:null;this.advancedQueryCapabilities=d.advancedQueryCapabilities||{supportsStatistics:this.supportsStatistics,supportsOrderBy:this.supportsAdvancedQueries,supportsDistinct:this.supportsAdvancedQueries};
this.geometryProperties=d.hasGeometryProperties&&d.geometryProperties||null;this.url&&(this.advancedQueryCapabilities.supportsPagination=this.advancedQueryCapabilities.supportsPagination&&(this.reHostedFS.test(this.url)||10.3<this.version));this.queryPagination=this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination;this.useStandardizedQueries=d.useStandardizedQueries;this.tileMaxRecordCount=d.tileMaxRecordCount;this.standardMaxRecordCount=d.standardMaxRecordCount;if(a=d.dateFieldsTimeReference)this.dateFieldsTimeReference=
new P(a);this._setMaxOffset(this._maxOffset,!0);this._isTable="Table"===this.type;h=d.fields;this._createFields(h);if(!this.objectIdField){this.objectIdField=d.objectIdField;if(!this.objectIdField)for(h=d.fields,a=0;a<h.length;a++){var l=h[a];if("esriFieldTypeOID"===l.type){this.objectIdField=l.name;break}}this.objectIdField||this._isStream||console.debug("esri.layers.FeatureLayer: "+z.substitute({url:this.url},"objectIdField is not set [url: ${url}]"))}if(!z.isDefined(this._nextId)){h=this.objectIdField;
l=-1;if(this._collection&&h){var b=(a=this._featureSet)&&a.features,r=b?b.length:0,c;for(a=0;a<r;a++)c=(c=b[a].attributes)&&c[h],c>l&&(l=c)}this._nextId=l+1}this.globalIdField=d.globalIdField;if(a=this.typeIdField=d.typeIdField)if(a=!this._getField(a)&&this._getField(a,!0))this.typeIdField=a.name;this.visibilityField=d.visibilityField;if(h=d.defaultSymbol)this.defaultSymbol=M.fromJson(h);var e=this.types=[],y=d.types,f,k,l=(a=this.editFieldsInfo)&&a.creatorField,b=a&&a.editorField;c=l||b;r=[];if(y)for(a=
0;a<y.length;a++)f=new ba(y[a]),k=f.templates,c&&k&&k.length&&(r=r.concat(k)),e.push(f);y=d.templates;f=this.templates=[];if(y)for(a=0;a<y.length;a++)e=new ea(y[a]),c&&r.push(e),f.push(e);for(a=0;a<r.length;a++)if(c=n.getObject("prototype.attributes",!1,r[a]))l&&delete c[l],b&&delete c[b];if(a=d.timeInfo)this.timeInfo=new H(a),this._startTimeField=a.startTimeField,this._endTimeField=a.endTimeField,this._startTimeField&&this._endTimeField&&(this._twoTimeFields=!0),this._trackIdField?a.trackIdField=
this._trackIdField:this._trackIdField=a.trackIdField;this.hasAttachments=!this._collection&&d.hasAttachments?!0:!1;this.htmlPopupType=d.htmlPopupType;a=d.drawingInfo;var g;(l=a&&a.labelingInfo)&&!this.labelingInfo&&(this.labelingInfo=m.map(l,function(d){return new N(d)}),this._fixLabelExpr());if(!this.renderer)if(a&&a.renderer){if(g=a.renderer,this.setRenderer(T.fromJson(g)),"classBreaks"===g.type&&this.renderer.setMaxInclusive(!0),!this._collection){var w=g.type,h=[];g=this.renderer;switch(w){case "simple":h.push(g.symbol);
break;case "uniqueValue":case "classBreaks":h.push(g.defaultSymbol),h=h.concat(m.map(g.infos,function(d){return d.symbol}))}var h=m.filter(h,z.isDefined),x=this._url.path+"/images/",p=this._getToken();m.forEach(h,function(d){var a=d.url;a&&(-1===a.search(/https?\:/)&&-1===a.indexOf("data:")&&(d.url=x+a),p&&-1!==d.url.search(/https?\:/)&&(d.url+="?token\x3d"+p))})}}else if(h)y=this.types,0<y.length?(g=new S(this.defaultSymbol,this.typeIdField),m.forEach(y,function(d){g.addValue(d.id,d.symbol)})):g=
new Q(this.defaultSymbol),this.setRenderer(g);else if(!this._isTable){switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":w=new K;break;case "esriGeometryPolyline":w=new J;break;case "esriGeometryPolygon":w=new L;break;default:this.hasXYFootprint()&&(w=new L)}this.setRenderer(w?new Q(w):null)}w=a&&a.transparency||0;!this.hasOwnProperty("opacity")&&0<w&&(this.opacity=1-w/100);(q("ie")||7<=q("trident")||q("safari"))&&this.isEditable()&&10.02>this.version&&(this._ts=!0);
this.statistics=d.statistics;this._fixRendererFields();this._updateRequiredFieldsFromLabelingInfo();this._checkFields();this._updateCaps();var B=function(){null==this._maxOffset||this._isFractionalOffsetAllowed()||this._setMaxOffset(this._maxOffset);this.loaded=!0;this.setFeatureReduction(this.getFeatureReduction());this.currentMode!==fa.MODE_SNAPSHOT&&(this.queryPagination=!1);this.onLoad(this);var d=this._loadCallback;d&&(delete this._loadCallback,d(this))};d=[];this._collection?(w=this._featureSet,
this._featureSet=null,this._mode._drawFeatures(new A(w)),this._fcAdded=!0):(d.push(this._forceIdentity()),this._limitPromise&&d.push(this._limitPromise));d.push(this._evalArcadeSupport());d.length?F(d).then(n.hitch(this,function(){B.call(this)})):B.call(this)}},setShowLabels:function(d){var a=this.showLabels;this.showLabels=d;a!==this.showLabels&&(this._evalSurfaceType(),this.onShowLabelsChange())},onShowLabelsChange:function(){},onRendererChange:function(d){this.inherited(arguments);var a=this._map;
this._ager=!!(d&&d.observationAger&&d.observationRenderer);d&&"colors"in d&&"blurRadius"in d&&"maxPixelIntensity"in d?(this._evalSurfaceType(!0),"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&a&&(this._heatmapManager=new ua(this),this._heatmapManager.initialize(a))):this.renderer&&this.renderer.getRendererInfo?m.some(this.renderer.rendererInfos,function(d){return d.renderer&&"colors"in d.renderer&&"blurRadius"in d.renderer})||(this._heatmapManager=null):this._heatmapManager=null;this.timeInfo&&
a&&(d&&(d.latestObservationRenderer||d.trackRenderer)?this._trackManager||(this._trackManager=new la(this),this._trackManager.initialize(a),this._childLayer=this._trackManager.container,this._mode._applyTimeFilter()):this._trackManager&&!this._isStream&&(this._trackManager.destroy(),this._trackManager=null));if(d){var h=[],a=m.filter([d,d.observationRenderer,d.latestObservationRenderer,d.trackRenderer],z.isDefined),l=function(d){return null!=d&&"function"!=typeof d&&d};m.forEach(a,function(d){var a=
l(d.attributeField),b=l(d.attributeField2);d=l(d.attributeField3);!1!==a&&h.push(a);!1!==b&&h.push(b);!1!==d&&h.push(d)});this._requiredFields=h}else this._requiredFields=[];this.loaded&&(this._fixRendererFields(),this._checkFields(this._requiredFields),this._collection&&(this._typesDirty=!0))},setFeatureReduction:function(d){d&&(d=n.mixin({},d),null!=d.clusterSize&&null==d.clusterRadius&&(d.clusterRadius=d.clusterSize),delete d.clusterSize);this.loaded?this._isFeatureReductionSupported(d)?this._featureReduction=
d:(this._featureReduction=null,d&&console.log("Clustering is not supported for this layer: "+this.url)):this._featureReduction=d;this._evalFeatureReduction(this._featureReduction)},hasFeatureReduction:function(){return!!this._featureReduction},getFeatureReduction:function(){var d=this._featureReduction;if(d){var d=n.mixin({},d),a=this._clusterManager;if(a=a&&a.aggregationInfo)d.clusterRadius=a.clusterRadius,d.infoTemplate=a.infoTemplate}return d},isFeatureReductionActive:function(){var d=this._clusterManager;
return!!(d&&d.isClusteringEnabled()&&d.isClusteringActive())},isFeatureReductionEnabled:function(){return this._featureReductionEnabled},enableFeatureReduction:function(){this._featureReductionEnabled||(this._featureReductionEnabled=!0,this._evalFeatureReduction(this._featureReduction))},disableFeatureReduction:function(){this._featureReductionEnabled&&(this._featureReductionEnabled=!1,this._evalFeatureReduction(this._featureReduction))},isFeatureReductionApplied:function(){return this.hasFeatureReduction()&&
this.isFeatureReductionEnabled()&&this._canCluster(this.getFeatureReduction())},getAggregateGraphics:function(){return this._clusterManager?this._clusterManager.getAggregateGraphics():[]},getChildGraphics:function(d){return this._clusterManager?this._clusterManager.getFeaturesInCluster(d):[]},getSingleGraphics:function(){return this._clusterManager?this._clusterManager.getSingleGraphics():[]},getFeatureReductionRenderer:function(){return this.isFeatureReductionActive()?this._clusterManager.getClusterRenderer():
null},getFeatureReductionLayer:function(){return this._clusterManager?this._clusterManager.container:null},getFeatureReductionField:function(d){var a,h=this._clusterManager?this._clusterManager.getClusterFields():null;d=d?d.toLowerCase():"";m.some(h,function(h){d===h.name.toLowerCase()&&(a=h);return!!a});return a},_isFeatureReductionSupported:function(d){return d&&"cluster"===d.type&&"esriGeometryPoint"===this.geometryType&&(this._collection||this._isStream||this._optQueryPagination&&this.advancedQueryCapabilities.supportsPagination)},
_isReductionCompatibleRenderer:function(d){d=d&&d.declaredClass||"";d=d.toLowerCase();return-1<d.indexOf("simplerenderer")||-1<d.indexOf("classbreaksrenderer")||-1<d.indexOf("uniquevaluerenderer")},_evalFeatureReduction:function(d){this.loaded&&this.getMap()&&(d=d||this.getFeatureReduction(),this._evalModeFromFReduction(d),d&&this.isFeatureReductionEnabled()?this._canCluster(d)?this._clusterManager?this._updateClusterManager(d):(this._clusterManager=this._createClusterManager(d),this.onFeatureReductionChange()):
(console.log("Clustering is supported only for point layers where map spatial reference is WGS84 or Web Mercator"),this._destroyClusterManager()):this._destroyClusterManager())},_canCluster:function(d){var a=this._map;if(!a)return!1;a=a.spatialReference;return this._isFeatureReductionSupported(d)&&this._isReductionCompatibleRenderer(this.renderer)&&(a.isWebMercator()||4326===a.wkid)},_createClusterManager:function(d){d=new Ea({layer:this,aggregationInfo:d});this._clusterHandles=[d.on("renderer-change",
n.hitch(this,function(){this.onFeatureReductionRendererChange()}))];d.initialize(this._map);return d},_updateClusterManager:function(d){var a=this._clusterManager;a&&a.setAggregationInfo(d)},_destroyClusterManager:function(d){m.forEach(this._clusterHandles,function(d){d.remove()});this._clusterHandles=null;this._clusterManager&&(this._clusterManager.destroy(d),this._clusterManager=null,this.onFeatureReductionChange())},redraw:function(){this.inherited(arguments);this._clusterManager&&this._clusterManager.redraw();
this._trackManager&&this._trackManager.container&&this._trackManager.container.redraw()},_evalSDRenderer:function(d){this.inherited(arguments);var a=this._getRenderer();this._ager=!!(a&&a.observationAger&&a.observationRenderer);this._trackManager&&this._trackManager.container&&this._trackManager.container.setRenderer(a&&a.trackRenderer);d&&this._evalFeatureReduction()},_graphicVisibilityChanged:function(d){this._clusterManager?this._clusterManager.toggleFeatureVisibility(d):this._heatmapManager&&
this._heatmapManager.redraw()},setWebGLFetchOptions:function(d){this._hasOnDemandDrillMode()&&(d=d||{},null!=d.maxDrillLevel&&(this._mode.maxDrillLevel=d.maxDrillLevel),null!=d.maxRecordCountFactor&&(this._mode.maxRecordCountFactor=d.maxRecordCountFactor),null!=d.enablePBFQuery&&(this._mode.enablePBFQuery=d.enablePBFQuery))},_isWebGLCompatible:function(){return this.loaded&&!this.isEditable()&&!this.isFeatureReductionApplied()&&(!this.labelingInfo||!1===this.showLabels)&&!this._isGeometryOperationsUsed()&&
this._isRendererSupportedInWebGL()&&this.supportsCoordinatesQuantization&&("esriGeometryPolygon"!==this.geometryType||this.advancedQueryCapabilities.supportsReturningGeometryCentroid)&&this.currentMode===fa.MODE_ONDEMAND&&(!this._preSurfaceChangeState||this._preSurfaceChangeState.currentMode===fa.MODE_ONDEMAND)},_isRendererSupportedInWebGL:function(){if(!this.renderer)return!1;var d=this.renderer,a=d.declaredClass?d.declaredClass.toLowerCase():"";return(-1<a.indexOf("simplerenderer")||-1<a.indexOf("classbreaksrenderer")||
-1<a.indexOf("uniquevaluerenderer"))&&this._hasWebGLCompatibleSymbols(d)&&this._hasWebGLCompatibleVVs(d)},_hasWebGLCompatibleSymbols:function(d){d=this._getAllSymbolsInRenderer(d);return!(this._hasSLSWithMarker(d)||this._hasIncompatibleSMSStyles(d))},_hasWebGLCompatibleVVs:function(d){return!m.some(d&&d.visualVariables,function(d){var a=d.type;return("colorInfo"===a||"opacityInfo"===a)&&d.stops&&8<d.stops.length||"sizeInfo"===a&&(d.field||d.valueExpression&&"$view.scale"!==d.valueExpression||d.expression&&
"view.scale"!==d.expression)&&d.stops&&6<d.stops.length?!0:!1})},_hasSLSWithMarker:function(d){return m.some(d,function(d){return d&&"simplelinesymbol"===d.type&&!!d.marker})},_hasIncompatibleSMSStyles:function(d){return m.some(d,function(d){return d&&"simplemarkersymbol"===d.type&&("path"===d.style||"triangle"===d.style)})},_getAllSymbolsInRenderer:function(d){var a=[];d&&(a.push(d.symbol),a.push(d.defaultSymbol),m.forEach(d.infos,function(d){a.push(d.symbol)}),a=m.filter(a,function(d){return!!d}));
return a},_setMap:function(d){var a=this.inherited(arguments),h=this._mode,l=this;h&&d.loaded&&h.initialize(d);this.geometryType&&this.attr("data-geometry-type",this.geometryType.replace(/esriGeometry/i,"").toLowerCase());this._addHandle=this.on("graphic-node-add",function(d){d=d.graphic.attributes;(d=l._selectedFeatures[d&&d[l.objectIdField]])&&d.attr("data-selected","")});return a},_unsetMap:function(d){var a=this._mode;a&&(a.suspend(),a.destroy());this._destroyClusterManager(!1);this._trackManager&&
(this._trackManager.destroy(),this._trackManager=null);v.disconnect(this._zoomConnect);v.disconnect(this._addHandle);this._zoomConnect=this._addHandle=null;this._toggleTime(!1);this.inherited("_unsetMap",arguments)},onAttach:function(){this._evalModeFromSurface()},refresh:function(){this._needsRefresh=!1;var d=this._mode;d&&d.refresh()},hasXYFootprint:function(){return"esriGeometryMultiPatch"===this.geometryType&&"xyFootprint"===this.multipatchOption},getOutFields:function(){return m.filter(this._getOutFields(),
function(d){return"*"===d||!!this._getField(d)},this)},getField:function(d){return this._getField(d,!0)},isOutField:function(d){d=this.getField(d);if(!d)return!1;var a=this.getOutFields();return-1<m.indexOf(a,"*")||-1<m.indexOf(a,d.name)},getFieldLabel:function(d){var a=this.infoTemplate,a=a&&a.getFieldInfo&&a.getFieldInfo(d);d=n.isFunction(d)?null:this.getField(d);var h=a||d,l="";h&&(l=a&&a.label||d&&d.alias||h.name||h.fieldName);return l},getDomain:function(d,a){var h,l,b=(a=a&&a.feature)&&this.typeIdField&&
a.attributes&&a.attributes[this.typeIdField];null!=b&&m.some(this.types,function(a){return a.id==b?((h=a.domains&&a.domains[d])&&"inherited"===h.type&&(h=this._getLayerDomain(d),l=!0),!0):!1},this);l||h||(h=this._getLayerDomain(d));return h},_getLayerDomain:function(d){this._createFieldsIndex();var a=this._fieldsIndex;if(a)return a=a.caseSensitive,(a=a.get(d))?a.domain:null;var h;m.some(this.fields,function(a){a.name===d&&(h=a.domain);return!!h});return h},getType:function(d){var a,h=d&&this.typeIdField&&
d.attributes&&d.attributes[this.typeIdField];m.some(this.types,function(d){d.id==h&&(a=d);return!!a});return a},setEditable:function(d){if(!this._collection)return console.log("FeatureLayer:setEditable - this functionality is not yet supported for layer in a feature service"),this;if(this._isImageService)return this;if(!this.loaded)return this._optEditable=d,this;var a=this._editable;this._editable=d;this._updateCaps();if(a!==d)this.onCapabilitiesChange();return this},getEditCapabilities:function(d){var a=
{canCreate:!1,canUpdate:!1,canDelete:!1,canUpdateGeometry:!1};if(!this.loaded||!this.isEditable())return a;var h=d&&d.feature;d=d&&d.userId||this.getUserId();var l=m.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],n.trim),b=(a=-1<m.indexOf(l,"editing"))&&-1<m.indexOf(l,"create"),r=a&&-1<m.indexOf(l,"update"),l=a&&-1<m.indexOf(l,"delete"),c=this.ownershipBasedAccessControlForFeatures,e=this.editFieldsInfo,y=e&&e.creatorField,e=e&&e.realm,h=(h=h&&h.attributes)&&y?h[y]:void 0,f=!!this.userIsAdmin,
y=!c||f||!(!c.allowOthersToUpdate&&!c.allowUpdateToOthers),A=!c||f||!(!c.allowOthersToDelete&&!c.allowDeleteToOthers),k=!c||f||!c.hasOwnProperty("allowAnonymousToUpdate")||c.allowAnonymousToUpdate,c=!c||f||!c.hasOwnProperty("allowAnonymousToDelete")||c.allowAnonymousToDelete;d&&e&&(d=d+"@"+e);if(f||a&&!(b||r||l))b=r=l=!0;a={canCreate:b,canUpdate:r,canDelete:l,canUpdateGeometry:f||this.allowGeometryUpdates};d||(a.canUpdate=a.canUpdate&&k,a.canDelete=a.canDelete&&c);null===h?(a.canUpdate=a.canUpdate&&
y,a.canDelete=a.canDelete&&A):""!==h&&h&&d.toLowerCase()!==h.toLowerCase()&&(a.canUpdate=a.canUpdate&&y,a.canDelete=a.canDelete&&A);return a},getUserId:function(){var d;this.loaded&&(d=this.credential&&this.credential.userId||this.userId||"");return d},setUserIsAdmin:function(d){this.userIsAdmin=d},setEditSummaryCallback:function(d){this.editSummaryCallback=d},getEditSummary:function(d,a,h){h=z.isDefined(h)?h:(new Date).getTime();var l="";h=this.getEditInfo(d,a,h);(a=a&&a.callback||this.editSummaryCallback)&&
(h=a(d,h)||"");if(n.isString(h))l=h;else{if(h){d=h.action;a=h.userId;var b=h.timeValue,r=0;d&&r++;a&&r++;z.isDefined(b)&&r++;1<r&&(l=("edit"===d?"edit":"create")+(a?"User":"")+(z.isDefined(b)?h.displayPattern:""))}l=l&&z.substitute(h,this.i18n.layers.FeatureLayer[l])}return l},getEditInfo:function(d,a,h){if(this.loaded){h=z.isDefined(h)?h:(new Date).getTime();a=a&&a.action||"last";var l=this.editFieldsInfo,b=l&&l.creatorField,r=l&&l.creationDateField,c=l&&l.editorField,l=l&&l.editDateField,c=(d=d&&
d.attributes)&&c?d[c]:void 0,l=d&&l?d[l]:null,b=this._getEditData(d&&b?d[b]:void 0,d&&r?d[r]:null,h);h=this._getEditData(c,l,h);var e;switch(a){case "creation":e=b;break;case "edit":e=h;break;case "last":e=h||b}e&&(e.action=e===h?"edit":"creation");return e}},_getEditData:function(d,a,h){var l,b,r;z.isDefined(a)&&(b=h-a,r=0>b?"Full":6E4>b?"Seconds":12E4>b?"Minute":36E5>b?"Minutes":72E5>b?"Hour":864E5>b?"Hours":6048E5>b?"WeekDay":"Full");if(void 0!==d||r)l=l||{},l.userId=d,r&&(d=f.format,h=new Date(a),
l.minutes=Math.floor(b/6E4),l.hours=Math.floor(b/36E5),l.weekDay=d(h,{datePattern:"EEEE",selector:"date"}),l.formattedDate=d(h,{selector:"date"}),l.formattedTime=d(h,{selector:"time"}),l.displayPattern=r,l.timeValue=a);return l},isEditable:function(){return!(!this._editable&&!this.userIsAdmin)},isQueryable:function(){var d=m.map(this.capabilities?this.capabilities.toLowerCase().split(","):[],n.trim);return this._isStream||this.userIsAdmin||this._collection||-1!==m.indexOf(d,"query")||-1!==m.indexOf(d,
"catalog")},setResolution:function(d){return this.setMaxAllowableOffset(d)},setMaxAllowableOffset:function(d){this.isEditable()||(this._optMaxOffset=d,this._setMaxOffset(d,!0));return this},_resetMaxAllowableOffset:function(){this.setMaxAllowableOffset(this._optMaxOffset);this._prevScale=null;this._refreshMaxAllowableOffset()},_refreshMaxAllowableOffset:function(){this._calcMaxOffsetForAutoSnapshot();this._updateMaxOffset();this._needsRefresh=!1},getResolution:function(){return this.getMaxAllowableOffset()},
getMaxAllowableOffset:function(){var d=this._quantizationParameters?this._quantizationParameters.tolerance:void 0;return null!=this._maxOffset?this._maxOffset:d},_setMaxOffset:function(d,a){if(null==d)return delete this._maxOffset,delete this._quantizationParameters,this;this.quantize&&this.supportsCoordinatesQuantization?("esriGeometryPolyline"===this.geometryType?this._maxOffset=d:delete this._maxOffset,this._quantizationParameters=d?{mode:"view",originPosition:"upperLeft",tolerance:d,extent:this.fullExtent}:
null):(this._isFractionalOffsetAllowed()&&a||(d=Math.floor(d)),isNaN(d)||0===d?delete this._maxOffset:this._maxOffset=d,delete this._quantizationParameters);return this},_isFractionalOffsetAllowed:function(){return null==this.version||10.1<=this.version||navigator.languages&&this._isLangWithDot(navigator.languages[0])},_isLangWithDot:function(d){d=(d=d&&d.split("-"))&&d[0]&&d[0].toLowerCase();return-1!==m.indexOf(this._langsWithDot,d)},_langsWithDot:"ar en et fr he ja ko th vi zh".split(" "),setAutoGeneralize:function(d){this.loaded?
this._canAutoGeneralize()&&((this._autoGeneralize=d)?(this._isAutoSnapshotMode()&&(this._prevScale=null),this._updateMaxOffset()):this._setMaxOffset(null)):this._optAutoGen=d;return this},_canAutoGeneralize:function(){return!this.isEditable()&&this.mode!==fa.MODE_SNAPSHOT},setGDBVersion:function(d){this._collection||d===this.gdbVersion||!d&&!this.gdbVersion||(this.gdbVersion=d,this._task.gdbVersion=d,this._url.query=n.mixin(this._url.query,{gdbVersion:d}),this.loaded&&(this.clearSelection(),this._map&&
this.refresh()),this.onGDBVersionChange());return this},hasAllFeatures:function(){return this._mode?this._mode.hasAllFeatures():!0},hasUpdateError:function(){return this._mode?this._mode.hasUpdateError():!1},setDefinitionExpression:function(d){this._defnExpr=d;this._hasPendingLimitQuery()||((d=this._checkFeatureLimit())?this._evalModeAndApplyDefnExpr(d):this._applyDefnExpr());return this},_applyDefnExpr:function(){var d=this._mode;d&&d.propertyChangeHandler(1)},_evalModeAndApplyDefnExpr:function(d){d.then(n.hitch(this,
function(d){d&&(d instanceof Error||!d.modeChanged)&&this._applyDefnExpr()}))},getDefinitionExpression:function(){return this._defnExpr},setTimeDefinition:function(d){this._isSnapshotMode()?(this._timeDefn=d,(d=this._mode)&&d.propertyChangeHandler(2)):console.log("FeatureLayer.setTimeDefinition: layer in on-demand or selection mode does not support time definitions. Layer id \x3d "+this.id+", Layer URL \x3d "+this.url);return this},getTimeDefinition:function(){return this._timeDefn},setTimeOffset:function(d,
a){this._timeOffset=d;this._timeOffsetUnits=a;(d=this._mode)&&d.propertyChangeHandler(0);return this},setUseMapTime:function(d){this.useMapTime=d;this._toggleTime(!this.suspended);(d=this._mode)&&d.propertyChangeHandler(0)},selectFeatures:function(d,a,h,l){a=a||fa.SELECTION_NEW;this._hasSelectionError=this._hasPartialSelectedFeatures=!1;d=this._getShallowClone(d);var b=this._map,r,e=this,y=G._fixDfd(new k(G._dfdCanceller));d.outFields=this.getOutFields();d.returnGeometry=!0;d.multipatchOption=this.multipatchOption;
b&&(d.outSpatialReference=new D(b.spatialReference.toJson()));if(!this._applyQueryFilters(d,!0))return r={features:[]},this._selectHandler(r,a,h,l,y),y;if(b=this._canDoClientSideQuery(d))y._pendingDfd=c(this._doQuery(d,b)),y._pendingDfd.then(function(d){r={features:d};e._selectHandler(r,a,h,l,y)});else{if(this._collection)return this._resolve([Error("FeatureLayer::selectFeatures - "+this.invalidParams)],null,l,y,!0),y;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],
null,l,y,!0),y;var f=this;this._ts&&(d._ts=(new Date).getTime());b=this._canFetchPBFForQuery(d);this._enableEditModeQuantization(d,b);(y._pendingDfd=this._task.execute(d,null,null,b?{format:"pbf"}:null)).addCallbacks(function(d){f._selectHandler(d,a,h,l,y)},function(d){f._hasPartialSelectedFeatures=!0;f._hasSelectionError=!0;f._resolve([d],null,l,y,!0)})}return y},getSelectedFeatures:function(){var d=this._selectedFeatures,a=[],h;for(h in d)d.hasOwnProperty(h)&&a.push(d[h]);return a},clearSelection:function(d){var a=
this._selectedFeatures,h=this._mode,l;for(l in a)a.hasOwnProperty(l)&&(this._unSelectFeatureIIf(l,h),h._removeFeatureIIf(l));this._selectedFeatures={};this._isSelOnly&&h._applyTimeFilter(!0);if(!d)this.onSelectionClear();return this},setSelectionSymbol:function(d){if(this._selectionSymbol=d){var a=this._selectedFeatures,h;for(h in a)a.hasOwnProperty(h)&&a[h].setSymbol(d)}return this},getSelectionSymbol:function(){return this._selectionSymbol},setLabelingInfo:function(d){d?(this.labelingInfo=d,this._fixLabelExpr()):
delete this.labelingInfo;this._collection&&(this._typesDirty=!0);this._evalSurfaceType();this.onLabelingInfoChange()},_fixLabelExpr:function(){var d=/\[([^\[\]]+)\]/ig,a,h=this,l=function(d,a){d=h._getField(a,!0);return"["+(d&&d.name||a)+"]"};m.forEach(this.labelingInfo,function(h){if(a=h.labelExpression)h.labelExpression=a.replace(d,l)})},_updateRequiredFieldsFromLabelingInfo:function(){var d=[];m.forEach(this.labelingInfo,function(a){var h=a.labelExpressionInfo;if(a.labelExpression){var l=/[\[\]]/ig;
a=a.labelExpression.match(/\[[^\[\]]+\]/ig);(a=m.map(a,function(d){return d.replace(l,"")}))&&(d=d.concat(a))}if(h){if(h.value){var b=/[\{\}]/ig;a=h.value.match(/\{[^\{\}]+\}/ig);(a=m.map(a,function(d){return d.replace(b,"")}))&&(d=d.concat(a))}h.expression&&(d=d.concat(O.extractFieldNames(h.expression)))}});d=m.map(d,function(d){var a=this.getField(d);return a?a.name:d},this);this._requiredFields&&(this._requiredFields=this._requiredFields.concat(d))},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],
e:4,f:1}],applyEdits:function(d,a,h,l,b,r){var c=r.assembly,e=r.dfd;this._applyNormalized(d,c&&c[0]);this._applyNormalized(a,c&&c[1]);this.onBeforeApplyEdits(d,a,h);var y={},f=this.objectIdField,c={f:"json"},A=!1;if(this._collection)r={},r.addResults=d?m.map(d,function(){A=!0;return{objectId:this._nextId++,success:!0}},this):null,r.updateResults=a?m.map(a,function(d){A=!0;var a=d.attributes[f];y[a]=d;return{objectId:a,success:!0}},this):null,r.deleteResults=h?m.map(h,function(d){A=!0;return{objectId:d.attributes[f],
success:!0}},this):null,A?this._editHandler(r,d,y,l,b,e):this._resolve([r.addResults,r.updateResults,r.deleteResults],null,l,e);else{d&&0<d.length&&(c.adds=this._convertFeaturesToJson(d,0,1),A=!0);if(a&&0<a.length){for(r=0;r<a.length;r++){var k=a[r];y[k.attributes[f]]=k}c.updates=this._convertFeaturesToJson(a,0,0,1);A=!0}if(h&&0<h.length){a=[];for(r=0;r<h.length;r++)a.push(h[r].attributes[f]);c.deletes=a.join(",");A=!0}if(A){var g=this;return E({url:this._url.path+"/applyEdits",content:n.mixin(c,
this._url.query),callbackParamName:"callback",load:function(a){g._editHandler(a,d,y,l,b,e)},error:function(d){g._resolve([d],null,b,e,!0)}},{usePost:!0})}this._resolve([],null,l,e)}},queryFeatures:function(d,a,h,l){return this._query("execute","onQueryFeaturesComplete",d,a,h,l)},queryRelatedFeatures:function(d,a,h){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",d,a,h)},queryIds:function(d,a,h,l){return this._query("executeForIds","onQueryIdsComplete",d,a,h,l)},queryCount:function(d,
a,h,l){return this._query("executeForCount","onQueryCountComplete",d,a,h,l)},queryExtent:function(d,a,h,l){return this._query("executeForExtent","onQueryExtentComplete",d,a,h,l)},queryAttachmentInfos:function(d,a,h){var l=this._url.path+"/"+d+"/attachments",b=new k(G._dfdCanceller),r=this,l=I.normalize(l);b._pendingDfd=E({url:l,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(h){h=h.attachmentInfos;var c;m.forEach(h,function(a){c=e.objectToQuery({gdbVersion:r._url.query&&
r._url.query.gdbVersion,layer:r._url.query&&r._url.query.layer,token:r._getToken()});a.url=l+"/"+a.id+(c?"?"+c:"");a.objectId=d});r._resolve([h],"onQueryAttachmentInfosComplete",a,b)},error:function(d){r._resolve([d],null,h,b,!0)}});return b},addAttachment:function(d,a,h,l){return this._sendAttachment("add",d,a,h,l)},updateAttachment:function(d,a,h,l,r){h.appendChild(b.create("input",{type:"hidden",name:"attachmentId",value:a}));return this._sendAttachment("update",d,h,l,r)},deleteAttachments:function(d,
a,h,l){var b=this._url.path+"/"+d+"/deleteAttachments",r=new k(G._dfdCanceller),c=this;a={f:"json",attachmentIds:a.join(",")};r._pendingDfd=E({url:b,content:n.mixin(a,this._url.query),callbackParamName:"callback",load:n.hitch(this,function(a){a=a.deleteAttachmentResults;a=m.map(a,function(a){a=new va(a);a.attachmentId=a.objectId;a.objectId=d;return a});c._resolve([a],"onDeleteAttachmentsComplete",h,r)}),error:function(d){c._resolve([d],null,l,r,!0)}},{usePost:!0});return r},addType:function(d){var a=
this.types;if(a){if(m.some(a,function(a){return a.id==d.id?!0:!1}))return!1;a.push(d)}else this.types=[d];return this._typesDirty=!0},deleteType:function(d){if(this._collection){var a=this.types;if(a){var h=-1;m.some(a,function(a,l){return a.id==d?(h=l,!0):!1});if(-1<h)return this._typesDirty=!0,a.splice(h,1)[0]}}},toJson:function(){var d=this._json;if(d=n.isString(d)?u.fromJson(d):n.clone(d)){var d=d.layerDefinition?d:{layerDefinition:d},a=d.layerDefinition,h=this._collection;if(h&&this._typesDirty){a.types=
m.map(this.types||[],function(d){return d.toJson()});var l=this.renderer,b=this.labelingInfo,r=a.drawingInfo;!l&&!b||r||(r=a.drawingInfo={});r&&l&&-1===l.declaredClass.indexOf("TemporalRenderer")&&(r.renderer=l.toJson());b&&(r.labelingInfo=m.map(b,function(d){return d.toJson()}))}l=null;if(!h||this._fcAdded)l={geometryType:a.geometryType,features:this._convertFeaturesToJson(this.graphics,!0)};d.featureSet=n.mixin({},d.featureSet||{},l);d.featureSet.transform&&(b=d.featureSet.transform,delete d.featureSet.transform,
l=new A(d.featureSet),l.quantize(b),d.featureSet=l.toJson());h&&(d.nextObjectId=this._nextId,a.capabilities=this.capabilities);return d}},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryExtentComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},
onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},onCapabilitiesChange:function(){},onGDBVersionChange:function(){},onQueryLimitExceeded:function(){},onLabelingInfoChange:function(){},onFeatureReductionRendererChange:function(){},onFeatureReductionChange:function(){},_evalArcadeSupport:function(){var d=new k;setTimeout(n.hitch(this,function(){this._initializeArcadeEngine().always(function(){d.resolve()})}),0);return d.promise},_initializeArcadeEngine:function(){var d=
[],a=this.infoTemplate;a&&a.initializeArcadeEngine&&d.push(a.initializeArcadeEngine());(a=this.renderer)&&a.initializeArcadeEngine&&d.push(a.initializeArcadeEngine());var h=[];m.forEach(this.labelingInfo,function(d){(d=d.labelExpressionInfo)&&d.expression&&h.push(d.expression)});d.push(W.initialize(h));return F(d)},_isGeometryOperationsUsed:function(){var d=this.infoTemplate,a=this.renderer,h=this.labelingInfo;return d&&d.hasGeometryOperations&&d.hasGeometryOperations()||a&&a.hasGeometryOperations&&
a.hasGeometryOperations()||m.some(h,function(d){return O.hasGeometryOperations(d.labelExpressionInfo&&d.labelExpressionInfo.expression)})?!0:!1},_forceIdentity:function(){var d=new k,a=this,h,l=this._url&&this._url.path;h=l&&l.toLowerCase().indexOf("/rest/services");var b=this.editFieldsInfo,b=b&&(b.creatorField||b.editorField);(this.userIsAdmin||b)&&!this._getToken()&&-1<h&&C.id?(h=l.substring(0,h)+"/rest/info",E({url:h,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(d){if(d.owningSystemUrl)return C.id.checkSignInStatus(d.owningSystemUrl+
"/sharing")}).then(function(d){if(d)return C.id.getCredential(l)}).then(function(d){d&&a._findCredential()}).always(function(){d.resolve()})):d.resolve();return d.promise},_isSnapshotMode:function(){return this._mode?this._mode.isInstanceOf(Ca):!1},_isOnDemandMode:function(){return this._mode?this._mode.isInstanceOf(ma):!1},_isAutoSnapshotMode:function(){return this._isAutoModeEnabled()&&this.currentMode===fa.MODE_SNAPSHOT},_getMaxFeaturesForAutoSnapshotMode:function(){var d=this.geometryType,a;"esriGeometryPolyline"===
d||"esriGeometryPolygon"===d||"esriGeometryMultipoint"===d||this.hasXYFootprint()?a=this.maxRecordCountForAuto:"esriGeometryPoint"===d&&(a=this.maxPointCountForAuto);return a},getLastExceedsLimitResult:function(){return this._lastExceedsLimitResult},_canUseSnapshotMode:function(d){this._lastExceedsLimitResult=d=(d=d&&d.features&&d.features[0])&&d.attributes&&d.attributes.exceedslimit;return!(this.mode!==fa.MODE_AUTO||this.isEditable()||0!==d||!(this._isPaginationAllowed()||this.maxRecordCount>=this._getMaxFeaturesForAutoSnapshotMode()))},
_evalModeFromFLimit:function(d){this._canUseSnapshotMode(d)?this._enableAutoSnapshotMode():this._enableAutoOnDemandMode()},_enableAutoSnapshotMode:function(){var d=fa.MODE_SNAPSHOT;this.isFeatureReductionApplied()?this._updatePreFReductionState(d):this._preSurfaceChangeState?(this._updatePreSurfaceChangeState(d),this._evalSurfaceType(!0)):this.currentMode!==d&&this._setFetchMode(fa.MODE_AUTO,d)},_enableAutoOnDemandMode:function(){var d=fa.MODE_ONDEMAND;this.isFeatureReductionApplied()?this._updatePreFReductionState(d):
this._preSurfaceChangeState?this._updatePreSurfaceChangeState(d):this.currentMode!==d&&(this._setFetchMode(fa.MODE_AUTO,d),this._evalSurfaceType())},_evalModeFromFReduction:function(d){this.loaded&&(d&&this.isFeatureReductionEnabled()&&this._canCluster(d)?this._enableFReductionMode():this._disableFReductionMode())},_enableFReductionMode:function(){this._evalSurfaceType(!0);if(!this._preFReductionState){var d=this.currentMode;d!==fa.MODE_SNAPSHOT&&d!==fa.MODE_STREAM&&d!==fa.MODE_SELECTION&&(this._preFReductionState=
{mode:this.mode,currentMode:this.currentMode},this._setFetchMode(this.mode===fa.MODE_AUTO?fa.MODE_AUTO:fa.MODE_SNAPSHOT,fa.MODE_SNAPSHOT))}},_disableFReductionMode:function(){var d=this._preFReductionState;this._preFReductionState=null;!d||d.mode===this.mode&&d.currentMode===this.currentMode||(this._setFetchMode(d.mode,d.currentMode),this._evalSurfaceType())},_updatePreFReductionState:function(d){this._preFReductionState=this._preFReductionState||{};this._preFReductionState.mode=fa.MODE_AUTO;this._preFReductionState.currentMode=
d},_evalModeFromSurface:function(){this.hasWebGLSurface()?this._enableWebGLSurfaceMode():this._disableWebGLSurfaceMode()},_enableWebGLSurfaceMode:function(){this._preSurfaceChangeState||(this._preSurfaceChangeState={mode:this.mode,currentMode:this.currentMode},this._setFetchMode(this.mode===fa.MODE_AUTO?fa.MODE_AUTO:fa.MODE_ONDEMAND,fa.MODE_ONDEMAND,this.webglDeps.OnDemandDrillMode))},_disableWebGLSurfaceMode:function(){var d=this._preSurfaceChangeState;d&&(this._preSurfaceChangeState=null,this._setFetchMode(d.mode,
d.currentMode))},_updatePreSurfaceChangeState:function(d){this._preSurfaceChangeState=this._preSurfaceChangeState||{};this._preSurfaceChangeState.mode=fa.MODE_AUTO;this._preSurfaceChangeState.currentMode=d},_setFetchMode:function(d,a,h){this.clearSelection();this._mode.suspend();this._mode.destroy();this.mode=d;this.currentMode=a;h=h||this._getModeConstructor(a);this._mode=new h(this);this.queryPagination=a===fa.MODE_ONDEMAND&&-1===h.prototype.declaredClass.toLowerCase().indexOf("ondemanddrillmode")?
!1:this._isPaginationAllowed();(d=this.getMap())&&d.loaded&&(this._resetMaxAllowableOffset(),this._mode.initialize(d),this._mode.startup())},_isPaginationAllowed:function(){return!(!this._optQueryPagination||this.loaded&&!this.advancedQueryCapabilities.supportsPagination)},_getModeConstructor:function(d){var a;d===fa.MODE_SNAPSHOT?a=Ca:d===fa.MODE_ONDEMAND&&(a=ma);return a},_hasOnDemandDrillMode:function(){var d=this._mode,d=d&&d.declaredClass;return!!(d&&-1<d.toLowerCase().indexOf("ondemanddrillmode"))},
_checkFeatureLimit:function(){this._limitPromise&&(this._limitPromise.cancel(),this._limitPromise=null);var d=this._queryLimit();d&&(this._lastExceedsLimitResult=null,this._limitPromise=d.then(n.hitch(this,function(d){var a=this.currentMode;this._evalModeFromFLimit(d);return{modeChanged:this.currentMode!==a}})).always(n.hitch(this,function(d){this._limitPromise=null;return d})));return this._limitPromise},_hasPendingLimitQuery:function(){return!!this._exceedsLimitTimer},_queryLimit:function(){if(this._isAutoModeEnabled()){var d,
a,h=new k(function(){clearTimeout(d);d=null;a&&!a.isFulfilled()&&a.cancel();a=null});this._exceedsLimitTimer=d=setTimeout(n.hitch(this,function(){this._exceedsLimitTimer=null;var d=new V,l=new X;l.statisticType="exceedslimit";l.maxPointCount=this.maxPointCountForAuto;l.maxRecordCount=this.maxRecordCountForAuto;l.maxVertexCount=this.maxVertexCountForAuto;l.outStatisticFieldName="exceedslimit";d.outStatistics=[l];a=this.queryFeatures(d).promise.then(function(d){h.resolve(d)}).otherwise(function(d){h.reject(d)})}),
0);return h.promise}},_isAutoModeEnabled:function(){return this.mode===fa.MODE_AUTO&&this.reHostedFS.test(this.url)},_updateCaps:function(){var d=this._editable,a=n.trim(this.capabilities||""),h=m.map(a?a.split(","):[],n.trim),l=m.map(a?a.toLowerCase().split(","):[],n.trim),a=m.indexOf(l,"editing"),b,l={Create:m.indexOf(l,"create"),Update:m.indexOf(l,"update"),Delete:m.indexOf(l,"delete")};if(d&&-1===a)h.push("Editing");else if(!d&&-1<a){d=[a];for(b in l)-1<l[b]&&d.push(l[b]);d.sort();for(b=d.length-
1;0<=b;b--)h.splice(d[b],1)}this.capabilities=h.join(",")},_counter:{value:0},_getUniqueId:function(){return this._counter.value++},onSuspend:function(){this.inherited(arguments);this._toggleTime(!1);var d=this._mode;d&&d.suspend()},onResume:function(d){this.inherited(arguments);this._toggleTime(!0);var a=this._map,h=this._getRenderer();if(d.firstOccurrence){if(this._fixRendererFields(),this._updateRequiredFieldsFromLabelingInfo(),this._checkFields(),this.clearSelection(),this._evalFeatureReduction(),
this.timeInfo&&!this._trackManager&&(this._trackIdField||h&&(h.latestObservationRenderer||h.trackRenderer))&&(this._trackManager=new la(this),this._trackManager.initialize(a),this._childLayer=this._trackManager.container),h&&"colors"in h&&"blurRadius"in h&&"maxPixelIntensity"in h&&"esriGeometryPoint"==this.geometryType&&!this._heatmapManager&&(this._heatmapManager=new ua(this),this._heatmapManager.initialize(a)),this._zoomConnect=v.connect(a,"onZoomEnd",this,this._zoomEndHandler),this._refreshMaxAllowableOffset(),
h=this._mode)h._init||h.initialize(a),h.startup()}else this._zoomEndHandler(),this._mode&&this._mode.resume()},_zoomEndHandler:function(){var d=this._map;this._updateMaxOffset();this._prevScale=d.getScale();!this.suspended&&this._needsRefresh&&this.refresh()},_updateMaxOffset:function(){var d=this._map;d&&d.loaded&&this._autoGeneralize&&(this._isAutoSnapshotMode()?(d=this.getMaxAllowableOffset(),this._setMaxOffset(this._getMaxOffsetForScale(),!0),this._needsRefresh||(this._needsRefresh=d!=this.getMaxAllowableOffset())):
this._setMaxOffset(d.extent.getWidth()/d.width,!d.extent.spatialReference.isWebMercator()))},_getMaxOffsetForScale:function(){if(this._map){var d=this._map.getScale(),a=this._calculatedScale,h=this._calcMaxOffset,l=this._prevScale;return d>=a&&(null==l||l<a)?h:d<a&&(null==l||l>=a)?null:this.getMaxAllowableOffset()}},_calcMaxOffsetForAutoSnapshot:function(){var d=this._map;if(d&&this._canAutoGeneralize()&&this._isAutoSnapshotMode()&&this._autoGeneralize&&null==this.getMaxAllowableOffset()){var a=this.generalizeForScale;
this._calculatedScale=a=this.maxScale?this.maxScale:this.minScale?Math.min(a,this.minScale):Math.min(a,h.getScale(d,this.initialExtent));this._calcMaxOffset=d.extent.getWidth()/d.width/d.getScale()*a}else this._calculatedScale=this._calcMaxOffset=void 0},_toggleTime:function(d){var a=this._map;d&&this.timeInfo&&this.useMapTime&&a?(this._mapTimeExtent=a.timeExtent,this._timeConnect||(this._timeConnect=v.connect(a,"onTimeExtentChange",this,this._timeChangeHandler))):(this._mapTimeExtent=null,v.disconnect(this._timeConnect),
this._timeConnect=null)},_timeChangeHandler:function(d){this._mapTimeExtent=d;(d=this._mode)&&d.propertyChangeHandler(0)},_getOffsettedTE:function(d){var a=this._timeOffset,h=this._timeOffsetUnits;return d&&a&&h?d.offset(-1*a,h):d},_getTimeOverlap:function(d,a){return d&&a?d.intersection(a):d||a},_getTimeFilter:function(d){var a=this.getTimeDefinition(),h;if(a&&(h=this._getTimeOverlap(a,null),!h))return[!1];if(d){if(d=h?this._getTimeOverlap(d,h):d,!d)return[!1]}else d=h;return[!0,d]},_getAttributeFilter:function(d){var a=
this.getDefinitionExpression();return d?a?"("+a+") AND ("+d+")":d:a},_applyQueryFilters:function(d,a){d.where=this._getAttributeFilter(d.where);d.returnGeometry&&null==d.maxAllowableOffset&&!d.quantizationParameters&&(d.maxAllowableOffset=this._maxOffset,d.quantizationParameters=this._quantizationParameters);a&&this.supportsAdvancedQueries&&(d.orderByFields=d.orderByFields||this.getOrderByFields());if(this.timeInfo)if(a=this._getTimeFilter(d.timeExtent),a[0])d.timeExtent=a[1];else return!1;return!0},
_add:function(d){var a=this._selectionSymbol,h=d.attributes,l=this.visibilityField;a&&this._isSelOnly&&d.setSymbol(a);if(l&&h&&h.hasOwnProperty(l))d[h[l]?"show":"hide"]();return this.add.apply(this,arguments)},_remove:function(){return this.remove.apply(this,arguments)},_canDoClientSideQuery:function(d,a){var h=[],l=this._map,b;if((this._collection||!this._isTable&&l)&&!(d.text||d.where&&d.where!==this.getDefinitionExpression()||d.orderByFields&&d.orderByFields.length&&(b=this.getOrderByFields()||
[])&&d.orderByFields.join()!==b.join()||d.outStatistics||d.returnDistinctValues)){b=this._isSnapshotMode();var r=this._isSelOnly;a=b?null:a?this._getExtentOfTiles(l.extent):l.extent;if(l=d.geometry){if(r||d.spatialRelationship!==V.SPATIAL_REL_INTERSECTS||"extent"!==l.type||!b&&!a.contains(l))return;h.push(1)}if(a=d.objectIds)if(b)h.push(2);else{var l=a.length,c=this._mode,e=0,y;for(y=0;y<l;y++)c._getFeature(a[y])&&e++;if(e===l)h.push(2);else return}if(this.timeInfo)if(d=d.timeExtent,a=this._mapTimeExtent,
b)d&&h.push(3);else if(r){if(d)return}else if(a)if(-1!==m.indexOf(h,2))d&&h.push(3);else if(-1!==m.indexOf(h,1))d==a&&h.push(3);else return;else if(0<h.length)d&&h.push(3);else if(d)return;return 0<h.length?h:null}},_getAbsMid:function(d){return p.toAbsMid?p.toAbsMid(d):g.id.replace(/\/[^\/]*$/ig,"/")+d},_doQuery:function(d,a,h){var l=[],b=this.objectIdField,r=this,c=new k,e=new k,y=this.graphics;if(-1!==m.indexOf(a,1)){var f=this.spatialIndex||this._map&&this._map.spatialIndex,A,g=d.geometry._normalize(null,
!0);null==f&&ra.autoSpatialIndexing?A=(this._map||this).addPlugin(this._getAbsMid("../plugins/spatialIndex")).then(n.hitch(this,n.partial(this._getFromIndex,g,f)),function(d){e.resolve(n.hitch(this,n.partial(this._filterByExtent,y,g)))}):f&&(A=this._getFromIndex(g,f));A?A.then(function(d){for(var a=0;a<d.length;a++)d[a].results&&(l=l.concat(d[a].results));e.resolve(l)}).otherwise(function(d){e.reject(d)}):e.resolve(this._filterByExtent(y,g))}else e.resolve(y);e.then(function(e){l=e;if(-1!==m.indexOf(a,
2)){var y=d.objectIds;l=m.filter(l,function(d){return-1<m.indexOf(y,d.attributes[b])})}-1!==m.indexOf(a,3)&&r.timeInfo&&(e=d.timeExtent,l=r._filterByTime(l,e.startTime,e.endTime).match);h&&(l=m.map(l,function(d){return d.attributes[b]},this));c.resolve(l)});return c},_getFromIndex:function(d,a){a=a||this.spatialIndex||this._map.spatialIndex;d instanceof Array||(d=[d]);var h=this.id;return w(m.map(d,function(d){return a.intersects(d,h)}))},_filterByExtent:function(d,a){for(var h=[],l=0,b=d.length;l<
b;l++){var r=d[l],c=r.geometry;c&&(this.normalization&&a.length?(a[0].intersects(c)||a[1].intersects(c))&&h.push(r):a.intersects(c)&&h.push(r))}return h},_filterByTime:function(d,a,h){var l=this._startTimeField,b=this._endTimeField,r;this._twoTimeFields||(r=l||b);var c=z.isDefined,e=[],y=[],f,A=d.length,k,g;a=a?a.getTime():-Infinity;h=h?h.getTime():Infinity;if(r)for(f=0;f<A;f++)k=d[f],g=k.attributes,l=g[r],l>=a&&l<=h?e.push(k):y.push(k);else for(f=0;f<A;f++)k=d[f],g=k.attributes,r=g[l],g=g[b],r=c(r)?
r:-Infinity,g=c(g)?g:Infinity,r>=a&&r<=h||g>=a&&g<=h||a>=r&&h<=g?e.push(k):y.push(k);return{match:e,noMatch:y}},_getSizeVariables:function(d){return d&&m.filter(d.getVisualVariablesForType("sizeInfo",!1),function(d){return!(!d.field&&!d.valueExpression)})},_needClientSideSorting:function(d){return this._collection?!(!d||!d.length):m.some(d,function(d){return!!d.valueExpression})},_sortFeatures:function(d){var a=this.renderer,h=this._getSizeVariables(a);if(d&&1<d.length&&this._needClientSideSorting(h)){var l=
h[0],b=this;d.sort(function(d,h){d._layer||(d._layer=b);h._layer||(h._layer=b);d=a._getDataValue(d,l,"sizeInfo");h=a._getDataValue(h,l,"sizeInfo");return null==d?-1:null==h?1:h-d})}return d},_resolve:function(d,a,h,l,b){a&&this[a].apply(this,d);h&&h.apply(null,d);l&&G._resDfd(l,d,b)},_getShallowClone:function(d){var a=new V,h;for(h in d)d.hasOwnProperty(h)&&(a[h]=d[h]);return a},_canFetchPBF:function(){return!!(pa&&Ia&&this.supportsFormatPBF)},_canFetchPBFForQuery:function(d){var a=this.advancedQueryCapabilities;
return!(!(this._canFetchPBF()&&("tile"===d.resultType&&a&&a.supportsQueryWithResultType||!this._isAutoSnapshotMode())&&(d.quantizationParameters||!this.isEditable()&&this.supportsQuantizationEditMode))||d.outStatistics)},_enableEditModeQuantization:function(d,a){d&&a&&!d.quantizationParameters&&(d.quantizationParameters={mode:"edit"})},_query:function(d,a,h,l,b,r){var e=this,y=this._map;r=r&&r.snapToTiles;var f=new k(G._dfdCanceller),g=h,H,w,q;if("executeRelationshipQuery"!==d){var g=this._getShallowClone(h),
P=this.getOutFields();g.outFields||(g.outFields=P);g.outFields&&g.outFields.length&&(w=-1<m.indexOf(P,"*")?!1:!m.every(g.outFields,function(d){return-1<m.indexOf(P,d)}));g.returnGeometry=h.hasOwnProperty("returnGeometry")?h.returnGeometry:!h.outStatistics;g.returnGeometry&&(g.multipatchOption=this.multipatchOption,null!=g.maxAllowableOffset||g.quantizationParameters)&&(h=null!=g.maxAllowableOffset?g.maxAllowableOffset:g.quantizationParameters.tolerance,null!=h&&h!==this.getMaxAllowableOffset()&&(q=
!0));var x;y&&(y=y&&y.spatialReference,(h=g.outSpatialReference)?H=!h.equals(y):g.outSpatialReference=new D(y.toJson()));r&&(y=g.geometry)&&"extent"===y.type&&(g.geometry=this._getExtentOfTiles(y),g.resultType||y===g.geometry||(g.resultType="coherent"));if(!this._applyQueryFilters(g,"execute"===d&&!g.outStatistics)){switch(d){case "execute":x=new A({features:[]});break;case "executeForIds":x=[];break;case "executeForCount":x=0;break;case "executeForExtent":x={}}this._resolve([x],a,l,f);return f}if(r=
"executeForExtent"!==d&&!H&&!w&&!q&&this._canDoClientSideQuery(g,r))return f._pendingDfd=c(this._doQuery(g,r,"executeForIds"===d||"executeForCount"===d)),f._pendingDfd.then(function(h){switch(d){case "execute":x=new A;x.features=h;break;case "executeForIds":x=h;break;case "executeForCount":x=h.length}e._resolve([x],a,l,f)}),f}if(this._collection)return this._resolve([Error("FeatureLayer::_query - "+this.invalidParams)],null,b,f,!0),f;if(this.loaded&&!this.isQueryable())return this._resolve([Error("Layer does not support query capability.")],
null,b,f,!0),f;this._ts&&(g._ts=(new Date).getTime());r="execute"===d&&this._canFetchPBFForQuery(g);this._enableEditModeQuantization(g,r);(f._pendingDfd=this._task[d](g,null,null,r?{format:"pbf"}:null)).addCallbacks(function(h){var b=!!g.outStatistics||H||w||q;if("execute"===d||"executeRelationshipQuery"===d){var r,c;if("execute"===d)for(r=h.features,c=r.length,--c;0<=c;c--){if(r[c]._layer=e,!b&&!e._isTable){var y=e._mode._getFeature(r[c].attributes[e.objectIdField]);y&&r.splice(c,1,y)}}else for(y in h)if(h.hasOwnProperty(y))for(r=
h[y].features,c=r.length,--c;0<=c;c--)r[c]._layer=e}e._resolve([h],a,l,f)},function(d){e._resolve([d],null,b,f,!0)});return f},_getExtentOfTiles:function(d){var a=this._isOnDemandMode()&&this._mode._gridLayer||ya.createFromFeatureLayer({layer:this}),h=this.getMap(),h=h&&h.getTargetExtent(d);return a&&h&&a.getExtentOfIntersectingCells(h)||d},_convertFeaturesToJson:function(d,a,h,l){var b=[],r=this._selectionSymbol,c=this.visibilityField,e,y=this.objectIdField;this.loaded&&(h||l)&&(e=m.filter(this.fields,
function(d){return!1===d.editable&&(!l||d.name!==y)}));for(h=0;h<d.length;h++){var f=d[h],A={},k=f.geometry,g=f.attributes,H=f.symbol;!k||l&&this.loaded&&!this.allowGeometryUpdates||(A.geometry=k.toJson());c?(A.attributes=g=n.mixin({},g),g[c]=f.visible?1:0):g&&(A.attributes=n.mixin({},g));A.attributes&&e&&e.length&&m.forEach(e,function(d){delete A.attributes[d.name]});H&&H!==r&&(A.symbol=H.toJson());b.push(A)}return a?b:u.toJson(b)},_selectHandler:function(d,a,h,l,b){var r;switch(a){case fa.SELECTION_NEW:this.clearSelection(!0);
r=!0;break;case fa.SELECTION_ADD:r=!0;break;case fa.SELECTION_SUBTRACT:r=!1}l=d.features;var c=this._mode,e=[],y=this.objectIdField,f,A;if(r)for(r=0;r<l.length;r++)f=l[r],A=f.attributes[y],f=c._addFeatureIIf(A,f),e.push(f),this._selectFeatureIIf(A,f,c);else for(r=0;r<l.length;r++)f=l[r],A=f.attributes[y],this._unSelectFeatureIIf(A,c),A=c._removeFeatureIIf(A),e.push(A||f);this._isSelOnly&&c._applyTimeFilter(!0);this._isImageService&&10.7>this.version&&void 0===d.exceededTransferLimit&&(d.exceededTransferLimit=
l.length===this.maxRecordCount);this._hasPartialSelectedFeatures=!!d.exceededTransferLimit;this._resolve([e,a,d.exceededTransferLimit?{queryLimitExceeded:!0}:null],"onSelectionComplete",h,b);if(d.exceededTransferLimit)this.onQueryLimitExceeded()},_selectFeatureIIf:function(d,a,h){var l=this._selectedFeatures,b=l[d];b||(h._incRefCount(d),l[d]=a,this._isTable||(this._setSelectSymbol(a),a.attr("data-selected","")));return b||a},_unSelectFeatureIIf:function(d,a){var h=this._selectedFeatures[d];h&&(a._decRefCount(d),
delete this._selectedFeatures[d],this._isTable||(this._setUnSelectSymbol(h),h.attr("data-selected")));return h},_setSelectSymbol:function(d){var a=this._selectionSymbol;a&&!this._isSelOnly&&d.setSymbol(a)},_setUnSelectSymbol:function(d){var a=this._selectionSymbol;a&&!this._isSelOnly&&a===d.symbol&&d.setSymbol(null,!0)},_getOutFields:function(){var d=[this.objectIdField,this.typeIdField,this.creatorField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._requiredFields).concat(this.dataAttributes),
d=m.filter(d,function(d,a,h){return!!d&&m.indexOf(h,d)===a}),a=n.clone(this._outFields);if(a){if(-1!==m.indexOf(a,"*"))return a;m.forEach(d,function(d){-1===m.indexOf(a,d)&&a.push(d)});return a}return d},_checkFields:function(d){var a=d||this._getOutFields();m.forEach(a,function(d){"*"!==d&&(this._getField(d)||console.debug("esri.layers.FeatureLayer: "+z.substitute({url:this.url,field:d},"unable to find '${field}' field in the layer 'fields' information [url: ${url}]")))},this);d||this._isTable||
this._fserver||this._collection||this._isStream||m.some(this.fields,function(d){return d&&"esriFieldTypeGeometry"===d.type?!0:!1})||console.debug("esri.layers.FeatureLayer: "+z.substitute({url:this.url},"unable to find a field of type 'esriFieldTypeGeometry' in the layer 'fields' information. If you are using a map service layer, features will not have geometry [url: ${url}]"))},_fixFieldCase:function(d,a,h){var l=d&&d[a],b;if(l&&!n.isFunction(l)){if(b=!this._getField(l)&&this._getField(l,!0))l=d[a]=
b.name;h&&h.push(l)}return l},_fixRendererFields:function(){var d=this.renderer;this._orderBy=null;this._requiredFields=[];if(d&&0<this.fields.length){var a=[],h,d=m.filter([d,d.observationRenderer,d.latestObservationRenderer,d.trackRenderer],z.isDefined),l=[].concat(d);m.forEach(d,function(d){m.forEach(d.rendererInfos,function(d){d.renderer&&l.push(d.renderer)})});m.forEach(l,function(d){this._fixFieldCase(d,"attributeField",a);this._fixFieldCase(d,"attributeField2",a);this._fixFieldCase(d,"attributeField3",
a);this._fixFieldCase(d.rotationInfo,"field",a);(h=this._fixFieldCase(d.sizeInfo,"field",a))&&!this._orderBy&&(this._orderBy=[h+" DESC"]);this._fixFieldCase(d.sizeInfo,"normalizationField",a);this._fixFieldCase(d.colorInfo,"field",a);this._fixFieldCase(d.colorInfo,"normalizationField",a);this._fixFieldCase(d.field,"field",a);this._fixFieldCase(d.opacityInfo,"field",a);this._fixFieldCase(d.opacityInfo,"normalizationField",a);m.forEach(d.visualVariables,function(d){h=this._fixFieldCase(d,"field",a);
"sizeInfo"===d.type&&h&&!this._orderBy&&(this._orderBy=[h+" DESC"]);this._fixFieldCase(d,"normalizationField",a)},this);var l=m.map(d.getFieldsUsedInExpressions(),function(d){var a=this.getField(d);return a?a.name:d},this);a=a.concat(l);this._orderBy||!d.addBreak||n.isFunction(d.attributeField)||!d.backgroundFillSymbol&&!this._hasSizeDiff(d)||(this._orderBy=[d.attributeField+" DESC"])},this);this._requiredFields=m.filter(a,z.isDefined)}},_hasSizeDiff:function(d){var a=Number.MAX_VALUE,h=-Number.MAX_VALUE,
l,b;m.forEach(d.infos,function(d){if(b=d.symbol){l=0;switch(b.type){case "simplemarkersymbol":l=b.size;break;case "picturemarkersymbol":l=(b.width+b.height)/2;break;case "simplelinesymbol":case "cartographiclinesymbol":l=b.width;break;case "simplefillsymbol":case "picturefillsymbol":l=b.outline&&b.outline.width}l&&(a=Math.min(a,l),h=Math.max(h,l))}});return a!==Number.MAX_VALUE&&h!==-Number.MAX_VALUE&&1<Math.abs(h-a)},getOrderByFields:function(){var d=this.orderByFields||this._orderBy;return this.supportsAdvancedQueries&&
d?m.filter(d,function(d){d=d.split(" ")[0];return!!this._getField(d,!0)},this):null},_createFields:function(d){var a=d?d.length:0,h,l=[];for(h=0;h<a;h++)l.push(new y(d[h]));this.fields=l},_createFieldsIndex:function(){if(this._fieldsIndexDirty){var d,a=this.fields,h=a?a.length:0;if(50<h&&this._canUseFieldsIndex()){d=new Map;for(var l=new Map,b=0;b<h;b++){var r=a[b];d.set(r.name,r);l.set(r.name.toLowerCase(),r)}d={caseSensitive:d,caseInsensitive:l}}this._fieldsIndex=d;this._fieldsIndexDirty=!1}},_canUseFieldsIndex:function(){var d=
x.Map;return!("function"!==typeof x.Proxy||"function"!==typeof x.Proxy.revocable||"function"!==typeof d||!d.prototype||"function"!==typeof d.prototype.set)},_getField:function(d,a){var h=this.fields;if(!h||0===h.length)return null;a&&(d=d.toLowerCase());this._createFieldsIndex();var l=this._fieldsIndex;if(l)return l=a?l.caseInsensitive:l.caseSensitive,l.get(d);var b;m.some(h,function(h){var l=!1;(l=a?h&&h.name.toLowerCase()===d?!0:!1:h&&h.name===d?!0:!1)&&(b=h);return l});return b},_getDateOpts:function(){this._dtOpts||
(this._dtOpts={properties:m.map(m.filter(this.fields,function(d){return!(!d||"esriFieldTypeDate"!==d.type)}),function(d){return d.name})});return this._dtOpts},_applyNormalized:function(d,a){d&&a&&m.forEach(d,function(d,h){d&&a[h]&&d.setGeometry(a[h])})},_editHandler:function(d,a,h,b,r,c){r=d.addResults;var e=d.updateResults;d=d.deleteResults;var y,f,A,k,g,H=this.objectIdField,w=this._mode,q=this._isTable;y=this.editFieldsInfo;k=this.getOutFields()||[];var P=y&&y.creatorField,x=y&&y.creationDateField,
u=y&&y.editorField,p=y&&y.editDateField;y=y&&y.realm;-1===m.indexOf(k,"*")&&(P&&-1===m.indexOf(k,P)&&(P=null),x&&-1===m.indexOf(k,x)&&(x=null),u&&-1===m.indexOf(k,u)&&(u=null),p&&-1===m.indexOf(k,p)&&(p=null));var B=x||p?(new Date).getTime():null,z=P||u?this.getUserId():void 0;z&&y&&(z=z+"@"+y);if(r){var ba=this.globalIdField;for(y=0;y<r.length;y++)r[y]=new va(r[y]),q||(f=r[y],f.success&&(A=f.objectId,k=a[y],(g=k._graphicsLayer)&&g!==this&&g.remove(k),g=k.attributes||{},g[H]=A,A=f.globalId,ba&&A&&
(g[ba]=A),P&&(g[P]=z),u&&(g[u]=z),x&&(g[x]=B),p&&(g[p]=B),k.setAttributes(g),w._init&&w.drawFeature(k)))}if(e)for(y=0;y<e.length;y++)if(e[y]=new va(e[y]),!q&&(f=e[y],f.success)){A=f.objectId;k=h[A];if(a=w._getFeature(A))a.geometry!==k.geometry&&k.geometry&&a.setGeometry(l.fromJson(k.geometry.toJson())),a.attributes!==k.attributes&&k.attributes&&a.setAttributes(n.mixin(a.attributes,k.attributes)),this._repaint(a,A);k=a||k;g=k.attributes||{};u&&(g[u]=z);p&&(g[p]=B);k.setAttributes(g)}if(d){h=[];for(y=
0;y<d.length;y++)if(d[y]=new va(d[y]),!q&&(f=d[y],f.success&&(A=f.objectId,k=w._getFeature(A))))this._unSelectFeatureIIf(A,w)&&h.push(k),k._count=0,w._removeFeatureIIf(A);if(0<h.length)this.onSelectionComplete(h,fa.SELECTION_SUBTRACT)}this._resolve([r,e,d],"onEditsComplete",b,c)},_sendAttachment:function(d,a,h,l,b){var r=this;return E({url:this._url.path+"/"+a+"/"+("add"===d?"addAttachment":"updateAttachment"),form:h,content:n.mixin(this._url.query,{f:"json",token:this._getToken()||void 0}),callbackParamName:"callback.html",
handleAs:"json"}).addCallback(function(h){var b="add"===d?"onAddAttachmentComplete":"onUpdateAttachmentComplete";h=new va(h["add"===d?"addAttachmentResult":"updateAttachmentResult"]);h.attachmentId=h.objectId;h.objectId=a;r._resolve([h],b,l);return h}).addErrback(function(d){r._resolve([d],null,b,null,!0)})},_repaint:function(d,a,h){a=z.isDefined(a)?a:d.attributes[this.objectIdField];a in this._selectedFeatures&&this._selectionSymbol||d.setSymbol(d.symbol,h)},_getKind:function(d){var a=this._trackManager;
return a?a.isLatestObservation(d)?1:0:0}});n.mixin(fa,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,MODE_AUTO:6,MODE_STREAM:7,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});d._createWrappers(fa);Object.defineProperty(fa.prototype,"graphics",{get:function(){return this._hasOnDemandDrillMode()?this._mode.graphics:this._graphicsVal},set:function(d){this._graphicsVal=
d}});Object.defineProperty(fa.prototype,"name",{get:function(){return this.arcgisProps&&this.arcgisProps.title?this.arcgisProps.title:this._name},set:function(d){this._name=d;this.loaded&&this.arcgisProps&&(this.arcgisProps.title=null)}});Object.defineProperty(fa.prototype,"fields",{get:function(){return this._fields},set:function(d){d&&this._canUseFieldsIndex()&&(d=new Proxy(d,{set:n.hitch(this,function(d,a,h){if(a)if("length"===a)this._fieldsIndexDirty=!0;else{var l=Number(a);"number"!==typeof l||
isNaN(l)||(this._fieldsIndexDirty=!0)}d[a]=h;return!0})}));this._fields=d;this._fieldsIndexDirty=!0}});return fa})},"esri/arcadeProfiles/labelingProfile":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../promiseList ../arcade/Feature ../support/expressionUtils ./utils".split(" "),function(p,g,t,v,n,m,u,k){return new (p(null,{declaredClass:"esri.arcadeProfiles.LabelingProfile",defaults:{context:{vars:{$feature:"any"}}},initialize:function(f){var e=[];k.hasGeometryOperations(f)&&
e.push(u.enableGeometryOperations());return n(e)},isAsync:function(f){return!1},parse:function(f){return u.createSyntaxTree(f.expression)},compile:function(f){var e=g.clone(this.defaults.context);return f.syntaxTree?u.createFunction(f.syntaxTree,e):null},getEvalOptions:function(f){var e=f.feature;return{context:{vars:{$feature:e&&f.expression.hasVariable("$feature")?m.createFromGraphicLikeObject(e.geometry,e.attributes,f.layer):null},spatialReference:f.spatialReference}}}}))})},"esri/layers/FeatureType":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../symbols/jsonUtils ./RangeDomain ./CodedValueDomain ./InheritedDomain ./FeatureTemplate".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p(null,{declaredClass:"esri.layers.FeatureType",constructor:function(a){if(a&&g.isObject(a)){this.id=a.id;this.name=a.name;var c=a.symbol;c&&(this.symbol=u.fromJson(c));var c=a.domains,m,w=this.domains={};for(m in c)if(c.hasOwnProperty(m)){var q=c[m];switch(q.type){case "range":w[m]=new k(q);break;case "codedValue":w[m]=new f(q);break;case "inherited":w[m]=new e(q)}}if(m=a.templates)for(c=this.templates=[],a=0;a<m.length;a++)c.push(new b(m[a]))}},toJson:function(){var a=
{id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()},b,e=this.domains,f=this.templates,k=m.fixJson;if(e){var g=a.domains={};for(b in e)e.hasOwnProperty(b)&&(g[b]=e[b]&&e[b].toJson());k(g)}f&&(a.templates=t.map(f,function(a){return a.toJson()}));return k(a)}})})},"esri/layers/InheritedDomain":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Domain"],function(p,g,t,v,n){return p([n],{declaredClass:"esri.layers.InheritedDomain"})})},"esri/layers/FeatureTemplate":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../graphic".split(" "),
function(p,g,t,v,n,m){p=p(null,{declaredClass:"esri.layers.FeatureTemplate",constructor:function(n){n&&g.isObject(n)&&(this.name=n.name,this.description=n.description,this.drawingTool=n.drawingTool,this.thumbnail=n.thumbnail,n=n.prototype,this.prototype=new m(n.geometry,null,n.attributes))},toJson:function(){return n.fixJson({name:this.name,description:this.description,drawingTool:this.drawingTool,thumbnail:n.fixJson(g.clone(this.thumbnail)),prototype:this.prototype&&this.prototype.toJson()})}});
g.mixin(p,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",
TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});return p})},"esri/layers/FeatureEditResult":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p(null,{declaredClass:"esri.layers.FeatureEditResult",constructor:function(n){n&&g.isObject(n)&&(this.objectId=n.objectId,this.globalId=n.globalId,this.success=n.success,n.success||(n=n.error,this.error=Error(),
this.error.code=n.code,this.error.message=n.description))}})})},"esri/layers/LabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has dojox/gfx/_base ../kernel ../lang ../symbols/TextSymbol ../symbols/ShieldLabelSymbol".split(" "),function(p,g,t,v,n,m,u,k){var f=/__begin__/ig,e=/__end__/ig,b=/^__begin__/i,a=/__end__$/i;return p(null,{declaredClass:"esri.layers.LabelClass",labelPlacement:null,labelExpression:null,format:null,fieldInfos:null,useCodedValues:null,symbol:null,maxScale:0,
minScale:0,where:null,sizeInfo:null,_labelPlacementLookup:{"above-center":"esriServerPointLabelPlacementAboveCenter","above-left":"esriServerPointLabelPlacementAboveLeft","above-right":"esriServerPointLabelPlacementAboveRight","below-center":"esriServerPointLabelPlacementBelowCenter","below-left":"esriServerPointLabelPlacementBelowLeft","below-right":"esriServerPointLabelPlacementBelowRight","center-center":"esriServerPointLabelPlacementCenterCenter","center-left":"esriServerPointLabelPlacementCenterLeft",
"center-right":"esriServerPointLabelPlacementCenterRight","above-after":"esriServerLinePlacementAboveAfter","above-along":"esriServerLinePlacementAboveAlong","above-before":"esriServerLinePlacementAboveBefore","above-start":"esriServerLinePlacementAboveStart","above-end":"esriServerLinePlacementAboveEnd","below-after":"esriServerLinePlacementBelowAfter","below-along":"esriServerLinePlacementBelowAlong","below-before":"esriServerLinePlacementBelowBefore","below-start":"esriServerLinePlacementBelowStart",
"below-end":"esriServerLinePlacementBelowEnd","center-after":"esriServerLinePlacementCenterAfter","center-along":"esriServerLinePlacementCenterAlong","center-before":"esriServerLinePlacementCenterBefore","center-start":"esriServerLinePlacementCenterStart","center-end":"esriServerLinePlacementCenterEnd","always-horizontal":"esriServerPolygonPlacementAlwaysHorizontal"},constructor:function(a){a&&(g.mixin(this,a),this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)||(this.labelPlacement=m.valueOf(this._labelPlacementLookup,
a.labelPlacement)),a.format&&(this.format=a.format),a.fieldInfos&&(this.fieldInfos=a.fieldInfos),a.symbol&&(this.symbol="esriSHD"===a.symbol.type?new k(a.symbol):new u(a.symbol)),a=this.sizeInfo)&&(a.minSize&&(a.minSize=v.pt2px(a.minSize)),a.maxSize&&(a.maxSize=v.pt2px(a.maxSize)))},getSymbol:function(){return this.symbol},toJson:function(){var a=this.sizeInfo;a&&(a=g.mixin({},a),a.minSize&&(a.minSize=v.px2pt(a.minSize)),a.maxSize&&(a.maxSize=v.px2pt(a.maxSize)));var b=m.fixJson(this.labelExpressionInfo&&
g.clone(this.labelExpressionInfo));this._processLabelExpressionInfo(b);a={name:this.name,labelExpression:this.labelExpression,labelExpressionInfo:b,format:this.format||void 0,fieldInfos:this.fieldInfos||void 0,useCodedValues:this.useCodedValues,maxScale:this.maxScale,minScale:this.minScale,where:this.where,sizeInfo:a||void 0,labelPlacement:this._labelPlacementLookup.hasOwnProperty(this.labelPlacement)?this._labelPlacementLookup[this.labelPlacement]:this.labelPlacement,symbol:this.symbol&&this.symbol.toJson()};
return m.fixJson(a)},_processLabelExpressionInfo:function(a){a&&a.value&&(a.expression=this._convertTemplatedStringToArcade(a.value))},_convertTemplatedStringToArcade:function(c){var k;c&&(k=g.replace(c,function(a,b){return'__begin__$feature["'+b+'"]__end__'}),k=b.test(k)?k.replace(b,""):'"'+k,k=a.test(k)?k.replace(a,""):k+'"',k=k.replace(f,'" + ').replace(e,' + "'));return k}})})},"esri/symbols/ShieldLabelSymbol":function(){define("dojo/_base/declare dojo/_base/lang dojo/sniff dojox/gfx/_base ../kernel ../lang ../urlUtils ./MarkerSymbol ./Font".split(" "),
function(p,g,t,v,n,m,u,k,f){var e={url:"",width:12,height:12,angle:0,xoffset:0,yoffset:0};p=p(k,{declaredClass:"esri.symbol.ShieldLabelSymbol",type:"shieldlabelsymbol",color:[255,255,255,1],width:32,height:32,font:v.defaultFont,constructor:function(b,a,c,f,k){b?g.isString(b)?(this.url=b,a&&(this.color=a),c&&(this.width=c),f&&(this.height=f),void 0!==k&&(this.font=k)):(this.width=v.pt2px(b.width),this.height=v.pt2px(b.height),a=b.imageData,9>t("ie")||!a||(c=this.url,this.url="data:"+(b.contentType||
"image")+";base64,"+a,this.imageData=c)):g.mixin(this,e)},getStroke:function(){return null},getFill:function(){return this.color},setWidth:function(b){this.width=b;return this},setHeight:function(b){this.height=b;return this},setUrl:function(b){b!==this.url&&(delete this.imageData,delete this.contentType);this.url=b;return this},setFont:function(b){this.font=b;return this},setText:function(b){this.text=b;return this},getWidth:function(){return this.width},getHeight:function(){return this.height},
getShapeDescriptors:function(){return{defaultShape:{type:"image",x:-Math.round(this.width/2),y:-Math.round(this.height/2),width:this.width,height:this.height,src:this.url||""},fill:null,stroke:null}},toJson:function(){var b=this.url,a=this.imageData;if(0===b.indexOf("data:"))var c=b,b=a,a=c.indexOf(";base64,")+8,a=c.substr(a);var b=u.getAbsoluteUrl(b),c=v.px2pt(this.width),c=isNaN(c)?void 0:c,e=v.px2pt(this.height),e=isNaN(e)?void 0:e,b=m.fixJson(g.mixin(this.inherited("toJson",arguments),{type:"esriSHD",
url:b,imageData:a,contentType:this.contentType,width:c,height:e}));this.font?(a=new f(this.font),b.font=a.toJson()):b.font=null;delete b.size;b.imageData||delete b.imageData;return b}});p.defaultProps=e;return p})},"esri/layers/SnapshotMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../SpatialReference ../srUtils ../tasks/query ./RenderMode ./support/ParallelSnapshot".split(" "),function(p,g,t,v,n,m,u,k,f){return p([k],{declaredClass:"esri.layers._SnapshotMode",maxFeatures:5E4,
maxRecordCountFactor:1,_isSuspendedAtStartup:!1,_pendingRefresh:!1,constructor:function(e){this.featureLayer=e;this._featureMap={};this._hasUpdateError=this._hasPartialFeatures=!1;this._drawFeatures=g.hitch(this,this._drawFeatures);this._queryErrorHandler=g.hitch(this,this._queryErrorHandler);this._handleSuccess=g.hitch(this,this._handleSuccess);this._handleError=g.hitch(this,this._handleError);this._handleProgress=g.hitch(this,this._handleProgress)},startup:function(){if(!this._started||this._isSuspendedAtStartup){this.inherited(arguments);
var e=this.featureLayer,b=e.advancedQueryCapabilities,a=e.reHostedFS.test(e.url);this.pagination=e.queryPagination&&null!=e.maxRecordCount;this._tileQueriesEnabled=a&&b&&b.supportsQueryWithResultType;a&&this.pagination&&(this._parallelSnapshot=new f({layer:e,mode:this,queryTask:e._task}));this._isSuspendedAtStartup=e.suspended;this._startup()}},propertyChangeHandler:function(e){this._init&&(e?this.featureLayer._collection?console.log("FeatureLayer: layer created by value (from a feature collection) does not support definition expressions and time definitions. Layer id \x3d "+
this.featureLayer.id):this._fetchAll():this._applyTimeFilter())},destroy:function(){this._isSuspendedAtStartup=this._pendingRefresh=!1;this._cancelPendingRequest(this._pendingRequest);this._parallelSnapshot&&this._parallelSnapshot.destroy();this.inherited(arguments)},drawFeature:function(e){var b=e.attributes[this.featureLayer.objectIdField];this._addFeatureIIf(b,e);this._incRefCount(b)},resume:function(){this._isSuspendedAtStartup||this._pendingRefresh?(this._isSuspendedAtStartup=!1,this._startup()):
this.propertyChangeHandler(0)},refresh:function(){var e=this.featureLayer;e._collection?(e._fireUpdateStart(),e._refresh(!0),e._fireUpdateEnd()):this._fetchAll()},hasAllFeatures:function(){return!this._hasPartialFeatures},hasUpdateError:function(){return this._hasUpdateError},canFetchPBF:function(e){return this.inherited(arguments)&&this.featureLayer._canFetchPBFForQuery(e)},_startup:function(){this.featureLayer._collection?this._applyTimeFilter():this._fetchAll()},_fetchAll:function(){var e=this.featureLayer;
e._collection||e.suspended||!e.isQueryable()?this._pendingRefresh=e.suspended:(this._pendingRefresh=!1,e._fireUpdateStart(),this._clearIIf(),this._hasUpdateError=this._hasPartialFeatures=!1,this._parallelSnapshot?this._parallelSnapshot.fetch().then(this._handleSuccess,this._handleError,this._handleProgress):this._sendRequest())},_handleSuccess:function(e){this._hasPartialFeatures=e.hasPartialFeatures;this._hasUpdateError=e.hasUpdateError;this.featureLayer._fireUpdateEnd(null)},_handleError:function(e){this._queryErrorHandler(e)},
_handleProgress:function(e){e.isError?this.featureLayer._errorHandler(e.error):this._addFeatures(e.features)},_getPageSize:function(e){var b=this.featureLayer.tileMaxRecordCount,b="tile"===e.resultType&&b?b:this.featureLayer.maxRecordCount;e.maxRecordCountFactor&&(b*=e.maxRecordCountFactor);return b},_sendRequest:function(e){var b=this.featureLayer,a=this._createQueryInfo(),c=a.query;this.pagination&&(this._pageSize=this._getPageSize(c),this._start=c.start=null==e?0:e,c.num=this._pageSize);this._pendingRequest&&
this._cancelPendingRequest(this._pendingRequest);this._pendingRequest=b._task.execute(c,this._drawFeatures,this._queryErrorHandler,a.pbf?{format:"pbf"}:null)},_drawFeatures:function(e){this._pendingRequest=null;this.featureLayer._isImageService&&10.7>this.featureLayer.version&&void 0===e.exceededTransferLimit&&(e.exceededTransferLimit=e.features.length===this.featureLayer.maxRecordCount);var b=this.featureLayer,a=e.exceededTransferLimit,c=a&&!b._collection;e=this._checkMaxLimit(e.features);var f=
e.maxLimitReached;this._addFeatures(e.features);this.pagination&&c&&!f||(this._hasPartialFeatures=!!a,b._fireUpdateEnd(null,a?{queryLimitExceeded:!0}:null));c&&(this.pagination&&!f&&this._sendRequest(this._start+this._pageSize),b.onQueryLimitExceeded())},_queryErrorHandler:function(e){this._pendingRequest=null;this._hasUpdateError=this._hasPartialFeatures=!0;var b=this.featureLayer;b._errorHandler(e);b._fireUpdateEnd(e)},_checkMaxLimit:function(e){var b=e?e.length:0,a=this.featureLayer.graphics.length+
b,c=a>=this.maxFeatures;if(c){var f=a-this.maxFeatures;f&&e.splice(b-f,f)}return{maxLimitReached:c,featuresDiscarded:a>this.maxFeatures,features:e}},_createQueryInfo:function(){var e=this.featureLayer,b=new u;b.outFields=e.getOutFields();b.where=e.getDefinitionExpression()||"1\x3d1";b.returnGeometry=!0;b.outSpatialReference=m.createSpatialReference(this.map.spatialReference.toJson());b.timeExtent=e.getTimeDefinition();b.maxAllowableOffset=e._maxOffset;b.quantizationParameters=e._quantizationParameters;
b.orderByFields=e.supportsAdvancedQueries?e.getOrderByFields():null;b.multipatchOption=e.multipatchOption;e._ts&&(b._ts=(new Date).getTime());this._tileQueriesEnabled&&(b.resultType="tile");var a=this.canFetchPBF(b);e._enableEditModeQuantization(b,a);this._applyMaxRecordCountFactor(b,a);return{query:b,pbf:a}},_applyMaxRecordCountFactor:function(e,b){var a=this.featureLayer.advancedQueryCapabilities;e&&"tile"===e.resultType&&b&&a&&a.supportsMaxRecordCountFactor&&0<this.maxRecordCountFactor&&1!==this.maxRecordCountFactor&&
(e.maxRecordCountFactor=this.maxRecordCountFactor)},_addFeatures:function(e){var b=this.featureLayer,a=b.objectIdField,c=e.length,f=b._selectedFeatures,k=b.mode===b.constructor.MODE_AUTO,g,m,n;b._fireUpdateStart();b._sortFeatures(e);for(b=0;b<c;b++)m=e[b],n=m.attributes[a],g=this._addFeatureIIf(n,m),this._incRefCount(n),k&&g!==m&&f[n]&&(g.setGeometry(m.geometry),g.setAttributes(m.attributes));this._applyTimeFilter(!0)}})})},"esri/layers/RenderMode":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/_base/array","../sniff","../kernel"],function(p,g,t,v,n){g=!!v("esri-pbf");v=!!v("esri-featurelayer-pbf");return p(null,{declaredClass:"esri.layers._RenderMode",enablePBFQuery:g&&v,initialize:function(g){this.map=g;this._init=!0},startup:function(){this._started=!0},propertyChangeHandler:function(g){},destroy:function(){this._init=this._started=!1},drawFeature:function(g){},suspend:function(){},resume:function(){},refresh:function(){},hasAllFeatures:function(){return!0},hasUpdateError:function(){return!1},
canFetchPBF:function(g){return!(!this.featureLayer._canFetchPBF()||!this.enablePBFQuery)},_incRefCount:function(g){(g=this._featureMap[g])&&g._count++},_decRefCount:function(g){(g=this._featureMap[g])&&g._count--},_getFeature:function(g){return this._featureMap[g]},_addFeatureIIf:function(g,n){var k=this._featureMap,f=k[g],e=this.featureLayer;f||(k[g]=n,e._add(n),n._count=0);return f||n},_removeFeatureIIf:function(g){var m=this._featureMap[g],k=this.featureLayer;if(m){if(m._count)return;delete this._featureMap[g];
k._remove(m)}return m},_registerFeature:function(g,n){var k=this._featureMap,f=k[g];f?(f.attributes=n.attributes,f.geometry=n.geometry):(k[g]=n,n._count=0,n._layer=n._graphicsLayer=n._sourceLayer=this.featureLayer);return f||n},_unregisterFeature:function(g){var m=this._featureMap,k=m[g];k&&!k._count&&(delete m[g],k._graphicsLayer=null)},_clearIIf:function(){var g;g=this.featureLayer;var n=g.graphics,k=g._selectedFeatures,f=g.getSelectedFeatures().length,e=g.objectIdField;if(f)for(g=n.length-1;0<=
g;g--){var f=n[g],b=f.attributes[e];b in k?f._count=1:(f._count=0,this._removeFeatureIIf(b))}else g.clear(),this._featureMap={}},_cancelPendingRequest:function(g){if(g)try{g.cancel()}catch(u){}},_toggleVisibility:function(g){var m=this.featureLayer,k=m.graphics,f=g?"show":"hide",e,b=k.length;g=g&&m._ager;for(e=0;e<b;e++){var a=k[e];a[f]();g&&m._repaint(a)}},_applyTimeFilter:function(g){var m=this.featureLayer;if(m.timeInfo&&!m.suspended){g||m._fireUpdateStart();var k=m._trackManager;k&&k.clearTracks();
var f=m.getTimeDefinition(),e=m._getOffsettedTE(m._mapTimeExtent);e?(e=m._getTimeOverlap(f,e))?(f=m._filterByTime(m.graphics,e.startTime,e.endTime),k&&k.addFeatures(f.match),t.forEach(f.match,function(b){var a=b._shape;b.visible||(b.show(),(a=b._shape)&&a._moveToFront());m._ager&&a&&m._repaint(b)}),t.forEach(f.noMatch,function(b){b.visible&&b.hide()})):this._toggleVisibility(!1):(k&&k.addFeatures(m.graphics),this._toggleVisibility(!0));k&&(k.moveLatestToFront(),k.drawTracks());g||m._fireUpdateEnd()}}})})},
"esri/layers/support/ParallelSnapshot":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../../kernel".split(" "),function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.layers.support.ParallelSnapshot",layer:null,mode:null,queryTask:null,batchSize:5,_queryInfo:null,_fetchDfd:null,_startPage:null,_lastPage:null,_pageSize:null,_maxPages:null,_requests:null,constructor:function(m){g.mixin(this,m);this._requests={}},destroy:function(){this.cancel()},fetch:function(){var g=
new n;this.cancel(!0);this._queryInfo=this.mode._createQueryInfo();this._pageSize=this.mode._getPageSize(this._queryInfo.query);this._maxPages=Math.ceil(this._getFeatureCount()/this._pageSize);this._fetchDfd=g;this._sendRequests();return g.promise},cancel:function(g){this._cancelPendingRequests(g);this._reset()},_reset:function(){this._startPage=this._lastPage=null;this._requests={}},_getFeatureCount:function(){return this.layer.mode===this.layer.constructor.MODE_AUTO&&0===this.layer.getLastExceedsLimitResult()?
this.layer._getMaxFeaturesForAutoSnapshotMode():this.mode.maxFeatures},_sendRequests:function(m){var k=this._queryInfo.query,f=this.queryTask,e=this._requests,b;m=null==m?1:m;b=m+this.batchSize-1;b>this._maxPages&&(b=this._maxPages);if(!(m>b))for(this._startPage=m,this._lastPage=b;m<=b;m++)k.start=(m-1)*this._pageSize,k.num=this._pageSize,e[m]=f.execute(k,null,null,this._queryInfo.pbf?{format:"pbf"}:null),e[m].then(g.hitch(this,this._handleSuccess,m)).otherwise(g.hitch(this,this._handleError,m))},
_evalNextBatch:function(g){g===this._lastPage&&this._sendRequests(this._lastPage+1)},_handleSuccess:function(g,k){k.exceededTransferLimit||this._cancelLaterRequests(g,!0);var f=this.mode._checkMaxLimit(k.features);this._fetchDfd.progress({features:f.features,isError:!1});f.maxLimitReached?((g=f.featuresDiscarded||this._hasRejectedRequests())||(g=!!this._getResult(this._getLastSuccessfulRequest()).exceededTransferLimit),this._resolveFetch(g)):(k.exceededTransferLimit&&this._evalNextBatch(g),this._evalResolution())},
_handleError:function(g,k){var f=this._requests;f&&f[g]&&(1===g?this._rejectFetch(k):(this._evalNextBatch(g),this._fetchDfd.progress({error:k,isError:!0}),this._evalResolution()))},_evalResolution:function(){this._hasPendingRequests()||this._resolveFetch(this._hasRejectedRequests())},_resolveFetch:function(g){var k=this._hasRejectedRequests();this.cancel(!0);this._fetchDfd.resolve({hasPartialFeatures:g,hasUpdateError:k})},_rejectFetch:function(g){this.cancel(!0);this._fetchDfd.reject(g)},_getResult:function(g){return g&&
g.dfd.results[0]},_hasPendingRequests:function(){return!!this._getPendingRequests().length},_getPendingRequests:function(){var g=this._requests,k,f=[];for(k in g){var e=g[k];e.isFulfilled()||f.push({pageId:Number(k),dfd:e})}return f},_getLastSuccessfulRequest:function(){var g=this._getResolvedRequests(),k=-Infinity,f,g=t.filter(g,function(e){return!!this._getResult(e).features.length||1===e.pageId},this);t.forEach(g,function(e){e.pageId>k&&(k=e.pageId,f=e)});return f},_getResolvedRequests:function(){var g=
this._requests,k,f=[];for(k in g){var e=g[k];e.isResolved()&&f.push({pageId:Number(k),dfd:e})}return f},_hasRejectedRequests:function(){var g=this._getRejectedRequests(),k=this._getLastSuccessfulRequest(),f=this._getResult(k);f&&!f.exceededTransferLimit&&(g=t.filter(g,function(e){return e.pageId<=k.pageId}));return!!g.length},_getRejectedRequests:function(){var g=this._requests,k,f=[];for(k in g){var e=g[k];e.isRejected()&&f.push({pageId:Number(k),dfd:e})}return f},_cancelPendingRequests:function(g){this._cancelRequests(this._getPendingRequests(),
g)},_cancelLaterRequests:function(g,k){var f=t.filter(this._getPendingRequests(),function(e){return e.pageId>g});this._cancelRequests(f,k)},_cancelRequests:function(g,k){var f=this.mode,e=this._requests;t.forEach(g,function(b){k&&delete e[b.pageId];f._cancelPendingRequest(b.dfd)})}})})},"esri/layers/OnDemandMode":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../tasks/query ./RenderMode ./GridLayout".split(" "),function(p,
g,t,v,n,m,u,k,f,e){return p([f],{declaredClass:"esri.layers._OnDemandMode",constructor:function(b){this.featureLayer=b;this._featureMap={}},initialize:function(b){this.inherited(arguments);this._cellMap={};this._gridLayer=e.createFromFeatureLayer({layer:this.featureLayer,map:b})},startup:function(){if(!this._started||this._isSuspendedAtStartup)this.inherited(arguments),this._ioQueue=[],this._isSuspendedAtStartup=this.featureLayer.suspended,this.featureLayer.suspended||(this._zoomHandler(),this._enableConnectors())},
propertyChangeHandler:function(b){this._init&&(2>b?this._zoomHandler():console.log("FeatureLayer: layer in on-demand mode does not support time definitions. Layer id \x3d "+this.featureLayer.id+", Layer URL \x3d "+this.featureLayer.url))},destroy:function(){this._disableConnectors();this._processIOQueue(!0);this.inherited(arguments)},drawFeature:function(b){var a=b.geometry,c=[];if(a){var c=this._gridLayer.getCellsInExtent("point"===a.type?{xmin:a.x,ymin:a.y,xmax:a.x,ymax:a.y}:a.getExtent(),!1).cells,
a=this._cellMap,e,f,g=b.attributes[this.featureLayer.objectIdField],k,m,n;for(e=0;e<c.length;e++)f=c[e],k=f.latticeID,m=f.row,n=f.col,k?f=a[k]=a[k]||f:(a[m]=a[m]||{},f=a[m][n]=a[m][n]||f),f.features=f.features||[],f.features.push(b),this._addFeatureIIf(g,b),this._incRefCount(g)}},suspend:function(){this._init&&this._disableConnectors()},resume:function(){this._init&&(this._enableConnectors(),this._zoomHandler())},refresh:function(){this._zoomHandler()},hasAllFeatures:function(){var b=!1,a=this._getCurrentCells(),
c;for(c=0;c<a.length;c++)if(a[c].hasPartialFeatures){b=!0;break}return!b},hasUpdateError:function(){var b=!1,a=this._getCurrentCells(),c;for(c=0;c<a.length;c++)if(a[c].hasUpdateError){b=!0;break}return b},canFetchPBF:function(b){return this.inherited(arguments)&&this.featureLayer._canFetchPBFForQuery(b)},_enableConnectors:function(){var b=this.map;this._zoomConnect=g.connect(b,"onZoomEnd",this,this._zoomHandler);this._panConnect=g.connect(b,"onPanEnd",this,this._panHandler);this._resizeConnect=g.connect(b,
"onResize",this,this._panHandler)},_disableConnectors:function(){g.disconnect(this._zoomConnect);g.disconnect(this._panConnect);g.disconnect(this._resizeConnect)},_zoomHandler:function(){this._processIOQueue(!0);var b=this.featureLayer,a=this.map;!b.suspended&&b.isQueryable()&&(b._fireUpdateStart(),this._clearIIf(),(b=b._trackManager)&&b.clearTracks(),this._cellMap={},this._gridLayer.setResolution(a.extent),this._sendRequest())},_panHandler:function(b){if(this.featureLayer.isQueryable()){this.featureLayer._fireUpdateStart();
var a=this.featureLayer._resized;b=a?b:null;a&&this._gridLayer.setMapState(b,this.map.width,this.map.height);this._sendRequest(b)}},_sendRequest:function(b){this._exceeds=!1;var a=this.featureLayer,c=this.map;b=b||c.extent;c=this._gridLayer.getCellsInExtent(b,a.latticeTiling).cells;if(!a.isEditable())var e=this._cellMap,c=v.filter(c,function(a){if(a.lattice){if(e[a.latticeID])return!1}else if(e[a.row]&&e[a.row][a.col])return!1;return!0});this._pending=this._pending||0;var f;for(f=0;f<c.length;f++){var g=
c[f],k=this._createQueryInfo(g);this._pending++;this._ioQueue.push(a._task.execute(k.query,t.hitch(this,this._drawFeatures,g),t.hitch(this,this._queryErrorHandler,g),k.pbf?{format:"pbf"}:null))}this._removeOldCells(b);this._endCheck()},_drawFeatures:function(b,a){this.featureLayer._isImageService&&10.7>this.featureLayer.version&&void 0===a.exceededTransferLimit&&(a.exceededTransferLimit=a.features.length===this.featureLayer.maxRecordCount);b.hasPartialFeatures=!!a.exceededTransferLimit;b.hasUpdateError=
!1;this._exceeds=this._exceeds||a.exceededTransferLimit;this._finalizeIO();var c=this.featureLayer,e=this.map.extent,f=b.extent,g=b.row,k=b.col,m=c.objectIdField;a=a.features;var n=this._gridLayer,p=this._cellMap,u=b.latticeID,p=u?p[u]:p[g]&&p[g][k];if(b.resolution==n.resolution&&(u?u===n.getLatticeID(e):n.intersects(f,e)))if(p)c._sortFeatures(a),this._updateCell(p,a);else for(c._sortFeatures(a),b.features=a,this._addCellToCellMap(b),c=a.length,b=0;b<c;b++)e=a[b],f=e.attributes[m],this._addFeatureIIf(f,
e),this._incRefCount(f);else p&&this._removeCell(g,k,u);this._endCheck()},_queryErrorHandler:function(b,a){this._finalizeIO();b.hasPartialFeatures=!0;b.hasUpdateError=!0;this._addCellToCellMap(b);this.featureLayer._errorHandler(a);this._endCheck(a)},_finalizeIO:function(){this._pending--},_endCheck:function(b){if(0===this._pending){this._processIOQueue();var a=this.featureLayer,c=a._trackManager;c&&(c.clearTracks(),c.addFeatures(a.graphics),a._ager&&v.forEach(a.graphics,function(b){b._shape&&a._repaint(b)}),
c.moveLatestToFront(),c.drawTracks());this.featureLayer._fireUpdateEnd(!!b&&Error("FeatureLayer: "+(b.message||"an error occurred while updating the layer.")),this._exceeds?{queryLimitExceeded:!0}:null);if(this._exceeds)a.onQueryLimitExceeded()}},_processIOQueue:function(b){this._ioQueue=v.filter(this._ioQueue,function(a){return-1<a.fired?!1:!0});b&&v.forEach(this._ioQueue,this._cancelPendingRequest)},_createQueryInfo:function(b){var a=this.featureLayer,c=new k;c.outFields=a.getOutFields();c.where=
a.getDefinitionExpression();c.returnGeometry=!0;c.geometry=b.extent||b.lattice;a.latticeTiling&&b.extent&&(c.spatialRelationship=k.SPATIAL_REL_CONTAINS);c.timeExtent=a._getOffsettedTE(a._mapTimeExtent);c.maxAllowableOffset=a._maxOffset;c.quantizationParameters=a._quantizationParameters;c.orderByFields=a.supportsAdvancedQueries?a.getOrderByFields():null;c.multipatchOption=a.multipatchOption;a._ts&&(c._ts=(new Date).getTime());(b=a.advancedQueryCapabilities)&&b.supportsQueryWithResultType&&(c.resultType=
"tile");b=this.canFetchPBF(c);a._enableEditModeQuantization(c,b);return{query:c,pbf:b}},_getCurrentCells:function(b){var a=[];b=b||this._cellMap;for(var c in b)if(b.hasOwnProperty(c)){var e=b[c];e&&(e.hasOwnProperty("row")||e.hasOwnProperty("latticeID")?a.push(e):"object"===typeof e&&a.push.apply(a,this._getCurrentCells(e)))}return a},_addCellToCellMap:function(b){var a=this._cellMap;if(b.latticeID)a[b.latticeID]=b;else{var c=b.row,e=b.col;a[c]=a[c]||{};a[c][e]=b}},_removeOldCells:function(b){var a=
this._cellMap,c=this._gridLayer,e,f;for(e in a)if(a[e]){var g=a[e],k=g.latticeID,m=0,n=0;if(k)m++,k!==c.getLatticeID(b)&&(this._removeCell(null,null,k),n++);else for(f in g)g[f]&&(m++,c.intersects(g[f].extent,b)||(this._removeCell(e,f),n++));n===m&&delete a[e]}},_updateCell:function(b,a){var c=this.featureLayer,e=c.objectIdField,c=c._selectedFeatures,f,g=a.length;b.features=b.features||[];for(f=0;f<g;f++){var k=a[f],m=k.attributes[e],n=this._addFeatureIIf(m,k);n===k?(this._incRefCount(m),b.features.push(n)):
m in c||(n.setGeometry(k.geometry),n.setAttributes(k.attributes))}},_removeCell:function(b,a,c){var e=this._cellMap,f=this.featureLayer,g=f.objectIdField,k=c?e[c]:e[b]&&e[b][a];if(k&&(c?delete e[c]:delete e[b][a],b=k.features))for(a=0;a<b.length;a++)c=b[a].attributes[g],this._decRefCount(c),c in f._selectedFeatures||this._removeFeatureIIf(c)}})})},"esri/layers/GridLayout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../geometry/Point ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/normalizeUtils ../srUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){var a=p(null,{declaredClass:"esri.layers._GridLayout",constructor:function(a,b,e,f){this.origin=a;this.cellWidth=b.width;this.cellHeight=b.height;this.mapWidth=e.width;this.mapHeight=e.height;this.srInfo=f},setResolution:function(a){this.resolution=(a.xmax-a.xmin)/this.mapWidth;this.srInfo&&(a=Math.round(Math.round(2*this.srInfo.valid[1]/this.resolution)/this.cellWidth),this._frameStats=[a,0,a-1])},setMapState:function(a,b,e){this.mapWidth=b;this.mapHeight=e;this.setResolution(a)},
getCellCoordinates:function(a){var b=this.resolution,c=this.origin;return{row:Math.floor((c.y-a.y)/(this.cellHeight*b)),col:Math.floor((a.x-c.x)/(this.cellWidth*b))}},normalize:function(a){var b=this._frameStats;if(b){var c=b[0],e=b[1],b=b[2];a<e?(a%=c,a=a<e?a+c:a):a>b&&(a%=c)}return a},intersects:function(a,b){var c=this.srInfo;return c?t.some(b._getParts(c),function(b){return a.intersects(b.extent)}):a.intersects(b)},getCellExtent:function(a,e){var c=this.resolution,f=this.origin,g=this.cellWidth,
k=this.cellHeight;return new u(e*g*c+f.x,f.y-(a+1)*k*c,(e+1)*g*c+f.x,f.y-a*k*c,b.createSpatialReference(f.spatialReference.toJson()))},getLatticeID:function(a){var b=this.getCellCoordinates({x:a.xmin,y:a.ymax}),c=this.getCellCoordinates({x:a.xmax,y:a.ymin});a=b.row;var e=c.row,b=this.normalize(b.col),c=this.normalize(c.col);return a+"_"+e+"_"+b+"_"+c},sorter:function(a,b){return a<b?-1:1},getCellsInExtent:function(a,b){var c=this.getCellCoordinates({x:a.xmin,y:a.ymax}),e=this.getCellCoordinates({x:a.xmax,
y:a.ymin}),f=c.row,g=e.row,c=c.col,e=e.col,m=[],n,x,p,u=[],v=[],K,J,L=[];for(n=f;n<=g;n++)for(x=c;x<=e;x++)p=this.normalize(x),a=this.getCellExtent(n,p),t.some(m,function(a){return a.row===n&&a.col===p})||m.push({row:n,col:p,extent:a,resolution:this.resolution}),b&&(u.push(a.xmin,a.xmax),v.push(a.ymin,a.ymax));c=this.normalize(c);e=this.normalize(e);u.sort(this.sorter);v.sort(this.sorter);b=u.length;for(n=b-1;0<=n;n--)n<b-1&&u[n]===u[n+1]&&u.splice(n,1);b=v.length;for(n=b-1;0<=n;n--)n<b-1&&v[n]===
v[n+1]&&v.splice(n,1);if(u.length&&v.length){a=u[0];x=u[u.length-1];K=v[0];J=v[v.length-1];b=u.length;for(n=0;n<b;n++)L.push([[u[n],J],[u[n],K]]);b=v.length;for(n=0;n<b;n++)L.push([[a,v[n]],[x,v[n]]]);u=new k({paths:L,spatialReference:this.origin.spatialReference.toJson()});m.push({latticeID:f+"_"+g+"_"+c+"_"+e,lattice:u,resolution:this.resolution})}return{minRow:f,maxRow:g,minCol:c,maxCol:e,topRow:f,bottomRow:g,leftCol:c,rightCol:e,cells:m}},_findCell:function(a,b,e){var c;t.some(a,function(a){a.row===
b&&a.col===e&&(c=a);return!!c});return c},getExtentOfIntersectingCells:function(a){var b=this.getCellsInExtent(a),c=b&&b.cells;if(c&&c.length){var g=b.topRow,k=b.leftCol,m=0;t.forEach(c,function(a){a.row===g&&m++});var n=this._findCell(c,g,k).extent,p=this.srInfo,v;!p||m!==this._frameStats[0]&&k!==b.rightCol?(v=n.xmin,p=v+m*n.getWidth()):(v=p.valid[0],p=p.valid[1]);b=this._findCell(c,b.bottomRow,k).extent.ymin;(a=(new u(v,b,p,n.ymax,a.spatialReference))._normalize(!1,!1))&&a.rings&&(a=new f(a),a=
e.getDenormalizedExtent(a));return a}}});a.createFromFeatureLayer=function(b){var c=b.layer;b=c.getMap()||b.map;var e=c._srInfo;(c=b&&b.loaded?new a(new m(e?e.valid[0]:b.extent.xmin,e?e.valid[1]:b.extent.ymax,b.spatialReference),{width:c._tileWidth,height:c._tileHeight},{width:b.width,height:b.height},e):null)&&c.setResolution(b.extent);return c};return a})},"esri/layers/SelectionMode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./RenderMode"],function(p,g,t,
v,n){return p([n],{declaredClass:"esri.layers._SelectionMode",constructor:function(g){this.featureLayer=g;this._featureMap={}},propertyChangeHandler:function(g){this._init&&0===g&&this._applyTimeFilter()},resume:function(){this.propertyChangeHandler(0)},hasAllFeatures:function(){return!this.featureLayer._hasPartialSelectedFeatures},hasUpdateError:function(){return this.featureLayer._hasSelectionError}})})},"esri/layers/StreamMode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/has ../kernel ../SpatialReference ../tasks/query ../tasks/QueryTask ../geometry/jsonUtils ./RenderMode".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p([b],{declaredClass:"esri.layers._StreamMode",constructor:function(a,b){this.featureLayer=a;this._featureMap={};this._setRefreshRate();this._drawBuffer={adds:[],updates:[]};this._timeoutId=null;this._flushDrawBuffer=g.hitch(this,this._flushDrawBuffer);this._featuresByTime={};this._lastEndTimeCheck=null;this._maxFeatureAge=0;a.purgeOptions&&a.purgeOptions.age&&"number"===typeof a.purgeOptions.age&&(this._maxFeatureAge=1E3*Math.ceil(60*a.purgeOptions.age));this._drawFeatures=
g.hitch(this,this._drawFeatures);this._queryErrorHandler=g.hitch(this,this._queryErrorHandler)},startup:function(){this._started||this.inherited(arguments)},propertyChangeHandler:function(a){this._init&&(0===a?this._applyTimeFilter():3===a?this._redrawAllTracks():console.debug("StreamLayer: Stream Layer only supports changing map time or maximumTrackPoints. Layer id \x3d "+this.featureLayer.id))},destroy:function(){this.inherited(arguments);clearTimeout(this._timeoutId);this._featuresByTime=this._drawBuffer=
this._featureMap=null},drawFeature:function(a){var b=this.featureLayer,e=b.objectIdField;this._timeoutId||(this._timeoutId=setTimeout(this._flushDrawBuffer,this._refreshRate));b._joinField&&this._getFeature(a.attributes[e])?this._drawBuffer.updates.push({oid:a.attributes[e],updates:a}):this._drawBuffer.adds.push(a)},resume:function(){this.propertyChangeHandler(0)},refresh:function(){this._pendingRequest&&this._cancelPendingRequest(this._pendingRequest);var a=this.featureLayer;a&&(a._relatedUrl||a._keepLatestUrl?
(a._fireUpdateStart(),a._refreshing=!0,a.disconnect(),a.clear(),a._relatedQueried=!1,a._keepLatestQueried=!1,a.connect()):(a._fireUpdateStart(),a.clear(),a._fireUpdateEnd()))},_drawFeatures:function(a,b){var c=this.featureLayer;c._create(a.features||[]);c._fireUpdateEnd(null,b)},_applyTimeFilter:function(a){this.inherited(arguments);this._redrawAllTracks()},_removeFeatures:function(a){var b=this.featureLayer,e=b.objectIdField;a&&t.forEach(a,function(a){a=a.attributes[e];b._unSelectFeatureIIf(a,this);
this._decRefCount(a);this._removeFeatureIIf(a)},this)},_addFeatures:function(a){var b=this.featureLayer,e=b._endTimeField,f=b._startTimeField,g,k,m,n=[],p=[],u=[];g=b._trackManager;k=b.objectIdField;if(g)for(m in a=g.addFeatures(a),a)a.hasOwnProperty(m)&&(n.push(m),a[m].adds&&(p=p.concat(a[m].adds)),a[m].deletes&&(u=u.concat(a[m].deletes)));else p=a;t.forEach(p,function(a){var b=a.attributes[k],c;c=e&&a.attributes[e];!c&&this._maxFeatureAge&&(c=f&&a.attributes[f]?a.attributes[f]+this._maxFeatureAge:
Date.now()+this._maxFeatureAge);c&&(c=1E3*Math.ceil(c/1E3),this._featuresByTime[c]?this._featuresByTime[c].push(b):this._featuresByTime[c]=[b]);this._addFeatureIIf(b,a);this._incRefCount(b)},this);u.length&&this._removeFeatures(u);g&&g.refreshTracks(n)},_updateFeatures:function(a){var b=this.featureLayer,e,f,g=[];e=b._trackManager;f=b._trackIdField;t.forEach(a,function(a){var c=a.updates;a=this._getFeature(a.oid);var k;if(a){c.geometry&&a.setGeometry(c.geometry);c=c.attributes||{};for(k in c)c.hasOwnProperty(k)&&
(a.attributes[k]=c[k]);a.setAttributes(a.attributes);a.visible=this._checkFeatureTimeIntersects(a);e&&a.attributes[f]?g.push(a.attributes[f]):b._repaint(a,null,!0)}},this);g.length&&e.refreshTracks(g)},_redrawAllTracks:function(){var a=this.featureLayer._trackManager,b;a&&(b=a.trimTracks())&&0<b.length&&(this._removeFeatures(b),a.refreshTracks())},_flushDrawBuffer:function(){clearTimeout(this._timeoutId);var a=this._drawBuffer,b=a.adds.splice(0,a.adds.length),e=a.updates.splice(0,a.updates.length),
a=this.featureLayer;if(!a)return!1;a.updating||a._fireUpdateStart();this._addFeatures(b);this._updateFeatures(e);(b=this._getExpiredFeatures())&&b.length&&(this._removeFeatures(b),a._trackManager&&a._trackManager.removeFeatures(b));a._purge();a._fireUpdateEnd();this._timeoutId=null},_clearDrawBuffer:function(){var a=this._timeoutId,b=this._drawBuffer,e=b.adds,b=b.updates;a&&clearTimeout(a);e.splice(0,e.length);b.splice(0,b.length);this._timeoutId=null},_clearTimeBin:function(){this._featuresByTime=
{};this._lastEndTimeCheck=1E3*Math.ceil(Date.now()/1E3)},_clearFeatureMap:function(){this._featureMap={}},_setRefreshRate:function(a){a=a||0===a?a:200;0>a&&(a=200);this._refreshRate=a},_checkFeatureTimeIntersects:function(a){var b=this.featureLayer,e=b.getMap();return(e=e?e.timeExtent:null)&&b.timeInfo&&(b.timeInfo.startTimeField||b.timeInfo.endTimeField)?0<b._filterByTime([a],e.startTime,e.endTime).match.length:!0},_fetchArchive:function(a){var b=new v,g=this.featureLayer,m,q,n,p,t;this._pendingRequest&&
this._cancelPendingRequest(this._pendingRequest);g._fireUpdateStart();a&&this.map?(a=new f(a),m=new k,q=this.map,n=g.getFilter()||{},p=n.where||"1\x3d1",t=n.geometry?e.fromJson(n.geometry):null,n=n.outFields?n.outFields.split(","):["*"],m.geometry=t,m.where=p,m.outFields=n,m.returnGeometry=!0,m.outSpatialReference=new u(q.spatialReference.toJson()),this._pendingRequest=a.execute(m).then(function(a){this._pendingRequest=null;var c=this._fixFieldNameCasing(g,a);a.features=c;this._drawFeatures(a);g._fireUpdateEnd();
b.resolve()}.bind(this)).otherwise(function(a){this._pendingRequest=null;g._errorHandler(a);g._fireUpdateEnd(a);b.reject(a)}.bind(this))):b.resolve();return b.promise},_queryErrorHandler:function(a){var b=this.featureLayer;b._errorHandler(a);b._fireUpdateEnd(a)},_fixFieldNameCasing:function(a,b){var c=b.features||[],e=b.fields;if(!e||!c.length)return c;a=this._mapFieldNameDifferences(a.fields,e);for(var e=[],f,g=0,k=b.features.length;g<k;g++)b=c[g],f=this._swizzleResponseAttributes(b.attributes,a),
e.push({geometry:b.geometry,attributes:f});return e},_mapFieldNameDifferences:function(a,b){var c=[],e={},f,g;f=0;for(g=b.length;f<g;f++)c.push(b[f].name);f=0;for(g=a.length;f<g;f++){b=a[f].name;var k=this._checkForStreamFieldName(b,c);k&&(e[k]=b)}return e},_checkForStreamFieldName:function(a,b){a=a.toLowerCase();for(var c,e=0,f=b.length;e<f;e++)if(b[e].toLowerCase()===a){c=b[e];break}return c},_swizzleResponseAttributes:function(a,b){var c={},e;for(e in a)if(a.hasOwnProperty(e)){var f=a[e];b.hasOwnProperty(e)?
c[b[e]]=f:c[e]=f}return c},_getExpiredFeatures:function(){var a,b,e,f=[],g=[];if(!this.featureLayer._endTimeField&&!this._maxFeatureAge)return g;a=1E3*Math.floor(this._lastEndTimeCheck/1E3);this._lastEndTimeCheck=b=1E3*Math.ceil(Date.now()/1E3);if(a&&a!==b)for(e=this._featuresByTime;a<=b;a+=1E3)e[a]&&(f=f.concat(e[a]),delete e[a]);t.forEach(f,function(a){(a=this._getFeature(a))&&g.push(a)},this);return g}})})},"esri/layers/TrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/dom-construct dojox/gfx ../kernel ../graphic ../geometry/Polyline ./GraphicsLayer".split(" "),
function(p,g,t,v,n,m,u,k,f,e){var b=-1!==m.renderer.toLowerCase().indexOf("canvas");return p(null,{declaredClass:"esri.layers._TrackManager",constructor:function(a){this.layer=a;this.trackMap={};this.trackLineMap={}},initialize:function(a){this.map=a;a=this.layer;this.createTracklineContainer()&&(a.on("visibility-change",g.hitch(this,function(a){this.container.setVisibility(a.visible);this.container.evaluateSuspension()})),a.on("scale-range-change",g.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,
this.layer.maxScale)})))},createTracklineContainer:function(){var a=this.layer;if("esriGeometryPoint"!==a.geometryType)return null;var c=this.map,f=a._getRenderer(),f=f&&f.trackRenderer,g=this.container=new e._GraphicsLayer({id:a.id+"_tracks",_child:!0,visible:a.visible,minScale:a.minScale,maxScale:a.maxScale});g.loaded=!0;g.onLoad(g);g._setMap(c,a._div);b||(c=g._div.getNode(),a=a._div.getNode(),c&&a&&n.place(c,a,"first"));g.setRenderer(f);return g},addFeatures:function(a){var b=this.trackMap,e=this.layer,
f=e._trackIdField,g=[];t.forEach(a,function(a){var c=a.attributes[f];(b[c]=b[c]||[]).push(a);-1===t.indexOf(g,c)&&g.push(c)});var k=e._startTimeField,m=e.objectIdField,n=function(a,b){var c=a.attributes[k],e=b.attributes[k];return c===e?a.attributes[m]<b.attributes[m]?-1:1:c<e?-1:1};t.forEach(g,function(a){b[a].sort(n)})},trimTracks:function(a){function b(a){for(a=e[a]||[];a.length>f;)g.push(a.shift())}var e=this.trackMap,f=this.layer.maximumTrackPoints||0,g=[],k;if(!f)return g;if(a)t.forEach(a,function(a){b(a)});
else for(k in e)e.hasOwnProperty(k)&&b(k);return g},drawTracks:function(a){function b(a){var b=m[a],c,q,w;q=e.trackLineMap[a];g.remove(q);delete e.trackLineMap[a];q=null;if(!b||2>b.length)return!1;q=[];for(c=b.length-1;0<=c;c--)(w=b[c].geometry)&&q.push([w.x,w.y]);b={};b[p]=a;1<q.length&&(q=new k(new f({paths:[q],spatialReference:n}),null,b),g.add(q),e.trackLineMap[a]=q)}var e=this,g=this.container,m,n,p,u;if(g)if(m=this.trackMap,n=this.map.spatialReference,p=this.layer._trackIdField,a)t.forEach(a,
function(a){b(a)});else for(u in m)m.hasOwnProperty(u)&&b(u)},refreshTracks:function(a){function b(a){var b,c;e.drawTracks([a]);if(k&&k.latestObservationRenderer)for(a=f[a]||[],b=a.length,c=0;c<b;c++)g._repaint(a[c],null,!0)}var e=this,f=this.trackMap,g=this.layer,k=g._getRenderer(),m;if(a)t.forEach(a,function(a){b(a)});else for(m in f)f.hasOwnProperty(m)&&b(m);this.moveLatestToFront()},moveLatestToFront:function(a){t.forEach(this.getLatestObservations(a),function(a){var b=a._shape;b&&b._moveToFront();
this._repaint(a,null,!0)},this.layer)},getLatestObservations:function(a){function b(a){a=g[a];return a[a.length-1]}var e=[],f=this.layer._getRenderer(),g=this.trackMap,k;if(!f.latestObservationRenderer)return e;if(a)t.forEach(a,function(a){e.push(b(a))});else for(k in g)g.hasOwnProperty(k)&&e.push(b(k));return e},clearTracks:function(a){var b=this.getLatestObservations(a),e=this.container,f=this.trackMap,g,k;if(a)t.forEach(a,function(a){delete this.trackMap[a];e&&(k=this.trackLineMap[a],e.remove(k),
delete this.trackLineMap[a])},this);else{if(e)for(g in f)k=this.trackLineMap[g],e.remove(k);this.trackMap={};this.trackLineMap={}}t.forEach(b,function(a){this._repaint(a,null,!0)},this.layer)},isLatestObservation:function(a){var b=this.trackMap[a.attributes[this.layer._trackIdField]];return b?b[b.length-1]===a:!1},destroy:function(){var a=this.container;a&&(a.clear(),a._unsetMap(this.map,this.layer._div));this.map=this.layer=this.trackMap=this.container=null}})})},"esri/layers/HeatmapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/_base/array require ../kernel ../sniff ../geometry/Point ../geometry/webMercatorUtils ./MapImage ../renderers/HeatmapRenderer ../tasks/query dojo/_base/fx".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){function x(){}function w(a){var b=a.layer;return{geometry:a.geometry,attributes:a.attributes,getLayer:function(){return b}}}return p(null,{declaredClass:"esri.layers.HeatmapManager",heatmapRenderer:null,sourceLayer:null,imageLayer:null,useTiles:!0,useWorker:!1,map:null,constructor:function(a){this.sourceLayer=a;this._hndls=[]},initialize:function(a){this.map=a;var c=this.sourceLayer,e=c.renderer;c.setDrawMode(!1);this.imageLayer=a._getMapImageLyr();var f=this;this.heatmapRenderer=
e instanceof b?e:(e.getRendererInfoByZoom(a.getZoom())||e.getRendererInfoByScale(a.getScale())).renderer;this.redraw=this.redraw.bind(this);this.recalculateHeatmap=this.recalculateHeatmap.bind(this);this._removeRenderer=this._removeRenderer.bind(this);this._handleRendererChange=this._handleRendererChange.bind(this);this._rendererChangeHandle=this.sourceLayer.on("renderer-change",this._handleRendererChange);this._handleOpacityChange=this._handleOpacityChange.bind(this);this._reprojectFeature=this._reprojectFeature.bind(this);
n(["../workers/heatmapCalculator"],function(a){f._calculator=new a(g.mixin({width:f.map.width,height:f.map.height},f._getOptions()));f._setupRenderer();f.heatmapRenderer.getStats=a.calculateStats;f.heatmapRenderer.getHistogramData=a.getHistogramData})},destroy:function(){this._removeHandlers();this._rendererChangeHandle&&this._rendererChangeHandle.remove();this._rendererChangeHandle=this.sourceLayer=this.imageLayer=this.map=this.heatmapRenderer=this._hndls=null},_handleRendererChange:function(a){var c=
a.renderer,e=c instanceof b;this.heatmapRenderer?e?this.heatmapRenderer=c:this._removeRenderer(a):e&&(this.heatmapRenderer=c,this.sourceLayer&&this.map&&this._setupRenderer())},_handleOpacityChange:function(a){a=a.opacity;var b=this._getImageBySourceId(this.sourceLayer.id);b&&b.setOpacity(a)},_setupRenderer:function(){var a=this._hndls,b=this.sourceLayer,c=this.map,e=this;b._originalDraw=b._draw;b._draw=x;b._div.clear();clearTimeout(this._resetTimer);this._resetTimer=setTimeout(this._resetGraphics.bind(this),
250);a.push(b.on("update-end",this.redraw));a.push(b.on("suspend",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&a.hide()}));a.push(b.on("resume",function(a){(a=e._getImageBySourceId(e.sourceLayer.id))&&a.show()}));a.push(t.after(b,"redraw",this.redraw));a.push(c.on("layer-remove",function(a){a.layer==b&&((a=e._getImageBySourceId(e.sourceLayer.id))&&e.imageLayer.removeImage(a),e._removeRenderer({target:b}))}));b._collection&&a.push(b.on("graphic-add",function(a){e._reprojectFeature(a.graphic);
e.redraw()}));1!==b.mode&&(a.push(c.on("resize, pan-end",this.redraw)),a.push(c.on("zoom-end",this.redraw)));a.push(b.on("opacity-change",this._handleOpacityChange));this.imageLayer.suspended&&this.imageLayer.resume();b.graphics&&b.graphics.length&&(b.graphics[0].geometry&&!c.spatialReference.equals(b.graphics[0].geometry.spatialReference)&&v.forEach(b.graphics,function(a){this._reprojectFeature(a)}.bind(this)),this.redraw())},redraw:function(){if(!this._drawTimer){var a=this;this._drawTimer=setTimeout(function(){clearTimeout(a._drawTimer);
a._drawTimer=null;a.sourceLayer._getRenderer().isInstanceOf(b)&&a.recalculateHeatmap()},16)}},_removeRenderer:function(a){var b=a.target;b._draw=b._originalDraw;delete b._originalDraw;b.setDrawMode(!0);this._removeHandlers();this._hndls=[];var c=this._getImageBySourceId(this.sourceLayer.id);c&&this.imageLayer.removeImage(c);clearTimeout(this._drawTimer);clearTimeout(this._resetTimer);this._drawTimer=this._resetTimer=null;b.renderer!=a.renderer&&b.renderer.getRendererInfo?this.heatmapRenderer=null:
(this.destroy(),b.renderer&&b.renderer.getRendererInfo&&b.redraw())},recalculateHeatmap:function(){this._calculator?this._doMainCalculation():this._calculatorClient&&this._doWorkerCalculation()},_reprojectFeature:function(a){if(a&&a.geometry){var b=a.geometry,c=this.map.spatialReference;c.equals(b.spatialReference)||(b=f.project(b,c),null==b?console.log("Unable to reproject features to map's spatial reference. Please convert feature geometry before adding to layer"):a.geometry=b)}},_doWorkerCalculation:function(){},
_doMainCalculation:function(){var b=this.sourceLayer,c=this.map,f=this.heatmapRenderer,k=this.map.extent,m=this.map.width,n=this.map.height,x=this._calculator,p=this,u=function(a){a=p._getScreenPoints(a.features,c,b);a=x.calculateImageData(g.mixin({screenPoints:a,mapinfo:{extent:[k.xmin,k.ymin,k.xmax,k.ymax],resolution:c.getResolution()},width:m,height:n},p._getOptions()));a=f.getSymbol(w({geometry:c.extent,attributes:{size:[m,n],imageData:a},layer:b}));a=new e({extent:c.extent,href:a.url,opacity:0,
sourceId:b.id});p._swapMapImages(a,p._getImageBySourceId(b.id));b.suspended&&a.hide()},v={geometry:c.extent,timeExtent:b.useMapTime?c.timeExtent:void 0,spatialRelationship:a.SPATIAL_REL_INTERSECTS};null!=b._canDoClientSideQuery(v)?b.queryFeatures(v,u):u({features:b.graphics})},_getScreenPoints:function(a,b,c){var e=[],f=a.length,g=0,m=0,w,q=new k(b.extent.xmin,b.extent.ymax,b.spatialReference),n=b.toScreen(q),x=n.x,n=n.y,p=b.getResolution(),u;for((m=b.extent.getCacheValue("_parts"))&&(u=v.map(m,function(a){return c._intersects(b,
a.extent)[0]}));f--;)m=a[f],m.geometry&&m.visible&&(w={x:Math.ceil((m.geometry.x-q.x)/p+x),y:Math.floor((q.y-m.geometry.y)/p-n),attributes:m.attributes},u&&(m=1<u.length&&w.x<-u[0]?u[1]:u[0],w.x+=m),e[g++]=w);return e},_getImageBySourceId:function(a){var b=this.imageLayer.getImages(),b=v.filter(b,function(b){return b.sourceId==a});if(b.length)return b[b.length-1]},_swapMapImages:function(a,b){function e(){f.removeImage(b)}var f=this.imageLayer,g=this.sourceLayer.opacity;f.addImage(a);c.anim(a._node,
{opacity:g},null,null,function(){a.opacity=g});null!=b&&c.anim(b._node,{opacity:0},null,null,e)},_removeHandlers:function(){if(null!=this._hndls)for(var a=this._hndls.length;a--;)this._hndls[a].remove()},_getOptions:function(){var a=this.heatmapRenderer;return{blurRadius:a.blurRadius,gradient:a.gradient,maxPixelIntensity:a.maxPixelIntensity,minPixelIntensity:a.minPixelIntensity,field:a.field,fieldOffset:a.fieldOffset}},_resetGraphics:function(){clearTimeout(this._resetTimer);this._resetTimer=null;
for(var a=this.sourceLayer.graphics,b=a.length,c;b--;)c=a[b],c._shape=c._offsets=void 0}})})},"esri/layers/MapImage":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has ../kernel ../domUtils ../geometry/Extent".split(" "),function(p,g,t,v,n,m,u){return p(null,{declaredClass:"esri.layers.MapImage",constructor:function(k){g.mixin(this,k);this.extent=new u(this.extent)},visible:!0,opacity:1,getLayer:function(){return this._layer},getNode:function(){return this._node},show:function(){if(!this.visible){this.visible=
!0;var g=this._node,f=this._layer,e;if(g){if(e=f&&f._div)f.suspended||f._setPos(g,e._left,e._top),(f._active||e).appendChild(g);m.show(g)}}},hide:function(){if(this.visible){this.visible=!1;var g=this._node;g&&(m.hide(g),g.parentNode&&g.parentNode.removeChild(g))}},setOpacity:function(g){var f=this._node;this.opacity=g;f&&t.set(f,"opacity",g)}})})},"esri/layers/clustering/ClusterManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../../kernel ../../Evented ../../graphic ../../lang ../../Color ../../graphicsUtils ../../dijit/PopupTemplate ../../dijit/Legend/utils ../../renderers/ClassBreaksRenderer ../../symbols/SimpleMarkerSymbol ../GraphicsLayer ../Field ./GeohashAggregation ./statUtils dojo/i18n!../../nls/jsapi".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){var B=E.layers.clusters,G=E.widgets.popup,F=B.numFeatures,D=Math.pow(2,53)-1;return p(m,{declaredClass:"esri.layers.clustering.ClusterManager",layer:null,aggregationInfo:null,container:null,defaults:{clusterRadius:80,markerSymbol:{color:[77,77,77,255],size:6,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}}},_initialized:!1,_map:null,_eventHandles:null,_clusterRadius:null,
_renderer:null,_statisticInfos:null,_fields:null,_infoTemplate:null,_clusterGenerator:null,_singleGraphics:null,constructor:function(a){this._eventHandles=[];this.layer=a.layer;this.setAggregationInfo(a.aggregationInfo)},initialize:function(a){this._initialized=!0;this._map=a;this.container=this._createContainer();this._clusterGenerator=this._createClusterGenerator();this._initClusterGenerator();this._createLayerEventListeners();this._createMapEventListeners();this._createPopupEventListeners()},destroy:function(a){this._clearSingleGraphics();
this._removeClusterBoundary();this._destroyEventListeners();this._removeFromPopup(this.container);this._removeFromPopup(this.layer);this._resetClusterNav();this._destroyClusterGenerator(a);this._destroyContainer();this.layer=this.aggregationInfo=this._map=null},setAggregationInfo:function(a){this.aggregationInfo=a?g.mixin({},a):null;this._applyAggregationInfo()},getClusterRenderer:function(){return this._renderer},getClusterFields:function(){return this._fields||[]},getFeaturesInCluster:function(a){a=
a&&a.getAggregationInfo();return this._clusterGenerator?this._clusterGenerator.getFeaturesInCluster(a):[]},getAggregateGraphics:function(){return this.container?this.container.graphics.slice(0):[]},getSingleGraphics:function(){return this._singleGraphics?this._singleGraphics.slice(0):[]},redraw:function(){this.container&&this.container.redraw()},isClusteringEnabled:function(){return!(!this._clusterGenerator||!this._clusterGenerator.clustersEnabled)},isClusteringActive:function(){return!!(this._clusterGenerator&&
0<this._clusterGenerator.getNumFeatures())},toggleFeatureVisibility:function(a){this._clusterGenerator&&this._clusterGenerator.toggleFeatureVisibility(a)},_createContainer:function(){var a=this.layer,b=new w._GraphicsLayer({_child:!0,id:a.id+"_clusters",visible:a.visible,minScale:a.minScale,maxScale:a.maxScale,infoTemplate:this._infoTemplate});b.fields=this._fields;b.setRenderer(this._renderer);b.loaded=!0;b.onLoad(b);b._setMap(this._map,a._div);return a._childLayer=b},_destroyContainer:function(){var a=
this.container;a&&(a.clear(),a._unsetMap(this._map,this.layer._div),this.layer._childLayer=null);this.container=null},_createClusterGenerator:function(){return new C({map:this._map,layer:this.layer,clusterRadius:this._clusterRadius,statisticInfos:this._statisticInfos})},_initClusterGenerator:function(){var a=this._clusterGenerator;a.loaded?this._awaitClusterGenerator():this._eventHandles.push(a.on("load",g.hitch(this,function(){this._awaitClusterGenerator()})),a.on("load-error",g.hitch(this,function(a){console.log(a.error)})))},
_destroyClusterGenerator:function(a){this._clusterGenerator&&this._clusterGenerator.destroy(a);this._clusterGenerator=null},_awaitClusterGenerator:function(){var a=this._clusterGenerator;a.started?(this._applyRenderer(),this._initClusterUpdates()):this._eventHandles.push(a.on("start",g.hitch(this,function(){this._applyRenderer();this._initClusterUpdates()})))},_applyAggregationInfo:function(){this._applyClusterRadius();this._applyRenderer();this._clusterGenerator&&!this._clusterGenerator.isUpdateScheduled()&&
this.redraw()},_applyClusterRadius:function(){var a=this.aggregationInfo;this._clusterRadius=a&&a.clusterRadius||this.defaults.clusterRadius;this._clusterGenerator&&this._clusterGenerator.setClusterRadius(this._clusterRadius);this._computeClusterRadius()},_computeClusterRadius:function(){var a=this.aggregationInfo||{};a.clusterRadius=this._clusterRadius;this.aggregationInfo=a},_applyRenderer:function(){var a=this.container,b=this._getClusterRendererInfo(),c=this._compareStatInfos(this._statisticInfos,
b.statisticInfos);c&&(this._statisticInfos=b.statisticInfos,this._clusterGenerator&&(this._clusterGenerator.setStatisticInfos(t.map(this._statisticInfos,function(a){return{attributeInfo:a.attributeInfo,statisticType:a.statisticType}})),a&&t.forEach(a.graphics,function(a){this._applyClusterAttributes(a,a.getAggregationInfo())},this)));this._renderer=b.renderer;this._applyFields();this._applyInfoTemplate(!!c&&this._initialized);a&&(a.setRenderer(this._renderer),this.emit("renderer-change"))},_applyFields:function(){this._fields=
this._getFields(this._statisticInfos);this.container&&(this.container.fields=this._fields)},_applyInfoTemplate:function(a){if(this.layer.infoTemplate){var b=this.aggregationInfo,b=b&&b.infoTemplate||this._infoTemplate;a=a||!b?this._createInfoTemplate():this._updateInfoTemplate(b)}else a=null;this._infoTemplate=a;this.container&&this.container.setInfoTemplate(this._infoTemplate);this._computeInfoTemplate()},_computeInfoTemplate:function(){var a=this.aggregationInfo||{};a.infoTemplate=this._infoTemplate;
this.aggregationInfo=a},_getClusterRendererInfo:function(){var a=this.layer&&this.layer.renderer;return a?this._createClusterRenderer(a):this._getDefaultClusterRenderer()},_getDefaultClusterRenderer:function(){var a=this._createContinuousCountRenderer();this._addSizeByCountVariable(a);return{renderer:a,statisticInfos:[]}},_createContinuousCountRenderer:function(a){var b=new c(null,"cluster_count");b.addBreak({minValue:-D,maxValue:D,symbol:a?new a.constructor(a.toJson()):new x(g.clone(this.defaults.markerSymbol))});
return b},_createClusterRenderer:function(a){if(!this._isSupportedRenderer(a))return this._getDefaultClusterRenderer();var b,c=[];if(this._isSimpleRenderer(a))b=this._createContinuousCountRenderer(a.symbol);else{b=new a.constructor(a.toJson());var e=this._getRendererAttributeInfo(a),f;this._isCBRenderer(b)?(f=z.getClusterField(e,"avg"),c.push(this._getStatInfo(e,"avg")),b.normalizationType=null,b.normalizationField=null,b.normalizationTotal=null):this._isUVRenderer(b)&&(f=z.getClusterField(e,"type"),
c.push(this._getStatInfo(e,"type")));b.attributeField=f;b.setValueExpression(null);b.valueExpressionTitle=null;b.setVisualVariables(null);this._setRendererTitle(b,a)}a=this._getSupportedVariables(a);e=this._createClusterVariables(a.allVars,c);b.setVisualVariables(e);a.sizeVars.length||this._isCBSizeRenderer(b)||this._addSizeByCountVariable(b);return{renderer:b,statisticInfos:c}},_isSupportedRenderer:function(a){if(this._isSimpleRenderer(a))return!0;if(this._isCBRenderer(a)){var b=a.normalizationType;
return"function"===typeof a.attributeField||b&&"field"!==b?!1:!0}return this._isUVRenderer(a)?"function"===typeof a.attributeField||a.attributeField2?!1:!0:!1},_isSimpleRenderer:function(a){return-1<a.declaredClass.toLowerCase().indexOf("simplerenderer")},_isCBRenderer:function(a){return-1<a.declaredClass.toLowerCase().indexOf("classbreaksrenderer")},_isUVRenderer:function(a){return-1<a.declaredClass.toLowerCase().indexOf("uniquevaluerenderer")},_isCBSizeRenderer:function(a){var b=a.infos;if(!this._isCBRenderer(a)||
!b||2>b.length)return!1;var c=Infinity,e=-Infinity;t.forEach(b,function(a){if(a=a.symbol){var b=0;switch(a.type){case "simplemarkersymbol":b=a.size;break;case "picturemarkersymbol":b=(a.width+a.height)/2}c=Math.min(c,b);e=Math.max(e,b)}});return Infinity!==c&&-Infinity!==e&&c!==e},_getRendererAttributeInfo:function(a){var b=a.attributeField,c=b?this.layer.getField(b):null;return{field:b,attributeType:c&&"esriFieldTypeDate"===c.type?"date":null,rotationType:null,valueExpression:a.valueExpression,valueExpressionTitle:a.valueExpressionTitle,
normalizationField:a.normalizationField}},_setRendererTitle:function(b,c){b.legendOptions=g.clone(c.legendOptions);b.legendOptions&&b.legendOptions.title||(b.legendOptions=b.legendOptions||{},b.legendOptions.title=a.getRendererTitle(c,this.layer))},_getSupportedVariables:function(a){var b=a.getVisualVariablesForType("colorInfo",!1)||[],c=a.getVisualVariablesForType("sizeInfo",!1)||[],e=a.getVisualVariablesForType("opacityInfo",!1)||[];a=a.getVisualVariablesForType("rotationInfo",!1)||[];b=t.filter(b,
this._variableFilter);c=t.filter(c,this._variableFilter);e=t.filter(e,this._variableFilter);a=t.filter(a,this._variableFilter);return{sizeVars:c,allVars:b.concat(c).concat(e).concat(a)}},_variableFilter:function(a){return"function"!==typeof a.field},_createClusterVariables:function(a,b){return t.map(a,function(a){return this._createVarForAvg(a,b)},this)},_createVarForAvg:function(a,b){var c=g.clone(a),e=this._getVariableAttributeInfo(a);c.field=z.getClusterField(e,"avg");c.normalizationField=null;
c.valueExpression=null;c.valueExpressionTitle=null;e=this._getStatInfo(e,"avg");this._addStatInfo(b,e);this._setVariableTitle(c,a);return c},_getVariableAttributeInfo:function(a){var b="rotationInfo"===a.type,c=b?"angle":null,b=b?a.rotationType:null,e=a.legendOptions&&a.legendOptions.title,f=a.field,g=f?this.layer.getField(f):null;g&&"esriFieldTypeDate"===g.type&&(c="date");return{field:f,attributeType:c,rotationType:b,valueExpression:a.valueExpression,valueExpressionTitle:a.valueExpressionTitle||
a.valueExpression&&e,normalizationField:a.normalizationField}},_setVariableTitle:function(b,c){b.legendOptions&&b.legendOptions.title||(b.legendOptions=b.legendOptions||{},b.legendOptions.title=a.getVisualVariableTitle(c,this.layer))},_getStatInfo:function(a,b){return{statisticHash:z.getStatisticHash(a,b),attributeInfo:a,statisticType:b}},_addStatInfo:function(a,b){var c=this._findStatInfo(a,b);c?c.attributeInfo.valueExpressionTitle||(c.attributeInfo.valueExpressionTitle=b.attributeInfo.valueExpressionTitle):
a.push(b)},_findStatInfo:function(a,b){var c;t.some(a,function(a){a.statisticHash===b.statisticHash&&(c=a);return!!c});return c},_compareStatInfos:function(a,b){var c=t.filter(a,function(a){return!this._findStatInfo(b,a)},this),e=t.filter(b,function(b){return!this._findStatInfo(a,b)},this);return e.length||c.length?{added:e,removed:c}:null},_addSizeByCountVariable:function(a){var b=this._createSizeByCountVariable();b&&this._addVariable(a,b)},_getSizeByCountVariable:function(a){a=a.getVisualVariablesForType("sizeInfo",
!1)||[];return t.filter(a,function(a){return"cluster_count"===a.field})[0]},_updateSizeByCountVariable:function(){var a=this._renderer,b=this._getSizeByCountVariable(a);if(b){var c=this._createSizeByCountVariable();c&&this._replaceVariable(a,b,c)}},_createSizeByCountVariable:function(){var a=this._clusterGenerator,b;if(a){var c=a.getCurrentLodStats();if(c){b=a.getNumFeatures();var a=a.clusters,e=c.min,f=c.max;1===c.count&&e===b||1===a.length&&a[0].count===b?(e=1,f=b):e&&e===f&&(f=2*e);b={type:"sizeInfo",
field:"cluster_count",valueUnit:"unknown",minSize:12,maxSize:50,minDataValue:e,maxDataValue:f,legendOptions:{title:F}}}}return b},_addVariable:function(a,b){var c=a.visualVariables||[];c.push(b);a.setVisualVariables(c)},_replaceVariable:function(a,b,c){var e=a.visualVariables;b=t.indexOf(e,b);-1<b&&e.splice(b,1);e.push(c);a.setVisualVariables(e)},_getFields:function(a){var b=[new q({name:"cluster_count",type:"esriFieldTypeInteger"})];t.forEach(a,function(a){var c=a.statisticType;a=a.attributeInfo;
var e;"avg"===c?e="date"===a.attributeType?"esriFieldTypeDate":"esriFieldTypeDouble":"type"===c&&(e=a.field?this.layer.getField(a.field).type:"esriFieldTypeString");b.push(new q({name:z.getClusterField(a,c),type:e}))},this);return b},_createInfoTemplate:function(){var a=this._statisticInfos,c=this._renderer,e=[{fieldName:"cluster_count",label:F,visible:!0,format:{digitSeparator:!0,places:0}}],f=[],g=[k.substitute({count:"{cluster_count}"},B.countSummary)],m=this._isUVRenderer(c)?c.infos:[];t.forEach(a,
function(a){var b,c,k=a.statisticType,w=a.attributeInfo,q=z.getClusterField(w,k),A=this._getFieldLabel(a);"avg"===k?(b={fieldName:q,label:A,visible:!0,format:"date"===w.attributeType?{dateFormat:"shortDateShortTime"}:{digitSeparator:!0,places:1}},c=this._getFieldSummary(a,q)):"type"===k&&(c="expression/"+q,b={fieldName:c,visible:!0},f.push({name:q,title:A,returnType:"string",expression:this._getExpression(m,q)}),c=this._getFieldSummary(a,c));b&&e.push(b);c&&g.push(c)},this);return new b({fieldInfos:e,
expressionInfos:f,description:g.join("\x3cbr/\x3e\x3cbr/\x3e")})},_updateInfoTemplate:function(a){var c=a.toJson(),e=this._isUVRenderer(this._renderer)?this._renderer.infos:[];t.forEach(this._statisticInfos,function(a){var b=a.statisticType;a=z.getClusterField(a.attributeInfo,b);"type"===b&&(b=this._findExpressionInfo(a,c))&&(b.expression=this._getExpression(e,a))},this);return new b(c)},_findExpressionInfo:function(a,b){var c;t.some(b.expressionInfos,function(b){b.name===a&&(c=b);return!!c});return c},
_escapeDoubleQuotes:function(a){return a?a.replace(/"/g,'\\"'):""},_getExpression:function(a,b){return["var uvInfos \x3d ["+this._getObjects(a).join(", ")+"];",'var predominantType \x3d Text($feature["'+b+'"]);','var label \x3d "'+this._escapeDoubleQuotes(B.predominantNoneValue)+'";',"for (var i \x3d 0; i \x3c Count(uvInfos); i++) {\nif (uvInfos[i].value \x3d\x3d predominantType) {\nlabel \x3d uvInfos[i].label;\nbreak;\n}\n}\nreturn label;"].join("\n")},_getObjects:function(a){return t.map(a,function(a){return'{"value": "'+
String(a.value)+'","label": "'+this._escapeDoubleQuotes(String(a.label))+'"}'},this)},_getFieldLabel:function(a){var b=a.statisticType,c=a.attributeInfo,e=c.field;a=c.normalizationField;var f="",g;"avg"===b?g=a?B.avgNormFieldLabel:B.avgFieldLabel:"type"===b&&(g=B.predominantFieldLabel);g&&(b=c.valueExpression?c.valueExpressionTitle:this.layer.getFieldLabel(e),a=a&&this.layer.getFieldLabel(a),f=k.substitute({fieldLabel:b||"",normFieldLabel:a||""},g));return f},_getFieldSummary:function(a,b){var c=
a.statisticType,e=a.attributeInfo,f=e.field;a=e.normalizationField;var g="",m;"avg"===c?m=a?B.avgNormFieldSummary:B.avgFieldSummary:"type"===c&&(m=B.predominantFieldSummary);m&&(c=e.valueExpression?e.valueExpressionTitle:this.layer.getFieldLabel(f),a=a&&this.layer.getFieldLabel(a),g=k.substitute({fieldLabel:c||"",normFieldLabel:a||"",fieldValue:"{"+b+"}"},m));return g},_removeFromPopup:function(a){var b=this._map.infoWindow,c=b.features;if(c&&c.length){var e=t.filter(c,function(b){return b.getLayer()!==
a});e.length<c.length&&(e.length?b.setFeatures(e):(b.clearFeatures(),b.hide()))}},_resetClusterNav:function(){this._resetClusterNavPartial();this._popupClusterGraphic=null},_resetClusterNavPartial:function(){this._map.infoWindow.removeActions(this._popupActions);this._hideSingleGraphic(this._popupSingleGraphic);this._popupSingleGraphic=null},_addClusterBoundary:function(a,b){(b=b.clusterFillSymbol)&&(b=new b.constructor(b.toJson()));a=new u(a,b);this._map.graphics.add(a);this._clusterBoundary=a},
_removeClusterBoundary:function(){this._map.graphics.remove(this._clusterBoundary);this._clusterBoundary=null},_createBrowseFeaturesAction:function(){return this._map.infoWindow.addActions([{title:G.NLS_browseFeatures,className:"browseFeatures",callback:g.hitch(this,function(a){a.preventDefault();a=this._map.infoWindow;var b=a.getSelectedFeature(),c=b.getChildGraphics(),f=a.getCurrentAnchor();a.setFeatures(c,{anchor:f});if(c=e.graphicsExtent(c))this._addClusterBoundary(c,a),a.show(this._getPopupLocation(c,
f));this._popupClusterGraphic=b})}])[0]},_getPopupLocation:function(a,b){var c=a.getCenter();b=b.toLowerCase();-1<b.indexOf("top")?c.update(c.x,a.ymax):-1<b.indexOf("bottom")?c.update(c.x,a.ymin):-1<b.indexOf("left")?c.update(a.xmin,c.y):c.update(a.xmax,c.y);return c},_createViewSummaryAction:function(){return this._map.infoWindow.addActions([{title:G.NLS_viewSummary,className:"viewSummary",callback:g.hitch(this,function(a){a.preventDefault();a=this._popupClusterGraphic;var b=this._map.infoWindow;
b.setFeatures([a]);b.show(a.geometry);this._popupClusterGraphic=null})}])[0]},_initClusterUpdates:function(){this._updateSizeVariable();this._updateClusterGraphics();this._eventHandles.push(this._clusterGenerator.on("update-end",g.hitch(this,function(a){(a.mapLevelChange||a.indexChange)&&this._updateSizeVariable();this._updateClusterGraphics()})),this._clusterGenerator.on("index-complete",g.hitch(this,function(){this._updateSizeVariable()})))},_updateClusterGraphics:function(){this._hideSingleGraphics();
var a=[],b=[];t.forEach(this._clusterGenerator.clusters,function(c){var e=new u(c.centroid);e.setAggregationSourceLayer(this.layer);e.setAggregationInfo(c);this._applyClusterAttributes(e,c);1===c.count?(c=this._getSingleGraphic(e),b.push(c)):a.push(e)},this);this._showSingleGraphics(b);this._addGraphics(a)},_addGraphics:function(a){var b=this.container;b.clear();t.forEach(a,function(a){b.add(a)})},_getSingleGraphic:function(a){var b=this._clusterGenerator.getCell(a.getAggregationInfo().primary).features[0],
c=this.layer.renderer,c=c&&c.getSymbol(b),e=this._getSizeByCountVariable(this._renderer);c&&e&&(a=e?this._renderer.getSize(a,{sizeInfo:e,shape:c.style,resolution:this._map.getResolutionInMeters(),scale:this._map.getScale()}):null,b.setSize(a));return b},_showSingleGraphics:function(a){t.forEach(a,this._showSingleGraphic);this._singleGraphics=a},_hideSingleGraphics:function(){t.forEach(this._singleGraphics,function(a){a.setSize(null);this._hideSingleGraphic(a)},this);this._singleGraphics=null},_clearSingleGraphics:function(){t.forEach(this._singleGraphics,
function(a){a.setSize(null)});this._singleGraphics=null},_showSingleGraphic:function(a){a&&a._resume()},_hideSingleGraphic:function(a){a&&a._suspend()},_updateSizeVariable:function(){this.isClusteringEnabled()&&(this._updateSizeByCountVariable(),this.emit("renderer-change"))},_applyClusterAttributes:function(a,b){a.setAttributes(b.attributes)},_createLayerEventListeners:function(){var a=this.layer;this._eventHandles.push(a.on("visibility-change",g.hitch(this,function(a){this.container.setVisibility(a.visible)})),
a.on("scale-range-change",g.hitch(this,function(){this.container.setScaleRange(this.layer.minScale,this.layer.maxScale)})),a.on("renderer-change",g.hitch(this,function(){this._applyRenderer()})),a.on("info-template-change",g.hitch(this,function(){this._applyInfoTemplate()})))},_createMapEventListeners:function(){this._eventHandles.push(this._map.on("zoom-start",g.hitch(this,function(){this._removeClusterBoundary();this._removeFromPopup(this.container);this._removeFromPopup(this.layer);this._resetClusterNav();
this.container.clear();this._hideSingleGraphics()})))},_createPopupEventListeners:function(){var a=this._map.infoWindow;this._eventHandles.push(a.on("selection-change",g.hitch(this,function(){this._resetClusterNavPartial();var a=this._map.infoWindow.getSelectedFeature(),b=a&&a.getLayer();if(b){var c;b===this.container?(this._removeClusterBoundary(),c=this._createBrowseFeaturesAction()):b===this.layer&&a._isSuspended()?(c=this._createViewSummaryAction(),this._popupSingleGraphic=a,this._showSingleGraphic(this._popupSingleGraphic)):
this._removeClusterBoundary();this._popupActions=c?[c]:null}})),a.on("clear-features",g.hitch(this,function(a){this._resetClusterNav();a.isIntermediate||this._removeClusterBoundary()})),a.on("hide",g.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic._suspend();this._clusterBoundary&&this._clusterBoundary.hide()})),a.on("show",g.hitch(this,function(){this._popupSingleGraphic&&this._popupSingleGraphic._resume();this._clusterBoundary&&this._clusterBoundary.show()})))},_destroyEventListeners:function(){t.forEach(this._eventHandles,
function(a){a.remove()})}})})},"esri/dijit/Legend/utils":function(){define(["dojo/_base/lang","../../lang","dojo/i18n!../../nls/jsapi"],function(p,g,t){var v=t.widgets.legend;return{getVisualVariableTitle:function(n,m){var u,k=n.field,f=n.normalizationField,e=!1,b=!1,a=!1,k=p.isFunction(k)?null:k,f=p.isFunction(f)?null:f;if(n.legendOptions&&n.legendOptions.title)u=n.legendOptions.title;else if(n.valueExpressionTitle)u=n.valueExpressionTitle;else{if(m.renderer&&m.renderer.authoringInfo&&m.renderer.authoringInfo.visualVariables){var c=
m.renderer.authoringInfo.visualVariables;for(n=0;n<c.length;n++){var x=c[n];if("colorInfo"===x.type&&"ratio"===x.style){e=!0;break}else if("colorInfo"===x.type&&"percent"===x.style){b=!0;break}else if("colorInfo"===x.type&&"percentTotal"===x.style){a=!0;break}}}(e=a&&"showRatioPercentTotal"||b&&"showRatioPercent"||e&&"showRatio"||f&&"showNormField"||k&&"showField"||null)&&(u=g.substitute({field:k&&m.getFieldLabel(k),normField:f&&m.getFieldLabel(f)},"showField"===e?"${field}":v[e]))}return u},getRendererTitle:function(n,
m){var u;if(n){var k,f,e;"esri.renderer.ClassBreaksRenderer"===n.declaredClass&&(k=n.attributeField,f=n.normalizationField,e="percent-of-total"===n.normalizationType);k=p.isFunction(k)?null:k;f=p.isFunction(f)?null:f;n.legendOptions&&n.legendOptions.title?u=n.legendOptions.title:n.valueExpressionTitle?u=n.valueExpressionTitle:(n=f&&"showNormField"||(e?"showNormPct":null)||k&&"showField"||null)&&(u=g.substitute({field:k&&m.getFieldLabel(k),normField:f&&m.getFieldLabel(f)},"showField"===n?"${field}":
v[n]))}return u}}})},"esri/layers/clustering/GeohashAggregation":function(){define("dojo/has dojo/_base/declare dojo/_base/lang dojo/_base/array ../../kernel ../../Evented ../../geometry/Point ../../geometry/Extent ../../geometry/mathUtils ../../support/expressionUtils ../../core/timerUtils ../support/attributeUtils ./geohashUtils ./statUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return g(m,{loaded:!1,started:!1,map:null,layer:null,lod:null,tolerance:null,clusterMode:null,clusterRadius:null,
sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0,clusters:null,clustersEnabled:!0,statisticInfos:null,defaults:{lod:1,tolerance:0,clusterMode:"auto",clusterRadius:80,sortEnabled:!0,filterEnabled:!0,bufferEnabled:!0,updateEnabled:!0},_eventHandles:null,_updateHandle:null,_indexHandle:null,_cellIndex:null,_globalIndex:null,_perfProfile:null,_indexUpdated:!1,_cellSizeScaleFactor:1.5,_extentScaleFactor:1.25,_maxGeohashLength:12,_minClusterRadius:15,_levelChange:!0,_clusterFieldPrefix:"cluster_",
_mapLevelChange:!1,constructor:function(a){this._update=t.hitch(this,this._update);this._indexFeatures=t.hitch(this,this._indexFeatures);this._eventHandles=[];this._globalIndex={numFeatures:null,fullExtent:null,lodStats:null};this._perfProfile={lastIndex:{total:null,numFeatures:0},lastUpdate:{cells:null,clusters:null,total:null}};this.clusters=[];this.map=a.map;this.layer=a.layer;this.setLod(a.lod);this.setTolerance(a.tolerance);this.setClusterMode(a.clusterMode);this.setClusterRadius(a.clusterRadius);
this.setSortEnabled(a.sortEnabled);this.setFilterEnabled(a.filterEnabled);this.setBufferEnabled(a.bufferEnabled);this.setUpdateEnabled(a.updateEnabled);this.setStatisticInfos(a.statisticInfos);this._load();this.loaded?this._startup():this._eventHandles.push(this.on("load",t.hitch(this,this._startup)))},destroy:function(a){this._displayFeatures(!0,a);v.forEach(this._eventHandles,function(a){a.remove()});b.clearTimeout(this._updateHandle);b.clearTimeout(this._indexHandle);this._cellIndex=this._globalIndex=
this._eventHandles=this._updateHandle=this._indexHandle=this.map=this.layer=this.clusters=null},setLod:function(a){var b=this.lod;this.lod=a||this.defaults.lod;b!==this.lod&&this.update()},setTolerance:function(a){var b=this.tolerance;this.tolerance=a||this.defaults.tolerance;b!==this.tolerance&&this.update()},setClusterMode:function(a){var b=this.clusterMode;this.clusterMode=a||this.defaults.clusterMode;this._evalClusterParams();b!==this.clusterMode&&this.update()},setClusterRadius:function(a){var b=
this.clusterRadius;this.clusterRadius=null!=a?a:this.defaults.clusterRadius;this._evalClusterParams();b!==this.clusterRadius&&this.update()},setSortEnabled:function(a){var b=this.sortEnabled;this.sortEnabled=null!=a?!!a:this.defaults.sortEnabled;b!==this.sortEnabled&&this.update()},setFilterEnabled:function(a){var b=this.filterEnabled;this.filterEnabled=null!=a?!!a:this.defaults.filterEnabled;b!==this.filterEnabled&&this.update()},setBufferEnabled:function(a){var b=this.bufferEnabled;this.bufferEnabled=
null!=a?!!a:this.defaults.bufferEnabled;b!==this.bufferEnabled&&this.update()},setUpdateEnabled:function(a){var b=this.updateEnabled;(this.updateEnabled=null!=a?!!a:this.defaults.updateEnabled)&&b!==this.updateEnabled&&(this._mapLevelChange=!0,this.update())},setStatisticInfos:function(a){this.statisticInfos=a||[];this.loaded&&this._applyStatInfos(this.statisticInfos)},update:function(){this.loaded&&null==this._updateHandle&&(this._updateHandle=b.setTimeout(this._update,b.priority.HIGH))},isUpdateScheduled:function(){return null!=
this._updateHandle},index:function(){this.loaded&&null==this._indexHandle&&(this._indexHandle=b.setTimeout(this._indexFeatures,b.priority.HIGH))},getCell:function(a){return this._cellIndex[a.length][a]},getCluster:function(a){var b;v.some(this.clusters,function(c){-1<v.indexOf(c.geohashes,a)&&(b=c);return!!b});return b},getCellsInCluster:function(a){var b=[];v.forEach(a&&a.geohashes,function(a){(a=this.getCell(a))&&b.push(a)},this);return b},getFeaturesInCluster:function(a){var b=[];a=this.getCellsInCluster(a);
v.forEach(a,function(a){Array.prototype.push.apply(b,a.features)});return b},toggleFeatureVisibility:function(a){this.index()},getCurrentLodStats:function(){var a=this._globalIndex.lodStats;return a&&a[this.lod]},getNumFeatures:function(){return this._globalIndex.numFeatures},getFullExtent:function(){var a=this._globalIndex.fullExtent;return a&&Infinity!==a.xmin?new k(a):null},_load:function(){this._displayFeatures(!1);this._checkLoadStatus();this.map.loaded||this._eventHandles.push(this.map.on("load",
t.hitch(this,this._checkLoadStatus)));this.layer.loaded||this._eventHandles.push(this.layer.on("load",t.hitch(this,this._checkLoadStatus)))},_checkLoadStatus:function(){if(this.map.loaded&&this.layer.loaded){var a;if("esriGeometryPoint"!==this.layer.geometryType)a=Error("GeohashAggregation is supported only for points");else{var b=this.map.spatialReference;b.isWebMercator()||4326===b.wkid||(a=Error("GeohashAggregation is supported only when map spatial reference is WGS84 or WebMercator"))}a?(this.loadError=
a,this.emit("load-error",{error:a})):(this.loaded=!0,this.emit("load"))}},_startup:function(){this._evalUpdateStatus();this.index();this._processExtentChange();this._eventHandles.push(this.layer.on("update-end",t.hitch(this,this.index)),this.layer.on("edits-complete",t.hitch(this,this.index)),this.layer.on("graphics-clear",t.hitch(this,this.index)),this.layer.on("suspend",t.hitch(this,this._evalUpdateStatus)),this.layer.on("resume",t.hitch(this,this._evalUpdateStatus)),this.map.on("extent-change",
t.hitch(this,this._processExtentChange)))},_evalUpdateStatus:function(){this.setUpdateEnabled(!this.layer.suspended)},_processExtentChange:function(a){this._mapLevelChange=!(!a||!a.levelChange);this._evalClusterParams();this.update()},_update:function(){this._updateHandle=null;if(this.updateEnabled){this.emit("update-start");if(this.clustersEnabled){var a=this.map.geographicExtent;if(a){var b=this._getIntersectingCells(a),a=this._getClusters(b.cells,a);this.clusters=a.clusters;this._applyStatInfosToClusters();
var b=b.profile,a=a.profile,c=b.total+a.total;b.total=this._getElapsedTime(b.total);a.total=this._getElapsedTime(a.total);var e=this._perfProfile.lastUpdate={};e.cells=b;e.clusters=a;e.total=this._getElapsedTime(c)}}else this.clusters=[],this._perfProfile.lastUpdate=null;b=this._indexUpdated;this._indexUpdated=!1;a=this._mapLevelChange;this._mapLevelChange=!1;this.emit("update-end",{levelChange:this._levelChange,mapLevelChange:a,indexChange:b})}},_displayFeatures:function(a,b){var c=this.layer;a=
!a;c.suspendGraphics(a);!1!==b&&(a?c.clearNodes():c.redraw())},_indexFeatures:function(){this._indexHandle=null;var a=this._getTime();this._initializeIndexing();var b=0,e=this._globalIndex.fullExtent;v.forEach(this.layer.graphics,function(a){if(a.visible){var f=a.geometry,g=this._getLngLat(f),k;g&&(k=f.getCacheValue("_geohash"),void 0===k&&(k=c.pointToGeohash(g),f.setCacheValue("_geohash",k||null)));k&&(this._addGeohashToIndex(k,a,g),b++,this._updateExtent(e,g))}},this);this._applyStatInfosToIndex();
this._globalIndex.numFeatures=b;for(var f=this._globalIndex.lodStats,g=1;g<=this._maxGeohashLength;g++)f[g]=this._getLODStats(g,b);this._perfProfile.lastIndex.total=this._getElapsedTime(a,this._getTime());this._perfProfile.lastIndex.numFeatures=b;this._indexUpdated=!0;this.emit("index-complete");this.started||(this.started=!0,this.emit("start"));this.update()},_initializeIndexing:function(){this._globalIndex={numFeatures:0,fullExtent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},lodStats:{}};
for(var a=this._cellIndex=[],b=1;b<=this._maxGeohashLength;b++)a[b]={}},_getLngLat:function(a){if(a){var b=a.getLongitude();a=a.getLatitude();a=null!=b&&null!=a?{x:b,y:a}:null}return a},_addGeohashToIndex:function(a,b,c){for(var e=this._cellIndex,f="",g=0;g<this._maxGeohashLength;g++){var f=f+a[g],k=e[f.length],m=k[f];m||(m=k[f]={count:0,centroid:{x:null,y:null},extent:{xmin:Infinity,ymin:Infinity,xmax:-Infinity,ymax:-Infinity},features:[],geohash:f,statistics:null});this._updateItem(m,1,c,!0);m.features.push(b)}},
_getLODStats:function(a,b){var c=this._cellIndex[a],e=0,f=Infinity,g=-Infinity,k=null,m;for(m in c){var q=c[m];e++;q.count<f&&(f=q.count);q.count>g&&(g=q.count)}0<e&&(k=Number((b/e).toFixed(2)));return{lod:a,count:e,min:Infinity===f?null:f,max:-Infinity===g?null:g,avg:k}},_evalClusterParams:function(){if(this.loaded&&"auto"===this.clusterMode){var a=this._getClusterParams(this.map.getResolutionInMeters(),this.clusterRadius,this._minClusterRadius);this._levelChange=this.lod!==a.lod;this.lod=a.lod;
this.tolerance=a.tolerance}},_getClusterParams:function(a,b,c){b<c&&(b=c);a=Math.ceil(a*b);b=this._getClosestLODRange(a).max;do c=this._getCellSize(b),(c=a>=this._cellSizeScaleFactor*c||1===c)||(b+=1);while(!c);c=a/this._getCellSize(b);return{lod:b,tolerance:a,multiplier:Number(c.toFixed(2))}},_getClosestLODRange:function(a){for(var b,c=this._maxGeohashLength;1<=c;c--)if(this._getCellSize(c)>=a){b=c;break}null==b&&(b=1);a=b+1;a>this._maxGeohashLength&&(a=this._maxGeohashLength);return{min:b,max:a}},
_getCellSize:function(a){a=c.getCellSizeInMeters(a);return Math.ceil(Math.min(a.width,a.height))},_sorter:function(a,b){var c=a.centroid,e=b.centroid;return a.count>b.count?-1:a.count<b.count?1:c.x>e.x?-1:c.x<e.x?1:0},_getIntersectingCells:function(a){var b=this._getTime();a=a.expand(this._extentScaleFactor);var e=c.getIntersecting(a,this.lod,this.bufferEnabled?this.tolerance:0);a=this._getTime();var f=[],g=this.tolerance,k=this.sortEnabled;v.forEach(e,function(a){(a=this.getCell(a))&&f.push(a)},
this);g&&k&&f.sort(this._sorter);e=this._getTime();return{cells:f,profile:{findCells:this._getElapsedTime(b,a),scanAndSortCells:this._getElapsedTime(a,e),total:e-b}}},_getClusters:function(a,b){var c=this._getTime(),e=[],f={},g={findCells:0};v.forEach(a,function(a,b){(a=this._createCluster(a,f,g))&&e.push(a)},this);this._markIntersecting(e,b);this.filterEnabled&&(e=this._getIntersectingClusters(e));a=this._getTime();return{clusters:e,profile:{findCellsInCluster:this._getElapsedTime(g.findCells),total:a-
c}}},_markIntersecting:function(a,b){var c=b.normalize();v.forEach(a,function(a){var b=a.centroid.x,e=a.centroid.y;a.isIntersecting=v.some(c,function(a){return b>=a.xmin&&b<=a.xmax&&e>=a.ymin&&e<=a.ymax})})},_getIntersectingClusters:function(a){return v.filter(a,function(a){return a.isIntersecting})},_createCluster:function(a,b,e){if(!b[a.geohash]){var f=[{cell:a,distance:0}];if(this.tolerance){var g=this._getTime(),k=c.getNeighborsWithinDistance(a.centroid,this.lod,this.tolerance);e.findCells+=this._getTime()-
g;v.forEach(k,function(b){if(b!==a.geohash&&(b=this.getCell(b))){var c=this._calculateDistance(a.centroid,b.centroid);c<=this.tolerance&&f.push({cell:b,distance:c})}},this)}return this._mergeCells(f,b)}},_calculateDistance:function(a,b){return f.getLength(c.geographicToWebMercator(a),c.geographicToWebMercator(b))},_mergeCells:function(a,b){var c=this._initializeCluster({},a[0].cell.geohash);v.forEach(a,function(a){var e=a.cell,f=e.geohash;a=a.distance;var g=b[f];if(g)if(a<g.distance)this._removeCellFromCluster(f,
b);else return;b[f]={cluster:c,distance:a};this._updateItem(c,e.count,e.centroid);c.geohashes.push(f)},this);return c},_removeCellFromCluster:function(a,b){var c=b[a].cluster;delete b[a];a=v.indexOf(c.geohashes,a);-1<a&&c.geohashes.splice(a,1);this._reevaluateCluster(c)},_reevaluateCluster:function(a){var b=a.geohashes;a=this._initializeCluster(a,a.primary);v.forEach(b,function(b){var c=this.getCell(b);c&&(this._updateItem(a,c.count,c.centroid),a.geohashes.push(b))},this)},_initializeCluster:function(a,
b){a.count=0;a.centroid=new u(null,null);a.geohashes=[];a.primary=b;a.statistics=null;return a},_applyStatInfos:function(a){a=this._getValidStatInfos(a);this._applyStatInfosToIndex(a);this._applyStatInfosToClusters(a)},_getValidStatInfos:function(b){var c=[];v.forEach(b,function(b){var e=b.attributeInfo;b=b.statisticType;var f="angle"===e.attributeType;if(x.isSupportedStatisticType(b)&&(!f||"avg"===b)){var g="arithmetic"===e.rotationType;c.push({attributeCache:a.createAttributeCache(e,"type"===b),
identifier:x.getStatisticId(e,b),statFunctions:x.getStatisticFunctions(b),isAngular:f,isDate:"date"===e.attributeType,isArithmetic:g})}});return c},_applyStatInfosToIndex:function(a){a=a||this._getValidStatInfos(this.statisticInfos);var b=this._cellIndex;if(b)for(var c=1;c<=this._maxGeohashLength;c++){var e=b[c],f;for(f in e)this._applyStatInfosToCell(e[f],a)}},_applyStatInfosToCell:function(a,b){var c=this._initializeStats(a,b);v.forEach(a.features,function(a){this._calcFeatureStats(a,b,c)},this);
this._summarizeStats(a,c,b)},_calcFeatureStats:function(a,b,c){a.attributes&&v.forEach(b,function(b){var f=c[b.identifier],g=b.attributeCache,g=g?a._getDataValue(g.attributeInfo,g,e):null;b.statFunctions.updateCellStat(f,g,b)})},_applyStatInfosToClusters:function(a){a=a||this._getValidStatInfos(this.statisticInfos);var b=this._clusterFieldPrefix;v.forEach(this.clusters,function(c){var e=this._initializeStats(c,a);v.forEach(this.getCellsInCluster(c),function(b){this._calcCellStats(b,a,e)},this);this._summarizeStats(c,
e,a,b);c.attributes[b+"id"]=c.primary},this)},_calcCellStats:function(a,b,c){var e=a.statistics;v.forEach(b,function(a){var b=a.identifier;a.statFunctions.updateClusterStat(c[b],e[b],a)})},_initializeStats:function(a,b){var c=a.statistics={};v.forEach(b,function(a){c[a.identifier]=a.statFunctions.initialize(a)});return c},_summarizeStats:function(a,b,c,e){var f=a.attributes={};e=e||"";f[e+"count"]=a.count;v.forEach(c,function(a){var c=this._getStatFieldName(a,e);f[c]=a.statFunctions.summarize(b[a.identifier],
a)},this)},_getStatFieldName:function(a,b){return(b||"")+a.identifier},_updateItem:function(a,b,c,e){var f=c.y,g=a.centroid,k=a.count;g.x=(k*g.x+b*c.x)/(k+b);g.y=(k*g.y+b*f)/(k+b);a.count+=b;e&&this._updateExtent(a.extent,c)},_updateExtent:function(a,b){var c=b.x;b=b.y;c<a.xmin&&(a.xmin=c);c>a.xmax&&(a.xmax=c);b<a.ymin&&(a.ymin=b);b>a.ymax&&(a.ymax=b)},_getTime:function(){return window.performance?window.performance.now():(new Date).getTime()},_getElapsedTime:function(a,b){var c;a=null!=a&&null!=
b?b-a:a;null!=a&&(c="millisecond",1E3<=a&&(a/=1E3,c="second",60<=a&&(a/=60,c="minute")),c={value:Number(a.toFixed(2)),unit:c});return c}})})},"esri/core/timerUtils":function(){define([],function(){function p(g){var m,k=g.length;for(m=0;m<k;m++)g[m]()}var g={LOW:1,HIGH:2},t,v={};v[g.LOW]=[];v[g.HIGH]=[];var n=function(){clearTimeout(t);t=null;var m=v[g.HIGH];v[g.HIGH]=[];p(m);m=v[g.LOW];v[g.LOW]=[];p(m)};return{priority:g,callbackQueue:v,setTimeout:function(g,p){g=[p,v[p].push(g)-1];t||(t=setTimeout(n,
0));return g},clearTimeout:function(g){g&&v[g[0]].splice(g[1],1)}}})},"esri/layers/clustering/geohashUtils":function(){define("dojo/has dojo/string dojo/_base/lang dojo/_base/array ../../kernel ../../geometry/Point ../../geometry/Extent ../../SpatialReference ../../geometry/webMercatorUtils".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a){var b=a.spatialReference;if(!b)return{x:a.x,y:a.y};var c=b.isWebMercator(),e;4326===b.wkid?e={x:a.x,y:a.y}:c&&(e={x:a.getLongitude(),y:a.getLatitude()});return e}
function b(a){var b=a.spatialReference,c=!(!b||!b.isWebMercator()),e;b&&4326===b.wkid?e=new u(a.toJson()):c&&(e=f.webMercatorToGeographic(a,!0));return e}function a(a,b){b.x=m.prototype._normalizeX(a.x,k.prototype._info[4326]);b.y=a.y;return b}function c(a){a=M.decimals[a].toString(2);return g.pad(a,M.bitsPerBase32Char,"0")}function x(a,b){var c;b=b.slice();b.splice(1,0,0);for(var e=b[0],f=b[2],g=0;g<a.length;g++)Number(a[g])?b[0]=b[1]:b[2]=b[1],c=b[1]=(b[0]+b[2])/2,e=b[0],f=b[2];return{value:c,min:e,
max:f}}function w(a,b,c){var e=[];b=b.slice();b.splice(1,0,0);for(var f=b[0],g=b[2],k=0;k<c;k++)a>=b[1]?(b[0]=b[1],f=1):(b[2]=b[1],f=0),b[1]=(b[0]+b[2])/2,e.push(f),f=b[0],g=b[2];return{value:e.join(""),min:f,max:g}}function q(a){var b=a*M.bitsPerBase32Char;0===b%2?a=b/=2:(a=(b+1)/2,b-=a);return{lon:a,lat:b}}function C(a){var b=0;a=a.split("").reverse().join("");for(var c=0;c<a.length;c++)b+=Number(a[c])*Math.pow(2,c);return M.base32[b]}function z(a,b){var c={x:a.xmin,y:a.ymax},e={x:a.xmax,y:a.ymin},
f={x:a.xmax,y:a.ymax};return{sw:Q.pointToGeohash({x:a.xmin,y:a.ymin},b),nw:Q.pointToGeohash(c,b),se:Q.pointToGeohash(e,b),ne:Q.pointToGeohash(f,b)}}function E(a,b,c,e,f){var g=a;do f[g]||(f[g]=!0,e.push(g)),(a=g===b)||(g=L(g,c));while(!a)}function B(a,b,c,e){var f=z(a,b);a=[];E(f.sw,f.nw,"n",a,{});b=[];E(f.se,f.ne,"n",b,{});for(f=0;f<a.length;f++)E(a[f],b[f],"e",c,e)}function G(a){return v.filter(a,function(a){return 180===a.xmax?!0:!1})[0]}function F(a){return v.filter(a,function(a){return-180===
a.xmin?!0:!1})[0]}function D(a,b,c,e){var f=Q.geographicToWebMercator(a);a={x:f.x-b,y:f.y-b};b=Q.webMercatorToGeographic({x:f.x+b,y:f.y+b},!0);a=Q.webMercatorToGeographic(a,!0);return new u(null!=c?c:a.x,a.y,null!=e?e:b.x,b.y)}function I(a,b,c,e){var f;a=z(a,b);var g,k;"min"===e?k=180:"max"===e&&(g=-180);var m=g;e=k;f=Q.geohashToCell(a.sw).extent;b=Q.geohashToCell(a.ne).extent;a=null!=m?m:f.xmin;f=f.ymin;e=null!=e?e:b.xmax;b=b.ymax;a=D({x:a,y:f},c,g,k);c=D({x:e,y:b},c,g,k);return new u(a.xmin,a.ymin,
c.xmax,c.ymax)}function K(a,b,c){var e=a,f=0;do f++,(a=e===b)||(e=L(e,c));while(!a);return f}function J(a,b){a=z(a,b);b=K(a.nw,a.ne,"e");return{rows:K(a.nw,a.sw,"s"),cols:b}}function L(a,b){var c=a.length%2,e=a.slice(-1),f=M.decimals[e];a=a.slice(0,-1);-1!=M.borders[b][c].indexOf(e)&&a&&(a=L(a,b));return a+M.neighbors[b][c][f]}var M={base32:"0123456789bcdefghjkmnpqrstuvwxyz",decimals:function(){for(var a={},b=0;32>b;b++)a["0123456789bcdefghjkmnpqrstuvwxyz"[b]]=b;return a}(),neighbors:{n:[null,"238967debc01fg45kmstqrwxuvhjyznp"],
s:[null,"bc01fg45238967deuvhjyznpkmstqrwx"],e:[null,"14365h7k9dcfesgujnmqp0r2twvyx8zb"],w:[null,"p0r21436x8zb9dcf5h7kjnmqesgutwvy"]},borders:{n:[null,"bcfguvyz"],s:[null,"0145hjnp"],e:[null,"prxz"],w:[null,"028b"]},bitsPerBase32Char:5,maxGeohashLength:12,longitudeRange:[-180,180],latitudeRange:[-90,90]};M.neighbors.n[0]="14365h7k9dcfesgujnmqp0r2twvyx8zb";M.neighbors.s[0]="p0r21436x8zb9dcf5h7kjnmqesgutwvy";M.neighbors.e[0]="238967debc01fg45kmstqrwxuvhjyznp";M.neighbors.w[0]="bc01fg45238967deuvhjyznpkmstqrwx";
M.borders.n[0]="prxz";M.borders.s[0]="028b";M.borders.e[0]="bcfguvyz";M.borders.w[0]="0145hjnp";var Q={geographicToWebMercator:function(a){a=m.lngLatToXY(a.x,a.y);return{x:a[0],y:a[1]}},webMercatorToGeographic:function(a,b){a=m.xyToLngLat(a.x,a.y,b);return{x:a[0],y:a[1]}},geohashToCell:function(a){for(var b=[],e=0;e<a.length;e++)b.push(c(a[e]));for(var b=b.join(""),e=[],f=[],g=0;g<b.length;g++)0===g%2?e.push(b[g]):f.push(b[g]);e=e.join("");f=f.join("");e=[e,f];b=x(e[0],M.longitudeRange);e=x(e[1],
M.latitudeRange);return{point:{x:b.value,y:e.value},extent:{xmin:b.min,xmax:b.max,ymin:e.min,ymax:e.max},geohash:a}},pointToCell:function(b,c){var f,g;c=c||M.maxGeohashLength;if(b=e(b)){b=a(b,b);f=q(c);c=w(b.x,M.longitudeRange,f.lon);var k=w(b.y,M.latitudeRange,f.lat);f=c.value;g=k.value;c={xmin:c.min,xmax:c.max,ymin:k.min,ymax:k.max};for(var k=[],m=Math.ceil((f.length+g.length)/M.bitsPerBase32Char),A=0,n=0,x=0;x<m*M.bitsPerBase32Char;x++){var l=0===x%2?f[A++]:g[n++];null==l&&(l=0);k.push(l)}f=k.join("");
g=M.bitsPerBase32Char;k=f.length/g;m=[];for(A=0;A<k;A++)n=f.substr(A*g,g),m.push(C(n));f=m.join("");return{point:b,extent:c,geohash:f}}},geohashToPoint:function(a){return Q.geohashToCell(a).point},pointToGeohash:function(a,b){return(a=Q.pointToCell(a,b))&&a.geohash},getCells:function(a){return v.map(a,function(a){return Q.geohashToCell(a)})},getCellSize:function(a){var b=M.longitudeRange,c=M.latitudeRange,b=Math.abs(b[1]-b[0]),c=Math.abs(c[1]-c[0]);a=q(a||1);return{width:b/Math.pow(2,a.lon),height:c/
Math.pow(2,a.lat)}},getCellSizeInMeters:function(a){a=Q.getCellSize(a);var b=f.metersPerDegree;a.width*=b;a.height*=b;return a},getIntersecting:function(a,c,e){c=c||1;e=e||0;var f=[],g=b(a);if(g){e&&(g=Q.expandExtent(a,c,e));a=g.normalize();var k={};v.forEach(a,function(a){B(a,c,f,k)})}return f},countIntersecting:function(c,e,f){e=e||1;f=f||0;var g=0,k=b(c);if(k){f&&(k=Q.expandExtent(c,e,f));c=k.normalize();if(2===c.length){g=G(c);k=F(c);f=J(g,e);var m=J(k,e);c=f.rows;f=f.cols+m.cols;g={x:g.xmin,
y:g.ymax};k={x:k.xmax,y:k.ymax};g=a(g,{});k=a(k,{});g=Q.pointToGeohash(g,e);e=Q.pointToGeohash(k,e);g===e&&f--;e={rows:c,cols:f}}else e=J(c[0],e);g=e.cols*e.rows}return g},getChildren:function(a){a=a||"";var b=[],c;for(c in M.decimals)b.push(a+c);return b},getNeighbors:function(a){var b=L(a,"n"),c=L(a,"s");return[b,L(b,"e"),L(b,"w"),c,L(c,"e"),L(c,"w"),L(a,"e"),L(a,"w")]},getExtentFromDistance:function(a,b){b=b||1E3;var c;(a=e(a))&&(c=D(a,b));return c},expandExtent:function(a,c,e){c=c||1;e=e||0;if(a=
b(a)){if(e){a=a.normalize();if(2===a.length){var f=e;e=G(a);a=F(a);e=I(e,c,f,"min");a=I(a,c,f,"max");360<=e.getWidth()+a.getWidth()?(c=-180,a=180):(c=e.xmin,a=a.xmax);return new u(c,e.ymin,a,e.ymax)}return I(a[0],c,e)}return a}},getNeighborsWithinDistance:function(a,b,c){c=c||1E3;b=b||1;var f=[];if(a=e(a)){c=D(a,c).normalize();var g={};v.forEach(c,function(a){B(a,b,f,g)})}return f}};return Q})},"esri/layers/clustering/statUtils":function(){define(["dojo/_base/lang","../support/attributeUtils"],function(p,
g){function t(g){return"number"===typeof g&&!isNaN(g)&&Infinity!==g&&-Infinity!==g}var v={sum:{initialize:function(){return{count:0,sum:null}},updateCellStat:function(g,n){t(n)&&(g.count++,g.sum+=n)},updateClusterStat:function(g,n){n.count&&(g.count+=n.count,g.sum+=n.sum)},summarize:function(g){return g.sum}},avg:{initialize:function(g){return{count:0,sum:null,avg:null,sum_cosine:null,sum_sine:null}},updateCellStat:function(g,n,k){t(n)&&(g.count++,k.isAngular?(k.isArithmetic||(n=-1*n+90),g.sum_cosine+=
Math.cos(n*Math.PI/180),g.sum_sine+=Math.sin(n*Math.PI/180)):g.sum+=n)},updateClusterStat:function(g,n,k){n.count&&(g.count+=n.count,k.isAngular?(g.sum_cosine+=n.sum_cosine,g.sum_sine+=n.sum_sine):g.sum+=n.sum)},summarize:function(g,n){if(0<g.count){var k=g.count;n.isAngular?(k=180*Math.atan2(g.sum_sine/k,g.sum_cosine/k)/Math.PI,n.isArithmetic||(k=-1*(k-90)),g.avg=0>k?k+360:k):(g.avg=g.sum/k,n.isDate&&(g.avg=Math.ceil(g.avg)))}return g.avg}},type:{initialize:function(){return{uvInfos:{}}},updateCellStat:function(g,
n){if(null==n||""===n||"string"===typeof n&&""===p.trim(n))n=null;g=g.uvInfos;null==g[n]?g[n]={count:1,value:n}:g[n].count++},updateClusterStat:function(g,n){g=g.uvInfos;n=n.uvInfos;for(var k in n){var f=n[k];null==g[k]?g[k]={count:f.count,value:f.value}:g[k].count+=f.count}},summarize:function(g){g=g.uvInfos;var m,k=-Infinity,f;for(m in g){var e=g[m];e.count>k?(k=e.count,f=e.value):e.count===k&&(f=null)}return f}}},n={isSupportedStatisticType:function(g){return v.hasOwnProperty(g)},getStatisticFunctions:function(g){return v[g]},
getStatisticId:function(m,n){var k=g.getAttributeIdSource(m);m=k&&g.getAttributeId(k)||m.field;return n+"_"+m},getClusterField:function(g,p){return"cluster_"+n.getStatisticId(g,p)},getStatisticHash:function(g,p){p=[n.getStatisticId(g,p)];g.attributeType&&p.push(g.attributeType.toLowerCase());g.rotationType&&p.push(g.rotationType.toLowerCase());return p.join("_")}};return n})},"esri/geometry/geometryEngine":function(){define("require exports esri/kernel esri/geometry/Geometry esri/geometry/Polygon esri/geometry/Polyline esri/geometry/Point esri/geometry/Extent esri/geometry/Multipoint dojo/_base/lang".split(" "),
function(p,g,t,v,n,m,u,k,f,e){function b(a){if(void 0===u.fromJson){if(void 0!==a.x&&void 0!==a.y)return new u(a);if(void 0!==a.paths)return new m(a);if(void 0!==a.rings)return new n(a);if(void 0!==a.points)return new f(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new k(a)}else{if(void 0!==a.x&&void 0!==a.y)return u.fromJson(a);if(void 0!==a.paths)return m.fromJson(a);if(void 0!==a.rings)return n.fromJson(a);if(void 0!==a.points)return f.fromJson(a);if(void 0!==
a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return k.fromJson(a)}}function a(a){if(void 0===u.fromJson){if(void 0!==a.x&&void 0!==a.y)return new u(a);if(void 0!==a.paths)return new m(a);if(void 0!==a.rings)return new n(a);if(void 0!==a.points)return new f(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return new k(a)}else{if(void 0!==a.x&&void 0!==a.y)return u.fromJSON(a);if(void 0!==a.paths)return m.fromJSON(a);if(void 0!==a.rings)return n.fromJSON(a);if(void 0!==
a.points)return f.fromJSON(a);if(void 0!==a.xmin&&void 0!==a.ymin&&void 0!==a.xmax&&void 0!==a.ymax)return k.fromJSON(a)}}function c(a,b){var c;if(null==a||void 0===a||"number"===typeof a)return a;var l=a.toString();if(""===l)return null;if(2==b){if(c=O[l],void 0!==c)return c}else if(0==b){c=T[l];if(void 0!==c)return c;c=W[a];if(void 0!==c)return c}else if(3==b&&(c=T[l],void 0!==c))return c;if(1==b&&(c=W[a],void 0!==c))return c;if(!0===/^\d+$/.test(l))return parseInt(l);throw Error("Unrecognised Unit Type");
}function x(a){if(void 0!==a&&null!==a)switch(a){case "loxodrome":return 1;case "great-elliptic":return 2;case "normal-section":return 3;case "shape-preserving":return 4}return 0}function w(a,b){if(null===a||void 0===a||a.u())return null;switch(a.G()){case D.Fj.Point:var c=new u(a.Be(),a.nf(),b);if(Q){var l=a.hasAttribute(D.Wc.M);a.hasAttribute(D.Wc.Z)&&c.set("z",a.rH());l&&c.set("m",a.aH())}return c;case D.Fj.Polygon:var c=a.hasAttribute(D.Wc.Z),l=a.hasAttribute(D.Wc.M),d=q(a,c,l),c=new n({rings:d,
hasZ:c,hasM:l});Q?c.set("spatialReference",b):c.setSpatialReference(b);c.setCacheValue("_geVersion",a);return c;case D.Fj.Polyline:return c=a.hasAttribute(D.Wc.Z),l=a.hasAttribute(D.Wc.M),d=q(a,c,l),c=new m({paths:d,hasZ:c,hasM:l}),Q?c.set("spatialReference",b):c.setSpatialReference(b),c.setCacheValue("_geVersion",a),c;case D.Fj.MultiPoint:var c=a.hasAttribute(D.Wc.Z),l=a.hasAttribute(D.Wc.M),h=d=null;c&&(d=a.Pa(D.Wc.Z));l&&(h=a.Pa(D.Wc.M));var r=new D.b,e=a.D();b=new f(b);Q&&(b.set("hasZ",c),b.set("hasM",
l));for(var g=0;g<e;g++){a.w(g,r);var A=[r.x,r.y];c&&A.push(d.get(g));l&&A.push(h.get(g));b.addPoint(A)}b.setCacheValue("_geVersion",a);return b;case D.Fj.Envelope:return d=a.hasAttribute(D.Wc.Z),c=a.hasAttribute(D.Wc.M),l=new k(a.R.o,a.R.A,a.R.v,a.R.B,b),Q&&(d&&(d=a.xf(D.Wc.Z,0),l.set("zmin",d.ca),l.set("zmax",d.ha)),c&&(d=a.xf(D.Wc.M,0),l.set("mmin",d.ca),l.set("mmax",d.ha))),l.setCacheValue("_geVersion",a),l}return null}function q(a,b,c){var l=[],d=a.aa(),h=null,r=null;b&&(h=a.Pa(D.Wc.Z));c&&(r=
a.Pa(D.Wc.M));for(var e=new D.b,f=0;f<d;f++){for(var g=a.wa(f),k=a.La(f),A=0,m=0,q=NaN,n=NaN,w=NaN,x=NaN,p=a.Qb(f),u=[],B=g;B<g+k;B++){a.w(B,e);var x=w=NaN,z=[e.x,e.y];b&&(w=h.get(B),z.push(w));c&&(x=r.get(B),z.push(x));B==g&&p&&(A=e.x,m=e.y,q=w,n=x);u.push(z)}!p||A==e.x&&m==e.y&&(!b||isNaN(q)&&isNaN(w)||q==w)&&(!c||isNaN(n)&&isNaN(x)||n==x)||u.push(u[0].slice(0));l.push(u)}return l}function C(a){var b=a._geVersion;if(null==b||void 0==b){if(Object.freeze&&Object.isFrozen(a))return 102100===a.wkid?
V:4326===a.wkid?U:b=D.Sd.create(a.wkid);-1!=a.wkid&&null!==a.wkid&&void 0!==a.wkid?(b=D.Sd.create(a.wkid),a._geVersion=b):""!==a.wkt&&void 0!==a.wkt&&null!==a.wkt&&(b=D.Sd.oR(a.wkt),a._geVersion=b)}return b}function z(a){if(null==a)return null;if(void 0===a.getCacheValue){var b=a._geVersion;if(null==b||void 0==b)b=D.cc.cG(a),a._geVersion=b}else if(b=a.getCacheValue("_geVersion"),null==b||void 0==b)b=D.cc.cG(a),a.setCacheValue("_geVersion",b);return b}function E(a){return null===a.spatialReference?
null:C(a.spatialReference)}function B(a){return"[object Array]"===Object.prototype.toString.call(a)}function G(a){if(null===a||void 0===a||a.u())return null;switch(a.G()){case D.Fj.Point:var b={};b.x=a.Be();b.y=a.nf();if(Q){var c=a.hasAttribute(D.Wc.M);a.hasAttribute(D.Wc.Z)&&(b.z=a.rH());c&&(b.m=a.aH())}return b;case D.Fj.Polygon:return b=a.hasAttribute(D.Wc.Z),c=a.hasAttribute(D.Wc.M),{rings:q(a,b,c),hasZ:b,hasM:c};case D.Fj.Polyline:return b=a.hasAttribute(D.Wc.Z),c=a.hasAttribute(D.Wc.M),{paths:q(a,
b,c),hasZ:b,hasM:c};case D.Fj.MultiPoint:var b=a.hasAttribute(D.Wc.Z),c=a.hasAttribute(D.Wc.M),l=null,d=null;b&&(l=a.Pa(D.Wc.Z));c&&(d=a.Pa(D.Wc.M));var h=new D.b,r=a.D(),e={points:[]};Q&&(e.hasZ=b,e.hasM=c);for(var f=0;f<r;f++){a.w(f,h);var g=[h.x,h.y];b&&g.push(l.get(f));c&&g.push(d.get(f));e.points.push(g)}return e;case D.Fj.Envelope:return l=a.hasAttribute(D.Wc.Z),b=a.hasAttribute(D.Wc.M),c={},c.xmin=a.R.o,c.ymin=a.R.A,c.xmax=a.R.v,c.ymax=a.R.B,Q&&(l&&(l=a.xf(D.Wc.Z,0),c.zmin=l.ca,c.zmax=l.ha),
b&&(l=a.xf(D.Wc.M,0),c.mmin=l.ca,c.mmax=l.ha)),c}return null}var F=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var l in b)b.hasOwnProperty(l)&&(a[l]=b[l]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},D;(function(a){var b=function(){function a(){}a.Bm=!1;a.jw=!1;a.yz="";return a}();a.Xh=b;if("undefined"!==typeof window)a.Xh.yz="browser","Float64Array"in window&&(a.Xh.jw=!0),"ArrayBuffer"in window&&(a.Xh.Bm=!0);else if("undefined"!==typeof process)b.yz=
"node",a.Xh.Bm=!0,a.Xh.jw=!0;else{b.yz="browser";try{var c=new ArrayBuffer(0);new Uint8Array(c);a.Xh.Bm=!0;a.Xh.jw=!0}catch(l){a.Xh.Bm=!1}}})(D||(D={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Point=33]="Point";a[a.Line=322]="Line";a[a.Envelope=197]="Envelope";a[a.MultiPoint=550]="MultiPoint";a[a.Polyline=1607]="Polyline";a[a.Polygon=1736]="Polygon"})(a.Fj||(a.Fj={}));(function(a){a[a.enumMild=0]="enumMild";a[a.enumMedium=1]="enumMedium";a[a.enumHot=2]="enumHot"})(a.tM||(a.tM={}));
var b=function(){function b(){this.description=null;this.BB=0}b.prototype.G=function(){return 0};b.prototype.tb=function(){return-1};b.prototype.Fg=function(a){this.Bc();a!=this.description&&this.mo(a)};b.prototype.mo=function(){};b.prototype.om=function(b){this.Bc();b!=this.description&&(b=a.ye.vT(this.description,b),b!=this.description&&this.mo(b))};b.prototype.hasAttribute=function(a){return this.description.hasAttribute(a)};b.prototype.Ud=function(b){this.Bc();this.description.hasAttribute(b)||
(b=a.ye.uT(this.description,b),this.mo(b))};b.prototype.xf=function(){return null};b.prototype.Qn=function(){};b.prototype.s=function(){};b.prototype.Cp=function(){};b.prototype.ac=function(a){this.s(a)};b.prototype.u=function(){return!0};b.prototype.Oa=function(){};b.prototype.Xc=function(){};b.prototype.Ka=function(){return null};b.prototype.copyTo=function(){};b.prototype.hf=function(){return 0};b.prototype.Rb=function(){return 0};b.prototype.uH=function(){return this.hasAttribute(1)};b.lf=function(a){return((a&
192)>>6)+1>>1};b.Jo=function(a){return 0!=(a&32)};b.l_=function(a){return 0!=(a&64)};b.OU=function(a){return 0!=(a&128)};b.Oc=function(a){return 0!=(a&256)};b.gh=function(a){return 0!=(a&512)};b.Ic=function(a){return 0!=(a&1024)};b.prototype.Vf=function(){var a=this.Ka();this.copyTo(a);return a};b.prototype.Gg=function(){return null};b.oe=function(a){var d=a.Ka();a.copyTo(d);return d};b.prototype.Bc=function(){0<=this.BB&&(this.BB+=2147483649)};b.gy=function(l){var d=l.G();if(b.gh(d))return l.D();
if(l.u())return 0;if(197==d)return 4;if(33==d)return 1;if(b.Oc(d))return 2;throw a.g.X("missing type");};return b}();a.T=b})(D||(D={}));(function(a){var b=function(){function b(){this.y=this.x=0}b.pa=function(a,d){var h=new b;h.x=a;h.y=d;return h};b.El=function(a){var d=new b;d.x=a.x;d.y=a.y;return d};b.prototype.ka=function(a,d){this.x=a;this.y=d};b.prototype.L=function(a){this.x=a.x;this.y=a.y};b.prototype.Uq=function(a,d){return this.x===a&&this.y===d};b.prototype.wA=function(a){return 2.220446049250313E-16>=
Math.abs(this.x-a.x)&&2.220446049250313E-16>=Math.abs(this.y-a.y)};b.prototype.ub=function(a){return this.x===a.x&&this.y===a.y};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.x==a.x&&this.y==a.y:!1};b.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};b.prototype.zc=function(a,d){this.x=a.x-d.x;this.y=a.y-d.y};b.prototype.add=function(a,d){void 0!==d?(this.x=a.x+d.x,this.y=a.y+d.y):(this.x+=a.x,this.y+=a.y)};b.prototype.Lr=function(){this.x=-this.x;this.y=-this.y};b.prototype.bu=
function(a){this.x=-a.x;this.y=-a.y};b.prototype.IU=function(a,d,h){this.x=a.x*(1-h)+d.x*h;this.y=a.y*(1-h)+d.y*h};b.prototype.ru=function(a,d){this.x=this.x*a+d.x;this.y=this.y*a+d.y};b.prototype.EX=function(a,d,h){this.x=d.x*a+h.x;this.y=d.y*a+h.y};b.prototype.scale=function(a){this.x*=a;this.y*=a};b.prototype.compare=function(a){return this.y<a.y?-1:this.y>a.y?1:this.x<a.x?-1:this.x>a.x?1:0};b.prototype.normalize=function(){var a=this.length();0==a&&(this.x=1,this.y=0);this.x/=a;this.y/=a};b.prototype.length=
function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.qk=function(){return this.x*this.x+this.y*this.y};b.Cb=function(a,d){return Math.sqrt(this.sc(a,d))};b.xz=function(a,d,h,b){a-=h;d-=b;return Math.sqrt(a*a+d*d)};b.prototype.oi=function(a){return this.x*a.x+this.y*a.y};b.prototype.yE=function(a){return Math.abs(this.x*a.x)+Math.abs(this.y*a.y)};b.prototype.Ui=function(a){return this.x*a.y-this.y*a.x};b.prototype.qu=function(a,d){var h=-this.x*d+this.y*a;this.x=this.x*a+this.y*d;
this.y=h};b.prototype.uw=function(){var a=this.x;this.x=-this.y;this.y=a};b.prototype.aI=function(a){this.x=-a.y;this.y=a.x};b.prototype.Ur=function(){var a=this.x;this.x=this.y;this.y=-a};b.prototype.dv=function(){this.y=this.x=NaN};b.prototype.Hy=function(){return isNaN(this.x)};b.prototype.$u=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3};b.vs=function(a,d){var h=a.$u(),b=d.$u();return b==h?(h=a.Ui(d),0>h?1:0<h?-1:0):h<b?-1:1};b.AZ=function(a,d){return b.vs(a,d)};b.sc=function(a,
d){var h=a.x-d.x;a=a.y-d.y;return h*h+a*a};b.prototype.toString=function(){return"("+this.x+" , "+this.y+")"};b.prototype.$c=function(){this.y=this.x=NaN};b.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)};b.prototype.RO=function(){return this.Hy()?NaN:Math.abs(this.x)>=Math.abs(this.y)?Math.abs(this.x):Math.abs(this.y)};b.prototype.offset=function(a,d){var h=b.Cb(a,d),l=b.pa(this.x,this.y);if(0==h)return b.Cb(l,a);var c=new b;c.L(d);c.sub(a);l.sub(a);return l.Ui(c)/h};b.zp=function(b,
d,h){var l=new a.Xb;l.set(d.x);l.sub(b.x);var c=new a.Xb;c.set(h.y);c.sub(b.y);var e=new a.Xb;e.set(d.y);e.sub(b.y);var f=new a.Xb;f.set(h.x);f.sub(b.x);l.Vg(c);e.Vg(f);l.sub(e);if(!l.lt())return h=l.value(),0>h?-1:0<h?1:0;l=new a.Tp(d.x);c=new a.Tp(b.x);e=new a.Tp(b.y);l=l.Zt(c);b=new a.Tp(h.y);b=b.Zt(e);d=new a.Tp(d.y);d=d.Zt(e);h=new a.Tp(h.x);h=h.Zt(c);l=l.ds(b);d=d.ds(h);l=l.ds(d);return l.oV()?-1:l.$T()?1:0};b.prototype.jc=function(){return a.J.Zi(a.J.Zi())};return b}();a.b=b})(D||(D={}));(function(a){var b=
function(){function a(a){this.kz=this.Au=0;this.HY=a}a.prototype.reset=function(){this.kz=this.Au=0};a.prototype.add=function(a){a-=this.kz;var d=this.Au+a;this.kz=d-this.Au-a;this.Au=d};a.prototype.sub=function(a){this.add(-a)};a.prototype.en=function(){return this.HY+this.Au};return a}();a.ry=b;b=function(){function a(){}a.Fl=function(a,d){return 0<=d?Math.abs(a):-Math.abs(a)};a.sign=function(a){return 0>a?-1:0<a?1:0};a.gM=function(a){return a-360*Math.floor(a/360)};a.round=function(a){return Math.floor(a+
.5)};a.Yx=function(a){return a*a};a.Xq=function(a,d,h){var b;.5>=h?b=a+(d-a)*h:b=d-(d-a)*(1-h);return b};a.cI=function(a,d,h,b){.5>=h?(b.x=a.x+(d.x-a.x)*h,b.y=a.y+(d.y-a.y)*h):(b.x=d.x-(d.x-a.x)*(1-h),b.y=d.y-(d.y-a.y)*(1-h))};a.mV=function(a,d,h,b,c,e){.5>=c?(e.x=a+(h-a)*c,e.y=d+(b-d)*c):(e.x=h-(h-a)*(1-c),e.y=b-(b-d)*(1-c))};return a}();a.Ub=b})(D||(D={}));(function(a){var b=function(b){function l(){b.call(this);this.oa=this.sa=this.ra=this.ua=0;this.la=null}F(l,b);l.prototype.ec=function(){return a.b.pa(this.ua,
this.ra)};l.prototype.Oq=function(d){d.x=this.ua;d.y=this.ra};l.prototype.Mc=function(d){this.Qm(0,d)};l.prototype.wC=function(d,h){this.Qm(0,a.b.pa(d,h))};l.prototype.Dp=function(d){this.AE(0,d)};l.prototype.setStart=function(d){this.KE(0,d)};l.prototype.dt=function(d,a){return this.ae(0,d,a)};l.prototype.Tx=function(d,a,b){this.oo(0,d,a,b)};l.prototype.Cc=function(){return a.b.pa(this.sa,this.oa)};l.prototype.Ps=function(d){d.x=this.sa;d.y=this.oa};l.prototype.Zc=function(d){this.Qm(1,d)};l.prototype.vm=
function(d,h){this.Qm(1,a.b.pa(d,h))};l.prototype.Bp=function(d){this.AE(1,d)};l.prototype.setEnd=function(d){this.KE(1,d)};l.prototype.Os=function(d,a){return this.ae(1,d,a)};l.prototype.Lx=function(d,a,b){this.oo(1,d,a,b)};l.prototype.tb=function(){return 1};l.prototype.u=function(){return this.Hc()};l.prototype.Oa=function(){};l.prototype.hf=function(){return 0};l.prototype.Ma=function(d,a,b,l,c){return this.PO(d,a,b,l,c)};l.prototype.Yb=function(d,a){return 0!=this.ys(d,a,!1)};l.prototype.mt=
function(d,a){return this.av(d,a,!1)};l.prototype.av=function(){return null};l.prototype.Hc=function(){return!1};l.prototype.Jy=function(d){this.Bc();if(null==this.la&&0<d)this.la=a.J.gf(2*d);else if(null!=this.la&&this.la.length<2*d){for(var h=this.la.slice(0),b=this.la.length;b<2*d;b++)h[b]=0;this.la=h}};l.bX=function(d,a,b){if(0<b)var h=0;for(var l=0;l<b;l++)a[0+h]=d[0],h++};l.prototype.Qm=function(d,a){0!=d?(this.sa=a.x,this.oa=a.y):(this.ua=a.x,this.ra=a.y)};l.prototype.mo=function(d){if(null!=
this.la){for(var h=a.ye.vx(d,this.description),b=[],c=l.vl(this.description,0),e=l.vl(this.description,1),f=l.vl(d,0),g=l.vl(d,1),k=0,A=1,m=d.Ga;A<m;A++){var q=d.rd(A),n=a.ma.Xa(q);if(-1==h[A])for(var w=a.ma.de(q),q=0;q<n;q++)b[f+k]=w,b[g+k]=w,k++;else for(w=this.description.xk(h[A])-2,q=0;q<n;q++)b[f+k]=this.la[c+w],b[g+k]=this.la[e+w],k++,w++}this.la=b}this.description=d};l.prototype.AE=function(d,h){if(this.Hc())throw a.g.X("empty geometry");h.Fg(this.description);h.Hc()&&h.nq();for(var b=0;b<
this.description.Ga;b++)for(var l=this.description.Td(b),c=0,e=a.ma.Xa(l);c<e;c++){var f=this.ae(d,l,c);h.setAttribute(l,c,f)}};l.prototype.KE=function(d,h){this.Bc();if(h.Hc())throw a.g.X("empty geometry");for(var b=h.description,l=0,c=b.Ga;l<c;l++)for(var e=b.Td(l),f=a.ma.Xa(e),g=0;g<f;g++){var k=h.Yc(e,g);this.oo(d,e,g,k)}};l.prototype.ae=function(d,h,b){if(this.Hc())throw a.g.X("This operation was performed on an Empty Geometry.");if(0==h)return 0!=d?0!=b?this.oa:this.sa:0!=b?this.ra:this.ua;
if(b>=a.ma.Xa(h))throw a.g.wd();var r=this.description.mg(h);return 0<=r?(null!=this.la&&this.Jy(this.description.af.length-2),this.la[l.vl(this.description,d)+this.description.xk(r)-2+b]):a.ma.de(h)};l.prototype.oo=function(d,h,b,c){this.Bc();if(b>=a.ma.Xa(h))throw a.g.wd();var r=this.description.mg(h);0>r&&(this.Ud(h),r=this.description.mg(h));0==h?0!=d?0!=b?this.oa=c:this.sa=c:0!=b?this.ra=c:this.ua=c:(null==this.la&&this.Jy(this.description.af.length-2),this.la[l.vl(this.description,d)+this.description.xk(r)-
2+b]=c)};l.prototype.copyTo=function(d){if(d.G()!=this.G())throw a.g.F();d.description=this.description;d.Jy(this.description.af.length-2);l.bX(this.la,d.la,2*(this.description.af.length-2));d.ua=this.ua;d.ra=this.ra;d.sa=this.sa;d.oa=this.oa;d.Bc();this.iq(d)};l.prototype.xf=function(d,h){var b=new a.Ac;if(this.Hc())return b.Oa(),b;b.ca=this.ae(0,d,h);b.ha=b.ca;b.ml(this.ae(1,d,h));return b};l.prototype.SJ=function(d){this.Hc()?d.Oa():(d.ca=this.ae(0,0,0),d.ha=d.ca,d.ml(this.ae(1,0,0)))};l.prototype.Fx=
function(d,h){h.Fg(this.description);h.rb(this.gc(d));for(var b=1,l=this.description.Ga;b<l;b++)for(var c=this.description.Td(b),e=a.ma.Xa(c),f=0;f<e;f++){var g=this.Yc(d,c,f);h.setAttribute(c,f,g)}};l.prototype.MO=function(d){if(this.description!=d.description||this.ua!=d.ua||this.sa!=d.sa||this.ra!=d.ra||this.oa!=d.oa)return!1;for(var a=0;a<2*(this.description.af.length-2);a++)if(this.la[a]!=d.la[a])return!1;return!0};l.prototype.OH=function(){return this.ua==this.sa&&this.ra==this.oa};l.prototype.reverse=
function(){var d=this.ua;this.ua=this.sa;this.sa=d;d=this.ra;this.ra=this.oa;this.oa=d;for(var d=1,h=this.description.Ga;d<h;d++)for(var b=this.description.rd(d),l=0,c=a.ma.Xa(b);l<c;l++){var e=this.ae(0,b,l),f=this.ae(1,b,l);this.oo(0,b,l,f);this.oo(1,b,l,e)}};l.prototype.ys=function(d,h,b){var l=d.G();switch(this.G()){case 322:if(322==l)return a.Hb.QO(this,d,h,b);throw a.g.za();default:throw a.g.za();}};l.prototype.PO=function(d,h,b,l,c){var r=d.G();switch(this.G()){case 322:if(322==r)return a.Hb.Gy(this,
d,h,b,l,c);throw a.g.za();default:throw a.g.za();}};l.prototype.Cy=function(){return null};l.vl=function(d,a){return a*(d.af.length-2)};l.prototype.gc=function(d,h){if(void 0===h)return h=new a.b,this.gc(d,h),h;a.Ub.mV(this.ua,this.ra,this.sa,this.oa,d,h)};l.prototype.pe=function(){return null};l.prototype.qH=function(){return null};l.prototype.Tq=function(){return null};l.prototype.fh=function(){return null};l.prototype.Go=function(){return null};l.prototype.Eg=function(){return null};l.prototype.Dy=
function(d,a){return void 0!==a?this.cy(a)-this.cy(d):this.cy(d)};l.prototype.iq=function(){};l.prototype.Hl=function(){return null};l.prototype.yh=function(){};l.prototype.Yc=function(){return null};l.prototype.pf=function(){return null};l.prototype.cy=function(){return null};l.prototype.bI=function(){return null};l.prototype.Cb=function(d,a){if(!a&&0!=this.ys(d,0,!1))return 0;a=1.7976931348623157E308;var h,b;h=this.ec();b=d.pe(h,!1);h.sub(d.gc(b));h=h.length();h<a&&(a=h);h=this.Cc();b=d.pe(h,!1);
h.sub(d.gc(b));h=h.length();h<a&&(a=h);h=d.ec();b=this.pe(h,!1);h.sub(this.gc(b));h=h.length();h<a&&(a=h);h=d.Cc();b=this.pe(h,!1);h.sub(this.gc(b));h=h.length();h<a&&(a=h);return a};l.prototype.Gg=function(){return a.Pi.Rm(this,null)};return l}(a.T);a.cE=b})(D||(D={}));new D.b;(function(a){(function(a){a[a.Unknown=-1]="Unknown";a[a.Not=0]="Not";a[a.Weak=1]="Weak";a[a.Strong=2]="Strong"})(a.vM||(a.vM={}));(function(a){a[a.DirtyIsKnownSimple=1]="DirtyIsKnownSimple";a[a.IsWeakSimple=2]="IsWeakSimple";
a[a.IsStrongSimple=4]="IsStrongSimple";a[a.DirtyOGCFlags=8]="DirtyOGCFlags";a[a.DirtyVerifiedStreams=32]="DirtyVerifiedStreams";a[a.DirtyExactIntervals=64]="DirtyExactIntervals";a[a.DirtyLooseIntervals=128]="DirtyLooseIntervals";a[a.DirtyIntervals=192]="DirtyIntervals";a[a.DirtyIsEnvelope=256]="DirtyIsEnvelope";a[a.DirtyLength2D=512]="DirtyLength2D";a[a.DirtyRingAreas2D=1024]="DirtyRingAreas2D";a[a.DirtyCoordinates=1993]="DirtyCoordinates";a[a.DirtyAllInternal=65535]="DirtyAllInternal";a[a.DirtyAll=
16777215]="DirtyAll"})(a.$L||(a.$L={}));var b=function(b){function l(){b.call(this);this.tn=65535;this.qa=0;this.lh=-1;this.ob=null}F(l,b);l.prototype.iq=function(){};l.prototype.Iy=function(){};l.prototype.Py=function(){};l.prototype.D=function(){return this.qa};l.prototype.u=function(){return this.Hc()};l.prototype.Hc=function(){return 0==this.qa};l.prototype.yk=function(d){return 0!=(this.tn&d)};l.prototype.lg=function(d,a){this.tn=a?this.tn|d:this.tn&~d};l.prototype.wc=function(){this.yk(32)&&
this.ZO()};l.prototype.Cu=function(){if(this.Hc())throw a.g.X("This operation was performed on an Empty Geometry.");};l.prototype.Ae=function(d,h){if(0>d||d>=this.qa)throw a.g.X("index out of bounds");this.wc();h.Fg(this.description);h.u()&&h.nq();for(var b=0;b<this.description.Ga;b++)for(var l=this.description.Td(b),c=0,e=a.ma.Xa(l);c<e;c++){var f=this.ya[b].Of(e*d+c);h.setAttribute(l,c,f)}};l.prototype.vu=function(d,h){this.wc();for(var b=h.description,l=0;l<b.Ga;l++)for(var c=b.Td(l),e=a.ma.Xa(c),
f=0;f<e;f++){var g=h.Yc(c,f);this.setAttribute(c,d,f,g)}};l.prototype.w=function(d,h){if(0>d||d>=this.D())throw a.g.wd();this.wc();this.ya[0].fc(2*d,h)};l.prototype.Ba=function(d){var h=new a.b;this.w(d,h);return h};l.prototype.Nc=function(d,a){this.ya[0].fc(2*d,a)};l.prototype.rb=function(d,h,b){if(0>d||d>=this.qa)throw a.g.wd();this.wc();var l=this.ya[0];void 0!==b?(l.write(2*d,h),l.write(2*d+1,b)):l.fo(2*d,h);this.Dc(1993)};l.prototype.lA=function(d){if(0>d||d>=this.D())throw a.g.wd();this.wc();
var h=this.ya[0],b=new a.qd;b.x=h.read(2*d);b.y=h.read(2*d+1);b.z=this.hasAttribute(1)?this.ya[1].Of(d):a.ma.de(1);return b};l.prototype.BC=function(d,h){if(0>d||d>=this.D())throw a.g.wd();this.Ud(1);this.wc();this.Dc(1993);var b=this.ya[0];b.write(2*d,h.x);b.write(2*d+1,h.y);this.ya[1].Dm(d,h.z)};l.prototype.Yc=function(d,h,b){if(0>h||h>=this.qa)throw a.g.wd();var l=a.ma.Xa(d);if(b>=l)throw a.g.wd();this.wc();var r=this.description.mg(d);return 0<=r?this.ya[r].Of(h*l+b):a.ma.de(d)};l.prototype.KG=
function(d,a,b){return this.Yc(d,a,b)};l.prototype.setAttribute=function(d,h,b,l){if(0>h||h>=this.qa)throw a.g.wd();var r=a.ma.Xa(d);if(b>=r)throw a.g.wd();this.Ud(d);this.wc();d=this.description.mg(d);this.Dc(1993);this.ya[d].Dm(h*r+b,l)};l.prototype.Pa=function(d){this.Cu();this.Ud(d);this.wc();return this.ya[this.description.mg(d)]};l.prototype.Yn=function(d,h){if(null!=h&&a.ma.si(d)!=h.si())throw a.g.F();this.Ud(d);d=this.description.mg(d);null==this.ya&&(this.ya=a.Uc.IB(this.description.Ga));
this.ya[d]=h;this.Dc(16777215)};l.prototype.mo=function(d){var h=null;if(null!=this.ya)for(var b=a.ye.vx(d,this.description),h=[],l=0,c=d.Ga;l<c;l++)-1!=b[l]&&(h[l]=this.ya[b[l]]);this.description=d;this.ya=h;this.lh=-1;this.Dc(16777215)};l.prototype.PE=function(d){this.fv(!0);d instanceof a.h?this.R.s(d):this.R.Cp(d)};l.prototype.YO=function(d){this.fv(!1);d instanceof a.h?this.R.s(d):this.R.Cp(d)};l.prototype.Qn=function(d){this.fv(!0);this.R.copyTo(d)};l.prototype.s=function(d){this.PE(d)};l.prototype.Cp=
function(d){this.PE(d)};l.prototype.ac=function(d){this.YO(d)};l.prototype.xf=function(d,h){var b=new a.Ac;if(this.Hc())return b.Oa(),b;this.fv(!0);return this.R.xf(d,h)};l.prototype.jc=function(){var d=this.description.jc();if(!this.Hc())for(var h=this.D(),b=0,l=this.description.Ga;b<l;b++)d=this.ya[b].Ak(d,0,h*a.ma.Xa(this.description.Td(b)));return d};l.prototype.Eb=function(d){if(d==this)return!0;if(!(d instanceof l&&this.description.Eb(d.description))||this.Hc()!=d.Hc())return!1;if(this.Hc())return!0;
var h=this.D();if(h!=d.D())return!1;for(var b=0;b<this.description.Ga;b++){var c=this.description.rd(b),e=this.Pa(c),f=d.Pa(c);if(!e.Eb(f,0,h*a.ma.Xa(c)))return!1}return!0};l.prototype.copyTo=function(d){if(d.G()!=this.G())throw a.g.F();this.xE(d)};l.prototype.xE=function(d){this.wc();d.description=this.description;d.ya=null;var h=this.description.Ga,b=null;if(null!=this.ya)for(var b=[],l=0;l<h;l++)null!=this.ya[l]&&(b[l]=this.ya[l].Tr(this.D()*a.ma.Xa(this.description.Td(l))));null!=this.R?(d.R=
this.R.Ka(),this.R.copyTo(d.R)):d.R=null;d.qa=this.qa;d.tn=this.tn;d.ya=b;try{this.iq(d)}catch(H){throw d.Oa(),a.g.TN();}};l.prototype.ME=function(){this.qa=0;this.lh=-1;this.ya=null;this.Dc(16777215)};l.prototype.Dc=function(d){16777215==d&&(this.lh=-1,this.Iy());this.tn|=d;this.DO();this.Bc()};l.prototype.fv=function(d){this.wc();if(this.yk(192))if(null==this.R?this.R=new a.ci(this.description):this.R.Fg(this.description),this.u())this.R.Oa();else{this.Oy(d);for(var h=1;h<this.description.Ga;h++)for(var b=
this.description.Td(h),l=a.ma.Xa(b),c=this.ya[h],e=0;e<l;e++){var f=new a.Ac;f.Oa();for(var g=0;g<this.qa;g++){var k=c.Of(g*l+e);f.Nb(k)}this.R.setInterval(b,e,f)}d&&this.lg(192,!1)}};l.prototype.Oy=function(){this.R.Oa();for(var d=this.ya[0],h=new a.b,b=0;b<this.qa;b++)d.fc(2*b,h),this.R.Nb(h)};l.prototype.uo=function(d){d.Oa();for(var h=this.ya[0],b=new a.b,l=0;l<this.qa;l++)h.fc(2*l,b),d.Nb(b)};l.prototype.ZO=function(){if(this.lh<this.qa){null==this.ya&&(this.ya=a.Uc.IB(this.description.Ga));
this.lh=2147483647;for(var d=0;d<this.description.Ga;d++){var h=this.description.Td(d);if(null!=this.ya[d]){var b=a.ma.Xa(h),l=a.J.truncate(this.ya[d].size/b);l<this.qa&&(l=a.J.truncate(this.lh>this.qa+5?(5*this.qa+3)/4:this.qa),this.ya[d].resize(l*b,a.ma.de(h)));l<this.lh&&(this.lh=l)}else this.ya[d]=a.Uc.qz(h,this.qa),this.lh=this.qa}}this.Py();this.lg(32,!1)};l.prototype.zl=function(d){if(0>d)throw a.g.F();d!=this.qa&&(this.qa=d,this.Dc(65535))};l.prototype.Lk=function(d){if(!this.yk(1)){if(!this.yk(2))return 0;
if(this.OV>=d)return this.yk(8)?1:2}return-1};l.prototype.Zg=function(d,h){this.OV=h;if(-1==d)this.lg(1,!0),this.lg(8,!0);else if(this.lg(1,!1),this.lg(8,!0),0==d)this.lg(2,!1),this.lg(4,!1);else if(1==d)this.lg(2,!0),this.lg(4,!1);else if(2==d)this.lg(2,!0),this.lg(4,!0);else throw a.g.X("internal error.");};l.prototype.DO=function(){null!=this.ob&&(this.ob=null)};l.prototype.DE=function(d,h,b,l){if(0>d||d>=this.qa)throw a.g.X("index out of bounds");if(0>h||h>=this.qa)throw a.g.X("index out of bounds");
this.wc();l.Fg(this.description);l.u()&&l.nq();for(var r=0;r<this.description.Ga;r++)for(var c=this.description.Td(r),e=0,f=a.ma.Xa(c);e<f;e++){var y=this.ya[r].Of(f*d+e),g=this.ya[r].Of(f*h+e);l.setAttribute(c,e,a.Ub.Xq(y,g,b))}};l.prototype.xs=function(d,a){var h=this.ya[0].f,b=h[2*d]-h[2*a],h=h[2*d+1]-h[2*a+1];return Math.sqrt(b*b+h*h)};l.prototype.Yh=function(d,h){if(0>d||d>=this.qa)throw a.g.wd();if(h.u())throw a.g.F();this.wc();for(var b=h.description,l=0;l<b.Ga;l++)for(var c=b.rd(l),e=a.ma.Xa(c),
f=0;f<e;f++){var g=h.Yc(c,f);this.setAttribute(c,d,f,g)}};l.prototype.Xu=function(){return null};l.prototype.Hj=function(){return null};return l}(a.T);a.Mu=b})(D||(D={}));(function(a){var b=function(){function b(){this.pb=this.Oo=null;this.Gn=124234251;this.Dw=!0;this.qf=-1;this.pb=new a.ad(7);this.Oo=null}b.prototype.Ep=function(a){this.Oo=a};b.prototype.OR=function(){this.Dw=!1};b.prototype.Qe=function(a){this.pb.Qe(a)};b.prototype.Ks=function(a){var d=this.pb.Pe();this.mY(d);this.pY(a,d);return d};
b.prototype.IR=function(a){this.pb.kd(a)};b.prototype.addElement=function(a,d){var h;-1==d?(-1==this.qf&&(this.qf=this.Ks(-1)),h=this.qf):h=d;return this.WE(a,0,h)};b.prototype.$E=function(a){-1==this.qf&&(this.qf=this.Ks(-1));return this.WE(a,1,this.qf)};b.prototype.ro=function(a){var d;-1==this.qf&&(this.qf=this.Ks(-1));d=this.qf;var h=this.pb.f;if(-1==d||-1==h[7*d])return a=this.pb.nl([-1,-1,-1,a,this.Ll(),-1,-1]),h=this.pb.f,h[7*d]=a,this.pq(-1,a,d,h),a;var b=-1==d?-1:h[7*d+2];a=this.pb.nl([-1,
-1,b,a,this.Ll(),-1,-1]);h=this.pb.f;h[7*b+1]=a;this.Vy(a,h);-1===h[7*a+2]&&(h[7*d]=a);this.pq(-1,a,d,h);return a};b.prototype.jv=function(b,d,h,r){var l=-1;-1==l&&(-1==this.qf&&(this.qf=this.Ks(-1)),l=this.qf);var c=this.pb.f;if(-1==l||-1==c[7*l])return h=this.pb.nl([-1,-1,-1,h,this.Ll(),-1,-1]),c=this.pb.f,c[7*l]=h,this.pq(-1,h,l,c),h;var e;r?(r=-1!=d?this.Oo.compare(this,h,d):-1,e=-1!=b?this.Oo.compare(this,h,b):1):(r=-1,e=1);if(0==r||0==e)return c[7*l+3]=0==r?d:b,-1;(-1!=d&&-1!=b?this.Gn>a.J.HB(this.Gn)>>
1:-1!=d)?b=d:r=e;for(d=!0;;){if(0>r)if(e=c[7*b],-1!=e)b=e;else{r=b;h=this.pb.nl([-1,-1,b,h,this.Ll(),-1,-1]);c=this.pb.f;c[7*b]=h;break}else if(e=c[7*b+1],-1!=e)b=e;else{r=c[7*b+6];h=this.pb.nl([-1,-1,b,h,this.Ll(),-1,-1]);c=this.pb.f;c[7*b+1]=h;break}d&&(r*=-1,d=!1)}this.Vy(h,c);-1===c[7*h+2]&&(c[7*l]=h);this.pq(r,h,l,c);return h};b.prototype.QG=function(){return this.$S(this.qf)};b.prototype.Kd=function(a,d){d=-1==d?this.qf:d;this.Dw?this.HR(a,d):this.fZ(a,d)};b.prototype.search=function(a,d){for(d=
this.fw(d);-1!=d;){var h=this.Oo.compare(this,a,d);if(0==h)return d;d=0>h?this.Pl(d):this.Nq(d)}return-1};b.prototype.HX=function(a){for(var d=this.fw(-1),h=-1;-1!=d;){var b=a.compare(this,d);if(0==b)return d;0>b?d=this.Pl(d):(h=d,d=this.Nq(d))}return h};b.prototype.lK=function(a){for(var d=this.fw(-1),h=-1;-1!=d;){var b=a.compare(this,d);if(0==b)return d;0>b?(h=d,d=this.Pl(d)):d=this.Nq(d)}return h};b.prototype.ja=function(a){return this.pb.S(a,3)};b.prototype.Pl=function(a){return this.pb.S(a,0)};
b.prototype.Nq=function(a){return this.pb.S(a,1)};b.prototype.getParent=function(a){return this.pb.S(a,2)};b.prototype.nb=function(a){return this.pb.S(a,6)};b.prototype.Ve=function(a){return this.pb.S(a,5)};b.prototype.xc=function(a){return-1==a?this.Ol(this.qf):this.Ol(a)};b.prototype.Fc=function(a){return-1==a?this.Zs(this.qf):this.Zs(a)};b.prototype.ST=function(a){return-1==a?this.nH(this.qf):this.nH(a)};b.prototype.kk=function(a,d){this.nC(a,d)};b.prototype.fw=function(a){return-1==a?this.iH(this.qf):
this.iH(a)};b.prototype.clear=function(){this.pb.Vi(!1);this.qf=-1};b.prototype.size=function(a){return-1==a?this.kH(this.qf):this.kH(a)};b.prototype.OP=function(a,d){for(var h=d[7*a],b=d[7*a+1],l=d[7*a+4];-1!=h||-1!=b;){var c=-1!=h?d[7*h+4]:2147483647,b=-1!=b?d[7*b+4]:2147483647;if(l<=Math.min(c,b))break;c<=b?this.iK(h,d):this.hK(a,d);h=d[7*a];b=d[7*a+1]}};b.prototype.Vy=function(a,d){if(this.Dw)for(var h=d[7*a+4],b=d[7*a+2];-1!=b&&d[7*b+4]>h;)d[7*b]==a?this.iK(a,d):this.hK(b,d),b=d[7*a+2]};b.prototype.hK=
function(a,d){var h=d[7*a+1],b;d[7*h+2]=d[7*a+2];d[7*a+2]=h;b=d[7*h];d[7*a+1]=b;-1!=b&&(d[7*b+2]=a);d[7*h]=a;b=d[7*h+2];-1!=b&&(d[7*b]==a?d[7*b]=h:d[7*b+1]=h)};b.prototype.iK=function(a,d){var h=d[7*a+2],b;d[7*a+2]=d[7*h+2];d[7*h+2]=a;b=d[7*a+1];d[7*h]=b;-1!=b&&(d[7*b+2]=h);d[7*a+1]=h;b=d[7*a+2];-1!=b&&(d[7*b]===h?d[7*b]=a:d[7*b+1]=a)};b.prototype.sl=function(a,d){this.pb.P(a,2,d)};b.prototype.rC=function(a,d){this.pb.P(a,0,d)};b.prototype.vC=function(a,d){this.pb.P(a,1,d)};b.prototype.uC=function(a,
d){this.pb.P(a,5,d)};b.prototype.Qx=function(a,d){this.pb.P(a,6,d)};b.prototype.OK=function(a,d){this.pb.P(d,0,a)};b.prototype.mY=function(a){this.pb.P(a,4,0)};b.prototype.pY=function(a,d){this.pb.P(d,5,a)};b.prototype.iH=function(a){return-1==a?-1:this.pb.S(a,0)};b.prototype.Ol=function(a){return-1==a?-1:this.pb.S(a,1)};b.prototype.Zs=function(a){return-1==a?-1:this.pb.S(a,2)};b.prototype.$S=function(a){return-1==a?-1:this.pb.S(a,3)};b.prototype.kH=function(a){return-1==a?0:this.pb.S(a,4)};b.prototype.nH=
function(a){return this.pb.S(a,5)};b.prototype.Bx=function(a){return this.pb.nl([-1,-1,-1,a,this.Ll(),-1,-1])};b.prototype.Kl=function(a){-1!=a&&this.pb.kd(a)};b.prototype.Ll=function(){this.Gn=a.J.HB(this.Gn);return this.Gn&1073741823};b.prototype.WE=function(a,d,h){var b=this.pb.f;if(-1==h||-1==b[7*h])return a=this.pb.nl([-1,-1,-1,a,this.Ll(),-1,-1]),b=this.pb.f,b[7*h]=a,this.pq(-1,a,h,b),a;for(var l=-1==h?-1:b[7*h];;){var c=-1==d?1:this.Oo.compare(this,a,l);if(0>c)if(c=this.Pl(l),-1!=c)l=c;else{d=
l;a=this.pb.nl([-1,-1,l,a,this.Ll(),-1,-1]);b=this.pb.f;b[7*l]=a;break}else{if(1==d&&0==c)return b[7*h+3]=l,-1;c=b[7*l+1];if(-1!=c)l=c;else{d=b[7*l+6];a=this.pb.nl([-1,-1,l,a,this.Ll(),-1,-1]);b=this.pb.f;b[7*l+1]=a;break}}}this.Vy(a,b);-1===b[7*a+2]&&(b[7*h]=a);this.pq(d,a,h,b);return a};b.prototype.pq=function(a,d,h,b){var l;-1!=a?(l=b[7*a+5],b[7*a+5]=d):l=-1==h?-1:b[7*h+2];b[7*d+5]=l;-1!=l&&(b[7*l+6]=d);b[7*d+6]=a;a==(-1==h?-1:b[7*h+1])&&(b[7*h+1]=d);-1==a&&(b[7*h+2]=d);b[7*h+4]=(-1==h?0:b[7*h+
4])+1};b.prototype.$B=function(a,d){var h=this.pb.f,b=h[7*a+5];a=h[7*a+6];-1!=b?h[7*b+6]=a:h[7*d+1]=a;-1!=a?h[7*a+5]=b:h[7*d+2]=b;h[7*d+4]=-1===d?-1:h[7*d+4]-1};b.prototype.fZ=function(b,d){this.$B(b,d);var h=this.Pl(b),l=this.Nq(b),c=this.getParent(b),e=b;if(-1!=h&&-1!=l){this.Gn=a.J.HB(this.Gn);var f;f=1073741823<this.Gn?this.nb(b):this.Ve(b);var g=this.getParent(f)==b;this.pb.ay(b,f,0);this.pb.ay(b,f,1);this.pb.ay(b,f,2);-1!=c?this.Pl(c)==b?this.rC(c,f):this.vC(c,f):this.OK(f,d);g?(h==f?(this.rC(f,
b),this.sl(l,f)):l==f&&(this.vC(f,b),this.sl(h,f)),this.sl(b,f),c=f):(this.sl(h,f),this.sl(l,f),c=this.getParent(b),e=f);h=this.Pl(b);l=this.Nq(b);-1!=h&&this.sl(h,b);-1!=l&&this.sl(l,b)}h=-1!=h?h:l;-1==c?this.OK(h,d):this.Pl(c)==e?this.rC(c,h):this.vC(c,h);-1!=h&&this.sl(h,c);this.Kl(b,d)};b.prototype.HR=function(a,d){var h=this.pb.f;h[7*a+4]=2147483647;var b=-1,l=-1,c=-1===d?-1:h[7*d],e=c==a;e&&(b=h[7*c],l=h[7*c+1],-1==b&&-1==l)?(this.$B(c,d),this.Kl(c,d),h[7*d]=-1):(this.OP(a,h),c=h[7*a+2],-1!=
c&&(h[7*c]==a?h[7*c]=-1:h[7*c+1]=-1),this.$B(a,d),this.Kl(a,d),e&&(h[7*d]=-1==b||-1!=h[7*b+2]?l:b))};b.prototype.nC=function(a,d){this.pb.P(a,3,d)};return b}();a.uk=b})(D||(D={}));(function(a){var b=function(){function b(a,d){void 0!==a&&this.I(a,d)}b.prototype.I=function(a,d){this.ca=a;this.ha=d;this.normalize()};b.prototype.Yb=function(a){return this.ca<=a.ca?this.ha>=a.ca:a.ha>=this.ca};b.prototype.move=function(a){this.u()||(this.ca+=a,this.ha+=a)};b.prototype.normalize=function(){if(!isNaN(this.ca)){if(this.ca>
this.ha){var a=this.ca;this.ca=this.ha;this.ha=a}isNaN(this.ha)&&this.Oa()}};b.prototype.Oa=function(){this.ha=this.ca=NaN};b.prototype.u=function(){return isNaN(this.ca)};b.prototype.Nb=function(a){"number"===typeof a?this.u()?this.ha=this.ca=a:this.ml(a):a.u()||(this.u()?(this.ca=a.ca,this.ha=a.ha):(this.ca>a.ca&&(this.ca=a.ca),this.ha<a.ha&&(this.ha=a.ha),this.ca>this.ha&&this.Oa()))};b.prototype.ml=function(a){a<this.ca?this.ca=a:a>this.ha&&(this.ha=a)};b.prototype.contains=function(a){return"number"===
typeof a?a>=this.ca&&a<=this.ha:a.ca>=this.ca&&a.ha<=this.ha};b.prototype.Ma=function(a){this.u()||a.u()?this.Oa():(this.ca<a.ca&&(this.ca=a.ca),this.ha>a.ha&&(this.ha=a.ha),this.ca>this.ha&&this.Oa())};b.prototype.O=function(a){this.u()||(this.ca-=a,this.ha+=a,this.ha<this.ca&&this.Oa())};b.prototype.no=function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.ca)+Math.abs(this.ha)+1)};b.prototype.kC=function(a,d){a>d?(this.ca=d,this.ha=a):(this.ca=a,this.ha=d)};b.prototype.wu=
function(b){return a.J.pk(b,this.ca,this.ha)};b.prototype.N=function(){return this.ha-this.ca};b.prototype.Wf=function(){return.5*(this.ca+this.ha)};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?this.u()&&a.u()?!0:this.ca!=a.ca||this.ha!=a.ha?!1:!0:!1};b.prototype.jc=function(){return a.J.Zi(a.J.Zi())};return b}();a.Ac=b})(D||(D={}));(function(a){var b=new a.Ac,c=new a.Ac,l=function(){return function(){this.Le=null;this.qb=-1;this.wb=new a.Hb;this.YA=55555555;this.Fw=this.Iw=!1;this.rg=
new a.Ac;this.rg.kC(0,0)}}();a.k_=l;var d=function(){function d(d,h,b){this.a=d;this.il=NaN;this.aJ=this.Ar=0;this.bJ=NaN;this.ta=h;this.Dr=10*h;this.cJ=this.dJ=NaN;this.Ng=!1;this.rn=this.Yt=this.vp=this.St=this.Rt=-1;this.PA=b;this.zB=new l;this.kJ=new l;a.J.truncate(3*d.vd/2)}d.prototype.AH=function(d,a,h,b){d.Le=null===b?null:b[h[5*a]];d.Fw=null!=d.Le;d.Fw||(b=h[5*a+2],-1!==b&&this.a.gX(h[5*a],h[5*b],d.wb),d.Le=d.wb,d.rg.kC(d.wb.ua,d.wb.sa),d.rg.ha+=this.ta,d.wb.BJ(),d.Iw=d.wb.oa==d.wb.ra,d.Iw||
(d.YA=(d.wb.sa-d.wb.ua)/(d.wb.oa-d.wb.ra)))};d.prototype.RQ=function(d,a){var h=d.ys(a,this.ta,!0);if(0!=h)return 2==h?this.Az():this.Wi();d.Oq(K);d.Ps(J);a.Oq(L);a.Ps(M);I.ka(this.Ar,this.il);K.ub(L)&&this.il==K.y?0>J.compare(M)?I.L(J):I.L(M):K.ub(M)&&this.il==K.y?0>J.compare(L)?I.L(J):I.L(L):L.ub(J)&&this.il==L.y?0>K.compare(M)?I.L(K):I.L(M):J.ub(M)&&this.il==J.y&&(0>K.compare(L)?I.L(K):I.L(L));return d.pf(I.y,I.x)<a.pf(I.y,I.x)?-1:1};d.prototype.PQ=function(d,a){if(d.wb.ra==a.wb.ra&&d.wb.ua==a.wb.ua)return d.wb.oa==
a.wb.oa&&d.wb.sa==a.wb.sa?this.PA?this.Az():0:this.VF(d,a);if(d.wb.oa==a.wb.oa&&d.wb.sa==a.wb.sa)return this.UF(d,a);var h=this.UF(d,a);d=this.VF(d,a);return 0>h&&0>d?-1:0<h&&0<d?1:this.Wi()};d.prototype.LQ=function(d,a){if(d.sa>a.sa){if(a.sa>a.ua&&a.oa-a.ra<2*this.ta&&d.Si(a.sa,a.oa,this.ta))return this.Wi()}else if((a.oa-a.ra)/(a.sa-a.ua)*(d.sa-d.ua)<this.Dr&&a.Si(d.sa,d.oa,this.ta))return this.Wi();return 1};d.prototype.MQ=function(d,a){if(d.ua<a.ua){if(a.sa>a.ua&&a.oa-a.ra<2*this.ta&&d.Si(a.sa,
a.oa,this.ta))return this.Wi()}else if((a.oa-a.ra)/(a.sa-a.ua)*(d.ua-d.sa)<this.Dr&&a.Si(d.ua,d.ra,this.ta))return this.Wi();return-1};d.prototype.NQ=function(d,h){var b=new a.b;b.zc(h.Cc(),h.ec());b.Ur();b.normalize();var l=new a.b;l.zc(d.ec(),h.ec());var r=new a.b;r.zc(d.Cc(),h.ec());var l=l.oi(b),b=r.oi(b),r=Math.abs(l),c=Math.abs(b);if(r<c){if(r<this.Dr&&h.Si(d.ua,d.ra,this.ta))return this.Wi()}else if(c<this.Dr&&h.Si(d.sa,d.oa,this.ta))return this.Wi();return 0>l&&0>b?-1:0<l&&0<b?1:this.Wi()};
d.prototype.TF=function(d,a){return d.ra==a.ra&&d.ua==a.ua?this.LQ(d,a):d.oa==a.oa&&d.sa==a.sa?this.MQ(d,a):this.NQ(d,a)};d.prototype.OQ=function(d,a){return d.oa==a.oa&&d.sa==a.sa&&d.ra==a.ra&&d.ua==a.ua?this.PA?this.Az():0:this.Wi()};d.prototype.UF=function(d,a){var h=1;if(d.wb.ra<a.wb.ra){var h=-1,b=d;d=a;a=b}b=d.wb;d=a.wb;var l=b.ua-d.ua;a=a.YA*(b.ra-d.ra);var r=this.Dr;return l<a-r?-h:l>a+r?h:d.Si(b.ua,b.ra,this.ta)?this.Wi():l<a?-h:h};d.prototype.VF=function(d,a){var h=1;if(a.wb.oa<d.wb.oa){var h=
-1,b=d;d=a;a=b}b=d.wb;d=a.wb;var l=b.sa-d.ua;a=a.YA*(b.oa-d.ra);var r=this.Dr;return l<a-r?-h:l>a+r?h:d.Si(b.sa,b.oa,this.ta)?this.Wi():l<a?-h:h};d.prototype.Az=function(){this.Ng=!0;this.mj=new a.$d(5,this.vp,this.Yt);return-1};d.prototype.Wi=function(){this.Ng=!0;this.PA?this.mj=new a.$d(4,this.vp,this.Yt):this.Yt=this.vp=this.St=this.Rt=-1;return-1};d.prototype.QQ=function(d,a,h,l){if(this.Ng)return-1;var r=this.bJ==this.il&&this.aJ==this.Ar,e;r&&d==this.Rt?e=this.cJ:(e=NaN,this.Rt=-1);r&&a==this.St?
r=this.dJ:(r=NaN,this.St=-1);h.Le.SJ(b);l.Le.SJ(c);if(b.ha<c.ca)return-1;if(c.ha<b.ca)return 1;this.bJ=this.il;this.aJ=this.Ar;isNaN(e)&&(this.Rt=d,this.cJ=e=d=h.Le.pf(this.il,this.Ar));isNaN(r)&&(this.St=a,this.dJ=r=d=l.Le.pf(this.il,this.Ar));return Math.abs(e-r)<=this.ta?this.RQ(h.Le,l.Le):e<r?-1:e>r?1:0};d.prototype.Gs=function(){this.Ng=!1};d.prototype.en=function(){return this.mj};d.prototype.QK=function(d,a){this.il=d;this.Ar=a;this.Yt=this.vp=this.St=this.Rt=-1};d.prototype.compare=function(d,
a,h){if(this.Ng)return-1;d=d.ja(h);this.rn=h;return this.XF(a,a,d,d)};d.prototype.XF=function(d,a,h,b){var l;this.vp==a?l=this.zB:(this.vp=a,l=this.zB,this.zB.qb=d,this.AH(l,a,this.a.Dd.f,this.a.wf));var r;null==r&&(this.Yt=b,r=this.kJ,this.kJ.qb=h,this.AH(r,b,this.a.Dd.f,this.a.wf));if(l.Fw||r.Fw)return this.QQ(a,b,l,r);if(l.rg.ha<r.rg.ca)return-1;if(r.rg.ha<l.rg.ca)return 1;d=l.Iw?1:0;d|=r.Iw?2:0;return 0==d?this.PQ(l,r):1==d?this.TF(l.wb,r.wb):2==d?-1*this.TF(r.wb,l.wb):this.OQ(l.wb,r.wb)};return d}();
a.fE=d})(D||(D={}));(function(a){var b=function(){function b(b,d){this.a=b;this.ta=d;this.Ng=!1;this.vp=-1;this.rg=new a.Ac;this.wr=new a.b;this.wr.$c();this.Fe=new a.Hb;this.rn=-1;this.hB=1.7976931348623157E308}b.prototype.Gs=function(){this.Ng=!1;this.hB=1.7976931348623157E308};b.prototype.Yh=function(a){this.wr.L(a)};b.prototype.compare=function(a,d){return this.YF(d,a.ja(d))};b.prototype.YF=function(b,d){var h=null!=this.a.ic(d);h||(this.a.pd(d,this.Fe),this.rg.kC(this.Fe.ua,this.Fe.sa));if(h)throw a.g.X("not implemented");
if(this.wr.x+this.ta<this.rg.ca)return-1;if(this.wr.x-this.ta>this.rg.ha)return 1;if(this.Fe.ra==this.Fe.oa)return this.rn=b,this.Ng=!0,0;this.Fe.BJ();d=this.Fe.ec();h=new a.b;h.zc(this.Fe.Cc(),d);h.Ur();var l=new a.b;l.zc(this.wr,d);d=h.oi(l);d/=h.length();return d<10*-this.ta?-1:d>10*this.ta?1:this.Fe.mt(this.wr,this.ta)&&(h=Math.abs(d),h<this.hB&&(this.rn=b,this.hB=h),this.Ng=!0,h<.25*this.ta)?0:0>d?-1:1};return b}();a.aO=b})(D||(D={}));(function(a){function b(a,d,h,b){h=new Float64Array(a.subarray(h,
b));a.set(h,d)}var c=function(){function b(d){this.xa=this.Ce=!1;this.f=[];var h=d;2>h&&(h=2);this.f=a.J.gf(h,b.Bb);this.size=d}b.prototype.rotate=function(d,h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};b.zd=function(d,a){b.Bb=a;d=new b(d);b.Bb=0;return d};b.Bk=function(d){var a=new b(0);a.f=d.f.slice(0);a.size=d.size;return a};b.$=function(d,a){var h=new b(0);h.size=d.size;h.size>a&&(h.size=a);h.f=d.f.slice(0,
h.size);return h};b.prototype.yb=function(){};b.prototype.read=function(d){return this.f[d]};b.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};b.prototype.oX=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};b.prototype.get=function(d){return this.f[d]};b.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.set=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h.x;this.f[d+1]=h.y};b.prototype.add=
function(d){this.resize(this.size+1);this.f[this.size-1]=d};b.prototype.Tr=function(d){return b.$(this,d)};b.prototype.Of=function(d){return this.read(d)};b.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(a.J.truncate(5*d/4)<this.f.length){var b=this.f.slice(0,d);this.f=b}}else if(d>this.f.length){a.J.truncate(64>d?Math.max(2*d,4):5*d/4);for(var b=this.f.slice(0),l=this.f.length;l<d;l++)b[l]=
h;this.f=b}this.size=d};b.prototype.yf=function(d){(null==this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};b.prototype.Dm=function(d,a){this.write(d,a)};b.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.Zi(this.read(h));return d};b.prototype.Eb=function(d,a,l){if(null==d||!(d instanceof b))return!1;var h=this.size,r=d.size;if(l>h||l>r&&h!=r)return!1;for(l>h&&(l=h);a<l;a++)if(this.read(a)!=
d.read(a))return!1;return!0};b.prototype.Sq=function(d,h,b,l,c,e){if(this.xa)throw a.g.Da();0>e&&(e=this.size);this.size+2*l>this.f.length?this.resize(this.size+2*l):this.size+=2*l;e-=d;for(var r=this.f.slice(d,d+e),f=0;f<e;f++)this.f[d+2*l+f]=r[f];if(c)for(c=0;c<l;c++)e=h[b++],this.f[d++]=e.x,this.f[d++]=e.y;else for(c=0,r=l-1;c<l;++c)e=h[b+r],this.f[d++]=e.x,this.f[d++]=e.y,r--};b.prototype.Rk=function(d,h,b,l,c,e,f){if(this.xa)throw a.g.Da();if(!c&&(1>e||0!=l%e))throw a.g.F();var r=this.size-f;
r<l&&this.resize(this.size+l-r);for(r=0;r<f-d;r++)this.f[d+l+r]=this.f[d+r];this.f==h.f&&d<b&&(b+=l);if(c)for(r=0;r<l;r++)this.f[r+d]=h.f[b+r];else for(c=l,f=0;f<l;f+=e)for(c-=e,r=0;r<e;r++)this.f[d+f+r]=h.f[b+c+r]};b.prototype.Vj=function(d,h,b,l){if(this.xa)throw a.g.Da();l-=d;for(var r=this.f.slice(d,d+l),c=0;c<l;c++)this.f[d+b+c]=r[c];for(l=0;l<b;l++)this.f[d+l]=h};b.prototype.eh=function(d,h,b){if(this.xa)throw a.g.Da();for(var l=this.f.slice(d,d+(b-d)),r=0;r<b-d;r++)this.f[r+d+2]=l[r];this.f[d]=
h.x;this.f[d+1]=h.y};b.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),c)for(c=0;c<h;c++)this.f[d+c]=b[l+c];else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};b.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,
l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<h;c++){for(var r=0;r<e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};b.prototype.Fk=function(d,h,b){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();if(0<b-(d+h)){b-=d+h;for(var l=this.f.slice(d+h,d+b+h),r=0;r<b;r++)this.f[d+r]=l[r]}this.size-=h};b.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();for(var l=h>>1,r=0;r<l;r+=b){h-=b;for(var c=0;c<b;c++){var e=this.f[d+
r+c];this.f[d+r+c]=this.f[d+h+c];this.f[d+h+c]=e}}};b.prototype.Zh=function(d,h,b){if(0>h||0>b||0>h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=d};b.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b){for(var r=0;r<h;r++)this.f[d+r]=this.f[b+r];if(!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}}};b.prototype.ks=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<
1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};b.prototype.hy=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l][0],this.f[d+1]=b[l][1],d+=c};b.prototype.pl=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};b.prototype.Hx=function(d,h,b,l,c){if(0>d||0>h||0>
l||this.size<(h>>1)+d)throw a.g.F();if(0!=h)for(c||(d+=h-1),c=c?2:-2,h=l+h;l<h;l++)b[l][0]=this.f[d],b[l][1]=this.f[d+1],d+=c};b.prototype.clear=function(d){d?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(d,a,b){var h=this.f.slice(0,d),l=this.f.slice(a);d=this.f.slice(d,a).sort(b);this.f.length=0;this.f.push.apply(this.f,h.concat(d).concat(l))};b.prototype.si=function(){return 1};b.Bb=0;return b}();a.Rd=c;c=function(){function l(d){this.xa=this.Ce=
!1;this.f=null;var a=d;2>a&&(a=2);this.f=new Float64Array(a);this.size=d}l.prototype.rotate=function(d,h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};l.zd=function(d,a){var h=new l(d),b=h.f;2>d&&(d=2);if(0!==a)for(var c=0;c<d;c++)b[c]=a;return h};l.Bk=function(d){var a=new l(0);a.f=new Float64Array(d.f);a.size=d.size;return a};l.$=function(d,a){var h=new l(0);h.size=d.size;h.size>a&&(h.size=a);a=h.size;2>
a&&(a=2);h.f=new Float64Array(a);h.f.set(d.f.length<=a?d.f:d.f.subarray(0,a),0);return h};l.prototype.yb=function(d){0>=d||(null==this.f?this.f=new Float64Array(d):d<=this.f.length||(0<this.f.length?(d=new Float64Array(d),d.set(this.f),this.f=d):this.f=new Float64Array(d)))};l.prototype.read=function(d){return this.f[d]};l.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};l.prototype.get=function(d){return this.f[d]};l.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.set=
function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h.x;this.f[d+1]=h.y};l.prototype.add=function(d){this.resize(this.size+1);this.f[this.size-1]=d};l.prototype.Tr=function(d){return l.$(this,d)};l.prototype.Of=function(d){return this.read(d)};l.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(30<this.f.length&&5*d/4<this.f.length){var b=
new Float64Array(this.f,0,d);this.f=b}}else{d>this.f.length&&(b=a.J.truncate(64>d?Math.max(2*d,4):5*d/4),b=new Float64Array(b),b.set(this.f),this.f=b);for(var b=this.f,l=this.size;l<d;l++)b[l]=h}this.size=d};l.prototype.yf=function(d){(null==this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};l.prototype.Dm=function(d,a){this.write(d,a)};l.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.Zi(this.read(h));
return d};l.prototype.Eb=function(d,a,b){if(null==d||!(d instanceof l))return!1;var h=this.size,r=d.size;if(b>h||b>r&&h!=r)return!1;for(b>h&&(b=h);a<b;a++)if(this.read(a)!=d.read(a))return!1;return!0};l.prototype.Rk=function(d,h,l,c,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=c%f))throw a.g.F();var r=this.size-g;r<c&&this.resize(this.size+c-r);b(this.f,d+c,d,d+(g-d));this.f==h.f&&d<l&&(l+=c);if(e)this.f.set(h.f.subarray(l,l+c),d);else for(e=c,g=0;g<c;g+=f)for(e-=f,r=0;r<f;r++)this.f[d+g+r]=h.f[l+
e+r]};l.prototype.Sq=function(d,h,l,c,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*c>this.f.length?this.resize(this.size+2*c):this.size+=2*c;b(this.f,d+2*c,d,d+(f-d));if(e)for(e=0;e<c;e++)f=h[l++],this.f[d++]=f.x,this.f[d++]=f.y;else{e=0;for(var r=c-1;e<c;++e)f=h[l+r],this.f[d++]=f.x,this.f[d++]=f.y,r--}};l.prototype.Vj=function(d,h,l,c){if(this.xa)throw a.g.Da();c-=d;b(this.f,d+c,d,d+c);for(c=0;c<l;c++)this.f[d+c]=h};l.prototype.eh=function(d,h,l){if(this.xa)throw a.g.Da();b(this.f,
d+2,d,d+(l-d));this.f[d]=h.x;this.f[d+1]=h.y};l.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),c)this.f.set(b.subarray(l,h),d);else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};l.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=
b.f[l],d++,l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<h;c++){for(var r=0;r<e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};l.prototype.Fk=function(d,h,l){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();0<l-(d+h)&&b(this.f,d,d+h,d+(l-(d+h))+h);this.size-=h};l.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();for(var l=h>>1,r=0;r<l;r+=b){h-=b;for(var c=0;c<b;c++){var e=this.f[d+r+c];this.f[d+r+c]=this.f[d+
h+c];this.f[d+h+c]=e}}};l.prototype.Zh=function(d,h,b){if(0>h||0>b||0>h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=d};l.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b)if(this.f.set(this.f.subarray(b,b+h),d),!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(var r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}};l.prototype.ks=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=
c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};l.prototype.hy=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l][0],this.f[d+1]=b[l][1],d+=c};l.prototype.pl=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};l.prototype.Hx=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<(h>>1)+d)throw a.g.F();
if(0!=h)for(c||(d+=h-1),c=c?2:-2,h=l+h;l<h;l++)b[l][0]=this.f[d],b[l][1]=this.f[d+1],d+=c};l.prototype.clear=function(d){d?this.resize(0):this.yf(0)};l.prototype.Mp=function(){this.Ce=this.xa=!0};l.prototype.Gd=function(d,a,b){Array.prototype.sort.call(this.f.subarray(d,a),b)};l.prototype.si=function(){return 1};return l}();a.KL=c})(D||(D={}));!0===D.Xh.Bm&&!0===D.Xh.jw&&(D.Rd=D.KL);(function(a){function b(a,d,h,b){h=new Int32Array(a.subarray(h,b));a.set(h,d)}a.BZ=function(){return function(){this.random=
1973}}();var c=function(){function b(d){this.xa=this.Ce=!1;this.f=[];var h=d;2>h&&(h=2);this.f=this.f=a.J.gf(h,b.Bb);this.size=d}b.prototype.rotate=function(d,h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};b.zd=function(d,a){b.Bb=a;d=new b(d);b.Bb=0;return d};b.Bk=function(d){var a=new b(0);a.f=d.f.slice(0);a.size=d.size;return a};b.$=function(d,a){var h=new b(0);h.size=d.size;h.size>a&&(h.size=a);h.f=d.f.slice(0,
h.size);return h};b.prototype.yb=function(){};b.prototype.read=function(d){return this.f[d]};b.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};b.prototype.get=function(d){return this.f[d]};b.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.set=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h.x;this.f[d+1]=h.y};b.prototype.add=function(d){this.resize(this.size+1);this.f[this.size-1]=d};
b.prototype.Tr=function(d){return b.$(this,d)};b.prototype.Of=function(d){return this.read(d)};b.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(a.J.truncate(5*d/4)<this.f.length){var b=this.f.slice(0,d);this.f=b}}else if(d>this.f.length){a.J.truncate(64>d?Math.max(2*d,4):5*d/4);for(var b=this.f.slice(0),l=this.f.length;l<d;l++)b[l]=h;this.f=b}this.size=d};b.prototype.yf=function(d){(null==
this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};b.prototype.Dm=function(d,a){this.write(d,a)};b.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.dh(this.read(h),d);return d};b.prototype.Eb=function(d,a,l){if(null==d||!(d instanceof b))return!1;var h=this.size,r=d.size;if(l>h||l>r&&h!=r)return!1;for(l>h&&(l=h);a<l;a++)if(this.read(a)!=d.read(a))return!1;return!0};b.prototype.Rk=function(d,
h,b,l,c,e,f){if(this.xa)throw a.g.Da();if(!c&&(1>e||0!=l%e))throw a.g.F();for(var r=0;r<f-d;r++)this.f[d+l+r]=this.f[d+r];this.f==h.f&&d<b&&(b+=l);if(c)for(r=0;r<l;r++)this.f[r+d]=h.f[b+r];else for(c=l,f=0;f<l;f+=e)for(c-=e,r=0;r<e;r++)this.f[d+f+r]=h.f[b+c+r]};b.prototype.Sq=function(d,h,b,l,c,e){if(this.xa)throw a.g.Da();0>e&&(e=this.size);this.size+2*l>this.f.length?this.resize(this.size+2*l):this.size+=2*l;e-=d;for(var r=this.f.slice(d,d+e),f=0;f<e;f++)this.f[d+2*l+f]=r[f];if(c)for(c=0;c<l;c++)e=
h[b++],this.f[d++]=e.x,this.f[d++]=e.y;else for(c=0,r=l-1;c<l;++c)e=h[b+r],this.f[d++]=e.x,this.f[d++]=e.y,r--};b.prototype.Vj=function(d,h,b,l){if(this.xa)throw a.g.Da();l-=d;for(var r=this.f.slice(d,d+l),c=0;c<l;c++)this.f[d+b+c]=r[c];for(l=0;l<b;l++)this.f[d+l]=h};b.prototype.eh=function(d,h,b){if(this.xa)throw a.g.Da();for(var l=this.f.slice(d,d+(b-d)),r=0;r<b-d;r++)this.f[r+d+2]=l[r];this.f[d]=h.x;this.f[d+1]=h.y};b.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<
l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),c)for(c=0;c<h;c++)this.f[d+c]=b[l+c];else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};b.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<
h;c++){for(var r=0;r<e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};b.prototype.Fk=function(d,h,b){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();if(0<b-(d+h)){b-=d+h;for(var l=this.f.slice(d+h,d+b+h),r=0;r<b;r++)this.f[d+r]=l[r]}this.size-=h};b.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();for(var l=h>>1,r=0;r<l;r+=b){h-=b;for(var c=0;c<b;c++){var e=this.f[d+r+c];this.f[d+r+c]=this.f[d+h+c];this.f[d+h+c]=e}}};b.prototype.Zh=function(d,h,b){if(0>h||0>b||0>
h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=d};b.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b){for(var r=0;r<h;r++)this.f[d+r]=this.f[b+r];if(!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}}};b.prototype.ks=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};b.prototype.pl=
function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};b.prototype.clear=function(d){d?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(d,a,b){var h=this.f.slice(0,d),l=this.f.slice(a);d=this.f.slice(d,a).sort(b);this.f.length=0;this.f.push.apply(this.f,h.concat(d).concat(l))};b.prototype.si=function(){return 2};b.prototype.Fc=function(){return this.f[this.size-
1]};b.prototype.Pf=function(){this.resize(this.size-1)};b.prototype.CK=function(d){this.f[this.size-1]=d};b.prototype.HJ=function(d){d<this.size-1&&(this.f[d]=this.f[this.size-1]);this.resize(this.size-1)};b.prototype.Ov=function(d){for(var a=0,b=this.size;a<b;a++)if(this.f[a]==d)return a;return-1};b.prototype.nA=function(d){return 0<=this.Ov(d)};b.Bb=0;return b}();a.ia=c;c=function(){function l(d){this.xa=this.Ce=!1;this.f=null;var a=d;2>a&&(a=2);this.f=new Int32Array(a);this.size=d}l.prototype.rotate=
function(d,h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};l.zd=function(d,a){var h=new l(d),b=h.f;2>d&&(d=2);if(0!==a)for(var c=0;c<d;c++)b[c]=a;return h};l.Bk=function(d){var a=new l(0);a.f=new Int32Array(d.f);a.size=d.size;return a};l.$=function(d,a){var h=new l(0);h.size=d.size;h.size>a&&(h.size=a);a=h.size;2>a&&(a=2);h.f=new Int32Array(a);h.f.set(d.f.length<=a?d.f:d.f.subarray(0,a),0);return h};l.prototype.yb=
function(d){0>=d||(null==this.f?this.f=new Int32Array(d):d<=this.f.length||(0<this.f.length?(d=new Int32Array(d),d.set(this.f),this.f=d):this.f=new Int32Array(d)))};l.prototype.read=function(d){return this.f[d]};l.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};l.prototype.get=function(d){return this.f[d]};l.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.set=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();
this.f[d]=h.x;this.f[d+1]=h.y};l.prototype.add=function(d){this.resize(this.size+1);this.f[this.size-1]=d};l.prototype.Tr=function(d){return l.$(this,d)};l.prototype.Of=function(d){return this.read(d)};l.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(30<this.f.length&&5*d/4<this.f.length){var b=new Int32Array(this.f,0,d);this.f=b}}else{d>this.f.length&&(b=a.J.truncate(64>d?Math.max(2*d,
4):5*d/4),b=new Int32Array(b),b.set(this.f),this.f=b);for(var b=this.f,l=this.size;l<d;l++)b[l]=h}this.size=d};l.prototype.yf=function(d){(null==this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};l.prototype.Dm=function(d,a){this.write(d,a)};l.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.dh(this.read(h),d);return d};l.prototype.Eb=function(d,a,b){if(null==d||!(d instanceof l))return!1;
var h=this.size,c=d.size;if(b>h||b>c&&h!=c)return!1;for(b>h&&(b=h);a<b;a++)if(this.read(a)!=d.read(a))return!1;return!0};l.prototype.Rk=function(d,h,l,c,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=c%f))throw a.g.F();b(this.f,d+c,d,d+(g-d));this.f==h.f&&d<l&&(l+=c);if(e)this.f.set(h.f.subarray(l,l+c),d);else for(e=c,g=0;g<c;g+=f){e-=f;for(var r=0;r<f;r++)this.f[d+g+r]=h.f[l+e+r]}};l.prototype.Sq=function(d,h,l,c,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*c>this.f.length?this.resize(this.size+
2*c):this.size+=2*c;b(this.f,d+2*c,d,d+(f-d));if(e)for(e=0;e<c;e++)f=h[l++],this.f[d++]=f.x,this.f[d++]=f.y;else{e=0;for(var r=c-1;e<c;++e)f=h[l+r],this.f[d++]=f.x,this.f[d++]=f.y,r--}};l.prototype.Vj=function(d,h,l,c){if(this.xa)throw a.g.Da();c-=d;b(this.f,d+c,d,d+c);for(c=0;c<l;c++)this.f[d+c]=h};l.prototype.eh=function(d,h,l){if(this.xa)throw a.g.Da();b(this.f,d+2,d,d+(l-d));this.f[d]=h.x;this.f[d+1]=h.y};l.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<l+h)throw a.g.F();
if(0!=h)if(this.size<h+d&&this.resize(h+d),c)this.f.set(b.subarray(l,h),d);else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};l.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<h;c++){for(var r=0;r<
e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};l.prototype.Fk=function(d,h,l){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();0<l-(d+h)&&b(this.f,d,d+h,d+(l-(d+h))+h);this.size-=h};l.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();for(var l=h>>1,c=0;c<l;c+=b){h-=b;for(var r=0;r<b;r++){var e=this.f[d+c+r];this.f[d+c+r]=this.f[d+h+r];this.f[d+h+r]=e}}};l.prototype.Zh=function(d,h,b){if(0>h||0>b||0>h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=
d};l.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b)if(this.f.set(this.f.subarray(b,b+h),d),!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(var r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}};l.prototype.ks=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};l.prototype.pl=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();
if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};l.prototype.clear=function(d){d?this.resize(0):this.yf(0)};l.prototype.Mp=function(){this.Ce=this.xa=!0};l.prototype.Gd=function(d,a,b){10>a-d?l.ul(this.f,d,a,b):l.Oi(this.f,d,a-1,b)};l.prototype.si=function(){return 2};l.prototype.Fc=function(){return this.f[this.size-1]};l.prototype.Pf=function(){this.resize(this.size-1)};l.prototype.CK=function(d){this.f[this.size-1]=d};l.prototype.HJ=function(d){d<this.size-1&&
(this.f[d]=this.f[this.size-1]);this.resize(this.size-1)};l.prototype.Ov=function(d){for(var a=0,b=this.size;a<b;a++)if(this.f[a]==d)return a;return-1};l.prototype.nA=function(d){return 0<=this.Ov(d)};l.ul=function(d,a,b,l){for(var h=a;h<b;h++){for(var c=d[h],r=h-1;r>=a&&0<l(d[r],c);)d[r+1]=d[r],r--;d[r+1]=c}};l.Wg=function(d,a,b){var h=d[b];d[b]=d[a];d[a]=h};l.Oi=function(d,a,b,c){if(!(a>=b))for(;;){if(9>b-a){l.ul(d,a,b+1,c);break}var h=d[a];l.Wg(d,a,b);for(var r=a,e=a;e<b;e++)0>=c(d[e],h)&&(l.Wg(d,
r,e),r+=1);l.Wg(d,r,b);r-a<b-r?(l.Oi(d,a,r-1,c),a=r+1):(l.Oi(d,r+1,b,c),b=r-1)}};return l}();a.jy=c})(D||(D={}));!0===D.Xh.Bm&&(D.ia=D.jy);(function(a){function b(a,d,h,b){h=new Int8Array(a.subarray(h,b));a.set(h,d)}var c=function(){function b(d){this.xa=this.Ce=!1;this.f=[];var h=d;2>h&&(h=2);this.f=a.J.gf(h,b.Bb);this.size=d}b.prototype.rotate=function(d,h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};b.zd=
function(d,a){b.Bb=a;d=new b(d);b.Bb=0;return d};b.Bk=function(d){var a=new b(0);a.f=d.f.slice(0);a.size=d.size;return a};b.$=function(d,a){var h=new b(0);h.size=d.size;h.size>a&&(h.size=a);h.f=d.f.slice(0,h.size);return h};b.prototype.yb=function(){};b.prototype.read=function(d){return this.f[d]};b.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};b.prototype.get=function(d){return this.f[d]};b.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.set=function(d,
h){if(this.xa)throw a.g.Da();this.f[d]=h};b.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h.x;this.f[d+1]=h.y};b.prototype.add=function(d){this.resize(this.size+1);this.f[this.size-1]=d};b.prototype.Tr=function(d){return b.$(this,d)};b.prototype.Of=function(d){return this.read(d)};b.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(a.J.truncate(5*d/4)<this.f.length){var b=
this.f.slice(0,d);this.f=b}}else if(d>this.f.length){a.J.truncate(64>d?Math.max(2*d,4):5*d/4);for(var b=this.f.slice(0),l=this.f.length;l<d;l++)b[l]=h;this.f=b}this.size=d};b.prototype.yf=function(d){(null==this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};b.prototype.Dm=function(d,a){this.write(d,a)};b.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.dh(this.read(h),d);return d};b.prototype.Eb=
function(d,a,l){if(null==d||!(d instanceof b))return!1;var h=this.size,c=d.size;if(l>h||l>c&&h!=c)return!1;for(l>h&&(l=h);a<l;a++)if(this.read(a)!=d.read(a))return!1;return!0};b.prototype.Rk=function(d,h,b,l,c,e,f){if(this.xa)throw a.g.Da();if(!c&&(1>e||0!=l%e))throw a.g.F();for(var r=0;r<f-d;r++)this.f[d+l+r]=this.f[d+r];this.f==h.f&&d<b&&(b+=l);if(c)for(r=0;r<l;r++)this.f[r+d]=h.f[b+r];else for(c=l,f=0;f<l;f+=e)for(c-=e,r=0;r<e;r++)this.f[d+f+r]=h.f[b+c+r]};b.prototype.Sq=function(d,h,b,l,c,e){if(this.xa)throw a.g.Da();
0>e&&(e=this.size);this.size+2*l>this.f.length?this.resize(this.size+2*l):this.size+=2*l;e-=d;for(var r=this.f.slice(d,d+e),f=0;f<e;f++)this.f[d+2*l+f]=r[f];if(c)for(c=0;c<l;c++)e=h[b++],this.f[d++]=e.x,this.f[d++]=e.y;else for(c=0,r=l-1;c<l;++c)e=h[b+r],this.f[d++]=e.x,this.f[d++]=e.y,r--};b.prototype.Vj=function(d,h,b,l){if(this.xa)throw a.g.Da();l-=d;for(var c=this.f.slice(d,d+l),r=0;r<l;r++)this.f[d+b+r]=c[r];for(l=0;l<b;l++)this.f[d+l]=h};b.prototype.eh=function(d,h,b){if(this.xa)throw a.g.Da();
for(var l=this.f.slice(d,d+(b-d)),c=0;c<b-d;c++)this.f[c+d+2]=l[c];this.f[d]=h.x;this.f[d+1]=h.y};b.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),c)for(c=0;c<h;c++)this.f[d+c]=b[l+c];else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};b.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+
d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<h;c++){for(var r=0;r<e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};b.prototype.Fk=function(d,h,b){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();if(0<b-(d+h)){b-=d+h;for(var l=this.f.slice(d+h,d+b+h),c=0;c<b;c++)this.f[d+c]=l[c]}this.size-=h};b.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();
for(var l=h>>1,c=0;c<l;c+=b){h-=b;for(var r=0;r<b;r++){var e=this.f[d+c+r];this.f[d+c+r]=this.f[d+h+r];this.f[d+h+r]=e}}};b.prototype.Zh=function(d,h,b){if(0>h||0>b||0>h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=d};b.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b){for(var r=0;r<h;r++)this.f[d+r]=this.f[b+r];if(!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}}};b.prototype.ks=function(d,h,b,l,c){if(0>
d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};b.prototype.pl=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};b.prototype.clear=function(d){d?this.resize(0):this.yf(0)};b.prototype.Mp=function(){this.Ce=this.xa=!0};b.prototype.Gd=function(d,a,b){var h=this.f.slice(0,d),l=this.f.slice(a);
d=this.f.slice(d,a).sort(b);this.f.length=0;this.f.push.apply(this.f,h.concat(d).concat(l))};b.prototype.si=function(){return 1};b.prototype.iC=function(d,h){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[d]|=h};b.prototype.fz=function(d,h){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[d]&=~h};b.Bb=0;return b}();a.Fm=c;c=function(){function l(d){this.f=null;var a=d;2>a&&(a=2);this.f=new Int8Array(a);this.size=d}l.prototype.rotate=function(d,
h,b){if(this.xa)throw a.g.X("invalid_call");if(h<d||h>b||d>b)throw a.g.F();d!=h&&b!=h&&(this.Zd(d,h-d,1),this.Zd(h,b-h,1),this.Zd(d,b-d,1))};l.zd=function(d,a){var h=new l(d),b=h.f;2>d&&(d=2);if(0!==a)for(var c=0;c<d;c++)b[c]=a;return h};l.Bk=function(d){var a=new l(0);a.f=new Int8Array(d.f);a.size=d.size;return a};l.$=function(d,a){var h=new l(0);h.size=d.size;h.size>a&&(h.size=a);a=h.size;2>a&&(a=2);h.f=new Int8Array(a);h.f.set(d.f.length<=a?d.f:d.f.subarray(0,a),0);return h};l.prototype.yb=function(d){0>=
d||(null==this.f?this.f=new Int8Array(d):d<=this.f.length||(0<this.f.length?(d=new Int8Array(d),d.set(this.f),this.f=d):this.f=new Int8Array(d)))};l.prototype.read=function(d){return this.f[d]};l.prototype.fc=function(d,a){a.x=this.f[d];a.y=this.f[d+1]};l.prototype.get=function(d){return this.f[d]};l.prototype.write=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.set=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=h};l.prototype.fo=function(d,h){if(this.xa)throw a.g.Da();this.f[d]=
h.x;this.f[d+1]=h.y};l.prototype.add=function(d){this.resize(this.size+1);this.f[this.size-1]=d};l.prototype.Tr=function(d){return l.$(this,d)};l.prototype.Of=function(d){return this.read(d)};l.prototype.resize=function(d,h){void 0===h&&(h=0);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");if(d<=this.size){if(30<this.f.length&&5*d/4<this.f.length){var b=new Int8Array(this.f,0,d);this.f=b}}else{d>this.f.length&&(b=a.J.truncate(64>d?Math.max(2*d,4):5*d/4),b=
new Int8Array(b),b.set(this.f),this.f=b);for(var b=this.f,l=this.size;l<d;l++)b[l]=h}this.size=d};l.prototype.yf=function(d){(null==this.f||d>this.f.length)&&this.resize(d);if(this.Ce)throw a.g.X("invalid call. Attribute Stream is locked and cannot be resized.");this.size=d};l.prototype.Dm=function(d,a){this.write(d,a)};l.prototype.Ak=function(d,h,b){for(var l=this.size;h<l&&h<b;h++)d=a.J.dh(this.read(h),d);return d};l.prototype.Eb=function(d,a,b){if(null==d||!(d instanceof l))return!1;var h=this.size,
c=d.size;if(b>h||b>c&&h!=c)return!1;for(b>h&&(b=h);a<b;a++)if(this.read(a)!=d.read(a))return!1;return!0};l.prototype.Rk=function(d,h,l,c,e,f,g){if(this.xa)throw a.g.Da();if(!e&&(1>f||0!=c%f))throw a.g.F();b(this.f,d+c,d,d+(g-d));this.f==h.f&&d<l&&(l+=c);if(e)this.f.set(h.f.subarray(l,l+c),d);else for(e=c,g=0;g<c;g+=f){e-=f;for(var r=0;r<f;r++)this.f[d+g+r]=h.f[l+e+r]}};l.prototype.Vj=function(d,h,l,c){if(this.xa)throw a.g.Da();c-=d;b(this.f,d+c,d,d+c);for(c=0;c<l;c++)this.f[d+c]=h};l.prototype.Sq=
function(d,h,l,c,e,f){if(this.xa)throw a.g.Da();0>f&&(f=this.size);this.size+2*c>this.f.length?this.resize(this.size+2*c):this.size+=2*c;b(this.f,d+2*c,d,d+(f-d));if(e)for(e=0;e<c;e++)f=h[l++],this.f[d++]=f.x,this.f[d++]=f.y;else{e=0;for(var r=c-1;e<c;++e)f=h[l+r],this.f[d++]=f.x,this.f[d++]=f.y,r--}};l.prototype.eh=function(d,h,l){if(this.xa)throw a.g.Da();b(this.f,d+2,d,d+(l-d));this.f[d]=h.x;this.f[d+1]=h.y};l.prototype.js=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(b.length<l+h)throw a.g.F();
if(0!=h)if(this.size<h+d&&this.resize(h+d),c)this.f.set(b.subarray(l,h),d);else for(c||(d+=h-1),h=l+h;l<h;l++)this.f[d]=b[l],d--};l.prototype.ho=function(d,h,b,l,c,e){if(0>d||0>h||0>l)throw a.g.F();if(!c&&(0>=e||0!=h%e))throw a.g.F();if(b.size<l+h)throw a.g.F();if(0!=h)if(this.size<h+d&&this.resize(h+d),b==this)this.Ij(d,h,l,c,e);else if(c)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l++;else if(l=l+h-e,1==e)for(c=0;c<h;c++)this.f[d]=b.f[l],d++,l--;else for(c=0,h=a.J.truncate(h/e);c<h;c++){for(var r=0;r<
e;r++)this.f[d+r]=b.f[l+r];d+=e;l-=e}};l.prototype.Fk=function(d,h,l){if(this.xa)throw a.g.Da();if(d+h>this.size)throw a.g.Da();0<l-(d+h)&&b(this.f,d,d+h,d+(l-(d+h))+h);this.size-=h};l.prototype.Zd=function(d,h,b){if(this.xa)throw a.g.Da();if(1>b||0!=h%b)throw a.g.Da();for(var l=h>>1,c=0;c<l;c+=b){h-=b;for(var r=0;r<b;r++){var e=this.f[d+c+r];this.f[d+c+r]=this.f[d+h+r];this.f[d+h+r]=e}}};l.prototype.Zh=function(d,h,b){if(0>h||0>b||0>h||b+h>this.size)throw a.g.F();for(var l=h;l<h+b;l++)this.f[l]=
d};l.prototype.Ij=function(d,h,b,l,c){if(!l||d!=b)if(this.f.set(this.f.subarray(b,b+h),d),!l)for(b=d,d=d+h-c,l=0,h=a.J.truncate(h/2);l<h;l++){for(var r=0;r<c;r++){var e=this.f[b+r];this.f[b+r]=this.f[d+r];this.f[d+r]=e}b+=c;d-=c}};l.prototype.ks=function(d,h,b,l,c){if(0>d||0>h||0>l)throw a.g.F();if(0!=h)for(this.size<(h<<1)+d&&this.resize((h<<1)+d),c||(d+=h-1<<1),c=c?2:-2,h+=l;l<h;l++)this.f[d]=b[l].x,this.f[d+1]=b[l].y,d+=c};l.prototype.pl=function(d,h,b,l,c){if(0>d||0>h||0>l||this.size<h+d)throw a.g.F();
if(c)for(c=0;c<h;c++)b[l+c]=this.f[d+c];else for(l=l+h-1;d<h;d++)b[l]=this.f[d],l--};l.prototype.clear=function(d){d?this.resize(0):this.yf(0)};l.prototype.Mp=function(){this.Ce=this.xa=!0};l.prototype.Gd=function(d,a,b){a=this.f.subarray(d,a);Array.prototype.sort.call(a,b);this.f.set(a,d)};l.prototype.iC=function(d,h){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");this.f[d]|=h};l.prototype.fz=function(d,h){if(this.xa)throw a.g.X("invalid call. Attribute Stream is read only.");
this.f[d]&=~h};l.prototype.si=function(){return 1};return l}();a.ky=c})(D||(D={}));!0===D.Xh.Bm&&(D.Fm=D.ky);(function(a){var b=function(){function b(){}b.vq=function(b,d){return a.Fm.zd(b,d)};b.Um=function(b,d){return a.Rd.zd(b,d)};b.pz=function(b,d,h){switch(b){case 1:b=a.Rd.zd(d,h);break;case 2:b=a.ia.zd(d,h);break;case 4:b=a.Fm.zd(d,h);break;default:throw a.g.za();}return b};b.qz=function(l,d){return b.pz(a.ma.si(l),d*a.ma.Xa(l),a.ma.de(l))};b.wh=function(b,d){return a.ia.zd(b,d)};b.IB=function(a){var d,
h=[];for(d=0;d<a;d++)h.push(null);return h};return b}();a.Uc=b})(D||(D={}));(function(a){var b=function(){function b(){}b.vq=function(b,d){return a.ky.zd(b,d)};b.Um=function(b,d){return a.Rd.zd(b,d)};b.pz=function(b,d,h){switch(b){case 1:b=a.Rd.zd(d,h);break;case 2:b=a.jy.zd(d,h);break;case 4:b=a.ky.zd(d,h);break;default:throw a.g.za();}return b};b.qz=function(b,d){return a.Uc.pz(a.ma.si(b),d*a.ma.Xa(b),a.ma.de(b))};b.wh=function(b,d){return a.jy.zd(b,d)};b.IB=function(a){var d,h=[];for(d=0;d<a;d++)h.push(null);
return h};return b}();a.LL=b})(D||(D={}));!0===D.Xh.Bm&&(D.Uc=D.LL);(function(a){a.ea=function(){return function(a){void 0===a&&(a=0);this.j=a}}()})(D||(D={}));(function(a){var b=function(){function b(){}b.bind=function(l){a.Vc=l.PeDefs;a.Tf=l.PeFactory;a.QD=l.PeVertcs;a.ND=l.PeCoordsys;a.fi=l.PeCSTransformations;a.PD=l.PeGTTransformations;a.yN=l.PeGeogtran;a.xN=l.PeFactoryCodechange;a.OD=l.PeGCSExtent;a.Bg=l.PePCSInfo;a.zN=l.PeHorizon;a.ND=l.PeCoordsys;a.fq=l.PeGTlistExtended;a.fq.PE_GTLIST_OPTS_USE_DEFAULT=
128;a.Tf.initialize(null);a.wy=l.PeGTlistExtendedEntry;b.QY=a.Tf.fromString(a.Vc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')};b.w_=function(){};b.QY=null;return b}();a.AN=b;a.Tf=null;a.QD=null;a.ND=null;a.zN=null;a.Bg=null;a.fq=null;a.wy=null;a.OD=null;a.xN=null;a.yN=null;a.Vc=null;a.PD=null;a.fi=null})(D||(D={}));(function(a){var b=function(){function a(){}a.Ab=function(d,h){return 0<=h?a.K(d):-a.K(d)};a.K=function(d){return 0>d?-d:d};a.Qi=function(d){return 3.552713678800501E-15>d};a.MD=function(d,h,b){return a.K(d-
h)<=b*(1+(a.K(d)+a.K(h))/2)};a.W=function(d,h){return a.MD(d,h,3.552713678800501E-15)};a.jW=function(d){return 3.552713678800501E-15>=a.K(d)};a.xd=function(d){return a.jW(d)};return a}();a.l=b;var c=function(){function l(){}l.Sp=function(d,a){d=b.K(d);a=b.K(a);var h=0;0!=d+a&&(d>a?(h=a/d,h=d*Math.sqrt(1+h*h)):(h=d/a,h=a*Math.sqrt(1+h*h)));return h};l.Or=function(d,a,c,e,f){for(var h=[0,0,0],r=[0,0,0],g=0;2>=g;g++)a[g]-=d[g],c[g]-=a[g];c=h[1]*r[2]-h[2]*r[1];a=h[2]*r[0]-h[0]*r[2];h=h[0]*r[1]-h[1]*r[0];
d=-1*(c*d[0]+a*d[1]+h*d[2]);e[0]=c;e[1]=a;e[2]=h;e[3]=d;r=l.eo(e);e[0]/=r;e[1]/=r;e[2]/=r;e[3]/=r;0!=f&&(r=b.xd(h)?b.xd(d)?b.Ab(1,a):-b.Ab(1,d):b.Ab(1,h),r*=b.Ab(1,f),e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r)};l.fy=function(d,a,b){b[0]=d[1]*a[2]-a[1]*d[2];b[1]=d[2]*a[0]-a[2]*d[0];b[2]=d[0]*a[1]-a[0]*d[1]};l.Eu=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]};l.eo=function(d){return l.Sp(l.Sp(d[0],d[1]),d[2])};l.Dk=function(d,a,b,c,e,f,g,k){d=l.n(d,a,b);var h=Math.cos(b);f.j=(d+e)*h*Math.cos(c);g.j=(d+e)*
h*Math.sin(c);k.j=(d*(1-a)+e)*Math.sin(b)};l.jQ=function(d,a,c,e,f,g,k){var h=l.Sp(a,c),r=1*Math.sqrt(1-d),y=r/1;if(b.W(h,0))g.j=0,f.j=b.Ab(1.570796326794897,e),k.j=b.K(e)-r;else{g.j=Math.atan2(c,a);c=Math.atan2(1*e,r*h);g=Math.cos(c);var A=Math.sin(c);a=r*d/(1-d);d*=1;c=Math.atan2(e+a*A*A*A,h-d*g*g*g);3.141592653589793<b.K(c)&&(c=b.Ab(3.141592653589793,c)-c);c=Math.atan(y*Math.tan(c));A=Math.sin(c);g=Math.cos(c);f.j=Math.atan2(e+a*A*A*A,h-d*g*g*g);1.570796326794897<b.K(f.j)&&(f.j=b.Ab(3.141592653589793,
f.j)-f.j);c=Math.atan(y*Math.tan(f.j));A=Math.sin(c);g=Math.cos(c);k.j=(e-r*A)*Math.sin(f.j)+(h-1*g)*Math.cos(f.j)}};l.n=function(d,a,b){b=Math.sin(b);return d/Math.sqrt(1-a*b*b)};l.du=function(d,a){return Math.atan2(Math.sin(a)*(1-d),Math.cos(a))};l.ik=function(d,a){return Math.atan2(Math.sin(a),Math.cos(a)*(1-d))};l.xp=function(d,a){if(b.Qi(d)||0==a||b.W(b.K(a),1.570796326794897))return a;var h,c,e,f,g,k,A,m,q;if(.006884661117170036>d){f=Math.sqrt(1-d);g=(1-f)/(1+f);k=g*g;A=g*k;m=g*A;h=g*m;q=g*
h;c=g*q;e=1.572916666666667*A-3.2578125*h+4.295068359375*c;f=2.142578125*m-6.071484375*q;d=3.129296875*h-11.249837239583334*c;var n=4.775276692708333*q,w=7.958636765252976*c,x=Math.cos(2*a);return a+Math.sin(2*a)*(1.5*g-.84375*A+.525390625*h-.2688395182291667*c-e+d-w+x*(2*(1.3125*k-1.71875*m+1.650146484375*q)-4*f+6*n+x*(4*e-12*d+24*w+x*(8*f-32*n+x*(16*d-80*w+x*(32*n+64*x*w))))))}f=1-d;g=d/2;k=b.K(a);A=k*l.Tu(d)/(1.570796326794897*f);m=9999;q=k;for(k=0;1E-16<m&&50>k;k++)c=l.Cm(d,q),h=(l.EG(q,d)-g*
Math.sin(2*q)/c)/f-A,c=1/(c*c*c),e=h/c,h=q-e,m=b.K(e),q=h;return 0<=a?q:-q};l.pX=function(d,a){return b.Qi(a)?d:d*l.Tu(a)/1.570796326794897};l.da=function(d){d=l.qG(d,6.283185307179586);return 0>d?d+6.283185307179586:3.141592653589793>b.K(d)||b.W(b.K(d),3.141592653589793)?d:d-6.283185307179586};l.qG=function(d,a){return d-Math.floor(d/a)*a};l.Yg=function(d,a){if(.006884661117170036>a){a=Math.sqrt(1-a);a=(1-a)/(1+a);var h=a*a,b=h*h;return d/(1+a)*(1+.25*h+.015625*b+.00390625*h*b)*1.570796326794897}return d*
l.Tu(a)};l.Nr=function(d,a){var h=b.Ab(1,Math.sin(a));a=b.K(l.qG(a,3.141592653589793));a=1.570796326794897>=a?a:3.141592653589793-a;var c;b.W(a,1.570796326794897)?c=a:c=Math.atan(Math.sqrt(1-d)*Math.tan(a));return c*h};l.q=function(d,a,b){if(.006884661117170036>a){a=Math.sqrt(1-a);a=(1-a)/(1+a);var h=a*a,c=a*h,r=a*c,e=a*r,f=a*e,g=a*f,k=-.7291666666666666*c+.2278645833333333*e+.03987630208333334*g,A=.615234375*r-.21533203125*f,m=-.54140625*e+.20302734375*g,q=.48876953125*f,n=-.4488699776785715*g,w=
Math.cos(2*b);return d/(1+a)*((1+.25*h+.015625*r+.00390625*f)*b+Math.sin(2*b)*(-1.5*a+.1875*c+.0234375*e+.00732421875*g-k+m-n+w*(2*(.9375*h-.234375*r-.03662109375*f)-4*A+6*q+w*(4*k-12*m+24*n+w*(8*A-32*q+w*(16*m-80*n+w*(32*q+64*w*n)))))))}return d*(l.EG(b,a)-.5*a*Math.sin(2*b)/l.Cm(a,b))};l.Cm=function(d,a){a=Math.sin(a);return Math.sqrt(1-d*a*a)};l.Tu=function(d){return b.MD(d,1,2.220446049250313E-16)?1:1>d?l.Lv(0,1-d)-d/3*l.Iv(0,1-d):NaN};l.EG=function(d,h){var c=b.Ab(1,d);d=b.K(d);var e=Math.floor(d/
1.570796326794897),f;if(1<h)f=0==d?0:NaN;else if(b.xd(e))f=l.sin(d),f=f*l.Lv(1-f*f,1-h*f*f)-h/3*f*f*f*l.Iv(1-f*f,1-h*f*f);else{f=a.J.truncate(e%2);var g=l.Tu(h);0<f?(f=Math.sin(1.570796326794897*(e+1)-d),f=f*l.Lv(1-f*f,1-h*f*f)-h/3*f*f*f*l.Iv(1-f*f,1-h*f*f),f=g*(e+1)-f):(f=Math.sin(d-1.570796326794897*e),f=f*l.Lv(1-f*f,1-h*f*f)-h/3*f*f*f*l.Iv(1-f*f,1-h*f*f),f=g*e+f)}return f*c};l.sin=function(d){d=l.da(d);var a=b.Ab(1,d);d=b.K(d);return b.W(d,3.141592653589793)?0:b.W(d,1.570796326794897)?1*a:Math.sin(d)*
a};l.Iv=function(d,a){for(var h=1,l=0,c=1,e,f,g,k;;){e=.2*(d+a+3*h);f=(e-d)/e;g=(e-a)/e;k=(e-h)/e;if(1E-4>b.K(f)&&1E-4>b.K(g)&&1E-4>b.K(k))break;k=Math.sqrt(a);e=Math.sqrt(h);k=Math.sqrt(d)*(k+e)+k*e;l+=c/(e*(h+k));c*=.25;d=.25*(d+k);a=.25*(a+k);h=.25*(h+k)}d=f*g;h=k*k;a=d-h;h=d-6*h;f=h+a+a;return 3*l+c*(1+h*(-.2142857142857143+.10227272727272728*h-.1730769230769231*k*f)+k*(.1666666666666667*f+k*(-.4090909090909091*a+.1153846153846154*k*d)))/(e*Math.sqrt(e))};l.Lv=function(d,a){for(var h,l,c,e,f=
1;;f=.25*(f+h)){h=(d+a+f)/3;l=2-(h+d)/h;c=2-(h+a)/h;e=2-(h+f)/h;if(1E-4>b.K(l)&&1E-4>b.K(c)&&1E-4>b.K(e))break;h=Math.sqrt(a);l=Math.sqrt(f);h=Math.sqrt(d)*(h+l)+h*l;d=.25*(d+h);a=.25*(a+h)}d=l*c-e*e;a=l*c*e;return(1+(.04166666666666666*d-.1-.06818181818181818*a)*d+.07142857142857142*a)/Math.sqrt(h)};l.Cx=function(d,a){if(b.Qi(d)||0==a||b.W(b.K(a),1.570796326794897))return a;var h,l,c;if(.006884661117170036>d){h=d*d;l=d*h;c=d*l;var e=d*c,f=d*e,g=d*f,k=-(.02708333333333333*l+.03430059523809524*c+.03149181547619048*
e+.02634359154541446*f+.02156896735835538*g),A=.007669890873015873*c+.01299603174603175*e+.0148051353064374*f+.01454454953803912*g,m=-(.002275545634920635*e+.004830845032667949*f+.006558395368616723*g),q=6.957236677288761E-4*f+.001775193002406544*g,n=-(2.17324089394402E-4*g),w=Math.cos(2*a);return a+Math.sin(2*a)*(-(.5*d+.2083333333333333*h+.09375*l+.04878472222222222*c+.02916666666666667*e+.01938905423280423*f+.01388255931712963*g)-k+m-n+w*(2*(.1041666666666667*h+.0875*l+.06050347222222222*c+.04151785714285714*
e+.02958958540013228*f+.02203667534722222*g)-4*A+6*q+w*(4*k-12*m+24*n+w*(8*A-32*q+w*(16*m-80*n+w*(32*q+64*w*n))))))}0==a||b.W(b.K(a),1.570796326794897)?h=a:(l=Math.sqrt(d),c=l*Math.sin(a),h=Math.tan(.7853981633974483+a/2)*Math.pow((1-c)/(1+c),l/2),h=2*Math.atan(h)-1.570796326794897);return h};l.BQ=function(d,a){if(b.Qi(d)||0==a||b.W(b.K(a),1.570796326794897))return a;var h,l;if(.006884661117170036>d){w=d*d;m=d*w;q=d*m;h=d*q;n=d*h;l=d*n;var c=.05833333333333333*m+.07232142857142858*q+.05634300595238095*
h+.0355325796406526*n+.020235546186067*l,e=.02653149801587302*q+.04379960317460317*h+.0429211791776896*n+.03255384637546096*l,f=.01294022817460318*h+.02668104344536636*n+.03155651254609588*l,g=.00659454790965208*n+.0163075268674227*l,k=.003463473736911237*l,A=Math.cos(2*a);return a+Math.sin(2*a)*(.5*d+.2083333333333333*w+.08333333333333333*m+.03611111111111111*q+.01875*h+.01195601851851852*n+.008863673941798942*l-c+f-k+A*(2*(.1458333333333333*w+.1208333333333333*m+.07039930555555556*q+.03616071428571429*
h+.01839451058201058*n+.01017113095238095*l)-4*e+6*g+A*(4*c-12*f+24*k+A*(8*e-32*g+A*(16*f-80*k+A*(32*g+64*A*k))))))}for(var m=Math.sqrt(d),q=m/2,n=Math.tan(.7853981633974483+a/2),c=0,e=1,w=a;0!=e;w=l)if(h=m*Math.sin(w),l=n*Math.pow((1+h)/(1-h),q),l=2*Math.atan(l)-1.570796326794897,c++,b.W(l,w)||3E4<c)e=0;return w};return l}();a.C=c})(D||(D={}));(function(a){var b=function(){function b(b){this.Zl=this.Pt=null;this.vw=!1;this.mB=this.nB=0;this.kB=new a.b;this.xB=new a.b;this.ix=!1;this.kr=new a.h;this.II=
this.fx=0;this.gx=null;this.al=!1;this.Fr=null;this.KA=0;this.uf=b;this.wt=a.Ib.iw(this.uf,0,!0);this.kB.$c();this.xB.$c();this.eJ=NaN;var d=b.getCode();0<d?(this.ll=d,a.Tf.getCode(b)):this.ll=a.Tf.getCode(b);0>this.ll&&(this.ll=0);var h=this.uf.getType();this.vI=h==a.Vc.PE_TYPE_PROJCS?2:1;if(h==a.Vc.PE_TYPE_PROJCS&&!b.loadConstants())throw a.g.F("PeProjcs.loadConstants failed");d=h==a.Vc.PE_TYPE_GEOGCS?this.uf:this.uf.getGeogcs();h!=a.Vc.PE_TYPE_GEOGCS&&a.Tf.getCode(d);this.Fr=b.getUnit();this.eJ=
d.getPrimem().getLongitude();this.II=b=d.getUnit().getUnitFactor();b=Math.PI/(180*b);1E-10>Math.abs(b-1)&&(b=1);this.mB=b;0!=(h&a.Vc.PE_TYPE_PROJCS)?(d=this.uf,this.nB=1/d.getUnit().getUnitFactor(),this.fx=.001/this.uf.getUnit().getUnitFactor(),this.gx=a.Bg.generate(d,a.Bg.PE_PCSINFO_OPTION_NONE),this.al=this.gx.isPannableRectangle(),this.KA=a.Ib.qP(this.gx.getCentralMeridian(),this.mB)):(this.ix=this.al=!0,this.nB=0,h=1/d.getUnit().getUnitFactor(),this.fx=.001/d.getDatum().getSpheroid().getAxis()*
h,this.KA=0);this.al&&(this.dy(),this.uL(),this.vL(),this.tL(),this.iZ(),this.jZ())}b.prototype.$s=function(){return this.ll};b.prototype.Sj=function(){return this.gx};b.zz=function(a,d){return a==d?!0:null!=a&&null!=d&&0==a.ll&&0==d.ll?a.wt===d.wt:!1};b.prototype.Jc=function(){return this.al};b.prototype.Bh=function(a){a.I(this.gp)};b.prototype.bw=function(){return this.gp.o};b.prototype.aw=function(){return this.gp.v};b.prototype.zT=function(a){a.I(this.hx)};b.prototype.iZ=function(){var b=this.uf.getType();
if(b==a.Vc.PE_TYPE_PROJCS){var b=this.uf,d=this.Sj().getCentralMeridian(),h=b.getGeogcs();if(null==h)throw a.g.X("internal error");h=1/h.getUnit().getUnitFactor()*Math.PI;d=[[d+h,0]];a.fi.geogToProj(b,1,d);var d=d[0][0],h=b.getParameters()[a.Vc.PE_PARM_X0].getValue(),c=this.Mk(),b=new a.h;c.s(b);var c=Math.abs(d-h),d=c+h,h=-1*c+h,c=b.B,b=b.A,e=new a.h;e.I(h,b,d,c);null==this.gp&&(this.gp=e)}else if(b==a.Vc.PE_TYPE_GEOGCS)h=1/this.uf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-h,-h/2,h,h/2),null==
this.gp&&(this.gp=b);else throw a.g.X("internal error");};b.prototype.jZ=function(){var b=this.uf.getType();if(b==a.Vc.PE_TYPE_PROJCS){var d=this.uf,b=this.Sj().getCentralMeridian(),d=d.getGeogcs();if(null==d)throw a.g.X("internal error");var d=1/d.getUnit().getUnitFactor()*Math.PI,h=this.Vs(),c=new a.h;h.s(c);h=new a.h;h.I(b-d,c.A,b+d,c.B);null==this.hx&&(this.hx=h)}else if(b==a.Vc.PE_TYPE_GEOGCS)d=1/this.uf.getUnit().getUnitFactor()*Math.PI,b=new a.h,b.I(-d,-d/2,d,d/2),null==this.hx&&(this.hx=b);
else throw a.g.X("internal error");};b.prototype.ee=function(){return this.mB};b.prototype.bn=function(){return this.nB};b.prototype.Vs=function(){if(this.al)return this.Zl;var a=this.Zl;if(null!=a)return a;this.dy();return this.Zl};b.prototype.Ws=function(){if(this.al)return null;if(null!=this.Zl)return this.hI;this.dy();return this.hI};b.prototype.dy=function(){if(this.uf.getType()==a.Vc.PE_TYPE_PROJCS){var b;b=this.uf;var d=b.getGeogcs(),h=b.horizonGcsGenerate();if(null!=h){var c=h[0].getNump(),
e=h[0].getKind();b=0<h[0].getInclusive();var f=this.ee(),g=90*f,k=360*f,A=370*f,m=180*f*a.Vc.PE_HORIZON_DELTA/Math.PI,q=new a.h,n=null;if(1<c)for(var w=1;w<c;w++)if(h[w].getKind()==a.Vc.PE_HORIZON_LINE){null==n&&(n=new a.Ua);var x=h[w].getCoord();n.$x(x[0][0],x[0][1]);n.Xj(x[1][0],x[1][1])}if(e==a.Vc.PE_HORIZON_RECT)h=h[0].getCoord(),q.I(h[0][0],h[0][1]),q.Nb(h[1][0],h[1][1]),Math.abs(q.B-g)<1E-7*m&&(q.B=g),Math.abs(q.A+g)<1E-7*m&&(q.A=-g),q.N()>A&&(h=-400*f,q.I(h,q.A,h+5*k,q.B)),h=new a.ci(q),null==
this.Zl&&(this.Zl=h,this.vw=b);else{A=new a.Ja;k=this.Sj().isGcsHorizonMultiOverlap();q=a.Ou.iG(d,a.ts.Integer64);if(k){A=new a.QM;m=a.ei.local().V(A,q,null);for(w=0;w<c;w++)if(h[w].getKind()==a.Vc.PE_HORIZON_POLY){d=h[w].getSize();f=h[w].getCoord();e=[];for(g=0;g<d;g++)e[g]=a.b.pa(f[g][0],f[g][1]);h[w].getInclusive();k&&(f=new a.Ja,f.Bl(e,d-1),A.SY(f),m.Re())}A=m.next()}else for(w=0;w<c;w++)if(h[w].getKind()==a.Vc.PE_HORIZON_POLY){d=h[w].getSize();f=h[w].getCoord();k=[];for(g=0;g<d;g++)k[g]=a.b.pa(f[g][0],
f[g][1]);h[w].getInclusive();A.Bl(k,d-1)}b?a.tk.local().qo(A,q,1):a.cq.local().qo(A,q,1);a.Gj.local().qo(A,q,1);null==this.Zl&&(this.Zl=A,this.vw=b,this.hI=n)}}}};b.prototype.Uv=function(){if(this.al)return this.vw;null==this.Zl&&this.dy();return this.vw};b.prototype.uL=function(){if(2==this.vI){var b=this.uf.horizonPcsGenerate();if(null!=b){var d=b[0].getKind();b[0].getInclusive();var h=b[0].getNump(),c=!1;if(d==a.Vc.PE_HORIZON_RECT)b=b[0].getCoord(),h=new a.h,h.I(b[0][0],b[0][1]),h.Nb(b[1][0],b[1][1]),
b=new a.ci(h);else{d=-1;for(c=0;c<h;c++)b[c].getKind()==a.Vc.PE_HORIZON_POLY&&(d=c);c=b[d].getSize()-1;b=b[d].getCoord();h=[];for(d=0;d<c;d++)h[d]=a.b.pa(b[d][0],b[d][1]);b=d=new a.Ja;d.Bl(h,c);c=!0}this.Sj().isDensificationNeeded()&&(h=1E5*this.bn(),b=a.Jm.local().V(b,h,null));c&&(c=new a.ci,b.Qn(c),b.hf(),b.Rb(),b.gT(),a.tk.local().qo(b,null,1));null==this.Pt&&(this.Pt=b)}}};b.prototype.Mk=function(){if(this.al)return this.Pt;var a=this.Pt;if(null!=a)return a;this.uL();return this.Pt};b.prototype.vL=
function(){if(this.uf.getType()==a.Vc.PE_TYPE_PROJCS){var b=90*this.ee(),b=[[0,b],[0,-b]];a.fi.geogToProj(this.uf,2,b);var d=this.Sj(),h=d.getNorthPoleLocation()!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY,d=d.getSouthPoleLocation()!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY;this.ix||(h&&this.kB.ka(b[0][0],b[0][1]),d&&this.xB.ka(b[1][0],b[1][1]))}this.ix=!0};b.prototype.dA=function(a,d){this.al||this.ix||this.vL();a?d.L(this.xB):d.L(this.kB)};b.prototype.tL=function(){if(1==this.vI){var b=400*this.ee();this.kr.I(-b,-b,b,
b)}else b=a.Bg.generate(this.uf,a.Bg.PE_PCSINFO_OPTION_DOMAIN),b=a.h.pa(b.getDomainMinx(),b.getDomainMiny(),b.getDomainMaxx(),b.getDomainMaxy()),this.kr.u()&&this.kr.I(b)};b.prototype.ZS=function(a){this.al&&a.I(this.kr);this.kr.u()&&this.tL();a.I(this.kr)};b.prototype.dn=function(){return this.eJ};b.prototype.pi=function(){return this.KA};b.prototype.Nd=function(){return this.Fr};b.prototype.Xs=function(){return this.II};return b}();a.TD=b})(D||(D={}));(function(a){var b=function(){function b(b){this.IV=
b;this.wt=a.Ib.iw(b,0,!0);var d=b.getCode();this.nt=0<d?d:a.Tf.getCode(b);0>this.nt&&(this.nt=0);this.Fr=d=this.IV.getUnit();this.XI=1/d.getUnitFactor();a.Tf.getCode(b)}b.zz=function(a,d){return a==d?!0:null!=a&&null!=d&&0==a.nt&&0==d.nt?a.wt===d.wt:!1};b.prototype.$s=function(){return this.nt};return b}();a.FN=b})(D||(D={}));(function(a){var b=function(){function b(){}b.Cb=function(b,d,h,c,e,f,g,k){if(null!=f||null!=g||null!=k){c=a.C.da(c);d=a.C.da(d);h=a.C.da(h);e=a.C.da(e);1.570796326794897<a.l.K(h)&&
(h=a.l.Ab(3.141592653589793,h)-h,d=a.C.da(d+3.141592653589793));1.570796326794897<a.l.K(e)&&(e=a.l.Ab(3.141592653589793,e)-e,c=a.C.da(c+3.141592653589793));var l=a.C.da(c-d);if(a.l.W(h,e)&&(a.l.W(d,c)||a.l.W(a.l.K(h),1.570796326794897)))null!=f&&(f.j=0),null!=g&&(g.j=0),null!=k&&(k.j=0);else{if(a.l.W(h,-e)){if(a.l.W(a.l.K(h),1.570796326794897)){null!=f&&(f.j=3.141592653589793*b);null!=g&&(g.j=0<h?a.C.da(3.141592653589793-a.C.da(c)):a.C.da(c));null!=k&&(k.j=0<h?a.C.da(c):a.C.da(3.141592653589793-a.C.da(c)));
return}if(a.l.W(a.l.K(l),3.141592653589793)){null!=f&&(f.j=3.141592653589793*b);null!=g&&(g.j=0);null!=k&&(k.j=0);return}}var r=1.570796326794897==a.l.K(h)?0:Math.cos(h),y=Math.sin(h),A=1.570796326794897==a.l.K(e)?0:Math.cos(e),m=Math.sin(e),H=1.570796326794897==a.l.K(l)?0:Math.cos(l),q=3.141592653589793==a.l.K(l)?0:Math.sin(l);if(null!=f){var w=Math.sin((e-h)/2),l=Math.sin(l/2);f.j=2*Math.asin(Math.sqrt(w*w+r*A*l*l))*b}null!=g&&(a.l.W(a.l.K(h),1.570796326794897)?g.j=0>h?c:a.C.da(3.141592653589793-
c):g.j=Math.atan2(A*q,r*m-y*A*H));null!=k&&(a.l.W(a.l.K(e),1.570796326794897)?k.j=0>e?d:a.C.da(3.141592653589793-d):(k.j=Math.atan2(r*q,m*r*H-A*y),k.j=a.C.da(k.j+3.141592653589793)))}}};b.Uf=function(b,d,h,c,e,f,g){if(null!=f||null!=g){d=a.C.da(d);h=a.C.da(h);1.570796326794897<a.l.K(h)&&(h=a.l.Ab(3.141592653589793,h)-h,d=a.C.da(d+3.141592653589793));a.l.W(a.l.K(h),1.570796326794897)&&(d=0);e=a.C.da(e);var l=a.l.W(a.l.K(e),1.570796326794897)?0:Math.cos(e),r=a.l.W(a.l.K(e),3.141592653589793)?0:Math.sin(e),
y=a.l.W(a.l.K(h),1.570796326794897)?0:Math.cos(h),k=Math.sin(h);b=c/b;c=a.l.W(a.l.K(b),1.570796326794897)?0:Math.cos(b);var A=a.l.W(a.l.K(b),3.141592653589793)?0:Math.sin(b),m=Math.asin(k*c+y*A*l);null!=g&&(g.j=m);null!=f&&(f.j=a.l.W(a.l.K(m),1.570796326794897)?a.l.W(h,-m)?0>m?e:a.C.da(3.141592653589793-e):d:a.l.W(a.l.K(h),1.570796326794897)&&a.l.W(b,3.141592653589793)?0>h?e:a.C.da(3.141592653589793-e):a.C.da(d+Math.atan2(A*r,y*c-k*A*l)))}};return b}();a.vh=b})(D||(D={}));(function(a){var b=function(){function b(){}
b.Cb=function(b,d,h,c,e,f,g,k,A){var l=new a.ea(0),r=new a.ea(0),y=[0,0,0],m=[0,0,0],H=[0,0,0],q=new a.ea(0),w=new a.ea(0),n=new a.ea(0),x=new a.ea(0),P=new a.ea(0);if(null!=g||null!=k||null!=A)if(a.l.Qi(d))a.vh.Cb(b,h,c,e,f,g,k,A);else{e=a.C.da(e);h=a.C.da(h);var p=a.C.da(e-h);if(a.l.W(c,f)&&(a.l.W(h,e)||a.l.W(a.l.K(c),1.570796326794897)))null!=g&&(g.j=0),null!=k&&(k.j=0),null!=A&&(A.j=0);else{if(a.l.W(c,-f)){if(a.l.W(a.l.K(c),1.570796326794897)){null!=g&&(g.j=2*a.C.Yg(b,d));null!=k&&(k.j=0<c?a.C.da(3.141592653589793-
a.C.da(e)):a.C.da(e));null!=A&&(A.j=0<c?a.C.da(e):a.C.da(3.141592653589793-a.C.da(e)));return}a.l.W(a.l.K(p),3.141592653589793)&&(null!=g&&(g.j=2*a.C.Yg(b,d)),null!=k&&(k.j=0),null!=A&&(A.j=0))}else if(a.l.W(a.l.K(c),1.570796326794897)||a.l.W(a.l.K(f),1.570796326794897))a.l.W(a.l.K(c),1.570796326794897)?h=e:e=h;var u=0,B;0>p&&(u=1,B=h,h=e,e=B,B=c,c=f,f=B);var p=a.C.du(d,c),z=a.C.du(d,f);if(null!=k||null!=A)a.vh.Cb(b,h,p,e,z,null,l,r),l=Math.atan2(Math.sin(l.j)*Math.cos(c-p),Math.cos(l.j)),r=Math.atan2(Math.sin(r.j)*
Math.cos(f-z),Math.cos(r.j)),0!=u&&(B=l,l=r,r=B),null!=k&&(k.j=l),null!=A&&(A.j=r);null!=g&&(a.C.Dk(1,d,c,h,0,n,x,P),y[0]=n.j,y[1]=x.j,y[2]=P.j,a.C.Dk(1,d,f,e,0,n,x,P),m[0]=n.j,m[1]=x.j,m[2]=P.j,H[0]=y[1]*m[2]-m[1]*y[2],H[1]=-(y[0]*m[2]-m[0]*y[2]),H[2]=y[0]*m[1]-m[0]*y[1],d=1-a.C.Cm(d,a.C.Nr(d,a.C.ik(d,Math.acos(H[2]/Math.sqrt(H[0]*H[0]+H[1]*H[1]+H[2]*H[2]))))),d*=2-d,k=Math.atan2(-H[1],-H[0]),H=a.C.da(k-1.570796326794897),k=a.C.da(k+1.570796326794897),H=a.l.K(a.C.da(h-H))<=a.l.K(a.C.da(h-k))?H:k,
a.vh.Cb(1,H,0,h,p,q,null,null),a.vh.Cb(1,H,0,e,z,w,null,null),3.141592653589793<q.j+w.j&&(H=a.C.da(H+3.141592653589793),a.vh.Cb(1,H,0,h,p,q,null,null),a.vh.Cb(1,H,0,e,z,w,null,null)),q.j*=a.l.Ab(1,c),w.j*=a.l.Ab(1,f),q.j=a.C.ik(d,q.j),w.j=a.C.ik(d,w.j),h=a.C.q(b,d,q.j),b=a.C.q(b,d,w.j),g.j=a.l.K(b-h))}}};b.Uf=function(b,d,h,c,e,f,g,k){var l=0,r=new a.ea(0),y=new a.ea(0),A=[0,0,0],m=[0,0,0],H=new a.ea(0),q=new a.ea(0),w=new a.ea(0);if(null!=g||null!=k)if(a.l.Qi(d))a.vh.Uf(b,h,c,e,f,g,k);else if(a.l.xd(e))null!=
g&&(g.j=h),null!=k&&(k.j=c);else{f=a.C.da(f);0>e&&(e=a.l.K(e),f=a.C.da(f+3.141592653589793));h=a.C.da(h);c=a.C.da(c);1.570796326794897<a.l.K(c)&&(h=a.C.da(h+3.141592653589793),c=a.l.Ab(3.141592653589793,c)-c);a.l.W(a.l.K(c),1.570796326794897)&&(h=0);var n;if(a.l.xd(c))n=a.l.K(1.570796326794897-a.l.K(f)),n=a.C.ik(d,n),n=1-a.C.Cm(d,a.C.Nr(d,n)),n*=2-n,b=e/a.C.Yg(b,n)*1.570796326794897,b=a.C.xp(n,b),b=a.C.du(n,b),a.vh.Uf(1,h,c,b,f,g,r),null!=k&&(l=r.j),null!=k&&(k.j=a.C.ik(d,l));else if(a.l.W(a.l.K(c),
1.570796326794897))l=a.C.Yg(b,d),r=2*l,b=a.l.Ab(1.570796326794897,c),f=0<b?a.C.da(3.141592653589793-f):f,c=l-e,a.l.K(c)<=l?null!=g&&(g.j=f):(c=Math.floor(e/r),0==a.J.truncate(c%2)?(null!=g&&(g.j=f),c=l-(e-c*r)):(null!=g&&(g.j=a.C.da(f+3.141592653589793)),c=l-((c+1)*r-e))),null!=k&&(k.j=a.C.xp(d,c/l*b));else{n=a.C.du(d,c);f=Math.atan2(Math.sin(f),Math.cos(f)*Math.cos(c-n));var x=a.J.truncate(a.l.Ab(1,n))*(1.570796326794897>=a.l.K(f)?1:-1);f=a.C.da(h+Math.atan(Math.tan(f)*-Math.sin(n)));a.vh.Cb(b,f,
0,h,n,null,y,null);n=a.l.K(1.570796326794897-a.l.K(y.j));n=a.C.ik(d,n);n=1-a.C.Cm(d,a.C.Nr(d,n));n*=2-n;a.C.Dk(1,d,0,f,0,H,q,w);A[0]=H.j;A[1]=q.j;A[2]=w.j;a.C.Dk(1,d,c,h,0,H,q,w);m[0]=H.j;m[1]=q.j;m[2]=w.j;c=Math.acos((A[0]*m[0]+A[1]*m[1]+A[2]*m[2])/Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]));c=a.C.ik(n,c);c=a.C.q(b,n,c)+e*x;e=0<c?y.j:a.C.da(y.j+3.141592653589793);b=a.l.K(c)/a.C.Yg(b,n)*1.570796326794897;b=a.C.xp(n,b);b=a.C.du(n,b);a.vh.Uf(1,f,0,b,e,g,r);null!=k&&(l=r.j);null!=k&&(k.j=a.C.ik(d,l))}}};
return b}();a.yl=b})(D||(D={}));(function(a){var b=function(){function b(){}b.Cb=function(b,d,h,c,e,f,g,k,m){var l=0,r=0,y=0;if(null!=g||null!=k||null!=m)if(a.l.Qi(d))a.vh.Cb(b,h,c,e,f,g,k,m);else{var A=a.C.da(e-h);if(a.l.W(c,f)&&(a.l.xd(A)||a.l.W(a.l.K(c),1.570796326794897)))null!=g&&(g.j=0),null!=k&&(k.j=0),null!=m&&(m.j=0);else{if(a.l.W(c,-f)){if(a.l.W(a.l.K(c),1.570796326794897)){null!=g&&(g.j=2*a.C.Yg(b,d));null!=k&&(k.j=0<c?a.C.da(3.141592653589793-a.C.da(e)):a.C.da(e));null!=m&&(m.j=0<c?a.C.da(e):
a.C.da(3.141592653589793-a.C.da(e)));return}a.l.W(a.l.K(A),3.141592653589793)&&(null!=g&&(g.j=2*a.C.Yg(b,d)),null!=k&&(k.j=0),null!=m&&(m.j=0))}else{if(a.l.W(a.l.K(c),1.570796326794897)||a.l.W(a.l.K(f),1.570796326794897)){a.yl.Cb(b,d,h,c,e,f,g,k,m);return}if(a.l.xd(A)||a.l.W(a.l.K(A),3.141592653589793)){a.yl.Cb(b,d,h,c,e,f,g,k,m);return}}var H=1-Math.sqrt(1-d),q=d/(1-d),n=b*(1-H);b=a.C.Nr(d,c);var w=a.C.Nr(d,f);d=1.570796326794897==a.l.K(b)?0:Math.cos(b);var x=Math.sin(b),p=1.570796326794897==a.l.K(w)?
0:Math.cos(w),P=Math.sin(w),u=A,B=Math.cos(u),z=Math.sin(u),v=1,t=0,ba,C,E,ea,F;do{ba=u;C=Math.sqrt(Math.pow(p*z,2)+Math.pow(d*P-x*p*B,2));E=x*P+d*p*B;ea=Math.atan2(C,E);if(0==C){v=0;break}F=d*p*z/C;l=Math.cos(Math.asin(F));l*=l;r=E-2*x*P/l;1<a.l.K(r)&&(r=a.l.Ab(1,r));y=r*r;u=H/16*l*(4+H*(4-3*l));u=A+(1-u)*H*F*(ea+u*C*(r+u*E*(2*y-1)));B=Math.cos(u);z=Math.sin(u);t++;if(3.141592653589793<a.l.K(u)&&30<t){v=0;break}}while(5E3>=t&&!a.l.W(ba,u));if(0!=v)q*=l,H=q*(256+q*(-128+q*(74-47*q)))/1024,null!=g&&
(g.j=n*(1+q*(4096+q*(-768+q*(320-175*q)))/16384)*(ea-H*C*(r+H/4*(E*(2*y-1)-H/6*r*(4*C*C-3)*(4*y-3))))),null!=k&&(a.l.W(a.l.K(c),1.570796326794897)?k.j=0>c?e:a.C.da(3.141592653589793-e):k.j=Math.atan2(p*z,d*P-x*p*B)),null!=m&&(a.l.W(a.l.K(f),1.570796326794897)?m.j=0>f?h:a.C.da(3.141592653589793-h):(m.j=Math.atan2(d*z,d*P*B-x*p),m.j=a.C.da(m.j+3.141592653589793)));else{u=a.l.Ab(3.141592653589793,A);E=x*P-d*p;ea=Math.acos(E);C=Math.sin(ea);l=1;t=F=0;do y=F,l*=l,B=l*l,F=H*l*(1+H+H*H),r=H*H*B*(1+2.25*
H),v=H*H*H*B*l,B=1-.25*F+.1875*r-.1953125*v,F=.25*F-.25*r+.29296875*v,z=.03125*r-.05859375*v,v*=.00651041666666667,r=E-2*x*P/l,1<a.l.K(r)&&(r=a.l.Ab(1,r)),l=Math.acos(r),E=Math.cos(2*l),ba=Math.cos(3*l),F=a.l.W(c,-f)?a.C.da(3.141592653589793-A)/(3.141592653589793*H*B):a.C.da(u-A)/(H*(B*ea+F*C*r+z*Math.sin(2*ea)*E+v*Math.sin(3*ea)*ba)),z=F*C/(d*p),u=1.570796326794897<a.l.K(A)?a.l.Ab(3.141592653589793,z)-Math.asin(z):Math.asin(z),B=Math.cos(u),C=Math.sqrt(Math.pow(p*z,2)+Math.pow(d*P-x*p*B,2)),ea=3.141592653589793-
Math.asin(a.l.K(C)),E=Math.cos(ea),l=Math.cos(Math.asin(F)),t++;while(70>=t&&!a.l.W(y,F));null!=g&&(l*=l,q*=l,B=1+q*(4096+q*(-768+q*(320-175*q)))/16384,a.l.W(c,-f)?g.j=3.141592653589793*n*B:(r=E-2*x*P/l,l=Math.acos(r),E=Math.cos(2*l),ba=Math.cos(3*l),g.j=n*(B*ea+q*(-512+q*(128+q*(-60+35*q)))/2048*C*r+q*(-4+5*q)/6144*q*q*Math.sin(2*ea)*E+v*Math.sin(3*ea)*ba+-7.62939453125E-5*q*q*q*q*Math.sin(4*ea)*Math.cos(4*l))));null!=k&&(a.l.xd(c)&&a.l.xd(f)?(l=Math.sqrt(1-F*F),k.j=Math.acos(l),0>A&&(k.j*=-1)):
a.l.W(a.l.K(c),1.570796326794897)?k.j=0>c?e:a.C.da(3.141592653589793-e):(g=F/d,n=Math.sqrt(1-g*g),0>d*P-x*p*Math.cos(u)&&(n*=-1),k.j=Math.atan2(g,n),a.l.W(c,-f)&&a.l.K(a.C.da(h-e))>3.141592653589793*(1-H*Math.cos(c))&&(0<c&&1.570796326794897>a.l.K(k.j)||0>c&&1.570796326794897<a.l.K(k.j))&&(k.j=a.l.Ab(3.141592653589793,k.j)-k.j)));if(null!=m)if(a.l.xd(c)&&a.l.xd(f))l=Math.sqrt(1-F*F),m.j=Math.acos(l),0<=A&&(m.j*=-1);else if(a.l.W(a.l.K(f),1.570796326794897))m.j=0>f?h:a.C.da(3.141592653589793-h);else if(A=
F/p,g=Math.sqrt(1-A*A),n=Math.sin(u/2),0>Math.sin(w-b)-2*d*P*n*n&&(g*=-1),m.j=Math.atan2(A,g),m.j=a.C.da(m.j+3.141592653589793),a.l.W(c,-f)&&!a.l.xd(c)&&!a.l.W(a.l.K(c),1.570796326794897)&&a.l.K(a.C.da(h-e))>3.141592653589793*(1-H*Math.cos(c))&&(null!=k?n=k.j:(g=F/d,n=Math.sqrt(1-g*g),0>d*P-x*p*Math.cos(u)&&(n*=-1),n=Math.atan2(g,n),a.l.W(c,-f)&&a.l.K(a.C.da(h-e))>3.141592653589793*(1-H*Math.cos(c))&&(0<c&&1.570796326794897>a.l.K(n)||0>c&&1.570796326794897<a.l.K(n))&&(n=a.l.Ab(3.141592653589793,n)-
n)),1.570796326794897>=a.l.K(n)&&1.570796326794897<a.l.K(m.j)||1.570796326794897<=a.l.K(n)&&1.570796326794897>a.l.K(m.j)))m.j=-1*a.C.da(m.j+3.141592653589793)}}}};b.Uf=function(b,d,h,c,e,f,g,k){if(null!=g||null!=k)if(a.l.Qi(d))a.vh.Uf(b,h,c,e,f,g,k);else if(f=a.C.da(f),a.l.W(a.l.K(c),1.570796326794897)||a.l.xd(f)||a.l.W(a.l.K(f),3.141592653589793))a.yl.Uf(b,d,h,c,e,f,g,k);else{var l=1.570796326794897==a.l.K(f)?0:Math.cos(f),r=3.141592653589793==a.l.K(f)?0:Math.sin(f);a.l.W(a.l.K(c),1.570796326794897)&&
(h=0);f=1-Math.sqrt(1-d);var y=a.C.Nr(d,c);c=1.570796326794897==a.l.K(y)?0:Math.cos(y);var m=Math.sin(y),y=Math.atan2(Math.tan(y),l),A=c*r,H=A*A,q=1-H,n=d/(1-d)*q;d=n*(256+n*(-128+n*(74-47*n)))/1024;var w=d/4,x=d/6,p=e/(b*(1-f)*(1+n*(4096+n*(-768+n*(320-175*n)))/16384)),P=p,u;do{u=P;e=1.570796326794897==a.l.K(P)?0:Math.cos(P);var n=3.141592653589793==a.l.K(P)?0:Math.sin(P),B=n*n;b=Math.cos(2*y+P);P=b*b;P=d*n*(b+w*(e*(2*P-1)-x*b*(4*B-3)*(4*P-3)))+p}while(!a.l.W(u,P));e=1.570796326794897==a.l.K(P)?
0:Math.cos(P);n=3.141592653589793==a.l.K(P)?0:Math.sin(P);null!=g&&(r=Math.atan2(n*r,c*e-m*n*l),q=f/16*q*(4+f*(4-3*q)),b=Math.cos(2*y+P),g.j=a.C.da(h+(r-(1-q)*f*A*(P+q*n*(b+q*e*(2*b*b-1))))));null!=k&&(q=m*n-c*e*l,q=(1-f)*Math.sqrt(H+q*q),k.j=Math.atan2(m*e+c*n*l,q))}};return b}();a.Nu=b})(D||(D={}));(function(a){var b=function(){function b(){}b.Cb=function(b,d,h,c,e,f,g,k,m){var l=a.C.da(e-h),r=a.l.W(a.l.K(c),1.570796326794897),y=a.l.W(a.l.K(f),1.570796326794897);if(a.l.W(c,f)&&(a.l.xd(l)||r))null!=
g&&(g.j=0),null!=k&&(k.j=0),null!=m&&(m.j=0);else{var A,H;a.l.Qi(d)?(A=Math.sin(c),H=Math.sin(f),A=Math.sqrt((1+A)/(1-A)),H=Math.sqrt((1+H)/(1-H)),A=Math.log(H)-Math.log(A),A=Math.atan2(l,A),null!=g&&(g.j=a.l.W(c,f)?a.l.K(b*Math.cos(c)*l):a.l.K((b*f-b*c)/Math.cos(A)))):(H=a.C.Cx(d,f),A=Math.sin(a.C.Cx(d,c)),H=Math.sin(H),A=Math.sqrt((1+A)/(1-A)),H=Math.sqrt((1+H)/(1-H)),A=Math.log(H)-Math.log(A),A=Math.atan2(l,A),null!=g&&(a.l.W(c,f)?g.j=a.l.K(b*l*Math.cos(c)/a.C.Cm(d,c)):(l=a.C.q(b,d,c),b=a.C.q(b,
d,f),g.j=a.l.K((b-l)/Math.cos(A)))));if(null!=k||null!=m)g=a.C.da(A+3.141592653589793),r&&y||!r&&!y||(r?A=0>c?e:a.C.da(3.141592653589793-e):y&&(g=0>f?h:a.C.da(3.141592653589793-h))),null!=k&&(k.j=A),null!=m&&(m.j=g)}};b.Uf=function(b,d,h,c,e,f,g,k){f=a.C.da(f);0>e&&(e=a.l.K(e),f=a.C.da(f+3.141592653589793));a.l.Qi(d)?a.l.W(a.l.K(c),1.570796326794897)?(h=0>c?f:a.C.da(3.141592653589793-f),f=e/b%6.283185307179586,3.141592653589793>=f?b=c-a.l.Ab(f,c):(h=a.C.da(h+3.141592653589793),b=-c+a.l.Ab(f-3.141592653589793,
c))):a.l.W(a.l.K(f),1.570796326794897)?(h=a.C.da(h+a.l.Ab(e,f)/(b*Math.cos(c))),b=c):(b=c+e*Math.cos(f)/b,1.570796326794897<a.l.K(b)&&(b=1.570796326794897),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.xd(f)||a.l.W(a.l.K(f),3.141592653589793))||(1.570796316258184<a.l.K(b)&&(b=a.l.Ab(1.570796316258184,b)),d=Math.sin(c),c=Math.sin(b),d=Math.sqrt((1+d)/(1-d)),c=Math.sqrt((1+c)/(1-c)),d=Math.log(c)-Math.log(d),h=a.C.da(h+Math.tan(f)*d))):a.l.W(a.l.K(c),1.570796326794897)?(h=0>c?f:a.C.da(3.141592653589793-f),
f=e/a.C.pX(b,d),f%=6.283185307179586,3.141592653589793>=f?(b=c-a.l.Ab(f,c),b=a.C.xp(d,b)):(h=a.C.da(h+3.141592653589793),b=-c+a.l.Ab(f-3.141592653589793,c),b=a.C.xp(d,b))):a.l.W(a.l.K(f),1.570796326794897)?(h=a.C.da(h+a.l.Ab(e,f)*a.C.Cm(d,c)/(b*Math.cos(c))),b=c):(b=1.570796326794897*(e*Math.cos(f)+a.C.q(b,d,c))/a.C.Yg(b,d),1.570796326794897<a.l.K(b)&&(b=a.l.Ab(1.570796326794897,b)),b=a.C.xp(d,b),a.l.W(a.l.K(b),1.570796326794897)&&(a.l.xd(f)||a.l.W(a.l.K(f),3.141592653589793))||(e=a.C.Cx(d,c),c=a.C.Cx(d,
b),1.570796316258184<a.l.K(c)&&(c=a.l.Ab(1.570796316258184,b),b=a.C.BQ(d,c)),d=Math.sin(e),c=Math.sin(c),d=Math.sqrt((1+d)/(1-d)),c=Math.sqrt((1+c)/(1-c)),d=Math.log(c)-Math.log(d),h=a.C.da(h+Math.tan(f)*d)));null!=g&&(g.j=h);null!=k&&(k.j=b)};return b}();a.UD=b})(D||(D={}));(function(a){var b=function(){function b(){}b.Fz=function(b,d,h,c,e,f,g){a.Nu.Cb(b,d,h,c,e,f,null,g,null)};b.Xi=function(b,d,h,c,e,f,g,k){a.Nu.Uf(b,d,h,c,e,f,g,k)};b.Ld=function(b,d,h,c,e,f,g,k,m,A){switch(A){case 2:a.yl.Cb(b,
d,h,c,e,f,g,k,m);break;case 3:a.VD.Cb(b,d,h,c,e,f,g,k,m);break;case 1:a.UD.Cb(b,d,h,c,e,f,g,k,m);break;default:a.Nu.Cb(b,d,h,c,e,f,g,k,m)}};b.Oj=function(b,d,h,c,e,f,g,k,m){switch(m){case 2:a.yl.Uf(b,d,h,c,e,f,g,k);break;case 3:a.VD.Uf(b,d,h,c,e,f,g,k);break;case 1:a.UD.Uf(b,d,h,c,e,f,g,k);break;default:a.Nu.Uf(b,d,h,c,e,f,g,k)}};return b}();a.mb=b})(D||(D={}));(function(a){var b=function(){function d(){this.y=this.x=null}d.pa=function(h){var b=new d;b.x=new a.Xb;b.x.set(h.x);b.y=new a.Xb;b.y.set(h.y);
return b};d.aG=function(h,b){var l=new d;l.x=new a.Xb;l.x.set(h);l.y=new a.Xb;l.y.set(b);return l};d.prototype.Lg=function(){return this.x.Lg()&&this.y.Lg()};d.prototype.value=function(){return a.b.pa(this.x.value(),this.y.value())};return d}();a.IZ=b;var c=function(){function d(){this.z=this.y=this.x=null}d.pa=function(h){var b=new d;b.x=new a.Xb;b.x.set(h.x);b.y=new a.Xb;b.y.set(h.y);b.z=new a.Xb;b.z.set(h.z);return b};d.aG=function(h,b,l){var c=new d;c.x=new a.Xb;c.x.set(h);c.y=new a.Xb;c.y.set(b);
c.z=new a.Xb;c.z.set(l);return c};d.prototype.Lg=function(){return this.x.Lg()&&this.y.Lg()&&this.z.Lg()};d.prototype.value=function(){return new a.qd(this.x.value(),this.y.value(),this.z.value())};d.prototype.oi=function(d){var h=new a.Xb,b=new a.Xb,l=new a.Xb;h.pm(this.x,d.x);b.pm(this.y,d.y);l.pm(this.z,d.z);d=new a.Xb;d.bP(h,b);d.add(l);return d};d.prototype.jG=function(h){var b=new d;b.x.pm(this.y,h.z);b.y.pm(this.z,h.x);b.z.pm(this.x,h.y);var l=new a.Xb,c=new a.Xb,e=new a.Xb;l.pm(this.z,h.y);
c.pm(this.x,h.z);e.pm(this.y,h.x);b.x.sub(l);b.y.sub(c);b.z.sub(e);return b};return d}();a.JZ=c;var l=function(){function d(){}d.pO=function(a,b,l){var h=b.x;b=b.y;d.Dk(1,a,Math.cos(h),Math.sin(h),Math.cos(b),Math.sin(b),l)};d.mO=function(h,b){var l=new a.qd;d.pO(h,b,l);return l};d.HZ=function(h,b,l,c,e,f){var r=new a.qd;d.Dk(h,b,l,c,e,f,r);return r};d.Dk=function(d,a,b,l,c,e,f){d/=Math.sqrt(1-a*e*e);f.I(d*c*b,d*c*l,d*(1-a)*e)};d.Su=function(d,b){var h=new a.Xb,l=new a.Xb,e=new a.Xb,r=new a.Xb;h.cos(b.x);
l.sin(b.x);e.cos(b.y);r.sin(b.y);b=new a.Xb;b.set(r);b.Vg(r);b.yp(d);b.yp(-1);b.iP();b.sqrt();var f=new a.Xb;f.set(1);f.Wm(b);b=new a.Xb;b.set(f);b.Vg(e);b.Vg(h);h=new a.Xb;h.set(f);h.Vg(e);h.Vg(l);l=new a.Xb;l.set(f);l.yp(1-d);l.Vg(r);return c.aG(b,h,l)};d.LN=function(d,a,b){var h=a.x,l=a.y;b.ka(Math.atan2(l,h),Math.atan2(a.z,(1-d)*Math.sqrt(h*h+l*l)))};d.Y_=function(h,b,l){h=new a.b;d.LN(b,l,h);return h};d.MU=function(h,l,c,e){if(Math.abs(l.x-c.x)>Math.PI||Math.abs(l.y)>.5*Math.PI||Math.abs(c.y)>
.5*Math.PI||(Math.abs(l.y)==.5*Math.PI||Math.abs(c.y)==.5*Math.PI)&&l.x!=c.x)return NaN;e=d.RC(e,Math.min(l.x,c.x),Math.max(l.x,c.x));if(!(new a.Ac(l.x,c.x)).contains(e))return NaN;var r=b.pa(l);c=b.pa(c);r=d.Su(h,r);c=d.Su(h,c);c=r.jG(c);if(c.z.Lg())return l=l.y;var f=new a.Xb;f.set(c.x);f.Wm(c.z);f.yp(-1);var g=new a.Xb;g.set(c.y);g.Wm(c.z);g.yp(-1);var k=new a.Xb;k.set(g);k.Vg(g);r=new a.Xb;r.set(f);r.Vg(f);r.add(k);r.sqrt();if(r.Lg()||f.Lg()&&g.Lg())return l=l.y;l=Math.atan2(g.value(),f.value());
l=Math.atan2(r.value()*Math.cos(l-e),1-h);e=d.mO(h,a.b.pa(e,l));h=new a.qd(e.x,e.y,-e.z);e=c.value().oi(e);h=c.value().oi(h);Math.abs(h)<Math.abs(e)&&(l=-l);return l};d.uA=function(h,l,c,e,f,g){g[0]=NaN;g[1]=NaN;if(Math.abs(c.x-e.x)>Math.PI||Math.abs(c.y)>.5*Math.PI||Math.abs(e.y)>.5*Math.PI||(Math.abs(c.y)==.5*Math.PI||Math.abs(e.y)==.5*Math.PI)&&c.x!=e.x||Math.abs(f)>=.5*Math.PI||0<c.y&&0<e.y&&c.y>f&&e.y>f||0>c.y&&0>e.y&&c.y<f&&e.y<f)return 0;var r=b.pa(c);h=b.pa(e);r=d.Su(l,r);h=d.Su(l,h);var k=
r.jG(h);if(k.z.Lg())return(new a.Ac(c.y,e.y)).contains(f)?(g[0]=c.x,1):0;h=new a.Xb;h.set(k.x);h.Wm(k.z);h.yp(-1);r=new a.Xb;r.set(k.y);r.Wm(k.z);r.yp(-1);k=new a.Xb;k.set(r);k.Vg(r);var y=new a.Xb;y.set(h);y.Vg(h);y.add(k);y.sqrt();if(y.Lg()||h.Lg()&&r.Lg())return 0==f?(g[0]=c.x,g[1]=e.x,2):0;l=(1-l)*Math.tan(f)/y.value();if(1<Math.abs(l))return 0;l=Math.acos(l);k=Math.atan2(r.value(),h.value());h=Math.min(c.x,e.x);r=Math.max(c.x,e.x);e=d.RC(k-l,h,r);l=0!=f?d.RC(k+l,h,r):e;f=0;h<=e&&e<=r&&(g[f]=
e,f++);l!=e&&h<=l&&l<=r&&(g[f]=l,f++,2==f&&Math.abs(g[0]-c.x)>Math.abs(g[1]-c.x)&&(c=g[0],g[0]=g[1],g[1]=c));return f};d.RC=function(d,a,b){d>b?(a=Math.ceil((d-b)/(2*Math.PI)),d-=2*a*Math.PI):d<a&&(a=Math.ceil((a-d)/(2*Math.PI)),d+=2*a*Math.PI);return d};d.KB=function(d,a){a[0]>.5*Math.PI?(d[0]+=Math.PI,a[0]=Math.PI-a[0]):a[0]<-.5*Math.PI&&(d[0]-=Math.PI,a[0]=-Math.PI-a[0])};return d}();a.yy=l})(D||(D={}));(function(a){var b=function(){function b(){}b.TY=function(l,d){var h=8;0>h&&(h=8);var c=[0,
0,0,0],e=new a.b;e.L(d);e.scale(9102==a.fb.kc(l).Nd().yc()?1:a.fb.kc(l).Nd().Ai/3.141592653589793*180);-180>e.x?(e.x-=e.x%360,-180>e.x&&(e.x+=360)):180<e.x&&(e.x-=e.x%360,180<e.x&&(e.x-=360));90<e.y&&(e.y=90);-90>e.y&&(e.y=-90);l=5*h;d=(l+31)/32;for(var f=-180,g=180,k=l-1,m=d-1;0<=m;m--)for(var A=k-32*m,q=Math.min(32,l-32*m),n=1;n<q;n+=2){var w=.5*(g+f);e.x>=w?(c[m]|=1<<A,f=w):g=w;A-=2;k-=2}f=-90;g=90;k=l-2;for(m=d-1;0<=m;m--)for(A=k-32*m,q=Math.min(32,l-32*m),n=0;n<q;n+=2)w=.5*(g+f),e.y>=w?(c[m]|=
1<<A,f=w):g=w,A-=2,k-=2;return b.vO(c,h,h)};b.vO=function(a,d,h){for(var b=[],l=0;l<d;l++)b[l]="";for(var c=l=0,e=0;e<d;e++){var f=a[l]>>c&31,c=c+5;if(31<c){var g=37-c,f=f&(1<<g)-1,c=c-32;l++;f|=(a[l]&(1<<c)-1)<<g}b[d-1-e]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[f]}if(h>d)for(e=0;e<h-d;e++)b.push("0");else h<d&&(b.length=h);return b.join("")};return b}();a.sM=b})(D||(D={}));(function(a){var b={gcstol:[0,1E-8,1,1.11111E-8,2,1.68845E-8,3,2.17661E-8,4,2.22508E-8,5,2.34848E-8,6,2.37811E-8,7,2.88455E-8,
8,3.1456E-8,9,3.29779E-8,10,3.66789E-8,11,4.23597E-8,12,4.79463E-8,13,6.45223E-8,14,7.26274E-8,15,7.49945E-8,16,7.52506E-8,17,7.97991E-8,18,9.66202E-8,19,9.79918E-8,20,9.89735E-8,21,1.02314E-7,22,1.08146E-7,23,2.29734E-7,24,2.42985E-7,25,2.7546E-7,26,3.37034E-7,27,4.30795E-7,28,5.20871E-7,29,5.50921E-7,30,6.74068E-7,31,6.86177E-7,32,7.25263E-7,33,7.44101E-7,34,7.74267E-7,35,9.62954E-7,36,1.06103E-6,37,1.14363E-6,38,1.16219E-6,39,1.36419E-6,40,1.36744E-6,41,1.43239E-6,42,1.73624E-6,43,1.84825E-6,44,
1.90986E-6,45,1.97572E-6,46,2.12207E-6,47,2.72837E-6,48,3.1831E-6,49,3.58099E-6,50,3.81972E-6,51,4.09256E-6,52,4.40737E-6,53,4.77465E-6,54,5.16178E-6,55,5.20871E-6,56,5.72958E-6,57,6.03113E-6,58,6.98729E-6,59,9.24125E-6,60,1.14592E-5],pcstol:[0,6.66667E-9,1,2E-8,2,4.97098E-5,3,.001,4,.00109362,5,.00328087,6,.00497101],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,
102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,
102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,
2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,
2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,
2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,
3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3400,102184,3401,102185,3404,3359,3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,
3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,
4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,
4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,
102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,
27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077],pcsid:[2066,6,2136,5,2155,5,2157,
3,2158,3,2159,5,2160,5,2219,3,2220,3,2244,5,2245,5,2256,5,2265,5,2266,5,2269,5,2270,5,2273,5,2290,3,2291,3,2294,3,2295,3,2313,3,2314,5,2964,5,2967,5,2968,5,2991,3,2992,5,2993,3,2994,5,3073,3,3076,3,3079,3,3091,5,3106,3,3108,3,3109,3,3141,3,3142,3,3167,2,3337,3,3347,3,3348,3,3359,5,3360,3,3361,5,3362,3,3363,5,3364,3,3365,5,3366,5,3402,3,3403,3,3405,3,3406,3,3439,3,3440,3,3447,3,3449,3,3450,3,3453,5,3454,5,3460,3,3479,5,3480,3,3481,5,3482,3,3483,5,3484,3,3485,5,3486,3,3487,5,3488,3,3489,3,3490,5,3491,
3,3492,5,3493,3,3494,5,3495,3,3496,5,3497,3,3498,5,3499,3,3500,5,3501,3,3502,5,3503,3,3504,5,3505,3,3506,5,3507,3,3508,5,3509,3,3510,5,3511,3,3512,5,3513,3,3514,3,3515,5,3516,3,3517,5,3518,3,3519,5,3520,3,3521,5,3522,3,3523,5,3524,3,3525,5,3526,3,3527,5,3528,3,3529,5,3530,3,3531,5,3532,3,3533,5,3534,3,3535,5,3536,3,3537,5,3538,3,3539,5,3540,3,3541,5,3542,3,3543,5,3544,3,3545,5,3546,3,3547,5,3548,3,3549,5,3550,3,3551,5,3552,3,3553,5,3582,5,3583,3,3584,5,3585,3,3586,5,3587,3,3588,5,3589,3,3590,5,3591,
3,3592,3,3593,5,3598,5,3599,3,3600,5,3605,5,3606,3,3607,3,3608,5,3609,3,3610,5,3611,3,3612,5,3613,3,3614,5,3615,3,3616,5,3617,3,3618,5,3619,3,3620,5,3621,3,3622,5,3623,3,3624,5,3625,3,3626,5,3627,3,3628,5,3629,3,3630,5,3631,3,3632,5,3633,3,3634,5,3635,3,3636,5,3640,5,3641,3,3642,5,3643,3,3644,5,3645,3,3646,5,3647,3,3648,5,3649,3,3650,5,3651,3,3652,5,3653,3,3654,5,3655,3,3656,5,3657,3,3658,5,3659,3,3660,5,3661,3,3662,5,3663,3,3664,5,3668,5,3669,3,3670,5,3671,3,3672,5,3673,3,3674,5,3675,3,3676,5,3677,
5,3678,3,3679,5,3680,5,3681,3,3682,5,3683,5,3684,3,3685,3,3686,5,3687,3,3688,5,3689,3,3690,5,3691,3,3692,5,3696,5,3697,3,3698,5,3699,3,3700,5,3740,3,3749,3,3783,3,3784,3,3793,3,3794,3,3802,3,3816,3,3829,3,3854,3,3920,3,3978,3,3979,3,3991,5,3992,5,4026,3,4037,3,4038,3,4217,5,4438,5,4439,5,4467,3,4471,3,4474,3,4559,3,4839,3,5018,3,5048,3,5167,3,5168,3,5223,3,5234,3,5235,3,5243,3,5266,3,5316,3,5320,3,5321,3,5330,3,5331,3,5337,3,5361,3,5362,3,5382,3,5383,3,5396,3,5456,3,5457,3,5469,3,5472,4,5490,3,5518,
3,5523,3,5559,3,5588,5,5589,5,5596,3,5627,3,5629,3,5641,3,5643,3,5644,3,5654,5,5655,5,5659,3,5700,3,5825,3,5836,3,5837,3,5842,3,5844,3,5880,3,5887,3,5890,3,20499,3,20538,3,20539,3,20790,3,20791,3,21291,3,21292,3,21500,3,21817,3,21818,3,22032,3,22033,3,22091,3,22092,3,22332,3,22391,3,22392,3,22700,3,22770,3,22780,3,22832,3,23090,3,23095,3,23239,3,23240,3,23433,3,23700,3,24047,3,24048,3,24100,5,24200,3,24305,3,24306,3,24382,4,24383,3,24500,3,24547,3,24548,3,24571,2,24600,3,25E3,3,25231,3,25884,3,25932,
3,26237,3,26331,3,26332,3,26591,3,26592,3,26632,3,26692,3,26855,5,26856,5,27120,3,27200,3,27291,4,27292,4,27429,3,27492,3,27500,3,27700,3,28232,3,28600,3,28991,3,28992,3,29100,3,29220,3,29221,3,29333,3,29635,3,29636,3,29701,3,29738,3,29739,3,29849,3,29850,3,29871,2,29872,5,29873,3,29900,3,29901,3,29903,3,30200,6,30339,3,30340,3,30591,3,30592,3,30791,3,30792,3,31028,3,31121,3,31154,3,31170,3,31171,3,31370,3,31528,3,31529,3,31600,3,31700,3,31838,3,31839,3,31901,3,32061,3,32062,3,32098,3,32099,5,32100,
3,32104,3,32161,3,32766,3,53034,3,53048,3,53049,3,54034,3,65061,5,65062,5,65161,3,65163,3,102041,5,102064,4,102068,1,102069,0,102217,5,102218,3,102219,5,102220,5,102378,5,102379,5,102380,3,102381,5,102589,5,102599,5,102600,5,102604,5,102605,3,102606,3,102647,3,102704,5,102705,5,102733,5,102761,5,102762,3,102763,5,102764,3,102765,3,102766,5,102970,5,102974,5,102993,3,102994,3,102995,5,102996,5,103015,3,103016,5,103017,3,103018,5,103025,3,103026,3,103027,5,103028,5,103035,3,103036,3,103037,5,103038,
5,103039,3,103040,3,103041,5,103042,5,103043,3,103044,3,103045,5,103046,5,103047,3,103048,3,103049,5,103050,5,103051,3,103052,5,103053,3,103054,5,103055,3,103056,5,103057,3,103058,3,103059,5,103060,5,103061,3,103062,3,103063,5,103064,5,103069,5,103070,3,103071,3,103072,5,103073,5,103086,3,103087,3,103088,5,103089,5,103094,5,103095,3,103096,5,103103,3,103104,5,103105,3,103106,5,103121,3,103122,5,103123,3,103124,3,103125,5,103126,5,103127,3,103128,3,103129,5,103130,5,103131,3,103132,3,103133,5,103134,
5,103135,3,103136,3,103137,5,103138,5,103139,3,103140,5,103141,3,103142,5,103143,3,103144,5,103145,3,103146,5,103147,3,103148,3,103149,5,103150,5,103151,3,103152,5,103172,3,103173,5,103174,3,103175,3,103176,5,103177,5,103178,3,103179,3,103180,5,103181,5,103182,3,103183,3,103184,5,103185,5,103228,3,103229,3,103230,5,103231,5,103250,3,103251,5,103252,3,103253,5,103260,3,103261,3,103262,5,103263,5,103270,3,103271,3,103272,5,103273,5,103274,3,103275,3,103276,5,103277,5,103278,3,103279,3,103280,5,103281,
5,103282,3,103283,3,103284,5,103285,5,103286,3,103287,5,103288,3,103289,5,103290,3,103291,5,103292,3,103293,3,103294,5,103295,5,103296,3,103297,3,103298,5,103299,5,103376,5,103377,3,103378,3,103379,5,103380,5,103393,3,103394,3,103395,5,103396,5,103472,3,103473,5,103474,3,103475,5,103482,3,103483,5,103484,3,103485,5,103500,3,103501,5,103502,3,103503,3,103504,5,103505,5,103506,3,103507,3,103508,5,103509,5,103510,3,103511,3,103512,5,103513,5,103514,3,103515,5,103516,3,103517,5,103518,3,103519,5,103520,
3,103521,5,103522,3,103523,3,103524,5,103525,5,103526,3,103527,5,103561,5,103562,5,103563,3,103564,3,103565,5,103566,5,103567,3,103568,3,103569,5,103570,5,103585,5,103695,5],pcsidc:[[2E3,2045,3],[2056,2065,3],[2067,2135,3],[2137,2153,3],[2161,2170,3],[2172,2193,3],[2196,2198,3],[2200,2203,3],[2206,2217,3],[2222,2224,5],[2251,2253,5],[2280,2282,5],[2308,2311,3],[2315,2325,3],[2327,2394,3],[2400,2462,3],[2523,2576,3],[2578,2693,3],[2695,2758,3],[2867,2888,5],[2891,2930,5],[2931,2941,3],[2969,2973,3],
[2975,2982,3],[2984,2988,3],[2995,3002,3],[3006,3051,3],[3054,3059,3],[3061,3066,3],[3068,3071,3],[3084,3087,3],[3112,3118,3],[3120,3138,3],[3146,3151,3],[3153,3157,3],[3161,3166,3],[3168,3172,3],[3174,3203,3],[3294,3313,3],[3315,3335,3],[3339,3345,3],[3350,3358,3],[3367,3369,3],[3374,3399,3],[3408,3416,3],[3425,3432,5],[3441,3446,5],[3456,3459,5],[3465,3478,3],[3554,3559,3],[3561,3565,5],[3568,3570,5],[3571,3581,3],[3594,3597,3],[3601,3604,3],[3637,3639,3],[3665,3667,3],[3693,3695,3],[3701,3727,
3],[3728,3733,5],[3744,3747,3],[3753,3758,5],[3761,3763,3],[3765,3769,3],[3779,3781,3],[3788,3791,3],[3797,3799,3],[3832,3841,3],[3844,3852,3],[3873,3885,3],[3890,3893,3],[3907,3912,3],[3942,3950,3],[3968,3970,3],[3973,3976,3],[3986,3989,3],[3994,3997,3],[4399,4413,5],[4418,4433,5],[4491,4554,3],[5069,5072,3],[5105,5130,3],[5180,5184,3],[5253,5259,3],[5269,5275,3],[5292,5311,3],[5343,5349,3],[5355,5357,3],[5387,5389,3],[5459,5463,3],[5479,5482,3],[5530,5539,3],[5550,5552,3],[5562,5583,3],[5623,5625,
5],[5631,5639,3],[5649,5653,3],[5663,5680,3],[5682,5685,3],[5875,5877,3],[20002,20032,3],[20062,20092,3],[20135,20138,3],[20248,20258,3],[20348,20358,3],[20436,20440,3],[20822,20824,3],[20934,20936,3],[21035,21037,3],[21095,21097,3],[21148,21150,3],[21413,21423,3],[21473,21483,3],[21780,21782,3],[21891,21894,3],[22171,22177,3],[22181,22187,3],[22191,22197,3],[22234,22236,3],[22521,22525,3],[22991,22994,3],[23028,23038,3],[23830,23853,3],[23866,23872,3],[23877,23884,3],[23886,23894,3],[23946,23948,
3],[24311,24313,3],[24342,24347,3],[24370,24374,4],[24375,24381,3],[24718,24721,3],[24817,24821,3],[24877,24882,3],[24891,24893,3],[25391,25395,3],[25828,25838,3],[26191,26195,3],[26391,26393,3],[26703,26722,3],[26729,26760,5],[26766,26798,5],[26860,26870,5],[26891,26899,3],[26903,26923,3],[26929,26946,3],[26948,26998,3],[27037,27040,3],[27205,27232,3],[27258,27260,3],[27391,27398,3],[27561,27564,3],[27571,27574,3],[27581,27584,3],[27591,27594,3],[28191,28193,3],[28348,28358,3],[28402,28432,3],[28462,
28492,3],[29118,29122,3],[29177,29185,3],[30161,30179,3],[30491,30494,3],[30729,30732,3],[31251,31259,3],[31265,31268,3],[31275,31278,3],[31288,31297,3],[31461,31465,3],[31491,31495,3],[31917,31922,3],[31965,31985,3],[31992,32E3,3],[32001,32003,5],[32005,32031,5],[32033,32060,5],[32074,32077,5],[32081,32086,3],[32107,32130,3],[32133,32158,3],[32164,32167,5],[32180,32199,3],[32201,32260,3],[32301,32360,3],[32601,32662,3],[32664,32667,5],[32701,32761,3],[53001,53004,3],[53008,53019,3],[53021,53032,
3],[53042,53046,3],[54001,54004,3],[54008,54019,3],[54021,54032,3],[54042,54046,3],[54048,54053,3],[102001,102040,3],[102042,102063,3],[102065,102067,3],[102070,102112,3],[102114,102117,3],[102118,102121,5],[102122,102208,3],[102210,102216,3],[102221,102300,3],[102304,102377,3],[102382,102388,3],[102389,102391,5],[102401,102444,3],[102450,102452,3],[102461,102468,5],[102469,102492,3],[102500,102519,5],[102530,102549,3],[102570,102588,3],[102590,102598,3],[102601,102603,3],[102608,102628,3],[102629,
102646,5],[102648,102672,5],[102675,102700,5],[102701,102703,3],[102707,102730,5],[102735,102758,5],[102767,102798,3],[102962,102969,3],[102971,102973,3],[102975,102989,3],[102990,102992,5],[102997,103002,3],[103003,103008,5],[103009,103011,3],[103012,103014,5],[103019,103021,3],[103022,103024,5],[103029,103031,3],[103032,103034,5],[103065,103068,3],[103074,103076,3],[103077,103079,5],[103080,103082,3],[103083,103085,5],[103090,103093,3],[103097,103099,3],[103100,103102,5],[103107,103109,3],[103110,
103112,5],[103113,103116,3],[103117,103120,5],[103153,103157,3],[103158,103162,5],[103163,103165,3],[103166,103171,5],[103186,103188,3],[103189,103191,5],[103192,103195,3],[103196,103199,5],[103200,103224,3],[103225,103227,5],[103232,103237,3],[103238,103243,5],[103244,103246,3],[103247,103249,5],[103254,103256,3],[103257,103259,5],[103264,103266,3],[103267,103269,5],[103300,103375,3],[103381,103383,3],[103384,103386,5],[103387,103389,3],[103390,103392,5],[103397,103399,3],[103400,103471,5],[103476,
103478,3],[103479,103481,5],[103486,103488,3],[103489,103491,5],[103492,103495,3],[103496,103499,5],[103539,103543,3],[103544,103548,5],[103549,103551,3],[103552,103557,5],[103558,103560,3],[103571,103573,3],[103574,103576,5],[103577,103580,3],[103581,103583,5],[103600,103694,3],[103700,103793,5],[103794,103799,3]],gcsid:[4042,0,4075,0,4081,0,4168,0,4170,0,4188,0,4261,1,4262,0,4263,0,4288,0,4289,0,4305,1,4322,0,4324,0,4326,0,4466,0,4469,0,4475,0,4483,0,4490,0,4555,0,4558,0,4614,0,4619,0,4657,0,4670,
0,4671,0,4674,0,4682,0,4683,0,4718,0,4720,0,4721,0,4723,0,4726,0,4737,0,4738,0,4759,0,4761,0,4807,1,4808,0,4809,0,4816,1,4817,0,4818,0,4819,1,4820,0,4821,1,4823,0,4824,0,4901,1,4902,1,4903,0,4904,0,5228,0,5229,0,5233,0,5252,0,5264,0,5340,0,5354,0,5360,0,5371,0,5373,0,5381,0,5393,0,5464,0,5467,0,5489,0,5524,0,5527,0,5546,0,5561,0,5593,0,5681,0,5886,0,37225,1,37235,0,37257,0,37259,0,37260,0,104020,0,104139,1,104140,1,104223,0,104286,0,104287,0,104304,0,104305,0,104896,0,104900,5,104901,0,104902,0,104903,
9,104904,2,104905,2,104906,59,104907,54,104908,0,104909,58,104910,31,104911,56,104912,6,104913,50,104914,41,104915,10,104916,3,104917,30,104918,8,104919,60,104920,53,104921,44,104922,48,104923,51,104924,38,104925,0,104926,49,104927,57,104928,21,104929,23,104930,35,104931,49,104932,27,104933,17,104934,13,104935,7,104936,56,104937,40,104938,28,104939,37,104940,15,104941,55,104942,22,104943,4,104944,0,104945,20,104946,42,104947,47,104948,52,104949,43,104950,46,104951,39,104952,24,104953,16,104954,50,
104955,36,104956,33,104957,46,104958,14,104959,19,104960,0,104961,34,104962,32,104963,29,104964,45,104965,26,104966,25,104967,41,104968,11,104969,12,104970,18],gcsidc:[[4001,4016,0],[4018,4025,0],[4027,4029,0],[4031,4036,0],[4044,4047,0],[4052,4054,0],[4120,4166,0],[4172,4176,0],[4178,4185,0],[4190,4196,0],[4198,4216,0],[4218,4222,0],[4224,4232,0],[4234,4260,0],[4265,4267,0],[4269,4286,0],[4291,4303,0],[4306,4319,0],[4600,4610,0],[4621,4625,0],[4627,4633,0],[4636,4639,0],[4641,4646,0],[4659,4667,
0],[4676,4680,0],[4686,4697,0],[4699,4706,0],[4740,4757,0],[4763,4765,0],[4801,4806,0],[4810,4812,1],[4813,4815,0],[37001,37008,0],[37201,37208,0],[37211,37224,0],[37226,37233,0],[37237,37243,0],[37245,37247,0],[37249,37255,0],[104100,104138,0],[104141,104145,0],[104256,104261,0],[104700,104786,0],[104990,104992,0]]},c={c:[[2E3,2045,9001],[2056,2065,9001],[2067,2135,9001],[2137,2153,9001],[2161,2170,9001],[2172,2193,9001],[2196,2198,9001],[2200,2203,9001],[2206,2217,9001],[2222,2224,9002],[2251,2253,
9002],[2280,2282,9002],[2308,2311,9001],[2315,2325,9001],[2327,2394,9001],[2400,2462,9001],[2523,2576,9001],[2578,2693,9001],[2695,2758,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2941,9001],[2969,2973,9001],[2975,2982,9001],[2984,2988,9001],[2995,3002,9001],[3006,3051,9001],[3054,3059,9001],[3061,3066,9001],[3068,3071,9001],[3084,3087,9001],[3112,3118,9001],[3120,3138,9001],[3146,3151,9001],[3153,
3157,9001],[3161,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3335,9001],[3339,3345,9001],[3350,3358,9001],[3367,3369,9001],[3374,3399,9001],[3408,3416,9001],[3425,3432,9003],[3441,3446,9003],[3456,3459,9003],[3465,3478,9001],[3554,3559,9001],[3561,3565,9003],[3568,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3733,9003],[3744,3747,9001],[3753,3758,9003],[3761,3763,9001],[3765,3769,9001],
[3779,3781,9001],[3788,3791,9001],[3797,3799,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3907,3912,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4052,4054,9102],[4120,4166,9102],[4172,4176,9102],[4178,4185,9102],[4190,4196,9102],[4198,4216,9102],[4218,4222,9102],[4224,4232,9102],[4234,4260,9102],[4265,4267,9102],[4269,4286,9102],[4291,4303,
9102],[4306,4319,9102],[4399,4413,9003],[4418,4433,9003],[4491,4554,9001],[4600,4610,9102],[4621,4625,9102],[4627,4633,9102],[4636,4639,9102],[4641,4646,9102],[4659,4667,9102],[4676,4680,9102],[4686,4697,9102],[4699,4706,9102],[4740,4757,9102],[4763,4765,9102],[4801,4806,9102],[4810,4812,9105],[4813,4815,9102],[5069,5072,9001],[5105,5130,9001],[5180,5184,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5343,5349,9001],[5355,5357,9001],[5387,5389,9001],[5459,5463,9001],[5479,5482,9001],[5530,
5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21891,21894,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,
9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26703,26722,9001],[26729,26760,9003],[26766,26798,9003],[26860,26870,9003],[26891,26899,9001],[26903,26923,9001],[26929,
26946,9001],[26948,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29118,29122,9001],[29177,29185,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31278,9001],[31288,31297,9001],[31461,31465,9001],[31491,31495,9001],[31917,31922,9001],[31965,31985,9001],
[31992,32E3,9001],[32001,32003,9003],[32005,32031,9003],[32033,32060,9003],[32074,32077,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37001,37008,9102],[37201,37208,9102],[37211,37224,9102],[37226,37233,9102],[37237,37243,9102],[37245,37247,9102],[37249,37255,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53042,53046,9001],[54001,54004,
9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[102001,102040,9001],[102042,102063,9001],[102065,102067,9001],[102070,102112,9001],[102114,102117,9001],[102122,102208,9001],[102210,102216,9001],[102221,102300,9001],[102304,102377,9001],[102382,102388,9001],[102389,102391,9003],[102401,102444,9001],[102450,102452,9001],[102461,102468,9003],[102469,102492,9001],[102500,102519,9002],[102530,102549,9001],[102570,102588,9001],[102590,102598,9001],[102601,102603,9001],
[102608,102628,9001],[102629,102646,9003],[102648,102672,9003],[102675,102700,9003],[102701,102703,9001],[102707,102730,9003],[102735,102758,9003],[102767,102798,9001],[102962,102969,9001],[102971,102973,9001],[102975,102989,9001],[102990,102992,9002],[102997,103002,9001],[103003,103008,9003],[103009,103011,9001],[103012,103014,9003],[103019,103021,9001],[103022,103024,9003],[103029,103031,9001],[103032,103034,9003],[103065,103068,9001],[103074,103076,9001],[103077,103079,9002],[103080,103082,9001],
[103083,103085,9003],[103090,103093,9001],[103097,103099,9001],[103100,103102,9003],[103107,103109,9001],[103110,103112,9003],[103113,103116,9001],[103117,103120,9003],[103153,103157,9001],[103158,103162,9003],[103163,103165,9001],[103166,103168,9002],[103169,103171,9003],[103186,103188,9001],[103189,103191,9003],[103192,103195,9001],[103196,103199,9003],[103200,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],
[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103300,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103400,103471,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],
[103577,103580,9001],[103581,103583,9003],[103600,103694,9001],[103700,103793,9003],[103794,103799,9001],[104100,104138,9102],[104141,104145,9102],[104256,104261,9102],[104700,104786,9102],[104900,104970,9102],[104990,104992,9102]],nc:[2066,9039,2136,9094,2155,9003,2157,9001,2158,9001,2159,9094,2160,9094,2219,9001,2220,9001,2244,9003,2245,9003,2256,9002,2265,9002,2266,9002,2269,9002,2270,9002,2273,9002,2290,9001,2291,9001,2294,9001,2295,9001,2313,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,
9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2964,9003,2967,9003,2968,9003,2991,9001,2992,9002,2993,9001,2994,9002,3073,9001,3076,9001,3079,9001,3091,9003,3106,9001,3108,9001,3109,9001,3141,9001,3142,9001,3167,9301,3337,9001,3347,9001,3348,9001,3359,9003,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3366,9005,3402,9001,3403,9001,3405,9001,3406,9001,3439,9001,3440,9001,3447,9001,3449,9001,3450,9001,3453,9003,3454,9003,3460,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,
3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,
9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,
3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,
9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3740,9001,3749,9001,3783,9001,3784,9001,3793,9001,3794,9001,3802,9001,3816,9001,3829,9001,3854,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4075,9102,4081,9102,4168,9102,4170,9102,4188,9102,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,
4305,9105,4322,9102,4324,9102,4326,9102,4438,9003,4439,9003,4466,9102,4467,9001,4469,9102,4471,9001,4474,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4614,9102,4619,9102,4657,9102,4670,9102,4671,9102,4674,9102,4682,9102,4683,9102,4718,9102,4720,9102,4721,9102,4723,9102,4726,9102,4737,9102,4738,9102,4759,9102,4761,9102,4807,9105,4808,9102,4809,9102,4816,9105,4817,9102,4818,9102,4819,9105,4820,9102,4821,9105,4823,9102,4824,9102,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5018,
9001,5048,9001,5167,9001,5168,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5330,9001,5331,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5393,9102,5396,9001,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5518,9001,5523,9001,5524,9102,5527,9102,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,
5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5842,9001,5844,9001,5880,9001,5886,9102,5887,9001,5890,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23433,9001,23700,9001,24047,9001,24048,
9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25E3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,26855,9003,26856,9003,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27492,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29100,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,
9001,29850,9001,29871,9042,29872,9041,29873,9001,29900,9001,29901,9001,29903,9001,30200,9039,30339,9001,30340,9001,30591,9001,30592,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37225,9105,37235,9102,37257,9102,37259,9102,37260,9102,53034,9001,53048,9001,53049,9001,54034,9001,65061,9003,65062,
9003,65161,9001,65163,9001,102041,9003,102064,9085,102068,109030,102069,109031,102118,9003,102119,9002,102120,9003,102121,9003,102217,9003,102218,9001,102219,9003,102220,9003,102378,9002,102379,9002,102380,9001,102381,9002,102589,9003,102599,9003,102600,9003,102604,9003,102605,9001,102606,9001,102647,9001,102704,9003,102705,9003,102733,9003,102761,9003,102762,9001,102763,9003,102764,9001,102765,9001,102766,9003,102970,9002,102974,9003,102993,9001,102994,9001,102995,9003,102996,9003,103015,9001,103016,
9003,103017,9001,103018,9003,103025,9001,103026,9001,103027,9003,103028,9003,103035,9001,103036,9001,103037,9003,103038,9003,103039,9001,103040,9001,103041,9003,103042,9003,103043,9001,103044,9001,103045,9003,103046,9003,103047,9001,103048,9001,103049,9003,103050,9003,103051,9001,103052,9003,103053,9001,103054,9003,103055,9001,103056,9003,103057,9001,103058,9001,103059,9003,103060,9003,103061,9001,103062,9001,103063,9003,103064,9003,103069,9003,103070,9001,103071,9001,103072,9003,103073,9003,103086,
9001,103087,9001,103088,9003,103089,9003,103094,9002,103095,9001,103096,9003,103103,9001,103104,9003,103105,9001,103106,9003,103121,9001,103122,9003,103123,9001,103124,9001,103125,9002,103126,9002,103127,9001,103128,9001,103129,9003,103130,9003,103131,9001,103132,9001,103133,9003,103134,9003,103135,9001,103136,9001,103137,9002,103138,9002,103139,9001,103140,9003,103141,9001,103142,9003,103143,9001,103144,9003,103145,9001,103146,9002,103147,9001,103148,9001,103149,9003,103150,9003,103151,9001,103152,
9003,103172,9001,103173,9003,103174,9001,103175,9001,103176,9003,103177,9003,103178,9001,103179,9001,103180,9003,103181,9003,103182,9001,103183,9001,103184,9003,103185,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,
9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,
9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103695,9003,104020,9102,104139,9105,104140,9105,104223,9102,104286,9102,104287,9102,104304,9102,104305,9102,104896,9102]},l=function(){function d(){}d.xG=function(a){!1===
d.ul&&d.hq();var h=d.eU(a);if(-1==h){var b=d.Qv(a);b!=a&&(h=d.xG(b))}return h};d.eU=function(a){return void 0!==d.hv[a]?d.hv[a]:-1};d.uS=function(a){!1===d.ul&&d.hq();var h=d.KF(a);if(1E38==h){var b=d.Qv(a);b!=a&&(h=d.KF(b));if(1E38==h)return 1E-10}return h};d.SU=function(a){if(void 0!==d.$p[a])return!0;var h=d.Qv(a);return h!=a&&void 0!==d.$p[h]?!0:!1};d.UU=function(a){if(void 0!==d.Dj[a])return!0;var h=d.Qv(a);return h!=a&&void 0!==d.Dj[h]?!0:!1};d.KF=function(a){!1===d.ul&&d.hq();return void 0!==
d.$p[a]?d.$p[a]:void 0!==d.Dj[a]?d.Dj[a]:1E38};d.sZ=function(a){!1===d.ul&&d.hq();return void 0!==d.HC[a]?d.HC[a]:a};d.Qv=function(a){!1===d.ul&&d.hq();return void 0!==d.PC[a]?d.PC[a]:a};d.hq=function(){for(var a=b,l,e=0;e<a.pcsid.length;e+=2)d.Dj[a.pcsid[e]]=a.pcstol[2*a.pcsid[e+1]+1];for(e=0;e<a.pcsidc.length;e+=1){l=a.pcsidc[e];for(var f=l[0];f<=l[1];f++)d.Dj[f]=a.pcstol[2*l[2]+1]}for(e=0;e<a.gcsid.length;e+=2)d.$p[a.gcsid[e]]=a.gcstol[2*a.gcsid[e+1]+1];for(e=0;e<a.gcsidc.length;e+=1)for(l=a.gcsidc[e],
f=l[0];f<=l[1];f++)d.Dj[f]=a.gcstol[2*l[2]+1];for(e=0;e<c.c.length;e+=1)for(l=c.c[e],f=l[0];f<=l[1];f++)d.hv[f]=l[2];for(e=0;e<c.nc.length;e+=2)d.hv[c.nc[e]]=c.nc[e+1];c=null;for(e=0;e<a.newtoold.length;e+=2)d.HC[a.newtoold[e+1]]=a.newtoold[e],d.PC[a.newtoold[e]]=a.newtoold[e+1];b=null;d.ul=!0};d.ul=!1;d.$p=[];d.Dj=[];d.HC=[];d.PC=[];d.hv=[];return d}();a.us=l})(D||(D={}));(function(a){function b(d){return 0===d.length?'""':'"'==d[0]||"."==d[0]||"0"<=d[0]&&"9">=d[0]?d:'"'+d.trim()+'"'}var c=[],l=
function(){function d(){}d.wS=function(h){try{for(var l=0;l<c.length;l++)if(c[l].wkttext===h)return c[l].unit;for(var e,f=l="",g=!1,k=0;k<h.length;k++){var m=h[k];!0===g?'"'==m?'"'==h[k+1]?l+=m:g=!1:l+=m:/[\s]/.test(m)||(","==m?(f=""!==l?f+(b(l)+","):f+",",l=""):")"==m||"]"==m?(f=""!==l?f+(b(l)+"]}"):f+"]}",l=""):"("==m||"["==m?(f+='{ "entity": "'+l.toUpperCase().trim()+'", "values":[',l=""):'"'==m?(g=!0,l=""):l+=m)}e=JSON.parse(f);var A=d.pF(e);if(null===A)return null;e=null;for(m=0;m<A.values.length;m++)if("object"===
typeof A.values[m]&&"UNIT"===A.values[m].entity){e=A.values[m];break}if(null===e)return null;var q=a.oc.bR("GEOGCS"===A.entity?1:0,e.values[1],e.values[2]);c.push({wkttext:h,unit:q});10<c.length&&c.shift();return q}catch(Ca){return null}};d.pF=function(a){if(null===a)return null;if("GEOGCS"===a.entity||"PROJCS"===a.entity)return a;for(var h=[],b=0;b<a.values.length;b++)if("object"===typeof a.values[b]&&void 0!==a.values[b].entity){if("GEOGCS"===a.values[b].entity||"PROJCS"==a.values[b].entity)return a.values[b];
h.push(a.values[b])}for(a=0;a<h.length;a++)if(b=d.pF(h[a]),null!==b)return b;return null};d.vS=function(d){var a=-1;if(null!=d&&0<d.length){var h,b;h=d.indexOf("PROJCS");if(0<=h){var l=0;h=d.lastIndexOf("UNIT");if(0<=h&&(h=d.indexOf(",",h+4),0<h&&(h++,b=d.indexOf("]",h+1),0<b)))try{l=parseFloat(d.substring(h,b))}catch(ea){l=0}0<l&&(a=.001/l)}else if(h=d.indexOf("GEOGCS"),0<=h){var c=0,l=0;h=d.indexOf("SPHEROID",h+6);if(0<h&&(h=d.indexOf(",",h+8),0<h)){h++;b=d.indexOf(",",h+1);if(0<b)try{c=parseFloat(d.substring(h,
b))}catch(ea){c=0}if(0<c&&(h=d.indexOf("UNIT",b+1),0<=h&&(h=d.indexOf(",",h+4),0<h&&(h++,b=d.indexOf("]",h+1),0<b))))try{l=parseFloat(d.substring(h,b))}catch(ea){l=0}}0<c&&0<l&&(a=.001/(c*l))}}return a};return d}();a.oE=l})(D||(D={}));(function(a){(function(a){a[a.NONE=0]="NONE";a[a.LINEAR=1]="LINEAR";a[a.ANGULAR=2]="ANGULAR"})(a.FM||(a.FM={}));(function(a){a[a.enumFloat=0]="enumFloat";a[a.enumDouble=1]="enumDouble";a[a.enumInt32=2]="enumInt32";a[a.enumInt64=3]="enumInt64";a[a.enumInt8=4]="enumInt8";
a[a.enumInt16=5]="enumInt16"})(a.GN||(a.GN={}));(function(a){a[a.POSITION=0]="POSITION";a[a.Z=1]="Z";a[a.M=2]="M";a[a.ID=3]="ID";a[a.NORMAL=4]="NORMAL";a[a.TEXTURE1D=5]="TEXTURE1D";a[a.TEXTURE2D=6]="TEXTURE2D";a[a.TEXTURE3D=7]="TEXTURE3D";a[a.ID2=8]="ID2";a[a.MAXSEMANTICS=10]="MAXSEMANTICS"})(a.Wc||(a.Wc={}));var b=function(){function b(a,d){this.Qt=this.af=null;this.Er=this.Ga=0;this.Sh=this.wg=null;this.bm=0;if(void 0!==d){this.Ga=d.Ga;this.Er=d.Er;this.wg=d.wg.slice(0);this.Sh=d.Sh.slice(0);this.bm=
d.bm;this.Qt=[];for(d=a=0;d<this.Ga;d++)this.Qt[d]=a,a+=b.Xa(this.wg[d]);this.Er=a;this.af=[];for(d=0;d<this.Ga;d++){a=b.Xa(this.rd(d));for(var h=b.de(this.rd(d)),l=0;l<a;l++)this.af[this.Qt[d]+l]=h}}else this.Er=this.Ga=0}b.prototype.rd=function(b){if(0>b||b>this.Ga)throw a.g.F();return this.wg[b]};b.prototype.mg=function(a){return this.Sh[a]};b.Wz=function(a){return b.tc[a]};b.si=function(a){return b.bd[a]};b.Mg=function(a){return b.fe[a]};b.Cj=function(a){return b.Mg(b.si(a))*b.Xa(a)};b.Xa=function(a){return b.Bb[a]};
b.Wg=function(a){return 2>a};b.rk=function(a){return b.Wg(b.si(a))};b.prototype.hasAttribute=function(a){return 0<=this.Sh[a]};b.prototype.uH=function(){return this.hasAttribute(1)};b.de=function(a){return b.$[a]};b.prototype.ET=function(a){return this.Qt[a]};b.PH=function(a,d){return b.$[a]===d};b.Oi=function(b){if(4==b)return 2;if(8==b)return 3;throw a.g.F();};b.prototype.Eb=function(a){return this===a};b.prototype.Ak=function(){for(var b=a.J.dh(this.wg[0]),d=1;d<this.Ga;d++)b=a.J.dh(this.wg[d],
b);return b};b.prototype.xk=function(a){return this.Qt[a]};b.prototype.jc=function(){return this.bm};b.prototype.Td=function(a){return this.wg[a]};b.$=[0,0,NaN,0,0,0,0,0,0];b.tc=[1,1,1,0,2,1,1,1,0];b.bd=[1,1,1,2,0,0,0,0,2];b.fe=[4,8,4,8,1,2];b.Bb=[2,1,1,1,3,1,2,3,2];return b}();a.ma=b})(D||(D={}));(function(a){function b(d,a,b,l){var h=d.Jd,e=d.e+a+1;1===b?l=5<=h[e]:2===b?l=5<h[e]||5==h[e]&&(l||0>e||void 0!==h[e+1]||h[e-1]&1):3===b?l=l||void 0!==h[e]||0>e:(l=!1,0!==b&&c("!Big.RM!"));if(1>e||!h[0])l?
(d.e=-a,d.Jd=[1]):d.Jd=[d.e=0];else{h.length=e--;if(l)for(;9<++h[e];)h[e]=0,e--||(++d.e,h.unshift(1));for(e=h.length;!h[--e];h.pop());}}function c(d){d=Error(d);d.name="BigError";throw d;}var l=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d=function(){function d(a){if(a instanceof d)this.me=a.me,this.e=a.e,this.Jd=a.Jd.slice();else{var h,b,e;0===a&&0>1/a?a="-0":l.test(a+="")||c(NaN);this.me="-"==a.charAt(0)?(a=a.slice(1),-1):1;-1<(h=a.indexOf("."))&&(a=a.replace(".",""));0<(b=a.search(/e/i))?(0>h&&(h=b),
h+=+a.slice(b+1),a=a.substring(0,b)):0>h&&(h=a.length);for(b=0;"0"==a.charAt(b);b++);if(b==(e=a.length))this.Jd=[this.e=0];else{for(;"0"==a.charAt(--e););this.e=h-b-1;this.Jd=[];for(h=0;b<=e;this.Jd[h++]=+a.charAt(b++));}}}d.prototype.abs=function(){var a=new d(this);a.me=1;return a};d.prototype.RF=function(){var a=0,h=this.Jd,b=(a=new d(a)).Jd,l=this.me,c=a.me,e=this.e,f=a.e;if(!h[0]||!b[0])return h[0]?l:b[0]?-c:0;if(l!=c)return l;a=0>l;if(e!=f)return e>(f^a)?1:-1;l=-1;for(c=(e=h.length)<(f=b.length)?
e:f;++l<c;)if(h[l]!=b[l])return h[l]>(b[l]^a)?1:-1;return e==f?0:e>(f^a)?1:-1};d.prototype.Wm=function(a){var h=this.Jd,l=(a=new d(a)).Jd,e=this.me==a.me?1:-1,r=d.bd;(r!==~~r||0>r||1E6<r)&&c("!Big.DP!");if(!h[0]||!l[0])return h[0]==l[0]&&c(NaN),l[0]||c(e/0),new d(0*e);var f,g,k,m,A=l.slice(),q=f=l.length,n=h.length,w=h.slice(0,f),x=w.length,p=a,u=p.Jd=[],B=0,z=r+(p.e=this.e-a.e)+1;p.me=e;e=0>z?0:z;for(A.unshift(0);x++<f;w.push(0));do{for(g=0;10>g;g++){if(f!=(x=w.length))k=f>x?1:-1;else for(m=-1,k=
0;++m<f;)if(l[m]!=w[m]){k=l[m]>w[m]?1:-1;break}if(0>k){for(a=x==f?l:A;x;){if(w[--x]<a[x]){for(m=x;m&&!w[--m];w[m]=9);--w[m];w[x]+=10}w[x]-=a[x]}for(;!w[0];w.shift());}else break}u[B++]=k?g:++g;w[0]&&k?w[x]=h[q]||0:w=[h[q]]}while((q++<n||void 0!==w[0])&&e--);u[0]||1==B||(u.shift(),p.e--);B>z&&b(p,r,d.Mg,void 0!==w[0]);return p};d.prototype.$T=function(){return 0<this.RF()};d.prototype.oV=function(){return 0>this.RF()};d.prototype.Zt=function(a){var h,b,l=this.me,c=(a=new d(a)).me;if(l!=c)return a.me=
-c,this.EJ(a);var e=this.Jd.slice();b=this.e;var r=a.Jd,f=a.e;if(!e[0]||!r[0])return r[0]?(a.me=-c,a):new d(e[0]?this:0);if(l=b-f){(h=0>l)?(l=-l,b=e):(f=b,b=r);b.reverse();for(c=l;c--;b.push(0));b.reverse()}else for(b=((h=e.length<r.length)?e:r).length,l=c=0;c<b;c++)if(e[c]!=r[c]){h=e[c]<r[c];break}h&&(b=e,e=r,r=b,a.me=-a.me);if(0<(c=(b=r.length)-(h=e.length)))for(;c--;e[h++]=0);for(c=h;b>l;){if(e[--b]<r[b]){for(h=b;h&&!e[--h];e[h]=9);--e[h];e[b]+=10}e[b]-=r[b]}for(;0==e[--c];e.pop());for(;0==e[0];)e.shift(),
--f;e[0]||(a.me=1,e=[f=0]);a.Jd=e;a.e=f;return a};d.prototype.EJ=function(a){var h,b=this.me;h=(a=new d(a)).me;if(b!=h)return a.me=-h,this.Zt(a);h=this.e;var l=this.Jd,c=a.e,e=a.Jd;if(!l[0]||!e[0])return e[0]?a:new d(l[0]?this:0*b);l=l.slice();if(b=h-c){0<b?(c=h,h=e):(b=-b,h=l);for(h.reverse();b--;h.push(0));h.reverse()}0>l.length-e.length&&(h=e,e=l,l=h);b=e.length;for(h=0;b;)h=(l[--b]=l[b]+e[b]+h)/10|0,l[b]%=10;h&&(l.unshift(h),++c);for(b=l.length;0==l[--b];l.pop());a.Jd=l;a.e=c;return a};d.prototype.pow=
function(a){var h=this,b=new d(1),l=b,e=0>a;(a!==~~a||-1E6>a||1E6<a)&&c("!pow!");for(a=e?-a:a;;){a&1&&(l=l.ds(h));a>>=1;if(!a)break;h=h.ds(h)}return e?b.Wm(l):l};d.prototype.round=function(a,h){var l=this;null==a?a=0:(a!==~~a||0>a||1E6<a)&&c("!round!");b(l=new d(l),a,null==h?d.Mg:h);return l};d.prototype.sqrt=function(){var a,h,l;h=this.Jd;a=this.me;l=this.e;var e=new d("0.5");if(!h[0])return new d(this);0>a&&c(NaN);a=Math.sqrt(this.toString());0==a||a==1/0?(a=h.join(""),a.length+l&1||(a+="0"),h=
new d(Math.sqrt(a).toString()),h.e=((l+1)/2|0)-(0>l||l&1)):h=new d(a.toString());a=h.e+(d.bd+=4);do l=h,h=e.ds(l.EJ(this.Wm(l)));while(l.Jd.slice(0,a).join("")!==h.Jd.slice(0,a).join(""));b(h,d.bd-=4,d.Mg);return h};d.prototype.ds=function(a){var h,b=this.Jd,l=(a=new d(a)).Jd,c=b.length,e=l.length,r=this.e,f=a.e;a.me=this.me==a.me?1:-1;if(!b[0]||!l[0])return new d(0*a.me);a.e=r+f;c<e&&(h=b,b=l,l=h,f=c,c=e,e=f);for(h=Array(f=c+e);f--;h[f]=0);for(r=e;r--;){e=0;for(f=c+r;f>r;)e=h[f]+l[r]*b[f-r-1]+e,
h[f--]=e%10,e=e/10|0;h[f]=(h[f]+e)%10}e&&++a.e;h[0]||h.shift();for(r=h.length;!h[--r];h.pop());a.Jd=h;return a};d.prototype.toString=function(){var d=this.e,a=this.Jd.join(""),h=a.length;if(-7>=d||21<=d)a=a.charAt(0)+(1<h?"."+a.slice(1):"")+(0>d?"e":"e+")+d;else if(0>d){for(;++d;a="0"+a);a="0."+a}else if(0<d)if(++d>h)for(d-=h;d--;a+="0");else d<h&&(a=a.slice(0,d)+"."+a.slice(d));else 1<h&&(a=a.charAt(0)+"."+a.slice(1));return 0>this.me&&this.Jd[0]?"-"+a:a};d.bd=20;d.Mg=1;return d}();a.Tp=d})(D||(D=
{}));(function(a){var b=function(){function b(d){this.Nf=d}b.prototype.hs=function(d,h,b){var l=new a.b,c=new a.b,e=this.Nf;b.Gd(d,h,function(d,a){e.fc(2*d,l);e.fc(2*a,c);return l.compare(c)})};b.prototype.Qq=function(d){return this.Nf.read(2*d+1)};return b}(),c=function(){function l(){}l.Rq=function(d){if(d.u())return!1;var h=d.G();return 1736==h?0==d.hf()?!1:!0:1607==h?(h=[!1],l.mE(d,!0,h),h[0]):197==h||a.T.Oc(h)&&!d.OH()?!0:!1};l.Rm=function(d){var h=d.G();if(1736==h)return h=new a.Ua(d.description),
d.u()||d.xE(h),h;if(1607==h)return l.mE(d,!1,null);if(197==h)return h=new a.Ua(d.description),d.u()||h.jd(d,!1),h;if(a.T.Oc(h)){h=new a.Ed(d.description);if(!d.u()&&!d.OH()){var b=new a.Wa;d.Dp(b);h.add(b);d.Bp(b);h.add(b)}return h}if(a.T.Jo(h))return null;throw a.g.F();};l.mE=function(d,h,l){null!=l&&(l[0]=!1);var c=null;h||(c=new a.Ed(d.description));if(!d.u()){var e=new a.ia(0);e.yb(2*d.aa());for(var r=0,f=d.aa();r<f;r++)if(0<d.La(r)&&!d.Eo(r)){var g=d.wa(r);e.add(g);g=d.Gc(r)-1;e.add(g)}if(0<
e.size){f=new a.Hu;r=d.Pa(0);f.sort(e,0,e.size,new b(r));f=new a.b;r.fc(2*e.get(0),f);for(var g=0,k=1,m=new a.Wa,A=new a.b,q=1,n=e.size;q<n;q++)if(r.fc(2*e.get(q),A),A.ub(f))e.get(g)>e.get(q)?(e.set(g,2147483647),g=q):e.set(q,2147483647),k++;else{if(0==(k&1))e.set(g,2147483647);else if(h)return null!=l&&(l[0]=!0),null;f.L(A);g=q;k=1}if(0==(k&1))e.set(g,2147483647);else if(h)return null!=l&&(l[0]=!0),null;if(!h)for(e.Gd(0,e.size,function(d,a){return d-a}),q=0,n=e.size;q<n&&2147483647!=e.get(q);q++)d.Ae(e.get(q),
m),c.add(m)}}return h?null:c};return l}();a.Pi=c})(D||(D={}));(function(a){var b=function(){function b(){this.ag=new a.ia(0);this.ut=new a.ia(0);this.UI=1;this.At=NaN}b.prototype.sort=function(a,d,h,b){if(32>h-d)b.hs(d,h,a);else{var l=!0;try{for(var c=Infinity,e=-Infinity,r=d;r<h;r++){var f=b.Qq(a.get(r));f<c&&(c=f);f>e&&(e=f)}if(this.reset(h-d,c,e,h-d)){for(r=d;r<h;r++){var g=a.get(r),f=b.Qq(g),k=this.LG(f);this.ag.set(k,this.ag.get(k)+1);this.ut.write(r-d,g)}var m=this.ag.get(0);this.ag.set(0,0);
for(var r=1,A=this.ag.size;r<A;r++){var q=this.ag.get(r);this.ag.set(r,m);m+=q}for(r=d;r<h;r++){var g=this.ut.read(r-d),f=b.Qq(g),k=this.LG(f),n=this.ag.get(k);a.set(n+d,g);this.ag.set(k,n+1)}l=!1}}catch(ya){this.ag.resize(0),this.ut.resize(0)}if(l)b.hs(d,h,a);else{r=h=0;for(A=this.ag.size;r<A;r++)l=h,h=this.ag.get(r),h>l&&b.hs(d+l,d+h,a);100<this.ag.size&&(this.ag.resize(0),this.ut.resize(0))}}};b.prototype.reset=function(a,d,h,c){if(2>a||h==d)return!1;a=Math.min(b.QV,a);this.ag.yb(a);this.ag.resize(a);
this.ag.Zh(0,0,this.ag.size);this.UI=d;this.ut.resize(c);this.At=(h-d)/(a-1);return!0};b.prototype.LG=function(b){return a.J.truncate((b-this.UI)/this.At)};b.QV=65536;return b}();a.Hu=b})(D||(D={}));(function(a){var b;(function(d){d[d.enum_line=1]="enum_line";d[d.enum_arc=2]="enum_arc";d[d.enum_dummy=4]="enum_dummy";d[d.enum_concave_dip=8]="enum_concave_dip";d[d.enum_connection=3]="enum_connection"})(b||(b={}));var c=function(){function d(){}d.Ev=function(h,b,l,c,e,r){var f=new d;f.un=new a.b;f.In=
new a.b;f.Ow=new a.b;f.un.L(h);f.In.L(b);f.Ow.L(l);f.qp=c;f.Nh=e;f.Qh=r;return f};d.pa=function(h,b,l,c){var e=new d;e.un=new a.b;e.In=new a.b;e.Ow=new a.b;e.un.L(h);e.In.L(b);e.Ow.$c();e.qp=4;e.Nh=l;e.Qh=c;return e};return d}(),l=function(){function d(d,a,h,b,l,c){this.Lw=null;this.Ca=0;this.jB=d;this.oJ=this.mJ=0;this.Qa=a;this.fk=h;this.Xk=b;this.tr=l;this.lc=c}d.prototype.next=function(){for(var d=new a.Wa;;){if(this.Ca==this.jB.D())return null;this.jB.Ae(this.Ca,d);this.Ca++;if(!d.u())break}var h=
!1;null==this.Lw&&(this.mJ=d.Be(),this.oJ=d.nf(),this.Lw=e.buffer(d,this.Qa,this.fk,this.Xk,this.tr,this.lc),h=!0);var b;this.Ca<this.jB.D()?(b=new a.Ja,this.Lw.copyTo(b)):b=this.Lw;if(!h){var h=new a.Hd,l=d.Be()-this.mJ,d=d.nf()-this.oJ;h.Ag(l,d);b.Xc(h)}return b};d.prototype.Ia=function(){return 0};d.prototype.Re=function(){return!0};return d}(),d=function(){function d(d,a){this.$a=d;this.Ca=0;this.dr=a}d.prototype.next=function(){var d=this.$a.Y;if(this.Ca<d.aa()){var h=this.Ca;this.Ca++;if(!d.Eo(h))for(var b=
d.Ba(d.Gc(h)-1);this.Ca<d.aa();){var l=d.Ba(d.wa(this.Ca));if(d.Eo(this.Ca))break;if(l!=b)break;b=d.Ba(d.Gc(this.Ca)-1);this.Ca++}if(1==this.Ca-h)return this.$a.xF(this.$a.Y,h,this.dr);b=new a.Ua(this.$a.Y.description);b.Ti(this.$a.Y,h,!0);for(h+=1;h<this.Ca;h++)b.Bs(this.$a.Y,h,0,d.ew(h),!1);return this.$a.xF(b,0,this.dr)}return null};d.prototype.Ia=function(){return 0};d.prototype.Re=function(){return!0};return d}(),h=function(){function d(d){this.$a=d;this.Ca=0}d.prototype.next=function(){var d=
this.$a.Y;if(this.Ca<d.aa()){var a=this.Ca;d.Sm(this.Ca);for(this.Ca++;this.Ca<d.aa()&&!(0<d.Sm(this.Ca));)this.Ca++;return 0==a&&this.Ca==d.aa()?this.$a.Wy(d,0,d.aa()):this.$a.Wy(d,a,this.Ca)}return null};d.prototype.Ia=function(){return 0};d.prototype.Re=function(){return!0};return d}(),e=function(){function b(d){this.Ft=this.Zw=this.Gt=this.Wd=null;this.te=[];this.lc=d;this.vb=this.xw=this.HV=this.Qa=this.ZA=this.Vt=this.ta=0;this.WA=this.Xk=-1;this.dr=!0}b.buffer=function(d,h,l,c,e,r){if(null==
d)throw a.g.F();if(0>c)throw a.g.F();if(d.u())return new a.Ja(d.description);var f=new a.h;d.ac(f);0<h&&f.O(h,h);r=new b(r);r.fk=l;r.Y=d;r.ta=a.na.be(l,f,!0);r.Vt=a.na.be(null,f,!0);r.Qa=h;r.HV=d.G();0>=e&&(e=96);r.vb=Math.abs(r.Qa);r.xw=0!=r.vb?1/r.vb:0;isNaN(c)||0==c?c=1E-5*r.vb:c>.5*r.vb&&(c=.5*r.vb);12>e&&(e=12);d=Math.abs(h)*(1-Math.cos(Math.PI/e));d>c?c=d:(d=Math.PI/Math.acos(1-c/Math.abs(h)),d<e-1&&(e=a.J.truncate(d),12>e&&(e=12,c=Math.abs(h)*(1-Math.cos(Math.PI/e)))));r.Xk=c;r.tr=e;r.ZA=Math.min(r.Vt,
.25*c);return r.yF()};b.prototype.Rv=function(){if(null==this.Wd)this.Wd=[];else if(0!==this.Wd.length)return;var d=this.CF(),d=a.J.truncate((d+3)/4),h=.5*Math.PI/d;this.WA=h;for(var b=0;b<4*d;b++)this.Wd.push(null);for(var l=Math.cos(h),h=Math.sin(h),c=a.b.pa(0,1),b=0;b<d;b++)this.Wd[b+0*d]=a.b.pa(c.y,-c.x),this.Wd[b+1*d]=a.b.pa(-c.x,-c.y),this.Wd[b+2*d]=a.b.pa(-c.y,c.x),this.Wd[b+3*d]=c,c=a.b.pa(c.x,c.y),c.qu(l,h)};b.prototype.yF=function(){var d=this.Y.G();if(a.T.Oc(d))return d=new a.Ua(this.Y.description),
d.dc(this.Y,!0),this.Y=d,this.yF();if(this.Qa<=this.ta)if(a.T.OU(d)){if(0>=this.Qa&&(d=new a.h,this.Y.s(d),d.N()<=2*-this.Qa||d.fa()<=2*this.Qa))return new a.Ja(this.Y.description)}else return new a.Ja(this.Y.description);switch(this.Y.G()){case 33:return this.SP();case 550:return this.RP();case 1607:return this.UP();case 1736:return this.TP();case 197:return this.PP();default:throw a.g.za();}};b.prototype.UP=function(){if(this.QH(this.Y)){var h=new a.Wa;this.Y.Ae(0,h);var b=new a.h;this.Y.s(b);h.rb(b.Wf());
return this.rv(h)}this.Y=this.OW(this.Y);h=new d(this,this.dr);return a.ei.local().V(h,this.fk,this.lc).next()};b.prototype.TP=function(){if(0==this.Qa)return this.Y;var d=a.Km.local();this.Rv();this.Y=d.V(this.Y,null,!1,this.lc);if(0>this.Qa){var b=this.Y,b=this.Wy(b,0,b.aa());return d.V(b,this.fk,!1,this.lc)}if(this.QH(this.Y))return d=new a.Wa,this.Y.Ae(0,d),b=new a.h,this.Y.s(b),d.rb(b.Wf()),this.rv(d);d=new h(this);return a.ei.local().V(d,this.fk,this.lc).next()};b.prototype.Wy=function(d,h,
l){for(var c=new a.Ja(d.description);h<l;h++)if(!(1>d.La(h))){var e=d.Sm(h),r=new a.h;d.jk(h,r);if(0<this.Qa)if(0<e)if(this.RH(d,h))e=new a.Wa,d.Ae(d.wa(h),e),e.rb(r.Wf()),this.iv(c,e);else{var f=e=new a.Ua(d.description),f=a.Ju.VH(this.Y,h)||2==this.to(this.Y,h,f,!0,1)?this.wF(d,h):this.so(e);c.add(f,!1)}else{if(!(r.N()+this.ta<=2*this.vb||r.fa()+this.ta<=2*this.vb||(f=e=new a.Ua(d.description),this.to(this.Y,h,f,!0,1),e.u()))){var g=new a.h;g.I(r);g.O(this.vb,this.vb);f.oq(g);f=this.so(e);r=1;for(e=
f.aa();r<e;r++)c.Ti(f,r,!0)}}else if(0<e){if(!(r.N()+this.ta<=2*this.vb||r.fa()+this.ta<=2*this.vb||(f=e=new a.Ua(d.description),this.to(this.Y,h,f,!0,-1),e.u())))for(g=new a.h,f.ac(g),g.O(this.vb,this.vb),f.oq(g),f=this.so(e),r=1,e=f.aa();r<e;r++)c.Ti(f,r,!0)}else for(f=e=new a.Ua(d.description),this.to(this.Y,h,f,!0,-1),f=this.so(e),r=0,e=f.aa();r<e;r++)c.Ti(f,r,!0)}if(0<this.Qa)return 1<c.aa()?c=this.so(c):b.We(c);d=new a.h;c.ac(d);if(c.u())return b.We(c);d.O(this.vb,this.vb);c.oq(d);c=this.so(c);
d=new a.Ja(c.description);r=1;for(e=c.aa();r<e;r++)d.Ti(c,r,!1);return b.We(d)};b.prototype.SP=function(){return this.rv(this.Y)};b.prototype.rv=function(d){var h=new a.Ja(this.Y.description);this.iv(h,d);return this.nY(h)};b.prototype.RP=function(){var d=new l(this.Y,this.Qa,this.fk,this.Xk,this.tr,this.lc);return a.ei.local().V(d,this.fk,this.lc).next()};b.prototype.PP=function(){var d=new a.Ja(this.Y.description);if(0>=this.Qa){if(0==this.Qa)d.jd(this.Y,!1);else{var h=new a.ci;this.Y.Qn(h);h.O(this.Qa,
this.Qa);d.jd(h,!1)}return d}d.jd(this.Y,!1);this.Y=d;return this.wF(d,0)};b.prototype.wF=function(d,h){this.Rv();var l=new a.Ja(d.description),c=new a.b,e=new a.b,r=new a.b,f=new a.b,g=new a.b,k=new a.b,y=new a.b,m=new a.b,A=d.La(h),H=d.wa(h),q=0;for(h=d.La(h);q<h;q++){d.w(H+q,e);d.w(H+(q+1)%A,f);d.w(H+(q+2)%A,k);y.zc(f,e);if(0==y.length())throw a.g.za();y.uw();y.normalize();y.scale(this.vb);c.add(y,e);r.add(y,f);0==q?l.zu(c):l.aj(c);l.aj(r);m.zc(k,f);if(0==m.length())throw a.g.za();m.uw();m.normalize();
m.scale(this.vb);g.add(m,f);this.XE(l,f,r,g,!1)}return b.We(l)};b.prototype.xF=function(d,h,b){this.Rv();if(1>d.La(h))return null;if(this.RH(d,h)&&0<this.Qa){b=new a.Wa;d.Ae(d.wa(h),b);var l=new a.h;d.jk(h,l);b.rb(l.Wf());return this.rv(b)}l=new a.Ua(d.description);if(d.Eo(h))this.to(d,h,l,b,1),this.to(d,h,l,b,-1);else{var c=new a.Ua(d.description);c.Ti(d,h,!1);c.Bs(d,h,0,d.ew(h),!1);this.to(c,0,l,b,1)}return this.so(l)};b.prototype.Pr=function(){this.kx++};b.prototype.so=function(d){return a.Dg.ol(d,
this.Vt,!0,!0,this.lc)};b.prototype.CF=function(){if(0==this.Xk)return this.tr;var d=1-this.Xk*Math.abs(this.xw),h;-1>d?h=4:h=2*Math.PI/Math.acos(d)+.5;4>h?h=4:h>this.tr&&(h=this.tr);return a.J.truncate(h)};b.prototype.XE=function(d,h,b,l,c){this.Rv();var e=new a.b;e.zc(b,h);e.scale(this.xw);var r=new a.b;r.zc(l,h);r.scale(this.xw);e=Math.atan2(e.y,e.x)/this.WA;0>e&&(e=this.Wd.length+e);e=this.Wd.length-e;r=Math.atan2(r.y,r.x)/this.WA;0>r&&(r=this.Wd.length+r);r=this.Wd.length-r;r<e&&(r+=this.Wd.length);
var f=a.J.truncate(r),r=a.J.truncate(Math.ceil(e)),e=new a.b;e.L(this.Wd[r%this.Wd.length]);e.ru(this.vb,h);var g=10*this.ta;e.sub(b);e.length()<g&&(r+=1);e.L(this.Wd[f%this.Wd.length]);e.ru(this.vb,h);e.sub(l);e.length()<g&&--f;b=f-r;b++;f=0;for(r%=this.Wd.length;f<b;f++,r=(r+1)%this.Wd.length)e.L(this.Wd[r]),e.ru(this.vb,h),d.aj(e),this.Pr();c&&d.aj(l)};b.prototype.to=function(d,h,b,l,e){var r=new a.fd,f=r.kP(d,h);r.zq(this.ZA,!1,!1);if(2>r.D(f)){if(0>e)return 1;e=d;r=new a.Wa;e.Ae(e.wa(h),r);this.iv(b,
r);return 1}var g=r.Ba(r.cb(r.Pb(f))),k=new a.Hd;k.Ag(-g.x,-g.y);r.Xc(k);if(l&&(this.oS(r,f,e),2>r.D(f))){if(0>e)return 1;e=d;r=new a.Wa;e.Ae(e.wa(h),r);this.iv(b,r);return 1}this.te.length=0;var y=r.Pb(f);h=r.cb(y);var m=1==e?r.Ra(h):r.U(h);d=1==e?r.U(h):r.Ra(h);var A=!0;l=new a.b;for(var f=new a.b,q=new a.b,H=new a.b,n=new a.b,w=new a.b,x=new a.b,p=new a.b,u=new a.b,P=new a.b,B=this.vb,y=r.La(y),z=0;z<y;z++)r.w(d,f),A&&(r.w(h,l),r.w(m,q),p.zc(l,q),p.normalize(),P.aI(p),P.scale(B),H.add(P,l)),x.zc(f,
l),x.normalize(),u.aI(x),u.scale(B),n.add(l,u),m=p.Ui(x),A=p.oi(x),0>m||0>A&&0==m?this.te.push(c.Ev(H,n,l,2,this.te.length+1,this.te.length-1)):H.ub(n)||(this.te.push(c.pa(H,l,this.te.length+1,this.te.length-1,"dummy")),this.te.push(c.pa(l,n,this.te.length+1,this.te.length-1,"dummy"))),w.add(f,u),this.te.push(c.Ev(n,w,l,1,this.te.length+1,this.te.length-1)),H.L(w),P.L(u),q.L(l),l.L(f),p.L(x),m=h,h=d,A=!1,d=1==e?r.U(h):r.Ra(h);this.te[this.te.length-1].Nh=0;this.te[0].Qh=this.te.length-1;this.QW(b);
k.Ag(g.x,g.y);b.kF(k,b.aa()-1);return 1};b.prototype.QW=function(d){for(var a=this.CQ(),h=!0,b=a+1,l=a;b!=a;l=b){var c=this.te[l],b=-1!=c.Nh?c.Nh:(l+1)%this.te.length;0!=c.qp&&(h&&d.zu(c.un),2==c.qp?this.XE(d,c.Ow,c.un,c.In,!0):d.aj(c.In),h=!1)}};b.prototype.CQ=function(){null==this.Ft&&(this.Ft=[null,null,null,null,null,null,null,null,null]);for(var d=0,h=0,b=this.te.length;h<b;){var l=this.te[h];if(0!=(l.qp&3)){d=h;break}h=l.Nh}b=d+1;for(h=d;b!=d;h=b){for(var l=this.te[h],b=l.Nh,c=1,e=null;b!=h;){e=
this.te[b];if(0!=(e.qp&3))break;b=e.Nh;c++}1!=c&&1==(l.qp&e.qp)&&(null==this.Gt&&(this.Gt=new a.Hb,this.Zw=new a.Hb),this.Gt.Mc(l.un),this.Gt.Zc(l.In),this.Zw.Mc(e.un),this.Zw.Zc(e.In),1==this.Gt.Ma(this.Zw,this.Ft,null,null,this.Vt)&&(l.In.L(this.Ft[0]),e.un.L(this.Ft[0]),l.Nh=b,e.Qh=h))}return d};b.prototype.sw=function(d,h,b){var l=new a.b;l.zc(b,d);b=l.length();b=this.vb*this.vb-b*b*.25;if(0<b){b=Math.sqrt(b);l.normalize();l.Ur();var c=new a.b;c.zc(h,d);if(c.oi(l)+b>=this.vb)return!0}return!1};
b.prototype.oS=function(d,h,b){for(var l=0;1>l;l++){var c=!1,e=d.Pb(h),r=d.La(e);if(0==r)break;var f=r;if(3>r)break;!d.Qb(e)&&(f=r-1);for(var e=d.cb(e),r=0<b?d.Ra(e):d.U(e),g=0<b?d.U(e):d.Ra(e),k=r,y=!0,m=new a.b,A=new a.b,q=new a.b,H=new a.b,n=new a.b,w=a.b.pa(0,0),x=new a.b,p=new a.b,u=new a.b,P=new a.b,B=this.vb,z=0,v=0;v<f;){d.w(g,A);y&&(d.w(e,m),d.w(r,q),k=r);p.zc(m,q);p.normalize();x.zc(A,m);x.normalize();if(k==g)break;var t=p.Ui(x),C=p.oi(x),ba=!0;0>t||0>C&&0==t||!this.sw(q,m,A)||(w.L(A),ba=
!1,++z,c=!0);if(ba){if(0<z)for(;;){t=0<b?d.Ra(k):d.U(k);if(t==e)break;d.w(t,H);if(this.sw(H,q,w))q.L(H),k=t,ba=!1,++z;else{t!=g&&this.sw(H,q,A)&&this.sw(H,m,A)&&(q.L(H),k=t,ba=!1,++z);break}}if(!ba)continue;if(0<z){k=0<b?d.Ra(r):d.U(r);for(y=1;y<z;y++)ba=0<b?d.Ra(k):d.U(k),d.ud(k,!0),k=ba;u.zc(m,q);z=u.length();z=B*B-z*z*.25;z=Math.sqrt(z);B-z>.5*this.Xk?(n.add(q,m),n.scale(.5),u.normalize(),u.Ur(),P.L(u),P.scale(B-z),n.add(P),d.Qf(r,n)):d.ud(r,!0);z=0}q.L(m);k=e}m.L(A);r=e;e=g;g=0<b?d.U(e):d.Ra(e);
v++;y=!1}if(0<z){k=0<b?d.Ra(r):d.U(r);for(y=1;y<z;y++)ba=0<b?d.Ra(k):d.U(k),d.ud(k,!0),k=ba;n.add(q,m);n.scale(.5);u.zc(m,q);z=u.length();z=B*B-z*z*.25;z=Math.sqrt(z);u.normalize();u.Ur();P.L(u);P.scale(B-z);n.add(P);d.Qf(r,n)}d.zq(this.ZA,!1,!1);if(!c)break}};b.prototype.RH=function(d,h){if(1==d.La(h))return!0;var b=new a.h;d.jk(h,b);return Math.max(b.N(),b.fa())<.5*this.Xk?!0:!1};b.prototype.QH=function(d){var h=new a.h;d.s(h);return Math.max(h.N(),h.fa())<.5*this.Xk?!0:!1};b.prototype.OW=function(d){d=
a.GD.local().V(d,.25*this.Xk,!1,this.lc);for(var h=0,b=0,l=d.aa();b<l;b++)h=Math.max(d.La(b),h);if(32>h)return this.dr=!1,d;this.dr=!0;return a.Dg.ol(d,this.Vt,!1,!0,this.lc)};b.prototype.iv=function(d,h){h=h.w();if(null!=this.Wd&&0!==this.Wd.length){var b=new a.b;b.L(this.Wd[0]);b.ru(this.vb,h);d.zu(b);for(var l=1,c=this.Wd.length;l<c;l++)b.L(this.Wd[l]),b.ru(this.vb,h),d.aj(b)}else for(var l=this.CF(),b=a.J.truncate((l+3)/4),l=.5*Math.PI/b,c=Math.cos(l),e=Math.sin(l),r=new a.b,f=3;0<=f;f--){r.ka(0,
this.vb);switch(f){case 0:for(l=0;l<b;l++)d.Xj(r.x+h.x,r.y+h.y),r.qu(c,e);break;case 1:for(l=0;l<b;l++)d.Xj(-r.y+h.x,r.x+h.y),r.qu(c,e);break;case 2:for(l=0;l<b;l++)d.Xj(-r.x+h.x,-r.y+h.y),r.qu(c,e);break;default:for(d.$x(r.y+h.x,-r.x+h.y),l=1;l<b;l++)r.qu(c,e),d.Xj(r.y+h.x,-r.x+h.y)}this.Pr()}};b.We=function(d){d.Zg(1,0);return d};b.prototype.nY=function(d){d.Zg(2,this.ta);d.Al();return d};return b}();a.PL=e})(D||(D={}));(function(a){var b=function(){function b(b){this.Ha=b;this.a=new a.fd;this.od=
new a.ia(0)}b.prototype.ji=function(a,d,h){switch(d){case 0:if(a.o<h&&a.v<=h)break;else return a.o>=h?1:-1;case 1:if(a.A<h&&a.B<=h)break;else return a.A>=h?1:-1;case 2:if(a.o>=h&&a.v>h)break;else return a.v<=h?1:-1;case 3:if(!(a.A>=h&&a.B>h))return a.B<=h?1:-1}return 0};b.prototype.hz=function(a,d,h){return 1736==a.G()?this.iz(a,d,h):this.jz(a,d)};b.prototype.iz=function(b,d,h){if(0==this.Ha.N()||0==this.Ha.fa())return b.Ka();d=new a.h;b.ac(d);this.Y=this.a.Jb(b);var l=new a.h,c=new a.h,e=new a.b,
f=new a.b,g=[0,0,0,0,0,0,0,0,0],k=[0,0,0,0,0,0,0,0,0];new a.Cg;var m=new a.Hb,A=new a.ia(0);A.yb(Math.min(100,b.D()));for(var q=!1,n=0;!q&&4>n;n++){var w=!1,x=0!=(n&1),p=0;switch(n){case 0:p=this.Ha.o;w=d.o<=p&&d.v>=p;break;case 1:p=this.Ha.A;w=d.A<=p&&d.B>=p;break;case 2:p=this.Ha.v;w=d.o<=p&&d.v>=p;break;case 3:p=this.Ha.B,w=d.A<=p&&d.B>=p}if(w)for(q=!0,w=this.a.Pb(this.Y);-1!=w;){var u=-1,B=-1,z=this.a.cb(w),v=z;do{var t=this.a.ic(v);null==t&&(t=m,this.a.w(v,e),t.Mc(e),this.a.w(this.a.U(v),f),
t.Zc(f));t.s(l);var C=this.ji(l,n,p),E=0,F=-1;if(-1==C){t=t.Tq(x,p,g,k);0<t?E=this.a.zm(v,k,t):E=0;for(var E=E+1,D=v,G=this.a.U(D),t=0;t<E;t++){this.a.w(D,e);this.a.w(G,f);F=this.a.ic(D);null==F&&(F=m,F.Mc(e),F.Zc(f));F.s(c);F=this.ji(c,n,p);if(-1==F){if(x)F=Math.abs(e.y-p),aa=Math.abs(f.y-p),F<aa?(e.y=p,this.a.Qf(D,e)):(f.y=p,this.a.Qf(G,f));else{var F=Math.abs(e.x-p),aa=Math.abs(f.x-p);F<aa?(e.x=p,this.a.Qf(D,e)):(f.x=p,this.a.Qf(G,f))}F=this.a.ic(D);null==F&&(F=m,F.Mc(e),F.Zc(f));F.s(c);F=this.ji(c,
n,p)}aa=u;u=F;-1==B&&(B=u);if(0!=aa||1!=u)1==aa&&0==u||0!=aa||0!=u||A.add(D);1==u&&(q=!1);F=D=G;G=this.a.U(G)}}if(0==E){aa=u;u=C;-1==B&&(B=u);if(0!=aa||1!=u)1==aa&&0==u||0!=aa||0!=u||A.add(v);1==u&&(q=!1);F=this.a.U(v)}v=F}while(v!=z);0==B&&0==u&&A.add(z);t=0;for(u=A.size;t<u;t++)B=A.get(t),this.a.ud(B,!1);A.clear(!1);w=3>this.a.La(w)?this.a.Rr(w):this.a.Sb(w)}}if(q)return b.Ka();this.fC();0<h&&this.vz(h);return this.a.Se(this.Y)};b.prototype.jz=function(b){var d=new a.h,h=new a.h,l=[0,0,0,0,0,0,
0,0,0],c=[0,0,0,0,0,0,0,0,0],e=new a.Cg,f=b,g=new a.h;b.ac(g);for(var k=0;4>k;k++){var m=!1,A=0!=(k&1),q=0;switch(k){case 0:q=this.Ha.o;m=g.o<=q&&g.v>=q;break;case 1:q=this.Ha.A;m=g.A<=q&&g.B>=q;break;case 2:q=this.Ha.v;m=g.o<=q&&g.v>=q;break;case 3:q=this.Ha.B,m=g.A<=q&&g.B>=q}if(m){m=f;f=b.Ka();m=m.Fa();m.yj();for(var n,w=new a.b;m.Ya();)for(var x,p=!0;m.Ea();){var u=m.ba();u.s(d);var B=this.ji(d,k,q);if(-1==B){if(B=u.Tq(A,q,l,c),0<B){var z=0;n=u.ec();for(var v=0;v<=B;v++)if(x=v<B?c[v]:1,z!=x){u.yh(z,
x,e);var t=e.get();t.Mc(n);v<B&&(A?(w.x=l[v],w.y=q):(w.x=q,w.y=l[v]),t.Zc(w));t.s(h);var C=this.ji(h,k,q);if(-1==C){n=t.ec();z=t.Cc();if(A)C=Math.abs(n.y-q),E=Math.abs(z.y-q),C<E?(n.y=q,t.Mc(n)):(z.y=q,t.Zc(z));else{var C=Math.abs(n.x-q),E=Math.abs(z.x-q);C<E?(n.x=q,t.Mc(n)):(z.x=q,t.Zc(z))}t.s(h);C=this.ji(h,k,q)}n=t.Cc();z=x;x=C;1==x?(f.dc(t,p),p=!1):p=!0}}}else x=B,1==x?(f.dc(u,p),p=!1):p=!0}}}return f};b.prototype.fC=function(){this.Ki=-1;this.Am(!1,this.Ha.o);this.Am(!1,this.Ha.v);this.Am(!0,
this.Ha.A);this.Am(!0,this.Ha.B);this.od.resize(0);this.od.yb(100);this.Ki=this.a.Vd();for(var b=new a.b,d=this.a.Pb(this.Y);-1!=d;d=this.a.Sb(d))for(var h=this.a.cb(d),c=0,e=this.a.La(d);c<e;c++,h=this.a.U(h))if(this.a.w(h,b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(h,this.Ki,this.od.size),this.od.add(h);this.sm(!1,this.Ha.o);this.sm(!1,this.Ha.v);this.sm(!0,this.Ha.A);this.sm(!0,this.Ha.B);this.Cz()};b.prototype.vz=function(b){for(var d=new a.b,h=new a.b,l=a.J.gf(2048,
0),c=this.a.Pb(this.Y);-1!=c;c=this.a.Sb(c)){var e=this.a.cb(c),f=e;do{var g=this.a.U(f);this.a.w(f,d);var k=-1;d.x==this.Ha.o?(this.a.w(g,h),h.x==this.Ha.o&&(k=1)):d.x==this.Ha.v&&(this.a.w(g,h),h.x==this.Ha.v&&(k=1));d.y==this.Ha.A?(this.a.w(g,h),h.y==this.Ha.A&&(k=0)):d.y==this.Ha.B&&(this.a.w(g,h),h.y==this.Ha.B&&(k=0));if(-1!=k&&(k=a.b.Cb(d,h),k=a.J.truncate(Math.min(Math.ceil(k/b),2048)),!(1>=k))){for(var m=1;m<k;m++)l[m-1]=1*m/k;this.a.zm(f,l,k-1)}f=g}while(f!=e)}};b.prototype.Am=function(b,
d){var h=this.a.Vd(),l=new a.b,c=new a.ia(0);c.yb(100);for(var e=this.a.Pb(this.Y);-1!=e;e=this.a.Sb(e))for(var f=this.a.cb(e),g=0,k=this.a.La(e);g<k;g++){var m=this.a.U(f);this.a.w(f,l);if(b?l.y==d:l.x==d)if(this.a.w(m,l),b?l.y==d:l.x==d)1!=this.a.Sa(f,h)&&(c.add(f),this.a.Va(f,h,1)),1!=this.a.Sa(m,h)&&(c.add(m),this.a.Va(m,h,1));f=m}this.a.le(h);if(!(3>c.size)){var A=this;c.Gd(0,c.size,function(d,a){return A.ki(d,a)});h=new a.b;e=new a.b;f=new a.b;e.$c();for(var q=-1,g=new a.ia(0),k=new a.ia(0),
m=this.a.Vd(),n=this.a.Vd(),w=0,x=c.size;w<x;w++){var p=c.get(w);this.a.w(p,l);if(!l.ub(e)){if(-1!=q){for(var u=q;u<w;u++){var q=c.get(u),B=this.a.U(q),p=this.a.Ra(q),z=!1;0>this.ki(q,B)&&(this.a.w(B,h),b?h.y==d:h.x==d)&&(g.add(q),z=!0,this.a.Va(q,n,1));0>this.ki(q,p)&&(this.a.w(p,h),b?h.y==d:h.x==d)&&(z||g.add(q),this.a.Va(q,m,1))}u=0;for(z=g.size;u<z;u++){q=g.get(u);p=this.a.Sa(q,m);B=this.a.Sa(q,n);if(1==p){p=this.a.Ra(q);this.a.w(p,f);var v=[0];v[0]=0;if(!f.ub(l)){var t=a.b.Cb(e,f);v[0]=a.b.Cb(f,
l)/t;0==v[0]?v[0]=2.220446049250313E-16:1==v[0]&&(v[0]=.9999999999999998);this.a.zm(p,v,1);p=this.a.Ra(q);this.a.Qf(p,l);k.add(p);this.a.Va(p,m,1);this.a.Va(p,n,-1)}}1==B&&(B=this.a.U(q),this.a.w(B,f),v=[0],v[0]=0,f.ub(l)||(t=a.b.Cb(e,f),v[0]=a.b.Cb(e,l)/t,0==v[0]?v[0]=2.220446049250313E-16:1==v[0]&&(v[0]=.9999999999999998),this.a.zm(q,v,1),p=this.a.U(q),this.a.Qf(p,l),k.add(p),this.a.Va(p,m,-1),this.a.Va(p,n,1)))}q=g;g=k;k=q;k.clear(!1)}q=w;e.L(l)}}this.a.le(m);this.a.le(n)}};b.prototype.sm=function(b,
d){var h=new a.b,l=new a.ia(0);l.yb(100);for(var c=this.a.Vd(),e=0,f=this.od.size;e<f;e++){var g=this.od.get(e);if(-1!=g){var k=this.a.U(g);this.a.w(g,h);if(b?h.y==d:h.x==d)if(this.a.w(k,h),b?h.y==d:h.x==d)-2!=this.a.Sa(g,c)&&(l.add(g),this.a.Va(g,c,-2)),-2!=this.a.Sa(k,c)&&(l.add(k),this.a.Va(k,c,-2))}}if(0!=l.size){var m=this;l.Gd(0,l.size,function(d,a){return m.ki(d,a)});e=0;for(f=l.size;e<f;e++){var A=l.get(e);this.a.Va(A,c,e)}g=new a.b;k=new a.b;k.$c();for(var q=-1,e=0,f=l.size;e<f;e++)if(A=
l.get(e),-1!=A&&(this.a.w(A,h),!h.ub(k))){if(-1!=q)for(;;){for(var A=!1,n=1<e-q?e-1:e,w=q;w<n;w++){var x=l.get(w);if(-1!=x){var p=-1,u=this.a.U(x);0>this.ki(x,u)&&(this.a.w(u,g),b?g.y==d:g.x==d)&&(p=u);var u=-1,B=this.a.Ra(x);0>this.ki(x,B)&&(this.a.w(B,g),b?g.y==d:g.x==d)&&(u=B);if(-1!=p&&-1!=u)this.ii(x,l,c),this.a.ud(x,!1),this.ii(p,l,c),this.a.ud(p,!1),A=!0;else if(-1!=p||-1!=u){for(B=w+1;B<e;B++){var z=l.get(B);if(-1!=z){var v=this.a.U(z),t=-1;0>this.ki(z,v)&&(this.a.w(v,g),b?g.y==d:g.x==d)&&
(t=v);var v=this.a.Ra(z),C=-1;0>this.ki(z,v)&&(this.a.w(v,g),b?g.y==d:g.x==d)&&(C=v);if(-1!=t&&-1!=C){this.ii(z,l,c);this.a.ud(z,!1);this.ii(t,l,c);this.a.ud(t,!1);A=!0;break}if(-1!=p&&-1!=C){this.ou(l,x,p,z,C,c);A=!0;break}else if(-1!=u&&-1!=t){this.ou(l,z,t,x,u,c);A=!0;break}}}if(A)break}}}if(!A)break}q=e;k.L(h)}}this.a.le(c)};b.prototype.ii=function(a,d,h){h=this.a.Sa(a,h);d.set(h,-1);h=this.a.Sa(a,this.Ki);this.od.set(h,-1);d=this.a.ld(a);-1!=d&&this.a.cb(d)==a&&(this.a.jg(d,-1),this.a.sh(d,-1))};
b.prototype.ou=function(a,d,h,b,c,e){this.a.Kc(d,b);this.a.Lc(b,d);this.a.Lc(h,c);this.a.Kc(c,h);this.ii(b,a,e);this.a.Mi(b,!1);this.ii(c,a,e);this.a.Mi(c,!0)};b.prototype.Cz=function(){for(var a=0,d=this.od.size;a<d;a++){var h=this.od.get(a);-1!=h&&this.a.Aj(h,-1)}for(var b=0,c=0,e=this.a.Pb(this.Y);-1!=e;){var f=this.a.cb(e);if(-1==f||e!=this.a.ld(f)){var g=e,e=this.a.Sb(e);this.a.jg(g,-1);this.a.Sr(g)}else{h=f;g=0;do this.a.Aj(h,e),g++,h=this.a.U(h);while(h!=f);2>=g?(h=this.a.Sa(f,this.Ki),this.od.set(h,
-1),f=this.a.ud(f,!1),2==g&&(h=this.a.Sa(f,this.Ki),this.od.set(h,-1),this.a.ud(f,!1)),g=e,e=this.a.Sb(e),this.a.jg(g,-1),this.a.Sr(g)):(this.a.Np(e,!1),this.a.sh(e,this.a.Ra(f)),this.a.nk(e,g),c+=g,b++,e=this.a.Sb(e))}}a=0;for(d=this.od.size;a<d;a++)if(h=this.od.get(a),-1!=h&&(e=this.a.ld(h),-1==e)){e=this.a.Yf(this.Y,-1);g=0;f=h;do this.a.Aj(h,e),g++,h=this.a.U(h);while(h!=f);2>=g?(h=this.a.Sa(f,this.Ki),this.od.set(h,-1),f=this.a.ud(f,!1),2==g&&(h=this.a.Sa(f,this.Ki),0<=h&&this.od.set(h,-1),this.a.ud(f,
!1)),g=e,this.a.jg(g,-1),this.a.Sr(g)):(this.a.$n(e,!0),this.a.nk(e,g),this.a.jg(e,f),this.a.sh(e,this.a.Ra(f)),this.a.Np(e,!1),c+=g,b++)}this.a.wm(this.Y,b);this.a.lk(this.Y,c);a=0;for(d=this.a.sd;-1!=d;d=this.a.Ue(d))a+=this.a.D(d);this.a.zC(a)};b.Hm=function(a,d,h,c){return(new b(d)).hz(a,h,c)};b.clip=function(l,d,h,c){if(l.u())return l;if(d.u())return l.Ka();var e=l.G();if(33==e)return h=l.w(),d.contains(h)?l:l.Ka();if(197==e)return h=new a.h,l.s(h),h.Ma(d)?(d=new a.ci,l.copyTo(d),d.Gp(h),d):
l.Ka();var r=new a.h;l.ac(r);if(d.contains(r))return l;if(!d.Yb(r))return l.Ka();r=l.ob;if(null!=r&&(r=r.Hi,null!=r)){r=r.Rn(d);if(1==r){if(1736!=e)throw a.g.za();l=new a.Ja(l.description);l.oq(d);return l}if(0==r)return l.Ka()}switch(e){case 550:c=null;for(var e=l.D(),r=l.Pa(0),f=0,g=0;g<e;g++)h=new a.b,r.fc(2*g,h),d.contains(h)||(0==f&&(c=l.Ka()),f<g&&c.Id(l,f,g),f=g+1);0<f&&c.Id(l,f,e);return 0==f?l:c;case 1736:case 1607:return b.Hm(l,d,h,c);default:throw a.g.za();}};b.prototype.ki=function(b,
d){var h=new a.b;this.a.w(b,h);b=new a.b;this.a.w(d,b);return h.compare(b)};return b}();a.ne=b})(D||(D={}));(function(a){var b=function(){function b(b,d){this.Ha=b;this.a=new a.fd;this.od=new a.ia(0);this.ke=d}b.prototype.ji=function(a,d,h){switch(d){case 0:if(a.o<h&&a.v<=h)break;else return a.o>=h?1:-1;case 1:if(a.A<h&&a.B<=h)break;else return a.A>=h?1:-1;case 2:if(a.o>=h&&a.v>h)break;else return a.v<=h?1:-1;case 3:if(!(a.A>=h&&a.B>h))return a.B<=h?1:-1}return 0};b.prototype.hz=function(a,d,h){return 1736==
a.G()?this.iz(a,d,h):this.jz(a,d)};b.prototype.iz=function(b,d,h){if(0==this.Ha.N()||0==this.Ha.fa())return b.Ka();d=new a.h;b.ac(d);this.Y=this.a.Jb(b);var l=new a.h,c=new a.h,e=new a.b,f=new a.b,g=[0,0,0,0,0,0,0,0,0],k=[0,0,0,0,0,0,0,0,0],m=new a.Hb,A=new a.ia(0);A.yb(256);for(var q=!1,n=0;!q&&4>n;n++){var w=!1,x=0!=(n&1),p=0;switch(n){case 0:p=this.Ha.o;w=d.o<=p&&d.v>=p;break;case 1:p=this.Ha.A;w=d.A<=p&&d.B>=p;break;case 2:p=this.Ha.v;w=d.o<=p&&d.v>=p;break;case 3:p=this.Ha.B,w=d.A<=p&&d.B>=p}if(w)for(q=
!0,w=this.a.Pb(this.Y);-1!=w;){var u=!0,B=-1,z=-1,v=this.a.cb(w),t=v;do{var C=this.a.ic(t);null==C&&(C=m,this.a.w(t,e),C.Mc(e),this.a.w(this.a.U(t),f),C.Zc(f));C.s(l);var E=this.ji(l,n,p),F=0,D=-1;if(-1==E){C=C.Tq(x,p,g,k);0<C?F=this.a.EY(t,k,C):F=0;for(var F=F+1,G=t,aa=this.a.U(G),C=0;C<F;C++){this.a.w(G,e);this.a.w(aa,f);D=this.a.ic(G);null==D&&(D=m,D.Mc(e),D.Zc(f));D.s(c);D=this.ji(c,n,p);if(-1==D){if(x)D=Math.abs(e.y-p),I=Math.abs(f.y-p),D<I?(e.y=p,this.a.Qf(G,e)):(f.y=p,this.a.Qf(aa,f));else{var D=
Math.abs(e.x-p),I=Math.abs(f.x-p);D<I?(e.x=p,this.a.Qf(G,e)):(f.x=p,this.a.Qf(aa,f))}D=this.a.ic(G);null==D&&(D=m,D.Mc(e),D.Zc(f));D.s(c);D=this.ji(c,n,p)}I=B;B=D;-1==z&&(z=B);if(0!=I||1!=B)1==I&&0==B||0!=I||0!=B||A.add(G);1==B&&(u=q=!1);D=G=aa;aa=this.a.U(aa)}}if(0==F){I=B;B=E;-1==z&&(z=B);if(0!=I||1!=B)1==I&&0==B||0!=I||0!=B||A.add(t);1==B&&(u=q=!1);D=this.a.U(t)}t=D;if(256<=A.size){C=1;for(E=A.size-1;C<E;C++)F=A.get(C),this.a.ud(F,!1);A.set(1,A.Fc());A.yf(2)}}while(t!=v);if(!u)for(0==z&&0==B&&
A.add(v),C=0,E=A.size;C<E;C++)F=A.get(C),this.a.ud(F,!1);A.clear(!1);w=u||0==this.a.La(w)?this.a.Rr(w):this.a.Sb(w)}}if(q)return b.Ka();this.fC();0<h&&this.vz(h);return this.a.Se(this.Y)};b.prototype.jz=function(b){var d=new a.h,h=new a.h,l=[0,0,0,0,0,0,0,0,0],c=[0,0,0,0,0,0,0,0,0],e=new a.Cg,f=b,g=new a.h;b.ac(g);for(var k=new a.b,m=new a.b,A=null,q=null,n=0;4>n;n++){var w=!1,x=0!=(n&1),p=0;switch(n){case 0:p=this.Ha.o;w=g.o<=p&&g.v>=p;break;case 1:p=this.Ha.A;w=g.A<=p&&g.B>=p;break;case 2:p=this.Ha.v;
w=g.o<=p&&g.v>=p;break;case 3:p=this.Ha.B,w=g.A<=p&&g.B>=p}if(w)for(w=f,f=b.Ka(),w=w.Fa(),w.yj();w.Ya();)for(var u,B=!0;w.Ea();){var z=w.ba();z.s(d);var v=this.ji(d,n,p);if(-1==v){if(v=z.Tq(x,p,l,c),0<v){var t=0;z.Oq(k);for(var C=0;C<=v;C++)if(u=C<v?c[C]:1,t!=u){z.yh(t,u,e);var E=e.get();E.Mc(k);C<v&&(x?(m.x=l[C],m.y=p):(m.x=p,m.y=l[C]),E.Zc(m));E.s(h);var F=this.ji(h,n,p);-1==F&&(null==A&&(A=new a.b),null==q&&(q=new a.b),E.Oq(A),E.Ps(q),x?(t=Math.abs(A.y-p),F=Math.abs(q.y-p),t<F?(A.y=p,E.Mc(A)):
(q.y=p,E.Zc(q))):(t=Math.abs(A.x-p),F=Math.abs(q.x-p),t<F?(A.x=p,E.Mc(A)):(q.x=p,E.Zc(q))),E.s(h),F=this.ji(h,n,p));E.Ps(k);t=u;u=F;1==u?(f.dc(E,B),B=!1):B=!0}}}else u=v,1==u?(f.dc(z,B),B=!1):B=!0}}return f};b.prototype.fC=function(){this.Ki=-1;this.Am(!1,this.Ha.o);this.Am(!1,this.Ha.v);this.Am(!0,this.Ha.A);this.Am(!0,this.Ha.B);this.od.resize(0);this.od.yb(100);this.Ki=this.a.Vd();for(var b=new a.b,d=this.a.Pb(this.Y);-1!=d;d=this.a.Sb(d))for(var h=this.a.cb(d),c=0,e=this.a.La(d);c<e;c++,h=this.a.U(h))if(this.a.w(h,
b),this.Ha.o==b.x||this.Ha.v==b.x||this.Ha.A==b.y||this.Ha.B==b.y)this.a.Va(h,this.Ki,this.od.size),this.od.add(h);this.sm(!1,this.Ha.o);this.sm(!1,this.Ha.v);this.sm(!0,this.Ha.A);this.sm(!0,this.Ha.B);this.Cz()};b.prototype.vz=function(b){for(var d=new a.b,h=new a.b,l=null,c=null,e=a.J.gf(2048,0),f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f)){var g=this.a.cb(f),k=g;do{var m=this.a.U(k);this.a.w(k,d);var A=-1;d.x==this.Ha.o?(this.a.w(m,h),h.x==this.Ha.o&&(A=1)):d.x==this.Ha.v&&(this.a.w(m,h),h.x==this.Ha.v&&
(A=1));d.y==this.Ha.A?(this.a.w(m,h),h.y==this.Ha.A&&(A=0)):d.y==this.Ha.B&&(this.a.w(m,h),h.y==this.Ha.B&&(A=0));if(-1!=A){null==l&&(l=new a.b);null==c&&(c=new a.b);l.L(d);c.ka(0,0);if(0==A){var q=d.x-this.Ha.o;c.x=a.Ub.sign(h.x-d.x);l.x=b*a.Ub.Fl(Math.floor(Math.abs(q/b)),q)+this.Ha.o;0>l.x&&(l.x+=b)}else q=d.y-this.Ha.A,c.y=a.Ub.sign(h.y-d.y),l.y=b*a.Ub.Fl(Math.floor(Math.abs(q/b)),q)+this.Ha.A,0>l.y&&(l.y+=b);var q=0!=A?h.y-d.y:h.x-d.x,n=Math.abs(q);if(65536<n/b)throw a.g.X("internal error");
if(0<n){n=a.J.truncate(n/b)+2;e.length<n&&(e=a.J.gf(n));for(var w=n=0;;w++){var x=new a.b;x.x=l.x+c.x*w*b;x.y=l.y+c.y*w*b;x=(0!=A?x.y-d.y:x.x-d.x)/q;if(1<=x)break;0>=x||(e[n]=x,n++)}0!=n&&this.a.zm(k,e,n)}}k=m}while(k!=g)}};b.prototype.Am=function(b,d){for(var h=-1,l=new a.b,c=null,e=this.a.Pb(this.Y);-1!=e;e=this.a.Sb(e))for(var f=this.a.cb(e),g=0,k=this.a.La(e);g<k;g++){var m=this.a.U(f);this.a.w(f,l);if(b?l.y==d:l.x==d)if(this.a.w(m,l),b?l.y==d:l.x==d)-1==h&&(h=this.a.Vd()),null==c&&(c=new a.ia(0),
c.yb(100)),1!=this.a.Sa(f,h)&&(c.add(f),this.a.Va(f,h,1)),1!=this.a.Sa(m,h)&&(c.add(m),this.a.Va(m,h,1));f=m}-1!=h&&this.a.le(h);if(!(null==c||3>c.size)){var A=this;c.Gd(0,c.size,function(d,a){return A.ki(d,a)});h=new a.b;e=new a.b;f=new a.b;e.$c();for(var q=-1,g=new a.ia(0),k=new a.ia(0),m=null,n=this.a.Vd(),w=this.a.Vd(),x=0,p=c.size;x<p;x++){var u=c.get(x);this.a.w(u,l);if(!l.ub(e)){if(-1!=q){for(var B=q;B<x;B++){var q=c.get(B),z=this.a.U(q),u=this.a.Ra(q),v=!1;this.a.w(z,h);0>e.compare(h)&&(b?
h.y==d:h.x==d)&&(g.add(q),v=!0,this.a.Va(q,w,1));this.a.w(u,h);0>e.compare(h)&&(b?h.y==d:h.x==d)&&(v||g.add(q),this.a.Va(q,n,1))}B=0;for(v=g.size;B<v;B++){q=g.get(B);u=this.a.Sa(q,n);z=this.a.Sa(q,w);if(1==u&&(u=this.a.Ra(q),this.a.w(u,f),!f.ub(l))){null==m&&(m=[]);var t=a.b.Cb(e,f);m[0]=a.b.Cb(f,l)/t;0==m[0]?m[0]=2.220446049250313E-16:1==m[0]&&(m[0]=.9999999999999998);this.a.zm(u,m,1);u=this.a.Ra(q);this.a.Qf(u,l);k.add(u);this.a.Va(u,n,1);this.a.Va(u,w,-1)}1==z&&(z=this.a.U(q),this.a.w(z,f),f.ub(l)||
(null==m&&(m=[]),t=a.b.Cb(e,f),m[0]=a.b.Cb(e,l)/t,0==m[0]?m[0]=2.220446049250313E-16:1==m[0]&&(m[0]=.9999999999999998),this.a.zm(q,m,1),u=this.a.U(q),this.a.Qf(u,l),k.add(u),this.a.Va(u,n,-1),this.a.Va(u,w,1)))}q=g;g=k;k=q;k.clear(!1)}q=x;e.L(l)}}this.a.le(n);this.a.le(w)}};b.prototype.sm=function(b,d){for(var h=new a.b,l=null,c=-1,e=0,f=this.od.size;e<f;e++){var g=this.od.get(e);if(-1!=g){var k=this.a.U(g);this.a.w(g,h);if(b?h.y==d:h.x==d)if(this.a.w(k,h),b?h.y==d:h.x==d)-1==c&&(c=this.a.Vd()),null==
l&&(l=new a.ia(0),l.yb(100)),-2!=this.a.Sa(g,c)&&(l.add(g),this.a.Va(g,c,-2)),-2!=this.a.Sa(k,c)&&(l.add(k),this.a.Va(k,c,-2))}}if(null==l)-1!=c&&this.a.le(c);else{var m=this;l.Gd(0,l.size,function(d,a){return m.ki(d,a)});e=0;for(f=l.size;e<f;e++){var A=l.get(e);this.a.Va(A,c,e)}g=new a.b;k=new a.b;k.$c();for(var q=-1,e=0,f=l.size;e<f;e++)if(A=l.get(e),-1!=A&&(this.a.w(A,h),!h.ub(k))){if(-1!=q)for(;;){for(var A=!1,n=1<e-q?e-1:e,w=q;w<n;w++){var x=l.get(w);if(-1!=x){var p=-1,u=this.a.U(x);this.a.w(u,
g);0>k.compare(g)&&(b?g.y==d:g.x==d)&&(p=u);var u=-1,B=this.a.Ra(x);this.a.w(B,g);0>k.compare(g)&&(b?g.y==d:g.x==d)&&(u=B);if(-1!=p&&-1!=u)this.ii(x,l,c),this.a.ud(x,!1),this.ii(p,l,c),this.a.ud(p,!1),A=!0;else if(-1!=p||-1!=u){for(B=w+1;B<e;B++){var z=l.get(B);if(-1!=z){var v=this.a.U(z),t=-1;this.a.w(v,g);0>k.compare(g)&&(b?g.y==d:g.x==d)&&(t=v);var v=this.a.Ra(z),C=-1;this.a.w(v,g);0>k.compare(g)&&(b?g.y==d:g.x==d)&&(C=v);if(-1!=t&&-1!=C){this.ii(z,l,c);this.a.ud(z,!1);this.ii(t,l,c);this.a.ud(t,
!1);A=!0;break}if(-1!=p&&-1!=C){this.ou(l,x,p,z,C,c);A=!0;break}else if(-1!=u&&-1!=t){this.ou(l,z,t,x,u,c);A=!0;break}}}if(A)break}}}if(!A)break}q=e;k.L(h)}this.a.le(c)}};b.prototype.ii=function(a,d,h){h=this.a.Sa(a,h);d.set(h,-1);h=this.a.Sa(a,this.Ki);this.od.set(h,-1);d=this.a.ld(a);-1!=d&&this.a.cb(d)==a&&(this.a.jg(d,-1),this.a.sh(d,-1))};b.prototype.ou=function(a,d,h,b,c,e){this.a.Kc(d,b);this.a.Lc(b,d);this.a.Lc(h,c);this.a.Kc(c,h);this.ii(b,a,e);this.a.Mi(b,!1);this.ii(c,a,e);this.a.Mi(c,
!0)};b.prototype.Cz=function(){for(var a=0,d=this.od.size;a<d;a++){var h=this.od.get(a);-1!=h&&this.a.Aj(h,-1)}for(var b=0,c=0,e=this.a.Pb(this.Y);-1!=e;){var f=this.a.cb(e);if(-1==f||e!=this.a.ld(f)){var g=e,e=this.a.Sb(e);this.a.jg(g,-1);this.a.Sr(g)}else{h=f;g=0;do this.a.Aj(h,e),g++,h=this.a.U(h);while(h!=f);this.a.Np(e,!1);this.a.sh(e,this.a.Ra(f));this.a.nk(e,g);c+=g;b++;e=this.a.Sb(e)}}a=0;for(d=this.od.size;a<d;a++)if(h=this.od.get(a),-1!=h&&(e=this.a.ld(h),-1==e)){e=this.a.Yf(this.Y,-1);
g=0;f=h;do this.a.Aj(h,e),g++,h=this.a.U(h);while(h!=f);2>=g?(h=this.a.Sa(f,this.Ki),this.od.set(h,-1),f=this.a.ud(f,!1),2==g&&(h=this.a.Sa(f,this.Ki),0<=h&&this.od.set(h,-1),this.a.ud(f,!1)),g=e,this.a.jg(g,-1),this.a.Sr(g)):(this.a.$n(e,!0),this.a.nk(e,g),this.a.jg(e,f),this.a.sh(e,this.a.Ra(f)),this.a.Np(e,!1),c+=g,b++)}this.a.wm(this.Y,b);this.a.lk(this.Y,c);a=0;for(d=this.a.sd;-1!=d;d=this.a.Ue(d))a+=this.a.D(d);this.a.zC(a)};b.We=function(a,d,h,c,e){return(new b(d,e)).hz(a,h,c)};b.clip=function(a,
d,h,c,e){return b.rq(a,d,null,h,c,e)};b.rq=function(l,d,h,c,e,f){var r=l.G();if(33==r)return e=l.w(),d.contains(e)?l:l.Ka();if(197==r)return e=new a.h,l.s(e),e.Ma(d)?(d=new a.ci,l.copyTo(d),d.Gp(e),d):l.Ka();if(l.u())return l;if(d.u())return l.Ka();var g=new a.h;l.ac(g);if(d.contains(g))return l;if(!d.Yb(g))return l.Ka();if(null!=h||isNaN(c))c=a.na.Zy(h,d,!1);if(!a.T.gh(r))throw a.g.F();h=l.ob;if(null!=h&&(h=h.Hi,null!=h)){h=h.Rn(d);if(1==h){if(1736!=r)throw a.g.X("internal error");l=new a.Ja(l.description);
l.oq(d);return l}if(0==h)return l.Ka()}switch(r){case 550:f=null;r=l.D();c=l.Pa(0);h=0;e=new a.b;for(g=0;g<r;g++)c.fc(2*g,e),d.contains(e)||(0==h&&(f=l.Ka()),h<g&&f.Id(l,h,g),h=g+1);0<h&&f.Id(l,h,r);return 0==h?l:f;case 1736:case 1607:return b.We(l,d,c,e,f);default:throw a.g.X("internal error");}};b.prototype.ki=function(b,d){var h=new a.b;this.a.w(b,h);b=new a.b;this.a.w(d,b);return h.compare(b)};return b}();a.uh=b})(D||(D={}));(function(a){var b=new a.b,c=function(){function d(d,b,l,c,e){this.Cn=
new a.b;this.fl=new a.b;this.oj=new a.b;this.a=d;this.px=l;this.ap=c;this.Cn=b;this.dm=e;this.fl.$c();this.oj.$c()}d.prototype.GF=function(d){this.a.w(d,this.fl);d=a.J.truncate((this.fl.x-this.Cn.x)*this.ap+.5);var h=a.J.truncate((this.fl.y-this.Cn.y)*this.ap+.5);return l.vH(d,h)};d.prototype.Vz=function(d){return this.a.Sa(d,this.dm)};d.prototype.zz=function(d,a){this.a.w(d,this.fl);this.a.w(a,this.oj);return l.pw(this.fl.x,this.fl.y,this.oj.x,this.oj.y,this.px)};return d}();a.EZ=function(){return function(){}}();
var l=function(){function d(){this.Cn=new a.b;this.er=[0,0,0,0];this.tt=[0,0,0,0];this.ep=this.dm=-1}d.bS=function(a,b){var h=new d;h.a=a;h.ta=b;h.px=b*b;h.Nw=2*b;h.ap=1/h.Nw;return h.EQ()};d.pw=function(d,a,b,l,c){d-=b;a-=l;return d*d+a*a<=c};d.vH=function(d,b){return a.J.dh(b,a.J.dh(d))};d.prototype.GQ=function(h,l){this.a.Nc(h,b);for(var c=(b.y-this.Cn.y)*this.ap,e=a.J.truncate((b.x-this.Cn.x)*this.ap),r=a.J.truncate(c),f=c=0;1>=f;f+=1)for(var g=0;1>=g;g+=1){var k=d.vH(e+f,r+g),m=this.cm.hT(k);
-1!=m&&(this.er[c]=m,this.tt[c]=k,c++)}for(e=c-1;1<=e;e--)for(m=this.er[e],r=e-1;0<=r;r--)if(m==this.er[r]){this.tt[r]=-1;c--;e!=c&&(this.tt[e]=this.tt[c],this.er[e]=this.er[c]);break}for(r=0;r<c;r++)this.HQ(h,this.tt[r],b,this.er[r],l)};d.prototype.HQ=function(h,b,l,c,e){for(var r=new a.b;-1!=c;c=this.cm.xT(c)){var f=this.cm.ja(c);h==f||-1!=b&&this.a.Sa(f,this.dm)!=b||(this.a.Nc(f,r),d.pw(l.x,l.y,r.x,r.y,this.px)&&e.add(c))}};d.prototype.Ln=function(d,a,b){var h=this.a.Sa(d,this.ep),l=this.a.Sa(a,
this.ep);-1==h&&(h=this.Od.mi(),this.Od.addElement(h,d),this.a.Va(d,this.ep,h));-1==l?this.Od.addElement(h,a):this.Od.mz(h,l);this.a.Va(a,this.ep,-2);a=this.WV(d,a);b&&(b=this.Yw.GF(d),this.a.Va(d,this.dm,b));return a};d.VV=function(h,b,l){h.Eb(b);l=h;var c=new a.b;d.FX(h.w(),b.w(),c);l.rb(c)};d.FX=function(d,a,b){var h=d.x;d.x!=a.x&&(h=(1*d.x+1*a.x)/2);var l=d.y;d.y!=a.y&&(l=(1*d.y+1*a.y)/2);b.ka(h,l)};d.prototype.WV=function(d,b){var h=new a.b;this.a.w(d,h);var l=new a.b;this.a.w(b,l);var c=this.a.oH(d);
b=this.a.oH(b);var e=c+b,r=0,f=h.x;h.x!=l.x&&(f=(h.x*c+l.x*b)/e,r++);var g=h.y;h.y!=l.y&&(g=(h.y*c+l.y*b)/e,r++);0<r&&this.a.rb(d,f,g);this.a.qY(d,e);return 0!=r};d.prototype.EQ=function(){var d=this.a.vd,b=this.a.TG();this.Cn=b.Yz();b=Math.max(b.fa(),b.N())/2147483646;this.Nw<b&&(this.Nw=b,this.ap=1/this.Nw);this.Od=new a.Lu;this.Od.pu(a.J.truncate(this.a.vd/3+1));this.Od.Vn(a.J.truncate(this.a.vd/3+1));this.dm=this.a.Vd();this.ep=this.a.Vd();this.Yw=new c(this.a,this.Cn,this.px,this.ap,this.dm);
this.cm=new a.EM(a.J.truncate(4*d/3),this.Yw);this.cm.xX(this.a.vd);d=!1;for(b=this.a.sd;-1!=b;b=this.a.Ue(b))for(var l=this.a.Pb(b);-1!=l;l=this.a.Sb(l))for(var e=this.a.cb(l),f=0,g=this.a.La(l);f<g;f++){var k=this.Yw.GF(e);this.a.Va(e,this.dm,k);this.cm.addElement(e,k);e=this.a.U(e)}var m=new a.ia(0);m.yb(10);for(b=this.a.sd;-1!=b;b=this.a.Ue(b))for(l=this.a.Pb(b);-1!=l;l=this.a.Sb(l))for(e=this.a.cb(l),f=0,g=this.a.La(l);f<g;f++){if(-2!=this.a.Sa(e,this.ep))for(k=this.a.Sa(e,this.dm),this.cm.kd(e,
k);;){this.GQ(e,m);if(0==m.size)break;for(var k=!1,A=0,q=m.size;A<q;A++){var n=m.get(A),w=this.cm.ja(n);this.cm.Kd(n);k=this.Ln(e,w,A+1==q)||k}d=d||k;m.clear(!1);if(!k)break}e=this.a.U(e)}d&&this.xP();this.Yw=this.cm=null;this.a.le(this.dm);this.a.le(this.ep);return d};d.prototype.xP=function(){for(var d=new a.b,b=this.Od.Ge;-1!=b;b=this.Od.bA(b)){var l=this.Od.xc(b);this.a.w(this.Od.ja(l),d);for(l=this.Od.nb(l);-1!=l;l=this.Od.nb(l))this.a.Qf(this.Od.ja(l),d)}};return d}();a.Iu=l})(D||(D={}));(function(a){var b=
function(){function b(a){void 0===a&&(a=null);this.Oe=null;this.xa=!1;null===a?this.Oe=[]:this.Oe=a}b.prototype.copyTo=function(b){if(b.xa)throw a.g.X("CompositeGeographicTransformation is read-only");for(var d=0;d<this.Oe.length;d++)b.Oe.push(this.Oe[d].Vf())};b.prototype.count=function(){return this.Oe.length};b.prototype.jT=function(a){return this.Oe[a]};b.prototype.add=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Oe.push(b.Vf())};b.prototype.clear=
function(){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Oe.length=0};b.prototype.remove=function(b){if(this.xa)throw a.g.X("CompositeGeographicTransformation is read-only");this.Oe.splice(b,1)};b.prototype.Wv=function(){for(var a=this.oe(),d=0;d<a.count();d++)a.jT(d).kt();a.Oe=a.Oe.reverse();return a};b.prototype.oe=function(){var a=new b;this.copyTo(a);return a};b.prototype.Vf=function(){return this.oe()};b.prototype.transform=function(b,d,h,c){if(b.length<d)throw a.g.X("invalid Argument");
var l=h;for(h=0;h<this.Oe.length;h++){var e=this.Oe[h];if(null!=e.cn()){var r=e.nn,f=r?1:0,g=r?e.cn().getGeogcs2():e.cn().getGeogcs1(),g=g.getUnit().getUnitFactor(),g=l/g;if(3.552713678800501E-15<Math.abs(g-1))for(l=0;l<d;l++)b[l][0]*=g,b[l][1]*=g;a.PD.geogToGeog(e.cn(),d,b,null,f);l=(r?e.cn().getGeogcs1():e.cn().getGeogcs2()).getUnit().getUnitFactor()}}g=l/c;if(3.552713678800501E-15<Math.abs(g-1))for(l=0;l<d;l++)b[l][0]*=g,b[l][1]*=g;return d};b.prototype.getName=function(){if(0==this.Oe.length)return"";
for(var a="",d=0,h=this.Oe.length;d<h;++d)""!==a&&(a+=" + "),a+=this.Oe[d].getName();return a};b.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof b)||this.Oe.length!=a.Oe.length)return!1;for(var d=0;d<this.Oe.length;d++)if(!this.Oe[d].Eb(a.Oe[d]))return!1;return!0};b.prototype.Mp=function(){this.xa=!0};b.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+a.length.toString()+" characters)":a};b.create=function(){return new b};b.aq=function(l,
d){var h=new b;h.add(a.io.create(l,d));return h};b.bq=function(l,d){var h=new b;h.add(a.io.fG(l,d));return h};return b}();a.ny=b})(D||(D={}));(function(a){var b=Math.PI,c=2*Math.PI,l=Math.PI/2,d=function(){function d(){}d.WQ=function(a,h){var b=new d;b.x=a;b.y=h;b.type=0;b.ui=0;return b};d.El=function(a){var h=new d;h.x=a.x;h.y=a.y;h.type=0;h.ui=0;return h};d.VQ=function(a){var h=new d;h.x=a.x;h.y=a.y;h.type=a.type;h.ui=a.ui;return h};d.ce=function(a,h,b){var l=new d;l.x=a.x+h*Math.cos(b);l.y=a.y+
h*Math.sin(b);l.type=a.type;l.ui=a.ui;return l};d.Dv=function(a,h){var b=new d;b.x=.5*(a.x+h.x);b.y=.5*(a.y+h.y);b.type=a.type;b.ui=a.ui;return b};d.ZF=function(a,h){var b=new d;b.x=a.x+.001*(h.x-a.x);b.y=a.y+.001*(h.y-a.y);b.type=a.type;b.ui=a.ui;return b};return d}(),h=function(){return function(){}}();(function(d){d[d.Round=0]="Round";d[d.Bevel=1]="Bevel";d[d.Miter=2]="Miter";d[d.Square=3]="Square"})(a.JM||(a.JM={}));var e=function(){function e(d){this.sB=this.$b=this.Sg=null;this.ke=d}e.V=function(d,
h,b,l,c,r){if(null==d)throw a.g.F();if(1>d.tb())throw a.g.F();if(0==h||d.u())return d;r=new e(r);r.Yo=d;r.Qa=h;r.ta=c;r.jj=b;r.iB=l;return r.Ay()};e.prototype.zO=function(){var d=this.Yo,h=d.ec(),b=d.Cc(),l=new a.b;l.zc(b,h);l.normalize();l.uw();l.scale(this.Qa);h.add(l);b.add(l);l=d.Ka();d.Mc(h);d.Zc(b);return l};e.prototype.yO=function(){var d=this.Yo;if(0<this.Qa&&2!=this.jj){var h=new a.Ja;h.jd(d,!1);this.Yo=h;return this.Ay()}d=new a.ci(d.R);d.O(this.Qa,this.Qa);return d};e.prototype.kK=function(d,
a,h,b){return(a.x-d.x)*(b.x-h.x)+(a.y-d.y)*(b.y-h.y)};e.prototype.pc=function(a,h){if(void 0===h)this.$b.push(a),this.Kf++;else if(0==this.Kf)this.pc(a);else{var b=this.qx,c,e;c=this.Sg[0==h?b-1:h-1];e=this.Sg[h];var r=this.kK(c,e,this.$b[this.Kf-1],a);0<r?this.pc(a):0>r&&(0<this.kK(c,e,e,this.$b[this.Kf-1])?(e=this.Sg[0==h?b-2:1==h?b-1:h-2],b=d.ce(c,this.Qa,Math.atan2(c.y-e.y,c.x-e.x)-l),this.$b[this.Kf-1]=b,1==this.jj||2==this.jj?(b=d.Dv(b,c),this.pc(b),b=d.ce(c,this.Qa,this.ww+l),c=d.Dv(b,c),c.type|=
256,this.pc(c)):(b=d.ce(c,this.Qa,this.ww+l),b.type|=256),this.pc(b),this.pc(a,h)):(b=d.ce(e,this.Qa,this.ww+l),this.pc(b),1==this.jj||2==this.jj?(b=d.Dv(b,e),this.pc(b),b=d.ce(e,this.Qa,this.JA-l),c=d.Dv(b,e),c.type|=256,this.pc(c)):(b=d.ce(e,this.Qa,this.JA-l),b.type|=256),this.pc(b)))}};e.prototype.zF=function(){var h,e,r,f,g,k,y=this.qx;this.Kf=0;var m=.5*this.ta,A=0,q=0;for(h=0;h<y;h++){f=this.Sg[h];g=0==h?this.Sg[y-1]:this.Sg[h-1];k=h==y-1?this.Sg[0]:this.Sg[h+1];var n=g.x-f.x,w=g.y-f.y,x=k.x-
f.x,p=k.y-f.y;e=Math.atan2(w,n);r=Math.atan2(p,x);this.ww=e;this.JA=r;0==h&&(A=e,q=r);n=n*p-x*w;w=r;r<e&&(r+=c);if(0<n*this.Qa)1==this.jj||2==this.jj?(e=d.ce(f,this.Qa,e+l),this.pc(e),e=d.ZF(f,e),this.pc(e),e=d.ce(f,this.Qa,r-l),f=d.ZF(f,e),f.type|=256,this.pc(f),this.pc(e)):(n=.5*(r-e),n=this.Qa/Math.abs(Math.sin(n)),e=d.ce(f,n,.5*(e+r)),this.pc(e,h));else if(0!=(f.type&512)){n=1-m/Math.abs(this.Qa);g=1;k=0>this.Qa?-b:b;-1<n&&1>n&&(w=2*Math.acos(n),.017453292519943295>w&&(w=.017453292519943295),
g=a.J.truncate(b/w+1.5),1<g&&(k/=g));w=e+l;e=d.ce(f,this.Qa,w);0==h&&(e.type|=1024);this.pc(e,h);n=this.Qa/Math.cos(k/2);w+=k/2;e=d.ce(f,n,w);e.type|=1024;for(this.pc(e);0<--g;)w+=k,e=d.ce(f,n,w),e.type|=1024,this.pc(e);e=d.ce(f,this.Qa,r-l);e.type|=1024;this.pc(e)}else if(1==this.jj)e=d.ce(f,this.Qa,e+l),this.pc(e,h),e=d.ce(f,this.Qa,r-l),this.pc(e);else if(0==this.jj)for(n=1-m/Math.abs(this.Qa),g=1,k=r-l-(e+l),-1<n&&1>n&&(w=2*Math.acos(n),.017453292519943295>w&&(w=.017453292519943295),g=a.J.truncate(Math.abs(k)/
w+1.5),1<g&&(k/=g)),n=this.Qa/Math.cos(.5*k),w=e+l+.5*k,e=d.ce(f,n,w),this.pc(e,h);0<--g;)w+=k,e=d.ce(f,n,w),this.pc(e);else 2==this.jj?(n=g.x-f.x,w=g.y-f.y,x=k.x-f.x,p=k.y-f.y,g=(n*x+w*p)/Math.sqrt(n*n+w*w)/Math.sqrt(x*x+p*p),.99999999<g?(e=d.ce(f,1.4142135623730951*this.Qa,r-.25*b),this.pc(e,h),e=d.ce(f,1.4142135623730951*this.Qa,r+.25*b),this.pc(e)):(g=Math.abs(this.Qa/Math.sin(.5*Math.acos(g))),k=Math.abs(this.iB*this.Qa),g>k?(n=.5*(r-e),n=this.Qa/Math.abs(Math.sin(n)),e=d.ce(f,n,.5*(e+r)),r=
a.b.pa(e.x,e.y),e=a.b.pa(f.x,f.y),f=new a.b,f.zc(r,e),r=new a.b,r.EX(k/f.length(),f,e),e=(g-k)*Math.abs(this.Qa)/Math.sqrt(g*g-this.Qa*this.Qa),0<this.Qa?f.uw():f.Ur(),f.scale(e/f.length()),e=new a.b,e.add(r,f),g=new a.b,g.zc(r,f),e=d.El(e),this.pc(e,h),e=d.El(g),this.pc(e)):(n=.5*(r-e),n=this.Qa/Math.abs(Math.sin(n)),e=d.ce(f,n,.5*(e+r)),this.pc(e,h)))):(r=w,0<this.Qa?(r>e&&(r-=c),g=e-r<l):(r<e&&(r+=c),g=r-e<l),g?(n=1.4142135623730951*this.Qa,w=0>n?e+.25*b:e+.75*b,e=d.ce(f,n,w),this.pc(e,h),w=0>
n?r-.25*b:r-.75*b,e=d.ce(f,n,w),this.pc(e)):(n=.5*(r-e),n=this.Qa/Math.abs(Math.sin(n)),r<e&&(r+=c),e=d.ce(f,n,(e+r)/2),this.pc(e,h)))}this.ww=A;this.JA=q;this.pc(this.$b[0],0);f=d.VQ(this.$b[this.Kf-1]);this.$b[0]=f;return this.tX()};e.prototype.kv=function(d,h){if(!(2>h))for(var b=0;b<h;b++){var l=this.$b[d+b];0!=b?this.sB.aj(a.b.pa(l.x,l.y)):this.sB.zu(a.b.pa(l.x,l.y))}};e.prototype.AO=function(a,h,b){var l=a.wa(h),c=a.Gc(h);this.$b=[];this.sB=b;if(a.Qb(h)){for(h=a.Ba(l);a.Ba(c-1).ub(h);)c--;if(2<=
c-l){this.qx=c-l;this.Sg=[];for(h=l;h<c;h++)this.Sg.push(d.El(a.Ba(h)));this.zF()&&this.kv(0,this.Kf-1)}}else{for(h=a.Ba(l);l<c&&a.Ba(l+1).ub(h);)l++;for(h=a.Ba(c-1);l<c&&a.Ba(c-2).ub(h);)c--;if(2<=c-l){this.qx=2*(c-l)-2;this.Sg=[];b=d.El(a.Ba(l));b.type|=1536;this.Sg.push(b);for(h=l+1;h<c-1;h++)b=d.El(a.Ba(h)),this.Sg.push(b);b=d.El(a.Ba(c-1));b.type|=512;this.Sg.push(b);for(h=c-2;h>=l+1;h--)b=d.El(a.Ba(h)),b.type|=1024,this.Sg.push(b);if(this.zF())if(2<=this.$b.length){a=-1;(c=0!=(this.$b[this.Kf-
1].type&1024))||(a=0);for(h=1;h<this.Kf;h++)(l=0!=(this.$b[h].type&1024))?c||(c=h-1,1<c-a+1&&this.kv(a,c-a+1)):c&&(a=h-1),c=l;c||(c=this.Kf-1,1<c-a+1&&this.kv(a,c-a+1))}else a=0,c=this.Kf-1,0<=a&&1<=c-a&&this.kv(a,c-a+1)}}this.Sg=null;this.qx=0;this.$b=null;this.Kf=0};e.prototype.tX=function(){for(var d=!1,a=0;a<this.Kf;a++){var h=this.$b[a];h.Nh=a+1;h.Qh=a-1;this.$b[a]=h}h=this.$b[0];h.Qh=this.Kf-2;this.$b[0]=h;h=this.$b[this.Kf-2];h.Nh=0;this.$b[this.Kf-2]=h;for(a=h=0;a<this.Kf;a++)if(0!=(this.$b[h].type&
256)){var b=this.CR(h);if(-1!=b)h=b;else{d=!0;break}}else h=this.$b[h].Nh;if(d)return!1;this.TQ(h);return!0};e.prototype.CR=function(d){for(var a=this.Kf-1,h=d,b,l,c=1;c<=a-2;c++){b=h=this.$b[h].Nh;l=d;for(var e=1;e<=c;e++){l=this.$b[l].Qh;if(0==(this.$b[l].type&256)&&0==(this.$b[b].type&256)){var r=this.aU(l,b);if(-1!=r)return r}b=this.$b[b].Qh}}return-1};e.prototype.aU=function(d,b){var l,c,e,r;l=this.$b[this.$b[d].Qh];c=this.$b[d];e=this.$b[this.$b[b].Qh];r=this.$b[b];if(!this.IX(l,c,e,r))return-1;
var f=new h;return this.pS(l,c,e,r,f)&&!f.oF&&a.J.SK((c.x-l.x)*(r.y-e.y)-(c.y-l.y)*(r.x-e.x))!=a.J.SK(this.Qa)?(l=this.$b[d].Qh,f.Pn.type=c.type,f.Pn.Nh=b,f.Pn.Qh=l,this.$b[d]=f.Pn,f.Pn=this.$b[b],f.Pn.Qh=d,this.$b[b]=f.Pn,b):-1};e.prototype.IX=function(d,a,h,b){return Math.max(d.x,a.x)>=Math.min(h.x,b.x)&&Math.max(h.x,b.x)>=Math.min(d.x,a.x)&&Math.max(d.y,a.y)>=Math.min(h.y,b.y)&&Math.max(h.y,b.y)>=Math.min(d.y,a.y)};e.prototype.pS=function(a,h,b,l,c){c.oF=!1;var e,r,f;e=(h.y-a.y)*(l.x-b.x)-(h.x-
a.x)*(l.y-b.y);r=(b.y-a.y)*(h.x-a.x)-(b.x-a.x)*(h.y-a.y);e=0==e?2:r/e;return 0<=e&&1>=e&&(f=e,e=(l.y-b.y)*(h.x-a.x)-(l.x-b.x)*(h.y-a.y),r=(a.y-b.y)*(l.x-b.x)-(a.x-b.x)*(l.y-b.y),e=0==e?2:r/e,0<=e&&1>=e)?(c.Pn=d.WQ(a.x+e*(h.x-a.x),a.y+e*(h.y-a.y)),c.Pn.ui=b.ui+f*(l.ui-b.ui),0!=f&&1!=f||0!=e&&1!=e||(c.oF=!0),c.N_=e,c.O_=f,(0==f||1==f)&&0<e&&1>e||(0==e||1==e)&&0<f&&1>f?!1:!0):!1};e.prototype.TQ=function(d){for(;this.$b[d].Qh<d;)d=this.$b[d].Qh;var a=0,h=d;do h=this.$b[h],this.$b[a]=h,h=h.Nh,a++;while(h!=
d);this.$b[a]=this.$b[0];this.Kf=a+1};e.prototype.vE=function(d){var a=this.Yo,h=a.Fa();if(null!=h){h.yj();for(var b=-1;h.Ya();)b++,this.AO(a,b,d)}};e.prototype.Ay=function(){var d=this.Yo.G();return 322==d?this.zO():197==d?this.yO():a.T.Oc(d)?(d=new a.Ua,d.dc(this.Yo,!0),this.Yo=d,this.Ay()):1607==d?(d=new a.Ua,this.vE(d),d):1736==d?(d=new a.Ja,this.vE(d),d):null};return e}();a.TL=e})(D||(D={}));(function(a){var b=function(){function d(d){this.Sk=d}d.prototype.w=function(d,a){this.Sk.a.w(d,a)};d.prototype.Kd=
function(d){var a=this.Sk.Na.ja(d);this.Sk.Na.Kd(d,-1);this.Sk.a.ud(a,!1)};return d}(),c=function(){function d(d){this.Sk=d}d.prototype.w=function(d,a){this.Sk.GV.w(d,a)};d.prototype.Kd=function(d){this.Sk.Na.Kd(d,-1)};return d}(),l=function(){function d(d){this.Sk=d}d.prototype.w=function(d,a){a.L(this.Sk.JV[d])};d.prototype.Kd=function(d){this.Sk.Na.Kd(d,-1)};return d}(),d=function(){function d(d){void 0===d?(this.Na=new a.uk,this.Na.Qe(20),this.a=new a.fd,this.xV=this.a.bh(550),this.Nt=this.a.Yf(this.xV,
-1),this.wi=new b(this)):d instanceof Array?(this.Na=new a.uk,this.Na.Qe(20),this.JV=d,this.wi=new l(this)):(this.Na=new a.uk,this.Na.Qe(20),this.GV=d,this.wi=new c(this))}d.prototype.Jb=function(d){var h=d.G();if(a.Mu.gh(h))this.hP(d);else if(a.xl.Oc(h))this.oP(d);else if(197==h)this.eP(d);else if(33==h)this.lP(d);else throw a.g.F("invalid shape type");};d.prototype.US=function(){var d=new a.Wa,h=this.Na.xc(-1),b=new a.Ja(this.a.Hr);this.a.wj(this.Na.ja(h),d);b.Rf(d);for(h=this.Na.nb(h);-1!=h;h=
this.Na.nb(h))this.a.wj(this.Na.ja(h),d),b.lineTo(d);return b};d.UQ=function(h){var b=new d(h),l=h.D(),c=1,e=new a.b,r=new a.b,f=new a.b;for(h.w(0,e);;){h.w(c,r);if(!(r.wA(e)&&c<l-1))break;c++}b.Na.addElement(0,-1);b.Na.ro(c);for(l=c+1;l<h.D();l++)h.w(l,f),c=b.OC(f),-1!=c&&b.Na.kk(c,l);f=new a.Wa;c=b.Na.xc(-1);l=new a.Ja(h.description);h.Ae(b.Na.ja(c),f);l.Rf(f);for(c=b.Na.nb(c);-1!=c;c=b.Na.nb(c))h.Ae(b.Na.ja(c),f),l.lineTo(f);return l};d.pa=function(a,h,b){for(var l=new d(a),c=1,e=a[0];a[c].wA(e)&&
c<h-1;)c++;l.Na.addElement(0,-1);l.Na.ro(c);for(c+=1;c<h;c++)e=l.OC(a[c]),-1!=e&&l.Na.kk(e,c);a=0;for(h=l.Na.xc(-1);-1!=h;h=l.Na.nb(h))b[a++]=l.Na.ja(h);return a};d.VH=function(h,b){var l=h.wa(b),c=h.Gc(b);b=!h.Qb(b)&&h.Eo(b);h=h.Pa(0);l*=2;c*=2;b&&(c-=2);if(6>c-l)return!0;b=new a.b;var e=new a.b,f=new a.b;h.fc(l,b);h.fc(l+2,e);h.fc(l+4,f);var r=d.fe(e,f,b);if(r.lt()||!d.tc(r.value()))return!1;for(var g=a.b.pa(e.x,e.y),k=new a.b,l=l+6;l<c;l+=2){k.L(e);e.L(f);h.fc(l,f);r=d.fe(e,f,b);if(r.lt()||!d.tc(r.value()))return!1;
r=d.fe(g,f,b);if(r.lt()||!d.tc(r.value()))return!1;r=d.fe(e,f,k);if(r.lt()||!d.tc(r.value()))return!1}return!0};d.prototype.hP=function(d){for(var h=new a.Wa,b=new a.b,l=0;l<d.D();l++){d.w(l,b);var c=this.As(b);if(-1!=c){d.Ae(l,h);var e=this.a.pc(this.Nt,h);this.Na.kk(c,e)}}};d.prototype.eP=function(d){for(var h=new a.Wa,b=new a.b,l=0;4>l;l++){d.Gx(l,b);var c=this.As(b);if(-1!=c){d.ig(l,h);var e=this.a.pc(this.Nt,h);this.Na.kk(c,e)}}};d.prototype.oP=function(d){var h=new a.Wa,b=d.ec(),b=this.As(b);
if(-1!=b){d.Dp(h);var l=this.a.pc(this.Nt,h);this.Na.kk(b,l)}b=d.Cc();b=this.As(b);-1!=b&&(d.Bp(h),d=this.a.pc(this.Nt,h),this.Na.kk(b,d))};d.prototype.lP=function(d){var a=d.w(),a=this.As(a);-1!=a&&(d=this.a.pc(this.Nt,d),this.Na.kk(a,d))};d.prototype.As=function(d){var a=-1;if(0==this.Na.size(-1))return a=this.Na.addElement(-4,-1);if(1==this.Na.size(-1)){var h=this.a.Ba(this.Na.ja(this.Na.xc(-1)));d.wA(h)||(a=this.Na.ro(-5));return a}return a=this.OC(d)};d.prototype.OC=function(h){var b=-1,l=this.Na.xc(-1),
c=this.Na.Fc(-1),e=this.Na.ja(l),f=this.Na.ja(c),r=new a.b,g=new a.b;this.wi.w(e,r);this.wi.w(f,g);e=a.b.zp(g,h,r);if(d.tc(e))b=this.Na.ro(-1),r=this.MC(h,c,l),r!=l&&this.NC(h,l,this.Na.Ve(r));else if(d.vl(e)){for(var g=this.Na.fw(-1),k=this.Na.xc(-1),m=this.Na.Fc(-1),A,e=new a.b,f=new a.b;k!=this.Na.Ve(m);)A=this.Na.ja(g),this.wi.w(A,e),A=a.b.zp(e,h,r),d.vl(A)?(m=g,g=this.Na.Pl(g)):(k=g,g=this.Na.Nq(g));g=m;r=k;A=this.Na.ja(g);k=this.Na.ja(r);this.wi.w(A,e);this.wi.w(k,f);if(r==l||(e=a.b.zp(f,h,
e),d.tc(e)))b=this.Na.jv(r,g,-2,!1),this.NC(h,g,c),this.MC(h,r,l)}else null==this.wb&&(this.wb=new a.Hb),this.wb.Mc(g),this.wb.Zc(r),r=this.wb.pe(h,!0),0>r?(r=this.Na.Ve(c),this.Na.Kd(c,-1),b=this.Na.ro(-3),this.MC(h,r,l)):1<r&&(r=this.Na.nb(l),this.Na.Kd(l,-1),b=this.Na.jv(-1,r,-3,!1),this.NC(h,r,c));return b};d.prototype.NC=function(h,b,l){if(b!=l){var c=this.Na.ja(b),e=this.Na.nb(b),f=new a.b,r=new a.b;for(this.wi.w(c,f);b!=l&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(e),r);c=a.b.zp(r,h,f);if(d.tc(c))break;
c=b;b=e;f.L(r);e=this.Na.nb(b);this.wi.Kd(c)}}};d.prototype.MC=function(h,b,l){if(b==l)return l;var c=this.Na.ja(b),e=this.Na.Ve(b),f=new a.b,r=new a.b;for(this.wi.w(c,f);b!=l&&2<this.Na.size(-1);){this.wi.w(this.Na.ja(e),r);c=a.b.zp(f,h,r);if(d.tc(c))break;c=b;b=e;f.L(r);e=this.Na.Ve(b);this.wi.Kd(c)}return b};d.fe=function(d,h,b){var l=new a.Xb;l.set(h.x);l.sub(d.x);var c=new a.Xb;c.set(b.y);c.sub(d.y);var e=new a.Xb;e.set(h.y);e.sub(d.y);h=new a.Xb;h.set(b.x);h.sub(d.x);l.Vg(c);e.Vg(h);l.sub(e);
return l};d.tc=function(d){return 0>d};d.vl=function(d){return 0<d};d.hq=function(d){return 0==d};return d}();a.Ju=d})(D||(D={}));(function(a){var b=function(){function b(a){this.ke=this.a=null;this.FI=!0;this.ke=a}b.yJ=function(b,d,h){b=a.na.Cs(b);return a.Iu.pw(d.Be(),d.nf(),h.Be(),h.nf(),a.Ub.Yx(b))};b.FQ=function(b,d){var h=new a.Wa;a.Iu.VV(b,d,h);return h};b.V=function(a,d,h,c){h=new b(h);h.a=a;h.ta=d;h.FI=c;return h.LO()};b.prototype.FO=function(b){return a.Iu.bS(this.a,b)};b.prototype.IO=function(b){return a.Ku.V(this.a,
b,this.ke)};b.prototype.LO=function(){for(var b=this.ta,d=a.na.Cs(b),b=a.na.rP(b),h=1.00001*b,b=1.000001*b,c=!1,e=30<this.a.vd+10?1E3:(this.a.vd+10)*(this.a.vd+10),f=0,g=this.a.dU();;f++){if(f>e)throw a.g.X("Internal Error: max number of iterations exceeded");var k=this.FO(d),c=c||k;this.FI&&(k=0!=this.a.zq(d,!0,!1),c=c||k);k=!1;if(0==f||g||a.Ku.tJ(!0,this.a,b,null,this.ke))k=this.IO(h),c=c||k;if(!k)break}return c};return b}();a.sk=b})(D||(D={}));(function(a){var b=function(){function b(d){this.we=
this.Tc=null;this.kx=0;this.lc=d;this.LA=!0}b.prototype.gw=function(d,a){var h=this.a.ic(d);if(null==h){if(!this.a.pd(d,a))return null;h=a}return h};b.prototype.Pr=function(d){void 0===d&&(d=!1);this.kx++;if(d||0==(this.kx&4095))this.kx=0};b.prototype.mR=function(){var d=this.a.Qr(!1),h=!1,b=new a.Hb,l=new a.Hb,c=new a.h;c.Oa();var e=new a.h;e.Oa();for(var f=new a.Wa,g=new a.dE,k=d.next();-1!=k;k=d.next()){var m=null,A=!1;if(!a.T.Jo(this.a.hc(d.Ck))){m=this.gw(k,b);if(null==m)continue;m.s(c);c.O(this.ta,
this.ta);if(m.fh(this.ta))if(m.fh(0))A=!0,m=null;else continue}var q=this.a.Qr(d),n=q.next();for(-1!=n&&(n=q.next());-1!=n;n=q.next()){var w=null,x=!1;if(!a.T.Jo(this.a.hc(q.Ck))){w=this.gw(n,l);if(null==w)continue;w.s(e);if(w.fh(this.ta))if(w.fh(0))x=!0,w=null;else continue}var p=0,u=0;if(null!=m&&null!=w)c.TH(e)&&(g.Ap(m),g.Ap(w),g.Ma(this.ta,!1),p=g.Rl(0),u=g.Rl(1),0<p+u&&(this.a.bs(k,g,0,!0),this.a.bs(n,g,1,!0)),g.clear());else if(null!=m){var B=new a.b;this.a.w(n,B);if(c.contains(B)){g.Ap(m);
this.a.wj(n,f);g.sA(this.ta,f,!1);p=g.Rl(0);if(0<p)if(this.a.bs(k,g,0,!0),x){x=-1;for(B=this.a.U(n);-1!=B&&B!=n&&(w=this.gw(B,l),x=B,null!=w&&w.fh(0));B=this.a.U(B));for(B=n;-1!=B&&(this.a.Yh(B,g.cg),B!=x);B=this.a.U(B));}else this.a.Yh(n,g.cg);g.clear()}}else if(null!=w){if(B=new a.b,this.a.w(k,B),e.O(this.ta,this.ta),e.contains(B)){g.Ap(w);this.a.wj(k,f);g.sA(this.ta,f,!1);u=g.Rl(0);if(0<u)if(this.a.bs(n,g,0,!0),A){x=-1;for(B=this.a.U(k);-1!=B&&B!=k&&(w=this.gw(B,l),x=B,null!=w&&w.fh(0));B=this.a.U(B));
for(B=k;-1!=B&&(this.a.Yh(B,g.cg),B!=x);B=this.a.U(B));}else this.a.Yh(k,g.cg);g.clear()}}else continue;if(0!=p+u){if(0!=p){m=this.a.ic(k);if(null==m){if(!this.a.pd(k,b))continue;m=b;b.s(c)}else m.s(c);if(m.fh(this.ta))break}h=!0}}}return h};b.prototype.nR=function(){return this.DW()};b.prototype.DW=function(){return(new a.WD).IY(this.a,this.ta)};b.prototype.uJ=function(){var d=!1,h,b;null==this.Tc&&(this.Tc=new a.uk);var l=new a.ia(0);l.yb(this.a.vd+1);for(var c=this.a.Qr(),e=c.next();-1!=e;e=c.next())l.add(e);
this.a.Xx(l,l.size);l.add(-1);c=this.a.Vd();e=this.a.Vd();this.we=new a.fE(this.a,this.ta,!this.LA);this.Tc.Ep(this.we);var f=new a.ia(0),g=new a.ia(0),k=0;new a.b;var m=this.a.Dd;this.a.xb.wc();for(var A=this.a.xb.ya[0].f,q,n,w=l.get(k++);-1!=w;){n=m.S(w,0);q=A[2*n];n=A[2*n+1];var x=q,p=n;do{var u=m.S(w,2),B=m.S(w,1);-1!=u&&(h=m.S(u,0),b=A[2*h],h=A[2*h+1],0>(p<h?-1:p>h?1:x<b?-1:x>b?1:0)&&(g.add(w),g.add(u)));-1!=B&&(h=m.S(B,0),b=A[2*h],h=A[2*h+1],0>(p<h?-1:p>h?1:x<b?-1:x>b?1:0)&&(g.add(B),g.add(B)));
b=this.a.Sa(w,c);-1!=b&&(f.add(b),this.a.Va(w,c,-1));b=this.a.Sa(w,e);-1!=b&&(f.add(b),this.a.Va(w,e,-1));w=l.get(k++);-1!==w&&(p=m.S(w,0),x=A[2*p],p=A[2*p+1])}while(-1!=w&&x===q&&p===n);x=1==f.size&&2==g.size;b=p=-1;u=0;for(B=f.size;u<B;u++){h=f.get(u);var z=this.Tc.Ve(h);-1==z||f.nA(z)||(p=z);h=this.Tc.nb(h);-1==h||f.nA(h)||(b=h);if(-1!=p&&-1!=b)break}this.we.QK(n,q);u=0;for(B=f.size;u<B;u++)h=f.get(u),this.Tc.Kd(h,-1);f.clear(!1);if(!x&&-1!=p&&-1!=b&&this.tQ(p,b)){d=!0;this.mj=this.we.en();break}u=
0;for(B=g.size;u<B;u+=2){n=g.get(u);q=g.get(u+1);x?(n=this.Tc.jv(p,b,n,!0),x=!1):n=this.Tc.addElement(n,-1);if(this.we.Ng){this.mj=this.we.en();d=!0;break}-1==this.a.Sa(q,c)?this.a.Va(q,c,n):this.a.Va(q,e,n)}if(d)break;g.yf(0)}this.a.le(c);this.a.le(e);return d};b.prototype.tQ=function(d,a){this.we.compare(this.Tc,this.Tc.ja(d),a);d=this.we.Ng;this.we.Gs();return d};b.Cj=function(d){for(var h=d.sd;-1!=h;h=d.Ue(h))if(a.T.Ic(d.hc(h)))return!0;return!1};b.Gm=function(d,a,l,c){if(!b.Cj(d))return!1;a=
new b(c);a.a=d;a.ta=l;if(15>d.vd)d=a.mR();else return a.nR();return d};b.V=function(d,a,l){return b.Gm(d,d.TG(),a,l)};b.tJ=function(d,h,l,c,e){if(!b.Cj(h))return!1;var f=new b(e);f.a=h;f.ta=l;f.LA=d;if(f.uJ())return null!=c&&c.ms(f.mj),!0;var r=new a.Hd;r.xC();h.Xc(r);f=new b(e);f.a=h;f.ta=l;f.LA=d;d=f.uJ();r.xC();h.Xc(r);return d?(null!=c&&c.ms(f.mj),!0):!1};b.qm=function(d,a){d=d.D();return 16>d?!1:2*d+Math.log(d)*Math.LOG10E/Math.log(2)*1*a<1*d*a};b.kR=function(d,h,l,c){if(a.T.Ic(h.G()))return(new b(c)).lR(d,
h,l);throw a.g.X("crack_A_with_B");};b.prototype.lR=function(d,h,l){var e=new a.h;d.ac(e);var f=new a.h;h.ac(f);f.O(l,l);if(!f.Yb(e))return d;var r=d.ob,g=null;null!=r&&(g=r.Mb);b.qm(d,d.D())&&(g=a.na.Lj(d,f));var k=null!=g?g.mf():null,m=h.Fa();h=d.Fa();for(var A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f=[];m.Ya();)for(;m.Ea();){var q=m.ba();if(null!=g)for(k.Wn(q,l),r=k.next();-1!=r;r=k.next()){if(this.Pr(),h.Tb(g.ja(r),-1),h.Ea())for(var r=h.ba(),n=r.Ma(q,null,A,null,l),r=0;r<n;++r){var w=A[r];if(0!=w&&
1!=w){var x=h.Db(),p=new c;p.t=w;p.index=x;f.push(p)}}}else{var u=new a.h;q.ac(u);u.O(l,l);if(e.Yb(u))for(h.yj();h.Ya();)for(;h.Ea();)if(this.Pr(),r=h.ba(),w=new a.h,r.ac(w),w.Yb(u))for(n=r.Ma(q,null,A,null,l),r=0;r<n;++r)w=A[r],0!=w&&1!=w&&(x=h.Db(),p=new c,p.t=w,p.index=x,f.push(p))}}if(0==f.length)return d;f=f.sort(c.Hs);d=d.Ka();for(h.yj();h.Ya()&&!h.Ea(););l=h.ba();e=new a.Cg;g=-1;r=0;for(k=f.length;r<k;){A=f[r].index;for(m=r+1;m<k&&f[m].index==A;)++m;for(;h.Db()<A;){this.Pr();q=h.Ea();w=h.Ta;
(u=q||!h.Fo()||h.Go())&&d.dc(l,g!=w);g=w;if(!q)for(;h.Ya()&&!h.Ea(););l=h.ba()}for(A=0;r<m;r++)w=f[r].t,w!=A&&(l.yh(A,w,e),A=w,w=h.Ta,d.dc(e.get(),g!=w),g=w);if(u=(q=h.Ea())||!h.Fo()||h.Go())l.yh(A,1,e),d.dc(e.get(),!1);if(q)l=h.ba();else{for(;h.Ya()&&!h.Ea(););h.Ea()?l=h.ba():l=null}r=m}null!=l&&(w=h.Ta,(u=(q=h.Ea())||!h.Fo()||h.Go())&&d.dc(l,g!=w),g=w);for(q=h.Ea();;){if(!q){for(;h.Ya()&&!(q=h.Ea()););if(!q)break}l=h.ba();w=h.Ta;(u=(q=h.Ea())||!h.Fo()||h.Go())&&d.dc(l,g!=w);g=w}return d};return b}();
a.Ku=b;var c=function(){function a(){}a.Hs=function(d,a){return d.index==a.index?d.t>a.t?1:d.t<a.t?-1:0:d.index>a.index?1:-1};return a}()})(D||(D={}));(function(a){(function(d){d[d.Left=0]="Left";d[d.Right=1]="Right";d[d.Coincident=2]="Coincident";d[d.Undefined=3]="Undefined";d[d.Uncut=4]="Uncut"})(a.VL||(a.VL={}));var b=function(){return function(d,a,b,l,c,e,f,g,k,m,A){this.Y=d;this.nx=a;this.It=b;this.Pg=l;this.yn=m;this.em=A}}();a.GZ=b;var c=function(){function d(d,a){this.YI=d;this.gj=a}d.prototype.HO=
function(d,h){var b=new a.b;this.gj.w(d,b);var l=new a.b;this.gj.w(h,l);b=b.compare(l);if(0!=b)return b;b=this.gj.Sa(d,this.YI);l=this.gj.Sa(h,this.YI);return b<l?-1:b==l?0:1};return d}(),l=function(){return function(d,a,b,l,c,e,f,g,k){this.Pg=d;this.It=a;this.tB=b;this.hJ=l;this.dj=c;this.em=e;this.yn=f;this.iJ=g;this.MV=k}}();a.FZ=l;var d=function(){function d(){}d.UL=function(h,l,c,e,f,g){if(l.u())h=new b(l,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),f.push(h);else{var r=new a.fd;r.Jb(l);r.Jb(c);
a.sk.V(r,e,g,!0);l=0;c=r.Vd();for(e=r.sd;-1!=e;e=r.Ue(e))for(g=r.Pb(e);-1!=g;g=r.Sb(g))for(var k=r.cb(g),y=0,m=r.La(g);y<m;k=r.U(k),y++)r.Va(k,c,l++);l=d.lM(c,r);d.tW(h,l,r,f)}};d.lM=function(h,b){for(var l=b.vd,e=new a.ia(0),f=b.sd;-1!=f;f=b.Ue(f))for(var r=b.Pb(f);-1!=r;r=b.Sb(r))for(var g=b.cb(r),k=0,y=b.La(r);k<y;g=b.U(g),k++)e.add(g);var m=new c(h,b);e.Gd(0,l,function(d,a){return m.HO(d,a)});h=[];var A=[],q=b.Vd(),n=b.Vd(),f=b.sd,r=b.Ue(f),y=new a.b,w=new a.b,x=e.get(0),p=b.ld(x),u=b.ng(p);b.w(x,
y);for(var B=1,g=0;B<l-1;){for(var z=!1,k=B;k<l;k++)if(k!=g){var v=e.get(k),t=b.ld(v),C=b.ng(t);b.w(v,w);if(y.ub(w))u==f&&C==r&&(z=d.nZ(q,n,b,h,A,p,x,t,v));else break}if(z||g==B-1){z&&g==B-1&&B--;if(++g==l)break;x=e.get(g);p=b.ld(x);u=b.ng(p);b.w(x,y)}z||(B=g+1)}l=[];for(f=b.sd;-1!=f;f=b.Ue(f))for(r=b.Pb(f);-1!=r;r=b.Sb(r))for(e=b.cb(r),k=0,y=b.La(r);k<y;e=b.U(e),k++){g=b.Sa(e,n);if(0<=g)for(;g<A.length&&A[g].Pg==e;)l.push(A[g++]);g=b.Sa(e,q);if(0<=g)for(;g<h.length&&h[g].Pg==e;)l.push(h[g++])}b.le(q);
b.le(n);return l};d.nZ=function(a,h,b,l,c,e,f,g,k){var r=b.Rj(e),y=b.Rj(g),m=b.cb(e),A=b.cb(g),q=b.Ra(f),n=b.Ra(k),w=!1,x=!1,p=!1,H=!1;f!=m&&(k!=A&&(w=d.tZ(a,b,l,e,q,g,n)),k!=y&&(x=d.vZ(a,b,l,e,q,g,k)));f!=r&&(k!=A&&(p=d.xZ(h,b,c,e,f,g,n,m)),k!=y&&(H=d.GL(h,b,c,e,f,g,k,m)));w&&x&&p?(a=l.length-1,2==c[H?c.length-2:c.length-1].dj&&(l[a-1]=l[a],--l.length)):w&&x&&H&&2==c[c.length-1].dj&&(c=l[l.length-1],--l.length,b.Sa(c.Pg,a)==l.length&&b.Va(c.Pg,a,-1));return w||x||p||H};d.tZ=function(d,h,b,c,e,f,
g){var r,k;k=new a.Hb;var y=new a.Hb,m=[0,0],A=[0,0];r=h.ic(e);null==r&&(h.pd(e,k),r=k);k=h.ic(g);null==k&&(h.pd(g,y),k=y);r=r.Ma(k,null,m,A,0);2>r&&(c=new l(e,c,m[0],NaN,r,g,f,A[0],NaN),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,b.length-1));return!0};d.vZ=function(d,h,b,c,e,f,g){var r,k;k=new a.Hb;var y=new a.Hb,m=[0,0],A=[0,0];r=h.ic(e);null==r&&(h.pd(e,k),r=k);k=h.ic(g);null==k&&(h.pd(g,y),k=y);r=r.Ma(k,null,m,A,0);return 2>r?(c=new l(e,c,m[0],NaN,r,g,f,A[0],NaN),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,
b.length-1),!0):!1};d.xZ=function(d,h,b,c,e,f,g,k){var r,y;y=new a.Hb;var m=new a.Hb,A=[0,0],q=[0,0];r=h.ic(e);null==r&&(h.pd(e,y),r=y);y=h.ic(g);null==y&&(h.pd(g,m),y=m);r=r.Ma(y,null,A,q,0);if(2==r)return c=new l(e,c,A[0],A[1],r,g,f,q[0],q[1]),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,b.length-1),!0;m=!1;e==k&&(c=new l(e,c,A[0],NaN,r,g,f,q[0],NaN),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,b.length-1),m=!0);return m};d.GL=function(d,h,b,c,e,f,g,k){var r,y;y=new a.Hb;var m=new a.Hb,A=[0,0],q=[0,0];r=h.ic(e);
null==r&&(h.pd(e,y),r=y);y=h.ic(g);null==y&&(h.pd(g,m),y=m);r=r.Ma(y,null,A,q,0);if(2==r)return c=new l(e,c,A[0],A[1],r,g,f,q[0],q[1]),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,b.length-1),!0;m=!1;e==k&&(c=new l(e,c,A[0],NaN,r,g,f,q[0],NaN),b.push(c),c=h.Sa(e,d),0>c&&h.Va(e,d,b.length-1),m=!0);return m};d.tW=function(h,l,c,e){var f,r=[];r[0]=new a.b;r[1]=new a.b;r[2]=new a.b;r[3]=new a.b;var g=new a.b,k=new a.b,m=new a.b,y=new a.b,A=null;null!=e&&(A=new a.Cg,A.Js());var q,n=0,w=null,x=new a.Hb;new a.Hb;
for(var p=c.Pb(c.sd);-1!=p;p=c.Sb(p)){var u,H=4,B=-1,z,v,t,C=-1,P,E,F,D,G=-1,aa=-1,I=NaN;u=!0;var K=!1,M=!0,J=!0,L=!0,Q=0;t=p;P=0;for(var O=c.cb(p),X=c.La(p),W=0;W<X;O=c.U(O),W++){q=c.ic(O);if(null==q){if(!c.pd(O,x))continue;q=x}-1==C&&(C=O);for(var S=0;n<l.length&&O==l[n].Pg;){B=l[n].It;z=l[n].Pg;v=l[n].tB;E=l[n].yn;F=l[n].em;D=l[n].iJ;if(2==l[n].dj){if(K||(t=B,C=z,P=v,G=E,aa=F,I=D,H=2,null!=e?w=new a.Ua:Q=0,L=!1,J=!0),v=l[n].hJ,D=l[n].MV,null!=e?(q.yh(S,l[n].hJ,A),w.dc(A.get(),J)):Q++,S=v,K=!0,
J=u=!1,n+1==l.length||2!=l[n+1].dj||l[n+1].Pg==z&&l[n+1].tB!=S)null!=e?(f=new b(w,2,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q),t=B,C=z,P=v,G=E,aa=F,I=D,H=2,K=u=!1,J=L=!0}else{var T=c.U(z);if(n<l.length-1&&l[n+1].Pg==T&&l[n+1].em==F&&2==l[n+1].dj)v!=S&&(L&&(null!=e?w=new a.Ua:Q=0),u=0<n&&l[n-1].It==B?1==H?0:0==H?1:3:3,null!=e?(q.yh(S,v,A),w.dc(A.get(),J),f=new b(w,u,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):(Q++,null.add(Q)),S=v,t=B,C=z,P=v,G=E,aa=F,I=D,H=u,u=M=!1,J=L=!0);else if(!d.aM(h,c,l,
n,g,k)){d.ML(c,l,n,p,O,m,y);var V=!1,T=!1;f=!0;if(!(g.ub(m)||k.ub(m)||g.ub(y)||k.ub(y))){r[0].L(g);r[1].L(k);r[2].L(m);r[3].L(y);r.sort(a.b.vs);var U=r[0],ga=r[1],ha=r[2],Y=r[3];U.ub(g)?ga.ub(k)?h?(T=V=!0,f=!1):V=!1:Y.ub(k)?h?f=T=V=!0:V=!1:(V=!0,f=ga.ub(m)):ga.ub(g)?ha.ub(k)?h?(T=V=!0,f=!1):V=!1:U.ub(k)?h?f=T=V=!0:V=!1:(V=!0,f=ha.ub(m)):ha.ub(g)?Y.ub(k)?h?(T=V=!0,f=!1):V=!1:ga.ub(k)?h?f=T=V=!0:V=!1:(V=!0,f=Y.ub(m)):U.ub(k)?h?(T=V=!0,f=!1):V=!1:ha.ub(k)?h?f=T=V=!0:V=!1:(V=!0,f=U.ub(m))}if(V){V=O==
z;if(v!=S||V&&0==S)L&&(null!=e?w=new a.Ua:Q=0),null!=e?(q.yh(S,v,A),w.dc(A.get(),J)):Q++;if(f)if(1!=H){if(v!=S||V&&0==S)null!=e?(f=new b(w,1,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q);if(!T)H=1;else if(n==l.length-2||l[n+2].It!=B)H=0}else{if(v!=S||V&&0==S)null!=e?(f=new b(w,3,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q);H=1}else if(0!=H){if(v!=S||V&&0==S)null!=e?(f=new b(w,0,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q);if(!T)H=0;else if(n==l.length-2||l[n+2].It!=B)H=1}else{if(v!=
S||V&&0==S)null!=e?(f=new b(w,3,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q);H=0}if(v!=S||V&&0==S)S=v,t=B,C=z,P=v,G=E,aa=F,I=D,u=M=!1,J=L=!0}}}n++}1!=S&&(L&&(null!=e?w=new a.Ua:Q=0),null!=e?(q.yh(S,1,A),w.dc(A.get(),J)):Q++,J=L=!1,M=!0)}M&&(v=1,z=c.Rj(p),z=c.Ra(z),F=E=-1,D=NaN,u?null!=e?(f=new b(w,4,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q):(u=1==H?0:0==H?1:3,null!=e?(f=new b(w,u,B,z,v,H,t,C,P,E,F,D,G,aa,I),e.push(f)):null.add(Q)))}};d.aM=function(h,b,l,c,e,f){var r=l[c].iJ;if(1==r)return d.QL(h,
b,l,c,e,f);if(0==r)return d.XL(h,b,l,c,e,f);throw a.g.za();};d.QL=function(d,h,b,l,c,e){var f=new a.Hb,r=b[l].Pg,g=b[l].yn,k=b[l].em,m=-1,y=-1,A=-1,q=-1;if(!d&&0<l)var n=b[l-1],m=n.Pg,y=n.yn,A=n.em,q=n.dj;var w=-1,x=-1,p=-1,u=-1;l<b.length-1&&(n=b[l+1],w=n.Pg,x=n.yn,p=n.em,u=n.dj);var H=h.U(r),n=h.U(k);if(!d)return 0<l&&m==r&&y==g&&A==n&&2==q||l<b.length-1&&w==H&&x==g&&p==n&&2==u?(d=h.ic(k),null==d&&(h.pd(k,f),d=f),e.L(d.Eg(1)),c.bu(e),e.normalize(),c.normalize(),!1):l<b.length-1&&w==r&&x==g&&p==
n?(d=h.ic(k),null==d&&(h.pd(k,f),d=f),c.L(d.Eg(1)),d=h.ic(n),null==d&&(h.pd(n,f),d=f),e.L(d.Eg(0)),c.Lr(),e.normalize(),c.normalize(),!1):!0;if(l==b.length-1||w!=r||x!=g||p!=n||2==u)return d=h.ic(k),null==d&&(h.pd(k,f),d=f),e.L(d.Eg(1)),c.bu(e),e.normalize(),c.normalize(),!1;d=h.ic(k);null==d&&(h.pd(k,f),d=f);c.L(d.Eg(1));d=h.ic(n);null==d&&(h.pd(n,f),d=f);e.L(d.Eg(0));c.Lr();e.normalize();c.normalize();return!1};d.XL=function(d,h,b,l,c,e){var f=new a.Hb,r=b[l].Pg,g=b[l].yn,k=b[l].em,m=-1,y=-1,A=
-1,q=-1;if(!d&&l<b.length-1)var n=b[l+1],m=n.Pg,y=n.yn,A=n.em,q=n.dj;var w=-1,x=-1,p=-1,n=-1;0<l&&(n=b[l-1],w=n.Pg,x=n.yn,p=n.em,n=n.dj);var u=h.U(r),H=h.Ra(k);return d?0==l||w!=r||x!=g||p!=H||2==n?(d=h.ic(k),null==d&&(h.pd(k,f),d=f),e.L(d.Eg(0)),c.bu(e),e.normalize(),c.normalize(),!1):!0:0<l&&w==r&&x==g&&p==H&&2==n||l<b.length-1&&m==u&&y==g&&A==H&&2==q?(d=h.ic(k),null==d&&(h.pd(k,f),d=f),e.L(d.Eg(0)),c.bu(e),e.normalize(),c.normalize(),!1):!0};d.ML=function(d,h,b,l,c,e,f){var r=new a.Hb,g=d.ic(c);
null==g&&(d.pd(c,r),g=r);b=h[b];h=b.Pg;b=b.tB;c=d.U(h);if(1==b)e.L(g.Eg(1)),-1!=c&&c!=d.Rj(l)?(g=d.ic(c),null==g&&(d.pd(c,r),g=r),f.L(g.Eg(0)),g=d.ic(h),null==g&&d.pd(h,r)):f.L(e),e.Lr(),f.normalize(),e.normalize();else if(0==b)f.L(g.Eg(b)),e.bu(f),f.normalize(),e.normalize();else throw a.g.za();};return d}();a.WL=d})(D||(D={}));(function(a){(function(d){d[d.Linear=0]="Linear";d[d.Angular=1]="Angular";d[d.Area=2]="Area"})(a.iO||(a.iO={}));var b=function(){function d(d,a,h){this.nd=a;this.Ai=h;this.bB=
d}d.prototype.Eb=function(a){return a instanceof d?this.Ai===a.Ai:!1};d.lH=function(a){return 0!==a.nd?null:-1===a.bB?new d(-1,2,a.Ai*a.Ai):d.ze(e[a.bB])};d.ze=function(d){d=h[d];return void 0===d?null:d};d.bR=function(a,h,b){var l=null;if(void 0!==b&&null!==b)try{"EPSG"===b.values[0]&&(l=d.ze(parseInt(b.values[1])))}catch(N){}null===l&&(l=new d(-1,a,h));return l};d.prototype.yc=function(){return this.bB};d.prototype.OG=function(d){if(d.nd!=this.nd)throw a.g.Da();return this.Ai/d.Ai};d.li=function(d,
a,h){return a.OG(h)*d};d.dG=function(d,a,h,b,l){h=h.OG(b);for(b=0;b<a;b++)l[b]=d[b]*h};return d}();a.oc=b;for(var c=[109402,4046.8564224,109403,4046.87260987425,109463,100,109401,1E4,109461,225E8,109460,25E8,109451,1E-4,109444,404.68564224000005,109424,404.6849341289498,109428,404.68493792602754,109416,404.67838076760535,109420,404.68423895571647,109448,404.683871963536,109411,404.6872609874253,109450,.01,109408,3.34450944,109405,.09290304,109430,.09290354800069446,109423,.0929028774400711,109427,
.09290287831176021,109441,.09290349665192114,109407,.09290137299531805,109440,.09290286332673177,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109419,.09290271785025629,109447,.0929026336004445,109406,.09290341161327487,109453,6.4516E-4,109454,6.451625806477421E-4,109414,1E6,109445,.04046856422400001,109425,.04046849341289498,109429,.04046849379260275,109417,.04046783807676053,109421,.04046842389557164,109449,.0404683871963536,109412,.04046872609874253,
109404,1,109410,1.000027193184865,109413,2589998.4703195216,109452,1E-6,109409,3429904,109458,3434290.937856,109457,3434528.1495040003,109464,1.244521604938272E-7,109455,25.292852640000003,109456,25.29295381171408,109459,2.89612324,109439,2589988.110336,109462,.7168473118308245,109442,.83612736,109422,.83612589696064,109426,.836125904805842,109415,.8361123569578626,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109418,.8361244606523066,109446,.8361237024040001,
109443,.8361307045194736],l=[9103,2.908882086657216E-4,9104,4.84813681109536E-6,9102,.0174532925199433,9106,.01570796326794897,9105,.01570796326794897,9109,1E-6,9114,9.817477042468104E-4,1031,4.84813681109536E-9,9112,1.570796326794897E-4,9101,1,9113,1.570796326794897E-6],d=[109031,15E4,109461,109030,5E4,109460,1033,.01,109451,9097,20.1168,109444,9052,20.1167824,109424,9062,20.116782494375872,109428,9038,20.1166195164,109416,9042,20.116765121552632,109420,9301,20.116756,109448,9033,20.11684023368047,
109411,109005,.1,109450,9014,1.8288,109408,9002,.3048,109405,9070,.3048008333333334,109430,9051,.3047997333333333,109423,9061,.3047997347632708,109427,9095,.3048007491,109441,9005,.3047972654,109407,9094,.3047997101815088,109440,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9041,.304799471538676,109419,9300,.3047993333333334,109447,9003,.3048006096012192,109406,109008,.0254,109453,109009,.0254000508001016,109454,9036,1E3,109414,9098,.201168,109445,9053,
.201167824,109425,9063,.2011678249437587,109429,9039,.201166195164,109417,9043,.2011676512155263,109421,9302,.20116756,109449,9034,.2011684023368047,109412,9001,1,109404,9031,1.0000135965,109410,9035,1609.3472186944375,109413,1025,.001,109452,9030,1852,109409,109013,1853.184,109458,109012,1853.248,109457,109016,3.527777777777778E-4,109464,109010,5.0292,109455,109011,5.029210058420118,109456,109014,1.7018,109459,9093,1609.344,109439,109015,.8466683600033867,109462,9096,.9144,109442,9050,.9143992,109422,
9060,.9143992042898124,109426,9037,.9143917962000001,109415,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9040,.9143984146160287,109418,9099,.914398,109446,109002,.9144018288036576,109443,109001,.9144,109442,109003,20.1168,109444,109004,.201168,109445,109006,.01,109451,109007,.001,109452],h=[],e=[],f=0;f<c.length;f+=2)h[c[f]]=new b(c[f],2,c[f+1]);c=null;for(f=0;f<l.length;f+=2)h[l[f]]=new b(l[f],1,l[f+1]);l=null;for(f=0;f<d.length;f+=3)h[d[f]]=new b(d[f],
0,d[f+1]),e[d[f]]=d[f+2];d=null})(D||(D={}));(function(a){var b=function(){function a(){this.Gb=this.qb=0}a.prototype.set=function(a,d){void 0!==d?(this.qb=a,this.Gb=d):"number"===typeof a?(this.qb=a,this.Gb=0):(this.qb=a.qb,this.Gb=a.Gb)};a.prototype.value=function(){return this.qb};a.prototype.add=function(a){var d=this.qb+a.qb;a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(d);this.qb=d;this.Gb=a};a.prototype.iP=function(){var a=this.qb+1,d=this.Gb+2.220446049250313E-16*Math.abs(a);this.qb=a;this.Gb=
d};a.prototype.bP=function(a,d){this.qb=a.qb+d.qb;this.Gb=a.Gb+d.Gb+2.220446049250313E-16*Math.abs(this.qb)};a.prototype.sub=function(a){if("number"===typeof a){var d=this.qb-a;a=this.Gb+2.220446049250313E-16*Math.abs(d)}else d=this.qb-a.qb,a=this.Gb+a.Gb+2.220446049250313E-16*Math.abs(d);this.qb=d;this.Gb=a};a.prototype.Vg=function(a){var d=this.qb*a.qb;this.Gb=this.Gb*Math.abs(a.qb)+a.Gb*Math.abs(this.qb)+this.Gb*a.Gb+2.220446049250313E-16*Math.abs(d);this.qb=d};a.prototype.yp=function(a){var d=
this.qb*a;this.Gb=this.Gb*Math.abs(a)+2.220446049250313E-16*Math.abs(d);this.qb=d};a.prototype.pm=function(a,d){var h=Math.abs(a.qb)*Math.abs(d.qb);this.Gb=a.Gb*Math.abs(d.qb)+d.Gb*Math.abs(a.qb)+a.Gb*d.Gb+2.220446049250313E-16*Math.abs(h);this.qb=h};a.prototype.Wm=function(a){var d=Math.abs(a.qb),h=this.qb/a.qb,b=(this.Gb+Math.abs(h)*a.Gb)/d;a.Gb>.01*d&&(a=a.Gb/d,b*=1+(1+a)*a);this.qb=h;this.Gb=b+2.220446049250313E-16*Math.abs(h)};a.prototype.sqrt=function(){var a,d;0<=this.qb?(a=Math.sqrt(this.qb),
d=this.qb>10*this.Gb?.5*this.Gb/a:this.qb>this.Gb?a-Math.sqrt(this.qb-this.Gb):Math.max(a,Math.sqrt(this.qb+this.Gb)-a),d+=2.220446049250313E-16*Math.abs(a)):this.qb<-1*this.Gb?d=a=NaN:(a=0,d=Math.sqrt(this.Gb));this.qb=a;this.Gb=d};a.prototype.sin=function(a){var d=Math.sin(a.qb),h=Math.cos(a.qb);this.qb=d;d=Math.abs(d);this.Gb=(Math.abs(h)+.5*d*a.Gb)*a.Gb+2.220446049250313E-16*d};a.prototype.cos=function(a){var d=Math.sin(a.qb),h=Math.cos(a.qb);this.qb=h;h=Math.abs(h);this.Gb=(Math.abs(d)+.5*h*
a.Gb)*a.Gb+2.220446049250313E-16*h};a.prototype.Lg=function(){return Math.abs(this.qb)<=this.Gb};a.prototype.lt=function(){return this.Lg()&&0!=this.Gb};return a}();a.Xb=b})(D||(D={}));var I=new D.b,K=new D.b,J=new D.b,L=new D.b,M=new D.b;(function(a){var b;(function(a){a[a.closedPath=1]="closedPath";a[a.exteriorPath=2]="exteriorPath";a[a.ringAreaValid=4]="ringAreaValid"})(b||(b={}));var c=function(){function b(d,a,b,l,c,e,f){void 0!==a?(this.bb=d,this.Ck=a,this.Gl=b,this.Ji=l,this.Ca=e,this.QA=f,
this.Uw=c):(this.bb=d.bb,this.Ck=d.Ck,this.Gl=d.Gl,this.Ji=d.Ji,this.Ca=d.Ca,this.QA=d.QA,this.Uw=d.Uw);this.nI=!0}b.prototype.next=function(){return this.nI?(this.nI=!1,this.Ji):-1!=this.Ji?(this.Ji=this.bb.U(this.Ji),this.Ca++,-1!=this.Ji&&this.Ji!=this.Uw?this.Ji:this.YV()):-1};b.prototype.YV=function(){this.Gl=this.bb.Sb(this.Gl);for(this.Ca=0;-1!=this.Ck;){for(;-1!=this.Gl;this.Gl=this.bb.Sb(this.Gl))if(this.Uw=this.Ji=this.bb.cb(this.Gl),-1!=this.Ji)return this.Ji;this.Ck=this.bb.Ue(this.Ck);
if(-1==this.Ck)break;if(!this.QA||a.T.Ic(this.bb.hc(this.Ck)))this.Gl=this.bb.Pb(this.Ck)}return-1};b.xR=function(d,a,l,c,e,f,g){return new b(d,a,l,c,e,f,g)};return b}();a.MZ=c;b=function(){function b(){this.Xo=this.on=this.Yk=this.md=this.el=this.jp=this.nj=this.td=this.Bi=this.ph=this.wf=this.Hr=this.Kr=this.xb=this.nm=null;this.cx=this.sd=-1;this.vd=0;this.OA=!1;this.Hr=this.Kr=this.xb=null}b.prototype.ti=function(d){return null!=this.wf?this.wf[d]:null};b.prototype.th=function(d,a){if(null==this.wf){if(null==
a)return;this.wf=[];for(var b=0,h=this.xb.D();b<h;b++)this.wf.push(null)}this.wf[d]=a};b.prototype.Lp=function(d,a){this.td.P(d,1,a)};b.prototype.Kp=function(d,a){this.td.P(d,2,a)};b.prototype.tC=function(d,a){this.td.P(d,6,a)};b.prototype.Lq=function(d){return this.td.S(d,6)};b.prototype.Rx=function(d,a){this.td.P(d,7,a)};b.prototype.dw=function(d){return this.td.S(d,0)};b.prototype.FK=function(d,a){this.md.P(d,1,a)};b.prototype.JK=function(d,a){this.md.P(d,0,a)};b.prototype.UG=function(d){return this.md.S(d,
7)};b.prototype.Ip=function(d,a){this.md.P(d,3,a)};b.prototype.Jp=function(d,a){this.md.P(d,4,a)};b.prototype.eW=function(d){null==this.md&&(this.md=new a.ad(8));var b=this.md.Pe();this.md.P(b,2,d);this.md.P(b,5,0);this.md.P(b,6,0);this.md.P(b,7,b);return b};b.prototype.CS=function(d){this.md.kd(d)};b.prototype.gW=function(d){null==this.td&&(this.td=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Rd(0),this.jp=new a.Rd(0));var b=this.td.Pe();this.td.P(b,0,b);this.td.P(b,3,0);this.td.P(b,6,0);this.Rx(b,
d);b>=this.nj.size&&(d=16>b?16:a.J.truncate(3*b/2),this.nj.resize(d),this.jp.resize(d));this.nj.set(b,0);this.jp.set(b,0);return b};b.prototype.DG=function(d){this.td.kd(d)};b.prototype.Dz=function(d){this.Dd.kd(d);this.vd--};b.prototype.xJ=function(d){null==this.td&&(this.td=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Rd(0),this.jp=new a.Rd(0));var b=this.Dd.Pe(),l=0<=d?d:b;this.Dd.P(b,0,l);if(0>d){if(l>=this.xb.D()){d=16>l?16:a.J.truncate(3*l/2);this.xb.resize(d);if(null!=this.wf)for(var c=0;c<
d;c++)this.wf.push(null);null!=this.ph&&this.ph.resize(d);this.Kr=this.xb.Pa(0)}this.xb.rb(l,-1E38,-1E38);null!=this.wf&&(this.wf[l]=null);null!=this.ph&&this.ph.write(l,1)}this.Dd.P(b,4,2*l);this.vd++;return b};b.prototype.Wj=function(d,a,b){var h=-1!=a?this.Ra(a):this.Rj(d),l=-1!=h?this.U(h):-1,c=this.xJ(null==b?this.vd:-1),e=this.Za(c);null!=b&&this.xb.vu(e,b);this.Aj(c,d);this.Kc(c,l);this.Lc(c,h);-1!=l&&this.Lc(l,c);-1!=h&&this.Kc(h,c);b=this.Qb(d);h=this.cb(d);-1==a&&this.sh(d,c);a==h&&this.jg(d,
c);b&&-1==l&&(this.Kc(c,c),this.Lc(c,c));this.nk(d,this.La(d)+1);d=this.ng(d);this.lk(d,this.D(d)+1);return c};b.prototype.an=function(){null==this.Xo&&(this.Xo=new a.Wa(this.xb.description));return this.Xo};b.prototype.Hp=function(d,a){this.md.P(d,2,this.md.S(d,2)&-134217729||(1==a?134217728:0))};b.prototype.xo=function(d){return 0!=(this.md.S(d,2)&134217728)?1:0};b.prototype.fP=function(d){var a=this.bh(d.G(),d.description);1736==d.G()&&this.Hp(a,d.xo());this.gF(a,d);return a};b.prototype.gP=function(d){var a=
this.bh(d.G(),d.description);this.hF(a,d);return a};b.prototype.PW=function(d,b){null==this.td&&(this.td=new a.ad(8),this.Dd=new a.ad(5),this.nj=new a.Rd(0),this.jp=new a.Rd(0));this.td.Qe(this.td.yd+d);this.Dd.Qe(this.Dd.yd+b);this.nj.yb(this.nj.size+d);this.jp.yb(this.jp.size+d)};b.prototype.gF=function(d,b){this.PW(b.aa(),b.D());this.nm.Id(b,0,b.D());this.Kr=this.xb.Pa(0);for(var h=null!=this.wf&&null!=b.cf,l=0,c=b.aa();l<c;l++)if(!(2>b.La(l))){var e=this.Yf(d,-1);this.$n(e,b.Qb(l));for(var f=
b.wa(l),g=b.Gc(l);f<g;f++){var k=this.Wj(e,-1,null);if(h)if(k=this.Za(k),0!=(b.jH(f)&1))this.th(k,null);else{var m=new a.Cg;b.ic(f,m,!0);this.th(k,m.get())}}}};b.prototype.hF=function(d,a){this.nm.Id(a,0,a.D());this.Kr=this.xb.Pa(0);d=this.Yf(d,-1);var b=0;for(a=a.D();b<a;b++)this.Wj(d,-1,null)};b.prototype.GY=function(d,b,l){var h=this.U(d);if(-1==h)throw a.g.za();for(var c=this.an(),e=this.ld(d),f=0,r=b.Rl(l);f<r;f++){var g=this.Za(d),k=this.U(d),m=b.Mq(l,f);0==f&&(m.Dp(c),this.Yh(d,c));322==m.G()?
this.th(g,null):this.th(g,a.T.oe(m));m.Bp(c);f<r-1?d=this.Wj(e,k,c):this.Yh(h,c)}};b.prototype.FY=function(d,b,l){var h=this.U(d);if(-1==h)throw a.g.za();for(var c=this.an(),e=this.ld(d),f=0,r=b.Rl(l);f<r;f++){var g=this.Za(d),k=this.U(d),m=b.Mq(l,r-f-1);0==f&&(m.Bp(c),this.Yh(d,c));322==m.G()?this.th(g,null):this.th(g,a.T.oe(m));m.Dp(c);f<r-1?d=this.Wj(e,k,c):this.Yh(h,c)}};b.prototype.TG=function(){var d=new a.h;d.Oa();for(var b=this.Qr(),l=new a.b,c=!0,e=b.next();-1!=e;e=b.next())this.w(e,l),c?
d.Nb(l.x,l.y):d.ml(l.x,l.y),c=!1;return d};b.prototype.Jb=function(d){var b=d.G();if(a.T.Ic(b))return this.fP(d);if(550==b)return this.gP(d);throw a.g.za();};b.prototype.wP=function(d,b){var h=b.G();if(a.T.Ic(h))this.gF(d,b);else if(550==h)this.hF(d,b);else throw a.g.za();};b.prototype.kP=function(d,b){var h=this.bh(1736,d.description);if(2>d.La(b))return h;this.nm.Id(d,d.wa(b),d.Gc(b));this.Kr=this.xb.Pa(0);var l=this.Yf(h,-1);this.$n(l,d.Qb(b)||!0);var c=null!=this.wf&&null!=d.cf,e=d.wa(b);for(b=
d.Gc(b);e<b;e++){var f=this.Wj(l,-1,null);if(c)if(f=this.Za(f),0!=(d.jH(e)&1))this.th(f,null);else{var g=new a.Cg;d.ic(e,g,!0);this.th(f,g.get())}}return h};b.prototype.Se=function(d){var b=this.hc(d),l=a.uM.bh(b,this.nm.description),c=this.D(d);if(0==c)return l;if(a.T.Ic(b)){for(var b=this.aa(d),e=a.Uc.wh(b+1),f=a.Uc.vq(b+1,0),g=l.description,k=0,m=g.Ga;k<m;k++){for(var q=g.rd(k),n=a.ma.Xa(q),A=a.Uc.qz(q,c),w=this.xb.Pa(q),x=0,p=0,u=0,B=this.Pb(d);-1!=B;B=this.Sb(B)){var z=0;this.Qb(B)&&(z|=1);this.RU(B)&&
(z|=4);0!=z&&f.iC(p,z);var v=this.La(B);e.write(p++,u);u+=v;if(0==q)for(var v=w,t=A,C=new a.b,z=this.cb(B);x<u;z=this.U(z),x++){var E=this.Za(z);v.fc(2*E,C);t.fo(2*x,C)}else for(z=this.cb(B);x<u;z=this.U(z),x++)for(E=this.Za(z),t=0;t<n;t++)C=w.Of(E*n+t),A.Dm(x*n+t,C)}l.Yn(q,A);e.write(b,c)}l.GK(f);l.HK(e);l.Dc(16777215)}else if(550==b){g=l.description;l.resize(c);k=0;for(m=g.Ga;k<m;k++){q=g.rd(k);n=a.ma.Xa(q);A=l.Pa(q);w=this.xb.Pa(q);x=0;B=this.Pb(d);v=this.La(B);for(z=this.cb(B);x<v;z=this.U(z),
x++)for(E=this.Za(z),t=0;t<n;t++)C=w.Of(E*n+t),A.Dm(x*n+t,C);l.Yn(q,A)}l.Dc(16777215)}return l};b.prototype.aC=function(d){for(var a=this.Pb(d);-1!=a;a=this.Rr(a));var a=this.IT(d),b=this.Ue(d);-1!=a?this.FK(a,b):this.sd=b;-1!=b?this.JK(b,a):this.cx=a;this.CS(d)};b.prototype.bh=function(d,b){return void 0===b?this.gG(d,a.ye.Ig()):this.gG(d,b)};b.prototype.gG=function(d,b){d=this.eW(d);null==this.xb?this.xb=this.nm=new a.Ed(b):this.nm.om(b);this.Hr=this.nm.description;this.OA=1<this.Hr.Ga;-1==this.sd?
this.sd=d:(this.JK(d,this.cx),this.FK(this.cx,d));return this.cx=d};b.prototype.Ue=function(d){return this.md.S(d,1)};b.prototype.IT=function(d){return this.md.S(d,0)};b.prototype.hc=function(d){return this.md.S(d,2)&2147483647};b.prototype.xK=function(d,b,l){b=this.Yk[b];d=this.UG(d);d>=b.size&&b.resize(Math.max(a.J.truncate(1.25*d),16),-1);b.write(d,l)};b.prototype.VG=function(d,a){d=this.UG(d);a=this.Yk[a];return d<a.size?a.read(d):-1};b.prototype.hG=function(){null==this.Yk&&(this.Yk=[]);for(var d=
0;d<this.Yk.length;d++)if(null==this.Yk[d])return this.Yk[d]=a.Uc.wh(0),d;this.Yk.push(a.Uc.wh(0));return this.Yk.length-1};b.prototype.uX=function(d){this.Yk[d]=null};b.prototype.Pb=function(d){return this.md.S(d,3)};b.prototype.Xv=function(d){return this.md.S(d,4)};b.prototype.D=function(d){return this.md.S(d,5)};b.prototype.aa=function(d){return this.md.S(d,6)};b.prototype.zq=function(d,b,l){for(var h=0,c=this.sd;-1!=c;c=this.Ue(c)){var e=this.hc(c);if(a.T.Ic(e)&&(!l||1736==e))for(var e=1736==
this.hc(c),f=this.Pb(c);-1!=f;){for(var r=0,g=this.cb(f);r<a.J.truncate(this.La(f)/2);){var k=this.U(g);if(-1==k)break;var m=this.Za(g),q=this.ti(m);null!=q?m=q.Rb():(q=this.Za(k),m=this.xb.xs(m,q));m<=d?(0==m?0==h&&(h=-1):h=1,k!=this.Rj(f)&&(this.JC(k,g),this.ud(k,!0))):g=this.U(g);r++}r=this.cb(f);for(g=this.Qb(f)?r:this.Rj(f);0<this.La(f);)if(k=this.Ra(g),-1!=k){var n=this.Za(k),q=this.ti(n);null!=q?m=q.Rb():(m=this.Za(g),m=this.xb.xs(m,n));if(m<=d)0==m?0==h&&(h=-1):h=1,this.JC(k,g),this.ud(k,
!1),r==k&&(r=this.cb(f));else if(g=this.Ra(g),g==r)break}else{this.ud(g,!0);0==h&&(h=-1);break}g=this.La(f);b&&(e?3>g:2>g)?(f=this.Rr(f),h=0<g?1:0==h?-1:h):f=this.Sb(f)}}return h};b.prototype.JC=function(d,a){var b=this.Za(d),h=this.Za(a);null!=this.ph&&(b=this.ph.read(b),this.ph.write(h,b));if(null!=this.Bi)for(h=0,b=this.Bi.length;h<b;h++)if(null!=this.Bi[h]){var l=this.Sa(d,h);-1!=l&&this.Va(a,h,l)}};b.prototype.zm=function(d,b,l){var h=0,c=this.U(d);if(-1==c)throw a.g.za();for(var e=this.Za(d),
f=this.Za(c),r=this.ti(e),g=null==r?this.xb.xs(e,f):r.Rb(),k=0;k<l;k++){var m=b[k];if(0<m&&1>m){var q=m;null!=r&&(q=0<g?r.Dy(m)/g:0);this.xb.DE(e,f,q,this.an());var n=this.Wj(this.ld(d),c,this.an());h++;if(null!=r){var A=r.Hl(0,m),q=this.Za(this.Ra(n));this.th(q,A);this.Qf(n,A.Cc());if(k==l-1||1==b[k+1])m=r.Hl(m,1),this.th(q,m)}}}return h};b.prototype.EY=function(d,b,l){var h=0,c=this.U(d);if(-1==c)throw a.g.X("internal error");var e=this.Za(d),f=this.Za(c),r=this.ti(e),g=null==r?this.xb.xs(e,f):
r.Rb(),k=0;d=this.ld(d);for(var m=0;m<l;m++){var q=b[m];if(k<q&&1>q){var n=q;null!=r&&(n=0<g?r.Dy(q)/g:0);this.xb.DE(e,f,n,this.an());n=this.tU(d,c,this.an());h++;if(null!=r){var k=r.Hl(k,q),A=this.Za(this.Ra(n));this.th(A,k);this.rb(n,k.sa,k.oa);if(m==l-1||1==b[m+1])k=r.Hl(q,1),n=this.Za(n),this.th(n,k)}}k=q}return h};b.prototype.tU=function(d,a,b){var h=-1!=a?this.Ra(a):this.Rj(d),l=-1!=h?this.U(h):-1,c=this.xJ(null==b?this.vd:-1),e=this.Za(c);null!=b&&this.xb.vu(e,b);this.Aj(c,d);this.Kc(c,l);
this.Lc(c,h);-1!=l&&this.Lc(l,c);-1!=h&&this.Kc(h,c);b=this.Qb(d);h=this.cb(d);-1==a&&this.sh(d,c);a==h&&(b&&-1!=h||this.jg(d,c));b&&-1==l&&(this.Kc(c,c),this.Lc(c,c));this.nk(d,this.La(d)+1);d=this.ng(d);this.lk(d,this.D(d)+1);return c};b.prototype.EF=function(d,b,l){var h=this.Za(b),c=this.Za(l);if(0>h||c>this.vd-1)throw a.g.F("invalid call");if(h>c&&!this.Qb(d))throw a.g.F("cannot iterate across an open path");for(d=0;b!=l;b=this.U(b))h=this.Za(b),c=this.ti(h),null!=c?d+=c.Rb():(c=this.Za(this.U(b)),
d+=this.xb.xs(h,c));return d};b.prototype.Yh=function(d,a){var b=this.Za(d);this.xb.vu(b,a);b=this.ti(b);null!=b&&b.setStart(a);d=this.Ra(d);-1!=d&&(d=this.Za(d),null!=this.ti(d)&&b.setEnd(a))};b.prototype.wj=function(d,a){d=this.Za(d);this.xb.Ae(d,a)};b.prototype.Qf=function(d,a){this.rb(d,a.x,a.y)};b.prototype.rb=function(d,a,b){var h=this.Za(d);this.xb.rb(h,a,b);h=this.ti(h);null!=h&&h.wC(a,b);d=this.Ra(d);-1!=d&&(d=this.Za(d),null!=this.ti(d)&&h.vm(a,b))};b.prototype.w=function(d,a){this.xb.w(this.Dd.S(d,
0),a)};b.prototype.Nc=function(d,a){this.xb.ya[0].fc(2*this.Dd.S(d,0),a)};b.prototype.Ba=function(d){var b=new a.b;this.xb.w(this.Dd.S(d,0),b);return b};b.prototype.pH=function(d,a){this.Kr.fc(2*d,a)};b.prototype.Yc=function(d,a,b){return this.xb.Yc(d,this.Za(a),b)};b.prototype.setAttribute=function(d,a,b,l){this.xb.setAttribute(d,this.Za(a),b,l)};b.prototype.Za=function(d){return this.Dd.S(d,0)};b.prototype.nf=function(d){var b=new a.b;this.w(d,b);return b.y};b.prototype.Uq=function(d,a){d=this.Za(d);
a=this.Za(a);var b=this.xb.ya[0].f;return b[2*d]===b[2*a]&&b[2*d+1]===b[2*a+1]};b.prototype.qw=function(d,a){d=this.Za(d);var b=this.xb.ya[0].f;return b[2*d]===a.x&&b[2*d+1]===a.y};b.prototype.qY=function(d,b){1>b&&(b=1);if(null==this.ph){if(1==b)return;this.ph=a.Uc.Um(this.xb.D(),1)}d=this.Za(d);d>=this.ph.size&&this.ph.resize(d+1,1);this.ph.write(d,b)};b.prototype.oH=function(d){d=this.Za(d);return null==this.ph||d>=this.ph.size?1:this.ph.read(d)};b.prototype.Va=function(d,a,b){a=this.Bi[a];d=this.Za(d);
a.size<this.xb.D()&&a.resize(this.xb.D(),-1);a.write(d,b)};b.prototype.Sa=function(d,a){d=this.Za(d);a=this.Bi[a];return d<a.size?a.read(d):-1};b.prototype.Vd=function(){null==this.Bi&&(this.Bi=[]);for(var d=0;d<this.Bi.length;d++)if(null==this.Bi[d])return this.Bi[d]=a.Uc.wh(0,-1),d;this.Bi.push(a.Uc.wh(0,-1));return this.Bi.length-1};b.prototype.le=function(d){this.Bi[d]=null};b.prototype.ic=function(d){return null!=this.wf?(d=this.Za(d),this.wf[d]):null};b.prototype.pd=function(d,b){var h=this.Dd.S(d,
2);if(-1==h)return!1;if(this.OA){var l=new a.Wa;this.wj(d,l);b.setStart(l);this.wj(h,l);b.setEnd(l)}else this.xb.Nc(this.Dd.S(d,0),I),b.Qm(0,I),this.xb.Nc(this.Dd.S(h,0),I),b.Qm(1,I);return!0};b.prototype.gX=function(d,b,l){if(this.OA){var h=new a.Wa;this.wj(d,h);l.setStart(h);this.wj(b,h);l.setEnd(h)}else this.xb.Nc(d,I),l.Qm(0,I),this.xb.Nc(b,I),l.Qm(1,I)};b.prototype.Yf=function(d,b){var h;if(-1!=b){if(d!=this.ng(b))throw a.g.za();h=this.ct(b)}else h=this.Xv(d);var l=this.gW(d);-1!=b&&this.Lp(b,
l);this.Kp(l,b);this.Lp(l,h);-1!=h?this.Kp(h,l):this.Ip(d,l);-1==b&&this.Jp(d,l);this.wm(d,this.aa(d)+1);return l};b.prototype.BH=function(d,a,b,l){d=this.Yf(d,-1);for(var h=0,c=a,e=!1;c==b&&(e=!0),this.Aj(c,d),h++,c=this.U(c),c!=a;);this.$n(d,!0);this.nk(d,h);e&&(a=b);this.jg(d,a);this.sh(d,this.Ra(a));this.Np(d,!1);null!=l&&(l[0]=e);return d};b.prototype.Rr=function(d){var a=this.ct(d),b=this.Sb(d),l=this.ng(d);-1!=a?this.Kp(a,b):this.Ip(l,b);-1!=b?this.Lp(b,a):this.Jp(l,a);this.DQ(d);this.wm(l,
this.aa(l)-1);this.DG(d);return b};b.prototype.DQ=function(d){var a=this.cb(d);if(-1!=a){for(var b=0,l=this.La(d);b<l;b++){var c=a,a=this.U(a);this.Dz(c)}a=this.ng(d);this.lk(a,this.D(a)-this.La(d))}this.nk(d,0)};b.prototype.Sb=function(d){return this.td.S(d,2)};b.prototype.ct=function(d){return this.td.S(d,1)};b.prototype.La=function(d){return this.td.S(d,3)};b.prototype.Qb=function(d){return 0!=(this.Lq(d)&1)};b.prototype.$n=function(d,a){if(this.Qb(d)!=a){if(0<this.La(d)){var b=this.cb(d),h=this.Rj(d);
a?(this.Kc(h,b),this.Lc(b,h)):(this.Kc(h,-1),this.Lc(b,-1));b=this.Za(h);this.th(b,null)}this.tC(d,(this.Lq(d)|1)-1|(a?1:0))}};b.prototype.ng=function(d){return this.td.S(d,7)};b.prototype.RU=function(d){return 0!=(this.Lq(d)&2)};b.prototype.oC=function(d,a){this.tC(d,(this.Lq(d)|2)-2|(a?2:0))};b.prototype.gA=function(d){if(this.XU(d))return this.nj.get(this.dw(d));var b=new a.Hb,l=this.cb(d);if(-1==l)return 0;var c=new a.b;this.w(l,c);for(var e=0,f=0,g=this.La(d);f<g;f++,l=this.U(l)){var k=this.ic(l);
if(null==k){if(!this.pd(l,b))continue;k=b}e+=k.Cy(c.x,c.y)}this.Np(d,!0);this.nj.set(this.dw(d),e);return e};b.prototype.$r=function(d,a,b){a=this.el[a];d=this.dw(d);a.size<this.nj.size&&a.resize(this.nj.size,-1);a.write(d,b)};b.prototype.Tj=function(d,a){d=this.dw(d);a=this.el[a];return d<a.size?a.read(d):-1};b.prototype.rz=function(){null==this.el&&(this.el=[]);for(var d=0;d<this.el.length;d++)if(null==this.el[d])return this.el[d]=a.Uc.wh(0),d;this.el.push(a.Uc.wh(0));return this.el.length-1};b.prototype.bC=
function(d){this.el[d]=null};b.prototype.XV=function(d,b,l){if(-1==l)throw a.g.F();if(b!=l){var h=this.Sb(l),c=this.ct(l),e=this.ng(l);-1==c?this.Ip(e,h):this.Kp(c,h);-1==h?this.Jp(e,c):this.Lp(h,c);this.lk(e,this.D(e)-this.La(l));this.wm(e,this.aa(e)-1);c=-1==b?this.Xv(d):this.ct(b);this.Lp(l,c);this.Kp(l,b);-1==b?this.Jp(d,l):this.Lp(b,l);-1==c?this.Ip(d,l):this.Kp(c,l);this.lk(d,this.D(d)+this.La(l));this.wm(d,this.aa(d)+1);this.Rx(l,d)}};b.prototype.Kj=function(d,a){this.xb.Ae(this.Za(a),this.an());
this.Wj(d,-1,this.an())};b.prototype.ud=function(d,b){var h=this.ld(d),l=this.Ra(d),c=this.U(d);-1!=l&&this.Kc(l,c);var e=this.La(h);d==this.cb(h)&&this.jg(h,1<e?c:-1);-1!=c&&this.Lc(c,l);d==this.Rj(h)&&this.sh(h,1<e?l:-1);if(-1!=l&&-1!=c){var l=this.Za(l),f=this.Za(c);b?(b=this.ti(l),null!=b&&(l=new a.b,this.xb.w(f,l),b.Zc(l))):(f=this.Za(d),b=this.ti(f),this.th(l,b),null!=b&&(l=this.xb.Ba(l),b.Mc(l)))}this.nk(h,e-1);h=this.ng(h);this.lk(h,this.D(h)-1);this.Dz(d);return c};b.prototype.cb=function(d){return this.td.S(d,
4)};b.prototype.Rj=function(d){return this.td.S(d,5)};b.prototype.U=function(d){return this.Dd.S(d,2)};b.prototype.Ra=function(d){return this.Dd.S(d,1)};b.prototype.ld=function(d){return this.Dd.S(d,3)};b.prototype.pc=function(d,a){return this.Wj(d,-1,a)};b.prototype.Qr=function(d){if(void 0===d)return this.Qr(!1);if(d instanceof c)return new c(d);var b,l=-1,e=-1,f=-1,g=0,k=!1;for(b=this.sd;-1!=b;b=this.Ue(b))if(!d||a.T.Ic(this.hc(b))){for(l=this.Pb(b);-1!=l;l=this.Sb(l))if(f=e=this.cb(l),g=0,-1!=
e){k=!0;break}if(k)break}return c.xR(this,b,l,e,f,g,d)};b.prototype.Xc=function(d){this.nm.Xc(d);if(null!=this.wf)for(var a=0,b=this.wf.length;a<b;a++)null!=this.wf[a]&&this.wf[a].Xc(d)};b.prototype.bs=function(d,a,b,l){l?this.GY(d,a,b):this.FY(d,a,b)};b.prototype.Lc=function(d,a){this.Dd.P(d,1,a)};b.prototype.Kc=function(d,a){this.Dd.P(d,2,a)};b.prototype.Aj=function(d,a){this.Dd.P(d,3,a)};b.prototype.nk=function(d,a){this.td.P(d,3,a)};b.prototype.jg=function(d,a){this.td.P(d,4,a)};b.prototype.sh=
function(d,a){this.td.P(d,5,a)};b.prototype.wm=function(d,a){this.md.P(d,6,a)};b.prototype.lk=function(d,a){this.md.P(d,5,a)};b.prototype.fK=function(d){var a=d;do{var b=this.U(a);this.Kc(a,this.Ra(a));this.Lc(a,b);a=b}while(a!=d)};b.prototype.zC=function(d){this.vd=d};b.prototype.Sr=function(d){var a=this.ct(d),b=this.Sb(d),l=this.ng(d);-1!=a?this.Kp(a,b):this.Ip(l,b);-1!=b?this.Lp(b,a):this.Jp(l,a);this.jg(d,-1);this.sh(d,-1);this.DG(d)};b.prototype.Mi=function(d,b){var h=this.Ra(d),l=this.U(d);
-1!=h&&this.Kc(h,l);-1!=l&&this.Lc(l,h);if(-1!=h&&-1!=l)if(h=this.Za(h),l=this.Za(l),b){if(b=this.ti(h),null!=b){var c=new a.b;this.xb.w(l,c);b.Zc(c)}}else l=this.Za(d),b=this.ti(l),this.th(h,b),null!=b&&(c=new a.b,this.xb.w(h,c),b.Mc(c));this.Dz(d)};b.prototype.XU=function(d){return 0!=(this.Lq(d)&4)};b.prototype.Np=function(d,a){this.tC(d,(this.Lq(d)|4)-4|(a?4:0))};b.prototype.Xx=function(d,a){var b=this.Dd.f;this.xb.wc();var h=this.xb.ya[0].f;d.Gd(0,a,function(d,a){d=b[5*d];a=b[5*a];var l=h[2*
d];d=h[2*d+1];var c=h[2*a];a=h[2*a+1];return d<a?-1:d>a?1:l<c?-1:l>c?1:0})};b.prototype.dU=function(){for(var d=this.sd;-1!=d;d=this.Ue(d))if(!a.T.Ic(this.hc(d)))return!0;return!1};b.prototype.EC=function(d,a){for(var b=this.Pb(d),h=this.Pb(a),l=this.Xv(d),c=this.Xv(a),e=this.Pb(d);-1!=e;e=this.Sb(e))this.Rx(e,a);for(e=this.Pb(a);-1!=e;e=this.Sb(e))this.Rx(e,d);this.Ip(d,h);this.Ip(a,b);this.Jp(d,c);this.Jp(a,l);b=this.D(d);h=this.aa(d);l=this.aa(a);this.lk(d,this.D(a));this.lk(a,b);this.wm(d,l);
this.wm(a,h);b=this.md.S(d,2);this.md.P(d,2,this.md.S(a,2));this.md.P(a,2,b)};return b}();a.fd=b})(D||(D={}));(function(a){var b=function(b){function l(d,h,l,c){b.call(this);this.R=new a.h;void 0===d?this.$F():"number"===typeof d?this.YQ(d,h,l,c):d instanceof a.Wa?void 0!==h?this.Ev(d,h,l):this.ZQ(d):d instanceof a.ma?void 0!==h?this.aR(d,h):this.$Q(d):d instanceof a.h?this.XQ(d):this.$F()}F(l,b);l.prototype.Ev=function(d,b,l){this.description=a.ye.Ig();this.R.Oa();d.u()||this.cv(d,b,l)};l.prototype.XQ=
function(d){this.description=a.ye.Ig();this.R.I(d);this.R.normalize()};l.prototype.$Q=function(d){if(null==d)throw a.g.F();this.description=d;this.R.Oa()};l.prototype.aR=function(d,b){if(null==d)throw a.g.F();this.description=d;this.R.I(b);this.R.normalize()};l.prototype.$F=function(){this.description=a.ye.Ig();this.R.Oa()};l.prototype.ZQ=function(d){this.description=a.ye.Ig();this.R.Oa();d.u()||this.cv(d)};l.prototype.YQ=function(d,b,l,c){this.description=a.ye.Ig();this.I(d,b,l,c)};l.prototype.I=
function(a,b,l,c){this.Bc();if("number"===typeof a)this.R.I(a,b,l,c);else for(this.Oa(),b=0,l=a.length;b<l;b++)this.Nb(a[b])};l.prototype.Gp=function(d){this.Bc();if(!d.ZU())throw a.g.F();this.R.I(d)};l.prototype.Oa=function(){this.Bc();this.R.Oa()};l.prototype.u=function(){return this.R.u()};l.prototype.N=function(){return this.R.N()};l.prototype.fa=function(){return this.R.fa()};l.prototype.Hk=function(){return this.R.Hk()};l.prototype.Cq=function(){return this.R.Cq()};l.prototype.Bq=function(){return this.R.Wf()};
l.prototype.Nb=function(d){if(d instanceof a.b)this.Bc(),this.R.Nb(d);else if(d instanceof a.h)this.Bc(),this.R.Nb(d);else if(d instanceof a.Wa){if(this.Bc(),!d.Hc()){var b=d.description;this.description!=b&&this.om(b);if(this.u())this.cv(d);else{this.R.Nb(d.w());for(var c=1,e=b.Ga;c<e;c++)for(var f=b.Td(c),g=a.ma.Xa(f),k=0;k<g;k++){var m=d.Yc(f,k),q=this.xf(f,k);q.Nb(m);setInterval(f,k,q)}}}}else if(d instanceof l&&!d.u())for(b=d.description,b!=this.description&&this.om(b),this.R.Nb(d.R),c=1,e=b.Ga;c<
e;c++)for(f=b.rd(c),g=a.ma.Xa(f),k=0;k<g;k++)m=d.xf(f,k),q=this.xf(f,k),q.Nb(m),setInterval(f,k,q)};l.prototype.cv=function(d,b,l){if(void 0!==b){this.R.I(d.w(),b,l);b=d.description;l=1;for(var h=b.Ga;l<h;l++)for(var c=b.Td(l),e=a.ma.Xa(c),f=0;f<e;f++){var r=d.Yc(c,f);this.setInterval(c,f,r,r)}}else for(this.R.I(d.la[0],d.la[1]),b=d.description,l=1,h=b.Ga;l<h;l++)for(c=b.Td(l),e=a.ma.Xa(c),f=0;f<e;f++)r=d.Yc(c,f),this.setInterval(c,f,r,r)};l.prototype.setInterval=function(d,b,l,c){var h=null;"number"===
typeof l?h=new a.Ac(l,c):h=l;this.Bc();if(0==d)if(0==b)this.R.o=h.ca,this.R.v=h.ha;else if(1==b)this.R.A=h.ca,this.R.B=h.ha;else throw a.g.wd();else this.LE(0,d,b,h.ca),this.LE(1,d,b,h.ha)};l.prototype.O=function(a,b){this.Bc();this.R.O(a,b)};l.prototype.Xc=function(d){if(d instanceof a.Hd)this.Bc(),d.KC(this.R);else if(this.Bc(),!this.R.u()){var b=new a.dM;this.Cp(b);b.QU()?b.Oa():d.KC(b)}};l.prototype.copyTo=function(d){if(d.G()!=this.G())throw a.g.F();d.Bc();d.description=this.description;d.R.I(this.R);
d.la=null;if(null!=this.la){d.Yu();for(var b=0;b<2*(this.description.af.length-2);b++)d.la[b]=this.la[b]}};l.prototype.Ka=function(){return new l(this.description)};l.prototype.hf=function(){return this.R.IG()};l.prototype.Rb=function(){return this.R.ZG()};l.prototype.G=function(){return 197};l.prototype.tb=function(){return 2};l.prototype.Qn=function(a){this.copyTo(a)};l.prototype.s=function(a){a.o=this.R.o;a.A=this.R.A;a.v=this.R.v;a.B=this.R.B};l.prototype.Cp=function(a){a.o=this.R.o;a.A=this.R.A;
a.v=this.R.v;a.B=this.R.B;a.I(this.R.o,this.R.A,this.ae(0,1,0),this.R.v,this.R.B,this.ae(1,1,0))};l.prototype.xf=function(d,b){var h=new a.Ac;h.I(this.ae(0,d,b),this.ae(1,d,b));return h};l.prototype.ig=function(d,b){b.Fg(this.description);var h=this.description.Ga-1;switch(d){case 0:for(d=0;d<h;d++)for(var l=this.description.rd(d),c=a.ma.Xa(l),e=0;e<c;e++)b.setAttribute(l,e,this.ae(0,l,e));b.rb(this.R.o,this.R.A);break;case 1:for(d=0;d<h;d++)for(l=this.description.rd(d),c=a.ma.Xa(l),e=0;e<c;e++)b.setAttribute(l,
e,this.ae(1,l,e));b.rb(this.R.o,this.R.B);break;case 2:for(d=0;d<h;d++)for(l=this.description.rd(d),c=a.ma.Xa(l),e=0;e<c;e++)b.setAttribute(l,e,this.ae(0,l,e));b.rb(this.R.v,this.R.B);break;case 3:for(d=0;d<h;d++)for(l=this.description.rd(d),c=a.ma.Xa(l),e=0;e<c;e++)b.setAttribute(l,e,this.ae(1,l,e));b.rb(this.R.v,this.R.A);break;default:throw a.g.wd();}};l.prototype.Gx=function(a,b){a=this.R.Gx(a);b.ka(a.x,a.y)};l.prototype.bT=function(a,b){return b*(a.Er-2)};l.prototype.JG=function(d,b,l){if(this.R.u())throw a.g.X("empty geometry");
if(0==b)return 0!=d?0!=l?this.R.B:this.R.v:0!=l?this.R.A:this.R.o;if(l>=a.ma.Xa(b))throw a.g.F();var h=this.description.mg(b);this.Yu();return 0<=h?this.la[this.bT(this.description,d)+this.description.ET(h)-2+l]:a.ma.de(b)};l.prototype.Yu=function(){this.Bc();if(null==this.la&&2<this.description.af.length){this.la=[];for(var d=l.$(this.description,0),b=l.$(this.description,1),c=0,e=1,f=this.description.Ga;e<f;e++)for(var g=this.description.rd(e),k=a.ma.Xa(g),g=a.ma.de(g),m=0;m<k;m++)this.la[d+c]=
g,this.la[b+c]=g,c++}};l.prototype.mo=function(d){if(null!=this.la)if(2<d.af.length){for(var b=a.ye.vx(d,this.description),c=[],e=l.$(this.description,0),f=l.$(this.description,1),g=l.$(d,0),k=l.$(d,1),m=0,q=1,n=d.Ga;q<n;q++){var w=d.rd(q),A=a.ma.Xa(w);if(-1==b[q])for(var x=a.ma.de(w),w=0;w<A;w++)c[g+m]=x,c[k+m]=x,m++;else for(x=this.description.xk(b[q])-2,w=0;w<A;w++)c[g+m]=this.la[e+x],c[k+m]=this.la[f+x],m++,x++}this.la=c}else this.la=null;this.description=d};l.prototype.ae=function(d,b,c){if(this.R.u())throw a.g.X("This operation was performed on an Empty Geometry.");
if(0==b)return 0!=d?0!=c?this.R.B:this.R.v:0!=c?this.R.A:this.R.o;if(c>=a.ma.Xa(b))throw a.g.wd();var h=this.description.mg(b);return 0<=h?(this.Yu(),this.la[l.$(this.description,d)+this.description.xk(h)-2+c]):a.ma.de(b)};l.prototype.LE=function(d,b,c,e){this.Bc();if(0==b)0!=d?0!=c?this.R.B=e:this.R.v=e:0!=c?this.R.A=e:this.R.o=e;else{if(c>=a.ma.Xa(b))throw a.g.wd();if(!this.hasAttribute(b)){if(a.ma.PH(b,e))return;this.Ud(b)}b=this.description.mg(b);this.Yu();this.la[l.$(this.description,d)+this.description.xk(b)-
2+c]=e}};l.$=function(a,b){return b*(a.af.length-2)};l.prototype.Ma=function(d){this.Bc();var b=new a.h;d.s(b);return this.R.Ma(b)};l.prototype.Yb=function(d){return d instanceof a.h?this.R.Yb(d):this.R.Yb(d.R)};l.prototype.xv=function(a,b,l){this.Bc();a.u()?this.Oa():void 0!==b?this.cv(a,b,l):this.R.xv(a.Be(),a.nf())};l.prototype.offset=function(a,b){this.Bc();this.R.offset(a,b)};l.prototype.normalize=function(){this.Bc();this.R.normalize()};l.prototype.Wf=function(d){if(void 0!==d)if(d.Fg(this.description),
this.u())d.Oa();else{for(var b=this.description.Ga,l=1;l<b;l++)for(var c=this.description.rd(l),e=a.ma.Xa(c),f=0;f<e;f++){var g=.5*(this.JG(0,c,f)+this.JG(1,c,f));d.setAttribute(c,f,g)}d.rb(this.R.Wf())}else{d=new a.Wa(this.description);if(this.u())return d;b=this.description.Ga;for(l=1;l<b;l++)for(c=this.description.Td(l),e=a.ma.Xa(c),f=0;f<e;f++)g=.5*(this.ae(0,c,f)+this.ae(1,c,f)),d.setAttribute(c,f,g);d.rb(this.R.Hk(),this.R.Cq());return d}};l.prototype.Yz=function(){return new a.Wa(this.R.Yz())};
l.prototype.contains=function(d){return d instanceof a.Wa?d.u()?!1:this.R.contains(d.Be(),d.nf()):this.R.contains(d.R)};l.prototype.gR=function(a){return this.R.contains(a)};l.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof l)||this.description!=a.description)return!1;if(this.u())return a.u()?!0:!1;if(!this.R.Eb(a.R))return!1;for(var d=0,b=2*(this.description.af.length-2);d<b;d++)if(this.la[d]!=a.la[d])return!1;return!0};l.prototype.jc=function(){var d=this.description.jc(),d=a.J.dh(d,
this.R.jc());if(!this.u()&&null!=this.la)for(var b=0,l=2*(this.description.af.length-2);b<l;b++)d=a.J.dh(d,this.la[b]);return d};l.prototype.Gg=function(){return a.Pi.Rm(this,null)};l.prototype.toString=function(){return this.u()?"Envelope: []":"Envelope: ["+this.R.o+", "+this.R.A+", "+this.R.v+", "+this.R.B+"]"};return l}(a.T);a.ci=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b,c){void 0===a?this.Oa():(this.o=a,this.A=d,this.v=b,this.B=c)}b.pa=function(a,d,h,c){var l=new b;l.o=a;l.A=
d;l.v=h;l.B=c;return l};b.prototype.I=function(l,d,h,c){"number"===typeof l?void 0!==h?(this.o=l,this.A=d,this.v=h,this.B=c,this.normalize()):(this.o=l,this.A=d,this.v=l,this.B=d):l instanceof a.b?void 0!==d?(this.o=l.x-.5*d,this.v=this.o+d,this.A=l.y-.5*h,this.B=this.A+h,this.normalize()):(this.o=l.x,this.A=l.y,this.v=l.x,this.B=l.y):l instanceof b?this.I(l.o,l.A,l.v,l.B):l instanceof a.Ac&&(l.u()||d.u()?this.Oa():(this.o=l.ca,this.v=l.ha,this.A=d.ca,this.B=d.ha))};b.prototype.nT=function(a,d){var h=
new b;h.I(this.o,this.A,this.v,this.B);h.O(a,d);return h};b.prototype.Mx=function(a,d){if(void 0!==d)if(0==d)this.Oa();else{this.o=a[0].x;this.A=a[0].y;this.v=this.o;this.B=this.A;for(var b=1;b<d;b++){var l=a[b];l.x<this.o?this.o=l.x:l.x>this.v&&(this.v=l.x);l.y<this.A?this.A=l.y:l.y>this.B&&(this.B=l.y)}}else if(null==a||0==a.length)this.Oa();else for(l=a[0],this.I(l.x,l.y),b=1;b<a.length;b++)l=a[b],this.ml(l.x,l.y)};b.prototype.Oa=function(){this.B=this.v=this.A=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};
b.prototype.Nb=function(l,d){"number"===typeof l?this.u()?(this.o=l,this.A=d,this.v=l,this.B=d):(this.o>l?this.o=l:this.v<l&&(this.v=l),this.A>d?this.A=d:this.B<d&&(this.B=d)):l instanceof a.b?this.Nb(l.x,l.y):l instanceof a.qd?this.Nb(l.x,l.y):l instanceof b&&!l.u()&&(this.Nb(l.o,l.A),this.Nb(l.v,l.B))};b.prototype.ml=function(a,d){this.o>a?this.o=a:this.v<a&&(this.v=a);this.A>d?this.A=d:this.B<d&&(this.B=d)};b.prototype.O=function(a,d){this.u()||(this.o-=a,this.v+=a,this.A-=d,this.B+=d,(this.o>
this.v||this.A>this.B)&&this.Oa())};b.prototype.scale=function(a){0>a&&this.Oa();this.u()||(this.o*=a,this.v*=a,this.A*=a,this.B*=a)};b.prototype.Yb=function(a){return!this.u()&&!a.u()&&(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.TH=function(a){return(this.o<=a.o?this.v>=a.o:a.v>=this.o)&&(this.A<=a.A?this.B>=a.A:a.B>=this.A)};b.prototype.Ma=function(a){if(this.u()||a.u())return!1;a.o>this.o&&(this.o=a.o);a.v<this.v&&(this.v=a.v);a.A>this.A&&(this.A=a.A);
a.B<this.B&&(this.B=a.B);(a=this.o<=this.v&&this.A<=this.B)||this.Oa();return a};b.prototype.Gx=function(b){switch(b){case 0:return a.b.pa(this.o,this.A);case 1:return a.b.pa(this.o,this.B);case 2:return a.b.pa(this.v,this.B);case 3:return a.b.pa(this.v,this.A);default:throw a.g.wd();}};b.prototype.PB=function(b){if(null==b||4>b.length)throw a.g.F();null!=b[0]?b[0].ka(this.o,this.A):b[0]=a.b.pa(this.o,this.A);null!=b[1]?b[1].ka(this.o,this.B):b[1]=a.b.pa(this.o,this.B);null!=b[2]?b[2].ka(this.v,this.B):
b[2]=a.b.pa(this.v,this.B);null!=b[3]?b[3].ka(this.v,this.A):b[3]=a.b.pa(this.v,this.A)};b.prototype.IG=function(){return this.u()?0:this.N()*this.fa()};b.prototype.ZG=function(){return this.u()?0:2*(this.N()+this.fa())};b.prototype.Hk=function(){return(this.v+this.o)/2};b.prototype.Cq=function(){return(this.B+this.A)/2};b.prototype.N=function(){return this.v-this.o};b.prototype.fa=function(){return this.B-this.A};b.prototype.move=function(a,d){this.u()||(this.o+=a,this.A+=d,this.v+=a,this.B+=d)};
b.prototype.xv=function(b,d){if(void 0!==d)this.move(b-this.Hk(),d-this.Cq());else if(b instanceof a.b)this.xv(b.x,b.y);else if(b instanceof a.Wa){d=(this.v-this.o)/2;var h=(this.B-this.A)/2;this.o=b.Be()-d;this.v=b.Be()+d;this.A=b.nf()-h;this.B=b.nf()+h}else throw a.g.F();};b.prototype.offset=function(a,d){this.o+=a;this.v+=a;this.A+=d;this.B+=d};b.prototype.normalize=function(){if(!this.u()){var a=Math.min(this.o,this.v),d=Math.max(this.o,this.v);this.o=a;this.v=d;a=Math.min(this.A,this.B);d=Math.max(this.A,
this.B);this.A=a;this.B=d}};b.prototype.Tn=function(a){a.ka(this.o,this.A)};b.prototype.TJ=function(a){a.ka(this.v,this.A)};b.prototype.WJ=function(a){a.ka(this.o,this.B)};b.prototype.Un=function(a){a.ka(this.v,this.B)};b.prototype.ZU=function(){return this.u()||this.o<=this.v&&this.A<=this.B};b.prototype.Wf=function(){return a.b.pa((this.v+this.o)/2,(this.B+this.A)/2)};b.prototype.Yz=function(){return a.b.pa(this.o,this.A)};b.prototype.contains=function(l,d){if(void 0!==d)return l>=this.o&&l<=this.v&&
d>=this.A&&d<=this.B;if(l instanceof a.Wa)return this.contains(l.Be(),l.nf());if(l instanceof a.b)return this.contains(l.x,l.y);if(l instanceof b)return l.o>=this.o&&l.v<=this.v&&l.A>=this.A&&l.B<=this.B;throw a.g.F();};b.prototype.Tm=function(l,d){if(void 0!==d)return l>this.o&&l<this.v&&d>this.A&&d<this.B;if(l instanceof a.b)return this.Tm(l.x,l.y);if(l instanceof b)return l.o>this.o&&l.v<this.v&&l.A>this.A&&l.B<this.B;throw a.g.F();};b.prototype.Eb=function(a){return a==this?!0:a instanceof b?
this.u()&&a.u()?!0:this.o!=a.o||this.A!=a.A||this.v!=a.v||this.B!=a.B?!1:!0:!1};b.prototype.jc=function(){var b=this.o,b=a.J.truncate(b^b>>>32),d=a.J.dh(b),b=this.v,b=a.J.truncate(b^b>>>32),d=a.J.dh(b,d),b=this.A,b=a.J.truncate(b^b>>>32),d=a.J.dh(b,d),b=this.B,b=a.J.truncate(b^b>>>32);return d=a.J.dh(b,d)};b.prototype.Ny=function(b){var d=new a.b;d.L(b);if(d.Hy())return d;if(this.u())return d.dv(),d;d.x<this.o?d.x=this.o:d.x>this.v&&(d.x=this.v);d.y<this.A?d.y=this.A:d.y>this.B&&(d.y=this.B);if(!d.Eb(b))return d;
b=this.Wf();(d.x<b.x?d.x-this.o:this.v-d.x)<(d.y<b.y?d.y-this.A:this.B-d.y)?d.x=d.x<b.x?this.o:this.v:d.y=d.y<b.y?this.A:this.B;return d};b.prototype.Wu=function(a){if(this.u())return NaN;if(a.x==this.o)return a.y-this.A;var d=this.B-this.A,b=this.v-this.o;return a.y==this.B?d+a.x-this.o:a.x==this.v?d+b+this.B-a.y:a.y==this.A?2*d+b+this.v-a.x:this.Wu(this.Ny(a))};b.prototype.zE=function(a){if(this.u())return-1;a=this.Wu(a);var d=this.B-this.A,b=this.v-this.o;return a<d?0:(a-=d)<b?1:a-b<d?2:3};b.prototype.no=
function(){return this.u()?2.220446049250313E-14:2.220446049250313E-14*(Math.abs(this.o)+Math.abs(this.v)+Math.abs(this.A)+Math.abs(this.B)+1)};b.prototype.gz=function(a,d){var h=this.wk(a),l=this.wk(d);if(0!=(h&l))return 0;if(0==(h|l))return 4;var c=(0!=h?1:0)|(0!=l?2:0);do{var e=d.x-a.x,f=d.y-a.y;e>f?0!=(h&b.bd)?(0!=(h&b.Bb)?(a.y+=f*(this.o-a.x)/e,a.x=this.o):(a.y+=f*(this.v-a.x)/e,a.x=this.v),h=this.wk(a)):0!=(l&b.bd)?(0!=(l&b.Bb)?(d.y+=f*(this.o-d.x)/e,d.x=this.o):(d.y+=f*(this.v-d.x)/e,d.x=this.v),
l=this.wk(d)):0!=h?(0!=(h&b.tc)?(a.x+=e*(this.A-a.y)/f,a.y=this.A):(a.x+=e*(this.B-a.y)/f,a.y=this.B),h=this.wk(a)):(0!=(l&b.tc)?(d.x+=e*(this.A-d.y)/f,d.y=this.A):(d.x+=e*(this.B-d.y)/f,d.y=this.B),l=this.wk(d)):0!=(h&b.fe)?(0!=(h&b.tc)?(a.x+=e*(this.A-a.y)/f,a.y=this.A):(a.x+=e*(this.B-a.y)/f,a.y=this.B),h=this.wk(a)):0!=(l&b.fe)?(0!=(l&b.tc)?(d.x+=e*(this.A-d.y)/f,d.y=this.A):(d.x+=e*(this.B-d.y)/f,d.y=this.B),l=this.wk(d)):0!=h?(0!=(h&b.Bb)?(a.y+=f*(this.o-a.x)/e,a.x=this.o):(a.y+=f*(this.v-a.x)/
e,a.x=this.v),h=this.wk(a)):(0!=(l&b.Bb)?(d.y+=f*(this.o-d.x)/e,d.x=this.o):(d.y+=f*(this.v-d.x)/e,d.x=this.v),l=this.wk(d));if(0!=(h&l))return 0}while(0!=(h|l));return c};b.prototype.wk=function(a){return(a.x<this.o?1:0)|(a.x>this.v?1:0)<<1|(a.y<this.A?1:0)<<2|(a.y>this.B?1:0)<<3};b.prototype.fh=function(a){return!this.u()&&(this.N()<=a||this.fa()<=a)};b.prototype.Cb=function(b){return b instanceof a.b?Math.sqrt(this.ZK(b)):Math.sqrt(this.Zx(b))};b.prototype.Zx=function(a){var d=0,b=0,l;l=this.o-
a.v;l>d&&(d=l);l=this.A-a.B;l>b&&(b=l);l=a.o-this.v;l>d&&(d=l);l=a.A-this.B;l>b&&(b=l);return d*d+b*b};b.prototype.ZK=function(a){var d=0,b=0,l;l=this.o-a.x;l>d&&(d=l);l=this.A-a.y;l>b&&(b=l);l=a.x-this.v;l>d&&(d=l);l=a.y-this.B;l>b&&(b=l);return d*d+b*b};b.prototype.Sn=function(a){this.u()?a.Oa():a.I(this.o,this.v)};b.CO=function(a,d,b,c){var h=1;isNaN(a)||(h+=Math.abs(a));isNaN(d)||(h+=Math.abs(d));isNaN(b)||(h+=Math.abs(b));isNaN(c)||(h+=Math.abs(c));return 2.220446049250313E-14*h};b.Bb=1;b.tc=
4;b.bd=3;b.fe=12;return b}();a.h=b})(D||(D={}));(function(a){var b;(function(a){a[a.initialize=0]="initialize";a[a.initializeRed=1]="initializeRed";a[a.initializeBlue=2]="initializeBlue";a[a.initializeRedBlue=3]="initializeRedBlue";a[a.sweep=4]="sweep";a[a.sweepBruteForce=5]="sweepBruteForce";a[a.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce";a[a.sweepRedBlue=7]="sweepRedBlue";a[a.sweepRed=8]="sweepRed";a[a.sweepBlue=9]="sweepBlue";a[a.iterate=10]="iterate";a[a.iterateRed=11]="iterateRed";a[a.iterateBlue=
12]="iterateBlue";a[a.iterateBruteForce=13]="iterateBruteForce";a[a.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce";a[a.resetRed=15]="resetRed";a[a.resetBlue=16]="resetBlue"})(b||(b={}));var c=function(){function a(a,b){this.Ci=a;this.pI=b}a.prototype.hs=function(a,b,l){this.Ci.DY(l,a,b,this.pI)};a.prototype.Qq=function(a){return this.Ci.Ms(a,this.pI)};return a}();b=function(){function b(){this.ax=this.bp=this.If=this.Bd=null;this.lr=new a.h;this.on=this.ck=this.dk=this.Qd=this.fg=this.Yd=
this.Qw=this.Uo=this.Ad=this.Lb=null;this.Zb=-1;this.ta=0;this.ql()}b.prototype.cs=function(){this.ql();this.Bw=!0;null==this.Lb?(this.Uo=new a.ia(0),this.Lb=[]):(this.Uo.yf(0),this.Lb.length=0)};b.prototype.jd=function(d,b){if(!this.Bw)throw a.g.Da();var h=new a.h;h.I(b);this.Uo.add(d);this.Lb.push(h)};b.prototype.yq=function(){if(!this.Bw)throw a.g.Da();this.Bw=!1;null!=this.Lb&&0<this.Lb.length&&(this.Zb=0,this.Pc=!1)};b.prototype.bL=function(){this.ql();this.Aw=!0;null==this.Lb?(this.Uo=new a.ia(0),
this.Lb=[]):(this.Uo.yf(0),this.Lb.length=0)};b.prototype.ZE=function(d,b){if(!this.Aw)throw a.g.Da();var h=new a.h;h.I(b);this.Uo.add(d);this.Lb.push(h)};b.prototype.tG=function(){if(!this.Aw)throw a.g.Da();this.Aw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:2==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=1),this.Pc=!1)};b.prototype.aL=function(){this.ql();this.zw=!0;null==this.Ad?(this.Qw=new a.ia(0),this.Ad=[]):(this.Qw.yf(0),this.Ad.length=0)};b.prototype.VE=
function(d,b){if(!this.zw)throw a.g.Da();var h=new a.h;h.I(b);this.Qw.add(d);this.Ad.push(h)};b.prototype.sG=function(){if(!this.zw)throw a.g.Da();this.zw=!1;null!=this.Lb&&0<this.Lb.length&&null!=this.Ad&&0<this.Ad.length&&(-1==this.Zb?this.Zb=3:1==this.Zb?this.Zb=3:3!=this.Zb&&(this.Zb=2),this.Pc=!1)};b.prototype.next=function(){if(this.Pc)return!1;for(var d=!0;d;)switch(this.Zb){case 0:d=this.qA();break;case 1:d=this.mU();break;case 2:d=this.jU();break;case 3:d=this.lU();break;case 4:d=this.NY();
break;case 5:d=this.JY();break;case 6:d=this.KY();break;case 7:d=this.LY();break;case 8:d=this.by();break;case 9:d=this.FC();break;case 10:d=this.CA();break;case 11:d=this.cV();break;case 12:d=this.$U();break;case 13:d=this.aV();break;case 14:d=this.bV();break;case 15:d=this.$J();break;case 16:d=this.ZJ();break;default:throw a.g.za();}return this.Pc?!1:!0};b.prototype.yC=function(a){this.ta=a};b.prototype.eA=function(a){return this.Lb[a]};b.prototype.Iz=function(a){return this.Ad[a]};b.prototype.Ql=
function(a){return this.Uo.read(a)};b.prototype.Ml=function(a){return this.Qw.read(a)};b.JB=function(a){return 1==(a&1)};b.Gm=function(a){return 0==(a&1)};b.prototype.ql=function(){this.Bw=this.zw=this.Aw=!1;this.dg=this.eg=this.nh=this.Ne=-1;this.Pc=!0};b.prototype.qA=function(){this.bg=this.sg=-1;if(10>this.Lb.length)return this.Ne=this.Lb.length,this.Zb=5,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));this.Bd.cs();for(var d=0;d<this.Lb.length;d++){var b=this.Lb[d];
this.Bd.zs(b.o,b.v)}this.Bd.yq();this.Yd.yb(2*this.Lb.length);this.Yd.resize(0);for(d=0;d<2*this.Lb.length;d++)this.Yd.add(d);this.yu(this.Yd,2*this.Lb.length,!0);this.Ne=2*this.Lb.length;this.Zb=4;return!0};b.prototype.mU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));this.Bd.cs();for(var d=0;d<this.Lb.length;d++){var b=this.Lb[d];this.Bd.zs(b.o,b.v)}this.Bd.yq();
this.Yd.yb(2*this.Lb.length);this.Yd.resize(0);for(d=0;d<2*this.Lb.length;d++)this.Yd.add(d);this.yu(this.Yd,this.Yd.size,!0);this.Ne=this.Yd.size;-1!=this.eg&&(this.Qd.zh(this.eg),this.dk.resize(0),this.eg=-1);this.Zb=7;return this.ZJ()};b.prototype.jU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.If&&(this.If=new a.ns(!0),this.ax=this.If.mf(),this.fg=new a.ia(0));this.If.cs();for(var d=0;d<this.Ad.length;d++){var b=this.Ad[d];
this.If.zs(b.o,b.v)}this.If.yq();this.fg.yb(2*this.Ad.length);this.fg.resize(0);for(d=0;d<2*this.Ad.length;d++)this.fg.add(d);this.yu(this.fg,this.fg.size,!1);this.nh=this.fg.size;-1!=this.dg&&(this.Qd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Zb=7;return this.$J()};b.prototype.lU=function(){this.bg=this.sg=-1;if(10>this.Lb.length||10>this.Ad.length)return this.Ne=this.Lb.length,this.Zb=6,!0;null==this.Bd&&(this.Bd=new a.ns(!0),this.bp=this.Bd.mf(),this.Yd=new a.ia(0));null==this.If&&(this.If=
new a.ns(!0),this.ax=this.If.mf(),this.fg=new a.ia(0));this.Bd.cs();for(var d=0;d<this.Lb.length;d++){var b=this.Lb[d];this.Bd.zs(b.o,b.v)}this.Bd.yq();this.If.cs();for(d=0;d<this.Ad.length;d++)b=this.Ad[d],this.If.zs(b.o,b.v);this.If.yq();this.Yd.yb(2*this.Lb.length);this.fg.yb(2*this.Ad.length);this.Yd.resize(0);this.fg.resize(0);for(d=0;d<2*this.Lb.length;d++)this.Yd.add(d);for(d=0;d<2*this.Ad.length;d++)this.fg.add(d);this.yu(this.Yd,this.Yd.size,!0);this.yu(this.fg,this.fg.size,!1);this.Ne=this.Yd.size;
this.nh=this.fg.size;-1!=this.eg&&(this.Qd.zh(this.eg),this.dk.resize(0),this.eg=-1);-1!=this.dg&&(this.Qd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Zb=7;return!0};b.prototype.NY=function(){var a=this.Yd.get(--this.Ne),h=a>>1;if(b.Gm(a))return this.Bd.remove(h),0==this.Ne?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;this.bp.dC(this.Lb[h].o,this.Lb[h].v,this.ta);this.sg=h;this.Zb=10;return!0};b.prototype.JY=function(){if(-1==--this.Ne)return this.bg=this.sg=-1,this.Pc=!0,!1;this.nh=this.sg=this.Ne;this.Zb=
13;return!0};b.prototype.KY=function(){if(-1==--this.Ne)return this.bg=this.sg=-1,this.Pc=!0,!1;this.sg=this.Ne;this.nh=this.Ad.length;this.Zb=14;return!0};b.prototype.LY=function(){var a=this.Yd.get(this.Ne-1),h=this.fg.get(this.nh-1),l=this.Ms(a,!0),c=this.Ms(h,!1);return l>c?this.by():l<c?this.FC():b.JB(a)?this.by():b.JB(h)?this.FC():this.by()};b.prototype.by=function(){var d=this.Yd.get(--this.Ne),h=d>>1;if(b.Gm(d))return-1!=this.eg&&-1!=this.dk.get(h)?(this.Qd.kd(this.eg,this.dk.get(h)),this.dk.set(h,
-1)):this.Bd.remove(h),0==this.Ne?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;if(-1!=this.dg&&0<this.Qd.at(this.dg))for(d=this.Qd.xc(this.dg);-1!=d;){var l=this.Qd.getData(d);this.If.eh(l);this.ck.set(l,-1);l=this.Qd.nb(d);this.Qd.kd(this.dg,d);d=l}0<this.If.size()?(this.ax.dC(this.Lb[h].o,this.Lb[h].v,this.ta),this.sg=h,this.Zb=12):(-1==this.eg&&(null==this.Qd&&(this.Qd=new a.Xp),this.dk=new a.ia(0),this.dk.resize(this.Lb.length,-1),this.dk.Zh(-1,0,this.Lb.length),this.eg=this.Qd.mi(1)),this.dk.set(h,
this.Qd.addElement(this.eg,h)),this.Zb=7);return!0};b.prototype.FC=function(){var d=this.fg.get(--this.nh),h=d>>1;if(b.Gm(d))return-1!=this.dg&&-1!=this.ck.get(h)?(this.Qd.kd(this.dg,this.ck.get(h)),this.ck.set(h,-1)):this.If.remove(h),0==this.nh?(this.bg=this.sg=-1,this.Pc=!0,!1):!0;if(-1!=this.eg&&0<this.Qd.at(this.eg))for(d=this.Qd.xc(this.eg);-1!=d;){var l=this.Qd.getData(d);this.Bd.eh(l);this.dk.set(l,-1);l=this.Qd.nb(d);this.Qd.kd(this.eg,d);d=l}0<this.Bd.size()?(this.bp.dC(this.Ad[h].o,this.Ad[h].v,
this.ta),this.bg=h,this.Zb=11):(-1==this.dg&&(null==this.Qd&&(this.Qd=new a.Xp),this.ck=new a.ia(0),this.ck.resize(this.Ad.length,-1),this.ck.Zh(-1,0,this.Ad.length),this.dg=this.Qd.mi(0)),this.ck.set(h,this.Qd.addElement(this.dg,h)),this.Zb=7);return!0};b.prototype.CA=function(){this.bg=this.bp.next();if(-1!=this.bg)return!1;var a=this.Yd.get(this.Ne)>>1;this.Bd.eh(a);this.Zb=4;return!0};b.prototype.cV=function(){this.sg=this.bp.next();if(-1!=this.sg)return!1;this.bg=this.sg=-1;var a=this.fg.get(this.nh)>>
1;this.If.eh(a);this.Zb=7;return!0};b.prototype.$U=function(){this.bg=this.ax.next();if(-1!=this.bg)return!1;var a=this.Yd.get(this.Ne)>>1;this.Bd.eh(a);this.Zb=7;return!0};b.prototype.aV=function(){if(-1==--this.nh)return this.Zb=5,!0;this.lr.I(this.Lb[this.Ne]);var a=this.Lb[this.nh];this.lr.O(this.ta,this.ta);return this.lr.Yb(a)?(this.bg=this.nh,!1):!0};b.prototype.bV=function(){if(-1==--this.nh)return this.Zb=6,!0;this.lr.I(this.Lb[this.Ne]);var a=this.Ad[this.nh];this.lr.O(this.ta,this.ta);
return this.lr.Yb(a)?(this.bg=this.nh,!1):!0};b.prototype.$J=function(){if(null==this.Bd)return this.Pc=!0,!1;this.Ne=this.Yd.size;0<this.Bd.size()&&this.Bd.reset();-1!=this.eg&&(this.Qd.zh(this.eg),this.dk.resize(0),this.eg=-1);this.Pc=!1;return!0};b.prototype.ZJ=function(){if(null==this.If)return this.Pc=!0,!1;this.nh=this.fg.size;0<this.If.size()&&this.If.reset();-1!=this.dg&&(this.Qd.zh(this.dg),this.ck.resize(0),this.dg=-1);this.Pc=!1;return!0};b.prototype.yu=function(d,b,l){null==this.on&&(this.on=
new a.Hu);l=new c(this,l);this.on.sort(d,0,b,l)};b.prototype.DY=function(a,h,l,c){var d=this;a.Gd(h,l,function(a,h){var l=d.Ms(a,c),e=d.Ms(h,c);return l<e||l==e&&b.Gm(a)&&b.JB(h)?-1:1})};b.prototype.Ms=function(a,h){var d=.5*this.ta;if(h)return h=this.Lb[a>>1],d=b.Gm(a)?h.A-d:h.B+d;h=this.Ad[a>>1];return d=b.Gm(a)?h.A-d:h.B+d};return b}();a.fD=b})(D||(D={}));(function(a){var b=function(){function b(){}b.pa=function(a,d,h,c,e,f){var l=new b;l.o=a;l.A=d;l.Bf=h;l.v=c;l.B=e;l.$g=f;return l};b.prototype.Oa=
function(){this.Bf=this.o=NaN};b.prototype.u=function(){return isNaN(this.o)};b.prototype.QU=function(){return isNaN(this.Bf)};b.prototype.I=function(a,d,b,c,e,f){void 0!==c?"number"===typeof a?(this.o=a,this.A=d,this.Bf=b,this.v=c,this.B=e,this.$g=f):(this.o=a.x-.5*d,this.v=this.o+d,this.A=a.y-.5*b,this.B=this.A+b,this.Bf=a.z-.5*c,this.$g=this.Bf+c):(this.o=a,this.A=d,this.Bf=b,this.v=a,this.B=d,this.$g=b)};b.prototype.move=function(a){this.o+=a.x;this.A+=a.y;this.Bf+=a.z;this.v+=a.x;this.B+=a.y;
this.$g+=a.z};b.prototype.copyTo=function(a){a.o=this.o;a.A=this.A;a.v=this.v;a.B=this.B};b.prototype.ml=function(a,d,b){this.o>a?this.o=a:this.v<a&&(this.v=a);this.A>d?this.A=d:this.B<d&&(this.B=d);0==isNaN(this.Bf)?this.Bf>b?this.Bf=b:this.$g<b&&(this.$g=b):this.$g=this.Bf=b};b.prototype.Nb=function(l,d,h,c,e,f){if("number"===typeof l)c?(this.Nb(l,d,h),this.Nb(c,e,f)):this.u()?(this.o=l,this.A=d,this.Bf=h,this.v=l,this.B=d,this.$g=h):this.ml(l,d,h);else if(l instanceof a.qd)this.Nb(l.x,l.y,l.z);
else if(l instanceof b)l.u()||(this.Nb(l.o,l.A,l.Bf),this.Nb(l.v,l.B,l.$g));else throw a.g.F();};b.prototype.pa=function(a,d,b){a.u()||d.u()?this.Oa():(this.o=a.ca,this.v=a.ha,this.A=d.ca,this.B=d.ha,this.Bf=b.ca,this.$g=b.ha)};b.prototype.PB=function(b){if(null==b||8>b.length)throw a.g.F();b[0]=new a.qd(this.o,this.A,this.Bf);b[1]=new a.qd(this.o,this.B,this.Bf);b[2]=new a.qd(this.v,this.B,this.Bf);b[3]=new a.qd(this.v,this.A,this.Bf);b[4]=new a.qd(this.o,this.A,this.$g);b[5]=new a.qd(this.o,this.B,
this.$g);b[6]=new a.qd(this.v,this.B,this.$g);b[7]=new a.qd(this.v,this.A,this.$g)};b.prototype.Mx=function(a){if(null==a||0==a.length)this.Oa();else{var d=a[0];this.I(d.x,d.y,d.z);for(d=1;d<a.length;d++){var b=a[d];this.ml(b.x,b.y,b.z)}}};return b}();a.dM=b})(D||(D={}));(function(a){(function(a){a.za=function(){var a=Error();a.message="Internal Error";return a};a.df=function(){var a=Error();a.message="Not Implemented";return a};a.vk=function(){var a=Error();a.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular";
return a};a.Da=function(){var a=Error();a.message="Invalid Call";return a};a.F=function(a){var b=Error();b.message="Illegal Argument Exception";void 0!==a&&(b.message+=": "+a);return b};a.TN=function(){var a=Error();a.message="Runtime Exception.";return a};a.X=function(a){var b=Error();b.message="Geometry Exception: "+a;return b};a.JL=function(){var a=Error();a.message="Assert Failed Exception";return a};a.wd=function(){var a=Error();a.message="IndexOutOfBoundsException";return a};a.n_=function(a){a.message=
"UserCancelException";return a}})(a.g||(a.g={}))})(D||(D={}));(function(a){a=a.Om||(a.Om={});a[a.forward=0]="forward";a[a.reverse=1]="reverse"})(D||(D={}));(function(a){var b=function(){function d(a,d){this.$a=a;this.VI=d;this.ZI=-1;this.Wl=!1}d.prototype.Re=function(){return!0};d.prototype.next=function(){if(++this.ZI==this.VI.D())return null;var d=this.VI.Ba(this.ZI);d.scale(this.$a.mc);var b=new a.Ja;this.$a.Yy(d,this.Wl,b);return b};d.prototype.Ia=function(){return 0};return d}(),c=function(){function d(d,
b,l){this.$a=d;this.ex=b;this.Mo=!1;this.So=l;this.Pw=[0];this.Uk=[0];this.gk=[0];this.Ct=[0];this.Wl=!1;this.fr=new a.Ja;this.Wk=[]}d.prototype.Re=function(){return!0};d.prototype.next=function(){if(this.Mo){this.Mo=!1;this.Cd.ba();var d=a.T.oe(this.fr);return d=a.Dg.ol(d,this.$a.pr,!0,!0,this.$a.lc)}null==this.Cd&&(this.Cd=this.ex.Fa(),this.Cd.Ya(),null!=this.So&&this.So.Bl(null,0));if(!this.Cd.Ea()){if(!this.Cd.Ya())return null;null!=this.So&&this.So.Bl(null,0)}d=null;this.Uk[0]=0;this.lB=this.Pw[0]=
0;this.Di=NaN;this.Mo=!1;for(var b=this.Wk.length=0,c=new a.b,e=new a.b,f=[0];this.Cd.Ea()&&8>this.lB;){var g=this.Cd.ba();c.L(g.ec());e.L(g.Cc());c.scale(this.$a.mc);e.scale(this.$a.mc);a.Ej.Bv(c,e)?c.x=e.x:a.Ej.zv(c,e)&&(e.x=c.x);this.Wk.length=0;a.Ej.GG(this.$a.Vb,this.$a.rc,this.$a.$e,c,e,this.$a.vB,this.$a.Tt,f,this.gk,this.Ct,this.Wk,this.Pw);null!=this.So&&(g=this.Wk.slice(0),this.So.EH(this.So.aa()-1,g,g.length-1));a.Ej.Av(c,e)?(this.fr.Oa(),this.$a.Yy(c,this.Wl,this.fr),this.Mo=!0):(this.fr.Oa(),
this.Mo=this.dz(f[0],this.fr));if(this.Mo){this.Cd.Li();if(this.Cd.oA()){this.Cd.Li();this.Cd.ba();break}this.Cd.zX();break}null==d&&(d=new a.Ja,d.Bl(null,0));this.dF(d);b++}this.Pw[0]=0;if(0<b){for(f=this.Cd.Db();0<b;)this.Cd.Li(),c.L(this.ex.Ba(this.Cd.Db())),e.L(this.ex.Ba(this.Cd.Jk())),c.scale(this.$a.mc),e.scale(this.$a.mc),this.Wl&&(a.Ej.Bv(c,e)?c.x=e.x:a.Ej.zv(c,e)&&(e.x=c.x)),this.Wk.length=0,a.Ej.GG(this.$a.Vb,this.$a.rc,this.$a.$e,e,c,this.$a.vB,this.$a.Tt,null,this.gk,this.Ct,this.Wk,
this.Pw),this.dF(d),b--;c.L(this.ex.Ba(this.Cd.Db()));c.scale(this.$a.mc);l.Fs(this.$a.Vb,this.$a.rc,this.$a.mc,this.$a.vb,c,this.Di+1.570796326794897,this.Di+4.71238898038469,this.$a.Qo,this.Wl,this.Uk,d,NaN,NaN);this.Cd.Tb(f);this.Cd.ba();b=a.na.ah(null,d,!0);return d=a.Dg.ol(d,b,!0,!0,this.$a.lc)}this.Mo=!1;this.Cd.ba();d=a.T.oe(this.fr);return d=a.Dg.ol(d,this.$a.pr,!0,!0,this.$a.lc)};d.prototype.dF=function(d){var b=this.Wk[0],h,c=this.gk[0]-1.570796326794897,e=this.Ct[0]+1.570796326794897,f;
if(!isNaN(this.Di)){this.Di>=this.gk[0]?(h=this.Di+1.570796326794897,c=h+3.141592653589793-(this.Di-this.gk[0])):(h=this.Di+1.570796326794897,c=h+3.141592653589793-(6.283185307179586-(this.gk[0]-this.Di)));f=this.Di>=this.gk[0]&&3.141592653589793>=this.Di-this.gk[0]?!1:this.Di<this.gk[0]&&3.141592653589793<=this.gk[0]-this.Di?!1:!0;var g=!1;if(Math.abs(c-h)<=.5*this.$a.Qo)if(f){var k=d.Ba(d.D()-2);k.scale(this.$a.mc);var m=new a.ea(0);a.mb.Fz(this.$a.Vb,this.$a.rc,b.x,b.y,k.x,k.y,m);for(k=m.j;k<=
h;)k+=6.283185307179586;for(;k>h;)k-=6.283185307179586;k<c&&(g=!0)}else g=!0;g?(d.cC(0,d.D()-1),this.Wl||(b=new a.b,b.L(d.Ba(d.D()-1)),b.scale(this.$a.mc),-3.141592653589793>b.x-this.Uk[0]?this.Uk[0]-=6.283185307179586:3.141592653589793<b.x-this.Uk[0]&&(this.Uk[0]+=6.283185307179586)),f||(c=.5*(c+h))):(f?(h=new a.b,h.L(b),h.scale(1/this.$a.mc),d.Zf(0,-1,h)):l.Fs(this.$a.Vb,this.$a.rc,this.$a.mc,this.$a.vb,this.Wk[0],h,c,this.$a.Qo,this.Wl,this.Uk,d,NaN,NaN),this.lB+=1)}l.Xy(this.$a.Vb,this.$a.rc,
this.$a.mc,this.$a.vb,this.$a.$e,this.Wk,c,e,this.Wl,this.Uk,d);this.Di=this.Ct[0]};d.prototype.dz=function(a,d){return this.$a.dz(this.Wk,a,this.gk[0],this.Ct[0],this.Wl,d)};d.prototype.Ia=function(){return 0};return d}(),l=function(){function d(){}d.buffer=function(b,l,c,e,f,g){if(null==b)throw a.g.F("Geometry::Geodesic_bufferer::buffer");if(b.u())return new a.Ja(b.description);var h=new d;h.mh=l;h.Qc=a.fb.kc(l);var r=a.fb.hw(h.Qc);h.lc=g;h.Vb=a.fb.Sv(h.Qc);h.rc=r*(2-r);h.mc=h.Qc.Nd().Ai;h.ta=h.mh.Bo();
h.pr=h.Qc.Bo();h.Tt=h.pr*h.mc;h.or=1.570796326794897/h.mc;h.E_=3.141592653589793/h.mc;h.Et=6.283185307179586/h.mc;h.F_=h.Et/6;h.qB=0;h.D_=1.5707963267948966*h.Vb/h.qB;4==c?(h.$e=2,h.Jw=!0):(h.$e=c,h.Jw=!1);h.Qa=e;h.vb=Math.abs(e);isNaN(f)||.001>f?h.sY():h.Po=f;c=b.G();a.T.Oc(c)?(c=new a.Ua(b.description),c.dc(b,!0),b=c,c=1607):197==c&&(c=new a.h,b.s(c),c.N()<=h.ta||c.fa()<=h.ta?(c=new a.Ua(b.description),c.jd(b,!1),b=c,c=1607):(c=new a.Ja(b.description),c.jd(b,!1),b=c,c=1736));h.tY();a.T.Jo(c)||h.uY();
if(h.vb<=.5*h.Po)return 1736!=c?new a.Ja(b.description):h.Jw?b:a.Ej.Ls(b,h.mh,h.$e,h.vB,-1,g);if(0>h.Qa&&1736!=c)return new a.Ja(b.description);h.Jw&&a.T.Ic(c)?(l=a.Ej.Ls(b,l,4,NaN,h.Po,g),b=a.fb.Xg(l,h.mh,h.Qc,g)):b=a.fb.Xg(b,h.mh,h.Qc,g);b=a.gi.Mj(b,h.Qc);if(b.u())return new a.Ja(b.description);!h.Jw&&a.T.Ic(c)&&(b=a.Ej.zJ(h.mc,b));b=d.mQ(b,h.Qc);switch(c){case 1736:g=h.XP(b);break;case 1607:g=h.YP(b);break;case 550:g=h.VP(b);break;case 33:g=h.WP(b);break;default:throw a.g.X("corrupted_geometry");
}h=a.fb.Xg(g,h.Qc,h.mh,h.lc);h.om(b.description);return h};d.prototype.XP=function(d){var b=new a.Ja;d=new c(this,d,b);d=a.ei.local().V(d,this.Qc,this.lc).next();d=a.Vp.Nj(d,this.Qc,2);var h=new a.Hd;h.scale(1/this.mc,1/this.mc);b.Xc(h);b=a.Vp.Nj(b,this.Qc,2);return 0<=this.Qa?a.ei.local().V(b,d,this.Qc,this.lc):a.cq.local().V(b,d,this.Qc,this.lc)};d.prototype.YP=function(d){d=new c(this,d,null);d=a.ei.local().V(d,this.Qc,this.lc).next();return d=a.Vp.Nj(d,this.Qc,2)};d.prototype.VP=function(d){d=
new b(this,d);d=a.ei.local().V(d,this.Qc,this.lc).next();return d=a.Vp.Nj(d,this.Qc,2)};d.prototype.WP=function(d){d=d.w();d.scale(this.mc);var b=new a.Ja;this.Yy(d,!1,b);return b=a.Vp.Nj(b,this.Qc,2)};d.prototype.dz=function(b,l,c,e,f,g){var h=b[0],r=b[b.length-1],k=h.y>r.y?h.y:r.y,m=a.C.q(this.Vb,this.rc,h.y<r.y?h.y:r.y),k=a.C.q(this.Vb,this.rc,k);if(.001<this.qB-(m+l+this.vb)&&.001<this.qB+(k-l-this.vb))return!1;l=c-1.570796326794897;c=e+1.570796326794897;var m=l-3.141592653589793,k=l+3.141592653589793,
y=c+3.141592653589793,q=[NaN],n=[NaN],w=[NaN],A=[NaN];e=!1;d.zD(this.Vb,this.rc,this.vb,h,l,m,r,c,q,n);d.zD(this.Vb,this.rc,this.vb,r,y,c,h,m,w,A);c<q[0]&&q[0]<y?e=!0:c<n[0]&&n[0]<y&&(e=!0);e||(m<w[0]&&w[0]<l?e=!0:m<A[0]&&A[0]<l&&(e=!0));if(!e&&f)return!1;for(var x=[],p=b.length-1;0<=p;p--)x.push(b[p]);g.Oa();g.Bl(null,0);p=[0];d.Xy(this.Vb,this.rc,this.mc,this.vb,this.$e,b,l,c,f,p,g);d.Fs(this.Vb,this.rc,this.mc,this.vb,r,c,y,this.Qo,f,p,g,q[0],n[0]);d.Xy(this.Vb,this.rc,this.mc,this.vb,this.$e,
x,y,k,f,p,g);d.Fs(this.Vb,this.rc,this.mc,this.vb,h,m,l,this.Qo,f,p,g,w[0],A[0]);b=!1;f||(b=this.OF(this.mc,g));return e||b};d.prototype.Yy=function(a,b,l){l.Oa();l.Bl(null,0);d.Fs(this.Vb,this.rc,this.mc,this.vb,a,-this.Qo,6.283185307179586,this.Qo,b,[0],l,NaN,NaN);b||this.OF(this.mc,l)};d.prototype.OF=function(a,d){var b=this.yQ(a,d);a=this.zQ(a,d);return b||a};d.prototype.yQ=function(d,b){var h=b.D(),l=!1,c=new a.h;b.s(c);if(!a.l.W(c.B*d,1.570796326794897)&&!a.l.W(c.A*d,-1.570796326794897))return!1;
for(var e=new a.b,h=h-1;0<=h;h--)b.w(h,e),e.y==c.B&&a.l.W(e.y*d,1.570796326794897)?(l=!0,this.IJ(e,h,b)):e.y==c.A&&a.l.W(e.y*d,-1.570796326794897)&&(l=!0,this.IJ(e,h,b));return l};d.prototype.zQ=function(a,d){var b=d.Ba(0),h=d.Ba(d.D()-1);return 3.141592653589793<Math.abs(b.x-h.x)*a?(this.NW(d),!0):this.xQ(d)};d.prototype.xQ=function(a){return 0>a.hf()?(this.MW(a),!0):!1};d.prototype.IJ=function(d,b,l){var h=l.D(),c=0<b?b-1:h-1,h=l.Ba(b<h-1?b+1:0),c=l.Ba(c);if(!a.l.W(h.y,d.y)&&!a.l.W(h.x,d.x)){var e=
new a.b;e.ka(h.x,d.y);l.rb(b,e)}a.l.W(c.y,d.y)||a.l.W(c.x,d.x)||(h=new a.b,h.ka(c.x,d.y),l.Zf(0,b,h))};d.prototype.NW=function(d){var b=new a.Ja,h=new a.Ja,l=new a.Hd,c=d.Ba(0),e=d.Ba(d.D()-1),f=new a.b;c.x>e.x?(e=this.or,l.Ag(-this.Et,0)):(e=-this.or,l.Ag(this.Et,0));b.add(d,!1);d.Oa();h.add(b,!1);h.Xc(l);c=new a.h;h.s(c);c.O((this.Et-c.N())/2,0);c.A=-this.or;c.B=this.or;for(var g=0;g<h.D();g++)h.w(g,f),b.Zf(0,-1,f);h.Xc(l);for(g=0;g<h.D();g++)h.w(g,f),b.Zf(0,-1,f);h=b.Ba(0);l=b.Ba(b.D()-1);f.ka(l.x,
e);b.Zf(0,-1,f);f.ka(.5*(l.x+h.x),e);b.Zf(0,-1,f);f.ka(h.x,e);b.Zf(0,-1,f);b=a.gi.ht(b,this.Qc,2,!0,c.o);b=a.gi.ht(b,this.Qc,2,!0,c.v);b=a.ne.clip(b,c,this.pr,NaN);d.add(b,!1)};d.prototype.MW=function(d){var b=new a.h;d.s(b);b.O((this.Et-b.N())/2,0);b.A=-this.or;b.B=this.or;d.Bl(null,0);var h=new a.b;h.ka(b.o,b.A);d.Zf(1,-1,h);h.ka(b.o,b.B);d.Zf(1,-1,h);h.ka(.5*(b.o+b.v),b.B);d.Zf(1,-1,h);h.ka(b.v,b.B);d.Zf(1,-1,h);h.ka(b.v,b.A);d.Zf(1,-1,h);h.ka(.5*(b.o+b.v),b.A);d.Zf(1,-1,h)};d.Xy=function(b,l,
c,e,f,g,k,m,q,n,w){var h=null;q||(h=new a.b,h.$c(),0<w.D()&&(h.L(w.Ba(w.D()-1)),h.scale(c)));var r=new a.ea(0),y=new a.ea(0),A=new a.ea(0),x=new a.b,p=new a.b,u=g[g.length-1];c=1/c;for(var H=0;H<g.length;H++){var B=g[H],z;0==H?z=k:H==g.length-1?z=m:(a.mb.Ld(b,l,u.x,u.y,B.x,B.y,null,null,r,f),z=r.j-1.570796326794897);a.mb.Xi(b,l,B.x,B.y,e,z,y,A);q?p.ka(y.j,A.j):(x.ka(y.j,A.j),d.LF(B.x,x.x,h.x,n),p.ka(n[0]+x.x,x.y),h.L(p));p.scale(c);w.Zf(0,-1,p)}};d.Fs=function(b,l,c,e,f,g,k,m,q,n,w,A,x){if(!(k-g<
m)){var h=new a.ea(0),r=new a.ea(0),y=new a.b,p=new a.b,u=null;q||(u=new a.b,u.$c(),0<w.D()&&(u.L(w.Ba(w.D()-1)),u.scale(c)));var H=a.J.truncate(Math.ceil(g/m)),B=H++*m;B==g&&(B=H++*m);for(c=1/c;B<k+m;){g<A&&A<B?(B=A,H--):g<x&&x<B&&(B=x,H--);if(B>=k)break;a.mb.Xi(b,l,f.x,f.y,e,B,h,r);q?p.ka(h.j,r.j):(y.ka(h.j,r.j),d.LF(f.x,y.x,u.x,n),p.ka(n[0]+y.x,y.y),u.L(p));p.scale(c);w.Zf(0,-1,p);g=B;B=H++*m}}};d.zD=function(d,b,l,c,e,f,g,k,m,q){var h=new a.b,r=new a.b,y=new a.ea(0),n=new a.ea(0);a.mb.Xi(d,b,
c.x,c.y,l,e,y,n);h.ka(y.j,n.j);a.mb.Xi(d,b,c.x,c.y,l,f,y,n);r.ka(y.j,n.j);l=new a.ea(0);a.mb.Fz(d,b,g.x,g.y,h.x,h.y,l);m[0]=l.j;a.mb.Fz(d,b,g.x,g.y,r.x,r.y,l);for(q[0]=l.j;m[0]<=q[0];)m[0]+=6.283185307179586;for(;m[0]>q[0];)m[0]-=6.283185307179586;for(;m[0]>=k;)m[0]-=6.283185307179586,q[0]-=6.283185307179586;for(;m[0]<k;)m[0]+=6.283185307179586,q[0]+=6.283185307179586};d.LF=function(a,d,b,l){if(isNaN(b)){for(;3.141592653589793<l[0]+d-a;)l[0]-=6.283185307179586;for(;3.141592653589793<a-(l[0]+d);)l[0]+=
6.283185307179586}else 3.141592653589793<l[0]+d-b?l[0]-=6.283185307179586:3.141592653589793<b-(l[0]+d)&&(l[0]+=6.283185307179586)};d.mQ=function(d,b){var h=d.G(),l;a.T.Ic(h)?l=d.aa():550==h?l=d.D():l=1;if(1==l)return d;var c=new a.ia(0);c.resize(l);for(var e=[],f=new a.h,r=0;r<l;r++){c.write(r,r);var g;a.T.Ic(h)?(d.jk(r,f),g=f.Wf()):g=d.Ba(r);g=a.sM.TY(b,g);e[r]=g}c.Gd(0,c.size,function(a,d){return e[a]<e[d]?-1:e[a]>e[d]?1:0});f=d.Ka();for(r=0;r<l;r++)g=c.read(r),a.T.Ic(h)?f.Ti(d,g,!0):f.Id(d,g,g+
1);return f};d.prototype.tY=function(){var d=Math.min(3.141592653589793*this.Vb-this.vb,this.vb),d=Math.min(d,.39269908169872414*this.Vb),b=new a.b;b.ka(0,10*this.mc);var l=45*this.mc,c=new a.ea(0),e=new a.ea(0),f=new a.ea(0),g=new a.ea(0),k=new a.ea(0),m=new a.ea(0),q=new a.ea(0),n=new a.ea(0),w=new a.b,A=new a.b,x=new a.b,p=new a.b;a.mb.Xi(this.Vb,this.rc,b.x,b.y,d,0,c,e);w.ka(c.j,e.j);a.mb.Xi(this.Vb,this.rc,b.x,b.y,d,l,f,g);A.ka(f.j,g.j);for(var c=new a.ea(0),e=new a.ea(0),u=new a.ea(0);;){a.mb.Xi(this.Vb,
this.rc,b.x,b.y,d,.5*(0+l),k,m);x.ka(k.j,m.j);a.mb.Ld(this.Vb,this.rc,w.x,w.y,A.x,A.y,c,e,null,2);a.mb.Oj(this.Vb,this.rc,w.x,w.y,.5*c.j,e.j,q,n,2);p.ka(q.j,n.j);a.mb.Ld(this.Vb,this.rc,x.x,x.y,p.x,p.y,u,null,null,2);if(u.j<=this.Po)break;l*=.9;a.mb.Xi(this.Vb,this.rc,b.x,b.y,d,l,f,g);A.ka(f.j,g.j)}this.Qo=6.283185307179586/Math.ceil(6.283185307179586/(l-0))};d.prototype.uY=function(){var d=Math.min(3.141592653589793*this.Vb-this.vb,this.vb),d=Math.min(d,.39269908169872414*this.Vb),b=new a.b,l=new a.b;
b.ka(0,10*this.mc);l.ka(10*this.mc,10*this.mc);var c=new a.ea(0),e=new a.ea(0),f=new a.ea(0);a.mb.Ld(this.Vb,this.rc,b.x,b.y,l.x,l.y,f,c,e,this.$e);var g=new a.ea(0),k=new a.ea(0),m=new a.ea(0),q=new a.ea(0),n=new a.b,w=new a.ea(0),A=new a.ea(0),x=new a.ea(0),p=new a.ea(0),u=new a.ea(0),B=new a.ea(0),z=new a.ea(0),v=new a.ea(0),t=new a.ea(0),C=new a.b,E=new a.b,F=new a.b,D=new a.b,G=1,c=c.j,e=e.j+1.570796326794897,f=f.j;a.mb.Xi(this.Vb,this.rc,b.x,b.y,d,c-1.570796326794897,A,x);C.ka(A.j,x.j);a.mb.Xi(this.Vb,
this.rc,l.x,l.y,d,e,p,u);E.ka(p.j,u.j);for(var A=new a.ea(0),x=new a.ea(0),e=new a.ea(0),aa=new a.ea(0);;){a.mb.Oj(this.Vb,this.rc,b.x,b.y,.5*(0+G)*f,c,g,k,this.$e);n.ka(g.j,k.j);a.mb.Ld(this.Vb,this.rc,b.x,b.y,n.x,n.y,null,null,w,this.$e);a.mb.Xi(this.Vb,this.rc,n.x,n.y,d,w.j+1.570796326794897,B,z);F.ka(B.j,z.j);a.mb.Ld(this.Vb,this.rc,C.x,C.y,E.x,E.y,A,x,null,2);a.mb.Oj(this.Vb,this.rc,C.x,C.y,.5*A.j,x.j,v,t,2);D.ka(v.j,t.j);a.mb.Ld(this.Vb,this.rc,F.x,F.y,D.x,D.y,e,null,null,2);if(e.j<=this.Po)break;
G*=.9;a.mb.Oj(this.Vb,this.rc,b.x,b.y,G*f,c,m,q,this.$e);l.ka(m.j,q.j);a.mb.Ld(this.Vb,this.rc,b.x,b.y,l.x,l.y,null,null,aa,this.$e);a.mb.Xi(this.Vb,this.rc,l.x,l.y,d,aa.j+1.570796326794897,p,u);E.ka(p.j,u.j)}d=G*f;1E5<d&&(d=1E5);this.vB=d};d.prototype.sY=function(){var a;a=5E4<this.vb?100:1E4<this.vb?10:1;500>this.vb/a&&(a=this.vb/500);.01>a&&(a=.01);this.Po=a};return d}();a.rM=l})(D||(D={}));(function(a){var b=function(){function b(){}b.tc=function(b,d){var h=new a.b;h.L(d);b.push(h)};b.rk=function(a,
d){a.add(d.x);a.add(d.y)};b.YC=function(a){a.yf(a.size-2)};b.oy=function(a,d){d.ka(a.get(a.size-2),a.get(a.size-1))};b.Ls=function(l,d,h,c,e,f){if(null==l)throw a.g.F();var r=l.G();if(l.u()||a.T.Jo(r))return l;var g=new b;g.mh=d;g.Qc=a.fb.kc(d);var k=a.fb.hw(g.Qc);g.lc=f;g.Vb=a.fb.Sv(g.Qc);g.rc=k*(2-k);g.mc=g.Qc.Nd().Ai;g.pr=g.Qc.Bo();g.Tt=g.pr*g.mc;g.gB=c;g.fB=e;g.$e=h;197==r?(h=new a.Ja(l.description),h.jd(l,!1)):a.T.Oc(r)?(h=new a.Ua(l.description),h.dc(l,!0)):h=l;if(4!=g.$e){d=0==g.mh.Eb(g.Qc)?
a.fb.Xg(h,g.mh,g.Qc,f):a.gi.Mj(h,g.Qc);if(d.u())return d;d=b.zJ(g.mc,d);d=g.Gz(d);d=a.Vp.Nj(d,g.Qc,g.$e);g=a.fb.Xg(d,g.Qc,g.mh,f)}else{2==a.Sd.Fb(d)?(l=a.fb.Mk(d),f=a.tk.local().V(h,l,d,f),f==l&&(f=new a.Ja,l.copyTo(f))):f=a.gi.Mj(h,g.Qc);d=f;if(d.u())return d;g=g.wY(d)}return g};b.zJ=function(l,d){var h=new a.h;d.ac(h);if(3.141592653589793>h.N()*l)return d;for(var c=!1,h=d.Fa(),e=new a.b,f=new a.b;h.Ya();)for(;h.Ea();){var g=h.ba();e.L(g.ec());f.L(g.Cc());e.scale(l);f.scale(l);if(3.141592653589793<
Math.abs(e.x-f.x)){var k=b.Av(e,f);if(!k){c=!0;break}if(6.283185307179586<Math.abs(e.x-f.x)){c=!0;break}}}if(!c)return d;var c=d.Ka(),m=1<d.description.Ga,q=new a.b,n=new a.b,w=new a.b,x=new a.b,A=new a.Wa;for(h.yj();h.Ya();)for(var p=NaN,u=[0];h.Ea();){g=h.ba();e.L(g.ec());f.L(g.Cc());e.scale(l);f.scale(l);isNaN(p)?(b.fe(e.x,NaN,u),n.L(e)):n.L(w);p=n.x;if(k=b.Av(e,f)){if(6.283185307179586<f.x-e.x)for(;6.283185307179586<f.x-e.x;)f.x-=6.283185307179586;if(-6.283185307179586>f.x-e.x)for(;-6.283185307179586>
f.x-e.x;)f.x+=6.283185307179586;b.fe(f.x,NaN,u);w.L(f)}else q.L(f),b.VM(q),b.fe(q.x,p,u),w.ka(u[0]+q.x,q.y);.5>Math.abs(w.x-f.x)&&w.L(f);m?(g.Fx(0,A),x.L(n),x.scale(1/l),A.rb(x),(k=h.jn())?c.Rf(A):c.lineTo(A),h.Io()&&!d.Qb(h.Ta)&&(g.Fx(1,A),x.L(w),x.scale(1/l),A.rb(x),c.lineTo(A))):((k=h.jn())&&c.rA(null,0),g=c.aa()-1,x.L(n),x.scale(1/l),c.Zf(g,-1,x),h.Io()&&!d.Qb(h.Ta)&&(x.L(w),x.scale(1/l),c.Zf(g,-1,x)))}return c};b.GG=function(l,d,h,c,e,f,g,k,m,q,n,w){var r=new a.b,y=new a.b,x=0<c.compare(e);b.qF(x,
c,e,r,y);b.vG(l,d,h,r,y,f,NaN,g,k,m,q,null,n,w);x&&b.qy(m,q,null,n)};b.prototype.Gz=function(l){var d=l.Ka(),h=l.Fa(),c=[],e=null,f=null,g=1<l.description.Ga;g&&(e=new a.Rd(0),f=new a.Cg);for(var k=[0],m=new a.b,q=new a.b,n=new a.b,w=new a.b;h.Ya();)for(k[0]=0;h.Ea();){var x=h.ba();m.L(x.ec());q.L(x.Cc());m.scale(this.mc);q.scale(this.mc);var A=0<m.compare(q);b.qF(A,m,q,n,w);c.length=0;null!=e&&e.yf(0);0<this.gB?b.vG(this.Vb,this.rc,this.$e,n,w,this.gB,this.fB,this.Tt,null,null,null,g?e:null,c,k):
b.RV(this.Vb,this.rc,this.$e,n,w,this.fB,this.Tt,g?e:null,c,k);A&&b.qy(null,null,g?e:null,c);c[0].L(x.ec());c[c.length-1].L(x.Cc());for(var p=1;p<c.length-1;p++)c[p].scale(1/this.mc);g?(A=b.SE(A,x,f),b.iE(h.jn(),h.Io()&&!l.Qb(h.Ta),x,A,e,c,d)):b.gE(h.jn(),h.Io()&&!l.Qb(h.Ta),c,d)}return d};b.prototype.wY=function(l){var d=l.Ka(),h=l.Fa(),c=[],e=null,f=new a.Cg,g=1<l.description.Ga;for(g&&(e=new a.Rd(0));h.Ya();)for(;h.Ea();){var k=h.ba(),m=k.ec(),q=k.Cc(),m=0<m.compare(q),q=b.SE(m,k,f);c.length=0;
null!=e&&e.yf(0);b.FL(this.Vb,this.rc,this.mc,q,this.mh,this.gB,this.fB,g?e:null,c);m&&b.qy(null,null,g?e:null,c);g?b.iE(h.jn(),h.Io()&&!l.Qb(h.Ta),k,q,e,c,d):b.gE(h.jn(),h.Io()&&!l.Qb(h.Ta),c,d)}return d};b.gE=function(a,d,b,c){a&&c.rA(null,0);a=c.aa()-1;var h=b.slice(0);c.EH(a,h,h.length-1);d&&c.Zf(a,-1,b[b.length-1])};b.iE=function(b,d,h,c,e,f,g){var l=new a.Wa;h.Dp(l);b?g.Rf(l):g.lineTo(l);if(2<f.length){b=c.Rb();for(var r=1;r<f.length-1;r++){var k=c.bI(e.get(r)*b);c.Fx(k,l);l.rb(f[r]);g.lineTo(l)}}d&&
(h.Bp(l),g.lineTo(l))};b.vG=function(l,d,h,c,e,f,g,k,m,q,n,w,x,A){var r=new a.ea(0),y=new a.ea(0),p=new a.ea(0);a.mb.Ld(l,d,c.x,c.y,e.x,e.y,p,r,y,h);var p=p.j,u=r=r.j,y=y.j;0>u&&(u+=6.283185307179586);0>y&&(y+=6.283185307179586);null!=m&&(m[0]=p);null!=q&&(q[0]=u);null!=n&&(n[0]=y);q=m=NaN;null!=w&&(q=a.C.Yg(l,d),n=a.C.q(l,d,c.y),m=(q-n)/p,q=(q+n)/p);n=b.Bv(c,e);var y=b.zv(c,e),u=n||y,H=b.tE(c,e,k),B=new a.ea(0),z=new a.ea(0),v=new a.b,t=new a.b,C=new a.b;b.fe(c.x,NaN,A);var E=[A[0]];if(p<=f)b.tc(x,
c),b.fe(e.x,NaN,A),null!=w&&w.add(0),u?(n&&b.my(c,e,w,x),y&&b.iy(c,e,w,x)):H?b.ly(c,e,r,m,q,w,x):0<g&&(t.ka(c.x-E[0],c.y),v.ka(e.x-A[0],e.y),b.FA(l,d,h,c,p,r,t,v,0,1,g,w,x,E)),b.tc(x,e);else{f=1+a.J.truncate(Math.ceil(p/f));var P=p/(f-1),F=new a.b,D=0;b.tc(x,c);F.L(c);t.ka(c.x-A[0],c.y);null!=w&&w.add(0);for(var G=1;G<f;G++){var ba;G<f-1?(a.mb.Oj(l,d,c.x,c.y,G*P,r,B,z,h),v.ka(B.j,z.j),b.fe(v.x,F.x,A),C.ka(A[0]+v.x,v.y),ba=G/(f-1)):(b.fe(e.x,NaN,A),v.ka(e.x-A[0],e.y),C.L(e),ba=1);u?(1==G&&n&&b.my(c,
C,w,x),G==f-1&&y&&b.iy(F,e,w,x)):H?b.rE(F,C,k)&&(c.x<e.x?F.x>C.x&&(A[0]+=6.283185307179586,C.ka(A[0]+v.x,v.y)):F.x<C.x&&(A[0]-=6.283185307179586,C.ka(A[0]+v.x,v.y)),b.ly(F,C,r,m,q,w,x)):0<g&&b.FA(l,d,h,c,p,r,t,v,D,ba,g,w,x,E);b.tc(x,C);null!=w&&w.add(ba);F.L(C);t.L(v);E[0]=A[0];D=ba}}};b.RV=function(l,d,h,c,e,f,g,k,m,q){var r=new a.ea(0),y=new a.ea(0),n=new a.ea(0);a.mb.Ld(l,d,c.x,c.y,e.x,e.y,n,r,y,h);var y=n.j,r=r.j,w=n=NaN;if(null!=k)var w=a.C.Yg(l,d),x=a.C.q(l,d,c.y),n=(w-x)/y,w=(w+x)/y;var x=
b.Bv(c,e),A=b.zv(c,e),p=x||A;g=b.tE(c,e,g);var u=b.Av(c,e),u=p||g||u;b.fe(c.x,NaN,q);var H=new a.b;b.tc(m,c);H.L(c);null!=k&&k.add(0);u?(p?(x&&b.my(c,e,k,m),A&&b.iy(c,e,k,m)):g&&b.ly(c,e,r,n,w,k,m),b.fe(e.x,NaN,q),b.tc(m,e)):y<=f?(b.fe(e.x,NaN,q),b.tc(m,e)):(n=new a.b,g=new a.b,n.L(c),g.L(e),n.x-=q[0],g.x-=q[0],-3.141592653589793>g.x?g.x+=6.283185307179586:3.141592653589793<g.x&&(g.x-=6.283185307179586),b.FA(l,d,h,c,y,r,n,g,0,1,f,k,m,q),b.tc(m,e),b.fe(e.x,NaN,q));null!=k&&k.add(1)};b.FA=function(l,
d,h,c,e,f,g,k,m,q,n,w,x,A){var r=new a.b,y=new a.b;r.ka(g.x+A[0],g.y);new a.ea(0);new a.ea(0);new a.ea(0);new a.ea(0);var p=new a.ea(0),u=new a.ea(0),H=new a.ea(0),B=new a.b,z=new a.b,v=new a.b,t=new a.b;B.L(g);z.L(k);g=new a.Rd(0);k=new a.Rd(0);b.rk(g,z);k.add(q);var C=new a.b,E=new a.Hb,F=[];for(b.rG(4,F);0<g.size;){for(var P=!1,D,G=NaN,ba=0;3>ba;ba++)if(D=F[ba]*q+(1-F[ba])*m,a.mb.Oj(l,d,c.x,c.y,D*e,f,p,u,h),v.ka(p.j,u.j),0==ba&&(G=D,t.L(v)),b.xO(B,v,z,E),E.gc(E.pe(v,!0),C),a.mb.Ld(l,d,v.x,v.y,
C.x,C.y,H,null,null,2),H.j>n){P=!0;break}P?(z.L(t),q=G,b.rk(g,z),k.add(q)):(b.YC(g),k.Fk(k.size-1,1,k.size-1),0<g.size&&(b.fe(z.x,r.x,A),y.ka(A[0]+z.x,z.y),b.tc(x,y),r.L(y),null!=w&&w.add(q),B.L(z),m=q,b.oy(g,z),q=k.get(k.size-1)))}};b.FL=function(l,d,h,c,e,f,g,k,m){var r=new a.b,y=new a.b,q=new a.b,n=new a.b,w=new a.b,x=new a.b,A=new a.b,p=new a.b,u=new a.b,H=new a.b,B=new a.ea(0),z=new a.ea(0),v=new a.b,t=[[],[]],C=1==a.Sd.Fb(e);e=e.re(0);var E=c.ec(),F=c.Cc();C?(x.ka(E.x*h,E.y*h),A.ka(F.x*h,F.y*
h)):(t[0][0]=E.x,t[0][1]=E.y,t[1][0]=F.x,t[1][1]=F.y,a.fb.lu(),x.x=t[0][0]*h,x.y=t[0][1]*h,A.x=t[1][0]*h,A.y=t[1][1]*h);var P=0,D=0,G=1,ba=c.Go();r.L(E);y.L(F);var F=new a.Rd(0),I=new a.Rd(0),K=new a.Rd(0);b.rk(F,y);b.rk(I,A);K.add(G);b.tc(m,r);null!=k&&k.add(D);var M=[],aa;aa=0<g?ba?5:3:ba?5:1;b.rG(aa,M);for(var ea=new a.ea(0),J=new a.ea(0),L=new a.ea(0),Q=new a.ea(0),O=new a.ea(0),W=new a.ea(0),X=new a.ea(0);0<I.size;){var S=!1,T,V=NaN;a.mb.Ld(l,d,x.x,x.y,A.x,A.y,ea,J,null,2);for(E=0;E<aa;E++){if(0==
E){if(!ba&&0>=g&&ea.j<=f&&3.141592653589793>Math.abs(x.x-A.x))break;if(c.Dy(D,G)<=e)break}T=M[E]*G+(1-M[E])*D;c.gc(T,q);C?p.ka(q.x*h,q.y*h):(t[0][0]=q.x,t[0][1]=q.y,a.fb.lu(),p.x=t[0][0]*h,p.y=t[0][1]*h);if(0==E&&(V=T,w.L(q),H.L(p),0<f&&(ea.j>f||3.141592653589793<=Math.abs(x.x-A.x)))){S=!0;break}if(ba&&0<f){if(a.mb.Ld(l,d,x.x,x.y,p.x,p.y,L,null,null,2),L.j>f||3.141592653589793<=Math.abs(x.x-p.x)){S=!0;break}}else if(0<g)if(ba?(n.IU(r,y,M[E]),C?u.ka(n.x*h,n.y*h):(t[0][0]=n.x,t[0][1]=n.y,a.fb.lu(),
u.x=t[0][0]*h,u.y=t[0][1]*h)):(n.L(q),u.L(p)),a.mb.Ld(l,d,x.x,x.y,u.x,u.y,Q,null,null,2),Q.j<=ea.j){a.mb.Oj(l,d,x.x,x.y,Q.j,J.j,B,z,2);v.ka(B.j,z.j);a.mb.Ld(l,d,v.x,v.y,p.x,p.y,O,null,null,2);if(O.j>g){S=!0;break}if(ba){a.mb.Ld(l,d,v.x,v.y,u.x,u.y,W,null,null,2);if(W.j>g){S=!0;break}a.mb.Ld(l,d,u.x,u.y,p.x,p.y,X,null,null,2);if(X.j>g){S=!0;break}}}else{S=!0;break}}S?(y.L(w),A.L(H),G=V,b.rk(F,y),b.rk(I,A),K.add(G)):(b.YC(F),b.YC(I),K.Fk(K.size-1,1,K.size-1),b.tc(m,y),P+=ea.j,null!=k&&k.add(P),0<I.size&&
(r.L(y),x.L(A),D=G,b.oy(F,y),b.oy(I,A),G=K.get(K.size-1)))}if(null!=k)for(l=1/P,E=0;E<k.size;E++)k.write(E,k.read(E)*l)};b.qy=function(a,d,b,c){c.reverse();null!=b&&b.Zd(0,b.size,1);b=null!=a?a[0]:NaN;c=null!=d?d[0]:NaN;null!=a&&(a[0]=c);null!=d&&(d[0]=b)};b.qF=function(a,d,b,c,e){a?(c.L(b),e.L(d)):(c.L(d),e.L(b))};b.SE=function(a,d,b){if(!a)return d;b.create(d.G());d.copyTo(b.get());b.get().reverse();return b.get()};b.fe=function(a,d,b){if(isNaN(d)){for(;3.141592653589793<b[0]-a;)b[0]-=6.283185307179586;
for(;3.141592653589793<a-b[0];)b[0]+=6.283185307179586}else 3.141592653589793<b[0]+a-d?b[0]-=6.283185307179586:3.141592653589793<d-(b[0]+a)&&(b[0]+=6.283185307179586)};b.xO=function(a,d,b,c){3.141592653589793>Math.abs(d.x-a.x)?(c.Mc(a),3.141592653589793<=b.x-a.x?c.vm(b.x-6.283185307179586,b.y):3.141592653589793<=a.x-b.x?c.vm(b.x+6.283185307179586,b.y):c.vm(b.x,b.y)):(c.Mc(b),3.141592653589793<=a.x-b.x?c.vm(a.x-6.283185307179586,a.y):3.141592653589793<=b.x-a.x?c.vm(a.x+6.283185307179586,a.y):c.vm(a.x,
a.y))};b.rG=function(a,d){for(var b=0;b<a;b++){var l=Math.ceil(b/2)/(a+1);0!=b%2&&(l=-l);d[b]=.5+l}};b.Bv=function(b,d){return a.l.W(b.y,1.570796326794897)&&!a.l.W(d.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&!a.l.W(d.y,-1.570796326794897)?!0:!1};b.zv=function(b,d){return a.l.W(d.y,1.570796326794897)&&!a.l.W(b.y,1.570796326794897)||a.l.W(d.y,-1.570796326794897)&&!a.l.W(b.y,-1.570796326794897)?!0:!1};b.tE=function(l,d,h){return!b.rE(l,d,h)||a.l.W(l.y,1.570796326794897)||a.l.W(l.y,-1.570796326794897)||
a.l.W(d.y,1.570796326794897)||a.l.W(d.y,-1.570796326794897)?!1:!0};b.rE=function(a,d,b){return Math.abs(Math.abs(a.x-d.x)-3.141592653589793)<=b?!0:!1};b.Av=function(b,d){return a.l.W(b.y,1.570796326794897)&&a.l.W(d.y,1.570796326794897)||a.l.W(b.y,-1.570796326794897)&&a.l.W(d.y,-1.570796326794897)?!0:!1};b.my=function(l,d,h,c){if(0<l.y){var e=new a.b;e.ka(d.x,1.570796326794897)}else e=new a.b,e.ka(d.x,-1.570796326794897);a.l.W(l.x,e.x)||a.l.W(d.y,e.y)||(b.tc(c,e),null!=h&&h.add(0))};b.iy=function(l,
d,h,c){if(0<d.y){var e=new a.b;e.ka(l.x,1.570796326794897)}else e=new a.b,e.ka(l.x,-1.570796326794897);a.l.W(d.x,e.x)||a.l.W(l.y,e.y)||(b.tc(c,e),null!=h&&h.add(1))};b.ly=function(l,d,h,c,e,f,g){a.l.xd(h)?(0<1.570796326794897-l.y&&(h=new a.b,h.ka(l.x,1.570796326794897),b.tc(g,h),null!=f&&f.add(c)),0<1.570796326794897-d.y&&(h=new a.b,h.ka(d.x,1.570796326794897),b.tc(g,h),null!=f&&f.add(c))):(0<1.570796326794897+l.y&&(h=new a.b,h.ka(l.x,-1.570796326794897),b.tc(g,h),null!=f&&f.add(e)),0<1.570796326794897+
d.y&&(h=new a.b,h.ka(d.x,-1.570796326794897),b.tc(g,h),null!=f&&f.add(e)))};b.VM=function(a){if(-3.141592653589793>a.x)for(;-3.141592653589793>a.x;)a.x+=6.283185307179586;if(3.141592653589793<a.x)for(;3.141592653589793<a.x;)a.x-=6.283185307179586};return b}();a.Ej=b})(D||(D={}));(function(a){var b=function(){function b(){}b.Nj=function(l,d,h){if(null==l||null==d||!a.fb.Jc(d))throw a.g.F();if(l.u())return l;var c=l,e=c.G();if(a.T.Ic(e)){c=a.gi.Mj(l,d);l=new a.h;c.s(l);for(var e=a.na.be(d,l,!1),f=a.fb.Bh(d),
g=Math.floor((l.o-f.o)/f.N())*f.N()+f.o;g<l.v;)g>l.o+e&&g<l.v-e&&(c=a.gi.ht(c,d,h,!0,g)),g+=f.N()}else{if(197==e)return l=new a.Ja(c.description),l.jd(c,!1),b.Nj(l,d,h);if(a.T.Oc(e))return l=new a.Ua(c.description),l.dc(c,!0),b.Nj(l,d,h)}return b.jV(c,d)};b.jV=function(l,d){if(null==l||null==d||!a.fb.Jc(d))throw a.g.F();if(l.u())return l;var h;h=l.G();197==h?(h=new a.Ja(l.description),h.jd(l,!1)):a.T.Oc(h)?(h=new a.Ua(l.description),h.dc(l,!0)):h=l;h=a.gi.Mj(h,d);return h.u()?h:1==a.Sd.Fb(d)?a.gi.Xm(h,
d,0,h!=l,0):b.dV(h,d,h!=l)};b.dV=function(b,d,h){if(!a.fb.Jc(d))throw a.g.F();if(b.u())return b;var l=a.fb.ee(d),c=0-180*l,l=360*l;2==a.Sd.Fb(d)&&(c=a.fb.Bh(d),l=c.v,c=c.o,l-=c);return a.gi.Aq(b,c,l,d,h,0,!0)};return b}();a.Vp=b})(D||(D={}));(function(a){var b=function(){function b(){}b.fV=function(a,d){var b=Math.abs(a%d);return isNaN(b)||b==a||b<=Math.abs(d)/2?b:0>a?-1*(b-d):0<a?1*(b-d):0*(b-d)};b.K=function(a){return 0>a?-a:a};b.Ab=function(a,d){return 0<=d?b.K(a):-b.K(a)};b.W=function(a,d){return a==
d||b.K(a-d)<=b.gD*(1+(b.K(a)+b.K(d))/2)};b.xd=function(a){return 0==a||b.K(a)<=b.gD};b.Fu=function(a){a=b.fV(a,b.mA);return b.K(a)<=b.Oi?a:0>a?a+b.mA:a-b.mA};b.KB=function(a,d){a.j=b.Fu(a.j);d.j=b.Fu(d.j);b.K(d.j)>b.ss&&(a.j=b.Fu(a.j+b.Oi),d.j=b.Ab(b.Oi,d.j)-d.j)};b.Yg=function(a,d){d=Math.sqrt(1-d);d=(1-d)/(1+d);var h=d*d;return a/(1+d)*(1+h*(.25+h*(.015625+1/256*h)))*b.ss};b.SS=function(l,d,h,c,e){var f,r,g,k,m,q,y,n=0,w=q=0,x=0,A=0,p=0;m=0;var u,B,z;y=0;var v,t,C;z=new a.ea;f=new a.ea;if(null!=
e)if(z.j=l,f.j=d,b.KB(z,f),l=z.j,d=f.j,z.j=h,f.j=c,b.KB(z,f),h=z.j,c=f.j,h=b.Fu(h-l),b.W(d,c)&&(b.xd(h)||b.W(b.K(d),b.ss)))null!=e&&(e.j=0);else{if(b.W(d,-c)){if(b.W(b.K(d),b.ss)){null!=e&&(e.j=2*b.Yg(6378137,.0066943799901413165));return}if(b.W(b.K(h),b.Oi)){null!=e&&(e.j=2*b.Yg(6378137,.0066943799901413165));return}}if(b.xd(.0066943799901413165))A=Math.cos(d),p=Math.cos(c),null!=e&&(n=Math.sin((c-d)/2),q=Math.sin(h/2),y=2*Math.asin(Math.sqrt(n*n+A*p*q*q)),e.j=6378137*y);else{z=1-Math.sqrt(.9933056200098587);
l=1-z;f=Math.atan(l*Math.tan(d));d=Math.sin(f);f=Math.cos(f);r=Math.atan(l*Math.tan(c));c=Math.sin(r);r=Math.cos(r);k=g=h;t=0;C=1;v=h;for(B=!0;1==B;)t+=1,1==C&&(m=Math.sin(v),q=Math.cos(v),n=r*m,y=f*c-d*r*q,n=Math.sqrt(n*n+y*y),q=d*c+f*r*q,y=Math.atan2(n,q),w=1E-15>b.K(n)?f*r*m/b.Ab(1E-15,n):f*r*m/n,x=1-w*w,A=1E-15>b.K(x)?q-d*c/b.Ab(1E-15,x)*2:q-d*c/x*2,p=A*A,m=((-3*x+4)*z+4)*x*z/16),u=(1-m)*z*(y+m*n*(A+q*m*(2*p-1))),1==C?(v=h+u*w,1E-14>b.K(v-k)?B=!1:b.K(v)>b.Oi?(C=2,v=b.Oi,0>h&&(v=-v),w=0,x=1,g=
k=2,y=b.Oi-b.K(Math.atan(d/f)+Math.atan(c/r)),n=Math.sin(y),q=Math.cos(y),m=((-3*x+4)*z+4)*x*z/16,1E-14>b.K(w-g)?B=!1:(A=1E-15>b.K(x)?q-d*c/b.Ab(1E-15,x)*2:q-d*c/x*2,p=A*A)):(0>(v-k)*(k-g)&&5<t&&(v=(2*v+3*k+g)/6),g=k,k=v)):(w=(v-h)/u,0>(w-k)*(k-g)&&5<t&&(w=(2*w+3*k+g)/6),g=k,k=w,x=1-w*w,m=w*n/(f*r),q=-Math.sqrt(b.K(1-m*m)),v=Math.atan2(m,q),n=r*m,y=f*c-d*r*q,n=Math.sqrt(n*n+y*y),q=d*c+f*r*q,y=Math.atan2(n,q),m=((-3*x+4)*z+4)*x*z/16,1E-14>b.K(w-g)?B=!1:(A=1E-15>b.K(x)?q-d*c/b.Ab(1E-15,x)*2:q-d*c/x*
2,p=A*A));null!=e&&(w=Math.sqrt(1+(1/(l*l)-1)*x),w=(w-1)/(w+1),x=w*(1-.375*w*w),e.j=(1+w*w/4)/(1-w)*l*6378137*(y-x*n*(A+x/4*(q*(-1+2*p)-x/6*A*(-3+4*n*n)*(-3+4*p)))))}}};b.Oi=3.141592653589793;b.ss=1.5707963267948966;b.mA=6.283185307179586;b.gD=3.552713678800501E-15;return b}();a.pM=b})(D||(D={}));(function(a){var b=function(){return function(a){this.ue=a;this.ll=this.ue.getCode();0>this.ll&&(this.ll=0)}}();a.SZ=b;var c=function(){function l(a){void 0===a&&(a=null);this.Kh=null;this.nn=!1;null!==a&&
(this.Kh=new b(a))}l.prototype.yc=function(){return null!=this.Kh?this.Kh.ll:0};l.prototype.Vf=function(){var a=new l;this.copyTo(a);return a};l.prototype.copyTo=function(a){a.Kh=this.Kh;a.nn=this.nn};l.prototype.Wv=function(){var a=this.Vf();a.kt();return a};l.prototype.kt=function(){this.nn=!this.nn};l.prototype.cn=function(){return null!=this.Kh?this.Kh.ue:null};l.prototype.BK=function(d){if(0>=d)throw a.g.F();if(d!=this.yc()){d=a.Tf.geogtran(d);if(null==d)throw a.g.F("Geogtran not found.");this.Kh=
new b(d)}};l.prototype.mH=function(){return null==this.Kh?null:this.Kh.ue.toString()};l.prototype.getName=function(){if(null==this.Kh||null==this.Kh.ue)return"";var a="";this.nn&&(a+="~");return a+=this.Kh.ue.getName()};l.prototype.oY=function(d){if(null==d)throw a.g.F();var h=null;try{h=a.Tf.fromString(a.Vc.PE_TYPE_GEOGTRAN,d)}catch(r){throw a.g.F();}this.Kh=new b(h)};l.prototype.Eb=function(a){return a==this?!0:a instanceof l&&(!(0>=this.yc()||this.yc()!=a.yc())||this.cn().isEqual(a.cn()))?this.nn==
a.nn:!1};l.prototype.toString=function(){var a=toString();return 200<a.length?a.substring(0,197)+"... ("+a.length.toString()+" characters)":a};l.create=function(a,b){var d=new l;d.BK(a);b&&d.kt();return d};l.fG=function(a,b){var d=new l;d.oY(a);b&&d.kt();return d};return l}();a.io=c})(D||(D={}));(function(a){var b=function(){function a(){}a.pa=function(d,b,l,c){var h=new a;h.vn=d;h.wn=b;h.MI=l;h.NI=c;return h};a.Hs=function(a,b){return a.vn==b.vn?a.wn==b.wn?0:a.wn<b.wn?-1:1:a.vn<b.vn?-1:1};return a}(),
c=function(){function l(){this.Hw=!1;this.OI=[];this.$A=[];this.jI=this.Hw=this.iI=!1;this.kq()}l.zo=function(){null==l.FG&&(l.FG=new l);return l.FG};l.c_=function(){return l.zo().Hw};l.f_=function(){return l.zo().jI};l.z_=function(a,b){if(a==b)return null;var d=l.zo();if(d.iI){var h=l.EA(d.$A,a,b);return null!=h?h:null}h=l.EA(d.$A,a,b);return null!=h?h:l.EA(d.OI,a,b)};l.fO=function(d,b,l,c,e){var h=a.ny.create();if(0<d)try{var f=a.io.create(d,b);if(0==f.yc())return null;h.add(f);if(0<l){var r=a.io.create(l,
c);if(0==r.yc())return null;h.add(r)}e&&(h=h.Wv())}catch(va){h=null}return h};l.EA=function(a,h,c){if(h==c||0==a.length)return null;for(var d=b.pa(h,c,0,0),e=!1,f=!1,r=0,g=0,k=-1,m=0;m<a.length;m++)if(0===b.Hs(d,a[m])){k=m;break}if(0>k||a[k].vn!=d.vn||a[k].wn!=d.wn){d=b.pa(c,h,0,0);h=-1;for(m=0;m<a.length;m++)if(0===b.Hs(d,a[m])){h=m;break}0<=h&&a[h].vn==d.vn&&a[h].wn==d.wn&&(r=a[h].MI,g=a[h].NI,f=e=!0)}else r=a[k].MI,g=a[k].NI,e=!1,f=!0;if(!f)return null;0==r&&(r=g,g=0);d=a=!1;0>r&&(r=-r,a=!0);0>
g&&(g=-g,d=!0);return l.fO(r,a,g,d,e)};l.prototype.kq=function(){this.BE(this.OI)&&(this.Hw=!0);this.BE(this.$A)&&(this.jI=!0);this.iI=!this.Hw};l.prototype.BE=function(a){try{for(var d=[],d=d.sort(b.Hs),l=0;l<d.length;l++)a.push(d[l])}catch(y){}return!0};l.Q_=function(){return null};return l}();a.RZ=c})(D||(D={}));(function(a){var b=function(){function a(){}a.prototype.My=function(a){this.Hi=a};a.prototype.NE=function(a){this.Mb=a};a.prototype.OE=function(a){this.np=a};a.JF=function(a){return a.u()||
1607!=a.G()&&1736!=a.G()?!1:!0};a.HF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>a.D()?!1:!0};a.IF=function(a){return a.u()||1607!=a.G()&&1736!=a.G()||20>a.D()?!1:!0};return a}();a.wl=b})(D||(D={}));(function(a){var b=function(){function b(){}b.mX=function(b){var d=new a.Ja;d.$x(b.R.o,b.R.A);d.Xj(b.R.o,b.R.B);d.Xj(b.R.v,b.R.B);d.Xj(b.R.v,b.R.A);return d};b.Xg=function(b,d){return null===b?null:a.os.local().V(b,d,null)};b.gZ=function(b,d){var h=a.ei.local();b=new a.hd(b);return h.V(b,d,
null).next()};b.Vm=function(b,d,h){return a.cq.local().V(b,d,h,null)};b.Pp=function(b,d,h){return a.uy.local().V(b,d,h,null)};b.OY=function(b,d,h){var l=a.uy.local();b=new a.hd(b);d=new a.hd(d);h=l.V(b,d,h,null);for(l=[];null!=(d=h.next());)l.push(d);return l};b.Eb=function(b,d,h){return a.Gj.local().V(3,b,d,h,null)};b.QR=function(b,d,h){return a.Gj.local().V(4,b,d,h,null)};b.LU=function(b,d,h){var l=a.tk.local();b=new a.hd(b);d=new a.hd(d);h=l.V(b,d,h,null);for(l=[];null!=(d=h.next());)l.push(d);
return l};b.NR=function(b,d,h){var l=a.cq.local();b=new a.hd(b);d=new a.hd(d);h=l.V(b,d,h,null);for(l=[];null!=(d=h.next());)l.push(d);return l};b.Ma=function(b,d,h){return a.tk.local().V(b,d,h,null)};b.rZ=function(b,d,h){return a.Gj.local().V(2,b,d,h,null)};b.contains=function(b,d,h){return a.Gj.local().V(1,b,d,h,null)};b.yR=function(b,d,h){return a.Gj.local().V(16,b,d,h,null)};b.touches=function(b,d,h){return a.Gj.local().V(8,b,d,h,null)};b.oW=function(b,d,h){return a.Gj.local().V(32,b,d,h,null)};
b.NU=function(b,d,h){return a.Gj.local().V(1073741824,b,d,h,null)};b.YB=function(b,d,h,c){return a.pN.local().V(b,d,h,c,null)};b.Cb=function(b,d,h,c){var l=null;if(null!=h){if(l=h.Nd(),null!=c&&l.yc()!=c.yc()&&l.nd!=c.nd)throw a.g.vk();}else if(null!=c)throw a.g.F();b=a.hN.local().V(b,d,null);null!==l&&null!==c&&(b=a.oc.li(b,l,c));return b};b.clip=function(b,d,h){return a.bN.local().V(b,a.h.pa(d.R.o,d.R.A,d.R.v,d.R.B),h,null)};b.Hl=function(b,d,h){if(null==b||null==d)return null;b=a.dN.local().V(!0,
b,d,h,null);for(d=[];null!=(h=b.next());)h.u()||d.push(h);return d.slice(0)};b.QP=function(l,d,h,c,e,f,g,k){if(!0===e)return b.YM(l,d,h,c,f,g,k);e=h;if(null!=d){if(g=d.Nd(),null!=c&&g.yc()!=c.yc()){if(g.nd!=c.nd)throw a.g.vk();e=[];a.oc.dG(h,h.length,c,g,e)}}else if(null!=c)throw a.g.F();h=a.CD.local();if(f){l=new a.hd(l);d=h.V(l,d,e,f,null);for(l=[];null!=(f=d.next());)l.push(f);f=l.slice(0)}else for(f=[],c=0;c<l.length;c++)f[c]=h.V(l[c],d,e[c],null);return f};b.YM=function(b,d,h,c,e,f,g){if(null===
d)throw a.g.F();if(null===c||void 0===c)c=4326!==d.yc()?d.Nd():a.oc.ze(9001);if(0!==c.nd)throw a.g.F();a.oc.dG(h,h.length,c,a.oc.ze(9001),h);c=a.HD.local();if(e){b=new a.hd(b);d=c.V(b,d,f,h,g,!1,e,null);for(h=[];null!=(f=d.next());)h.push(f);e=h.slice(0)}else{e=[];for(var l=0;l<b.length;l++)e[l]=c.V(b[l],d,f,h[l],g,!1,null)}return e};b.buffer=function(b,d,h,c,e,f,g){var l=h;if(!1===e){if(null!=d){if(e=d.Nd(),null!=c&&e.yc()!=c.yc()){if(e.nd!=c.nd)throw a.g.vk();l=a.oc.li(h,c,e)}}else if(null!=c)throw a.g.F();
b=a.CD.local().V(b,d,l,null)}else{if(null===d)throw a.g.F();if(null===c||void 0===c)c=4326!==d.yc()?d.Nd():a.oc.ze(9001);if(0!==c.nd)throw a.g.F();l=a.oc.li(h,c,a.oc.ze(9001));b=a.HD.local().V(b,d,f,l,g,!1,null)}return b};b.mW=function(b,d,h,c,e,f,g){if(null!=d){var l=d.Nd();if(null!=g&&l.yc()!=g.yc()){if(l.nd!=g.nd)throw a.g.vk();h=a.oc.li(h,g,l)}}else if(null!=g)throw a.g.F();b=new a.hd(b);d=a.LD.local().V(b,d,h,c,e,f,null);for(h=[];null!=(c=d.next());)h.push(c);return h.slice(0)};b.offset=function(b,
d,h,c,e,f,g){if(null!=d){var l=d.Nd();if(null!=g&&l.yc()!=g.yc()){if(l.nd!=g.nd)throw a.g.vk();h=a.oc.li(h,g,l)}}else if(null!=g)throw a.g.F();return a.LD.local().V(b,d,h,c,e,f,null)};b.hR=function(b){return a.ED.local().V(b,null)};b.iR=function(b,d){var h=a.ED.local();b=new a.hd(b);h=h.V(b,d,null);for(b=[];null!=(d=h.next());)b.push(d);return b};b.Zz=function(b,d,h){return a.sy.local().Zz(b,d,h)};b.$z=function(b,d){return a.sy.local().$z(b,d)};b.aA=function(b,d,h,c){return a.sy.local().aA(b,d,h,
c)};b.CC=function(b,d){return a.Km.local().V(b,d,!1,null)};b.YU=function(b,d){return a.Km.local().Wq(b,d,null)};b.GS=function(b,d,h,c,e){var l=a.GD.local();if(null!=d){if(d=d.Nd(),null!=e&&d.yc()!=e.yc()){if(d.nd!=e.nd)throw a.g.vk();h=a.oc.li(h,e,d)}}else if(null!=e)throw a.g.F();return l.V(b,h,c,null)};b.Ls=function(b,d,h,c){var l=a.Jm.local();if(null!=d){if(d=d.Nd(),null!=c&&d.yc()!=c.yc()){if(d.nd!=c.nd)throw a.g.vk();h=a.oc.li(h,c,d)}}else if(null!=c)throw a.g.F();return l.V(b,h,null)};b.Ez=
function(b,d,h,c,e){void 0===e&&(e=0);var l=a.jN.local();if(4==e)throw a.g.df();if(0!==e)throw a.g.df();if(null!=d){var f=d.Nd();if(null!=c&&f.yc()!=c.yc()){if(f.nd!=c.nd)throw a.g.vk();h=a.oc.li(h,c,f)}}else if(null!=c)throw a.g.F();return l.V(b,h,d,e,null)};b.MS=function(c,d,h,e){if(null===c)return 0;if(4==e)throw a.g.df();if(0!==e)throw a.g.df();if(197==c.G())c=b.mX(c);else if(1736!=c.G())return 0;e=a.fb.kc(d);c=a.fb.Xg(c,d,e,null);c=a.qM.NS([c])[0];if(null!==h){if(2!==h.nd)throw a.g.F("Unit must be a area unit type");
c=a.oc.li(c,a.oc.ze(109404),h)}return c};b.QS=function(b,d,h,c){b=a.lN.local().V(b,d,c,null);if(null!==h){if(0!==h.nd)throw a.g.F("Unit must be a linear unit type");b=a.oc.li(b,a.oc.ze(9001),h)}return b};b.wW=function(b,d,h){if(null===b)return 0;var c=null;if(null!=d){c=d.Nd();if(0==c.nd&&(c=a.oc.lH(c),null==c&&null!==h))throw a.g.F();if(null!=h&&c.yc()!=h.yc()&&c.nd!=h.nd)throw a.g.vk();}else if(null!=h)throw a.g.F();return 1736==b.G()||197==b.G()?(b=b.hf(),null!==h?a.oc.li(b,c,h):b):0};b.xW=function(b,
d,h){if(null===b||b.u()||1>b.tb())return 0;var c=null;if(null!=d){if(c=d.Nd(),null!=h&&c.yc()!=h.yc()&&c.nd!=h.nd)throw a.g.vk();}else if(null!=h)throw a.g.F();1736==b.G()||197==b.G()?d=b.Gg():a.T.Oc(b.G())?(d=new a.Ua(b.description),d.dc(b,!0)):d=b;b=0;d=d.Fa();for(var l=new a.b,e=new a.b;d.Ya();)for(;d.Ea();){var f=d.ba();f.Oq(l);f.Ps(e);b+=a.b.Cb(l,e)}null!==c&&null!==h&&(b=a.oc.li(b,c,h));return b};b.$Z=function(b,d){return a.Sd.PS(b,d)};b.cG=function(a){return void 0!==a.points?b.kW(a,void 0===
a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM):void 0!==a.rings?b.wH(a.rings,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"P"):void 0!==a.paths?b.wH(a.paths,void 0===a.hasZ?!1:a.hasZ,void 0===a.hasM?!1:a.hasM,"L"):void 0!==a.x?b.uW(a):void 0!==a.xmin?b.cW(a):null};b.uW=function(b){if(null==b.x||"NaN"==b.x)return new a.Wa;var d=new a.Wa(b.x,b.y);void 0!==b.z&&null!==b.z&&d.rY(b.z);void 0!==b.m&&null!==b.m&&d.bY(b.m);return d};b.cW=function(b){if(null==b.xmin||"NaN"==b.xmin)return new a.ci;var d=
new a.ci(b.xmin,b.ymin,b.xmax,b.ymax);void 0!==b.zmin&&null!==b.zmin&&d.setInterval(1,0,b.zmin,b.zmax);void 0!==b.mmin&&null!==b.mmin&&d.setInterval(2,0,b.mmin,b.mmax);return d};b.kW=function(b,d,h){var c=0,l=new a.Ed,e=3*b.points.length;0!=e%2&&e++;2>e&&(e=2);var f=a.J.truncate(3*b.points.length/2);4>f?f=4:16>f&&(f=16);for(var e=a.Uc.Um(e,0),g=a.Uc.Um(f),f=a.Uc.Um(f),k=0;k<b.points.length;k++)e.write(2*k,b.points[k][0]),e.write(2*k+1,b.points[k][1]),g.write(k,d||h?b.points[k][2]:NaN),f.write(k,h&&
d?b.points[k][3]:NaN),c++;0!=c&&(l.resize(c),l.Yn(0,e));d&&(l.Ud(1),l.Yn(1,g));h&&(l.Ud(2),l.Yn(2,0==d?g:f));l.Dc(16777215);return l};b.wH=function(b,d,h,c){var l,e=0,f=2;"P"==c?(l=new a.Ja,e=1,f=3):l=new a.Ua;for(var g=a.Uc.wh(0),r=a.Uc.vq(0),k=0,m=0,q=[],n=[],w=0;w<b.length;w++){var x=b[w].length;q[w]=!1;if("P"===c&&b[w][0][0]===b[w][b[w].length-1][0]&&b[w][0][1]===b[w][b[w].length-1][1]){var p=0==h?!0:b[w][0][3]===b[w][b[w].length-1][3]||void 0===b[w][0][3]&&void 0===b[w][b[w].length-1][3];(0==
d||b[w][0][2]===b[w][b[w].length-1][2]||void 0===b[w][0][2]&&void 0===b[w][b[w].length-1][2])&&p&&(q[w]=!0,--x)}x>=f?(n[w]=!1,m+=1,g.add(k),r.add(e),k+=x):n[w]=!0}c=3*k;0!=c%2&&c++;2>c&&(c=2);w=a.J.truncate(3*k/2);4>w?w=4:16>w&&(w=16);c=a.Uc.Um(c,0);e=a.Uc.Um(w);f=a.Uc.Um(w);for(w=x=0;w<b.length;w++)if(!1===n[w])for(p=0;p<b[w].length;p++){var A=!1;p===b[w].length-1&&!0===q[w]&&(A=!0);A||(c.write(2*x,b[w][p][0]),c.write(2*x+1,b[w][p][1]),e.write(x,d||h?b[w][p][2]:NaN),f.write(x,h&&d?b[w][p][3]:NaN),
x++)}0!=k&&(b=l,g.resize(m),r.resize(m),0<k&&(g.add(k),r.add(0)),b.Yn(0,c),b.GK(r),b.HK(g));d&&(l.Ud(1),l.Yn(1,e));h&&(l.Ud(2),l.Yn(2,0==d?e:f));l.Dc(16777215);return l};return b}();a.cc=b})(D||(D={}));(function(a){var b=function(){function a(){}a.Hm=function(a){var d=0,b,c=a.length,l=a[0],e;for(b=0;b<c-1;b++)e=a[b+1],d+=(e[0]-l[0])*(e[1]+l[1]),l=e;return 0<=d};a.rotate=function(b,d,h){d=d*Math.PI/180;var c=Math.cos(d),l=Math.sin(d);if(void 0!==b.paths){d={paths:[]};for(var e=0;e<b.paths.length;e++){for(var f=
b.paths[e],g=[],k=0;k<f.length;k++){var m=f[k].slice(0);g.push(m);var q=c*(f[k][0]-h.x)-l*(f[k][1]-h.y)+h.x,n=l*(f[k][0]-h.x)+c*(f[k][1]-h.y)+h.y;m[0]=q;m[1]=n}d.paths.push(g)}return d}if(void 0!==b.rings){d={rings:[]};for(e=0;e<b.rings.length;e++){for(var f=b.rings[e],g=[],w=a.Hm(f),k=0;k<f.length;k++)m=f[k].slice(0),g.push(m),q=c*(f[k][0]-h.x)-l*(f[k][1]-h.y)+h.x,n=l*(f[k][0]-h.x)+c*(f[k][1]-h.y)+h.y,m[0]=q,m[1]=n;a.Hm(g)!==w&&g.reverse();d.rings.push(g)}return d}if(void 0!==b.x)return d={x:c*(b.x-
h.x)-l*(b.y-h.y)+h.x,y:l*(b.x-h.x)+c*(b.y-h.y)+h.y},void 0!==b.z&&(d.z=b.z),void 0!==b.m&&(d.m=b.m),d;if(void 0!==b.points){d={points:[]};b=b.points;for(k=0;k<b.length;k++)e=b[k].slice(0),e[0]=c*(b[k][0]-h.x)-l*(b[k][1]-h.y)+h.x,e[1]=l*(b[k][0]-h.x)+c*(b[k][1]-h.y)+h.y,d.points.push(e);return d}return null};a.zG=function(b,d){var h,c;if(void 0!==b.paths){h={paths:[]};for(var l=0;l<b.paths.length;l++){for(var e=b.paths[l],f=[],g=0;g<e.length;g++){var k=e[g].slice(0);f.push(k);c=d.x-e[g][0];k[0]=e[g][0]+
2*c}h.paths.push(f)}return h}if(void 0!==b.rings){h={rings:[]};for(l=0;l<b.rings.length;l++){for(var e=b.rings[l],m=a.Hm(e),f=[],g=0;g<e.length;g++)k=e[g].slice(0),f.push(k),c=d.x-e[g][0],k[0]=e[g][0]+2*c;a.Hm(f)!==m&&f.reverse();h.rings.push(f)}return h}if(void 0!==b.x)return c=d.x-b.x,h={x:b.x+2*c,y:b.y},void 0!==b.z&&(h.z=b.z),void 0!==b.m&&(h.m=b.m),h;if(void 0!==b.points){h={points:[]};l=b.points;for(g=0;g<l.length;g++)e=l[g].slice(0),c=d.x-e[0],e[0]+=2*c,h.points.push(e);return h}return void 0!==
b.xmin?(h={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(h.zmin=b.zmin,h.zmax=b.zmax),void 0!==b.mmin&&(h.mmin=b.mmin,h.mmax=b.mmax),c=d.x-b.xmin,h.xmax=b.xmin+2*c,c=d.x-b.xmax,h.xmin=b.xmax+2*c,h):null};a.AG=function(b,d){var h,c;if(void 0!==b.paths){h={paths:[]};for(var l=0;l<b.paths.length;l++){for(var e=b.paths[l],f=[],g=0;g<e.length;g++){var k=e[g].slice(0);f.push(k);c=d.y-e[g][1];k[1]=e[g][1]+2*c}h.paths.push(f)}return h}if(void 0!==b.rings){h={rings:[]};for(l=0;l<b.rings.length;l++){for(var e=
b.rings[l],m=a.Hm(e),f=[],g=0;g<e.length;g++)k=e[g].slice(0),f.push(k),c=d.y-e[g][1],k[1]=e[g][1]+2*c;a.Hm(f)!==m&&f.reverse();h.rings.push(f)}return h}if(void 0!==b.x)return c=d.y-b.y,h={y:b.y+2*c,x:b.x},void 0!==b.z&&(h.z=b.z),void 0!==b.m&&(h.m=b.m),h;if(void 0!==b.points){h={points:[]};l=b.points;for(g=0;g<l.length;g++)e=l[g].slice(0),c=d.y-e[1],e[1]+=2*c,h.points.push(e);return h}return void 0!==b.xmin?(h={o:b.xmin,A:b.ymin,v:b.xmax,B:b.ymax},void 0!==b.zmin&&(h.zmin=b.zmin,h.zmax=b.zmax),void 0!==
b.mmin&&(h.mmin=b.mmin,h.mmax=b.mmax),c=d.y-b.ymin,h.ymax=b.ymin+2*c,c=d.y-b.ymax,h.ymin=b.ymax+2*c,h):null};return a}();a.Wp=b})(D||(D={}));(function(a){var b=function(){function b(){}b.bh=function(b,d){null==d&&(d=a.ye.Ig());switch(b){case 33:return new a.Wa(d);case 322:return new a.Hb(d);case 197:return new a.ci(d);case 550:return new a.Ed(d);case 1607:return new a.Ua(d);case 1736:return new a.Ja(d);default:throw a.g.X("invalid argument.");}};return b}();a.uM=b})(D||(D={}));(function(a){var b=
function(){function b(b,d){this.tf=a.ia.zd(b,-1);this.va=new a.Lu;this.bm=d}b.prototype.xX=function(a){this.va.pu(Math.min(this.tf.size,a));this.va.Vn(a)};b.prototype.addElement=function(b,d){if(void 0===d)return this.cP(b);d=a.J.truncate(d%this.tf.size);var h=this.tf.get(d);-1==h&&(h=this.va.mi(),this.tf.set(d,h));return this.va.addElement(h,b)};b.prototype.cP=function(b){var d=this.bm.Vz(b),d=a.J.truncate(d%this.tf.size),h=this.tf.get(d);-1==h&&(h=this.va.mi(),this.tf.set(d,h));return this.va.addElement(h,
b)};b.prototype.kd=function(b,d){if(void 0===d)this.GR(b);else{d=a.J.truncate(d%this.tf.size);var h=this.tf.get(d);if(-1==h)throw a.g.F();for(var c=this.va.xc(h),l=-1;-1!=c;){var e=this.va.nb(c);this.va.ja(c)==b?(this.va.kd(h,l,c),-1==this.va.xc(h)&&(this.va.zh(h),this.tf.set(d,-1))):l=c;c=e}}};b.prototype.GR=function(b){var d=this.bm.Vz(b),d=a.J.truncate(d%this.tf.size),h=this.tf.get(d);if(-1==h)throw a.g.F();for(var c=this.va.xc(h),l=-1;-1!=c;){var e=this.va.nb(c);this.va.ja(c)==b?(this.va.kd(h,
l,c),-1==this.va.xc(h)&&(this.va.zh(h),this.tf.set(d,-1))):l=c;c=e}};b.prototype.hT=function(b){b=a.J.truncate(b%this.tf.size);b=this.tf.get(b);return-1==b?-1:this.va.xc(b)};b.prototype.xT=function(a){return this.va.nb(a)};b.prototype.Kd=function(b){var d=this.bm.Vz(this.ja(b)),d=a.J.truncate(d%this.tf.size),h=this.tf.get(d);if(-1==h)throw a.g.F();for(var c=this.va.xc(h),l=-1;-1!=c;){if(c==b){this.va.kd(h,l,c);-1==this.va.xc(h)&&(this.va.zh(h),this.tf.set(d,-1));return}l=c;c=this.va.nb(c)}throw a.g.F();
};b.prototype.ja=function(a){return this.va.ja(a)};b.prototype.clear=function(){this.tf=a.ia.zd(this.tf.size,-1);this.va.clear()};b.prototype.size=function(){return this.va.eH()};return b}();a.EM=b})(D||(D={}));(function(a){var b=function(){function b(){this.kj=new a.ad(3);this.va=new a.ad(6);this.sV=!1;this.Ge=-1}b.prototype.Kl=function(a){this.kj.kd(a)};b.prototype.Bx=function(){return this.kj.Pe()};b.prototype.Pv=function(a){this.va.kd(a)};b.prototype.FB=function(){return this.va.Pe()};b.prototype.uC=
function(a,d){this.kj.P(a,1,d)};b.prototype.Qx=function(a,d){this.kj.P(a,2,d)};b.prototype.aY=function(a,d){this.kj.P(a,3,d)};b.prototype.sC=function(a,d){this.va.P(a,4,d)};b.prototype.dY=function(a,d){this.va.P(a,3,d)};b.prototype.KK=function(a,d){this.va.P(a,2,d)};b.prototype.mi=function(a){var d=this.FB();this.va.P(d,3,this.Ge);this.va.P(d,4,0);this.va.P(d,5,a);-1!=this.Ge&&this.KK(this.Ge,d);return this.Ge=d};b.prototype.zh=function(a){this.QF(a);var d=this.va.S(a,2),b=this.va.S(a,3);-1!=d?this.dY(d,
b):this.Ge=b;-1!=b&&this.KK(b,d);this.Pv(a);return b};b.prototype.pu=function(a){this.va.Qe(a)};b.prototype.$G=function(a){return this.va.S(a,5)};b.prototype.$X=function(a,d){this.va.P(a,5,d)};b.prototype.addElement=function(a,d){return this.oU(a,d)};b.prototype.oU=function(a,d){var b=this.Bx();this.Qx(b,-1);-1==this.va.S(a,0)&&this.va.P(a,0,b);var c=this.va.S(a,1);this.uC(b,c);-1!=c&&this.Qx(c,b);this.va.P(a,1,b);this.setData(b,d);this.sC(a,this.at(a)+1);this.sV&&this.aY(b,a);return b};b.prototype.kd=
function(a,d){var b=this.Ve(d),c=this.nb(d);-1!=b?this.Qx(b,c):this.va.P(a,0,c);-1!=c?this.uC(c,b):this.va.P(a,1,b);this.Kl(d);this.sC(a,this.at(a)-1);return c};b.prototype.Vn=function(a){this.kj.Qe(a)};b.prototype.getData=function(a){return this.kj.S(a,0)};b.prototype.setData=function(a,d){this.kj.P(a,0,d)};b.prototype.nb=function(a){return this.kj.S(a,2)};b.prototype.Ve=function(a){return this.kj.S(a,1)};b.prototype.xc=function(a){return this.va.S(a,0)};b.prototype.Fc=function(a){return this.va.S(a,
1)};b.prototype.clear=function(){for(var a=this.Ge;-1!=a;)a=this.zh(a)};b.prototype.QF=function(a){for(var d=this.Fc(a);-1!=d;){var b=d,d=this.Ve(b);this.Kl(b)}this.va.P(a,0,-1);this.va.P(a,1,-1);this.sC(a,0)};b.prototype.u=function(){return 0==this.kj.size};b.prototype.eH=function(){return this.kj.size};b.prototype.at=function(a){return this.va.S(a,4)};b.prototype.bA=function(a){return this.va.S(a,3)};return b}();a.Xp=b})(D||(D={}));(function(a){var b=function(){function b(b){void 0===b?(this.Qg=
new a.ad(2),this.va=new a.ad(4),this.Ge=-1,this.Cw=!0):(this.Qg=new a.ad(2),this.va=new a.ad(b?4:2),this.Ge=-1,this.Cw=b)}b.prototype.Kl=function(a){this.Qg.kd(a)};b.prototype.Bx=function(){return this.Qg.Pe()};b.prototype.Pv=function(a){this.va.kd(a)};b.prototype.FB=function(){return this.va.Pe()};b.prototype.mi=function(){var a=this.FB();this.Cw&&(this.va.P(a,3,this.Ge),-1!=this.Ge&&this.va.P(this.Ge,2,a),this.Ge=a);return a};b.prototype.zh=function(a){for(var d=this.xc(a);-1!=d;){var b=d,d=this.nb(d);
this.Kl(b)}this.Cw&&(d=this.va.S(a,2),b=this.va.S(a,3),-1!=d?this.va.P(d,3,b):this.Ge=b,-1!=b&&this.va.P(b,2,d));this.Pv(a)};b.prototype.pu=function(a){this.va.Qe(a)};b.prototype.addElement=function(a,d){var b=this.va.S(a,1),c=this.Bx();-1!=b?this.Qg.P(b,1,c):this.va.P(a,0,c);this.va.P(a,1,c);this.Qg.P(c,0,d);return c};b.prototype.Vn=function(a){this.Qg.Qe(a)};b.prototype.kd=function(a,d,b){-1!=d?(this.Qg.P(d,1,this.Qg.S(b,1)),this.va.S(a,1)==b&&this.va.P(a,1,d)):(this.va.P(a,0,this.Qg.S(b,1)),this.va.S(a,
1)==b&&this.va.P(a,1,-1));this.Kl(b)};b.prototype.mz=function(a,d){var b=this.va.S(a,1),c=this.va.S(d,0);-1!=c&&(-1!=b?this.Qg.P(b,1,c):this.va.P(a,0,c),this.va.P(a,1,this.va.S(d,1)));this.Cw&&(b=this.va.S(d,2),c=this.va.S(d,3),-1!=b?this.va.P(b,3,c):this.Ge=c,-1!=c&&this.va.P(c,2,b));this.Pv(d)};b.prototype.ja=function(a){return this.Qg.S(a,0)};b.prototype.kk=function(a,d){this.Qg.P(a,0,d)};b.prototype.nb=function(a){return this.Qg.S(a,1)};b.prototype.xc=function(a){return this.va.S(a,0)};b.prototype.yo=
function(a){return this.ja(this.xc(a))};b.prototype.clear=function(){this.Qg.Vi(!0);this.va.Vi(!0);this.Ge=-1};b.prototype.u=function(a){return void 0===a?0==this.Qg.size:-1==this.va.S(a,0)};b.prototype.eH=function(){return this.Qg.size};b.prototype.bA=function(a){return this.va.S(a,3)};return b}();a.Lu=b})(D||(D={}));(function(a){var b=function(){function b(){}b.ZD=function(c,d,h,e,f,g,k){var l=new a.b;l.L(c);c=new a.b;c.L(d);f.Ny(l);f.Ny(c);d=f.Wu(l);var r=f.Wu(c);0==r&&(r=f.ZG());if(l.x!=c.x&&
(l.y!=c.y||l.y!=f.A&&l.y!=f.B)||r>d!=g){d=f.zE(l);var r=f.zE(c),m,q=g?1:3;do d=d+q&3,m=f.Gx(d),0!=k&&(e=b.ZD(l,m,h,e,f,g,k)),h[e++].ka(m.x,m.y),l=m;while((d&3)!=r);0!=k&&(e=b.ZD(l,c,h,e,f,g,k))}else if(f=new a.b,f.ka(c.x-l.x,c.y-l.y),0!=k&&(k=a.J.truncate(f.RO()/k),0<k))for(f.scale(1/(k+1)),g=0;g<k;g++)l.add(f),h[e++].ka(l.x,l.y);return e};b.be=function(a,d,b){d=d.no();a=null!=a&&void 0!==a.re?a.re(0):0;b&&(d*=4,a*=1.1);return Math.max(a,d)};b.Cs=function(a){return 2*Math.sqrt(2)*a};b.rP=function(a){return Math.sqrt(2)*
a};b.ah=function(c,d,h){var l=new a.h;d.s(l);return b.be(c,l,h)};b.FF=function(a,d,b){d=d.xf(1,0).no();a=null!=a?a.re(1):0;b&&(d*=4,a*=1.1);return Math.max(a,d)};b.a_=function(b,d){var h=new a.h;b.ac(h);h.Nb(d);return h};b.Zv=function(b,d){var h=new a.h;b.ac(h);b=new a.h;d.ac(b);h.Nb(b);return h};b.j_=function(b,d){var h=b.mT(d),c=b.wa(d),l=b.Gc(d),e=b.Ba(h);h==c?(l=b.Ba(l-1),h=b.Ba(c+1)):h==l-1?(l=b.Ba(h-1),h=b.Ba(c)):(l=b.Ba(h-1),h=b.Ba(h+1));e=a.b.zp(l,e,h);return 0==e?0<b.Sm(d):-1==e};b.aQ=function(b){var d=
new a.h;b.ac(d);if(d.u())return null;var h=new a.gq(d,8),c=-1,l=new a.h,e=!1;do for(var f=0,g=b.aa();f<g;f++)if(b.jk(f,l),c=h.lw(f,l,c),-1==c){if(e)throw a.g.X("internal error");b.uo(d,!1);e=!0;h.reset(d,8);break}else e=!1;while(e);return h};b.AF=function(b){var d=new a.h;b.ac(d);for(var h=new a.gq(d,8),c=-1,l=b.Fa(),e=new a.h,f=!1;l.Ya();)for(;l.Ea();){var g=l.ba(),k=l.Db();g.s(e);c=h.lw(k,e,c);if(-1==c){if(f)throw a.g.za();b.uo(d,!1);f=!0;h.reset(d,8);l.yj();break}}return h};b.Lj=function(b,d){var h=
new a.h;b.ac(h);for(var c=new a.gq(h,8),l=-1,e=new a.h,f=b.Fa(),g=!1;f.Ya();)for(;f.Ea();){var k=f.ba(),m=f.Db();k.s(e);if(e.Yb(d)&&(l=c.lw(m,e,l),-1==l)){if(g)throw a.g.X("internal error.");b.uo(h,!1);g=!0;c.reset(h,8);f.yj();break}}return c};b.S_=function(b){var d=new a.h;b.ac(d);for(var h=new a.gq(d,8),c=new a.b,l=new a.h,e=!1,f=0;f<b.D();f++)if(b.w(f,c),l.I(c),-1==h.eh(f,l)){if(e)throw a.g.za();b.uo(d,!1);e=!0;h.reset(d,8);f=-1}return h};b.BF=function(b,d){for(var h=new a.gq(d,8),c=new a.b,l=
!1,e=new a.h,f=0;f<b.D();f++)if(b.w(f,c),d.contains(c)&&(e.I(c),-1==h.eh(f,e))){if(l)throw a.g.za();l=!0;f=new a.h;b.uo(f,!1);h.reset(f,8);f=-1}return h};b.cT=function(b,d,h){var c=new a.h,l=new a.h;b.ac(c);d.ac(l);c.O(h,h);l.O(h,h);var e=new a.h;e.I(c);e.Ma(l);b=b.Fa();d=d.Fa();var f=new a.fD;f.yC(h);var g=!1;for(f.bL();b.Ya();)for(;b.Ea();)b.ba().s(c),c.Yb(e)&&(g=!0,h=new a.h,h.I(c),f.ZE(b.Db(),h));f.tG();if(!g)return null;c=!1;for(f.aL();d.Ya();)for(;d.Ea();)d.ba().s(l),l.Yb(e)&&(c=!0,h=new a.h,
h.I(l),f.VE(d.Db(),h));f.sG();return c?f:null};b.dT=function(b,d,h,c,e){var l=b.G(),f=d.G(),g=new a.h,r=new a.h;b.ac(g);d.ac(r);g.O(h,h);r.O(h,h);var k=new a.h;k.I(g);k.Ma(r);var m=new a.fD;m.yC(h);var q=!1;m.bL();var n=0;for(h=b.aa();n<h;n++)if(!c||1736!=l||b.rw(n))b.jk(n,g),g.Yb(k)&&(q=!0,m.ZE(n,g));m.tG();if(!q)return null;b=!1;m.aL();c=0;for(h=d.aa();c<h;c++)if(!e||1736!=f||d.rw(c))d.jk(c,r),r.Yb(k)&&(b=!0,m.VE(c,r));m.sG();return b?m:null};b.o_=function(a,d){return 0<a.Lk(d)};b.R_=function(b,
d){var h=new a.h;b.hX(d,h);var h=new a.gq(h,8),c=-1,l=new a.h;b=b.Fa();b.eC(d);if(b.Ya())for(;b.Ea();){d=b.ba();var e=b.Db();d.ac(l);c=h.lw(e,l,c);if(-1==c)throw a.g.X("internal error");}return h};b.Fv=function(b,d,h){if(b!=d)for(var c=0;c<h;c++)null==b[c]?b[c]=a.b.El(d[c]):b[c].L(d[c])};b.oz=function(a,d,b,c){var h=0;for(c+=0;h<c;b++,h++)null==a[h]&&(a[h]=[0,0]),a[h][0]=d[b].x,a[h][1]=d[b].y};b.nz=function(b,d,h,c){var l=d,e=0;for(d=c+d;l<d;e++,l++)null==b[l]?b[l]=a.b.pa(h[e][0],h[e][1]):b[l].ka(h[e][0],
h[e][1])};b.jR=function(b,d,h){if(b!=d)for(var c=0;c<h;c++)null==b[c]?b[c]=new a.Wa(d[c]):d[c].copyTo(b[c])};b.EP=function(a,d,b,c){var h=c.ca;c=c.ha;for(var l=0;l<d;l+=b){var e=a.read(l);e<h?a.write(l,h):e>c&&a.write(l,c)}};b.uP=function(a,d,b,c){var h=c.ca;c=c.ha;for(var l=0;l<d;l+=b){var e=a.read(l);e<h?a.write(l,h):e>c&&a.write(l,c)}};b.UK=function(c,d,h){if(c.hasAttribute(h)){var l=c.G();if(a.T.gh(l)){var e=a.ma.si(h),l=a.ma.Xa(h),f=c.D();if(1==e){c=c.Pa(h);b.EP(c,f*l,l,d);return}if(2==e){c=
c.Pa(h);b.uP(c,f*l,l,d);return}throw a.g.X("snap_coordinate not implemented");}if(197==l)f=c.xf(h,0),l=!1,f.ca<d.ca&&(l=!0,f.ca=d.ca),f.ha>d.ha&&(l=!0,f.ha=d.ha),l&&c.setInterval(h,0,f);else if(33==l)f=c.Yc(h,0),l=!1,f<d.ca&&(l=!0,f=d.ca),f>d.ha&&(l=!0,f=d.ha),l&&c.setAttribute(h,0,f);else if(a.T.Oc(l))f=c.dt(h,0),l=!1,f<d.ca&&(l=!0,f=d.ca),f>d.ha&&(l=!0,f=d.ha),l&&c.Tx(h,0,f),f=c.Os(h,0),f<d.ca&&(l=!0,f=d.ca),f>d.ha&&(l=!0,f=d.ha),l&&c.Lx(h,0,f);else throw a.g.X("snap_coordinate not implemented");
}};b.jo=function(a,d,b,c,e){var h=0;null!=d&&(h=d.re(a),e&&!c||null==d||(h+=1.01*d.fA(a)));c&&(b*=4,h*=1.01);return Math.max(h,b)};b.T_=function(c,d,h,e){d=a.h.CO(d.Be(),d.nf(),h.Be(),h.nf());return b.jo(0,c,d,e,!1)};b.Zy=function(a,d,h){d=d.no();return b.jo(0,a,d,h,!1)};b.U_=function(a,d,h){d=d.no();return b.jo(1,a,d,h,!1)};b.gQ=function(c,d){var h=new a.h;d.s(h);return b.Zy(c,h,!0)};b.$y=function(a,d){d=d.no();return b.jo(0,a,d,!1,!0)};b.V_=function(a,d,h){d=d.no();return b.jo(1,a,d,h,!0)};b.vv=
function(c,d){var h=new a.h;d.s(h);return b.$y(c,h)};b.NH=function(b,d,h,c){c*=c;var l=new a.b;l.zc(b,d);b=new a.b;b.zc(h,d);d=l.qk();h=b.qk();if(d<=c&&h<=c)return!0;var e=a.Ub.Yx(l.Ui(b));return e<=c*d||e<=c*h?0<=l.oi(b):!1};b.VK=function(b,d,h,c){for(var l=0;l<d;l++){var e=b[l].y,f=a.J.pk(e,h,c);f!=e&&(b[l].y=f)}};return b}();a.na=b})(D||(D={}));(function(a){var b=function(){function a(a){this.ab=a}a.prototype.compare=function(a,d,b){a=a.ja(b);b=this.ab.Pk(d);var c=this.ab.Pk(a);return b<c?-1:b==
c?h.Vq(d)&&h.tw(a)?-1:h.Vq(a)&&h.tw(d)?1:0:1};return a}(),c=function(){function a(a){this.ab=a}a.prototype.hs=function(a,d,b){this.ab.AY(b,a,d)};a.prototype.Qq=function(a){return this.ab.Pk(a)};return a}(),l;(function(a){a[a.initialize=0]="initialize";a[a.pIn=1]="pIn";a[a.pL=2]="pL";a[a.pR=3]="pR";a[a.pT=4]="pT";a[a.right=5]="right";a[a.left=6]="left";a[a.all=7]="all"})(l||(l={}));var d=function(){function d(){this.ab=null;this.pj=new a.Ac;this.oh=new a.ia(0);this.Og=[0,0]}d.prototype.Ni=function(a,
d){this.pj.ca=a.ca-d;this.pj.ha=a.ha+d;this.oh.resize(0);this.Ee=0;this.Og[0]=0};d.prototype.dC=function(d,b,h){if(d>b)throw a.g.F();this.pj.ca=d-h;this.pj.ha=b+h;this.oh.resize(0);this.Ee=0;this.Og[0]=0};d.prototype.Wn=function(a,d){this.pj.ca=a-d;this.pj.ha=a+d;this.oh.resize(0);this.Ee=0;this.Og[0]=0};d.prototype.next=function(){if(!this.ab.ar)throw a.g.Da();if(0>this.Ee)return-1;for(var d=!0;d;)switch(this.Og[this.Ee]){case 1:d=this.pW();break;case 2:d=this.qW();break;case 3:d=this.rW();break;
case 4:d=this.sW();break;case 5:d=this.CX();break;case 6:d=this.lV();break;case 7:d=this.vP();break;case 0:d=this.qA();break;default:throw a.g.za();}return-1!=this.jh?this.Gq()>>1:-1};d.CZ=function(a,b,h){var c=new d;c.ab=a;c.oh.yb(20);c.Ni(b,h);return c};d.DZ=function(a,b,h){var c=new d;c.ab=a;c.oh.yb(20);c.Wn(b,h);return c};d.pa=function(a){var b=new d;b.ab=a;b.oh.yb(20);b.Ee=-1;return b};d.prototype.qA=function(){this.jh=this.HI=this.lj=this.Sc=-1;if(null!=this.ab.Je&&0<this.ab.Je.size)return this.Og[0]=
1,this.lj=this.ab.Mf,!0;this.Ee=-1;return!1};d.prototype.pW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.jh=this.Ee=-1,!1;var a=this.ab.Hq(this.Sc);if(this.pj.ha<a)return a=this.ab.Ok(this.Sc),this.lj=this.ab.Qj(this.Sc),-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=6),!0;if(a<this.pj.ca)return a=this.ab.Ok(this.Sc),this.lj=this.ab.Nk(this.Sc),-1!=a&&(this.Ei=this.ab.Zs(a),this.Og[++this.Ee]=5),!0;this.Og[this.Ee]=2;this.HI=this.Sc;a=this.ab.Ok(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=
a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);return!0};d.prototype.qW=function(){this.Sc=this.lj;if(-1==this.Sc)return this.Og[this.Ee]=3,this.lj=this.ab.Nk(this.HI),!0;if(this.ab.Hq(this.Sc)<this.pj.ca){var a=this.ab.Ok(this.Sc);this.lj=this.ab.Nk(this.Sc);-1!=a&&(this.Ei=this.ab.Zs(a),this.Og[++this.Ee]=5);return!0}a=this.ab.Ok(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);a=this.ab.Nk(this.Sc);-1!=a&&this.oh.add(a);return!0};d.prototype.rW=function(){this.Sc=
this.lj;if(-1==this.Sc)return this.Og[this.Ee]=4,!0;if(this.pj.ha<this.ab.Hq(this.Sc)){var a=this.ab.Ok(this.Sc);this.lj=this.ab.Qj(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=6);return!0}a=this.ab.Ok(this.Sc);this.lj=this.ab.Nk(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);a=this.ab.Qj(this.Sc);-1!=a&&this.oh.add(a);return!0};d.prototype.sW=function(){if(0==this.oh.size)return this.jh=this.Ee=-1,!1;this.Sc=this.oh.get(this.oh.size-1);this.oh.resize(this.oh.size-1);var a=
this.ab.Ok(this.Sc);-1!=a&&(this.Ei=this.ab.Ol(a),this.Og[++this.Ee]=7);-1!=this.ab.Qj(this.Sc)&&this.oh.add(this.ab.Qj(this.Sc));-1!=this.ab.Nk(this.Sc)&&this.oh.add(this.ab.Nk(this.Sc));return!0};d.prototype.lV=function(){this.jh=this.Ei;if(-1!=this.jh&&h.Vq(this.Gq())&&this.ab.Pk(this.Gq())<=this.pj.ha)return this.Ei=this.dH(),!1;this.Ee--;return!0};d.prototype.CX=function(){this.jh=this.Ei;if(-1!=this.jh&&h.tw(this.Gq())&&this.ab.Pk(this.Gq())>=this.pj.ca)return this.Ei=this.JT(),!1;this.Ee--;
return!0};d.prototype.vP=function(){this.jh=this.Ei;if(-1!=this.jh&&h.Vq(this.Gq()))return this.Ei=this.dH(),!1;this.Ee--;return!0};d.prototype.dH=function(){return this.ab.pg?this.ab.vg.nb(this.jh):this.ab.sj.nb(this.jh)};d.prototype.JT=function(){return this.ab.pg?this.ab.vg.Ve(this.jh):this.ab.sj.Ve(this.jh)};d.prototype.Gq=function(){return this.ab.pg?this.ab.vg.ja(this.jh):this.ab.sj.getData(this.jh)};return d}();a.WZ=d;var h=function(){function h(a){this.on=this.zi=this.vg=this.sj=this.xn=this.ak=
this.Je=this.bk=null;this.pg=a;this.ar=this.Ew=!1}h.prototype.cs=function(){this.ql(!0)};h.prototype.zs=function(d,b){if(!this.Ew)throw a.g.Da();this.bk.push(new a.Ac(d,b))};h.prototype.yq=function(){if(!this.Ew)throw a.g.X("invalid call");this.Ew=!1;this.ar=!0;this.pg||(this.qU(),this.Mw=this.bk.length)};h.prototype.eh=function(d){if(!this.pg||!this.ar)throw a.g.F("invalid call");if(-1==this.Mf){var b=this.bk.length;if(this.RA){var h=new a.ia(0);h.yb(2*b);this.VJ(h);this.zi.yb(2*b);this.zi.resize(0);
this.UJ(h);this.xn.resize(b,-1);this.xn.Zh(-1,0,b);this.RA=!1}else this.xn.Zh(-1,0,b);this.Mf=this.Hv()}b=this.DH(d<<1,this.Mf);h=this.vg.addElement((d<<1)+1,this.hA(b));this.MK(b,h);this.xn.set(d,b);this.Mw++};h.prototype.remove=function(d){if(!this.pg||!this.ar)throw a.g.X("invalid call");var b=this.xn.get(d);if(-1==b)throw a.g.F("the interval does not exist in the interval tree");this.xn.set(d,-1);this.Mw--;var h=this.hA(b),c;c=this.vg.ST(h);this.vg.Kd(this.qT(b),h);this.vg.Kd(this.MT(b),h);d=
this.vg.size(h);0==d&&(this.vg.IR(h),this.PK(c,-1));this.ak.kd(b);for(var h=this.fH(c),l=this.Qj(c),e=this.Nk(c),b=0;!(0<d||c==this.Mf||-1!=l&&-1!=e);)c==this.Qj(h)?-1!=l?(this.rl(h,l),this.mk(l,h),this.rl(c,-1)):-1!=e?(this.rl(h,e),this.mk(e,h),this.tl(c,-1)):this.rl(h,-1):-1!=l?(this.tl(h,l),this.mk(l,h),this.rl(c,-1)):-1!=e?(this.tl(h,e),this.mk(e,h),this.tl(c,-1)):this.tl(h,-1),this.mk(c,-1),b++,c=h,h=this.Ok(c),d=-1!=h?this.vg.size(h):0,l=this.Qj(c),e=this.Nk(c),h=this.fH(c)};h.prototype.reset=
function(){if(!this.pg||!this.ar)throw a.g.F("invalid call");this.ql(!1)};h.prototype.size=function(){return this.Mw};h.prototype.mf=function(){return d.pa(this)};h.prototype.VJ=function(a){for(var d=this.bk.length,b=0;b<2*d;b++)a.add(b);this.BY(a,2*d)};h.prototype.UJ=function(a){for(var d=NaN,b=0;b<a.size;b++){var h=a.get(b),c=this.Pk(h);c!=d&&(this.zi.add(h),d=c)}};h.prototype.qU=function(){var d=this.bk.length,b=new a.ia(0);b.yb(2*d);this.VJ(b);this.zi.yb(2*d);this.zi.resize(0);this.UJ(b);this.ak.Qe(d);
this.sj.Vn(2*d);var h=a.Uc.wh(d);h.Zh(-1,0,d);this.Mf=this.Hv();for(d=0;d<b.size;d++){var c=b.get(d),l=h.get(c>>1);-1!=l?this.MK(l,this.sj.addElement(this.hA(l),c)):(l=this.DH(c,this.Mf),h.set(c>>1,l))}};h.prototype.DH=function(d,b){var h=b,c=b,l,e=-1,f=0,g=this.zi.size-1,r=0,k=d>>1,m=NaN,q=NaN;l=!0;for(var n=this.wT(k),k=this.tT(k);l;){f<g?(r=f+a.J.truncate((g-f)/2),-1==this.Pz(h)&&this.vK(h,this.zi.get(r),this.zi.get(r+1))):-1==this.Pz(h)&&this.vK(h,this.zi.get(f),this.zi.get(f));var w=this.Hq(h);
if(k<w)-1!=b&&(b==h?(c=h,m=w,b=this.Qj(h),-1!=b?q=this.Hq(b):q=NaN):q>w&&(w<m?this.rl(c,h):this.tl(c,h),this.tl(h,b),this.pg&&(this.mk(h,c),this.mk(b,h)),c=h,m=w,b=-1,q=NaN)),g=this.rT(h),-1==g&&(g=this.Hv(),this.YX(h,g)),h=g,g=r;else if(n>w)-1!=b&&(b==h?(c=h,m=w,b=this.Nk(h),-1!=b?q=this.Hq(b):q=NaN):q<w&&(w<m?this.rl(c,h):this.tl(c,h),this.rl(h,b),this.pg&&(this.mk(h,c),this.mk(b,h)),c=h,m=w,b=-1,q=NaN)),f=this.NT(h),-1==f&&(f=this.Hv(),this.iY(h,f)),h=f,f=r+1;else{l=this.Ok(h);-1==l&&(l=this.wR(h),
this.PK(h,l));var y=this.dP(l,d),e=this.uR();this.lY(e,l);this.XX(e,y);h!=b&&(w<m?this.rl(c,h):this.tl(c,h),this.pg&&this.mk(h,c),-1!=b&&(q<w?this.rl(h,b):this.tl(h,b),this.pg&&this.mk(b,h)));l=!1}}return e};h.prototype.Hv=function(){return this.Je.Pe()};h.prototype.wR=function(a){return this.pg?this.vg.Ks(a):this.sj.mi(a)};h.prototype.uR=function(){return this.ak.Pe()};h.prototype.ql=function(d){d?(this.Ew=this.RA=!0,this.ar=!1,null==this.zi?this.zi=a.Uc.wh(0):this.zi.resize(0),null==this.bk?this.bk=
[]:this.bk.length=0):this.RA=!1;this.pg?null==this.xn?(this.xn=a.Uc.wh(0),this.vg=new a.uk,this.vg.Ep(new b(this))):this.vg.clear():null==this.sj?this.sj=new a.Xp:this.sj.clear();null==this.Je?(this.ak=new a.ad(3),this.Je=new a.ad(this.pg?8:7)):(this.ak.Vi(!1),this.Je.Vi(!1));this.Mf=-1;this.Mw=0};h.prototype.vK=function(a,d,b){this.SX(a,d);this.TX(a,b)};h.prototype.Hq=function(a){var d=this.Pz(a);if(-1==d)return NaN;d=this.Pk(d);a=this.Pk(this.YS(a));return d==a?d:.5*(d+a)};h.prototype.SX=function(a,
d){this.Je.P(a,0,d)};h.prototype.TX=function(a,d){this.Je.P(a,1,d)};h.prototype.YX=function(a,d){this.Je.P(a,3,d)};h.prototype.iY=function(a,d){this.Je.P(a,4,d)};h.prototype.PK=function(a,d){this.Je.P(a,2,d)};h.prototype.rl=function(a,d){this.Je.P(a,5,d)};h.prototype.tl=function(a,d){this.Je.P(a,6,d)};h.prototype.mk=function(a,d){this.Je.P(a,7,d)};h.prototype.lY=function(a,d){this.ak.P(a,0,d)};h.prototype.dP=function(a,d){return this.pg?this.vg.addElement(d,a):this.sj.addElement(a,d)};h.prototype.XX=
function(a,d){this.ak.P(a,1,d)};h.prototype.MK=function(a,d){this.ak.P(a,2,d)};h.prototype.Ol=function(a){return this.pg?this.vg.xc(a):this.sj.xc(a)};h.prototype.Zs=function(a){return this.pg?this.vg.Fc(a):this.sj.Fc(a)};h.Vq=function(a){return 0==(a&1)};h.tw=function(a){return 1==(a&1)};h.prototype.Pz=function(a){return this.Je.S(a,0)};h.prototype.YS=function(a){return this.Je.S(a,1)};h.prototype.Ok=function(a){return this.Je.S(a,2)};h.prototype.rT=function(a){return this.Je.S(a,3)};h.prototype.NT=
function(a){return this.Je.S(a,4)};h.prototype.Qj=function(a){return this.Je.S(a,5)};h.prototype.Nk=function(a){return this.Je.S(a,6)};h.prototype.fH=function(a){return this.Je.S(a,7)};h.prototype.hA=function(a){return this.ak.S(a,0)};h.prototype.qT=function(a){return this.ak.S(a,1)};h.prototype.MT=function(a){return this.ak.S(a,2)};h.prototype.wT=function(a){return this.bk[a].ca};h.prototype.tT=function(a){return this.bk[a].ha};h.prototype.BY=function(d,b){null==this.on&&(this.on=new a.Hu);var h=
new c(this);this.on.sort(d,0,b,h)};h.prototype.AY=function(a,d,b){var c=this;a.Gd(d,b,function(a,d){var b=c.Pk(a),l=c.Pk(d);return b<l||b==l&&h.Vq(a)&&h.tw(d)?-1:1})};h.prototype.Pk=function(a){var d=this.bk[a>>1];return h.Vq(a)?d.ca:d.ha};return h}();a.ns=h})(D||(D={}));(function(a){var b=function(){function b(b){if(null==b)throw a.g.X("Invalid arguement");this.Ke=b;var d=b.eT();d.bU()?b.je.UH()?this.Zo=a.di.PannableFold:this.Zo=a.di.Clip:this.Zo=a.di.DontClip;d.cU()?b.He.UH()?this.Dn=a.di.PannableFold:
this.Dn=a.di.Clip:this.Dn=a.di.DontClip;this.pn=d.yv;this.yI=d.uz;b=this.Ke.EI;this.mI=b.et(2147483648);this.Gw=b.et(1073741824)}b.Xg=function(a,d,b){return d.xr.Xg(a,b)};b.gs=function(a,d,b,c){return a.xr.gs(d,b,c)};b.Du=function(a,d,b,c){b=0>b?d.length:b;a=a.xr.gs(d,b,c);if(a==b)return a;for(var h=d=0;h<b;h++){var l=c[h];l.isNaN()||(d<h&&c[d].L(l),d++)}for(;d<b;d++)c[d].$c();return a};b.LC=function(a,d,b,c){return a.xr.LC(d,b,c)};b.iL=function(a,d,b,c){b=0>b?d.length:b;a=a.xr.LC(d,b,c);if(a==b)return a;
for(var h=d=0;h<b;h++){var l=c[h];isNaN(l.x)||(d<h&&c[d].I(l.x,l.y,l.z),d++)}for(;d<b;d++)c[d].dv();return a};b.transform=function(c,d,h,e,f){if(c.Ho())return a.na.jR(e,d,h),h;for(var l=[],g=0,r=0;r<h;){for(var k=Math.min(l.length,h-r),m=r,q=0;m<k;m++,q++)null==l[q]?l[q]=d[m].w():d[m].w(l[q]);var n;n=f?b.Du(c,l,k,l):b.gs(c,l,k,l);for(q=m=0;m<n;m++,q++)null==e[r]&&(e[r]=new a.Wa(d[r])),e[r].rb(l[q]);r+=k;g+=n}return g};b.jL=function(b,d,h){if(0==h)return[];var c=new a.Ed;c.nP(d,2*h);d=this.Xg(c,b,
null);b=d.Pa(0);d=2*d.D();h=a.J.gf(d);b.pl(0,d,h,0,!0);return h};b.prototype.gs=function(b,d,h){if(this.Ke.Ho())return b!=h&&a.na.Fv(h,b,d),d;var c=this.Ke.je,l=this.Ke.He,e=c.Fb(),f=l.Fb();if(0==e&&e===f){var g=c.Yi(),l=l.Yi(),l=g/l,g=new a.Hd;g.Op(l,l);g.ZY(b,d,h);return d}g=a.J.qv(Math.min(d,64));if(3==e){var k;k=c.ij;c=k.Gk();e=c.Fb();h!=b&&a.na.Fv(h,b,d);a.Ib.Dl(k,h,d,!0);k.Du(a.Om.forward,h,d);a.Ib.Cl(k,h,d,!0)}if(3==e||3===f)throw a.g.X("image: transform_in_place_");if(2==e)this.Zo==a.di.Clip?
(h!=b&&a.na.Fv(h,b,d),b=c.Mk(),a.Ib.JU(b,c,h,d)):(h!=b&&a.na.Fv(h,b,d),c.Jc()&&(e=c.re(0),k=c.qe(),a.Ib.yY(h,d,k,e),a.Ib.BG(h,d,c,0))),a.Ib.wN(c,h,d,g);else for(e=c.re(0),k=c.qe(),c=0;c<d;c++)a.Ib.zY(b[c],k,e,h[c]);a.Ib.uN(this.Ke,h,d,g);b=0;(f=2==f)?b=l.pi():isNaN(this.pn)||(b=this.pn);f&&this.Dn!=a.di.Clip||a.Ib.BG(h,d,l.kc(),b);f&&(a.Ib.LH(h,d,l,this.Dn),a.Ib.vN(l,h,d,g));b=d;for(c=0;c<d;++c)h[c].isNaN()&&b--;return b};b.prototype.LC=function(b,d,h){d=0>d?b.length:d;if(this.Ke.Ho()){for(var c=
0;c<d;++c)null==h[c]&&(h[c]=new a.qd),h[c].I(b[c].x,b[c].y,b[c].z);return d}var l=this.Ke.je,c=this.Ke.He,e=l.Fb(),f=c.Fb();if(0==e&&e==f)return l=l.Yi(),c=c.Yi(),c=l/c,l=new a.eO,l.Op(c,c,c),l.transform(b,d,h),d;e=new a.Ed;e.Ud(1);e.Ud(3);e.mP(b);b=e.Pa(3);c=0;for(l=d;c<l;c++)b.write(c,c);e=this.Xg(e,null);for(c=0;c<d;++c)null==h[c]?h[c]=a.qd.pa(NaN,NaN,NaN):h[c].dv();if(null==e)return 0;b=e.Pa(3);var f=e.Pa(0),g=e.Pa(1);e.fX(h,d);c=0;for(l=e.D();c<l;c++)d=b.read(c),f.oX(2*c,h[d]),h[d].z=g.read(c);
return e.D()};b.prototype.Xg=function(b,d){if(this.Ke.Ho()||b.u())return b;if(33==b.G())return this.PJ(b);var h=this.Ke.je,c=this.Ke.He,l=h.Fb(),e=c.Fb();if(0==l&&l==e)return h=h.Yi(),c=c.Yi(),h/=c,c=new a.Hd,c.Op(h,h),h=a.T.oe(b),h.Xc(c),h;switch(b.G()){case 1607:case 1736:c=this.NJ(b,d);break;case 550:c=this.WW(b,d);break;case 197:c=this.VW(b,d);break;default:throw a.g.X("");}return c};b.prototype.PJ=function(b){var d=b.w(),h=[];h[0]=d;this.gs(h,1,h);b=new a.Wa(b);b.rb(h[0]);return b};b.prototype.NJ=
function(b,d){if(b.hn())throw a.g.X("curves not supported");var h=b.G();if(1736==h)return this.XW(b,d);if(1607==h)return this.YW(b,d);throw a.g.X("projectMultiPath");};b.prototype.XW=function(c,d){var h=this.Ke.je,l=this.Ke.He,e=h.Fb(),f=l.Fb(),g=a.J.qv(Math.min(c.D(),64));c=a.Ja.oe(c);if(3==e){var k=h.ij,h=k.Gk(),e=h.Fb();c=k.Dl(c,!0);this.qq(k,a.Om.forward,c);c=k.Cl(c,!0)}k=null;3==f&&(k=l.ij,l=k.Gk(),f=l.Fb());var m=2==e,q=2==f,n=q?l.kc():l,w=!q&&!this.Gw,f=!1,x=c;if(m){if(x=a.Ib.MJ(x,h,this.Zo,
d),x.u())return x}else{c=new a.h;x.ac(c);e=h.qe();if(c.A<e.A||c.B>e.B){var p=a.h.pa(c.o-1,e.A,c.v+1,e.B),x=a.uh.rq(x,p,h,NaN,0,d);if(x.u())return x}c.N()>2*e.N()&&(x=a.Ib.Aq(x,-2*e.N(),2*e.N(),h,!0,0,!0,d))}c=this.yI;(e=!isNaN(c))&&(x=a.Jm.local().V(x,c,d));var p=q?l.Sj():null,u=NaN;m&&(u=h.pi());var A=null!=l.Ws();if(this.mI)m&&(a.Ib.qs(h,u,x,g),e&&(m=h.Ch(),u=h.kc().Ch(),c*=u/m)),a.Ib.ps(this.Ke,x,w,g),e&&(m=h.kc().Ch(),u=l.kc().Ch(),c*=u/m),h=x;else{var B=new a.Ua(x.description);B.UE(x);m&&(a.Ib.qs(h,
u,B,g),e&&(m=h.Ch(),u=h.kc().Ch(),c*=u/m));a.Ib.ps(this.Ke,B,w,g);e&&(m=h.kc().bn(),u=l.kc().bn(),c*=u/m);w=NaN;q?(p=l.Sj(),w=l.pi()):isNaN(this.pn)||(w=this.pn);m=b.se(h)|b.se(l);u=10*n.re(0);this.Gw&&(m=3,u=0);h=a.Ib.KS(x,h,B,n,w,d,m,u)}A&&(h=a.Ib.jF(h,l,d));q&&(f||(q=n.qe().N(),h.xf(0,0).N()>=q-n.re(0)&&(n=p.getNorthPoleLocation(),q=p.getSouthPoleLocation(),x=p.getNorthPoleGeometry(),p=p.getSouthPoleGeometry(),w=0,x==a.Bg.PE_POLE_POINT&&n!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(w=1),p==a.Bg.PE_POLE_POINT&&
q!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(w|=2),0!==w&&(f=!0))),h=a.Ib.tA(h,l,this.Dn,d),e&&(h=a.Jm.local().V(h,c,d)),a.Ib.vy(l,h,g));if(h.u())return h;f&&(h=a.Km.local().V(h,l,!1,d));null!=k&&(h=k.Cl(h,!1),this.qq(k,a.Om.reverse,h),h=k.Dl(h,!1));return h};b.se=function(b){if(2!=b.Fb())return 0;var d=0,h=b.Sj();b=h.getNorthPoleLocation();var c=h.getSouthPoleLocation(),l=h.getNorthPoleGeometry(),h=h.getSouthPoleGeometry();l==a.Bg.PE_POLE_POINT&&b!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(d=1);h==a.Bg.PE_POLE_POINT&&
c!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY&&(d|=2);return d};b.prototype.YW=function(c,d){var h=this.Ke.je,l=this.Ke.He,e=h.Fb(),f=l.Fb(),g=a.J.qv(Math.min(c.D(),64));c=a.Ua.oe(c);if(3==e){var k=h.ij,h=k.Gk(),e=h.Fb();c=k.Dl(c,!0);this.qq(k,a.Om.forward,c);c=k.Cl(c,!0)}k=null;3==f&&(k=l.ij,l=k.Gk(),f=l.Fb());var m=2==e,e=(f=2==f)?l.kc():l,q=!f&&!this.Gw;if(m){if(c=a.Ib.MJ(c,h,this.Zo,d),c.u())return c}else{var n=new a.h;c.ac(n);var w=h.qe();if(n.A<w.A||n.B>w.B)if(n=a.h.pa(n.o-1,w.A,n.v+1,w.B),c=a.uh.rq(c,n,
h,NaN,0,d),c.u())return c}var x=NaN;m&&(x=h.pi());var n=null!=l.Ws(),w=this.yI,p=!isNaN(w);p&&(c=a.Jm.local().V(c,w,d));if(this.mI)m&&a.Ib.qs(h,x,c,g),p&&(m=h.Ch(),x=h.kc().Ch(),w*=x/m),a.Ib.ps(this.Ke,c,q,g),p&&(m=h.kc().Ch(),x=l.kc().Ch(),w*=x/m),h=c;else{var u=new a.Ua(c.description);u.UE(c);m&&(a.Ib.qs(h,x,u,g),p&&(m=h.Ch(),x=h.kc().Ch(),w*=x/m));a.Ib.ps(this.Ke,u,q,g);p&&(m=h.kc().Ch(),x=l.kc().Ch(),w*=x/m);q=NaN;f?q=l.pi():isNaN(this.pn)||(q=this.pn);m=b.se(h)|b.se(l);x=10*e.re(0);this.Gw&&
(m=3,x=0);h=a.Ib.LS(c,h,u,e,q,d,m,x)}n&&(h=a.Ib.jF(h,l,d));f&&(h=a.Ib.tA(h,l,this.Dn,d),p&&(h=a.Jm.local().V(h,w,d)),a.Ib.vy(l,h,g));if(h.u())return h;null!=k&&(h=k.Cl(h,!1),this.qq(k,a.Om.reverse,h),h=k.Dl(h,!1));return h};b.prototype.VW=function(b,d){var h=(b.fa()+b.N())/400;if(0!=h){var c=a.Jm.local().V(b,h,d),c=this.NJ(c,d),h=b.Ka();c.Qn(h)}else h=new a.Wa(b.Bq()),c=this.PJ(h),h=b.Ka(),c.u()?h.Oa():(b.copyTo(h),c=c.w(),h.I(c.x,c.y,c.x,c.y));return h};b.prototype.WW=function(b,d){b=a.T.oe(b);var h=
this.Ke.je,c=this.Ke.He,l=h.Fb(),e=c.Fb(),f=a.J.qv(Math.min(b.D(),64));if(3==l){var g=h.ij,h=g.Gk(),l=h.Fb();b=g.Cl(b,!0);this.qq(g,a.Om.forward,b);b=g.Dl(b,!0)}if(2==l){this.Zo==a.di.Clip?b=a.tk.local().V(b,h.Mk(),h,d):h.Jc()&&(l=new a.h,b.ac(l),h.qe().contains(l)||(this.Zo==a.di.PannableFold&&(b=a.Ib.Mj(b,h)),a.Ib.xu(b,h.qe(),h.re(0),!0),b=a.Ib.Xm(b,h,0,!0,0,d)));if(b.u())return b;a.Ib.qs(h,0,b,f)}else a.Ib.xu(b,h.qe(),h.re(0),!0);a.Ib.ps(this.Ke,b,!1,f);h=0;l=!1;g=null;3==e&&(l=!0,g=c.ij,c=g.Gk(),
e=c.Fb());(e=2==e)?h=c.pi():isNaN(this.pn)||(h=this.pn);e&&this.Dn!=a.di.Clip||(b=a.Ib.Xm(b,c.kc(),h,!1,0,d));if(e&&(b=a.Ib.tA(b,c,this.Dn,d),a.Ib.vy(c,b,f),b.u()))return b;l&&(b=g.Cl(b,!0),this.qq(g,a.Om.reverse,b),b=g.Dl(b,!0));return b};b.prototype.qq=function(b,d,h){var c=h.D();if(0!=c){for(var l=h.Pa(0),e=a.J.gf(200,0),f=[],g=0;g<c;){var k=Math.min(100,c-g);l.pl(2*g,2*k,e,2,!0);for(var m=0;m<k;++m)f[m]=a.b.pa(e[2*g],e[2*g+1]);b.Du(d,f,k);g+=k}h.Dc(1993)}};b.rk=function(b,d,h){if(null==b||null==
d||!d.Jc())throw a.g.X("Invalid Arguement");if(b.u())return b;var c;c=b.G();197==c?(c=new a.Ja(b.description),c.jd(b,!1)):a.T.Oc(c)?(c=new a.Ua(b.description),c.dc(b,!0)):c=b;c=a.Ib.Mj(c,d);return c.u()?c:a.Ib.Xm(c,d,0,c!=b,0,h)};b.Nj=function(c,d,h,e){if(null==c||null==d||!d.Jc())throw a.g.X("Invalid Arguement");if(c.u())return c;var l=c.G();if(a.T.Ic(l)){c=a.Ib.Mj(c,d);l=new a.h;c.s(l);for(var f=a.na.Zy(d,l,!1),g=d.Bh(),k=Math.floor((l.o-g.o)/g.N())*g.N()+g.o;k<l.v;)k>l.o+f&&k<l.v-f&&(c=a.Ib.pU(c,
d,h,k)),k+=g.N()}else{if(197==l)return l=new a.Ja(c.description),l.jd(c,!1),b.Nj(l,d,h,e);if(a.T.Oc(l))return l=new a.Ua(c.description),l.dc(c,!0),b.Nj(l,d,h,e)}return b.rk(c,d,e)};b.Yp=function(c,d,h,e){var l=d.Fb(),f=new a.eE;d.iX(f);if(0==l)return b.Dj(c,f,d,h);e==a.Up.foldAndClipWithHorizon&&d.Jc()&&(c=b.rk(c,d,h));c=b.Dj(c,f,d,h);if(e==a.Up.clipToDomainOnly||c.u())return c;if(1==l)return e==a.Up.clipWithHorizon?(e=new a.h,c.ac(e),l=d.qe(),f=.01*l.N(),e.A=l.A,e.B=l.B,e.o-=f,e.v+=f,a.uh.rq(c,e,
d,NaN,0,h)):c;if(2==l)return l=d.Mk(),e==a.Up.clipWithHorizon||e==a.Up.foldAndClipWithHorizon?(d=a.tk.local().V(c,l,d,h),d==l?a.T.oe(d):d):c;if(3==l)return c;throw a.g.X("missing implementation");};b.Dj=function(b,d,h,c){var l=d.WT(),e=b.hasAttribute(1),f=b.hasAttribute(2),g=new a.Ac;g.Oa();var k=new a.Ac;k.Oa();e&&(g=d.XT());f&&(k=d.sT());d=a.uh.rq(b,l,h,NaN,0,c);e&&(e=d.xf(1,0),g.contains(e)||(b==d&&(d=a.T.oe(d)),a.na.UK(d,g,1)));f&&(e=d.xf(2,0),k.contains(e)||(b==d&&(d=a.T.oe(d)),a.na.UK(d,k,2)));
return d};return b}();a.ko=b})(D||(D={}));(function(a){var b=function(b){function c(d,h,c,l){b.call(this);void 0===d?this.description=a.ye.Ig():void 0===c?this.description=d:(this.description=a.ye.Ig(),this.wC(d,h),this.vm(c,l))}F(c,b);c.prototype.G=function(){return 322};c.prototype.Rb=function(){var a=this.ua-this.sa,b=this.ra-this.oa;return Math.sqrt(a*a+b*b)};c.prototype.fh=function(a){var d=this.ua-this.sa,b=this.ra-this.oa;return Math.sqrt(d*d+b*b)<=a};c.prototype.Go=function(){return!1};c.prototype.Eg=
function(){var d=new a.b;d.zc(this.Cc(),this.ec());return d};c.fR=function(a,b){return new c(a.x,a.y,b.x,b.y)};c.prototype.Qn=function(d){d.Oa();d.Fg(this.description);var b=new a.h;this.s(b);d.Gp(b);for(var b=1,c=this.description.Ga;b<c;b++)for(var l=this.description.rd(b),e=a.ma.Xa(l);b<e;b++){var f=this.xf(l,0);d.setInterval(l,0,f)}};c.prototype.s=function(a){a.I(this.ua,this.ra,this.sa,this.oa);a.normalize()};c.prototype.Cp=function(a){a.Oa();a.Nb(this.ua,this.ra,this.ae(0,1,0));a.Nb(this.sa,
this.oa,this.ae(1,1,0))};c.prototype.Xc=function(d){if(d instanceof a.Hd){this.Bc();var b=new a.b;b.x=this.ua;b.y=this.ra;d.$h(b,b);this.ua=b.x;this.ra=b.y;b.x=this.sa;b.y=this.oa;d.$h(b,b);this.sa=b.x;this.oa=b.y}else this.Bc(),b=new a.qd,b.x=this.ua,b.y=this.ra,b.z=this.ae(0,1,0),b=d.Rp(b),this.ua=b.x,this.ra=b.y,this.oo(0,1,0,b.z),b.x=this.sa,b.y=this.oa,b.z=this.ae(1,1,0),b=d.Rp(b),this.sa=b.x,this.oa=b.y,this.oo(1,1,0,b.z)};c.prototype.Ka=function(){return new c(this.description)};c.prototype.Cy=
function(a,b){return(this.sa-a-(this.ua-a))*(this.oa-b+(this.ra-b))*.5};c.prototype.cy=function(a){return a*this.Rb()};c.prototype.bI=function(a){return a/this.Rb()};c.prototype.PG=function(d){return a.Ub.Xq(this.ua,this.sa,d)};c.prototype.XS=function(d){return a.Ub.Xq(this.ra,this.oa,d)};c.prototype.Hl=function(d,b){var h=new a.Cg;this.yh(d,b,h);return h.get()};c.prototype.yh=function(d,b,c){if(null==c)throw a.g.F();c.Js();c=c.get();c.Fg(this.description);var h=new a.b;this.gc(d,h);c.wC(h.x,h.y);
this.gc(b,h);c.vm(h.x,h.y);for(var h=1,l=this.description.Ga;h<l;h++)for(var e=this.description.Td(h),f=a.ma.Xa(e),g=0;g<f;g++){var k=this.Yc(d,e,g);c.Tx(e,g,k);k=this.Yc(b,e,g);c.Lx(e,g,k)}};c.prototype.Yc=function(d,b,c){if(0==b)return 0==c?this.gc(d).x:this.gc(d).y;switch(a.ma.Wz(b)){case 0:return.5>d?this.dt(b,c):this.Os(b,c);case 1:var h=this.dt(b,c);b=this.Os(b,c);return a.Ub.Xq(h,b,d);case 2:throw a.g.X("not implemented");}throw a.g.za();};c.prototype.pe=function(a,b){var d=this.sa-this.ua,
h=this.oa-this.ra,c=d*d+h*h;if(0==c)return.5;d=((a.x-this.ua)*d+(a.y-this.ra)*h)/c;b||(0>d?d=0:1<d&&(d=1));return d};c.prototype.Tq=function(a,b,c,l){if(a){a=this.oa-this.ra;if(0==a)return b==this.oa?-1:0;b=(b-this.ra)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.PG(b))}else{a=this.sa-this.ua;if(0==a)return b==this.sa?-1:0;b=(b-this.ua)/a;if(0>b||1<b)return 0;null!=c&&(c[0]=this.XS(b))}null!=l&&(l[0]=b);return 1};c.prototype.pf=function(a,b){var d=this.oa-this.ra;if(0==d)return a==this.oa?b:NaN;d=(a-
this.ra)/d;a=this.PG(d);1==d&&(a=this.sa);return a};c.prototype.av=function(a,b,c){return 0<=this.lq(a.x,a.y,b,c)};c.prototype.Si=function(a,b,c){return 0<=this.lq(a,b,c,!0)};c.prototype.mt=function(a,b){return this.av(a,b,!1)};c.prototype.BJ=function(){if(this.oa<this.ra||this.oa==this.ra&&this.sa<this.ua){var a=this.ua;this.ua=this.sa;this.sa=a;a=this.ra;this.ra=this.oa;this.oa=a;for(var a=0,b=this.description.Er-2;a<b;a++){var c=this.la[a];this.la[a]=this.la[a+b];this.la[a+b]=c}}};c.prototype.ev=
function(d,b){d=a.b.pa(d,b);d.sub(this.ec());b=new a.b;b.zc(this.Cc(),this.ec());var h=b.Ui(d);d=8.881784197001252E-16*(Math.abs(b.x*d.y)+Math.abs(b.y*d.x));return h>d?-1:h<-d?1:0};c.prototype.lq=function(d,b,c,l){var h=this.ua,e=this.ra,f=d-h,g=b-e,f=Math.sqrt(f*f+g*g);if(f<=Math.max(c,6.661338147750939E-16*f))return l&&0==f?NaN:0;f=d-this.sa;g=b-this.oa;f=Math.sqrt(f*f+g*g);if(f<=Math.max(c,6.661338147750939E-16*f))return l&&0==f?NaN:1;f=this.sa-this.ua;g=this.oa-this.ra;l=Math.sqrt(f*f+g*g);if(0<
l){var k=1/l,f=f*k,g=g*k,r=d-h,m=b-e,q=r*f+m*g,n=1.7763568394002505E-15*(Math.abs(r*f)+Math.abs(m*g)),w=f,f=-g,g=w,n=Math.max(c,n);if(q<-n||q>l+n)return NaN;if(Math.abs(r*f+m*g)<=Math.max(c,1.7763568394002505E-15*(Math.abs(r*f)+Math.abs(m*g)))&&(f=a.J.pk(q*k,0,1),.5>=f?(g=this.ua+(this.sa-this.ua)*f,l=this.ra+(this.oa-this.ra)*f):(g=this.sa-(this.sa-this.ua)*(1-f),l=this.oa-(this.oa-this.ra)*(1-f)),a.b.xz(g,l,d,b)<=c)){if(.5>f){if(a.b.xz(g,l,h,e)<=c)return 0}else if(a.b.xz(g,l,this.sa,this.oa)<=c)return 1;
return f}}return NaN};c.prototype.Eb=function(a){return null==a?!1:a==this?!0:a.constructor!==this.constructor?!1:this.MO(a)};c.prototype.IE=function(d,b,c){var h=c?this.ua:this.sa;c=c?this.ra:this.oa;var l=new a.b;l.x=d.sa-h;l.y=d.oa-c;return b.oi(l)>6.661338147750939E-16*b.yE(l)?(l.x=d.ua-h,l.y=d.ra-c,b.oi(l)<=6.661338147750939E-16*b.yE(l)):!0};c.prototype.HE=function(d){var b=new a.b;b.x=this.sa-this.ua;b.y=this.oa-this.ra;if(!this.IE(d,b,!1))return!1;b.Lr();return this.IE(d,b,!0)?!0:!1};c.We=
function(a,b){var d=a.ev(b.ua,b.ra),h=a.ev(b.sa,b.oa);if(0>d&&0>h||0<d&&0<h)return!1;d=b.ev(a.ua,a.ra);h=b.ev(a.sa,a.oa);if(0>d&&0>h||0<d&&0<h)return!1;d=a.Rb();h=b.Rb();return d>h?a.HE(b):b.HE(a)};c.se=function(d,b,c){var h=a.b.pa(NaN,NaN),l=d.sa-d.ua,e=d.oa-d.ra,f=b.sa-b.ua,g=b.oa-b.ra,k=f*e-l*g;if(0==k)return h;var r=8.881784197001252E-16*(Math.abs(f*e)+Math.abs(l*g)),m=b.ua-d.ua,q=b.ra-d.ra,n=f*q-m*g,w=n/k,x=Math.abs(k),f=(8.881784197001252E-16*(Math.abs(f*q)+Math.abs(m*g))*x+r*Math.abs(n))/(k*
k)+2.220446049250313E-16*Math.abs(w);if(w<-f||w>1+f)return h;g=l*q-m*e;f=g/k;l=(8.881784197001252E-16*(Math.abs(l*q)+Math.abs(m*e))*x+r*Math.abs(g))/(k*k)+2.220446049250313E-16*Math.abs(f);if(f<-l||f>1+l)return h;w=a.J.pk(w,0,1);l=a.J.pk(f,0,1);e=d.gc(w);k=b.gc(l);r=new a.b;r.zc(e,k);if(r.length()>c&&(r.add(e,k),r.scale(.5),w=d.pe(r,!1),l=b.pe(r,!1),d=d.gc(w),b=b.gc(l),d.sub(b),d.length()>c))return h;h.ka(w,l);return h};c.QO=function(a,b,l,e){var d=0;if(a.ua==b.ua&&a.ra==b.ra||a.ua==b.sa&&a.ra==b.oa)if(d++,
!e)return 1;if(a.sa==b.ua&&a.oa==b.ra||a.sa==b.sa&&a.oa==b.oa){d++;if(2==d)return 2;if(!e)return 1}return b.Si(a.ua,a.ra,l)||b.Si(a.sa,a.oa,l)||a.Si(b.ua,b.ra,l)||a.Si(b.sa,b.oa,l)?1:e&&0!=d?0:0==c.We(a,b)?0:1};c.Gy=function(d,b,l,e,f,g){var h=0,k=d.lq(b.ua,b.ra,g,!1),r=d.lq(b.sa,b.oa,g,!1),m=b.lq(d.ua,d.ra,g,!1),q=b.lq(d.sa,d.oa,g,!1);isNaN(k)||(null!=e&&(e[h]=k),null!=f&&(f[h]=0),null!=l&&(l[h]=a.b.pa(b.ua,b.ra)),h++);isNaN(r)||(null!=e&&(e[h]=r),null!=f&&(f[h]=1),null!=l&&(l[h]=a.b.pa(b.sa,b.oa)),
h++);2==h||isNaN(m)||0==k&&0==m||0==r&&1==m||(null!=e&&(e[h]=0),null!=f&&(f[h]=m),null!=l&&(l[h]=a.b.pa(d.ua,d.ra)),h++);2==h||isNaN(q)||1==k&&0==q||1==r&&1==q||(null!=e&&(e[h]=1),null!=f&&(f[h]=q),null!=l&&(l[h]=a.b.pa(b.sa,b.oa)),h++);if(0<h)return 2==h&&null!=e&&e[0]>e[1]&&(d=e[0],e[0]=e[1],e[1]=d,null!=f&&(e=f[0],f[0]=f[1],f[1]=e),null!=l&&(f=a.b.pa(l[0].x,l[0].y),l[0]=l[1],l[1]=f)),h;h=c.se(d,b,g);if(isNaN(h.x))return 0;null!=l&&(l[0]=d.gc(h.x));null!=e&&(e[0]=h.x);null!=f&&(f[0]=h.y);return 1};
c.prototype.qH=function(){return 0};c.prototype.iq=function(){};c.prototype.toString=function(){return"Line: ["+this.ua.toString()+", "+this.ra.toString()+", "+this.sa.toString()+", "+this.oa.toString()+"]"};return c}(a.cE);a.Hb=b})(D||(D={}));(function(a){var b=function(){function a(){this.am=[];this.Ca=-1}a.prototype.Ia=function(){return this.Ca};a.prototype.next=function(){if(null!=this.am&&0!=this.am.length){this.Ca++;var a=this.am[0];1>=this.am.length?this.am=[]:this.am=this.am.slice(1);return a}return this.am=
null};a.prototype.SY=function(a){this.am.push(a)};a.prototype.Re=function(){return!0};return a}();a.QM=b})(D||(D={}));(function(a){(function(a){a[a.enumFillRuleOddEven=0]="enumFillRuleOddEven";a[a.enumFillRuleWinding=1]="enumFillRuleWinding"})(a.IN||(a.IN={}));var b=function(b){function c(d,h){b.call(this);this.$f=!1;this.ur=null;this.gr=this.hr=0;this.bj=null;this.hh=!1;this.Xd=this.tj=this.cf=this.jb=this.kb=null;this.mr=this.Ta=this.ir=0;if(void 0===h)this.$f=d,this.hh=!1,this.qa=this.gr=this.hr=
this.ir=0,this.description=a.ye.Ig();else{if(null==h)throw a.g.F();this.$f=d;this.hh=!1;this.qa=this.gr=this.hr=this.ir=0;this.description=h}this.bj=null;this.Ta=0}F(c,b);c.prototype.hn=function(){return 0<this.ir};c.prototype.Fy=function(){this.Bc();null==this.ur?this.ur=new a.Wa(this.description):this.ur.Fg(this.description)};c.prototype.$x=function(d,b){var h=new a.b;h.x=d;h.y=b;this.zu(h)};c.prototype.zu=function(a){this.Fy();this.ur.rb(a);this.hh=!0};c.prototype.Rf=function(d){if(d.u())throw a.g.F();
this.om(d.description);this.Fy();d.copyTo(this.ur);this.hh=!0};c.prototype.By=function(){var d=1;this.hh&&(this.Fy(),null==this.kb?(this.kb=a.Uc.wh(2),this.kb.write(0,0),this.jb=a.Uc.vq(2,0)):(this.kb.resize(this.kb.size+1,0),this.jb.resize(this.jb.size+1,0)),this.$f&&this.jb.write(this.jb.size-2,1),d++);var b=this.qa;this.kb.write(this.kb.size-1,this.qa+d);this.zl(b+d);this.jb.write(this.kb.size-1,0);this.hh&&(this.vu(b,this.ur),this.hh=!1)};c.prototype.Xj=function(a,b){this.By();this.rb(this.qa-
1,a,b)};c.prototype.aj=function(a){this.By();this.rb(this.qa-1,a)};c.prototype.lineTo=function(a){this.By();this.vu(this.qa-1,a)};c.prototype.nW=function(d){this.Bc();if(this.$f)throw a.g.za();var b=this.aa();if(d>b)throw a.g.za();if(this.Qb(d)){if(null==this.jb)throw a.g.za();var c=this.qa,e=this.wa(d),l=this.Gc(d);this.zl(this.qa+1);this.wc();for(var f=0,g=this.description.Ga;f<g;f++)if(null!=this.ya[f]){var k=a.ma.Xa(this.description.Td(f));this.ya[f].Rk(k*l,this.ya[f],k*e,k,!0,1,k*c)}for(;b>d;b--)c=
this.kb.read(b),this.kb.write(b,c+1);this.jb.fz(d,1)}};c.prototype.sq=function(){var a;this.Cu();void 0===a&&(this.hh=!1,a=this.aa()-1);var b=this.jb.read(a);this.jb.write(a,b|1);null!=this.cf&&(a=this.Gc(a)-1,this.cf.write(a,1),this.tj.write(a,-1))};c.Dj=function(a){return c.se[a]};c.prototype.Qb=function(a){return 0!=(this.jb.read(a)&1)};c.prototype.Eo=function(a){if(this.Qb(a))return!0;var d=this.wa(a);a=this.Gc(a)-1;if(d>a)return!1;d=this.Ba(d);a=this.Ba(a);return d.ub(a)};c.prototype.ft=function(a){return 0!=
(this.jb.read(a)&2)};c.prototype.dc=function(d,b){this.om(d.description);if(322==d.G()){var h=new a.Wa;if(b||this.u())d.Dp(h),this.Rf(h);d.Bp(h);this.lineTo(h)}else throw a.g.za();};c.prototype.oq=function(a){var d=0==this.qa;this.$x(a.o,a.A);this.Xj(a.o,a.B);this.Xj(a.v,a.B);this.Xj(a.v,a.A);this.sq();this.hh=!1;d&&this.lg(256,!1)};c.prototype.jd=function(d,b){if(!d.u()){for(var h=0==this.qa,c=new a.Wa(this.description),e=0;4>e;e++)d.ig(b?4-e-1:e,c),0==e?this.Rf(c):this.lineTo(c);this.sq();this.hh=
!1;h&&!b&&this.lg(256,!1)}};c.prototype.add=function(a,b){for(var d=0;d<a.aa();d++)this.Ti(a,d,!b)};c.prototype.Ti=function(a,b,c){this.Yf(-1,a,b,c)};c.prototype.Bl=function(a,b){this.rA(a,b)};c.prototype.Bs=function(d,b,c,e,l){l||0!=this.aa()||(l=!0);0>b&&(b=d.aa()-1);if(b>=d.aa()||0>c||0>e||e>d.ew(b))throw a.g.X("index out of bounds");if(0!=e){var h=d.Qb(b)&&c+e==d.ew(b);if(!h||1!=e){this.hh=!1;this.om(d.description);c=d.wa(b)+c+1;l&&(e++,c--);h&&e--;h=this.qa;this.zl(this.qa+e);this.wc();if(l){if(0==
e)return;this.kb.add(this.qa);l=d.jb.read(b);l&=-5;this.$f&&(l|=1);this.jb.write(this.jb.size-1,l);this.jb.add(0)}else this.kb.write(this.jb.size-1,this.qa);l=0;for(var f=this.description.Ga;l<f;l++){var g=this.description.rd(l),k=a.ma.Xa(g),r=d.description.mg(g);0>r||null==d.ya[r]?this.ya[l].Vj(k*h,a.ma.de(g),e*k,k*h):this.ya[l].Rk(k*h,d.ya[r],k*c,e*k,!0,k,k*h)}if(this.hn())throw a.g.za();if(d.ft(b))throw a.g.za();this.Dc(1993)}}};c.prototype.eK=function(){for(var a=0,b=this.aa();a<b;a++)this.BX(a)};
c.prototype.BX=function(d){this.wc();if(d>=this.aa())throw a.g.F();var b=this.wa(d),c=this.La(d);d=this.Qb(d)?1:0;for(var e=0,l=this.description.Ga;e<l;e++)if(null!=this.ya[e]){var f=a.ma.Xa(this.description.Td(e));this.ya[e].Zd(f*(b+d),f*(c-d),f)}this.Dc(1993)};c.prototype.Rr=function(d){this.wc();var b=this.aa();0>d&&(d=b-1);if(d>=b)throw a.g.F();for(var c=this.wa(d),e=this.La(d),l=0,f=this.description.Ga;l<f;l++)if(null!=this.ya[l]){var g=a.ma.Xa(this.description.Td(l));this.ya[l].Fk(g*c,g*e,g*
this.qa)}for(c=d+1;c<=b;c++)l=this.kb.read(c),this.kb.write(c-1,l-e);if(null==this.jb)for(c=d+1;c<=b;c++)d=this.jb.read(c),this.jb.write(c-1,d);this.kb.resize(b);this.jb.resize(b);this.qa-=e;this.lh-=e;this.Dc(1993)};c.prototype.Yf=function(d,b,c,e){if(b==this)throw a.g.F();if(c>=b.aa())throw a.g.F();var h=this.aa();if(d>h)throw a.g.F();0>d&&(d=h);0>c&&(c=b.aa()-1);this.hh=!1;this.om(b.description);b.wc();var l=b.wa(c),f=b.La(c),g=this.qa,k=b.Qb(c)&&!e?1:0;this.zl(this.qa+f);this.wc();for(var r=d<
h?this.wa(d):g,m=0,q=this.description.Ga;m<q;m++){var n=this.description.Td(m),w=b.description.mg(n),x=a.ma.Xa(n);0<=w&&null!=b.ya[w]?(0!=k&&this.ya[m].Rk(r*x,b.ya[w],x*l,x,!0,x,x*g),this.ya[m].Rk((r+k)*x,b.ya[w],x*(l+k),x*(f-k),e,x,x*(g+k))):this.ya[m].Vj(r*x,a.ma.de(n),x*f,x*g)}this.kb.add(g+f);for(e=h;e>=d+1;e--)l=this.kb.read(e-1),this.kb.write(e,l+f);b.ft(c);this.jb.add(0);for(e=h-1;e>=d+1;e--)h=this.jb.read(e),h&=-5,this.jb.write(e+1,h);h=b.CT().read(c);h&=-5;this.$f&&(h|=1);this.jb.write(d,
h)};c.prototype.rA=function(d,b){var h=-1,c=this.aa();if(h>c)throw a.g.F();0>h&&(h=c);this.hh=!1;var e=this.qa;this.zl(this.qa+b);this.wc();var l=h<c?this.wa(h):e;null!=d?this.ya[0].Sq(2*l,d,0,b,!0,2*e):(d=a.ma.de(0),this.ya[0].Vj(2*l,d,2*b,2*e));for(var f=1,g=this.description.Ga;f<g;f++){d=this.description.rd(f);var k=a.ma.Xa(d);d=a.ma.de(d);this.ya[f].Vj(l*k,d,k*b,k*e)}this.kb.add(this.qa);for(e=c;e>=h+1;e--)l=this.kb.read(e-1),this.kb.write(e,l+b);this.jb.add(0);for(e=c-1;e>=h+1;e--)c=this.jb.read(e),
c&=-5,this.jb.write(e+1,c);this.$f&&this.jb.write(h,1)};c.prototype.EH=function(d,b,c){var h=-1;0>d&&(d=this.aa());if(d>this.aa()||h>this.La(d)||c>b.length)throw a.g.X("index out of bounds");if(0!=c){d==this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>h&&(h=this.La(d));this.wc();var e=this.qa;this.zl(this.qa+c);this.wc();for(var l=0,f=this.description.Ga;l<f;l++){var g=this.description.Td(l),k=a.ma.Xa(g);this.ya[l].ho(k*(this.wa(d)+h+c),(e-this.wa(d)-h)*k,this.ya[l],k*(this.wa(d)+
h),!0,k);0==l?this.ya[l].ks(k*(this.wa(d)+h),c,b,0,!0):this.ya[l].Zh(a.ma.de(g),(this.wa(d)+h)*k,c*k)}this.hn()&&(this.cf.ho(this.wa(d)+h+c,e-this.wa(d)-h,this.cf,this.wa(d)+h,!0,1),this.tj.ho(this.wa(d)+h+c,e-this.wa(d)-h,this.tj,this.wa(d)+h,!0,1),this.cf.Zh(1,this.wa(d)+h,c),this.tj.Zh(-1,this.wa(d)+h,c));d+=1;for(b=this.aa();d<=b;d++)this.kb.write(d,this.kb.read(d)+c)}};c.prototype.Zf=function(d,b,c){var h=this.aa();0>d&&(d=this.aa());if(d>=h||b>this.La(d))throw a.g.X("index out of bounds");d==
this.aa()&&(this.kb.add(this.qa),this.$f?this.jb.add(1):this.jb.add(0));0>b&&(b=this.La(d));var e=this.qa;this.zl(this.qa+1);this.wc();var l=this.wa(d);this.ya[0].eh(2*(l+b),c,2*e);c=1;for(var f=this.description.Ga;c<f;c++){var g=this.description.Td(c),k=a.ma.Xa(g);this.ya[c].Vj(k*(l+b),a.ma.de(g),k,k*e)}for(d+=1;d<=h;d++)this.kb.write(d,this.kb.read(d)+1)};c.prototype.cC=function(d,b){var h=this.aa();0>d&&(d=h-1);if(d>=h||b>=this.La(d))throw a.g.X("index out of bounds");this.wc();var c=this.wa(d);
0>b&&(b=this.La(d)-1);c+=b;b=0;for(var e=this.description.Ga;b<e;b++)if(null!=this.ya[b]){var l=a.ma.Xa(this.description.Td(b));this.ya[b].Fk(l*c,l,l*this.qa)}for(;h>=d+1;h--)c=this.kb.read(h),this.kb.write(h,c-1);this.qa--;this.lh--;this.Dc(1993)};c.prototype.EF=function(d,b,c,e){d=this.wa(d)+b;c=this.wa(c)+e;if(c<d||0>d||c>this.D()-1)throw a.g.F();e=this.Fa();b=0;e.Tb(d);do{for(;e.Ea();){d=e.ba();if(e.Db()==c)break;d=d.Rb();b+=d}if(e.Db()==c)break}while(e.Ya());return b};c.prototype.fQ=function(d,
b,c){b=this.wa(d)+b;c=this.wa(d)+c;if(0>b||c>this.D()-1)throw a.g.F();var h=this.Fa();if(b>c){if(!this.Qb(d))throw a.g.F("cannot iterate across an open path");h.jC()}var e=d=0;h.Tb(b);do e+=d,d=h.ba().Rb();while(h.Db()!=c);return e};c.prototype.Gg=function(){return a.Pi.Rm(this,null)};c.prototype.FU=function(d,b,c,e){for(var h=d;h<c-1;h++)if(this.Qb(h))throw a.g.F("cannot interpolate across closed paths");h=this.description.Ga;if(1!=h){var l=this.EF(d,b,c,e);if(0!=l)for(var f=1;f<h;f++){var g=this.description.rd(f);
if(2!=a.ma.Wz(g))for(var k=a.ma.Xa(g),r=0;r<k;r++)this.HU(g,d,b,c,e,l,r)}}};c.prototype.EU=function(d,b,c){var h=this.description.Ga;if(1!=h){var e=this.fQ(d,b,c);if(0!=e)for(var l=1;l<h;l++){var f=this.description.rd(l);if(2!=a.ma.Wz(f))for(var g=a.ma.Xa(f),k=0;k<g;k++)this.GU(f,d,b,c,e,k)}}};c.prototype.HU=function(d,b,c,e,l,f,g){var h=this.Fa();b=this.wa(b)+c;e=this.wa(e)+l;l=this.Yc(d,b,g);c=this.Yc(d,e,g);var k=l,r=0;h.Tb(b);do if(h.Ea()){h.ba();if(h.Db()==e)break;this.setAttribute(d,h.Db(),
g,k);h.Li();do{b=h.ba();if(h.Jk()==e)return;b=b.Rb();r+=b;k=a.Ub.Xq(l,c,r/f);h.Fo()||this.setAttribute(d,h.Jk(),g,k)}while(h.Ea())}while(h.Ya())};c.prototype.GU=function(d,b,c,e,l,f){var h=this.Fa(),g=this.wa(b)+c;b=this.wa(b)+e;if(b!=g){e=this.Yc(d,g,f);c=this.Yc(d,b,f);var k=0;h.Tb(g);h.jC();g=e;do{var r=h.ba();this.setAttribute(d,h.Db(),f,g);g=r.Rb();k+=g;g=a.Ub.Xq(e,c,k/l)}while(h.Jk()!=b)}};c.prototype.Oa=function(){this.ir=0;this.hh=!1;this.Xd=this.cf=this.tj=this.jb=this.kb=null;this.ME()};
c.prototype.Xc=function(d){d instanceof a.Hd?this.kF(d,-1):this.yP(d)};c.prototype.kF=function(d,b){if(!this.u()&&!d.Ho()){this.wc();var h=this.ya[0],c=new a.b,e=new a.b,l,f,g;for(0>b?(l=this.hn(),f=0,g=this.qa):(l=this.ft(b),f=this.wa(b),g=this.Gc(b));f<g;f++){c.x=h.read(2*f);c.y=h.read(2*f+1);if(l&&(b=this.tj.read(f),0<=b))switch(this.cf.read(f)&7){case 2:e.x=this.Xd.read(b);e.y=this.Xd.read(b+1);d.$h(e,e);this.Xd.write(b,e.x);this.Xd.write(b+1,e.y);e.x=this.Xd.read(b+3);e.y=this.Xd.read(b+4);d.$h(e,
e);this.Xd.write(b+3,e.x);this.Xd.write(b+4,e.y);break;case 4:throw a.g.za();}d.$h(c,c);h.write(2*f,c.x);h.write(2*f+1,c.y)}this.Dc(1993)}};c.prototype.yP=function(d){if(!this.u()){this.Ud(1);this.wc();for(var b=this.ya[0],c=this.ya[1],e=new a.qd,l=new a.qd,f=this.hn(),g=0;g<this.qa;g++){e.x=b.read(2*g);e.y=b.read(2*g+1);e.z=c.read(g);if(f){var k=this.tj.read(g);if(0<=k)switch(this.cf.read(g)&7){case 2:l.x=this.Xd.read(k);l.y=this.Xd.read(k+1);l.z=this.Xd.read(k+2);l=d.Rp(l);this.Xd.write(k,l.x);
this.Xd.write(k+1,l.y);this.Xd.write(k+1,l.z);l.x=this.Xd.read(k+3);l.y=this.Xd.read(k+4);l.z=this.Xd.read(k+5);l=d.Rp(l);this.Xd.write(k+3,l.x);this.Xd.write(k+4,l.y);this.Xd.write(k+5,l.z);break;case 4:throw a.g.za();}}e=d.Rp(e);b.write(2*g,e.x);b.write(2*g+1,e.y);c.write(g,e.z)}this.Dc(1993)}};c.prototype.Py=function(){null==this.kb&&(this.kb=a.Uc.wh(1,0),this.jb=a.Uc.vq(1,0));null!=this.cf&&(this.cf.resize(this.lh,1),this.tj.resize(this.lh,-1))};c.prototype.iq=function(d){d.hh=!1;d.ir=this.ir;
d.mr=this.mr;null!=this.kb?d.kb=a.ia.Bk(this.kb):d.kb=null;null!=this.jb?d.jb=a.Fm.Bk(this.jb):d.jb=null;null!=this.tj?d.tj=a.ia.Bk(this.tj):d.tj=null;null!=this.cf?d.cf=a.Fm.Bk(this.cf):d.cf=null;null!=this.Xd?d.Xd=a.Rd.Bk(this.Xd):d.Xd=null;d.hr=this.hr;d.gr=this.gr;this.yk(1024)?d.bj=null:d.bj=this.bj};c.prototype.Rb=function(){if(!this.yk(512))return this.hr;for(var d=this.Fa(),b=new a.ry(0);d.Ya();)for(;d.Ea();)b.add(d.ba().Rb());this.hr=b.en();this.lg(512,!1);return b.en()};c.prototype.Eb=function(a){if(a==
this)return!0;if(!(a instanceof c&&b.prototype.Eb.call(this,a)))return!1;var d=this.aa();return d!=a.aa()||null!=this.kb&&!this.kb.Eb(a.kb,0,d+1)||this.mr!=a.mr||null!=this.jb&&!this.jb.Eb(a.jb,0,d)?!1:b.prototype.Eb.call(this,a)};c.prototype.Fa=function(){return new a.YN(this)};c.prototype.Oy=function(a){b.prototype.Oy.call(this,a);if(this.hn())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};c.prototype.uo=function(a,h){b.prototype.uo.call(this,a,h);if(this.hn())for(a=this.Fa();a.Ya();)for(;a.Ea();)break};
c.prototype.Iy=function(){null==this.kb||0==this.kb.size?this.qa=0:this.qa=this.kb.read(this.kb.size-1)};c.prototype.hf=function(){if(!this.$f)return 0;this.gv();return this.gr};c.prototype.rw=function(a){if(!this.$f)return!1;if(!this.yk(8))return 0!=(this.jb.read(a)&4);this.gv();return 0<this.bj.read(a)};c.prototype.Sm=function(a){if(!this.$f)return 0;this.gv();return this.bj.read(a)};c.prototype.gv=function(){if(this.yk(1024)){var d=this.aa();null==this.bj?this.bj=new a.Rd(d):this.bj.size!=d&&this.bj.resize(d);
for(var d=new a.ry(0),b=new a.ry(0),c=new a.b,e=0,l=this.Fa();l.Ya();){b.reset();for(this.w(this.wa(l.Ta),c);l.Ea();)b.add(l.ba().Cy(c.x,c.y));d.add(b.en());var f=e++;this.bj.write(f,b.en())}this.gr=d.en();this.lg(1024,!1)}};c.prototype.yT=function(){if(this.$f){this.Al();for(var a=0,b=this.aa(),c=0;c<b;c++)0!=(this.jb.read(c)&4)&&a++}};c.prototype.Al=function(){if(this.yk(8)){this.gv();var d=this.aa();if(null==this.jb||this.jb.size<d)this.jb=a.Uc.vq(d+1);for(var b=1,c=0;c<d;c++){var e=this.bj.read(c);
0==c&&(b=0<e?1:-1);0<e*b?this.jb.iC(c,4):this.jb.fz(c,4)}this.lg(8,!1)}};c.prototype.cw=function(d){var b=this.Ta,c=this.aa();if(0<=b&&b<c){if(d<this.Gc(b)){if(d>=this.wa(b))return b;b--}else b++;if(0<=b&&b<c&&d>=this.wa(b)&&d<this.Gc(b))return this.Ta=b}if(5>c){for(b=0;b<c;b++)if(d<this.Gc(b))return this.Ta=b;throw a.g.X("corrupted geometry");}b=0;for(--c;c>b;){var e=b+(c-b>>1),l=this.wa(e);if(d<l)c=e-1;else if(b=this.Gc(e),d>=b)b=e+1;else return this.Ta=e}return this.Ta=b};c.prototype.mT=function(d){var b=
this.Pa(0);this.DT();var c=this.Gc(d),e=this.wa(d);d=-1;var l=new a.b,f=new a.b;l.y=-Infinity;l.x=-Infinity;for(e+=0;e<c;e++)b.fc(2*e,f),-1==l.compare(f)&&(d=e,l.L(f));return d};c.prototype.iA=function(){var a=this.D();if(!this.$f)for(var a=a-this.aa(),b=0,c=this.aa();b<c;b++)this.Qb(b)&&a++;return a};c.prototype.ew=function(a){var d=this.La(a);this.Qb(a)||d--;return d};c.prototype.Ka=function(){return new c(this.$f,this.description)};c.prototype.tb=function(){return this.$f?2:1};c.prototype.G=function(){return this.$f?
1736:1607};c.prototype.DT=function(){this.Cu()};c.prototype.HK=function(a){this.kb=a;this.Dc(16777215)};c.prototype.OT=function(){this.Cu();return this.cf};c.prototype.CT=function(){this.Cu();return this.jb};c.prototype.GK=function(a){this.jb=a;this.Dc(16777215)};c.prototype.aa=function(){return null!=this.kb?this.kb.size-1:0};c.prototype.Gc=function(a){return this.kb.read(a+1)};c.prototype.La=function(a){return this.kb.read(a+1)-this.kb.read(a)};c.prototype.wa=function(a){return this.kb.read(a)};
c.prototype.Xu=function(d,b){null==this.ob&&(this.ob=new a.wl);b=a.xy.kX(b);var h=this.ob.Hi;if(null!=h)if(h.jl<d||b>h.KT())this.ob.My(null);else return!0;h=a.xy.create(this,d,b);this.ob.My(h);return!0};c.prototype.jc=function(){var a=b.prototype.jc.call(this);if(!this.Hc()){var h=this.aa();null!=this.kb&&this.kb.Ak(a,0,h+1);null!=this.jb&&this.jb.Ak(a,0,h)}return a};c.prototype.jH=function(a){return null!=this.cf?this.cf.read(a):1};c.prototype.ic=function(d,b,c){var h=this.cw(d);if(d==this.Gc(h)-
1&&!this.Qb(h))throw a.g.X("index out of bounds");this.wc();var e=this.cf,l=1;null!=e&&(l=e.read(d)&7);switch(l){case 1:b.Js();break;case 2:throw a.g.za();case 4:throw a.g.za();default:throw a.g.za();}b=b.get();c?b.Fg(a.ye.Ig()):b.Fg(this.description);h=d==this.Gc(h)-1&&this.Qb(h)?this.wa(h):d+1;e=new a.b;this.w(d,e);b.Mc(e);this.w(h,e);b.Zc(e);if(!c)for(c=1,e=this.description.Ga;c<e;c++)for(var l=this.description.Td(c),f=a.ma.Xa(l),g=0;g<f;g++){var k=this.Yc(l,d,g);b.Tx(l,g,k);k=this.Yc(l,h,g);b.Lx(l,
g,k)}};c.prototype.jk=function(d,b){if(d>=this.aa())throw a.g.F();if(this.u())b.Oa();else{if(this.ft(d))throw a.g.X("not implemented");var h=this.Pa(0),c=new a.b,e=new a.h;e.Oa();var l=this.wa(d);for(d=this.Gc(d);l<d;l++)h.fc(2*l,c),e.Nb(c);b.I(e)}};c.prototype.hX=function(d,b){if(d>=this.aa())throw a.g.F();if(this.u())b.Oa();else{if(this.ft(d))throw a.g.X("not implemented");var h=this.Pa(0),c=new a.b,e=new a.h;e.Oa();var l=this.wa(d);for(d=this.Gc(d);l<d;l++)h.fc(2*l,c),e.Nb(c);b.I(e)}};c.prototype.Hj=
function(d){null==this.ob&&(this.ob=new a.wl);if(0==d||16>this.D())return!1;d=a.na.AF(this);this.ob.NE(d);return!0};c.prototype.BO=function(){null==this.ob&&(this.ob=new a.wl);if(null!=this.ob.np)return!0;this.ob.OE(null);var d=a.na.aQ(this);this.ob.OE(d);return!0};c.prototype.Hp=function(a){this.mr=a};c.prototype.xo=function(){return this.mr};c.prototype.UE=function(d){if(this==d)throw a.g.X("MultiPathImpl.add");for(var b=this.aa(),c=0;c<d.aa();c++)this.Ti(d,c,!0),this.nW(b),b++};c.prototype.nQ=
function(d){var b=this.cw(d),c=this.wa(b);if(c!=d){b=this.Gc(b);if(d>=b||d<c)throw a.g.X("change_ring_start_point");for(var e=0,l=this.description.Ga;e<l;e++){var f=this.description.rd(e),f=a.ma.Xa(f);this.ya[e].rotate(c*f,d*f,b*f)}}};c.se=[0,0,6,0,8,0];return c}(a.Mu);a.xl=b})(D||(D={}));(function(a){var b=function(b){function c(d){b.call(this);if(void 0!==d){if(null==d)throw a.g.F();this.description=d}else this.description=a.ye.Ig();this.qa=0}F(c,b);c.prototype.Ka=function(){return new c(this.description)};
c.prototype.add=function(a){this.resize(this.qa+1);this.Yh(this.qa-1,a)};c.prototype.lv=function(d,b){this.resize(this.qa+1);var h=new a.b;h.ka(d,b);this.rb(this.qa-1,h)};c.prototype.Id=function(d,b,c){c=0>c?d.D():c;if(0>b||b>d.D()||c<b)throw a.g.F();if(b!=c){this.om(d.description);c-=b;var h=this.qa;this.resize(this.qa+c);this.wc();for(var e=0,l=d.description.Ga;e<l;e++){var f=d.description.Td(e),g=a.ma.Xa(f),k=this.Pa(f),f=d.Pa(f);k.Rk(h*g,f,b*g,c*g,!0,1,h*g)}}};c.prototype.YE=function(d,b){var h=
d.length;b=0>b?h:b;if(0>h||0>b)throw a.g.F();if(0!=b){h=b-0;b=this.qa;this.resize(this.qa+h);for(var c=0;c<h;c++)this.rb(b+c,d[0+c])}};c.prototype.cC=function(d){if(0>d||d>=this.D())throw a.g.X("index out of bounds");this.wc();for(var b=0,c=this.description.Ga;b<c;b++)if(null!=this.ya[b]){var e=a.ma.Xa(this.description.Td(b));this.ya[b].Fk(e*d,e,e*this.qa)}this.qa--;this.lh--;this.Dc(1993)};c.prototype.resize=function(a){this.zl(a)};c.prototype.iq=function(){};c.prototype.Oa=function(){b.prototype.ME.call(this)};
c.prototype.Xc=function(d){if(d instanceof a.Hd){if(!this.u()){this.wc();for(var b=this.ya[0],c=new a.b,e=0;e<this.qa;e++)c.x=b.read(2*e),c.y=b.read(2*e+1),d.$h(c,c),b.write(2*e,c.x),b.write(2*e+1,c.y);this.Dc(1993)}}else if(!this.u()){this.wc();this.Ud(1);this.wc();for(var b=this.ya[0],c=this.ya[1],l=new a.qd,e=0;e<this.qa;e++){l.x=b.read(2*e);l.y=b.read(2*e+1);l.z=c.read(e);var f=d.Rp(l);b.write(2*e,f.x);b.write(2*e+1,f.y);c.write(e,f.z)}this.Dc(1993)}};c.prototype.tb=function(){return 0};c.prototype.G=
function(){return 550};c.prototype.hf=function(){return 0};c.prototype.Rb=function(){return 0};c.prototype.Eb=function(a){return a==this?!0:a instanceof c?b.prototype.Eb.call(this,a):!1};c.prototype.mP=function(d){var b=d.length,c=b;if(0>b||0>b||0>c)throw a.g.F();this.Ud(1);if(0!=c){b=c-0;c=this.qa;this.aK(this.qa+b);for(var e=this.Pa(0),l=0;l<b;l++){var f=d[0+l].y;e.write(2*(c+l),d[0+l].x);e.write(2*(c+l)+1,f)}e=this.Pa(1);for(l=0;l<b;l++)e.write(c+l,d[0+l].z);this.Dc(1993)}};c.prototype.nP=function(d,
b){var h=d.length;b=0>b?h:b;if(0>h||0>b)throw a.g.F();if(0!=b){h=b-0;if(0!=(h&1))throw a.g.F();b=this.qa;this.aK(this.qa+h/2);this.ya[0].js(2*b,h,d,0,!0)}};c.prototype.aK=function(d){var b=this.qa;this.zl(d);if(this.qa>b){d=1;for(var c=this.description.Ga;d<c;d++){var e=this.description.rd(d),l=a.ma.Xa(e);this.ya[d].Vj(l*b,a.ma.de(e),l*(this.qa-b),l*b)}}};c.prototype.eX=function(d,b){var h=this.qa,h=Math.min(h,b+1E3);if(0>b||b>=this.qa||h<b||1E3!=d.length)throw a.g.F();var c=this.Pa(0),e=h-b,l=[];
c.pl(2*b,2*e,l,0,!0);for(c=0;c<e;c++)d[c]=a.b.pa(l[2*c],l[2*c+1]);return h};c.prototype.fX=function(d,b){var h=this.qa,h=Math.min(h,0+b);if(0>=this.qa||0>h||d.length!=b)throw a.g.F();b=this.Pa(0);var c=null,e=a.ma.de(1),l=this.hasAttribute(1);l&&(c=this.Pa(1));var h=h-0,f=[],g=[];b.pl(0,2*h,f,0,!0);c.pl(0,h,g,0,!0);for(b=0;b<h;b++)d[b]=new a.qd(f[2*b],f[2*b+1],l?g[b]:e)};c.prototype.Iy=function(){};c.prototype.Py=function(){};c.prototype.Xu=function(){return!1};c.prototype.Hj=function(){return!1};
c.prototype.Gg=function(){return null};return c}(a.Mu);a.Ed=b})(D||(D={}));(function(a){(function(a){a[a.NotDetermined=0]="NotDetermined";a[a.Structure=1]="Structure";a[a.DegenerateSegments=2]="DegenerateSegments";a[a.Clustering=3]="Clustering";a[a.Cracking=4]="Cracking";a[a.CrossOver=5]="CrossOver";a[a.RingOrientation=6]="RingOrientation";a[a.RingOrder=7]="RingOrder";a[a.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency";a[a.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency";a[a.OGCDisconnectedInterior=
10]="OGCDisconnectedInterior"})(a.XM||(a.XM={}));var b=function(){function a(a,d,b){void 0===a?(this.Ii=0,this.mm=this.lm=-1):(this.Ii=a,this.lm=d,this.mm=b)}a.prototype.ms=function(a){this.Ii=a.Ii;this.lm=a.lm;this.mm=a.mm};return a}();a.$d=b})(D||(D={}));(function(a){var b=function(){function b(){}b.YZ=function(b){if(!1===b)throw a.g.JL();};b.SK=function(a){return isNaN(a)?NaN:0===a?a:0<a?1:-1};b.qv=function(a){var d;void 0===d&&(d=0);for(var h=[],c=0;c<a;c++)h[c]=b.gf(2,d);return h};b.gf=function(a,
d){void 0===d&&(d=0);for(var b=[],c=0;c<a;c++)b[c]=d;return b};b.Nv=function(a,d){var b,c;void 0===b&&(b=0);for(void 0===c&&(c=a.length-1);b<=c;b++)a[b]=d};b.pk=function(a,d,b){return a<d?d:a>b?b:a};b.t_=function(){return 4};b.dh=function(a,d){var b=5381;void 0!==d?b=(d<<5)+d+(a&255):b=(b<<5)+b+(a&255);b=(b<<5)+b+(a>>8&255);b=(b<<5)+b+(a>>16&255);return(b<<5)+b+(a>>24&255)&2147483647};b.Zi=function(){throw Error("Not Implemented");};b.p_=function(){return-Infinity};b.r_=function(){return Infinity};
b.h_=function(){return 2147483647};b.UZ=function(){return 2.220446049250313E-16};b.VZ=function(){return 1.7976931348623157E308};b.HB=function(a){return b.dZ(a)+12345&2147483647};b.gI=function(a){var d=32,h=a%b.pA|0,c=a/b.pA|0;if(0===(d&=63))return a;32>d?(a=h>>>d|c<<32-d,d=c>>d):(a=c>>d-32,d=0<=c?0:-1);return d*b.pA+(a>>>0)};b.dZ=function(a){a|=0;return(1103495168*a|0)+(20077*a|0)|0};b.truncate=function(a){return 0>a?-1*Math.floor(Math.abs(a)):Math.floor(a)};b.gV=Math.pow(2,53)-1;b.XZ=-b.gV;b.iD=
65536;b.K_=16777216;b.pA=b.iD*b.iD;return b}();a.J=b})(D||(D={}));(function(a){(function(a){a[a.Project=0]="Project";a[a.Union=1]="Union";a[a.Difference=2]="Difference";a[a.Proximity2D=3]="Proximity2D";a[a.Relate=4]="Relate";a[a.Equals=5]="Equals";a[a.Disjoint=6]="Disjoint";a[a.Intersects=7]="Intersects";a[a.Within=8]="Within";a[a.Contains=9]="Contains";a[a.Crosses=10]="Crosses";a[a.Touches=11]="Touches";a[a.Overlaps=12]="Overlaps";a[a.Buffer=13]="Buffer";a[a.Distance=14]="Distance";a[a.Intersection=
15]="Intersection";a[a.Clip=16]="Clip";a[a.Cut=17]="Cut";a[a.DensifyByLength=18]="DensifyByLength";a[a.DensifyByAngle=19]="DensifyByAngle";a[a.LabelPoint=20]="LabelPoint";a[a.GeodesicBuffer=21]="GeodesicBuffer";a[a.GeodeticDensifyByLength=22]="GeodeticDensifyByLength";a[a.ShapePreservingDensify=23]="ShapePreservingDensify";a[a.GeodeticLength=24]="GeodeticLength";a[a.GeodeticArea=25]="GeodeticArea";a[a.Simplify=26]="Simplify";a[a.SimplifyOGC=27]="SimplifyOGC";a[a.Offset=28]="Offset";a[a.Generalize=
29]="Generalize";a[a.SymmetricDifference=30]="SymmetricDifference";a[a.ConvexHull=31]="ConvexHull";a[a.Boundary=32]="Boundary";a[a.SimpleRelation=33]="SimpleRelation"})(a.sN||(a.sN={}));var b=function(){function b(){}b.prototype.G=function(){return null};b.prototype.qo=function(){return!1};b.prototype.wv=function(){return!1};b.NZ=function(b){a.T.gh(b.G())&&(b=b.ob,null!=b&&(b.My(null),b.NE(null)))};return b}();a.ef=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}
F(c,b);c.prototype.G=function(){return 13};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e,l){return d instanceof a.T?(l=new a.hd(d),this.V(l,b,[c],!1,e).next()):!0===e?(c=new a.DD(d,b,c,!1,l),a.ei.local().V(c,b,l)):new a.DD(d,b,c,!1,l)};c.$=null;return c}(a.ef);a.CD=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c,e){this.Ca=-1;this.ie=b;this.IA=d;this.yt=h;this.tV=new a.h;this.tV.Oa();this.To=-1;this.lc=e}b.prototype.next=function(){for(var a;null!=
(a=this.ie.next());)return this.Ca=this.ie.Ia(),this.To+1<this.yt.length&&this.To++,this.buffer(a,this.yt[this.To]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.buffer=function(b,d){return a.PL.buffer(b,d,this.IA,NaN,96,this.lc)};b.prototype.Re=function(){return!0};return b}();a.DD=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 16};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,
b,c,e){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c,e).next()):new a.cN(d,b,c,e)};c.$=null;return c}(a.ef);a.bN=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h){this.Ca=-1;if(null==b)throw a.g.F();this.R=d;this.$k=b;this.ta=a.na.be(h,d,!1)}b.prototype.next=function(){var b;return null!=(b=this.$k.next())?(this.Ca=this.$k.Ia(),a.ne.clip(b,this.R,this.ta,0)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.cN=b})(D||(D={}));(function(a){var b=
function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 31};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c){return d instanceof a.T?a.FD.DF(d):new a.FD(b,d,c)};c.$=null;return c}(a.ef);a.ED=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h){this.aB=new a.Ju;this.Ca=-1;if(null==d)throw a.g.F();this.oI=b;this.Pc=!1;this.$k=d;this.lc=h}b.prototype.next=function(){if(this.oI){if(!this.Pc){var a=this.eQ(this.$k);this.Pc=!0;
return a}return null}if(!this.Pc){a=this.$k.next();if(null!=a)return this.Ca=this.$k.Ia(),b.DF(a);this.Pc=!0}return null};b.prototype.Ia=function(){return this.Ca};b.prototype.eQ=function(a){for(var d;null!=(d=a.next());)this.aB.Jb(d);return this.aB.US()};b.prototype.Re=function(){if(this.Pc)return!0;if(!this.oI)throw a.g.X("Invalid call for non merging convex hull.");var b=this.$k.next();if(null!=b)return this.aB.Jb(b),!0;throw a.g.X("Expects a non-null geometry.");};b.DF=function(c){if(b.Wg(c))return c;
var d=c.G();if(a.xl.Oc(d))return d=new a.Ua(c.description),d.dc(c,!0),d;if(550==d&&2==c.D()){var h=new a.Wa,d=new a.Ua(c.description);c.Ae(0,h);d.Rf(h);c.Ae(1,h);d.lineTo(h);return d}return a.Ju.UQ(c)};b.Wg=function(b){if(b.u())return!0;var d=b.G();return 33==d||197==d?!0:a.xl.Oc(d)?!1:550==d?1==b.D()?!0:!1:1607==d?1==b.aa()&&2>=b.D()?!0:!1:1!=b.aa()?!1:2>=b.D()?!0:a.Ju.VH(b,0)};return b}();a.FD=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=
function(){return 17};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e,l){return new a.eN(d,b,c,e,l)};c.$=null;return c}(a.ef);a.dN=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c,e){this.qg=null;if(null==d||null==h)throw a.g.X("invalid argument");this.qV=b;this.VA=d;this.xI=h;b=a.na.Zv(d,h);this.ta=a.na.be(c,b,!0);this.wI=-1;this.ke=e}b.prototype.Ia=function(){return 0};b.prototype.next=function(){this.HS();return++this.wI<this.qg.length?this.qg[this.wI]:
null};b.prototype.HS=function(){if(null==this.qg)switch(this.qg=[],this.VA.G()){case 1607:this.JS();break;case 1736:this.IS()}};b.prototype.JS=function(){var b=new a.Ua,d=new a.Ua,h=new a.Ua;this.qg.push(b);this.qg.push(d);var c=[];a.WL.UL(this.qV,this.VA,this.xI,this.ta,c,this.ke);for(var e=0;e<c.length;e++){var f=c[e];0==f.nx?b.add(f.Y,!1):1==f.nx||2==f.nx?d.add(f.Y,!1):3==f.nx?this.qg.push(f.Y):h.add(f.Y,!1)}h.u()||b.u()&&d.u()&&!(3<=this.qg.length)||this.qg.push(h);b.u()&&d.u()&&3>this.qg.length&&
(this.qg.length=0)};b.prototype.IS=function(){var b=new a.ia(0),d=new a.fd,h=d.hG(),c=d.Jb(this.VA),e=d.Jb(this.xI),f=new a.Dg;try{f.Xr(d,this.ta,this.ke);f.Hl(h,c,e,b);var g=d.Se(c),k=new a.Ja,m=new a.Ja;this.qg.length=0;this.qg.push(k);this.qg.push(m);for(c=0;c<b.size;c++){var q,n=new a.fd,w=n.Jb(g),x=n.Jb(d.Se(b.get(c)));f.Wr(n,this.ke);var p=f.nw(w,x);q=n.Se(p);if(!q.u()){var u=d.VG(b.get(c),h);2==u?k.add(q,!1):1==u?m.add(q,!1):this.qg.push(q);var A=new a.fd,w=A.Jb(g),x=A.Jb(d.Se(b.get(c)));f.Wr(A,
this.ke);g=A.Se(f.Vm(w,x))}}!g.u()&&0<b.size&&this.qg.push(g);k.u()&&m.u()&&(this.qg.length=0)}finally{f.qh()}};b.prototype.Re=function(){return!0};return b}();a.eN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c){if(d instanceof a.T)return d=new a.hd(d),this.V(d,b,c).next();if(0>=b)throw a.g.F();return new a.fN(d,b,c)};c.$=null;return c}(a.ef);
a.Jm=b})(D||(D={}));(function(a){var b=function(){function b(a,d){this.Ca=-1;this.ie=a;this.Kt=d}b.prototype.Ia=function(){return this.Ca};b.prototype.next=function(){var a;return null!=(a=this.ie.next())?(this.Ca=this.ie.Ia(),this.JR(a)):null};b.prototype.JR=function(b){if(b.u()||1>b.tb())return b;var d=b.G();if(1736==d||1607==d)return this.wz(b);if(a.T.Oc(d))return this.LR(b);if(197==d)return this.KR(b);throw a.g.za();};b.prototype.LR=function(b){if(b.Rb()<=this.Kt)return b;var d=new a.Ua(b.description);
d.dc(b,!0);return this.wz(d)};b.prototype.KR=function(b){var d=new a.Ja(b.description);d.jd(b,!1);var h=new a.h;b.s(h);b=h.fa();return h.N()<=this.Kt&&b<=this.Kt?d:this.wz(d)};b.prototype.wz=function(b){for(var d=b.Ka(),h=b.Fa();h.Ya();)for(var c=!0;h.Ea();){var e=h.ba();if(322!=e.G())throw a.g.X("not implemented");var l=h.Fo(),f=e.Rb();if(f>this.Kt){var g=Math.ceil(f/this.Kt),f=new a.Wa(b.description);c&&(e.Dp(f),d.Rf(f));for(var k=c=1/g,m=0,g=g-1;m<g;m++)e.Fx(k,f),d.lineTo(f),k+=c;l?d.sq():(e.Bp(f),
d.lineTo(f))}else l?d.sq():d.dc(e,c);c=!1}return d};b.prototype.Re=function(){return!0};return b}();a.fN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 2};c.prototype.V=function(d,b,c,e){return d instanceof a.T?(d=new a.hd(d),b=new a.hd(b),this.V(d,b,c,e).next()):new a.gN(d,b,c,e)};c.Vm=function(d,b,e,l){if(d.u()||b.u())return d;var h=d.tb(),f=b.tb();if(h>f)return d;var g=
d.G(),k=b.G(),r=new a.h,m=new a.h,q=new a.h;d.s(r);b.s(m);q.I(r);q.Nb(m);var q=a.na.be(e,q,!1),n=q*Math.sqrt(2)*1.00001,w=new a.h;w.I(r);w.O(n,n);if(!w.Yb(m))return d;if(1==h&&2==f)return c.SL(d,b,k,e,l);if(33==g)switch(a.xl.Oc(k)?(e=new a.Ua(b.description),e.dc(b,!0)):e=b,k){case 1736:return c.gO(d,e,q);case 1607:return c.kO(d,e,q);case 550:return c.VN(d,e,q);case 197:return c.PN(d,e,q);case 33:return c.cO(d,e,q);default:throw a.g.F();}else if(550==g)switch(k){case 1736:return c.CM(d,b,q);case 197:return c.mM(d,
b,q);case 33:return c.xM(d,b,q)}return a.Dg.Vm(d,b,e,l)};c.gO=function(d,b,c){return 0==a.gd.WH(b,d,c)?d:d.Ka()};c.kO=function(d,b,c){var h=d.w();b=b.Fa();for(var e=c*Math.sqrt(2)*1.00001,l=e*e,f=new a.h;b.Ya();)for(;b.Ea();){var g=b.ba();g.s(f);f.O(e,e);if(f.contains(h)){if(g.mt(h,c))return d.Ka();var k=g.ec();if(a.b.sc(h,k)<=l)return d.Ka();k=g.Cc();if(a.b.sc(h,k)<=l)return d.Ka()}}return d};c.VN=function(d,b,c){var h=b.Pa(0);b=b.D();var e=d.w(),l=new a.b;c=c*Math.sqrt(2)*1.00001;c*=c;for(var f=
0;f<b;f++)if(h.fc(2*f,l),a.b.sc(l,e)<=c)return d.Ka();return d};c.PN=function(d,b,c){var h=new a.h;b.s(h);h.O(c,c);b=d.w();return h.contains(b)?d.Ka():d};c.cO=function(d,b,c){c=c*Math.sqrt(2)*1.00001;c*=c;var h=d.w();b=b.w();return a.b.sc(h,b)<=c?d.Ka():d};c.CM=function(d,b,c){var h=new a.h;b.s(h);h.O(c,c);for(var e=d.D(),l=!1,f=[],g=0;g<e;g++)f[g]=!1;for(var k=new a.b,g=0;g<e;g++)d.w(g,k),h.contains(k)&&0!=a.gd.ge(b,k,c)&&(l=!0,f[g]=!0);if(!l)return d;b=d.Ka();for(g=0;g<e;g++)f[g]||b.Id(d,g,g+1);
return b};c.mM=function(d,b,c){var h=new a.h;b.s(h);h.O(c,c);b=d.D();var e=!1;c=[];for(var l=0;l<b;l++)c[l]=!1;for(var f=new a.b,l=0;l<b;l++)d.w(l,f),h.contains(f)&&(e=!0,c[l]=!0);if(!e)return d;h=d.Ka();for(l=0;l<b;l++)c[l]||h.Id(d,l,l+1);return h};c.xM=function(d,b,c){var h=d.Pa(0),e=d.D(),l=b.w(),f=new a.b,g=!1;b=[];for(var k=0;k<e;k++)b[k]=!1;k=c*Math.sqrt(2)*1.00001;c=k*k;for(k=0;k<e;k++)h.fc(2*k,f),a.b.sc(f,l)<=c&&(g=!0,b[k]=!0);if(!g)return d;h=d.Ka();for(k=0;k<e;k++)b[k]||h.Id(d,k,k+1);return h};
c.SL=function(d,b,c,e,l){var h=new a.ci;d.Qn(h);var f=new a.h;b.s(f);h.Nb(f);h.O(.1*h.N(),.1*h.fa());f=new a.Ja;f.jd(h,!1);1736==c?f.add(b,!0):f.jd(b,!0);return a.tk.local().V(d,f,e,l)};c.$=null;return c}(a.ef);a.cq=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b,c){this.ot=null==d;this.Ca=-1;this.ie=a;this.IA=b;this.wV=d.next();this.lc=c}b.prototype.next=function(){if(this.ot)return null;var b;return null!=(b=this.ie.next())?(this.Ca=this.ie.Ia(),a.cq.Vm(b,this.wV,this.IA,this.lc)):
null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.gN=b})(D||(D={}));(function(a){var b=function(){function b(d){this.ke=d;this.Zj=new a.h;this.Zj.Oa();this.Jh=new a.h;this.Jh.Oa()}b.prototype.Bu=function(){var a;a=this.Zj.o;this.Zj.o=this.Jh.o;this.Jh.o=a;a=this.Zj.v;this.Zj.v=this.Jh.v;this.Jh.v=a;a=this.Zj.A;this.Zj.A=this.Jh.A;this.Jh.A=a;a=this.Zj.B;this.Zj.B=this.Jh.B;this.Jh.B=a};b.prototype.ZR=function(d,b){var h=!this.Zj.Yb(this.Jh);if(a.T.Ic(d.G())&&
a.T.Ic(b.G())){if(d.D()>b.D())return this.tF(d,b,h);this.Bu();h=this.tF(b,d,h);this.Bu();return h}if(550==d.G()&&a.T.Ic(b.G()))return h=this.uF(b,d,h),this.Bu(),h;if(550==b.G()&&a.T.Ic(d.G()))return this.uF(d,b,h);if(550==d.G()&&550==b.G()){if(d.D()>b.D())return this.vF(d,b);this.Bu();h=this.vF(b,d);this.Bu();return h}return 0};b.prototype.tF=function(d,b,c){var h=d.Fa(),e=b.Fa(),l=new a.h,f=new a.h,g=1.7976931348623157E308;if(!c&&this.qZ(d,b,h,e))return 0;for(;h.Ya();)for(;h.Ea();)if(d=h.ba(),d.s(l),
!(l.Zx(this.Jh)>g)){for(;e.Ya();)for(;e.Ea();)if(b=e.ba(),b.s(f),l.Zx(f)<g&&(b=d.Cb(b,c),b*=b,b<g)){if(0==b)return 0;g=b}e.yj()}return Math.sqrt(g)};b.prototype.uF=function(d,b,c){var h=d.Fa(),e=new a.h,l=1.7976931348623157E308,f=new a.b,g,k=b.D();for(c=!c&&1736==d.G();h.Ya();)for(;h.Ea();){var r=h.ba();r.s(e);if(!(1<k&&e.Zx(this.Jh)>l)){for(var m=0;m<k;m++){b.w(m,f);if(c&&0!=a.gd.ge(d,f,0))return 0;g=r.pe(f,!1);f.sub(r.gc(g));g=f.qk();if(g<l){if(0==g)return 0;l=g}}c=!1}}return Math.sqrt(l)};b.prototype.vF=
function(d,b){for(var h=1.7976931348623157E308,c=new a.b,e=new a.b,l,f=d.D(),g=b.D(),k=0;k<f;k++)if(d.w(k,c),!(1<g&&this.Jh.ZK(c)>h))for(var m=0;m<g;m++)if(b.w(m,e),l=a.b.sc(c,e),l<h){if(0==l)return 0;h=l}return Math.sqrt(h)};b.prototype.qZ=function(d,b,c,e){if(1736==d.G()){for(;e.Ya();)if(e.Ea()){var h=e.ba();if(0!=a.gd.ge(d,h.Cc(),0))return!0}e.yj()}if(1736==b.G()){for(;c.Ya();)if(c.Ea()&&(d=c.ba(),0!=a.gd.ge(b,d.Cc(),0)))return!0;c.yj()}return!1};b.prototype.Rm=function(a,b){if(a.u()||b.u())return NaN;
a.s(this.Zj);b.s(this.Jh);return this.ZR(a,b)};return b}(),c=function(c){function d(){c.apply(this,arguments)}F(d,c);d.prototype.V=function(d,c,e){if(null==d||null==c)throw a.g.F();if(d.u()||c.u())return NaN;var h,l;h=d.G();l=c.G();if(33==h){if(33==l)return a.b.Cb(d.w(),c.w());if(197==l)return e=new a.h,c.s(e),e.Cb(d.w());h=new a.Ed;h.add(d);d=h}else if(197==h){if(197==l)return l=new a.h,d.s(l),e=new a.h,c.s(e),e.Cb(l);h=new a.Ja;h.jd(d,!1);d=h}33==l?(l=new a.Ed,l.add(c),c=l):197==l&&(l=new a.Ja,
l.jd(c,!1),c=l);return(new b(e)).Rm(d,c)};d.local=function(){null===d.$&&(d.$=new d);return d.$};d.prototype.G=function(){return 14};d.$=null;return d}(a.ef);a.hN=c})(D||(D={}));(function(a){var b=function(){function b(a,d,b,c){this.LI=a;this.TI=d;this.ke=c;this.lI=b}b.prototype.next=function(){var a=this.LI.next();return null==a?null:this.kD(a)};b.prototype.Ia=function(){return this.LI.Ia()};b.prototype.kD=function(b){var d=b.G();if(a.T.Jo(d))return b;if(197==d)return d=new a.Ja(b.description),d.jd(b,
!1),this.kD(d);if(b.u())return b;if(null==b)throw a.g.za();for(var d=b.Ka(),h=new a.Hb,c=0,e=b.aa();c<e;c++)this.oM(b,c,d,h);return d};b.prototype.oM=function(b,d,h,c){if(!(2>b.La(d))){var e=b.wa(d),l=b.Gc(d)-1,f=b.Pa(0),g=b.Qb(d),k=new a.ia(0);k.yb(b.La(d)+1);var r=new a.ia(0);r.yb(b.La(d)+1);k.add(g?e:l);k.add(e);for(e=new a.b;1<k.size;){var m=k.Fc();k.Pf();var q=k.Fc();b.w(m,e);c.Mc(e);b.w(q,e);c.Zc(e);q=this.kM(c,e,f,m,q,l);0<=q?(k.add(q),k.add(m)):r.add(m)}g||r.add(k.get(0));if(r.size==k.size)h.Ti(b,
d,!0);else if(2<=r.size&&(!this.lI||2!=r.size||!(g||a.b.Cb(b.Ba(r.get(0)),b.Ba(r.get(1)))<=this.TI))){d=new a.Wa;c=0;for(l=r.size;c<l;c++)b.Ae(r.get(c),d),0==c?h.Rf(d):h.lineTo(d);g&&(this.lI||2!=r.size||h.lineTo(d),h.sq())}}};b.prototype.kM=function(a,d,b,c,e,f){var h=e-1;e<=c&&(h=f);f=e=-1;for(c+=1;c<=h;c++){b.fc(2*c,d);var l=d.x,g=d.y;a.gc(a.pe(d,!1),d);d.x-=l;d.y-=g;l=d.length();l>this.TI&&l>f&&(e=c,f=l)}return e};b.prototype.Re=function(){return!0};return b}();a.iN=b})(D||(D={}));(function(a){var b=
function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 29};c.prototype.V=function(d,b,c,e){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c,e).next()):new a.iN(d,b,c,e)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);a.GD=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 21};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,
e,l,f,g,k){return d instanceof a.T?(k=new a.hd(d),this.V(k,b,c,[e],l,f,!1,g).next()):!0===g?(c=new a.JD(d,b,c,e,l,!1,!1,k),a.ei.local().V(c,b,k)):new a.JD(d,b,c,e,l,!1,!1,k)};c.$=null;return c}(a.ef);a.HD=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c,e,f,g,k){if(f)throw a.g.df();if(null==d)throw a.g.F();this.Ca=-1;this.Ht=b;this.Rg=d;this.$e=h;this.yt=c;this.Po=e;this.To=-1;this.lc=k;this.uV=new a.h;this.uV.Oa()}b.prototype.next=function(){for(var a;null!=(a=this.Ht.next());)return this.Ca=
this.Ht.Ia(),this.To+1<this.yt.length&&this.To++,this.RS(a,this.yt[this.To]);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.RS=function(b,d){return a.rM.buffer(b,this.Rg,this.$e,d,this.Po,this.lc)};b.prototype.Re=function(){return!0};return b}();a.JD=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 24};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e){if(null==b)throw a.g.F();
if(d.u()||1>d.tb())return 0;if(4==c)throw a.g.df();var h=a.fb.kc(b),l=a.fb.hw(h),f=a.fb.Sv(h),l=l*(2-l),g=h.Nd().Ai,k=d.G(),r;1736==k||197==k?r=d.Gg():a.T.Oc(k)?(r=new a.Ua(d.description),r.dc(d,!0)):r=d;if(0==h.Eb(b)){if(a.fb.Jc(b)){r=a.gi.Mj(r,b);1607==k&&r==d&&(r=a.T.oe(d));d=new a.Ac;a.fb.Bh(b).Sn(d);for(var k=0,m=r.D();k<m;k++){var q=r.Ba(k);q.x=a.gi.Nn(q.x,d);r.rb(k,q)}}d=r.Ka();r=a.gi.OJ(b,h,r,d,e)?d:a.fb.Xg(r,b,h,e)}return this.aS(r,c,f,l,g)};c.prototype.aS=function(d,b,c,e,l){var h=new a.ea(0),
f=0;for(d=d.Fa();d.Ya();)for(;d.Ea();){var g=d.ba(),k=g.ec(),g=g.Cc();k.scale(l);g.scale(l);a.mb.Ld(c,e,k.x,k.y,g.x,g.y,h,null,null,b);f+=h.j}return f};c.$=null;return c}(a.ef);a.lN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 18};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e,l){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c,e,l).next()):new a.kN(d,c,e,b,-1,-1,l)};c.$=null;return c}(a.ef);
a.jN=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c,e,f){if(0<f)throw a.g.df();if(4!=h&&0<e)throw a.g.df();if(null==d)throw a.g.F();this.Ca=-1;this.Ht=b;this.Rg=d;this.$e=h;this.BV=c;this.AV=e}b.prototype.next=function(){for(var a;null!=(a=this.Ht.next());)return this.Ca=this.Ht.Ia(),this.Gz(a);return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Gz=function(b){return a.Ej.Ls(b,this.Rg,this.$e,this.BV,this.AV,this.lc)};b.prototype.Re=function(){return!0};return b}();
a.kN=b})(D||(D={}));(function(a){(function(a){a[a.Unknown=0]="Unknown";a[a.Contains=1]="Contains";a[a.Within=2]="Within";a[a.Equals=3]="Equals";a[a.Disjoint=4]="Disjoint";a[a.Touches=8]="Touches";a[a.Crosses=16]="Crosses";a[a.Overlaps=32]="Overlaps";a[a.NoThisRelation=64]="NoThisRelation";a[a.Intersects=1073741824]="Intersects";a[a.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"})(a.AM||(a.AM={}));var b=function(){function b(){}b.s_=function(c,d,h,e){if(d.u()||c.u())return 4;var l=c.G(),f=
d.G(),g;a.T.Oc(l)&&(c=g=new a.Ua(c.description),g.dc(c,!0));a.T.Oc(f)&&(d=g=new a.Ua(d.description),g.dc(d,!0));switch(l){case 33:switch(f){case 33:return b.EN(c,d,h);case 197:return b.se(b.BD(d,c,h));case 550:return b.se(b.$D(d,c,h));case 1607:return b.se(b.$C(d,c,h,e));case 1736:return b.se(b.nE(d,c,h))}throw a.g.za();case 197:switch(f){case 33:return b.BD(c,d,h);case 197:return b.IM(c,d,h);case 550:return b.se(b.SD(d,c,h,e));case 1607:return b.se(b.sE(d,c));case 1736:return b.se(b.jE(d,c))}throw a.g.za();
case 550:switch(f){case 33:return b.$D(c,d,h);case 197:return b.SD(c,d,h,e);case 550:return b.YD(c,d,h,e);case 1607:return b.se(b.uE(d,c));case 1736:return b.se(b.lE(d,c))}throw a.g.za();case 1607:switch(f){case 33:return b.$C(c,d,h,e);case 197:return b.sE(c,d);case 550:return b.uE(c,d);case 1607:return b.lO(c,d);case 1736:return b.se(b.qE(d,c))}throw a.g.za();case 1736:switch(f){case 33:return b.nE(c,d,h);case 197:return b.jE(c,d);case 550:return b.lE(c,d);case 1607:return b.qE(c,d);case 1736:return b.WN(c,
d)}throw a.g.za();default:throw a.g.za();}};b.EN=function(a,d,h){a=a.w();d=d.w();return b.hE(a,d,h)};b.hE=function(a,d,b){a.sub(d);return a.qk()<=b*b?3:4};b.BD=function(c,d,h){var e=new a.h;c.s(e);c=d.w();return b.PM(e,c,h)};b.PM=function(a,d,b){a.O(-b,-b);if(a.contains(d))return 1;a.O(b,b);return a.contains(d)?8:4};b.TM=function(a,d,b){return d.contains(b)?1:a.contains(b)?8:4};b.IM=function(c,d,h){var e=new a.h;c.s(e);c=new a.h;d.s(c);return b.MM(e,c,h)};b.MM=function(a,d,b){var h=0;a.contains(d)&&
(h|=1);d.contains(a)&&(h|=2);if(0!=h)return h;a.O(-b,-b);d.O(-b,-b);if(a.Yb(d))return h=a,h.O(b,b),h=h.contains(d)?1:0,d.O(b,b),h|=d.contains(a)?2:0,0!=h?h:32;h=a;h.O(b,b);d.O(b,b);return h.Yb(d)?8:4};b.$D=function(a,d,h){d=d.w();return b.bE(a,d,h)};b.bE=function(a,d,h){for(var c=0,e=a.D();c<e;c++){var l;l=a.Ba(c);l=b.hE(l,d,h);if(4!=l)return 0!=(l&2)&&1!=e?1:l}return 4};b.SD=function(c,d,h,e){var l=new a.h;d.s(l);return b.$M(c,l,h,e)};b.$M=function(a,d,h,c){d.O(-h,-h);d.O(h,h);for(var e=h=0,l=a.D();e<
l;e++){var f;f=a.Ba(e);f=b.se(b.TM(d,d,f));if(4!=f&&(h|=f,4==c))return 1073741824}return 0==h?4:2==h?h:32};b.YD=function(a,d,h,c){for(var e=0,l=0,f=d.D();l<f;l++){var g;g=d.Ba(l);g=b.bE(a,g,h);if(4!=g&&(e++,4==c))return 1073741824}return 0<e?e==d.D()?3==c?(g=b.YD(d,a,h,1),1==g?3:0):1:32:0};b.$C=function(a,d,h,c){d=d.w();return b.hO(a,d,h,c)};b.WM=function(a,d){var b=null;a=a.ob;null!=a&&(b=a.Hi);if(null!=b){b=b.rm(d.x,d.y);if(0==b)return 4;if(1==b)return 1}else return-1;return 0};b.hO=function(c,
d,h,e){if(0==(e&1073741839))return 64;var l=b.WM(c,d);if(0<l)return l;h*=h;for(l=c.Fa();l.Ya();){var f=l.Ta;if(!c.Qb(f)){var g=c.La(f),f=c.wa(f);if(0==g)continue;if(a.b.sc(c.Ba(f),d)<=h||1<g&&a.b.sc(c.Ba(f+g-1),d)<=h)return 8}if(8!=e)for(;l.Ea();)if(g=l.ba(),g=g.gc(g.pe(d,!1)),a.b.sc(g,d)<=h)return 0!=(e&1073741828)?1073741824:1}return 0!=(e&1073741828)?4:64};b.sE=function(c,d){var h=new a.h;d.s(h);return b.dO(c,h)};b.dO=function(a,d){a=b.eq(a,d);return 0<a?a:0};b.eq=function(a,d){a=a.ob;if(null!=
a)a=a.Hi;else return-1;if(null!=a){a=a.Rn(d);if(0==a)return 4;if(1==a)return 1}else return-1;return 0};b.uE=function(c,d){var h=new a.h;d.s(h);h=b.eq(c,h);return 0<h?h:0};b.uv=function(c,d){var h=new a.h;d.s(h);h=b.eq(c,h);return 0<h?h:-1==h&&(h=new a.h,c.s(h),h=b.eq(d,h),0<h)?b.se(h):0};b.lO=function(a,d){a=b.uv(a,d);return 0<a?a:0};b.nE=function(a,d,h){d=d.w();return b.QN(a,d,h)};b.QN=function(b,d,h){b=a.gd.ge(b,d,h);if(0==b)return 4;if(1==b)return 1;if(2==b)return 8;throw a.g.za();};b.jE=function(c,
d){var h=new a.h;d.s(h);return b.NN(c,h)};b.NN=function(a,d){a=b.eq(a,d);return 0<a?a:0};b.lE=function(a,d){a=b.uv(a,d);return 0<a?a:0};b.qE=function(a,d){a=b.uv(a,d);return 0<a?a:0};b.WN=function(a,d){a=b.uv(a,d);return 0<a?a:0};b.jX=function(b,d){var h=b.G(),c=d.G(),e;if(a.T.gh(h)&&(e=b.ob,null!=e&&(e=e.Hi,null!=e))){if(33==c){var l=d.w();e=e.rm(l.x,l.y)}else l=new a.h,d.s(l),e=e.Rn(l);if(1==e)return 1;if(0==e)return 4}if(a.T.gh(c)&&(e=d.ob,null!=e&&(e=e.Hi,null!=e))){33==h?(h=b.w(),e=e.rm(h.x,
h.y)):(h=new a.h,b.s(h),e=e.Rn(h));if(1==e)return 2;if(0==e)return 4}return 0};b.se=function(a){0!=(a&1)&&(a=a&-2|2);0!=(a&2)&&(a=a&-3|1);return a};return b}();a.mN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.G=function(){return 15};c.prototype.V=function(d,b,c,e,l){return d instanceof a.T?(d=new a.hd(d),b=new a.hd(b),this.V(d,b,c,e,l).next()):void 0===l?new a.KD(d,b,c,e,-1):new a.KD(d,
b,c,e,l)};c.prototype.qo=function(d,b,c){if(!this.wv(d))return!1;b=a.na.ah(b,d,!1);var h=d.Hj(c);return h=h||d.Xu(b,c)};c.prototype.wv=function(d){return a.xy.bz(d)};c.$=null;return c}(a.ef);a.tk=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c,e){this.ot=null==d;this.Ca=-1;this.ie=b;this.Rg=h;this.sf=d.next();this.$j=this.sf.G();this.lc=c;this.ej=e;if(-1!=this.ej&&(0>=this.ej||7<this.ej))throw a.g.F("bad dimension mask");}b.prototype.next=function(){if(this.ot)return null;var a;if(null!=
this.ox){a=this.ox.next();if(null!=a)return a;this.ox=null}for(;null!=(a=this.ie.next());){this.Ca=this.ie.Ia();if(-1==this.ej)return a=this.Ma(a);this.ox=this.KU(a);return a=this.ox.next()}return null};b.prototype.Ia=function(){return this.Ca};b.prototype.Ma=function(b){var d=this.oL(b);if(null!=d)return d;var d=a.na.Zv(this.sf,b),h=a.na.be(this.Rg,d,!0),d=new a.h;this.sf.s(d);var c=new a.h;b.s(c);d.O(2*h,2*h);d.Ma(c);d.O(100*h,100*h);h=a.ne.clip(this.sf,d,0,0);b=a.ne.clip(b,d,0,0);return a.Dg.nw(b,
h,this.Rg,this.lc)};b.prototype.JJ=function(b,d,h){var c=0;if(0!=(d&1))null==h[0]&&(h[0]=new a.Ed(b)),c++;else for(var e=0;e<h.length-1;e++)h[e]=h[e+1];if(0!=(d&2))null==h[c]&&(h[c]=new a.Ua(b)),c++;else for(e=c;e<h.length-1;e++)h[e]=h[e+1];if(0!=(d&4))null==h[c]&&(h[c]=new a.Ja(b)),c++;else for(e=c;e<h.length-1;e++)h[e]=h[e+1];if(3!=c){b=[];for(e=0;e<c;e++)b[e]=h[e];return new a.hd(b)}return new a.hd(h)};b.prototype.KU=function(b){var d=this.oL(b);if(null!=d){var h=[null,null,null];h[d.tb()]=d;return this.JJ(b.description,
this.ej,h)}d=a.na.Zv(this.sf,b);h=a.na.be(this.Rg,d,!0);d=new a.h;this.sf.s(d);d.O(2*h,2*h);var c=new a.h;b.s(c);d.Ma(c);d.O(100*h,100*h);h=a.ne.clip(this.sf,d,0,0);d=a.ne.clip(b,d,0,0);h=a.Dg.vA(d,h,this.Rg,this.lc);return this.JJ(b.description,this.ej,h)};b.prototype.oL=function(c){var d=a.na.Zv(c,this.sf),h=a.na.be(this.Rg,d,!1),d=c.G(),e=c.u(),l=this.sf.u(),l=e||l;if(!l){l=new a.h;c.s(l);var f=new a.h;this.sf.s(f);f.O(2*h,2*h);l=!l.Yb(f)}if(!l)if(f=a.mN.jX(this.sf,c),4==f)l=!0;else{if(0!=(f&2))return this.sf;
if(0!=(f&1))return c}if(l)return h=a.T.lf(d),l=a.T.lf(this.$j),h<l?b.$(c,e):h>l?this.dK():0==h?550==d&&33==this.$j?this.dK():b.$(c,e):b.$(c,e);if((-1==this.ej||4==this.ej)&&197==d&&197==this.$j)return h=this.sf,d=new a.h,c.s(d),e=new a.h,h.s(e),d.Ma(e),h=new a.ci,c.copyTo(h),h.Gp(d),h;if(197==d&&0==a.T.lf(this.$j)||197==this.$j&&0==a.T.lf(d))return e=197==d?c:this.sf,c=197==d?this.sf:c,d=new a.h,e.s(d),a.ne.clip(c,d,h,0);if(0==a.T.lf(d)&&0<a.T.lf(this.$j)||0<a.T.lf(d)&&0==a.T.lf(this.$j)){h=a.na.ah(this.Rg,
c,!1);if(550==d||33==d)return a.Dg.MH(c,this.sf,h);if(550==this.$j||33==this.$j)return a.Dg.MH(this.sf,c,h);throw a.g.za();}return-1!=this.ej&&2!=this.ej||1607!=d||1736!=this.$j?-1!=this.ej&&2!=this.ej||1736!=d||1607!=this.$j?null:this.lL(this.sf,c):this.lL(c,this.sf)};b.prototype.lL=function(b,d){var h=b,c=d,e=a.na.ah(this.Rg,d,!1),l=new a.h;c.s(l);var f=new a.h;h.s(f);f.O(2*e,2*e);l.Ma(f);l.O(10*e,10*e);var h=b=a.ne.clip(b,l,0,0),f=new a.ia(0),g=-1,k=c.ob;if(null!=k){var m=k.Hi;if(null!=m){g=0;
f.yb(h.D()+h.aa());for(var q=new a.h,n=h.Fa();n.Ya();)for(;n.Ea();){n.ba().s(q);var w=m.Rn(q);1==w?f.add(1):0==w?f.add(0):(f.add(-1),g++)}}}5<d.D()&&(c=d=a.ne.clip(d,l,0,0),k=c.ob);0>g&&(g=h.iA());l=h.D()+c.D();if(g*c.D()>Math.log(l)*l*4)return null;l=null;g=c.Fa();null!=k&&null!=k.Mb&&(l=k.Mb);null==l&&20<c.D()&&(l=a.na.AF(c));c=b.Ka();k=null;m=h.Fa();q=[0,0,0,0,0,0,0,0,0];n=new a.Rd(0);w=new a.Cg;b=-1;for(var x=0,p=0,u=0<f.size,B=-1;m.Ya();){var B=m.Ta,z=0;b=-1;for(x=0;m.Ea();){var A=u?a.J.truncate(f.get(p)):
-1;p++;var v=m.ba();if(0>A){if(null!=l)for(null==k?k=l.oT(v,e):k.Wn(v,e),A=k.next();-1!=A;A=k.next()){g.Tb(l.ja(A));for(var A=g.ba(),t=v.Ma(A,null,q,null,e),A=0;A<t;A++)n.add(q[A])}else for(g.yj();g.Ya();)for(;g.Ea();)for(A=g.ba(),t=v.Ma(A,null,q,null,e),A=0;A<t;A++)n.add(q[A]);if(0<n.size){n.Gd(0,n.size,function(a,d){return a-d});var C=0;n.add(1);for(var t=-1,A=0,E=n.size;A<E;A++){var F=n.get(A);if(F!=C){var D=!1;0!=C||1!=F?(v.yh(C,F,w),C=w.get()):(C=v,D=!0);if(2<=z){c.Bs(h,B,b,x,3==z);if(1!=this.eF(d,
C.ec(),e)&&1!=this.fF(d,C,e))return null;c.dc(C,!1);z=1;x=0}else switch(t=this.fF(d,C,e),t){case 1:D?2>z?(b=m.Db()-h.wa(B),x=1,z=0==z?3:2):x++:(c.dc(C,0==z),z=1);break;case 0:z=0;b=-1;x=0;break;default:return null}C=F}}}else{A=this.eF(d,v.ec(),e);if(0>A)return null;1==A?(2>z&&(b=m.Db()-h.wa(B),z=0==z?3:2),x++):(b=-1,x=0)}n.clear(!1)}else 0!=A&&1==A&&(0==z?(z=3,b=m.Db()-h.wa(B)):1==z?(z=2,b=m.Db()-h.wa(B)):x++)}2<=z&&(c.Bs(h,B,b,x,3==z),b=-1)}return c};b.prototype.eF=function(b,d,h){return a.ff.kn(b,
d,h)};b.prototype.fF=function(b,d,h){var c=d.ec();d=d.Cc();var e=a.ff.kn(b,c,h),l=a.ff.kn(b,d,h);if(1==e&&0==l||0==e&&1==l)return-1;if(0==e||0==l)return 0;if(1==e||1==l)return 1;e=new a.b;e.add(c,d);e.scale(.5);b=a.ff.kn(b,e,h);return 0==b?0:1==b?1:-1};b.$=function(a,d){return d?a:a.Ka()};b.prototype.dK=function(){null==this.KI&&(this.KI=this.sf.Ka());return this.KI};b.prototype.Re=function(){return!0};return b}();a.KD=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}
F(c,b);c.prototype.G=function(){return 28};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e,l,f,g){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c,e,l,f,g).next()):new a.nN(d,b,c,e,l,f,g)};c.$=null;return c}(a.ef);a.LD=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b,c,e,f,g){this.Ca=-1;this.ie=a;this.fk=d;this.Qa=b;this.jj=c;this.iB=e;this.GI=f;this.ke=g}b.prototype.next=function(){var a=this.ie.next();return null!=a?(this.Ca=this.ie.Ia(),this.aN(a)):
null};b.prototype.Ia=function(){return this.Ca};b.prototype.aN=function(b){var d;d=0>=this.GI?a.na.ah(this.fk,b,!1):this.GI;return a.TL.V(b,this.Qa,this.jj,this.iB,d,this.ke)};b.prototype.Re=function(){return!0};return b}();a.nN=b})(D||(D={}));(function(a){(function(a){a[a.clipToDomainOnly=1]="clipToDomainOnly";a[a.clipWithHorizon=2]="clipWithHorizon";a[a.foldAndClipWithHorizon=3]="foldAndClipWithHorizon"})(a.Up||(a.Up={}));var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=
function(){return 0};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c).next()):new a.oN(d,b,c)};c.prototype.transform=function(d,b,c,e){return a.ko.transform(d,b,c,e,!0)};c.prototype.jL=function(d,b,c){return a.ko.jL(d,b,c)};c.prototype.Du=function(d,b,c,e){return a.ko.Du(d,b,c,e)};c.prototype.WY=function(d,b,c,e){return a.ko.gs(d,b,c,e)};c.prototype.iL=function(d,b,c,e){return a.ko.iL(d,b,c,e)};c.$=null;return c}(a.ef);
a.os=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b){this.Ca=-1;this.ie=a;this.KV=d;this.ke=b}b.prototype.next=function(){var b=this.ie.next();return null!=b?(this.Ca=this.ie.Ia(),a.ko.Xg(b,this.KV,this.ke)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=function(){return!0};return b}();a.oN=b})(D||(D={}));(function(a){var b=function(){function b(){}b.prototype.reset=function(){this.Lh=this.Zk=-1;this.qt=this.$q=!1};b.prototype.sS=function(a,b,c){for(a.Tb(b,c);a.Ea();){var d=
a.ba(),d=d.Rb();if(0!=d)return a.Db()}for(a.Tb(b,c);a.oA();)if(d=a.Li(),d=d.Rb(),0!=d)return a.Db();return-1};b.prototype.tS=function(a,b){for(a.Tb(b,-1);a.oA();)if(0!=a.Li().Rb())return a.Db();return-1};b.prototype.rS=function(a,b){a.Tb(b,-1);for(a.ba();a.Ea();)if(0!=a.ba().Rb())return a.Db();return-1};b.prototype.qS=function(d,b,c,e){this.Zk=this.sS(b,c,e);if(-1!=this.Zk){b.Tb(this.Zk,-1);var h=b.ba(),l=h.gc(h.pe(d,!1));c=a.b.sc(l,d);e=new a.b;e.L(l);e.sub(h.ec());l=new a.b;l.L(d);l.sub(h.ec());
this.$q=0>e.Ui(l);this.Lh=this.rS(b,this.Zk);if(-1!=this.Lh){b.Tb(this.Lh,-1);var h=b.ba(),f=h.pe(d,!1),f=h.gc(f),g=a.b.sc(f,d);g>c?this.Lh=-1:(e.L(f),e.sub(h.ec()),l.L(d),l.sub(h.ec()),this.qt=0>e.Ui(l))}-1==this.Lh&&(this.Lh=this.tS(b,this.Zk),-1!=this.Lh&&(b.Tb(this.Lh,-1),h=b.ba(),f=h.pe(d,!1),f=h.gc(f),g=a.b.sc(f,d),g>c?this.Lh=-1:(e.L(f),e.sub(h.ec()),l.L(d),l.sub(h.ec()),this.qt=0>e.Ui(l),d=this.Zk,this.Zk=this.Lh,this.Lh=d,d=this.$q,this.$q=this.qt,this.qt=d)))}};b.prototype.dQ=function(a,
b,c,e,l){c=c.Fa();this.qS(a,c,e,l);if(-1!=this.Zk&&-1==this.Lh)return this.$q;if(-1!=this.Zk&&-1!=this.Lh){if(this.$q==this.qt)return this.$q;c.Tb(this.Zk,-1);a=c.ba().Eg(1);c.Tb(this.Lh,-1);b=c.ba().Eg(0);return 0<=a.Ui(b)?!0:!1}return b};return b}(),c=function(c){function d(){c.apply(this,arguments)}F(d,c);d.local=function(){null===d.$&&(d.$=new d);return d.$};d.prototype.G=function(){return 3};d.prototype.Zz=function(d,b,c,e){void 0===e&&(e=!1);if(d.u())return new a.Mm;b=b.w();var h=d,l=d.G();
197==l&&(h=new a.Ja,h.jd(d,!1),l=1736);switch(l){case 33:return this.FJ(h,b);case 550:return this.rJ(h,b);case 1607:case 1736:return this.ZV(h,b,c,e);default:throw a.g.X("not implemented");}};d.prototype.$z=function(d,b){if(d.u())return new a.Mm;b=b.w();var h=d,c=d.G();197==c&&(h=new a.Ja,h.jd(d,!1),c=1736);switch(c){case 33:return this.FJ(h,b);case 550:case 1607:case 1736:return this.rJ(h,b);default:throw a.g.X("not implemented");}};d.prototype.aA=function(d,b,c,e){if(0>e)throw a.g.F();if(d.u())return[];
b=b.w();var h=d,l=d.G();197==l&&(h=new a.Ja,h.jd(d,!1),l=1736);switch(l){case 33:return this.EW(h,b,c,e);case 550:case 1607:case 1736:return this.bW(h,b,c,e);default:throw a.g.X("not implemented");}};d.prototype.ZV=function(d,c,e,l){if(1736==d.G()&&e&&(e=new a.h,d.s(e),e=a.na.be(null,e,!1),0!=(l?a.gd.ge(d,c,0):a.gd.ge(d,c,e)))){var h=new a.Mm(c,0,0);l&&h.NK(!0);return h}for(var f=d.Fa(),h=new a.b,g=e=-1,k=1.7976931348623157E308,r=0;f.Ya();)for(;f.Ea();){var m=f.ba(),m=m.gc(m.pe(c,!1)),q=a.b.sc(m,
c);q<k?(r=1,h=m,e=f.Db(),g=f.Ta,k=q):q==k&&r++}h=new a.Mm(h,e,Math.sqrt(k));l&&(f.Tb(e,g),m=f.ba(),l=0>a.b.zp(c,m.ec(),m.Cc()),1<r&&(r=new b,r.reset(),l=r.dQ(c,l,d,e,g)),h.NK(l));return h};d.prototype.FJ=function(d,b){d=d.w();b=a.b.Cb(d,b);return new a.Mm(d,0,b)};d.prototype.rJ=function(d,b){var h=d.Pa(0);d=d.D();for(var c=0,e=0,l=0,f=1.7976931348623157E308,g=0;g<d;g++){var k=new a.b;h.fc(2*g,k);var r=a.b.sc(k,b);r<f&&(e=k.x,l=k.y,c=g,f=r)}h=new a.Mm;h.Ly(e,l,c,Math.sqrt(f));return h};d.prototype.EW=
function(d,b,c,e){if(0==e)return c=[];c*=c;d=d.w();b=a.b.sc(d,b);b<=c?(c=[],e=new a.Mm,e.Ly(d.x,d.y,0,Math.sqrt(b)),c[0]=e):c=[];return c};d.prototype.bW=function(d,b,c,e){if(0==e)return e=[];var h=d.Pa(0),l=d.D();d=[];var f=0;c*=c;for(var g=0;g<l;g++){var k=h.read(2*g),r=h.read(2*g+1),m=b.x-k,q=b.y-r,m=m*m+q*q;m<=c&&(q=new a.Mm,q.Ly(k,r,g,Math.sqrt(m)),f++,d.push(q))}b=d.length;d.sort(function(a,d){return a.Qa<d.Qa?-1:a.Qa==d.Qa?0:1});if(e>=b)return d.slice(0);d.length=e;return d.slice(0)};d.$=null;
return d}(a.ef);a.sy=c})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 4};c.prototype.V=function(d,b,c,e,l){return a.Nm.YB(d,b,c,e,l)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.wv=function(d){return a.Gu.cz(d)};c.prototype.qo=function(d,b,c){return a.Gu.TE(d,b,c)};c.$=null;return c}(a.ef);a.pN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 33};
c.prototype.V=function(d,b,c,e,l){return 1073741824===d?!a.Fd.ZB(b,c,e,4,l):a.Fd.ZB(b,c,e,d,l)};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.wv=function(d){return a.Gu.cz(d)};c.prototype.qo=function(d,b,c){return a.Gu.TE(d,b,c)};c.$=null;return c}(a.ef);a.Gj=b})(D||(D={}));(function(a){var b=function(){function b(b,d,h,c){this.ke=c;this.rV=h;this.Ca=-1;if(null==b)throw a.g.F();this.$k=b;this.fk=d}b.prototype.next=function(){var a;return null!=(a=this.$k.next())?(this.Ca=this.$k.Ia(),
this.CC(a)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.CC=function(b){if(null==b)throw a.g.F();return a.ty.TK(b,this.fk,this.rV,this.ke)};b.prototype.Re=function(){return!0};return b}();a.qN=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 26};c.prototype.V=function(d,b,c,e){return d instanceof a.T?(d=new a.hd(d),this.V(d,b,c,e).next()):new a.qN(d,b,c,e)};c.prototype.Wq=function(d,b,c,e,l){return 0<(void 0!==
e?a.ty.Wq(d,b,c,e,l):a.ty.Wq(d,b,!1,null,c))};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);a.Km=b})(D||(D={}));(function(a){var b=function(){function a(){this.nr=0}a.prototype.hY=function(a){this.nr&=-2;this.nr|=a?1:0};a.prototype.fn=function(){return 0!=(this.nr&1)};a.prototype.hH=function(){return this.fn()?0:1};return a}();a.KZ=b;var c=function(){return function(){}}(),e=function(){return function(a,d,b,h){this.x=a;this.y=d;this.$i=b;this.ln=h}}(),d=function(){function a(a){this.bf=
a}a.prototype.compare=function(a,d,b){a=a.ja(b);d=this.bf.Nf.read(2*d);a=this.bf.Nf.read(2*a);d-=a;return 0>d?-1:0<d?1:0};return a}(),h=function(){function a(a){this.bf=a}a.prototype.compare=function(a,d,b){d=this.bf.ib[d];a=this.bf.ib[a.ja(b)];var h=d.fn(),c=a.fn();b=d.Le.pf(this.bf.wp,0);var e=a.Le.pf(this.bf.wp,0);b==e&&(b=Math.min(h?d.Le.ra:d.Le.oa,c?a.Le.ra:a.Le.oa),h=.5*(b-this.bf.wp)+this.bf.wp,h==this.bf.wp&&(h=b),b=d.Le.pf(h,0),e=a.Le.pf(h,0));return b<e?-1:b>e?1:0};return a}(),f=function(){function d(d,
b){this.QJ=new a.b;this.parent=d;this.YT=b}d.prototype.hs=function(a,d,b){var h=this.parent,c=this.YT;b.Gd(a,d,function(a,d){return h.ki(a,d,c)})};d.prototype.Qq=function(a){a=this.parent.Gi.get(a);this.parent.Nf.fc(2*(a>>1),this.QJ);return this.QJ.y+(0!=(a&1)?this.parent.hk:-this.parent.hk)};return d}(),g=function(){function l(d,b,h,c,e){this.zI=d.description;this.Y=d;this.mh=b;this.hk=a.na.ah(this.mh,d,!1);this.pp=a.na.ah(this.mh,d,!0);this.dB=h;this.pV=this.zI.Ga;this.ib=[];this.cp=[];this.Hh=
new a.Xp;this.hb=new a.uk;this.ve=new a.$d;this.kI=this.Ul=e}l.prototype.AA=function(){this.kI=!0;return(!a.T.Ic(this.Y.G())||this.NF()&&this.MF(!1))&&this.pQ()?a.T.Ic(this.Y.G())?this.sQ()?1607==this.Y.G()?this.uQ()?2:0:this.vQ()?this.wQ():0:0:2:0};l.prototype.IC=function(d,b){var h=this.Nf.read(2*d);d=this.Nf.read(2*d+1);var c=this.Nf.read(2*b);b=this.Nf.read(2*b+1);var e=!a.Iu.pw(h,d,c,b,this.hk*this.hk);return e?e:0==this.Y.tb()?!1:h==c&&d==b};l.prototype.NF=function(){for(var d=this.Y,b=d.$f?
3:2,h=0,c=d.aa();h<c;h++)if(d.La(h)<b)return this.ve=new a.$d(1,h,0),!1;return!0};l.prototype.MF=function(d){for(var b=this.Y,h=b.Fa(),c=b.hasAttribute(1),b=c?a.na.FF(this.mh,b,!1):0;h.Ya();)for(;h.Ea();){var e=h.ba();if(!(e.Rb()>this.hk)){if(d&&c){var l=e.dt(1,0),e=e.dt(1,0);if(Math.abs(e-l)>b)continue}this.ve=new a.$d(2,h.Db(),-1);return!1}}return!0};l.prototype.pQ=function(){var b=this.Y,h=null;a.T.Ic(this.Y.G())&&(h=this.Y);var c=(this.kI||this.Ul)&&null!=h,e=b.D();this.Nf=b.Pa(0);this.Gi=new a.ia(0);
this.Gi.yb(2*e);this.Fi=new a.ia(0);this.Fi.yb(2*e);c&&(null==this.im&&(this.im=new a.ia(0)),this.im.yb(e));for(var l=b=0;l<e;l++)if(this.Gi.add(2*l),this.Gi.add(2*l+1),this.Fi.add(2*l),this.Fi.add(2*l+1),c){for(;l>=h.Gc(b);)b++;this.im.add(b)}(new a.Hu).sort(this.Fi,0,2*e,new f(this,c));this.hb.clear();this.hb.Ep(new d(this));this.hb.Qe(e);h=0;for(e*=2;h<e;h++)if(c=this.Fi.get(h),b=this.Gi.get(c),c=b>>1,0==(b&1)){b=this.hb.addElement(c,-1);l=this.hb.Ve(b);if(-1!=l&&!this.IC(this.hb.ja(l),c))return this.ve=
new a.$d(3,c,this.hb.ja(l)),!1;var g=this.hb.nb(b);if(-1!=g&&!this.IC(this.hb.ja(g),c))return this.ve=new a.$d(3,c,this.hb.ja(g)),!1}else if(b=this.hb.search(c,-1),l=this.hb.Ve(b),g=this.hb.nb(b),this.hb.Kd(b,-1),-1!=l&&-1!=g&&!this.IC(this.hb.ja(l),this.hb.ja(g)))return this.ve=new a.$d(3,this.hb.ja(l),this.hb.ja(g)),!1;return!0};l.prototype.sQ=function(){return 10>this.Y.D()?this.qQ():this.rQ()};l.prototype.rQ=function(){var d=new a.fd;d.Jb(this.Y);var b=new a.$d;return a.Ku.tJ(!1,d,this.hk,b,this.ke)?
(b.lm=d.Za(b.lm),b.mm=d.Za(b.mm),this.ve.ms(b),!1):!0};l.prototype.qQ=function(){for(var d=this.Y,b=d.Fa(),d=d.Fa();b.Ya();)for(;b.Ea();){var h=b.ba();if(!b.Io()||!b.TU()){d.yX(b);do for(;d.Ea();){var c=d.ba(),c=h.ys(c,this.hk,!0);if(0!=c)return this.ve=new a.$d(2==c?5:4,b.Db(),d.Db()),!1}while(d.Ya())}}return!0};l.prototype.vQ=function(){var d=this.Y;this.ib.length=0;this.cp.length=0;this.ug=d.Fa();this.ug.jC();var b=new a.ia(0);b.yb(10);for(var h=NaN,c=0,e=0,d=2*d.D();e<d;e++){var l=this.Fi.get(e),
l=this.Gi.get(l);if(0==(l&1)){var l=l>>1,f=this.Nf.read(2*l),g=this.Nf.read(2*l+1);if(0!=b.size&&(f!=h||g!=c)){if(!this.KJ(b))return!1;null!=b&&b.clear(!1)}b.add(l);h=f;c=g}}return this.KJ(b)?!0:!1};l.prototype.uQ=function(){for(var d=this.Y,b=Array(d.aa()),h=0,e=d.aa();h<e;h++)b[h]=d.Eo(h);var e=new c,l,f,g,k=new a.b,h=this.Fi.get(0),h=this.Gi.get(h),r=h>>1;this.Nf.fc(2*r,k);h=this.im.get(r);l=b[h];f=d.wa(h);g=d.Gc(h)-1;e.Il=r==f||r==g;e.Uy=this.Ul?!l&&e.Il:e.Il;e.$i=h;e.x=k.x;e.y=k.y;e.ln=r;for(var m=
new c,q=1,n=this.Fi.size;q<n;q++)if(h=this.Fi.get(q),h=this.Gi.get(h),0==(h&1)){r=h>>1;this.Nf.fc(2*r,k);h=this.im.get(r);h!=e.$i&&(l=b[h],f=d.wa(h),g=d.Gc(h)-1);var w,x=r==f||r==g;w=this.Ul?!l&&e.Il:e.Il;m.x=k.x;m.y=k.y;m.$i=h;m.ln=r;m.Uy=w;m.Il=x;if(m.x==e.x&&m.y==e.y)if(this.Ul){if(!m.Uy||!e.Uy)if(m.$i!=e.$i||!m.Il&&!e.Il)return this.ve=new a.$d(8,m.ln,e.ln),!1}else if(!m.Il||!e.Il)return this.ve=new a.$d(5,m.ln,e.ln),!1;h=e;e=m;m=h}return!0};l.prototype.PF=function(){for(var d=this.Y,b=[],h=-1,
c=!1,l=0,f=d.aa();l<f;l++)d.rw(l)&&(c=!1,h++,l<f-1&&(d.rw(l+1)||(c=!0))),b[l]=c?h:-1;var c=new a.b,l=this.Fi.get(0),l=this.Gi.get(l),g=l>>1;this.Nf.fc(2*g,c);for(var l=this.im.get(g),h=new e(c.x,c.y,l,g,b[l]),d=[],k=1,f=this.Fi.size;k<f;k++)if(l=this.Fi.get(k),l=this.Gi.get(l),0==(l&1)){g=l>>1;this.Nf.fc(2*g,c);l=this.im.get(g);l=new e(c.x,c.y,l,g,b[l]);if(l.x==h.x&&l.y==h.y){if(l.$i==h.$i)return this.ve=new a.$d(9,l.ln,h.ln),!1;0<=b[l.$i]&&b[l.$i]==b[h.$i]&&(0!=d.length&&d[d.length-1]==h||d.push(h),
d.push(l))}h=l}if(0==d.length)return!0;l=new a.Xp(!0);a.J.Nv(b,-1);c=-1;k=new a.b;k.$c();h=0;for(f=d.length;h<f;h++){g=d[h];if(g.x!=k.x||g.y!=k.y)c=l.mi(0),k.x=g.x,k.y=g.y;var r=b[g.$i];-1==r&&(r=l.mi(2),b[g.$i]=r);l.addElement(r,c);l.addElement(c,r)}f=new a.ia(0);f.yb(10);for(h=l.Ge;-1!=h;h=l.bA(h))if(d=l.$G(h),0==(d&1)&&0!=(d&2)){d=-1;f.add(h);for(f.add(-1);0<f.size;){c=f.Fc();f.Pf();k=f.Fc();f.Pf();g=l.$G(k);if(0!=(g&1)){d=0==(g&2)?c:k;break}l.$X(k,g|1);for(g=l.xc(k);-1!=g;g=l.nb(g))r=l.getData(g),
r!=c&&(f.add(r),f.add(k))}if(-1!=d){l=-1;h=0;for(f=b.length;h<f;h++)if(b[h]==d){l=h;break}this.ve=new a.$d(10,l,-1);return!1}}return!0};l.prototype.wQ=function(){var d=this.Y;if(0>=d.hf())return this.ve=new a.$d(6,1==d.aa()?1:-1,-1),0;if(1==d.aa())return this.Ul&&!this.PF()?0:2;this.hp=a.ia.zd(d.aa(),0);this.pB=a.ia.zd(d.aa(),-1);for(var b=-1,c=0,e=0,l=d.aa();e<l;e++){var f=d.Sm(e);this.hp.write(e,0>f?0:256);if(0<f)b=e,c=f;else{if(0==f)return this.ve=new a.$d(6,e,-1),0;if(0>b||c<Math.abs(f))if(this.ve=
new a.$d(7,e,-1),this.Ul)return 0;this.pB.write(e,b)}}this.Wt=d.aa();this.Bn=new a.ia(0);this.Bn.yb(10);l=d.D();this.wp=NaN;d=new a.ia(0);d.yb(10);this.Jr=a.ia.zd(l,-1);this.ux=a.ia.zd(l,-1);null!=this.Yj?this.Yj.clear(!1):this.Yj=new a.ia(0);this.Yj.yb(10);this.hb.clear();this.hb.Ep(new h(this));b=0;for(l*=2;0<this.Wt&&b<l;b++)if(c=this.Fi.get(b),c=this.Gi.get(c),0==(c&1)){c>>=1;e=this.Nf.read(2*c+1);if(e!=this.wp&&0!=d.size){if(!this.ju(d))return 0;null!=d&&d.clear(!1)}d.add(c);this.wp=e}return 0<
this.Wt&&!this.ju(d)?0:this.Ul?0==this.ve.Ii&&this.PF()?2:0:0==this.ve.Ii?2:1};l.prototype.KJ=function(d){if(1==d.size)return!0;for(var b=0,h=d.size;b<h;b++){var c=d.get(b);this.ug.Tb(c);var e=this.ug.Li();this.ib.push(this.Gv(e,c,this.ug.Ta,!0));this.ug.ba();e=this.ug.ba();this.ib.push(this.Gv(e,c,this.ug.Ta,!1))}var l=this;this.ib.sort(function(a,d){return l.UR(a,d)});c=this.Hh.Ge;-1==c&&(c=this.Hh.mi(0));this.Hh.Vn(this.ib.length);b=0;for(h=this.ib.length;b<h;b++)this.Hh.addElement(c,b);for(var b=
!0,f=h=-1;b;){b=!1;e=this.Hh.xc(c);if(-1==e)break;for(var g=this.Hh.nb(e);-1!=g;){h=this.Hh.getData(e);f=this.Hh.getData(g);h=this.ib[h].up;f=this.ib[f].up;if(h==f)if(b=!0,this.Hh.kd(c,e),e=this.Hh.Ve(g),g=this.Hh.kd(c,g),-1==g||-1==e)break;else continue;e=g;g=this.Hh.nb(e)}}b=this.Hh.at(c);this.Hh.QF(c);if(0<b)return this.ve=new a.$d(5,h,f),!1;b=0;for(h=d.size;b<h;b++)this.VB(this.ib[b]);this.ib.length=0;return!0};l.prototype.ju=function(d){for(var b=0,h=d.size;b<h;b++){var c=d.get(b),e=this.Jr.read(c);
if(-1!=e){var l=this.hb.ja(e);this.Yj.add(l);this.hb.Kd(e,-1);this.VB(this.ib[l]);this.ib[l]=null;this.Jr.write(c,-1)}e=this.ux.read(c);-1!=e&&(l=this.hb.ja(e),this.Yj.add(l),this.hb.Kd(e,-1),this.VB(this.ib[l]),this.ib[l]=null,this.ux.write(c,-1))}b=0;for(h=d.size;b<h;b++){c=d.get(b);this.ug.Tb(c);e=this.ug.Li();if(e.ra>e.oa){var f=this.ug.Db(),g=this.Gv(e,c,this.ug.Ta,!0);0<this.Yj.size?(l=this.Yj.Fc(),this.Yj.Pf(),this.ib[l]=g):(l=this.ib.length,this.ib.push(g));e=this.hb.addElement(l,-1);-1==
this.Jr.read(f)?this.Jr.write(f,e):this.ux.write(f,e);0==(this.hp.read(this.ug.Ta)&3)&&this.Bn.add(e)}this.ug.ba();e=this.ug.ba();e.ra<e.oa&&(f=this.ug.Jk(),g=this.Gv(e,c,this.ug.Ta,!1),0<this.Yj.size?(l=this.Yj.Fc(),this.Yj.Pf(),this.ib[l]=g):(l=this.ib.length,this.ib.push(g)),e=this.hb.addElement(l,-1),-1==this.Jr.read(f)?this.Jr.write(f,e):this.ux.write(f,e),0==(this.hp.read(this.ug.Ta)&3)&&this.Bn.add(e))}b=0;for(h=this.Bn.size;b<h&&0<this.Wt;b++)if(e=this.Bn.get(b),0==(this.hp.read(this.ib[this.hb.ja(e)].oB)&
3)){d=-1;for(var c=this.hb.Ve(e),k=e,g=null,l=-1,r=0;-1!=c;){l=this.hb.ja(c);g=this.ib[l];l=g.oB;r=this.hp.read(l);if(0!=(r&3))break;k=c;c=this.hb.Ve(c)}-1==c?(f=1,c=k):(d=1==(r&3)?l:this.pB.read(l),f=0!=g.hH()?0:1,c=this.hb.nb(c));do{l=this.hb.ja(c);g=this.ib[l];l=g.oB;k=this.hp.read(l);if(0==(k&3)){if(f!=g.hH())return this.ve=new a.$d(6,l,-1),!1;r=0==f||g.fn()?2:1;k=k&252|r;this.hp.write(l,r);if(2==r&&0==this.ve.Ii&&this.pB.read(l)!=d&&(this.ve=new a.$d(7,l,-1),this.Ul))return!1;this.Wt--;if(0==
this.Wt)return!0}1==(k&3)&&(d=l);k=c;c=this.hb.nb(c);f=0!=f?0:1}while(k!=e)}null!=this.Bn?this.Bn.clear(!1):this.Bn=new a.ia(0);return!0};l.prototype.Gv=function(d,b,h,c){if(322==d.G())d=this.rR(d);else throw a.g.za();d.up=b;d.oB=h;d.nr=0;d.hY(c);return d};l.prototype.rR=function(d){var h;0<this.cp.length?(h=this.cp[this.cp.length-1],--this.cp.length,d.copyTo(h.Le)):(h=new b,h.Le=a.cE.oe(d));return h};l.prototype.VB=function(a){322==a.Le.G()&&this.cp.push(a)};l.prototype.$V=function(){for(var d=this.Y.D(),
b=new a.ia(0),h=0;h<d;h++)b.add(h);var c=this;b.Gd(0,d,function(a,d){return c.Cv(a,d)});for(h=1;h<d;h++)if(0==this.Cv(b.get(h-1),b.get(h)))return this.ve=new a.$d(3,b.get(h-1),b.get(h)),0;return 2};l.prototype.JW=function(){return this.NF()?this.MF(!0)?2:0:0};l.prototype.HW=function(){return this.AA()};l.prototype.aW=function(){for(var d=this.Y.D(),b=new a.ia(0),h=0;h<d;h++)b.add(h);var c=this;b.Gd(0,d,function(a,d){return c.SQ(a,d)});var e=Array(d);a.J.Nv(e,!1);e[b.get(0)]=!0;for(h=1;h<d;h++){var l=
b.get(h-1),f=b.get(h);0==this.Cv(l,f)?e[f]=!1:e[f]=!0}for(var b=this.Y.Ka(),l=this.Y,f=0,g=1,h=0;h<d;h++)e[h]?g=h+1:(f<g&&b.Id(l,f,g),f=h+1);f<g&&b.Id(l,f,g);b.Zg(2,this.pp);return b};l.prototype.KW=function(){var d=this.Y,b=d.Fa(),h=d.Fa(),c=this.Y.Ka(),e=this.Y,l=d.hasAttribute(1),f=l?a.na.FF(this.mh,d,!0):0,g=new a.ia(0),k=new a.ia(0);g.yb(a.J.truncate(d.D()/2+1));for(k.yb(a.J.truncate(d.D()/2+1));b.Ya();)if(h.Ya(),!(2>d.La(b.Ta))){h.AX();for(var r,m,q=!0;b.Ea();){var n=b.ba(),w=h.Li();if(b.Db()>
h.Db())break;q&&(g.add(b.Db()),k.add(h.Jk()),q=!1);m=g.Fc();var x=b.Jk();if(1<x-m){var p=new a.b;p.zc(d.Ba(m),d.Ba(x));r=p.length()}else r=n.Rb();m=k.Fc();x=h.Db();1<x-m?(p=new a.b,p.zc(d.Ba(m),d.Ba(x)),m=p.length()):m=w.Rb();r>this.pp?g.add(b.Jk()):l&&(r=d.Yc(1,g.Fc(),0),n=n.Os(1,0),Math.abs(n-r)>f&&g.add(b.Jk()));m>this.pp?k.add(h.Db()):l&&(r=d.Yc(1,k.Fc(),0),n=w.Os(1,0),Math.abs(n-r)>f&&k.add(h.Db()))}g.Fc()<k.Fc()?g.size>k.size?g.Pf():k.Pf():(g.Fc()!=k.Fc()&&k.Pf(),k.Pf());if(2<=k.size+g.size){q=
new a.Wa;w=0;for(n=g.size;w<n;w++)e.Ae(g.get(w),q),0==w?c.Rf(q):c.lineTo(q);for(w=k.size-1;0<w;w--)e.Ae(k.get(w),q),c.lineTo(q);e.Qb(b.Ta)?c.sq():0<k.size&&(e.Ae(k.get(0),q),c.lineTo(q))}null!=g&&g.clear(!1);null!=k&&k.clear(!1)}c.Zg(2,this.pp);return c};l.prototype.IW=function(){return this.xY()};l.prototype.xY=function(){if(1736==this.Y.G()&&1==this.Y.xo())return a.Dg.ol(this.Y,this.pp,!0,!1,this.ke);this.gj=new a.fd;this.gj.Jb(this.Y);0!=this.gj.vd&&(1!=this.dB&&a.sk.V(this.gj,this.pp,this.ke,
!0),1736==this.Y.G()&&a.lo.V(this.gj,this.gj.sd,this.dB,!1,this.ke));this.Y=this.gj.Se(this.gj.sd);1736==this.Y.G()&&(this.Y.Al(),this.Y.Hp(0));this.Y.Zg(2,this.pp);return this.Y};l.tc=function(d,b,h){if(d.u())return 1;var c=d.G();if(33==c)return 1;if(197==c)return h=new a.h,d.s(h),h.fh(a.na.ah(b,d,!1))?0:1;if(a.T.Oc(c))throw a.g.za();if(!a.T.gh(c))throw a.g.za();var c=a.na.ah(b,d,!1),e=d.Lk(c);h=h?-1:e;if(-1!=h)return h;1==h&&(c=0);h=(new l(d,b,h,0,!1)).AA();d.Zg(h,c);return h};l.Wq=function(d,b,
h,c,e){null!=c&&(c.Ii=0,c.lm=-1,c.mm=-1);if(d.u())return 1;var f=d.G();if(33==f)return 1;var g=a.na.ah(b,d,!1);if(197==f)return b=new a.h,d.s(b),b.fh(g)?(null!=c&&(c.Ii=2,c.lm=-1,c.mm=-1),0):1;if(a.T.Oc(f))return g=new a.Ua(d.description),g.dc(d,!0),l.Wq(g,b,h,c,e);e=d.Lk(g);h=h?-1:e;if(-1!=h)return h;b=new l(d,b,h,0,!1);if(550==f)h=b.$V();else if(1607==f)h=b.JW();else if(1736==f)h=b.HW();else throw a.g.za();d.Zg(h,g);null!=c&&0==h&&c.ms(b.ve);return h};l.Bb=function(d,b,h,c,e){null!=c&&(c.Ii=0,c.lm=
-1,c.mm=-1);if(d.u())return 1;var f=d.G();if(33==f)return 1;var g=a.na.ah(b,d,!1);if(197==f)return b=new a.h,d.s(b),b.fh(g)?(null!=c&&(c.Ii=2,c.lm=-1,c.mm=-1),0):1;if(a.T.Oc(f))return f=new a.Ua(d.description),f.dc(d,!0),l.Wq(f,b,h,c,e);d=new l(d,b,-1,0,!0);if(550==f||1607==f||1736==f)b=d.AA();else throw a.g.za();null!=c&&c.ms(d.ve);return b};l.TK=function(d,b,h,c){if(d.u())return d;var e=d.G();if(33==e)return d;var f=a.na.ah(b,d,!1);if(197==e)return b=new a.h,d.s(b),b.fh(f)?d.Ka():d;if(a.T.Oc(e))return e=
new a.Ua(d.description),e.dc(d,!0),l.TK(e,b,h,c);c=d.Lk(f);h=h?-1:c;if(2==h)return d;d=new l(d,b,h,0,!1);if(550==e)d=d.aW();else if(1607==e)d=d.KW();else if(1736==e)d=d.IW();else throw a.g.za();return d};l.DC=function(d,b,h,c){if(d.u())return d;var e=d.G();if(33==e)return d;var f=a.na.ah(b,d,!1);if(197==e)return b=new a.h,d.s(b),b.fh(f)?d.Ka():d;if(a.T.Oc(e))return f=new a.Ua(d.description),f.dc(d,!0),l.DC(f,b,h,c);if(!a.T.gh(e))throw a.g.X("OGC simplify is not implemented for this geometry type "+
e);return a.Dg.DC(d,f,!1,c)};l.prototype.ki=function(d,b,h){if(d==b)return 0;d=this.Gi.get(d);var c=this.Gi.get(b);b=d>>1;var e=c>>1,l=new a.b,f=new a.b;this.Nf.fc(2*b,l);l.y+=0!=(d&1)?this.hk:-this.hk;this.Nf.fc(2*e,f);f.y+=0!=(c&1)?this.hk:-this.hk;d=l.compare(f);return 0==d&&h?(h=this.im.get(b)-this.im.get(e),0>h?-1:0<h?1:0):d};l.prototype.Cv=function(d,b){if(d==b)return 0;var h=this.Y,c=h.Ba(d),e=h.Ba(b);if(c.x<e.x)return-1;if(c.x>e.x)return 1;if(c.y<e.y)return-1;if(c.y>e.y)return 1;for(c=1;c<
this.pV;c++)for(var e=this.zI.rd(c),l=a.ma.Xa(e),f=0;f<l;f++){var g=h.Yc(e,d,f),k=h.Yc(e,b,f);if(g<k)return-1;if(g>k)return 1}return 0};l.prototype.SQ=function(a,d){var b=this.Cv(a,d);return 0==b?a<d?-1:1:b};l.prototype.UR=function(a,d){if(a===d)return 0;var b=a.Le.Eg(a.fn()?1:0);a.fn()&&b.Lr();a=d.Le.Eg(d.fn()?1:0);d.fn()&&a.Lr();d=b.$u();var h=a.$u();return h==d?(d=b.Ui(a),Math.abs(d)<=8.881784197001252E-16*(Math.abs(a.x*b.y)+Math.abs(a.y*b.x))&&(d--,d++),0>d?1:0<d?-1:0):d<h?-1:1};return l}();a.ty=
g})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 30};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.prototype.V=function(d,b,c,e){return d instanceof a.T?(d=new a.hd(d),b=new a.hd(b),this.V(d,b,c,e).next()):new a.rN(d,b,c,e)};c.Pp=function(d,b,e,l){var h=d.tb(),f=b.tb();if(d.u()&&b.u())return h>f?d:b;if(d.u())return b;if(b.u())return d;var g=new a.h,k=new a.h,r=new a.h;d.s(g);b.s(k);r.I(g);r.Nb(k);g=a.na.be(e,r,!1);
k=d.G();r=b.G();return 33==k&&33==r?c.nO(d,b,g):k!=r?0<h||0<f?h>f?d:b:550==k?c.XJ(d,b,g):c.XJ(b,d,g):a.Dg.Pp(d,b,e,l)};c.nO=function(d,b,c){c=c*Math.sqrt(2)*1.00001;c*=c;var h=d.w(),e=b.w(),l=new a.Ed(d.description);a.b.sc(h,e)>c&&(l.add(d),l.add(b));return l};c.XJ=function(d,b,c){var h=d.Pa(0),e=d.D(),l=b.w(),f=d.Ka();c=c*Math.sqrt(2)*1.00001;var g=new a.h;d.s(g);g.O(c,c);if(g.contains(l)){c*=c;for(var g=!1,k=[],r=0;r<e;r++)k[r]=!1;for(r=0;r<e;r++){var m=h.read(2*r),q=h.read(2*r+1),m=m-l.x,q=q-l.y;
m*m+q*q<=c&&(g=!0,k[r]=!0)}if(g)for(r=0;r<e;r++)k[r]||f.Id(d,r,r+1);else f.Id(d,0,e),f.add(b)}else f.Id(d,0,e),f.add(b);return f};c.$=null;return c}(a.ef);a.uy=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b,c){this.ot=null==d;this.Ca=-1;this.ie=a;this.Rg=b;this.LV=d.next();this.lc=c}b.prototype.next=function(){if(this.ot)return null;var b;return null!=(b=this.ie.next())?(this.Ca=this.ie.Ia(),a.uy.Pp(b,this.LV,this.Rg,this.lc)):null};b.prototype.Ia=function(){return this.Ca};b.prototype.Re=
function(){return!0};return b}();a.rN=b})(D||(D={}));(function(a){var b=function(){function a(){}a.prototype.kw=function(){this.Hz=null;this.gy=-1;this.rL=!1};return a}(),c=function(){function a(){this.Es=0;this.Pj=[]}a.prototype.pP=function(a){this.Es+=a.gy;this.Pj.push(a)};a.prototype.LW=function(){this.Es-=this.Pj[this.Pj.length-1].gy;--this.Pj.length};a.prototype.Ty=function(){return this.Pj[this.Pj.length-1]};a.prototype.Eb=function(a){return a===this};return a}(),e=function(){function d(a,d,
b){this.Ca=-1;this.Pc=!1;this.QI=[!1,!1,!1,!1];this.jr=[0,0,0,0];this.SA=!1;this.bl=-1;this.Yq=0;this.Ro=-1;this.rp=[];this.ie=a;this.Rg=d;this.lc=b}d.tc=function(a){var d=[],b;for(b in a)d.push(Number(b));d.sort(function(a,d){return a-d});return d};d.prototype.sH=function(b){var h=this.rp[b],c=d.tc(h)[0],e=h[c],l=e.Ty().Hz,e=e.Ty().rL;delete h[c];e&&(l=a.Km.local().V(l,this.Rg,!1,this.lc),0==b&&33==l.G()&&(b=new a.Ed(l.description),l.u()||b.add(l),l=b));return l};d.prototype.next=function(){if(this.Pc&&
this.Ro==this.bl)return null;for(;!this.cL(););if(-1==this.bl)return null;if(this.SA){for(this.Ro++;;){if(this.Ro>this.bl||0>this.Ro)throw a.g.za();if(this.QI[this.Ro])break}this.Ca++;return this.sH(this.Ro)}this.Ca=0;this.Ro=this.bl;return this.sH(this.bl)};d.prototype.Ia=function(){return this.Ca};d.prototype.cL=function(){if(this.Pc)return!0;var d=null;null!=this.ie&&(d=this.ie.next(),null==d&&(this.Pc=!0,this.ie=null));if(null!=d){var b=d.tb();this.QI[b]=!0;b>=this.bl&&!this.SA&&(this.cF(b,!1,
d),b>this.bl&&!this.SA&&this.wX(b))}if(0<this.Yq)for(b=0;b<=this.bl;b++)for(;1<this.jr[b];)if(d=this.IQ(b),0!=d.length)d=a.Dg.RR(d,this.Rg,this.lc),this.cF(b,!0,d);else break;return this.Pc};d.prototype.IQ=function(a){for(var b=[],h=[],c=this.rp[a],e=d.tc(c),l=0;l<e.length;l++){var f=e[l],g=c[f];if(this.Pc||1E4<g.Es&&1<g.Pj.length){this.jr[a]-=g.Pj.length;for(this.Yq-=g.Pj.length;0<g.Pj.length;)b.push(g.Ty().Hz),g.LW();h.push(f)}}for(l=0;l<h.length;l++)delete c[h[l]];return b};d.prototype.wX=function(a){for(var d=
0;d<a;d++)this.rp[d]=[],this.Yq-=this.jr[d],this.jr[d]=0};d.prototype.cF=function(a,e,l){var h=new b;h.kw();h.Hz=l;l=d.Mg(l);h.gy=l;l=d.We(l);if(a+1>this.rp.length)for(var f=0,g=Math.max(2,a+1);f<g;f++)this.rp.push([]);f=this.rp[a][l];void 0===f&&(f=new c,this.rp[a][l]=f);h.rL=e;f.pP(h);this.jr[a]++;this.Yq++;this.bl=Math.max(this.bl,a)};d.We=function(d){return 0<d?a.J.truncate(Math.log(d)/Math.log(4)+.5):0};d.Mg=function(d){var b=d.G();if(a.T.gh(b))return d.D();if(33==b)return 1;if(197==b)return 4;
if(a.T.Oc(b))return 2;throw a.g.za();};d.prototype.Re=function(){return this.cL()};return d}();a.tN=e})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments)}F(c,b);c.prototype.G=function(){return 1};c.prototype.V=function(d,b,c,e){return void 0===e?new a.tN(d,b,c):this.$R(d,b,c,e)};c.prototype.$R=function(d,b,c,e){d=new a.hd([d,b]);return this.V(d,c,e).next()};c.local=function(){null===c.$&&(c.$=new c);return c.$};c.$=null;return c}(a.ef);a.ei=b})(D||(D={}));(function(a){var b;
(function(a){a[a.nextPath=0]="nextPath";a[a.nextSegment=1]="nextSegment";a[a.iterate=2]="iterate"})(b||(b={}));b=function(){function b(b,d,h,c){this.Ot=new a.h;this.EV=b;this.FV=d;this.br=c;this.ip=-1;this.Vl=!1;var e=b.ob;null!=e&&(e=c?e.np:e.Mb,null!=e&&(this.Pc=!1,this.ta=h,this.Mb=e,this.lx=this.Mb.mf(),this.cr=this.Vl=!0,this.Zb=0,c?this.ip=d.aa():this.Cd=d.Fa()));this.Vl||(e=d.ob,null!=e&&(e=c?e.np:e.Mb,null!=e&&(this.Pc=!1,this.ta=h,this.Mb=e,this.lx=this.Mb.mf(),this.Vl=!0,this.cr=!1,this.Zb=
0,c?this.ip=b.aa():this.Cd=b.Fa())));this.Vl||(this.Ci=c?a.na.dT(b,d,h,1<=b.Lk(0),1<=d.Lk(0)):a.na.cT(b,d,h))}b.prototype.next=function(){if(this.Vl){if(this.Pc)return!1;for(var b=!0;b;)switch(this.Zb){case 0:b=this.hW();break;case 1:b=this.iW();break;case 2:b=this.CA();break;default:throw a.g.X("internal error");}return this.Pc?!1:!0}return null==this.Ci?!1:this.Ci.next()};b.prototype.Ql=function(){return this.Vl?this.cr?this.Mb.ja(this.Bt):this.br?this.ip:this.Cd.Db():this.Ci.Ql(this.Ci.sg)};b.prototype.Ml=
function(){return this.Vl?this.cr?this.br?this.ip:this.Cd.Db():this.Mb.ja(this.Bt):this.Ci.Ml(this.Ci.bg)};b.prototype.eA=function(){if(!this.br)throw a.g.X("internal error");return this.Vl?this.cr?this.Mb.RG(this.Bt):this.Ot:this.Ci.eA(this.Ci.sg)};b.prototype.Iz=function(){if(!this.br)throw a.g.X("internal error");return this.Vl?this.cr?this.Ot:this.Mb.RG(this.Bt):this.Ci.Iz(this.Ci.bg)};b.prototype.hW=function(){if(!this.br){if(!this.Cd.Ya())return this.Pc=!0,!1;this.Zb=1;return!0}if(-1==--this.ip)return this.Pc=
!0,!1;this.cr?this.FV.jk(this.ip,this.Ot):this.EV.jk(this.ip,this.Ot);this.lx.Ni(this.Ot,this.ta);this.Zb=2;return!0};b.prototype.iW=function(){if(!this.Cd.Ea())return this.Zb=0,!0;var a=this.Cd.ba();this.lx.Wn(a,this.ta);this.Zb=2;return!0};b.prototype.CA=function(){this.Bt=this.lx.next();return-1==this.Bt?(this.Zb=this.br?0:1,!0):!1};return b}();a.Lm=b})(D||(D={}));(function(a){a=a.BN||(a.BN={});a[a.enumClosed=1]="enumClosed";a[a.enumHasNonlinearSegments=2]="enumHasNonlinearSegments";a[a.enumOGCStartPolygon=
4]="enumOGCStartPolygon";a[a.enumCalcMask=4]="enumCalcMask"})(D||(D={}));(function(a){var b=function(){function b(){}b.Cb=function(c,d,h,e,f,g,k,m,q){var l=[0,0,0],r=[0,0,0],n=[0,0,0],w=[0,0,0,0],x=new a.ea(0),p=new a.ea(0),u=new a.ea(0);if(null!=k||null!=m||null!=q)if(a.l.Qi(d))a.vh.Cb(c,h,e,f,g,k,m,q);else{f=a.C.da(f);h=a.C.da(h);var y=a.C.da(f-h);if(a.l.W(e,g)&&(a.l.W(h,f)||a.l.W(a.l.K(e),1.570796326794897)))null!=k&&(k.j=0),null!=m&&(m.j=0),null!=q&&(q.j=0);else{if(a.l.W(e,-g)){if(a.l.W(a.l.K(e),
1.570796326794897)){null!=k&&(k.j=2*a.C.Yg(c,d));null!=m&&(m.j=0<e?a.C.da(3.141592653589793-a.C.da(f)):a.C.da(f));null!=q&&(q.j=0<e?a.C.da(f):a.C.da(3.141592653589793-a.C.da(f)));return}a.l.W(a.l.K(y),3.141592653589793)&&(null!=k&&(k.j=2*a.C.Yg(c,d)),null!=m&&(m.j=0),null!=q&&(q.j=0))}else{if(a.l.W(a.l.K(e),1.570796326794897)||a.l.W(a.l.K(g),1.570796326794897)){a.yl.Cb(c,d,h,e,f,g,k,m,q);return}if(a.l.W(h,f)||a.l.W(a.l.K(y),3.141592653589793)){a.yl.Cb(c,d,h,e,f,g,k,m,q);return}if(a.l.xd(e)){a.yl.Cb(c,
d,h,e,f,g,k,m,q);return}}var B=Math.sqrt(1-d);f=a.C.da(f-h);h=0;a.C.Dk(1,d,e,h,0,x,p,u);l[0]=x.j;l[1]=p.j;l[2]=u.j;a.C.Dk(1,d,g,f,0,x,p,u);r[0]=x.j;r[1]=p.j;r[2]=u.j;n[0]=0;n[1]=0;n[2]=-1*d*a.C.n(1,d,e)*Math.sin(e);0>f?a.C.Or(n,r,l,w,0):a.C.Or(n,l,r,w,0);for(var p=[0,0,0],u=[0,0,0],z=[0,0,0],l=[0,0,0],x=[0,0,0],v=Math.acos(w[2]/1),t=1-d,C=Math.tan(v),A=1+C*C/t,E=2*n[2]*C/t,C=Math.sqrt(E*E-4*A*(n[2]*n[2]/t-1)),A=2*A,t=(-E+C)/A,E=(-E-C)/A,C=Math.tan(v),A=C*t+n[2],v=(t+E)/2,n=(A+(C*E+n[2]))/2,C=a.C.Sp(t-
v,A-n),t=n/B*1.570796326794897,E=0;100>E;E++){A=a.C.Cm(d,t);A=A*A/Math.cos(t)*(Math.sin(t)-n*A/(1*(1-d)));if(a.l.xd(A))break;t-=A}var n=a.C.n(1,d,t)*Math.cos(t),n=Math.sqrt((n-v)*(n+v)),C=1-C/n,C=C*(2-C),A=a.C.eo(p),v=a.C.eo(u),t=a.C.eo(z),F=a.C.Eu(z,p),E=a.C.Eu(z,u);a.C.fy(z,p,l);a.C.fy(z,u,x);p=Math.acos(F/(t*A));u=Math.acos(E/(t*v));u*=a.l.Ab(1,a.C.Eu(l,x));if(1.570796326794897<=a.l.K(p)&&1.570796326794897<=a.l.K(u)||3.141592653589793<a.l.K(p-u))p=(3.141592653589793-a.l.K(p))*a.l.Ab(1,p),u=(3.141592653589793-
a.l.K(u))*a.l.Ab(1,u);l=a.C.ik(C,u);x=a.C.q(n,C,a.C.ik(C,p));l=a.C.q(n,C,l);l=a.l.K(l-x)*c;p=new a.ea(0);u=new a.ea(0);z=w[1]/1;z*=-a.l.Ab(1,y);x=Math.acos(z)*a.l.Ab(1,y);b.Uf(c,d,h,e,l,x,p,u);a.l.W(f,p.j)&&a.l.W(g,u.j)||(C=a.C.Sp(a.C.da(f-p.j),g-u.j),b.Uf(c,d,h,e,l,a.C.da(x+3.141592653589793),p,u),A=a.C.Sp(a.C.da(f-p.j),g-u.j),A<C&&(x=a.C.da(x+3.141592653589793)));p=[0,0,0,0];u=[0,0,0,0];n=[0,0,0];C=[0,0,0];c=[0,0,0];h=[0,0,0];e=[0,0,0];z=[0,0,0];n[0]=0;n[1]=0;n[2]=B;C[0]=0;C[1]=0;C[2]=0;a.C.Or(C,
n,r,p,0);a.l.xd(g)?(c[0]=r[0],c[1]=r[1],c[2]=1,h[0]=1*Math.cos(f)-1*Math.sin(f),h[1]=1*Math.sin(f)+1*Math.cos(f)):(d=a.C.n(1,d,g)*Math.cos(g),c[0]=0,c[1]=0,r[2]+=Math.tan(1.570796326794897-a.l.K(g))*d*a.l.Ab(1,g),h[0]=d*Math.cos(f)-d*Math.sin(f),h[1]=d*Math.sin(f)+d*Math.cos(f));h[2]=r[2];a.C.Or(r,h,c,u,1);a.C.fy(u,p,e);a.C.fy(u,w,z);z=a.C.Eu(e,z)/(a.C.eo(e)*a.C.eo(z));z*=a.l.Ab(1,y);f=Math.acos(z)*-a.l.Ab(1,y);0<x&&0<f?f=a.C.da(f+3.141592653589793):0>x&&0>f&&(f=a.C.da(f+3.141592653589793));null!=
k&&(k.j=l);null!=m&&(m.j=x);null!=q&&(q.j=f)}}};b.Uf=function(b,d,h,c,e,f,g,k){var l=[0,0,0],r=[0,0,0],m=[0,0,0],q=[0,0,0],n=[0,0,0],w=[0,0,0],x=[0,0,0],p=[0,0,0,0],u=new a.ea(0),y=new a.ea(0),B=new a.ea(0),z=new a.ea(0),v=new a.ea(0),t=new a.ea(0);if(null!=g&&null!=k)if(a.l.Qi(d))a.vh.Uf(b,h,c,e,f,g,k);else if(a.l.xd(e))null!=g&&(g.j=h),null!=k&&(k.j=c);else if(f=a.C.da(f),0>e&&(e=a.l.K(e),f=a.C.da(f+3.141592653589793)),h=a.C.da(h),c=a.C.da(c),1.570796326794897<a.l.K(c)&&(h=a.C.da(h+3.141592653589793),
c=a.l.Ab(3.141592653589793,c)-c),a.l.W(a.l.K(c),1.570796326794897)||a.l.xd(c)||a.l.xd(f)||a.l.W(a.l.K(f),3.141592653589793))a.yl.Uf(b,d,h,c,e,f,g,k);else{var C=Math.sqrt(1-d);b=e/b;a.C.Dk(1,d,c,0,0,z,v,t);l[0]=z.j;l[1]=v.j;l[2]=v.j;x[0]=0;x[1]=0;x[2]=-1*d*a.C.n(1,d,c)*Math.sin(c);z=a.C.n(1,d,c);v=a.C.da(1.570796326794897-f);t=Math.sin(v);e=Math.cos(c);c=Math.sin(c);n[0]=z*e-c*t;n[1]=Math.cos(v);n[2]=(1-d)*z*c+e*t;0>f?a.C.Or(x,n,l,p,0):a.C.Or(x,l,n,p,0);l=Math.acos(p[2]/1);p=Math.atan2(-p[1],-p[0]);
c=1-d;n=Math.tan(l);v=1+n*n/c;z=2*x[2]*n/c;n=Math.sqrt(z*z-4*v*(x[2]*x[2]/c-1));v*=2;c=(-z+n)/v;z=(-z-n)/v;n=Math.tan(l);v=n*c+x[2];l=(c+z)/2;x=(v+(n*z+x[2]))/2;n=a.C.Sp(c-l,v-x);C=x/C*1.570796326794897;for(c=0;100>c;c++){z=a.C.Cm(d,C);z=z*z/Math.cos(C)*(Math.sin(C)-x*z/(1*(1-d)));if(a.l.xd(z))break;C-=z}C=a.C.n(1,d,C)*Math.cos(C);C=Math.sqrt((C-l)*(C+l));x=1-n/C;x*=2-x;w=Math.acos(a.C.Eu(w,r)/(a.C.eo(w)*a.C.eo(r)));w*=a.l.Ab(1,r[0]);f=(a.C.q(C,x,a.C.ik(x,w))+b*a.l.Ab(1,f))/a.C.Yg(C,x);f=a.C.da(1.570796326794897*
f);f=a.C.xp(x,f);a.C.n(C,x,f);n=a.C.da(p+h);h=Math.cos(n);f=Math.sin(n);m[0]=q[0]*h+q[1]*-f;m[1]=q[0]*f+q[1]*h;m[2]=q[2];a.C.jQ(d,m[0],m[1],m[2],B,y,u);null!=g&&(g.j=y.j);null!=k&&(k.j=B.j)}};return b}();a.VD=b})(D||(D={}));(function(a){var b=function(){function d(d){this.ab=null;this.mu=new a.b;this.nu=new a.b;this.a=d}d.prototype.compare=function(a,d,b){this.a.Nc(d,this.mu);this.a.Nc(a.ja(b),this.nu);return this.mu.compare(this.nu)};return d}(),c=function(){function d(d){this.cg=new a.b;this.fl=
new a.b;this.a=d}d.prototype.Yh=function(a){this.cg.L(a)};d.prototype.compare=function(a,d){this.a.Nc(a.ja(d),this.fl);return this.cg.compare(this.fl)};return d}(),e=function(a){function d(d){a.call(this,d.a,d.ta,!1);this.bb=d}F(d,a);d.prototype.compare=function(a,d,b){if(this.Ng)return-1;var h=this.bb.he.yo(this.bb.ri(d));a=a.ja(b);var c=this.bb.he.yo(this.bb.ri(a));this.rn=b;return this.XF(d,h,a,c)};return d}(a.fE),d=function(a){function d(d){a.call(this,d.a,d.ta);this.bb=d}F(d,a);d.prototype.compare=
function(a,d){if(this.Ng)return-1;a=this.bb.he.yo(this.bb.ri(a.ja(d)));this.rn=d;return this.YF(d,a)};return d}(a.aO),h=function(){function h(){this.Tc=this.Hf=this.Xo=this.he=this.Gh=this.Od=this.ib=this.a=null;this.ih=!1;this.Th=this.An=this.Fe=this.hl=this.Ih=this.cl=this.gg=this.we=null;this.Vh=this.zr=this.AB=this.ta=0;this.Kw=this.Lo=!1;this.mp=new a.b;this.oj=new a.b;this.ib=new a.ad(8);this.Od=new a.ad(5);this.Gh=new a.Lu;this.he=new a.Lu;this.ih=!1;this.Th=new a.b;this.Th.ka(0,0);this.ta=
0;this.Vh=-1;this.Lo=!1;this.a=null;this.Hf=new a.uk;this.Tc=new a.uk;this.Ih=new a.ia(0);this.hl=new a.dE;this.gg=new a.ia(0);this.cl=new a.ia(0);this.Xo=new a.Wa}h.prototype.IY=function(d,b){var h=new a.Hd;h.xC();d.Xc(h);this.Yr(d);this.Lo=!1;this.ta=b;this.AB=b*b;b=this.GC();d.Xc(h);b||(this.lS(),b||this.GC());-1!=this.Vh&&(this.a.le(this.Vh),this.Vh=-1);this.a=null;return this.Lo};h.prototype.MY=function(a,d){this.Yr(a);this.Lo=!1;this.ta=d;this.AB=d*d;this.ih=!1;this.GC();this.ih||(this.ih=1==
a.zq(d,!0,!1));-1!=this.Vh&&(this.a.le(this.Vh),this.Vh=-1);this.a=null};h.prototype.Jg=function(a,d){return this.ib.S(a,0+d)};h.prototype.lC=function(a,d,b){this.ib.P(a,0+d,b)};h.prototype.ri=function(a){return this.ib.S(a,2)};h.prototype.UX=function(a,d){this.ib.P(a,2,d)};h.prototype.cH=function(a,d){return this.ib.S(a,3+d)};h.prototype.Jq=function(a){return this.ib.S(a,7)};h.prototype.um=function(a,d){this.ib.P(a,7,d)};h.prototype.Kq=function(a,d){return this.ib.S(a,3+this.Iq(a,d))};h.prototype.Zr=
function(a,d,b){this.ib.P(a,3+this.Iq(a,d),b)};h.prototype.GT=function(a,d){return this.ib.S(a,5+this.Iq(a,d))};h.prototype.as=function(a,d,b){this.ib.P(a,5+this.Iq(a,d),b)};h.prototype.Ns=function(a){return this.Od.S(a,0)};h.prototype.RX=function(a,d){this.Od.P(a,0,d)};h.prototype.Mz=function(a){return this.Od.S(a,4)};h.prototype.Vr=function(a,d){this.Od.P(a,4,d)};h.prototype.Nl=function(a){return this.Od.S(a,1)};h.prototype.ao=function(a,d){this.Od.P(a,1,d)};h.prototype.Lz=function(a){return this.Od.S(a,
3)};h.prototype.tu=function(a,d){this.Od.P(a,3,d)};h.prototype.Mn=function(a){var d=this.Od.Pe(),b=this.Gh.mi();this.RX(d,b);-1!=a?(this.Gh.addElement(b,a),this.a.Va(a,this.Vh,d),this.Vr(d,this.a.Za(a))):this.Vr(d,-1);return d};h.prototype.DR=function(a){this.Od.kd(a)};h.prototype.aF=function(a,d){this.Gh.addElement(this.Ns(a),d);this.a.Va(d,this.Vh,a)};h.prototype.cu=function(a){var d=this.ib.Pe(),b=this.he.mi();this.UX(d,b);-1!=a&&this.he.addElement(b,a);return d};h.prototype.bF=function(a,d){this.he.addElement(this.ri(a),
d)};h.prototype.Jv=function(a){this.ib.kd(a);a=this.Ih.Ov(a);0<=a&&this.Ih.HJ(a)};h.prototype.Jj=function(d,b){if(-1==this.Jg(d,0))this.lC(d,0,b);else if(-1==this.Jg(d,1))this.lC(d,1,b);else throw a.g.za();this.Ry(d,b)};h.prototype.Ry=function(a,d){var b=this.Nl(d);if(-1!=b){var h=this.Kq(b,d);this.as(h,d,a);this.Zr(a,d,h);this.Zr(b,d,a);this.as(a,d,b)}else this.as(a,d,a),this.Zr(a,d,a),this.ao(d,a)};h.prototype.Iq=function(a,d){return this.Jg(a,0)==d?0:1};h.prototype.Ln=function(a,d){var b=this.Lz(d);
-1!=b&&(this.Hf.Kd(b,-1),this.tu(d,-1));var h,b=this.Nl(d);if(-1!=b){var c=h=b,e;do{e=!1;var l=this.Iq(h,d),f=this.cH(h,l);if(this.Jg(h,l+1&1)==a){this.Kv(h);this.he.zh(this.ri(h));this.Jv(h);if(h==f){b=-1;break}b==h&&(b=this.Nl(d),c=f,e=!0)}h=f}while(h!=c||e);if(-1!=b){do l=this.Iq(h,d),f=this.cH(h,l),this.lC(h,l,a),h=f;while(h!=c);h=this.Nl(a);-1!=h?(c=this.Kq(h,a),e=this.Kq(b,a),c==h?(this.ao(a,b),this.Ry(h,a),this.ao(a,h)):e==b&&this.Ry(b,a),this.Zr(b,a,c),this.as(c,a,b),this.Zr(h,a,e),this.as(e,
a,h)):this.ao(a,b)}}b=this.Ns(a);h=this.Ns(d);for(c=this.Gh.xc(h);-1!=c;c=this.Gh.nb(c))this.a.Va(this.Gh.ja(c),this.Vh,a);this.Gh.mz(b,h);this.DR(d)};h.prototype.TV=function(a,d){var b=this.Jg(a,0),h=this.Jg(a,1),c=this.Jg(d,0),e=this.Jg(d,1);this.he.mz(this.ri(a),this.ri(d));d==this.Nl(b)&&this.ao(b,a);d==this.Nl(h)&&this.ao(h,a);this.Kv(d);this.Jv(d);b==c&&h==e||h==c&&b==e||(this.wo(b,this.mp),this.wo(c,this.oj),this.mp.ub(this.oj)?(b!=c&&this.Ln(b,c),h!=e&&this.Ln(h,e)):(h!=c&&this.Ln(h,c),b!=
e&&this.Ln(b,e)))};h.prototype.Kv=function(a){var d=this.Jg(a,1);this.lG(a,this.Jg(a,0));this.lG(a,d)};h.prototype.lG=function(a,d){var b=this.Kq(a,d),h=this.GT(a,d),c=this.Nl(d);b!=a?(this.Zr(h,d,b),this.as(b,d,h),c==a&&this.ao(d,b)):this.ao(d,-1)};h.prototype.iF=function(a,d,b){var h=this.he.xc(a),c=this.he.ja(h);a=this.jf(c);var e=this.jf(this.a.U(c));this.a.bs(c,d,b,!0);for(h=this.he.nb(h);-1!=h;h=this.he.nb(h)){var c=this.he.ja(h),l=this.jf(c)==a;this.a.bs(c,d,b,l)}h=d.Mq(b,0).ec();d=d.Mq(b,
d.Rl(b)-1).Cc();this.sL(a,h);this.sL(e,d)};h.prototype.eG=function(a,d,b){var h=this.ri(a),c=this.Jg(a,0),e=this.Jg(a,1),l=this.cu(-1);this.Ih.add(l);this.um(l,-3);this.gg.add(l);this.Jj(l,c);a=1;for(d=d.Rl(b);a<d;a++)b=this.Mn(-1),this.cl.add(b),this.gg.add(b),this.Jj(l,b),l=this.cu(-1),this.Ih.add(l),this.um(l,-3),this.gg.add(l),this.Jj(l,b);this.Jj(l,e);for(h=this.he.xc(h);-1!=h;h=this.he.nb(h))if(e=this.he.ja(h),this.jf(e)==c){a=0;do 0<a&&(l=this.gg.get(a-1),this.aF(l,e),-1==this.Mz(l)&&this.Vr(l,
this.a.Za(e))),l=this.gg.get(a),a+=2,this.bF(l,e),e=this.a.U(e);while(a<this.gg.size)}else{a=this.gg.size-1;do a<this.gg.size-2&&(l=this.gg.get(a+1),this.aF(l,e),0>this.Mz(l)&&this.Vr(l,this.a.Za(e))),l=this.gg.get(a),a-=2,this.bF(l,e),e=this.a.U(e);while(0<=a)}this.gg.clear(!1)};h.prototype.jf=function(a){return this.a.Sa(a,this.Vh)};h.prototype.LJ=function(d,b,h){var c=this.Jg(b,0),e=new a.b;this.wo(c,e);var l=new a.b,f=this.Jg(b,1);this.wo(f,l);var g=h.Rl(d),k=h.Mq(d,0),r=new a.b;k.Oq(r);if(!e.ub(r)){if(!this.ih){var m=
e.compare(this.Th),r=r.compare(this.Th);0>m*r&&(this.ih=!0)}this.HG(c,this.gg);this.cl.add(c)}!this.ih&&1<g&&(m=e.compare(l),k=k.Cc(),e.compare(k)!=m||k.compare(l)!=m?this.ih=!0:0>k.compare(this.Th)&&(this.ih=!0));k=h.Mq(d,g-1);d=k.Cc();l.ub(d)||(this.ih||(m=l.compare(this.Th),r=d.compare(this.Th),0>m*r&&(this.ih=!0)),this.HG(f,this.gg),this.cl.add(f));this.gg.add(b);l=0;for(f=this.gg.size;l<f;l++)d=this.gg.get(l),h=this.Jq(d),a.ad.BA(h)&&(this.Tc.Kd(h,-1),this.um(d,-1)),d!=b&&-3!=this.Jq(d)&&(this.Ih.add(d),
this.um(d,-3));this.gg.clear(!1)};h.prototype.oQ=function(a,d){this.we.compare(this.Tc,this.Tc.ja(a),d);this.we.Ng&&(this.we.Gs(),this.yG(a,d))};h.prototype.yG=function(d,b){this.Lo=!0;d=this.Tc.ja(d);b=this.Tc.ja(b);var h,c;c=this.he.yo(this.ri(d));var e=this.he.yo(this.ri(b));h=this.a.ic(c);null==h&&(null==this.Fe&&(this.Fe=new a.Hb),this.a.pd(c,this.Fe),h=this.Fe);c=this.a.ic(e);null==c&&(null==this.An&&(this.An=new a.Hb),this.a.pd(e,this.An),c=this.An);this.hl.Ap(h);this.hl.Ap(c);this.hl.Ma(this.ta,
!0)&&(this.ih=!0);this.YK(d,b,-1,this.hl);this.hl.clear()};h.prototype.xS=function(d,b){this.Lo=!0;b=this.Tc.ja(b);var h,c=this.he.yo(this.ri(b));h=this.a.ic(c);null==h&&(null==this.Fe&&(this.Fe=new a.Hb),this.a.pd(c,this.Fe),h=this.Fe);c=this.NG(d);this.hl.Ap(h);this.a.wj(c,this.Xo);this.hl.sA(this.ta,this.Xo,!0);this.YK(b,-1,d,this.hl);this.hl.clear()};h.prototype.sU=function(){if(0!=this.Ih.size)for(;0!=this.Ih.size;){if(this.Ih.size>Math.max(100,this.a.vd)){this.Ih.clear(!1);this.ih=!0;break}var a=
this.Ih.Fc();this.Ih.Pf();this.um(a,-1);-1!=this.PU(a)&&this.rU(a);this.Ko=!1}};h.prototype.rU=function(a){var d;this.Ko?(d=this.Tc.jv(this.$I,this.WI,a,!0),this.Ko=!1):d=this.Tc.$E(a);-1==d?this.TV(this.Tc.ja(this.Tc.QG()),a):(this.um(a,d),this.we.Ng&&(this.we.Gs(),this.yG(this.we.rn,d)))};h.prototype.PU=function(d){var b=this.Jg(d,0);d=this.Jg(d,1);this.wo(b,this.mp);this.wo(d,this.oj);if(a.b.sc(this.mp,this.oj)<=this.AB)return this.ih=!0,-1;var h=this.mp.compare(this.Th),c=this.oj.compare(this.Th);
return 0>=h&&0<c?d:0>=c&&0<h?b:-1};h.prototype.jS=function(){var d=new a.ia(0);d.yb(this.a.vd);for(var b=this.a.Qr(),h=b.next();-1!=h;h=b.next())-1!=this.a.Sa(h,this.Vh)&&d.add(h);this.a.Xx(d,d.size);this.kS(d)};h.prototype.kS=function(d){this.Hf.clear();this.Hf.Qe(d.size);this.Hf.Ep(new b(this.a));var h=new a.b;h.$c();for(var c=-1,e=new a.b,l=0,f=d.size;l<f;l++){var g=d.get(l);this.a.Nc(g,e);e.ub(h)?(g=this.a.Sa(g,this.Vh),this.Ln(c,g)):(c=this.jf(g),this.a.Nc(g,h),g=this.Hf.ro(g),this.tu(c,g))}};
h.prototype.lS=function(){var d=new a.ia(0);d.yb(this.a.vd);for(var b=this.Hf.xc(-1);-1!=b;b=this.Hf.nb(b))d.add(this.Hf.ja(b));this.Hf.clear();this.a.Xx(d,d.size);for(var b=0,h=d.size;b<h;b++){var c=d.get(b),e=this.jf(c),c=this.Hf.ro(c);this.tu(e,c)}};h.prototype.HG=function(d,b){var h=this.Nl(d);if(-1!=h){var c=h;do a.ad.BA(this.Jq(c))&&b.add(c),c=this.Kq(c,d);while(c!=h)}};h.prototype.sL=function(a,d){for(a=this.Gh.xc(this.Ns(a));-1!=a;a=this.Gh.nb(a))this.a.Qf(this.Gh.ja(a),d)};h.prototype.YK=
function(a,d,b,h){this.Kv(a);-1!=d&&this.Kv(d);this.LJ(0,a,h);-1!=d&&this.LJ(1,d,h);-1!=b&&(h.cg.w(this.mp),this.wo(b,this.oj),this.oj.ub(this.mp)||this.cl.add(b));b=0;for(var c=this.cl.size;b<c;b++){var e=this.cl.get(b),l=this.Lz(e);-1!=l&&(this.Hf.Kd(l,-1),this.tu(e,-1))}b=this.ri(a);c=-1!=d?this.ri(d):-1;this.iF(b,h,0);-1!=d&&this.iF(c,h,1);this.eG(a,h,0);-1!=d&&this.eG(d,h,1);this.he.zh(b);this.Jv(a);-1!=d&&(this.he.zh(c),this.Jv(d));b=0;for(c=this.cl.size;b<c;b++)e=this.cl.get(b),e==this.zr&&
(this.Kw=!0),l=this.Lz(e),-1==l&&(l=this.Hf.$E(this.NG(e)),-1==l?(a=this.jf(this.Hf.ja(this.Hf.QG())),this.Ln(a,e)):this.tu(e,l));this.cl.clear(!1)};h.prototype.wo=function(a,d){this.a.pH(this.Mz(a),d)};h.prototype.NG=function(a){return this.Gh.yo(this.Ns(a))};h.prototype.GC=function(){this.Kw=!1;this.zr=-1;null==this.we&&(this.Tc.Dw=!1,this.we=new e(this),this.Tc.Oo=this.we);var b=new a.ia(0),h=null,l=null,f=0;this.WI=this.$I=-1;this.Ko=!1;for(var g=this.Hf.xc(-1);-1!=g;){f++;this.Ko=!1;var k=this.Hf.ja(g);
this.zr=this.jf(k);this.a.Nc(k,this.Th);this.we.QK(this.Th.y,this.Th.x);var r,m=this.Nl(this.zr);r=-1==m;if(!r){k=m;do{var q=this.Jq(k);-1==q?(this.Ih.add(k),this.um(k,-3)):-3!=q&&b.add(q);k=this.Kq(k,this.zr)}while(k!=m)}if(0<b.size){this.Ko=1==b.size&&1==this.Ih.size;r=0;for(m=b.size;r<m;r++)k=this.Tc.ja(b.get(r)),this.um(k,-2);var n=-2,w=-2;r=0;for(m=b.size;r<m;r++){q=b.get(r);if(-2==n){var x=this.Tc.Ve(q);-1!=x?(k=this.Tc.ja(x),k=this.Jq(k),-2!=k&&(n=x)):n=-1}-2==w&&(q=this.Tc.nb(q),-1!=q?(k=
this.Tc.ja(q),k=this.Jq(k),-2!=k&&(w=q)):w=-1);if(-2!=n&&-2!=w)break}r=0;for(m=b.size;r<m;r++)q=b.get(r),k=this.Tc.ja(q),this.Tc.Kd(q,-1),this.um(k,-1);b.clear(!1);this.$I=-1!=n?n:-1;this.WI=-1!=w?w:-1;-1!=n&&-1!=w?this.Ko||this.oQ(n,w):-1==n&&-1==w&&(this.Ko=!1)}else r&&(null==h&&(h=new d(this)),h.Yh(this.Th),this.Tc.lK(h),h.Ng&&(h.Gs(),this.xS(this.zr,h.rn)));this.sU();this.Kw?(this.Kw=!1,null==l&&(l=new c(this.a)),l.Yh(this.Th),g=this.Hf.lK(l)):g=this.Hf.nb(g)}return this.Lo};h.prototype.Yr=function(d){this.a=
d;this.Vh=this.a.Vd();this.ib.Qe(d.vd+32);this.Od.Qe(d.vd);this.Gh.pu(d.vd);this.Gh.Vn(d.vd);this.he.pu(d.vd+32);this.he.Vn(d.vd+32);for(d=this.a.sd;-1!=d;d=this.a.Ue(d))if(a.T.Ic(this.a.hc(d)))for(g=this.a.Pb(d);-1!=g;g=this.a.Sb(g)){var b=this.a.La(g),h=this.a.cb(g),c=this.Mn(h),e=this.cu(h);this.Jj(e,c);k=this.a.U(h);h=0;for(b-=2;h<b;h++){var l=this.a.U(k),f=this.Mn(k);this.Jj(e,f);e=this.cu(k);this.Jj(e,f);k=l}this.a.Qb(g)?(f=this.Mn(k),this.Jj(e,f),e=this.cu(k),this.Jj(e,f),this.Jj(e,c)):(f=
this.Mn(k),this.Jj(e,f))}else for(var g=this.a.Pb(d);-1!=g;g=this.a.Sb(g))for(var k=this.a.cb(g),c=0,b=this.a.La(g);c<b;c++)this.Mn(k),k=this.a.U(k);this.jS()};return h}();a.WD=h})(D||(D={}));(function(a){var b=function(b){function c(d,h,e){b.call(this);if(void 0!==d)if(void 0!==e){this.description=a.ye.Ig();var l=new a.qd;l.I(d,h,e);this.BC(l)}else if(void 0!==h)this.description=a.ye.Ig(),this.rb(d,h);else if(d instanceof a.ma)this.description=d;else if(d instanceof a.b)this.description=a.ye.Ig(),
this.rb(d);else if(d instanceof c)this.description=d.description,this.rb(d.Be(),d.nf()),null!==d.la&&(this.la=d.la.slice(0));else throw a.g.F();else this.description=a.ye.Ig()}F(c,b);c.prototype.w=function(d){if(void 0!==d){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");d.ka(this.la[0],this.la[1])}else{if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");d=new a.b;d.ka(this.la[0],this.la[1]);return d}};c.prototype.rb=function(a,
b){"number"===typeof a?(this.Bc(),null==this.la&&this.nq(),this.la[0]=a,this.la[1]=b):(this.Bc(),this.rb(a.x,a.y))};c.prototype.lA=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");var d=new a.qd;d.x=this.la[0];d.y=this.la[1];this.description.uH()?d.z=this.la[2]:d.z=a.ma.de(1);return d};c.prototype.BC=function(d){this.Bc();var b=this.hasAttribute(1);b||a.ma.PH(1,d.z)||(this.Ud(1),b=!0);null==this.la&&this.nq();this.la[0]=d.x;this.la[1]=d.y;b&&(this.la[2]=
d.z)};c.prototype.Be=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");return this.la[0]};c.prototype.AC=function(a){this.setAttribute(0,0,a)};c.prototype.nf=function(){if(this.Hc())throw a.g.X("This operation should not be performed on an empty geometry.");return this.la[1]};c.prototype.RK=function(a){this.setAttribute(0,1,a)};c.prototype.rH=function(){return this.Yc(1,0)};c.prototype.rY=function(a){this.setAttribute(1,0,a)};c.prototype.aH=function(){return this.Yc(2,
0)};c.prototype.bY=function(a){this.setAttribute(2,0,a)};c.prototype.yc=function(){return this.KG(3,0)};c.prototype.BK=function(a){this.setAttribute(3,0,a)};c.prototype.Yc=function(d,b){var h=this.description.mg(d);return 0<=h?this.la[this.description.xk(h)+b]:a.ma.de(d)};c.prototype.KG=function(d,b){var h=this.description.mg(d);return 0<=h?this.la[this.description.xk(h)+b]:a.ma.de(d)};c.prototype.setAttribute=function(a,b,c){this.Bc();var d=this.description.mg(a);0>d&&(this.Ud(a),d=this.description.mg(a));
null==this.la&&this.nq();this.la[this.description.xk(d)+b]=c};c.prototype.G=function(){return 33};c.prototype.tb=function(){return 0};c.prototype.Oa=function(){this.Bc();null!=this.la&&(this.la[0]=NaN,this.la[1]=NaN)};c.prototype.mo=function(d){if(null!=this.la){for(var b=a.ye.vx(d,this.description),c=[],e=0,l=0,f=d.Ga;l<f;l++){var g=d.rd(l),k=a.ma.Xa(g);if(-1==b[l])for(var m=a.ma.de(g),g=0;g<k;g++)c[e]=m,e++;else for(m=this.description.xk(b[l]),g=0;g<k;g++)c[e]=this.la[m],e++,m++}this.la=c}this.description=
d};c.prototype.nq=function(){this.bK(this.description.af.length);c.Bb(this.description.af,this.la,this.description.af.length);this.la[0]=NaN;this.la[1]=NaN};c.prototype.Xc=function(d){if(d instanceof a.Hd){if(!this.Hc()){var b=this.w();d.$h(b,b);this.rb(b)}}else this.Hc()||(this.Ud(1),b=this.lA(),this.BC(d.Rp(b)))};c.prototype.copyTo=function(d){if(33!=d.G())throw a.g.F();d.Bc();null==this.la?(d.Oa(),d.la=null,d.Fg(this.description)):(d.Fg(this.description),d.bK(this.description.af.length),c.Bb(this.la,
d.la,this.description.af.length))};c.prototype.Ka=function(){return new c(this.description)};c.prototype.u=function(){return this.Hc()};c.prototype.Hc=function(){return null==this.la||isNaN(this.la[0])||isNaN(this.la[1])};c.prototype.Qn=function(a){a.Oa();this.description!=a.description&&a.Fg(this.description);a.Nb(this)};c.prototype.s=function(a){this.Hc()?a.Oa():(a.o=this.la[0],a.A=this.la[1],a.v=this.la[0],a.B=this.la[1])};c.prototype.Cp=function(a){if(this.Hc())a.Oa();else{var d=this.lA();a.o=
d.x;a.A=d.y;a.Bf=d.z;a.v=d.x;a.B=d.y;a.$g=d.z}};c.prototype.xf=function(d,b){var h=new a.Ac;if(this.Hc())return h.Oa(),h;d=this.Yc(d,b);h.ca=d;h.ha=d;return h};c.prototype.bK=function(d){if(null==this.la)this.la=a.J.gf(d);else if(this.la.length<d){for(var b=this.la.slice(0),c=this.la.length;c<d;c++)b[c]=0;this.la=b}};c.Bb=function(a,b,c){if(0<c)for(c=0;c<a.length;c++)b[c]=a[c]};c.prototype.Eb=function(a){if(a==this)return!0;if(!(a instanceof c)||this.description!=a.description)return!1;if(this.Hc())return a.Hc()?
!0:!1;for(var d=0,b=this.description.af.length;d<b;d++)if(this.la[d]!=a.la[d])return!1;return!0};c.prototype.jc=function(){var d=this.description.jc();if(!this.Hc())for(var b=0,c=this.description.af.length;b<c;b++)var e=this.la[b],e=a.J.truncate(e^e>>>32),d=a.J.dh(e,d);return d};c.prototype.Gg=function(){return null};return c}(a.T);a.Wa=b})(D||(D={}));(function(a){var b=function(){function a(a,d,b){void 0!==a&&(this.x=a,this.y=d,this.z=b)}a.pa=function(b,d,h){var c=new a;c.x=b;c.y=d;c.z=h;return c};
a.prototype.I=function(a,d,b){this.x=a;this.y=d;this.z=b};a.prototype.Vx=function(){this.z=this.y=this.x=0};a.prototype.normalize=function(){var a=this.length();0==a&&(this.x/=a,this.y/=a,this.z/=a)};a.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};a.prototype.sub=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)};a.prototype.Vg=function(b){return new a(this.x*b,this.y*b,this.z*b)};a.prototype.dv=function(){this.x=NaN};a.prototype.Hy=function(){return isNaN(this.x)};
a.prototype.oi=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};return a}();a.qd=b})(D||(D={}));(function(a){var b=function(){function b(a,d,b){this.tx=this.dx=null;this.tg=d;this.DV=d.y-b;this.CV=d.y+b;this.Ir=0;this.MA=a;this.ta=b;this.PV=b*b;this.NA=0!=b;this.yw=!1}b.prototype.result=function(){return 0!=this.Ir?1:0};b.prototype.XO=function(b){b=b.gc(b.pe(this.tg,!1));return a.b.sc(b,this.tg)<=this.PV?!0:!1};b.prototype.oG=function(a){if(!this.NA&&(this.MA&&this.tg.ub(a.ec())||this.tg.ub(a.Cc())))this.yw=
!0;else if(a.ra==this.tg.y&&a.ra==a.oa){if(this.MA&&!this.NA){var d=Math.max(a.ua,a.sa);this.tg.x>Math.min(a.ua,a.sa)&&this.tg.x<d&&(this.yw=!0)}}else{var b=!1,d=Math.max(a.ua,a.sa);this.tg.x>d?b=!0:this.tg.x>=Math.min(a.ua,a.sa)&&(b=0<a.Tq(!0,this.tg.y,this.tx,null)&&this.tx[0]<=this.tg.x);if(b){if(this.tg.y==a.ec().y){if(this.tg.y<a.Cc().y)return}else if(this.tg.y==a.Cc().y&&this.tg.y<a.ec().y)return;this.Ir=this.MA?this.Ir^1:this.Ir+(a.ec().y>a.Cc().y?1:-1)}}};b.prototype.ku=function(a){var d=
a.xf(0,1);if(d.ca>this.CV||d.ha<this.DV)return!1;if(this.NA&&this.XO(a))return!0;if(d.ca>this.tg.y||d.ha<this.tg.y)return!1;null==this.dx&&(this.dx=[null,null,null,null,null]);null==this.tx&&(this.tx=[0,0,0]);d=a.qH(this.dx);if(0<d)for(a=0;a<d;a++){var b=this.dx[a].get();this.oG(b);if(this.yw)return!0}else if(this.oG(a),this.yw)return!0;return!1};b.$=function(a,d,h){d=new b(0==a.xo(),d,h);for(a=a.Fa();a.Ya();)for(;a.Ea();)if(h=a.ba(),d.ku(h))return-1;return d.result()};b.bd=function(c,d,h,e){var l=
new a.h;c.ac(l);l.O(e,e);var f=new b(0==c.xo(),h,e);c=c.Fa();var g=new a.h;g.I(l);g.v=h.x+e;g.A=h.y-e;g.B=h.y+e;h=d.Xz(g,e);for(e=h.next();-1!=e;e=h.next())if(c.Tb(d.ja(e)),c.Ea()&&(e=c.ba(),f.ku(e)))return-1;return f.result()};b.kn=function(c,d,h){if(c.u())return 0;var e=new a.h;c.ac(e);e.O(h,h);if(!e.contains(d))return 0;e=c.ob;if(null!=e){var l=e.Hi;if(null!=l){l=l.rm(d.x,d.y);if(1==l)return 1;if(0==l)return 0}e=e.Mb;if(null!=e)return b.bd(c,e,d,h)}return b.$(c,d,h)};b.WU=function(c,d,h,e){if(c.u())return 0;
var l=new a.h;c.ac(l);l.O(e,e);if(!l.contains(d,h))return 0;l=c.ob;if(null!=l&&(l=l.Hi,null!=l)){l=l.rm(d,h);if(1==l)return 1;if(0==l)return 0}return b.$(c,a.b.pa(d,h),e)};b.VU=function(a,d,h){return d.u()?0:b.kn(a,d.w(),h)};b.yA=function(c,d,h,e,f){var l=new a.h;c.ac(l);l.O(e,e);if(!l.contains(h))return 0;var g=new b(!0,h,e);if(null!=f){var k=new a.h;k.I(l);k.v=h.x+e;k.A=h.y-e;k.B=h.y+e;c=c.Fa();e=f.Xz(k,e);for(k=e.next();-1!=k;k=e.next())if(c.Tb(f.ja(k),d),c.Ea()&&c.Ta==d&&(k=c.ba(),g.ku(k)))return-1}else if(c=
c.Fa(),c.eC(d),c.Ya())for(;c.Ea();)if(k=c.ba(),g.ku(k))return-1;return g.result()};b.xA=function(c,d,h){var e=new a.h;c.ac(e);e.O(h,h);if(!e.contains(d))return 0;d=new b(!1,d,h);for(h=c.Fa();h.Ya();)if(!(0>c.Sm(h.Ta))){for(d.Ir=0;h.Ea();)if(e=h.ba(),d.ku(e))return-1;if(0!=d.Ir)return 1}return d.result()};b.Oi=function(c,d,h,e,f){var l=c.Fa();l.eC(d);if(!l.Ya()||!l.Ea())throw a.g.X("corrupted geometry");for(d=2;2==d&&l.Ea();)d=l.ba().gc(.5),d=b.yA(c,h,d,e,f);if(2==d)throw a.g.X("internal error");return 1==
d?!0:!1};b.qm=function(a,d){a=a.D();return 16>a?!1:2*a+Math.log(a)/Math.log(2)*1*d<1*a*d};return b}();a.ff=b})(D||(D={}));(function(a){var b=function(a){function b(d){a.call(this,!0,d)}F(b,a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.tb=function(){return 2};b.prototype.G=function(){return 1736};b.prototype.KH=function(a,b,c){this.EU(a,b,c)};b.prototype.gT=function(){this.yT()};return b}(a.xl);a.Ja=b})(D||(D={}));(function(a){(function(a){a[a.PiPOutside=0]="PiPOutside";
a[a.PiPInside=1]="PiPInside";a[a.PiPBoundary=2]="PiPBoundary"})(a.HN||(a.HN={}));var b=function(){function b(){}b.WH=function(b,d,h){b=a.ff.VU(b,d,h);return 0==b?0:1==b?1:2};b.ge=function(b,d,h){b=a.ff.kn(b,d,h);return 0==b?0:1==b?1:2};b.cX=function(b,d,h,c){b=a.ff.WU(b,d,h,c);return 0==b?0:1==b?1:2};b.m_=function(b,d,h,c){return 0==a.ff.yA(b,d,h,c,null)?0:1};b.xA=function(b,d,h){return 0==a.ff.xA(b,d,h)?0:1};b.MR=function(c,d,h,e,f){if(d.length<h||f.length<h)throw a.g.F();for(var l=0;l<h;l++)f[l]=
b.ge(c,d[l],e)};b.XR=function(c,d,h,e,f){if(d.length/2<h||f.length<h)throw a.g.F();for(var l=0;l<h;l++)f[l]=b.cX(c,d[2*l],d[2*l+1],e)};b.fL=function(c,d,h,e,f){if(1736==c.G())b.MR(c,d,h,e,f);else if(197==c.G()){var l=new a.h;c.s(l);b.NM(l,d,h,e,f)}else throw a.g.X("invalid_call");};b.v_=function(c,d,h,e,f){if(1736==c.G())b.XR(c,d,h,e,f);else if(197==c.G()){var l=new a.h;c.s(l);b.RM(l,d,h,e,f)}else throw a.g.Da();};b.NM=function(b,d,h,c,e){if(d.length<h||e.length<h)throw a.g.F();if(b.u())for(c=0;c<
h;c++)e[c]=0;else for(b.O(.5*-c,.5*-c),b.O(.5*c,.5*c),c=0;c<h;c++)b.contains(d[c])?e[c]=1:b.contains(d[c])?e[c]=2:e[c]=0};b.RM=function(b,d,h,c,e){if(d.length/2<h||e.length<h)throw a.g.F();if(b.u())for(c=0;c<h;c++)e[c]=0;else for(b.O(.5*-c,.5*-c),b.O(.5*c,.5*c),c=0;c<h;c++)b.contains(d[2*c],d[2*c+1])?e[c]=1:b.contains(d[2*c],d[2*c+1])?e[c]=2:e[c]=0};b.ZT=function(a,d,b,c,e){for(var h=0;h<b;h++)e[h]=a.mt(d[h],c)?2:0};b.iS=function(a,d,b,c,e){var h=a.ob,l=null;null!=h&&(l=h.Hi);for(var h=b,f=0;f<b;f++)if(e[f]=
1,null!=l){var g=d[f];0==l.rm(g.x,g.y)&&(e[f]=0,h--)}if(0!=h)for(a=a.Fa();a.Ya()&&0!=h;)for(;a.Ea()&&0!=h;)for(l=a.ba(),f=0;f<b&&0!=h;f++)1==e[f]&&l.mt(d[f],c)&&(e[f]=2,h--);for(f=0;f<b;f++)1==e[f]&&(e[f]=0)};b.gL=function(c,d,h,e,f){var l=c.G();if(1607==l)b.iS(c,d,h,e,f);else if(a.T.Oc(l))b.ZT(c,d,h,e,f);else throw a.g.X("Invalid call.");};return b}();a.gd=b})(D||(D={}));(function(a){var b=function(a){function b(d,b){2==arguments.length?(a.call(this,!1,d.description),this.Rf(d),this.lineTo(b)):a.call(this,
!1,d)}F(b,a);b.prototype.Ka=function(){return new b(this.description)};b.prototype.tb=function(){return 1};b.prototype.G=function(){return 1607};b.prototype.KH=function(a,b,c,e){this.FU(a,b,c,e)};return b}(a.xl);a.Ua=b})(D||(D={}));(function(a){var b=function(){function a(){}a.$_=function(){};return a}();a.d_=b})(D||(D={}));(function(a){(function(a){a[a.clipWithInputHorizon=1]="clipWithInputHorizon";a[a.clipWithOutputHorizon=2]="clipWithOutputHorizon"})(a.eM||(a.eM={}));var b=function(){function a(){this.Jl=
3;this.uz=this.yv=NaN}a.prototype.bU=function(){return this.et(1)};a.prototype.cU=function(){return this.et(2)};a.prototype.et=function(a){return 0!=(this.Jl&a)};a.prototype.Vf=function(){var d=new a;d.yv=this.yv;d.uz=this.uz;d.Jl=this.Jl;return d};return a}();a.OZ=b;(function(a){a[a.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon";a[a.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"})(a.fM||(a.fM={}));var c=function(){function a(){this.Jl=0}a.prototype.et=function(a){return 0!=
(this.Jl&a)};a.oe=function(d){var b=new a;b.Jl=d.Jl;return b};a.prototype.EO=function(a){this.Jl=a.Jl};return a}();a.PZ=c;var e=function(){function d(d,b,c){this.je=d;this.He=b;this.rg=new a.h;this.rg.I(c);this.yV=d.jc()+b.jc()+this.rg.jc().toString()}d.prototype.jc=function(){return this.yV};d.prototype.Eb=function(a){return this==a||this.je.Eb(a.je)&&this.He.Eb(a.He)&&this.rg.Eb(a.rg)};return d}();a.e_=e;e=function(){function d(){this.He=this.je=null;this.DI=new b;this.EI=new c;this.xr=this.ue=
null;this.sr=this.Tl=!0}d.Is=function(a,b,c,e){var h;void 0===e&&(e=null);void 0===h&&(h=null);var l=new d;l.kq(a,b,c,e,h);return l};d.prototype.kq=function(d,b,c,e,l){if(null==d||null==b)throw a.g.X("invalidArgument");this.je=d;this.He=b;this.sr=this.Tl=!1;null!=e&&(this.DI=e.Vf());null!=l&&this.EI.EO(l);l=!1;1==b.Fb()&&null!=e&&(e=e.yv,isNaN(e)||0==e||(l=!0));if(d==b)this.Tl=!l,this.sr=!0;else{e=d.Fb();var h=b.Fb();if(0==e||0==h){if(null!=c)throw a.g.F();null!=d.Nd()&&null!=b.Nd()&&(this.Tl=d.Nd().Eb(b.Nd()))}else 3==
e||3==h?this.Tl=d.Eb(b):this.je.hU(this.He)?this.Tl=!l:this.Tl=!1,this.ue=c,null!=this.ue&&this.ue.Mp(),this.sr=(null==this.ue||0==this.ue.count())&&this.je.kc().Eb(this.He.kc())}this.wL()};d.prototype.Wv=function(){var a=new d;a.je=this.He;a.He=this.je;null!=this.ue&&(a.ue=this.ue.Wv());a.Tl=this.Tl;a.sr=this.sr;a.wL();return a};d.prototype.Ho=function(){return this.Tl};d.prototype.eT=function(){return this.DI.Vf()};d.prototype.Eb=function(a){return a==this?!0:a instanceof d&&this.je.Eb(a.je)&&this.He.Eb(a.He)?
this.ue==a.ue?!0:null!=this.ue&&null!=a.ue&&this.ue.Eb(a.ue)?!0:!1:!1};d.prototype.wL=function(){this.xr=new a.ko(this)};d.u_={};return d}();a.rs=e})(D||(D={}));(function(a){var b=function(){function b(){}b.uq=function(a){return a*b.oO};b.Wx=function(a,h){return b.UN(h-a)};b.bO=function(d){if(-360<=d&&720>d)return 0>d?d+=360:360<=d&&(d-=360),d;d=a.Ub.gM(d);0>d&&(d+=360);return d};b.UN=function(a){a=b.bO(a);180<a&&(a-=360);return a};b.QZ=.0174532925199433;b.oO=57.29577951308232;return b}();a.ls=b;
var c=function(){function c(){}c.Mj=function(d,b){var h=new a.h;d.s(h);var c=a.fb.Bh(b),e=new a.h;e.I(c);e.o=h.o;e.v=h.v;e.O(.01*e.fa(),0);c=a.na.be(b,h,!1);return e.contains(h)?d:a.ne.clip(d,e,c,0)};c.ht=function(d,b,e,l,f){if(!a.fb.Jc(b))throw a.g.F();var h=a.na.ah(b,d,!1),g=a.fb.Bh(b),k=a.fb.kc(b),r=k.Nd().Ai,m=a.fb.hw(k),k=a.fb.Sv(k),m=m*(2-m),q=new a.Ac;g.Sn(q);var n=[[0,0],[0,0]];2==a.Sd.Fb(b)?l?(n[0][0]=c.Nn(f,q),n[0][1]=g.Cq(),a.fb.lu(),g=n[0][0]*r):(n[0][0]=g.Hk(),n[0][1]=f,a.fb.lu(),g=n[0][1]*
r):g=f*r;if(!l&&0!=g)throw a.g.F();var w=new a.ea,x=new a.fd;d=x.Jb(d);for(var p=[0],u=new a.b,B=new a.b,z=new a.b,v=new a.b,y=new a.b,t=new a.b,C=x.Pb(d);-1!=C;C=x.Sb(C)){var A=x.cb(C);x.w(A,z);for(var E=!1,F=A=x.U(A);-1!=F;F=x.U(F)){if(F==A){if(E)break;E=!0}x.w(F,v);if(l&&h<f-z.x&&v.x-f>h||h<f-v.x&&z.x-f>h||!l&&h<-z.y&&v.y>h||h<-v.y&&z.y>h){do if(!(Math.abs(z.x-v.x)>=.5*q.N())){2==a.Sd.Fb(b)?(n[0][0]=c.Nn(z.x,q),n[0][1]=z.y,n[1][0]=c.Nn(v.x,q),n[1][1]=v.y,a.fb.UW(),y.x=n[0][0]*r,y.y=n[0][1]*r,t.x=
n[1][0]*r,t.y=n[1][1]*r):(y.x=z.x*r,y.y=z.y*r,t.x=v.x*r,t.y=v.y*r);t.x=6.283185307179586*(v.x-z.x)/q.N()+y.x;if(l){if(B.x=g,B.y=c.EB(k,m,y,t,g,e),isNaN(B.y))break}else{B.x=c.CB(k,m,y,t,e);if(isNaN(B.x))break;B.y=0}a.mb.Ld(k,m,y.x,y.y,t.x,t.y,w,null,null,e);var D=w.j;a.mb.Ld(k,m,y.x,y.y,B.x,B.y,w,null,null,e);var G=w.j;2==a.Sd.Fb(b)?(n[0][0]=B.x/r,n[0][1]=B.y/r,a.fb.TS(),l?(u.y=n[0][1],u.x=f):(u.x=c.Zp(n[0][0],z.x,v.x,q),u.y=f)):l?(u.x=f,u.y=B.y/r):(u.x=c.Zp(B.x/r,z.x,v.x,q),u.y=f);p[0]=0<D?a.J.pk(G/
D,0,1):.5;0!=p[0]&&1!=p[0]&&(D=x.Ra(F),x.zm(D,p,1),x.rb(x.U(D),u.x,u.y))}while(0)}z.L(v)}}return x.Se(d)};c.Xm=function(d,b,e,l,f){if(d.u())return d;var h=a.fb.ee(b);return c.Aq(d,e-180*h,360*h,b,l,f,!0)};c.EB=function(d,b,e,l,f,g){if(3.141592653589793<=Math.abs(e.x-l.x)||!c.Cj(e.x,l.x,f))return NaN;var h;e.x>l.x?h=l:(h=e,e=l);l=new a.ea(0);var k=new a.ea(0),r=new a.ea(0);a.mb.Ld(d,b,h.x,h.y,e.x,e.y,k,l,null,g);var m=k.j,q=0,n=1,w=new a.b;for(w.L(h);m*(n-q)>1E-12*d;){var x=.5*(q+n);a.mb.Oj(d,b,h.x,
h.y,m*x,l.j,k,r,g);w.x=k.j;w.y=r.j;if(w.x==f)break;if(c.Cj(h.x,w.x,f))n=x;else if(c.Cj(e.x,w.x,f))q=x;else return NaN}return w.y};c.Cj=function(a,h,c){a=b.uq(a);h=b.Wx(a,b.uq(h));c=b.Wx(a,b.uq(c));return 0==c||0<h&&0<c&&c<=h||0>h&&0>c&&c>=h?!0:!1};c.Nn=function(a,b){var d=b.ha-b.ca;return b.wu(a-Math.floor((a-b.ca)/d)*d)};c.Zp=function(d,b,c,e){var h=new a.Ac;h.I(b,c);c=e.N();d=Math.floor((d-b)/c)*c+d;for(h=h.Wf();Math.abs(d-h)>Math.abs(d+c-h);)d+=c;return d};c.CB=function(d,b,c,e,l){var h;c.y>e.y?
h=e:(h=c,c=e);e=new a.Ac;e.I(h.y,c.y);if(!e.contains(0)||3.141592653589793<=Math.abs(h.x-c.x))return NaN;if(h.x==c.x)return h.x;var f=new a.ea(0),g=new a.ea(0),k=new a.ea(0);a.mb.Ld(d,b,h.x,h.y,c.x,c.y,g,f,null,l);var r=g.j,m=0,q=1,n=new a.b;for(n.L(h);r*(q-m)>1E-12*d;){var w=.5*(m+q);a.mb.Oj(d,b,h.x,h.y,r*w,f.j,g,k,l);n.x=g.j;n.y=k.j;e.I(h.y,n.y);if(0==n.y)break;if(e.contains(0))q=w;else if(e.I(c.y,n.y),e.contains(0))m=w;else return NaN}return n.x};c.Aq=function(d,b,c,e,l,f,g){var h=new a.h;d.s(h);
if(h.u())return d;var k=new a.Ac;h.Sn(k);var r=new a.Ac;r.I(b,b+c);if(r.contains(k)&&r.ha!=k.ha)return d;var m=new a.h;m.I(h);var q=d.G();if(33==q){m=l?d:d.Vf();h=m.Be();if(h<r.ca||h>=r.ha||g&&h==r.ha)h+=Math.ceil((r.ca-h)/c)*c,h=r.wu(h),m.AC(h);return m}if(550==q){m=l?d:d.Vf();e=m.Pa(0);q=2*m.D();d=!1;for(l=0;l<q;l+=2)if(h=e.read(l),h<r.ca||h>=r.ha||g&&h==r.ha)d=!0,h+=Math.ceil((r.ca-h)/c)*c,h=r.wu(h),e.write(l,h);d&&m.Dc(1993);return m}if(r.contains(k))return d;if(197==q)return c=l?d:d.Vf(),h.Ma(m),
c.Gp(h),c;var n=.1*Math.max(h.fa(),h.N());m.O(0,n);g=d;r=e.re(0);d=a.ei.local();l=new a.Hd;for(var w=0;;){var x=Math.floor((k.ca-b)/c),p=Math.ceil((k.ha-b)/c);if(3<p-x){x=Math.floor(.5*(p+x));m.o=h.o-n;m.v=b+c*x;var u=a.ne.clip(g,m,r,f);m.o=m.v;m.v=h.v+n;var B=a.ne.clip(g,m,r,f);l.Ag((x-p)*c,0);B.Xc(l);1736==q?g=d.V(u,B,e,null):(g=u,g.add(B,!1));g.s(h);h.Sn(k);w++}else break}m.o=b;m.v=b+c;b=new a.h;b.I(m);b.O(r,0);b=Math.floor((h.o-m.o)/c)*c;0!=b?(m.move(b,0),l.Ag(-b,0)):l.pC();b=1607==q?new a.Ua(g.description):
new a.Ja(g.description);f=new a.h;for(k=new a.h;h.v>m.o;){n=a.ne.clip(g,m,r,0);n.s(k);if(1607==q?!n.u()&&(k.N()>r||k.fa()>r):!n.u()&&(1736!=q||k.N()>r))n.Xc(l),n.s(k),b.s(f),f.O(r,r),f.Yb(k)&&1736==q?b=d.V(b,n,e,null):b.add(n,!1);m.move(c,0);l.shift(-c,0)}return b};c.OJ=function(d,b,c,e,l){var h=new a.Ed(c.description);h.Id(c,0,-1);l=a.fb.Xg(h,d,b,l);h=c.D();e.Oa();if(!a.fb.Jc(d)||h!=l.D())return!1;var f=new a.h;c.s(f);var g=new a.h;l.s(g);f=f.N();g=g.N();if(0!=f&&0!=g){if(g/=f,d=a.fb.Bh(b).N()/a.fb.Bh(d).N(),
1E-10<Math.abs(g/d-1))return!1}else if(0!=f||0!=g)return!1;e.add(c,!1);for(c=0;c<h;c++)d=l.Ba(c),e.rb(c,d);return!0};c.uA=function(){throw a.g.df();};return c}();a.gi=c})(D||(D={}));(function(a){(function(a){a[a.Clip=0]="Clip";a[a.DontClip=1]="DontClip";a[a.PannableFold=2]="PannableFold"})(a.di||(a.di={}));var b=a.di;(function(a){a[a.Geodesic=0]="Geodesic";a[a.Loxodrome=1]="Loxodrome";a[a.GreatElliptic=2]="GreatElliptic";a[a.NormalSection=3]="NormalSection";a[a.ShapePreserving=4]="ShapePreserving"})(a.lD||
(a.lD={}));var c=a.lD,e=function(){function d(){}d.iw=function(d,b,c){if(c||0<b){d=d.toString(a.Vc.PE_STR_NAME_CANON|a.Vc.PE_STR_AUTH_NONE);b=[];for(c=0;c<d.length;c++)b[c]="a"<=d[c]&&"z">=d[c]?b[c]=d[c].toUpperCase():d[c];return b.join()}return d.toString(a.Vc.PE_STR_AUTH_TOP)};d.qs=function(d,b,c,e){var h=e.length,l=c.D();if(0!=l){var f=c.Pa(0),g=Math.min(l,h),k=0,m=d.Kg();isNaN(b)&&(b=0);var r=d.Jc();d=r?d.kc().qe().N():0;for(var q=179*d/360;0<l;){f.Hx(k<<1,g,e,0,!0);a.fi.projToGeogCenter(m,g,
e,b);if(r)for(var n=0;n<g;n++){var w=e[n][0]-b,x=a.Ub.sign(w),p=f.read(2*(k+n));0>x*a.Ub.sign(p)&&Math.abs(w)>q&&(e[n][0]+=-x*d)}f.hy(k<<1,g,e,0,!0);k+=g;l-=g;g=Math.min(l,h)}c.Dc(1993)}};d.J_=function(d,b,c,e){var h=d.Kg();isNaN(b)&&(b=0);var l=c.Be();e[0][0]=l;e[0][1]=c.nf();a.fi.projToGeogCenter(h,1,e,b);d.Jc()&&(b=a.Ub.sign(e[0][0]-b),0>b*a.Ub.sign(l)&&(d=d.kc().qe().N(),Math.abs(e[0][0])>179*d/360&&(e[0][0]-=b*d)));c.rb(e[0][0],e[0][1])};d.wN=function(d,b,c,e){var h=0,l=d.Kg();isNaN(h)&&(h=0);
var f=d.Jc(),g=d.ee();d=360*g;for(var g=179*g,k=e.length,m=0;m<c;){for(var r=m;r<c&&b[r].isNaN();++r)m++;var q=Math.min(k,c-m);if(0<q){for(var r=1,n=m+1;r<q;++r,++n)if(b[n].isNaN()){q=r;break}a.na.oz(e,b,m,q);a.fi.projToGeogCenter(l,q,e,h);if(f)for(r=0,n=m;r<q;++r,++n){var w=b[n].x,x=e[r][0]-h,p=a.Ub.sign(x);0>p*a.Ub.sign(w)&&Math.abs(x)>g&&(e[r][0]-=p*d)}a.na.nz(b,m,e,q);m+=q}}};d.vy=function(d,b,c){var h=c.length,e=b.D();if(!(1>e)){var l=b.Pa(0),f=Math.min(e,h),g=0,k=d.Kg(),m=d.Jc(),r=m?d.qe().N():
0,q=179*r/360,n=0;for(m&&(n=d.pi());0<e;){l.Hx(g<<1,f,c,0,!0);a.fi.geogToProj(k,f,c);if(m)for(d=0;d<f;d++){var w=c[d][0],x=a.Ub.sign(w),p=l.read(2*(g+d))-n;0>x*a.Ub.sign(p)&&Math.abs(w)>q&&(c[d][0]+=-x*r)}l.hy(g<<1,f,c,0,!0);g+=f;e-=f;f=Math.min(e,h)}b.Dc(1993)}};d.B_=function(d,b,c){if(!b.u()){var h=d.Kg();c[0][0]=b.Be();c[0][1]=b.nf();a.fi.geogToProj(h,1,c);if(d.Jc()){var h=a.Ub.sign(c[0][0]),e=d.pi();0>h*a.Ub.sign(b.Be()-e)&&(d=d.qe().N(),Math.abs(c[0][0])>179*d/360&&(c[0][0]-=h*d))}b.rb(c[0][0],
c[0][1])}};d.vN=function(d,b,c,e){if(0!=c){var h=d.Kg(),l=d.Jc(),f=l?d.qe().N():0,g=179*f/360,k=0;l&&(k=d.pi());for(d=0;d<c;){for(var m=d;m<c&&b[m].isNaN();++m)d++;var r=Math.min(e.length,c-d);if(0<r){for(var m=1,q=d+1;m<r;++m,++q)if(b[q].isNaN()){r=m;break}a.na.oz(e,b,d,r);a.fi.geogToProj(h,r,e);if(l)for(m=0,q=d;m<r;m++){var n=e[m][0],w=a.Ub.sign(n);0>w*a.Ub.sign(b[q].x-k)&&Math.abs(n)>g&&(e[m][0]-=w*f)}a.na.nz(b,d,e,r);d+=r}}}};d.ps=function(d,b,c,e){var h=b.D();if(0!=h){var l=b.Pa(0),f=d.je,g=
d.He,k=f.kc().Yi(),m=g.kc().Yi(),r=f.ee(),q=g.ee();d=d.ue;if(null==d||0==d.count()){c=k/m;e=(f.dn()-g.dn())*q;m=-90*r;d=90*r;k=!1;q=1;for(f=2*h;q<f;)r=l.get(q),g=a.J.pk(r,m,d),g!=r&&(l.set(q,g),k=!0),q+=2;if(0!=e||1!=c)for(k=!0,m=new a.b,q=0;q<h;q++)l.fc(2*q,m),m.x*=c,m.x+=e,m.y*=c,l.fo(2*q,m);k&&b.Dc(1993)}else{var f=e.length,g=Math.min(h,f),n=a.J.gf(g),w=null,x=0,p=NaN,u=NaN,B=360*q,z=q/r;c&&(u=90*q,p=89.9*r,w=a.J.gf(g));for(var v=!0,t=0;0!=h;){r=!1;l.Hx(x<<1,g,e,0,!0);for(q=0;q<g;q++)n[q]=e[q][0];
if(c)for(q=0;q<g;q++){var y=Math.abs(e[q][1])-p;0<y&&(r=e[q][1],e[q][1]=a.Ub.Fl(p,r),w[q]=a.Ub.Fl(y,r),r=!0)}q=e[0][0];d.transform(e,g,k,m);v&&(t=e[0][0]-z*q,v=!1);for(q=0;q<g;q++)y=e[q][0]-n[q]*z-t,200<Math.abs(y)&&(e[q][0]=0<y?e[q][0]-B:e[q][0]+B);if(r){for(q=0;q<g;q++)0!=w[q]&&(e[q][1]+=z*w[q],e[q][1]>u?e[q][1]=u:e[q][1]<-u&&(e[q][1]=-u));for(r=0;r<g;r++)w[r]=0}l.hy(x<<1,g,e,0,!0);x+=g;h-=g;g=Math.min(h,f)}b.Dc(1993)}}};d.A_=function(d,b,c,e){if(b.u())return!1;var h=d.je,l=d.He,f=d.ue,g=h.kc().Yi(),
k=l.kc().Yi();e[0][0]=b.Be();e[0][1]=b.nf();if(null!=f&&0<f.count()){d=!0;var m=!1,r=NaN,q=0,n=1;c&&(c=h.ee(),r=l.ee(),n=r/c,r*=90,h=89.9*c,l=Math.abs(e[0][1])-h,0<l&&(m=e[0][1],e[0][1]=a.Ub.Fl(h,m),q=a.Ub.Fl(l,m),m=!0));f.transform(e,1,g,k);m&&0!=q&&(e[0][1]+=n*q,e[0][1]>r?e[0][1]=r:e[0][1]<-r&&(e[0][1]=-r));b.rb(e[0][0],e[0][1])}else{c=h.ee();d=a.J.pk(e[0][1],-90*c,90*c)!=e[0][1];r=l.ee();f=(h.dn()-l.dn())*r;g/=k;if(1!=g||0!=f)d=!0,e[0][0]*=g,e[0][0]+=f,e[0][1]*=g;d&&b.rb(e[0][0],e[0][1])}return d};
d.uN=function(d,b,c,e){var h;if(d.sr)e=90*d.je.ee(),a.na.VK(b,c,-e,e);else{var l=d.ue,f=d.je,g=d.He;d=f.Xs();var k=g.Xs(),m=f.ee(),r=90*m,q=g.ee();if(null==l||0==l.count()){if(e=d/k,l=(f.dn()-g.dn())*q,a.na.VK(b,c,-r,r),0!=l||1!=e)for(q=0;q<c;q++)b[q].x*=e,b[q].x+=l,b[q].y*=e}else for(var f=Math.min(c,e.length),r=a.J.gf(f),g=360*q,m=q/m,n=!0,w=0,x=0;0!=c;){for(q=0;q<f;q++)r[q]=b[q+x].x;q=b[0].x;a.na.oz(e,b,x,f);l.transform(e,f,d,k);a.na.nz(b,x,e,f);n&&(w=b[0].x-m*q,n=!1);for(q=0;q<f;q++)h=b[x+q].x-
r[q]*m-w,200<Math.abs(h)&&(b[x+q].x=0<h?b[x+q].x-g:b[x+q].x+g);x+=f;c-=f;f=Math.min(c,e.length)}}};d.ZZ=function(a,b,c,e){return d.Xm(a,b,isNaN(c)?0:c,!0,e,null)};d.Vu=function(a,d){a=a.Bh();isNaN(d)||a.xv(d,0);return a};d.KS=function(b,c,e,l,f,g,k,m){for(var h=d.Vu(l,f),r=h.N(),q=r/360,n=d.kE*q,w=b.Pa(0),x=c.Jc(),p=x?r/c.qe().N():0,u=!1,B=new a.Ja(e.description),z=0,v=e.aa();z<v;++z){var t=x,y=new a.Ua(e.description);y.Ti(e,z,!0);if(0!=k){var C=d.aE(!0,y,h.B-m,h.B,k);(u=u||C)&&(t=!1)}var E=-1;t&&
(E=b.wa(z));var F=y.Pa(0),A=y.D(),D=0,G=F.read(0),H=0,C=3*l.re(0),I=!1,K=new a.b;K.$c();var M=new a.b;M.$c();for(var J=!1,P=1;P<A;++P){var L=a.b.pa(F.Of(2*P),F.Of(2*P+1)),Q=L.x,O=Q+D,va=O-G;L.x=O;if(Math.abs(va)>n){if(t){var W=E+(P+1<A?P:0),S=w.read(2*(E+P-1)),W=(w.read(2*W)-S)*p;Math.abs(va-W)>1*q&&(t=!1)}t||(D-=a.Ub.Fl(r,O-G),O=Q+D,++H,J=0!=D,L.x=O)}else I||a.na.NH(M,K,L,C)&&(I=!0);J&&F.write(2*P,O);G=O;M.L(K);K.L(L)}0<H&&y.Dc(1993);t=y.Ba(0);A=y.Ba(A-1);y=a.b.Cb(t,A)<C?d.TR(y,l,f,g,I):d.gS(b,z,
y,l,f);B.add(y,!1)}f=l.re(0);e=h.N()/180;d.xu(B,h,.1*f,!1);f=a.uh.clip(B,h,f,e,g);B=B!=f;b=b.hf();m=f.hf();k=0;0<m&&0>b?k=1:0>=m&&0<b&&(0==m?(m=NaN,2==c.Fb()?m=c.Mk().hf():1==c.Fb()&&(m=c.qe().IG()),b>.99*m&&(k=-1)):k=-1);0!=k&&(c=new a.Ja(f.description),c.oq(h),c=a.Jm.local().V(c,e,g),c.add(f,!1),B=!0,f=c);B&&(f=a.Km.local().V(f,l,!1,g));return f};d.gS=function(b,c,e,l,f){var h=e.D(),g=e.Ba(0),k=e.Ba(h-1);l=d.Vu(l,f);f=l.N();var g=a.Ub.sign(k.x-g.x),m=new a.h;e.ac(m);var r=l.Hk(),q,k=r-f,r=r+f;if(0<=
g){for(var n=Math.ceil((k-m.o)/f),n=n*f;k>m.o+n;)n+=f;for(;k<m.v+n;)n-=f;q=n;720<m.N()&&(r=k+360*Math.ceil(m.N()/360))}else{n=Math.ceil((r-m.v)/f);for(n*=f;r<m.v+n;)n-=f;for(;r>m.o+n;)n+=f;q=n;720<m.N()&&(k=r-360*Math.ceil(m.N()/360))}var n=g*f,w=a.h.pa(m.o,m.A,m.v,m.B);w.move(q,0);var x=new a.Hd;x.Ag(q,0);e.Xc(x);m=new a.Ua(e.description);m.add(e,!1);q=e.Ba(h-1);f=0;for(var p=m.Ba(0).x,u=0;0<g?w.v<r:w.o>k;)1024<=u&&(u=0),w.move(n,0),x.Wb=n,e.Xc(x),p+=n,l.o<=p&&l.v>=p&&(f=m.D()-1),e.rb(0,q),q=e.Ba(h-
1),m.Bs(e,0,0,h-1,!1);e=new a.Ja(m.description);h=0<b.Sm(c);e.add(m,!1);b=m.Ba(0);k=m.Ba(m.D()-1);c=e.aa()-1;(0>g?h:!h)?(g=a.b.pa(k.x,l.B),e.aj(g),g=a.b.pa(l.Hk(),l.B),e.aj(g),l=a.b.pa(b.x,l.B)):(g=a.b.pa(k.x,l.A),e.aj(g),g=a.b.pa(l.Hk(),l.A),e.aj(g),l=a.b.pa(b.x,l.A));e.aj(l);e.KH(0,c,0);e.nQ(f);return e};d.TR=function(b,c,e,l,f){var h=new a.Ja(b.description);h.add(b,!1);h.cC(0,h.D()-1);var g=new a.h;h.ac(g);e=d.Vu(c,e);for(var k=e.N(),m=Math.ceil((e.o-g.o)/k),m=m*k;e.o>g.o+m;)m+=k;for(;e.o<g.v+
m;)m-=k;m+=k;if(0!=m){g.move(m,0);var r=new a.Hd;r.Ag(m,0);h.Xc(r)}if(e.o<=g.o&&e.v>g.v)return f&&(f=h.hf(),h=a.Km.local().V(h,c,!0,l),c=h.hf(),(c=a.Ub.sign(f)!=a.Ub.sign(c))&&h.eK()),h;b=new a.Ja(b.description);b.add(h,!1);for(f=f||g.N()>k-c.re(0);g.o<e.v;)g.move(k,0),r=new a.Hd,r.Ag(k,0),h.Xc(r),b.add(h,!1);f&&(f=b.hf(),b.Hp(1),b=a.Km.local().V(b,c,!0,l),c=b.hf(),(c=a.Ub.sign(f)!=a.Ub.sign(c))&&b.eK());return b};d.aE=function(d,b,c,e,l){for(var h=b.Pa(0),f=b.D(),g=!1,k=0;k<f;k++){var m=a.b.pa(h.Of(2*
k),h.Of(2*k+1));if(0!=(l&1)&&m.y>=c){g=!0;break}if(0!=(l&2)&&m.y<=-c){g=!0;break}}if(!g)return!1;h=!1;d&&(h=b.Eo(0));d=new a.fd;var f=d.Jb(b),g=d.Pb(f),r=-1,q=!0,n=new a.b;n.$c();for(var k=new a.Wa,w=-1,x=d.cb(g);-1!=x;x=d.U(x)){var m=d.Ba(x),p=0!=(l&1)&&90<=m.y?1:0,p=p|(0!=(l&2)&&m.y<=-c?2:0);if(0<r&&r!=p){if(n.x!=m.x){n.x=m.x;d.wj(d.Ra(x),k);var u=d.Wj(g,x,k);d.Qf(u,n)}if(h)for(w=-1!=w?d.U(w):d.cb(g),u=d.Ra(x);w!=u;)w=d.ud(w,!1);w=-1}0<p&&(m.y=a.Ub.Fl(e,m.y),d.Qf(x,m),q||r==p||(m.x!=n.x?(d.wj(x,
k),u=d.Wj(g,x,k),d.rb(u,n.x,m.y),w=u):w=x));r=p;n=m;q=!1}if(h){if(-1!=w)for(w=d.U(w);-1!=w;)w=d.ud(w,!1);c=d.cb(g);d.Uq(c,d.Rj(g))||(d.wj(c,k),d.Wj(g,-1,k))}d.Se(f).copyTo(b);return!0};d.zZ=function(a,d){var b=0,c=a.La(d);d+=1;for(var h=a.aa();d<h&&!(0<a.Sm(d));++d)b++;return 64<c&&3<=b};d.tA=function(c,e,l,f){var h=c;if(h.u()||l==b.DontClip)return h;var g=h.G();if(33==g)return f=h,h=[f.w()],d.LH(h,1,e,l),h[0].isNaN()?f.Oa():f.rb(h[0]),c;c=e.kc();var k=c.ee(),m=90*k,r=180*k,q=360*k,n=e.pi(),w=.5*
k,x=new a.h;h.s(x);var p=e.Vs(),u=e.DS(),B=197==p.G();e=new a.h;p.s(e);l==b.PannableFold&&(l=c.qe().N(),e.o=n-.5*l,e.v=e.o+l);if(x.A<-m||x.B>m){(new a.h).I(x.o-k,-m,x.v+k,m);h=a.uh.rq(h,e,c,NaN,0,f);if(h.u())return h;h.s(x)}if(u&&(e.B<x.A||e.A>x.B))return h.Ka();x.N()>q&&(h=d.Aq(h,n-r,q,c,!0,0,!0,f),h.s(x));m=d.CN(x.o,x.v,e.o,e.v,q);0!=m&&x.move(m,0);if(x.v>e.v||x.o<e.o){if(x.v>e.v)for(;x.o>=e.v;)x.move(-q,0),m-=q;for(;x.o<e.v-q;)x.move(q,0),m+=q}l=a.na.vv(c,p);0!=m&&(k=new a.Hd,k.Ag(m,0),h.Xc(k));
if(u){if(B&&e.contains(x))return h;u=[null,null];for(m=0;2>m;m++){B?k=a.T.Ic(g)?a.uh.clip(h,e,l,w,f):a.uh.clip(h,e,l,0,f):(k=a.tk.local().V(h,p,c,f),k==p&&(k=a.T.oe(k)));if(e.o<=x.o&&e.v>=x.v||e.o>=x.o&&e.v<=x.v)return k;u[m]=k;0==m&&(x.move(-q,0),k=new a.Hd,k.Ag(-q,0),h.Xc(k))}if(550==g)u[0].Id(u[1],0,-1);else if(a.T.Ic(g))u[0].add(u[1],!1);else if(33==g)u[0].u()&&(u[0]=u[1]);else throw a.g.X("intersect_with_GCS_horizon: unexpected geometry type");return u[0]}if(e.B<x.A||e.A>x.B)return h;for(g=0;!h.u()&&
x.v>e.o;)0!=g&&(k=new a.Hd,k.Ag(g,0),h.Xc(k)),a.Gj.local().V(4,h,p,c,f)||(h=a.cq.local().V(h,p,c,f),p==h&&(h=a.T.oe(h))),0!=g&&(w=new a.Hd,w.Ag(-g,0),h.Xc(w)),g-=q,x.move(-q,0);return h};d.LH=function(c,e,l,f){if(0!=e&&f!=b.DontClip)if(f==b.PannableFold){f=l.AT();for(var h=e,g=0;g<e;g++)if(c[g].y>f.B||c[g].y<f.A)c[g].$c(),h--;0!=h&&d.Uu(c,e,f.o,f.N())}else{f=l.ee();var k=90*f,m=180*f;f*=360;h=e;for(g=0;g<e;g++)if(c[g].y>k||c[g].y<-k)c[g].$c(),h--;if(0!=h){h=new a.h;h.Mx(c,e);var k=l.Vs(),r=l.Uv(),
g=197==k.G(),q=new a.h;k.s(q);if(!r||!(q.B<h.A||q.A>h.B))if(r)if(d.Uu(c,e,q.Hk()-m,f),h=e,g)for(g=0;g<e;g++)q.contains(c[g])||(c[g].$c(),h--);else for(l=a.na.vv(l.kc(),k),g=0;g<e;g++)(m=0!=a.gd.ge(k,c[g],l))||(c[g].$c(),h--);else for(d.Uu(c,e,-m,f),h=e,l=a.na.vv(l.kc(),k),g=0;g<e;g++)if(m=c[g],m.isNaN()&&h--,r=d.pE(m.x,q.o,q.v,f),m.x+=r,m=0!=a.gd.ge(k,m,l))c[g].$c(),h--}}};d.b_=function(d,b,c){if(0<=b&&!d.Qb(b))return 0;var h=0;if(1==c.Fb())return b=90*c.ee(),b-=2*b/Math.PI*a.Vc.PE_HORIZON_DELTA,
c=new a.h,d.s(c),c.B>=b&&(h=1),c.A<=-b&&(h|=2),h;var e=c.Sj();if(null==e)return 0;var l=null;0<=b&&(l=d);for(var f=0;2>f;f++)if((0<f?e.getSouthPoleLocation():e.getNorthPoleLocation())!=a.Bg.PE_POLE_OUTSIDE_BOUNDARY){var g=c.dA(0<f);g.isNaN()||(g=0>b?a.ff.xA(d,g,0):a.ff.yA(l,b,g,0,null),h|=g<<f)}return h};d.Aq=function(d,b,c,e,l,f,g,k){var h=d.G(),m=b+c;if(33===h){e=l?d:d.Vf();var r=e.Be();if(r<b||r>=m||g&&r==m)r+=Math.ceil((b-r)/c)*c,r=a.J.pk(r,b,m),e.AC(r);return e}if(d.u())return d;r=new a.h;d.s(r);
if(r.u())return d;var q=new a.Ac;r.Sn(q);var n=new a.Ac;n.I(b,m);if(n.contains(q))return d;m=new a.h;m.I(r);if(550===h){e=l?d:d.Vf();k=e.Pa(0);h=2*e.D();m=!1;for(b=0;b<h;b+=2)if(r=k.read(b),r<n.ca||r>=n.ha||g&&r==n.ha)m=!0,r+=Math.ceil((n.ca-r)/c)*c,r=n.wu(r),k.write(b,r);m&&e.Dc(1993);return e}if(197==h)return c=l?d:d.Vf(),r.Ma(m),c.Gp(r),c;var w=.1*Math.max(r.fa(),r.N());m.O(0,w);g=d;n=e.re(0);d=a.ei.local();for(l=new a.Hd;;){var x=Math.floor((q.ca-b)/c),p=Math.ceil((q.ha-b)/c);if(3<p-x){x=Math.floor(.5*
(p+x));m.o=r.o-w;m.v=b+c*x;var u=a.uh.clip(g,m,n,f,k);m.o=m.v;m.v=r.v+w;var B=a.uh.clip(g,m,n,f,k);l.Ag((x-p)*c,0);B.Xc(l);1736==h?g=d.V(u,B,e,null):(g=u,g.add(B,!1));g.s(r);r.Sn(q)}else break}m.o=b;m.v=b+c;b=new a.h;b.I(m);b.O(n,0);b=Math.floor((r.o-m.o)/c)*c;0!=b?(m.move(b,0),l.Ag(-b,0)):l.pC();b=1607==h?new a.Ua(g.description):new a.Ja(g.description);f=new a.h;for(q=new a.h;r.v>m.o;){w=a.uh.clip(g,m,n,0,k);w.s(q);if(1607==h?!w.u()&&(q.N()>n||q.fa()>n):!w.u()&&(1736!=h||q.N()>n))w.Xc(l),w.s(q),
b.s(f),f.O(n,n),f.Yb(q)&&1736==h?b=d.V(b,w,e,null):b.add(w,!1);m.move(c,0);l.shift(-c,0)}return b};d.Uu=function(d,b,c,e){for(var h=c+e,l=0;l<b;l++){var f=d[l].x;c<=f&&f<h||!(f<c||f>h||f==h)||(f+=Math.ceil((c-f)/e)*e,f=a.J.pk(f,c,h),d[l].x=f)}};d.Xm=function(b,c,e,l,f,g){if(!c.Jc())throw a.g.X("fold_into_360_degree_range");if(b.u())return b;var h;if(2==c.Fb())e=c.bw(),h=c.aw()-e;else{var k=c.ee();h=360*k;e-=180*k}return d.Aq(b,e,h,c,l,f,!0,g)};d.BG=function(a,b,c,e){if(2==c.Fb())e=c.bw(),c=c.aw()-
e;else{var h=c.ee();c=360*h;e-=180*h}d.Uu(a,b,e,c)};d.Mj=function(d,b){var c=b.qe();if(33==d.G()){var h=d.nf();return c.A<=h&&h<=c.B?d:d.Ka()}h=new a.h;d.s(h);var e=new a.h;e.I(c);e.o=h.o;e.v=h.v;e.O(.01*e.fa(),0);c=a.na.$y(b,h);return e.contains(h)?d:a.uh.clip(d,e,c,0,null)};d.Im=function(a,d,b){return a>d.v&&a-d.v<b?d.v:a<d.o&&d.o-a<b?d.o:a};d.zY=function(a,b,c,e){e.x=d.Im(a.x,b,c);e.y=a.y};d.yY=function(a,b,c,e){for(var h=0;h<b;h++)a[h].y<c.A||a[h].y>c.B?a[h].$c():a[h].x=d.Im(a[h].x,c,e)};d.xu=
function(b,c,e,l){if(!b.u()){var h=b.G();if(!l||1736!=h)if(a.T.gh(h)){l=b.Pa(0);for(var h=0,f=b.D();h<f;h++){var g=l.read(2*h),k=d.Im(g,c,e);k!=g&&l.write(2*h,k)}b.Dc(1993)}else if(197==h)l=new a.h,b.s(l),l.o=d.Im(l.o,c,e),l.v=d.Im(l.v,c,e),b.Gp(l);else if(33==h)b.AC(d.Im(b.Be(),c,e));else throw a.g.X("internal error");}};d.pU=function(b,c,e,l){var h=new a.fd,f=h.Jb(b);b=a.na.vv(c,b);d.ht(h,f,c,b,e,!0,l);return h.Se(f)};d.ht=function(b,e,l,f,g,k,m){if(!l.Jc())throw a.g.F("invalid call");var h=l.qe(),
r=l.kc(),q=r.Kg().getDatum().getSpheroid(),r=r.Nd().Ai,n=q.getFlattening(),q=q.getAxis(),n=n*(2-n),w=new a.Ac;h.Sn(w);var x=null,p=[[0,0],[0,0]];2==l.Fb()?(x=l.Kg(),k?(p[0][0]=d.Nn(m,w),p[0][1]=h.Cq(),a.fi.projToGeog(x,1,p),h=p[0][0]*r):(p[0][0]=h.Hk(),p[0][1]=m,a.fi.projToGeog(x,1,p),h=p[0][1]*r)):h=m*r;if(!k&&0!=h&&g!=c.GreatElliptic)throw a.g.X("invalid argument");var u=new a.ea,B=[0],z=new a.b,v=new a.b,t=new a.b,C=[null,null],y=new a.b,E=new a.b,F=new a.b,A=new a.b;for(e=b.Pb(e);-1!=e;e=b.Sb(e)){var D=
b.cb(e);b.w(D,y);for(var G=!1,H=D=b.U(D);-1!=H;H=b.U(H)){if(H==D){if(G)break;G=!0}b.w(H,E);if(k&&(f<m-y.x&&E.x-m>f||f<m-E.x&&y.x-m>f)||!k&&(0!=m||f<-y.y&&E.y>f||f<-E.y&&y.y>f)){do if(!(Math.abs(y.x-E.x)>=.5*w.N())){2==l.Fb()?(p[0][0]=d.Nn(y.x,w),p[0][1]=y.y,p[1][0]=d.Nn(E.x,w),p[1][1]=E.y,a.fi.projToGeogCenter(x,2,p,0),F.x=p[0][0]*r,F.y=p[0][1]*r,A.y=p[1][1]*r):(F.x=y.x*r,F.y=y.y*r,A.y=E.y*r);A.x=2*(E.x-y.x)*Math.PI/w.N()+F.x;var I;if(k){v.x=h;v.y=d.EB(q,n,F,A,h,g);if(isNaN(v.y))break;C[0]=v;I=1}else if(g==
c.GreatElliptic){var K=[0,0];I=a.yy.uA(q,n,F,A,h,K);if(0==I)break;v.x=K[0];v.y=h;C[0]=v;2==I&&(t.x=K[1],t.y=h,C[1]=t)}else{v.x=d.CB(q,n,F,A,g);if(isNaN(v.x))break;v.y=0;C[0]=v;I=1}for(var M=-1,K=0;K<I;K++){a.mb.Ld(q,n,F.x,F.y,A.x,A.y,u,null,null,g);var J=u.j;a.mb.Ld(q,n,F.x,F.y,C[K].x,C[K].y,u,null,null,g);var L=u.j;2==l.Fb()?(p[0][0]=C[K].x/r,p[0][1]=C[K].y/r,a.fi.geogToProj(x,1,p),k?(z.y=p[0][1],z.x=m):(z.x=d.Zp(p[0][0],y.x,E.x,w),z.y=m)):k?(z.x=m,z.y=C[K].y/r):(z.x=d.Zp(C[K].x/r,y.x,E.x,w),z.y=
m);B[0]=0<J?a.J.pk(L/J,0,1):.5;if(0==B[0]||1==B[0])break;M>B[0]||(M=b.Ra(H),b.zm(M,B,1),b.rb(b.U(M),z.x,z.y),M=B[0])}}while(0)}y.L(E)}}};d.Nn=function(a,d){var b=d.ha-d.ca;return d.wu(a-Math.floor((a-d.ca)/b)*b)};d.Zp=function(d,b,c,e){var h=new a.Ac;h.I(b,c);c=e.N();d=Math.floor((d-b)/c)*c+d;for(h=h.Wf();Math.abs(d-h)>Math.abs(d+c-h);)d+=c;return d};d.Cj=function(d,b,c){d=a.ls.uq(d);b=a.ls.Wx(d,a.ls.uq(b));c=a.ls.Wx(d,a.ls.uq(c));return 0==c||0<b&&0<c&&c<=b||0>b&&0>c&&c>=b?!0:!1};d.EB=function(b,
e,l,f,g,k){if(k==c.GreatElliptic)return a.yy.MU(e,l,f,g);if(Math.abs(l.x-f.x)>=Math.PI||!d.Cj(l.x,f.x,g))return NaN;var h;l.x>f.x?h=f:(h=l,l=f);f=new a.ea;var m=new a.ea,r=new a.ea;a.mb.Ld(b,e,h.x,h.y,l.x,l.y,m,f,null,k);var q=m.j,n=0,w=1,x=new a.b;for(x.L(h);q*(w-n)>1E-12*b;){var p=.5*(n+w);a.mb.Oj(b,e,h.x,h.y,q*p,f.j,m,r,k);x.x=m.j;x.y=r.j;if(x.x==g)break;if(d.Cj(h.x,x.x,g))w=p;else if(d.Cj(l.x,x.x,g))n=p;else return NaN}return x.y};d.CB=function(d,b,e,l,f){if(f==c.GreatElliptic)return f=[0,0],
a.yy.uA(d,b,e,l,0,f),f[0];var h;e.y>l.y?h=l:(h=e,e=l);l=new a.Ac;l.I(h.y,e.y);if(!l.contains(0)||Math.abs(h.x-e.x)>=Math.PI)return NaN;if(h.x==e.x)return h.x;var g=new a.ea,k=new a.ea,m=new a.ea;a.mb.Ld(d,b,h.x,h.y,e.x,e.y,k,g,null,f);var r=k.j,q=0,n=1,w=new a.b;for(w.L(h);r*(n-q)>1E-12*d;){var x=.5*(q+n);a.mb.Oj(d,b,h.x,h.y,r*x,g.j,k,m,f);w.x=k.j;w.y=m.j;l.I(h.y,w.y);if(0==w.y)break;if(l.contains(0))n=x;else if(l.I(e.y,w.y),l.contains(0))q=x;else return NaN}return w.x};d.x_=function(d,b,c,e,l,f){if(b==
l&&c!=f)throw a.g.F();if(0>=e)return 0;if(d.Ho()){f*=2;var h=2*c;d=2*e;for(c=0;c<d;c++)l[f+c]=b[h+c];return e}if(2>=e){f=[new a.b,new a.b];for(h=0;h<e;h++)f[h].ka(b[2*h],b[2*h+1]);b=a.os.local().WY(d,f,e,f);for(h=0;h<e;h++)l[2*h]=f[h].x,l[2*h+1]=f[h].y;return b}var g=d.je,h=d.He,k=g.Fb(),m=h.Fb();if(0==k&&k==m)return d=g.Yi(),h=h.Yi(),h=d/h,d=new a.Hd,d.Op(h,h),d.XY(b,c,l,f,e),e;k=new a.Ed;k.Ud(3);k.resize(e);for(var m=k.Pa(0),r=k.Pa(3),h=0,q=2*c,n=2*f;h<e;h++,n+=2){c=b[q++];var g=b[q++],w=n;if(isNaN(c)||
isNaN(g))g=c=0,w=-1;r.write(h,w);m.write(2*h,c);m.write(2*h+1,g)}k.Dc(1993);b=a.os.local().V(k,d,null);h=0;for(f*=2;h<e;h++,f+=2)l[f]=NaN,l[f+1]=NaN;if(b.u())return 0;f=b.Pa(3);d=b.Pa(0);h=k=0;for(e=b.D();h<e;h++)b=f.read(h),-1!=b&&(c=d.read(2*h),g=d.read(2*h+1),l[b]=c,l[b+1]=g,k++);return k};d.OJ=function(d,b,c,e){if(!d.je.Jc())return!1;var h=new a.Ed(b.description);h.Id(b,0,-1);e=a.os.local().V(h,d,e);h=b.D();c.Oa();if(h!=e.D())return!1;var l=new a.h;b.s(l);var f=new a.h;e.s(f);l=l.N();f=f.N();
if(0!=l&&0!=f){if(f/=l,d=d.He.Bh().N()/d.je.Bh().N(),1E-10<Math.abs(f/d-1))return!1}else if(0!=l||0!=f)return!1;c.add(b,!1);b=new a.b;for(d=0;d<h;d++)e.w(d,b),c.rb(d,b);return!0};d.qP=function(a,d){a%=360*d;a>=180*d&&(a-=360*d);return a};d.MJ=function(c,e,l,f){if(l==b.Clip){var h=e.Mk();197==h.G()?(l=new a.h,h.s(l),h=a.na.$y(e,l),c=a.uh.clip(c,l,h,5E4*e.bn(),f)):a.Gj.local().V(1,h,c,e,f)||(c=a.tk.local().V(c,h,e,f),c==h&&(c=a.xl.oe(c)))}else e.Jc()&&(f=new a.h,c.ac(f),e.qe().contains(f)||(d.xu(c,
e.qe(),e.re(0),!0),l==b.PannableFold&&(c=d.Mj(c,e)),c=d.Xm(c,e,0,!0,1E5*e.bn(),null)));return c};d.jF=function(d,b,c){var h=b.Ws();if(null==h)return d;b=b.kc();var e=b.qe().N(),l=new a.h;d.ac(l);var f=new a.Ac;l.Sn(f);for(var l=h.Fa(),h=null,g=new a.Hd;l.Ya();)for(;l.Ea();){var k=l.ba(),m=k.xf(0,0),r=new a.Ac;r.I(m.ca,m.ha);for(m=0;r.ha>f.ca;)r.move(-e),--m;for(;r.ca<=f.ha;){if(r.Yb(f)){null==h&&(h=new a.Ua);var q=a.Hb.fR(k.ec(),k.Cc());0!=m&&(g.Ag(m*e,0),q.Xc(g));h.dc(q,!0)}r.move(e);++m}}return null!=
h?(b=a.na.gQ(b,h),b=a.na.Cs(b),a.Ku.kR(d,h,b,c)):d};d.CN=function(a,b,c,e,l){return a>=c&&b<=e?0:d.pE(.5*(b+a),c,e,l)};d.pE=function(d,b,c,e){return a.Ub.round((.5*(c+b)-d)/e)*e};d.LS=function(b,c,e,l,f,g,k,m){var h=d.Vu(l,f),r=h.N(),q=r/360,n=d.kE*q,w=b.Pa(0),x=c.Jc(),p=x?r/c.qe().N():0,u;c=b.Ka();for(var B=0,z=e.aa();B<z;++B){var v=x,t=new a.Ua(e.description);t.Ti(e,B,!0);u=e.Qb(B);0!=k&&(u=d.aE(u,t,h.B-m,h.B,k))&&(v=!1);var C=-1;u=t.D();var y=!1;v&&(C=b.wa(B),y=b.Qb(B));var E=t.Pa(0),F=0,A=E.read(0),
D=0,G=3*l.re(0),H=!1,I=new a.b;I.$c();var K=new a.b;K.$c();for(var M=!1,J=1;J<u;++J){var L=a.b.pa(E.Of(2*J),E.Of(2*J+1)),Q=L.x,P=Q+F,O=P-A;L.x=P;if(Math.abs(O)>n){if(v){var W=C+J-1,S=C;if(!y||J+1<u)S+=J;W=w.read(2*W);S=(w.read(2*S)-W)*p;Math.abs(O-S)>1*q&&(x=!1)}v||(F-=a.Ub.Fl(r,P-A),P=Q+F,++D,M=0!=F,L.x=P)}else H||a.na.NH(I,K,L,G)&&(H=!0);M&&E.write(2*J,P);A=P;I.L(K);K.L(L)}0!=D&&t.Dc(1993);v=t.Ba(0);u=t.Ba(u-1);a.b.Cb(v,u);t=d.ES(t,l,isNaN(f)?0:f,g);c.add(t,!1)}b=l.re(0);e=h.N()/180;d.xu(c,h,.1*
b,!1);return a.uh.clip(c,h,b,e,g)};d.ES=function(a,b,c,e){return d.Xm(a,b,c,!0,0,e)};d.JU=function(d,b,c,e){var h=d.G();if(1736==h)for(b=null!=b?b.re(0):0,h=0;h<e;h++)1!=a.gd.ge(d,c[h],b)&&c[h].$c();else if(197==h)for(h=0;h<e;h++)d.gR(c[h])||c[h].$c();else throw a.g.F();};d.Dl=function(d,b,c,e){if(32>c)for(var h=new a.Wa,l=0;l<c;l++)h.rb(b[l]),d.Dl(h,e).w(b[l]);else{var f=new a.Ed;f.Ud(3);f.YE(b,c);h=f.Pa(3);for(l=0;l<c;l++)h.write(l,l);l=d.Dl(f,e);d=l.Pa(0);h=l.Pa(3);e=a.b.pa(NaN,NaN);for(f=0;f<
c;f++)b[f]=e;c=l.D();for(l=0;l<c;l++)e=h.read(l),d.fc(2*l,b[e])}};d.Cl=function(d,b,c,e){if(32>c)for(var h=new a.Wa,l=0;l<c;l++)h.rb(b[l]),d.Cl(h,e).w(b[l]);else{var f=new a.Ed;f.Ud(3);f.YE(b,c);h=f.Pa(3);for(l=0;l<c;l++)h.write(l,l);l=d.Cl(f,e);d=l.Pa(0);h=l.Pa(3);e=a.b.pa(NaN,NaN);for(f=0;f<c;f++)b[f]=e;c=l.D();for(l=0;l<c;l++)e=h.read(l),d.fc(2*l,b[e])}};d.Z_="ABCDEFGHIJKLMNOPQRSTUVWXYZ";d.kE=210;return d}();a.Ib=e})(D||(D={}));(function(a){(function(a){a[a.rightSide=1]="rightSide"})(a.KN||(a.KN=
{}));var b=function(){function b(b,d,c){this.xt=new a.b;void 0===b?this.up=-1:(this.xt.L(b),this.up=d,this.Qa=c,this.$w=0)}b.prototype.NK=function(a){this.$w=a?this.$w|1:this.$w&-2};b.prototype.u=function(){return 0>this.up};b.prototype.Nz=function(){if(this.u())throw a.g.X("invalid call");return new a.Wa(this.xt.x,this.xt.y)};b.prototype.Za=function(){if(this.u())throw a.g.X("invalid call");return this.up};b.prototype.Qz=function(){if(this.u())throw a.g.X("invalid call");return this.Qa};b.prototype.zA=
function(){return 0!=(this.$w&1)};b.prototype.Ly=function(a,d,b,c){this.xt.x=a;this.xt.y=d;this.up=b;this.Qa=c};return b}();a.Mm=b})(D||(D={}));(function(a){var b=function(){function b(){}b.prototype.Wn=function(d,b){this.Rh.resize(0);this.hj.length=0;this.Vk=-1;d.ac(this.gl);this.gl.O(b,b);this.gl.Yb(this.Mb.Ha)?((this.rt=a.T.Oc(d.G()))?(this.gJ=d.ec(),this.fJ=d.Cc(),this.ta=b):this.ta=NaN,this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ha),this.Lt=this.Mb.Us(this.Mb.Mf)):this.Lt=-1};b.prototype.Ni=
function(a,b){this.Rh.resize(0);this.hj.length=0;this.Vk=-1;this.gl.I(a);this.gl.O(b,b);this.ta=NaN;this.gl.Yb(this.Mb.Ha)?(this.Rh.add(this.Mb.Mf),this.hj.push(this.Mb.Ha),this.Lt=this.Mb.Us(this.Mb.Mf),this.rt=!1):this.Lt=-1};b.prototype.next=function(){if(0==this.Rh.size)return-1;this.Vk=this.Lt;var d=null,b=null,e,l=null,f=null;this.rt&&(d=new a.b,b=new a.b,l=new a.h);for(var g=!1;!g;){for(;-1!=this.Vk;){e=this.Mb.Jz(this.Mb.Tv(this.Vk));if(e.Yb(this.gl))if(this.rt){if(d.L(this.gJ),b.L(this.fJ),
l.I(e),l.O(this.ta,this.ta),0<l.gz(d,b)){g=!0;break}}else{g=!0;break}this.Vk=this.Mb.$v(this.Vk)}if(-1==this.Vk){e=this.Rh.Fc();var k=this.hj[this.hj.length-1];null==f&&(f=[],f[0]=new a.h,f[1]=new a.h,f[2]=new a.h,f[3]=new a.h);c.uK(k,f);this.Rh.Pf();--this.hj.length;for(k=0;4>k;k++){var m=this.Mb.Eq(e,k);if(-1!=m&&0<this.Mb.PT(m)&&f[k].Yb(this.gl))if(this.rt){if(d.L(this.gJ),b.L(this.fJ),l.I(f[k]),l.O(this.ta,this.ta),0<l.gz(d,b)){var q=new a.h;q.I(f[k]);this.Rh.add(m);this.hj.push(q)}}else q=new a.h,
q.I(f[k]),this.Rh.add(m),this.hj.push(q)}if(0==this.Rh.size)return-1;this.Vk=this.Mb.Us(this.Rh.get(this.Rh.size-1))}}this.Lt=this.Mb.$v(this.Vk);return this.Vk};b.eR=function(d,c,e){var h=new b;h.Mb=d;h.gl=new a.h;h.Rh=new a.ia(0);h.hj=[];h.Wn(c,e);return h};b.dR=function(d,c,e){var h=new b;h.Mb=d;h.gl=new a.h;h.Rh=new a.ia(0);h.hj=[];h.Ni(c,e);return h};b.cR=function(d){var c=new b;c.Mb=d;c.gl=new a.h;c.Rh=new a.ia(0);c.hj=[];return c};return b}();a.g_=b;var c=function(){function c(d,b){this.Lf=
new a.ad(11);this.yi=new a.ad(5);this.st=[];this.Ww=new a.ia(0);this.Ha=new a.h;this.ql(d,b)}c.prototype.reset=function(a,b){this.Lf.Vi(!1);this.yi.Vi(!1);this.st.length=0;this.Ww.clear(!1);this.ql(a,b)};c.prototype.eh=function(a,b){return this.mw(a,b,0,this.Ha,this.Mf,!1,-1)};c.prototype.lw=function(a,b,c){c=-1==c?this.Mf:this.gH(c);var d=this.fa(c),h=this.fT(c);return this.mw(a,b,d,h,c,!1,-1)};c.prototype.ja=function(a){return this.aT(a)};c.prototype.RG=function(a){return this.Jz(this.Tv(a))};c.prototype.fa=
function(a){return this.Vv(a)};c.prototype.fT=function(d){var b=new a.h;b.I(this.Ha);var c=this.Vv(d);d=this.bH(d);for(var e=0;e<2*c;e+=2){var l=a.J.truncate(3&d>>e);0==l?(b.o=.5*(b.o+b.v),b.A=.5*(b.A+b.B)):1==l?(b.v=.5*(b.o+b.v),b.A=.5*(b.A+b.B)):(2==l?b.v=.5*(b.o+b.v):b.o=.5*(b.o+b.v),b.B=.5*(b.A+b.B))}return b};c.prototype.PT=function(a){return this.kA(a)};c.prototype.oT=function(a,c){return b.eR(this,a,c)};c.prototype.Xz=function(a,c){return b.dR(this,a,c)};c.prototype.mf=function(){return b.cR(this)};
c.prototype.ql=function(d,b){if(0>b||32<2*b)throw a.g.F("invalid height");this.zV=b;this.Ha.I(d);this.Mf=this.Lf.Pe();this.Ux(this.Mf,0);this.Ox(this.Mf,0);this.EK(this.Mf,0);this.AK(this.Mf,0)};c.prototype.mw=function(d,b,e,l,f,g,k){if(!l.contains(b))return 0==e?-1:this.mw(d,b,0,this.Ha,this.Mf,g,k);if(!g)for(var h=f;-1!=h;h=this.BT(h))this.Ux(h,this.kA(h)+1);h=new a.h;h.I(l);l=f;var m=[];m[0]=new a.h;m[1]=new a.h;m[2]=new a.h;for(m[3]=new a.h;e<this.zV&&this.iQ(l);e++){c.uK(h,m);for(var r=!1,q=
0;4>q;q++)if(m[q].contains(b)){var r=!0,n=this.Eq(l,q);-1==n&&(n=this.qR(l,q));this.Ux(n,this.kA(n)+1);l=n;h.I(m[q]);break}if(!r)break}return this.nU(d,b,e,h,l,g,f,k)};c.prototype.nU=function(a,b,c,e,l,f,g,k){var d=this.XG(l);if(f){if(l==g)return k;this.PR(k);f=k}else f=this.sR(),this.nC(f,a),this.JX(this.Tv(f),b);this.gY(f,l);-1!=d?(this.Sx(f,d),this.Px(d,f)):this.wK(l,f);this.qC(l,f);this.Ox(l,this.Yv(l)+1);this.hQ(l)&&this.BS(c,e,l);return f};c.prototype.PR=function(a){var d=this.gH(a),b=this.XG(d),
c=this.HT(a),e=this.$v(a);this.Us(d)==a?(-1!=e?this.Sx(e,-1):this.qC(d,-1),this.wK(d,e)):b==a?(this.Px(c,-1),this.qC(d,c)):(this.Sx(e,c),this.Px(c,e));this.Sx(a,-1);this.Px(a,-1);this.Ox(d,this.Yv(d)-1)};c.uK=function(a,b){var d=.5*(a.o+a.v),c=.5*(a.A+a.B);b[0].I(d,c,a.v,a.B);b[1].I(a.o,c,d,a.B);b[2].I(a.o,a.A,d,c);b[3].I(d,a.A,a.v,c)};c.prototype.hQ=function(a){return 8==this.Yv(a)&&!this.tH(a)};c.prototype.BS=function(a,b,c){var d,h,e=this.Us(c);do h=this.Tv(e),d=this.yi.S(e,0),h=this.Jz(h),this.mw(d,
h,a,b,c,!0,e),e=d=this.$v(e);while(-1!=e)};c.prototype.iQ=function(a){return 8<=this.Yv(a)||this.tH(a)};c.prototype.tH=function(a){return-1!=this.Eq(a,0)||-1!=this.Eq(a,1)||-1!=this.Eq(a,2)||-1!=this.Eq(a,3)};c.prototype.qR=function(a,b){var d=this.Lf.Pe();this.NX(a,b,d);this.Ux(d,0);this.Ox(d,0);this.sl(d,a);this.AK(d,this.Vv(a)+1);this.EK(d,b<<2*this.Vv(a)|this.bH(a));return d};c.prototype.sR=function(){var d=this.yi.Pe(),b;0<this.Ww.size?(b=this.Ww.Fc(),this.Ww.Pf()):(b=this.st.length,this.st.push(new a.h));
this.KX(d,b);return d};c.prototype.Eq=function(a,b){return this.Lf.S(a,b)};c.prototype.NX=function(a,b,c){this.Lf.P(a,b,c)};c.prototype.Us=function(a){return this.Lf.S(a,4)};c.prototype.wK=function(a,b){this.Lf.P(a,4,b)};c.prototype.XG=function(a){return this.Lf.S(a,5)};c.prototype.qC=function(a,b){this.Lf.P(a,5,b)};c.prototype.bH=function(a){return this.Lf.S(a,6)};c.prototype.EK=function(a,b){this.Lf.P(a,6,b)};c.prototype.Yv=function(a){return this.Lf.S(a,7)};c.prototype.kA=function(a){return this.Lf.S(a,
8)};c.prototype.Ox=function(a,b){this.Lf.P(a,7,b)};c.prototype.Ux=function(a,b){this.Lf.P(a,8,b)};c.prototype.BT=function(a){return this.Lf.S(a,9)};c.prototype.sl=function(a,b){this.Lf.P(a,9,b)};c.prototype.Vv=function(a){return this.Lf.S(a,10)};c.prototype.AK=function(a,b){this.Lf.P(a,10,b)};c.prototype.aT=function(a){return this.yi.S(a,0)};c.prototype.nC=function(a,b){this.yi.P(a,0,b)};c.prototype.HT=function(a){return this.yi.S(a,1)};c.prototype.$v=function(a){return this.yi.S(a,2)};c.prototype.Sx=
function(a,b){this.yi.P(a,1,b)};c.prototype.Px=function(a,b){this.yi.P(a,2,b)};c.prototype.gH=function(a){return this.yi.S(a,3)};c.prototype.gY=function(a,b){this.yi.P(a,3,b)};c.prototype.Tv=function(a){return this.yi.S(a,4)};c.prototype.KX=function(a,b){this.yi.P(a,4,b)};c.prototype.Jz=function(a){return this.st[a]};c.prototype.JX=function(a,b){this.st[a].I(b)};return c}();a.gq=c})(D||(D={}));(function(a){(function(a){a[a.Outside=0]="Outside";a[a.Inside=1]="Inside";a[a.Border=2]="Border"})(a.zM||
(a.zM={}));var b=function(){function a(a,b){this.Dh=null;this.NV=b;this.Dh=a}a.prototype.Kx=function(a,b){this.uI!=b&&a.flush();this.uI=b};a.prototype.pG=function(a,b){for(var d=0;d<b;)for(var c=a[d++],h=a[d++],e=a[d++]*this.NV;c<h;c++)this.Dh[e+(c>>4)]|=this.uI<<2*(c&15)};return a}();a.i_=b;var c=function(){function c(a,b,c){this.Dh=null;this.yB=this.jl=this.pJ=this.nJ=this.At=this.CI=this.hg=this.Hn=0;this.qj=this.kl=this.$l=null;this.kw(a,b,c)}c.create=function(d,b,e){if(!c.bz(d))throw a.g.F();
return c.fe(d,b,e)};c.Cj=function(d,b,e){if(!c.bz(d))throw a.g.F();return c.se(d,b,e)};c.kX=function(d){switch(d){case 0:d=1024;break;case 1:d=16384;break;case 2:d=262144;break;default:throw a.g.X("Internal Error");}return d};c.bz=function(a){return a.u()||1607!=a.G()&&1736!=a.G()?!1:!0};c.prototype.mS=function(d,b){b=b.Fa();for(var c=new a.b,h=new a.b;b.Ya();)for(;b.Ea();){var e=b.ba();if(322!=e.G())throw a.g.X("Internal Error");d.$h(e.ec(),c);d.$h(e.Cc(),h);this.qj.Qy(c.x,c.y,h.x,h.y)}this.qj.YJ(a.zy.py)};
c.prototype.nS=function(){throw a.g.X("Internal Error");};c.prototype.Bz=function(d,b){for(var c=1;4>c;c++)d.Qy(b[c-1].x,b[c-1].y,b[c].x,b[c].y);d.Qy(b[3].x,b[3].y,b[0].x,b[0].y);this.qj.YJ(a.zy.py)};c.prototype.dL=function(d,b,c){for(var h=[null,null,null,null],e=0;e<h.length;e++)h[e]=new a.b;b=b.Fa();c=this.kl.YY(c)+1.5;for(var e=new a.b,l=new a.b,f=new a.b,g=new a.b,k=new a.b,m=new a.h,r=new a.b;b.Ya();){var q=!1,n=!0;for(r.ka(0,0);b.Ea();){var w=b.ba();g.x=w.ua;g.y=w.ra;k.x=w.sa;k.y=w.oa;m.Oa();
m.Nb(g.x,g.y);m.ml(k.x,k.y);if(this.$l.TH(m)){this.kl.$h(k,k);n?(this.kl.$h(g,g),r.L(g),n=!1):g.L(r);e.zc(k,g);var w=e.length(),x=.5>w;0==w?e.ka(1,0):(x||r.L(k),e.scale(c/w),l.ka(-e.y,e.x),f.ka(e.y,-e.x),g.sub(e),k.add(e),h[0].add(g,l),h[1].add(g,f),h[2].add(k,f),h[3].add(k,l),x?q=!0:this.Bz(d,h))}else q&&(this.Bz(d,h),q=!1),n=!0}q&&this.Bz(d,h)}};c.prototype.UC=function(d){return a.J.truncate(d*this.CI+this.nJ)};c.prototype.VC=function(d){return a.J.truncate(d*this.At+this.pJ)};c.fe=function(a,b,
e){return new c(a,b,e)};c.se=function(a,b,e){return new c(a,b,e)};c.prototype.kw=function(d,c,e){this.hg=Math.max(a.J.truncate(2*Math.sqrt(e)+.5),64);this.Hn=a.J.truncate((2*this.hg+31)/32);this.$l=new a.h;this.jl=c;e=0;for(var h=this.hg,l=this.Hn;8<=h;)e+=h*l,h=a.J.truncate(h/2),l=a.J.truncate((2*h+31)/32);this.Dh=a.J.gf(e,0);this.qj=new a.zy;e=new b(this.Dh,this.Hn,this);this.qj.vY(this.hg,this.hg,e);d.s(this.$l);this.$l.O(c,c);var h=new a.h,l=a.h.pa(1,1,this.hg-2,this.hg-2),f=c*l.N();c*=l.fa();
h.I(this.$l.Wf(),Math.max(f,this.$l.N()),Math.max(c,this.$l.fa()));this.yB=this.jl;this.kl=new a.Hd;this.kl.kU(h,l);new a.Hd;switch(d.G()){case 550:e.Kx(this.qj,2);this.nS();break;case 1607:e.Kx(this.qj,2);this.dL(this.qj,d,this.yB);break;case 1736:e.Kx(this.qj,1),this.mS(this.kl,d),e.Kx(this.qj,2),this.dL(this.qj,d,this.yB)}this.CI=this.kl.lb;this.At=this.kl.gb;this.nJ=this.kl.Wb;this.pJ=this.kl.bc;this.$P()};c.prototype.$P=function(){this.qj.flush();for(var d=0,b=this.hg*this.Hn,c=this.hg,e=a.J.truncate(this.hg/
2),l=this.Hn,f=a.J.truncate((2*e+31)/32);8<c;){for(c=0;c<e;c++)for(var g=2*c,k=2*c+1,m=0;m<e;m++){var q=2*m,n=2*m+1,w=q>>4,q=2*(q&15),x=n>>4,n=2*(n&15),p=this.Dh[d+l*g+w]>>q&3,p=p|this.Dh[d+l*g+x]>>n&3,p=p|this.Dh[d+l*k+w]>>q&3,p=p|this.Dh[d+l*k+x]>>n&3;this.Dh[b+f*c+(m>>4)]|=p<<2*(m&15)}c=e;l=f;d=b;e=a.J.truncate(c/2);f=a.J.truncate((2*e+31)/32);b=d+l*c}};c.prototype.rm=function(a,b){if(!this.$l.contains(a,b))return 0;a=this.UC(a);b=this.VC(b);if(0>a||a>=this.hg||0>b||b>=this.hg)return 0;a=this.Dh[this.Hn*
b+(a>>4)]>>2*(a&15)&3;return 0==a?0:1==a?1:2};c.prototype.Rn=function(d){if(!d.Ma(this.$l))return 0;var b=this.UC(d.o),c=this.UC(d.v),e=this.VC(d.A);d=this.VC(d.B);0>b&&(b=0);0>e&&(e=0);c>=this.hg&&(c=this.hg-1);d>=this.hg&&(d=this.hg-1);if(b>c||e>d)return 0;for(var l=Math.max(c-b,1)*Math.max(d-e,1),f=0,g=this.Hn,k=this.hg,m=0;;){if(32>l||16>k){for(l=e;l<=d;l++)for(var q=b;q<=c;q++)if(m=this.Dh[f+g*l+(q>>4)]>>2*(q&15)&3,1<m)return 2;if(0==m)return 0;if(1==m)return 1}f+=g*k;k=a.J.truncate(k/2);g=a.J.truncate((2*
k+31)/32);b=a.J.truncate(b/2);e=a.J.truncate(e/2);c=a.J.truncate(c/2);d=a.J.truncate(d/2);l=Math.max(c-b,1)*Math.max(d-e,1)}};c.prototype.KT=function(){return this.hg*this.Hn};return c}();a.xy=c})(D||(D={}));(function(a){(function(a){a[a.contains=1]="contains";a[a.within=2]="within";a[a.equals=3]="equals";a[a.disjoint=4]="disjoint";a[a.touches=8]="touches";a[a.crosses=16]="crosses";a[a.overlaps=32]="overlaps";a[a.unknown=0]="unknown";a[a.intersects=1073741824]="intersects"})(a.RN||(a.RN={}));var b=
function(){function a(){}a.pa=function(d,b,c,e,l,f,g,k){var h=new a;h.bx=d;h.zn=b;h.ek=c;h.rj=e;h.RI=l;h.G_=f;h.H_=g;h.I_=k;return h};return a}(),c=function(){function b(){}b.TE=function(d,c,e){if(!b.cz(d))return!1;var h=a.na.ah(c,d,!1);c=!1;a.wl.JF(d)&&(c=c||d.Xu(h,e));h=d.G();1736!=h&&1607!=h||!a.wl.HF(d)||0==e||(c=c||d.Hj(e));1736!=h&&1607!=h||!a.wl.IF(d)||0==e||(c=c||d.BO());return c};b.cz=function(d){return a.wl.JF(d)||a.wl.HF(d)||a.wl.IF(d)};return b}();a.Gu=c;c=function(){function c(){this.Ph=
[]}c.ZB=function(d,b,e,f,l){var h=d.G(),g=b.G();if(197==h){if(197==g)return c.rO(d,b,e,f);if(33==g)return 2==f?f=1:1==f&&(f=2),c.kG(b,d,e,f)}else if(33==h){if(197==g)return c.kG(d,b,e,f);if(33==g)return c.uO(d,b,e,f)}if(d.u()||b.u())return 4==f?!0:!1;var k=new a.h;d.s(k);var m=new a.h;b.s(m);var r=new a.h;r.I(k);r.Nb(m);e=a.na.be(e,r,!1);if(c.Ek(k,m,e))return 4==f?!0:!1;k=!1;a.xl.Oc(h)&&(h=new a.Ua(d.description),h.dc(d,!0),d=h,h=1607);a.xl.Oc(g)&&(g=new a.Ua(b.description),g.dc(b,!0),b=g,g=1607);
if(197!=h&&197!=g){if(d.tb()<b.tb()||33==h&&550==g)2==f?f=1:1==f&&(f=2)}else 1736!=h&&197!=g&&(2==f?f=1:1==f&&(f=2));switch(h){case 1736:switch(g){case 1736:k=c.gu(d,b,e,f,l);break;case 1607:k=c.On(d,b,e,f,l);break;case 33:k=c.fu(d,b,e,f,l);break;case 550:k=c.eu(d,b,e,f,l);break;case 197:k=c.dD(d,b,e,f,l)}break;case 1607:switch(g){case 1736:k=c.On(b,d,e,f,l);break;case 1607:k=c.MB(d,b,e,f,l);break;case 33:k=c.iu(d,b,e,f,l);break;case 550:k=c.hu(d,b,e,f,l);break;case 197:k=c.rD(d,b,e,f)}break;case 33:switch(g){case 1736:k=
c.fu(b,d,e,f,l);break;case 1607:k=c.iu(b,d,e,f,l);break;case 550:k=c.au(b,d,e,f,l)}break;case 550:switch(g){case 1736:k=c.eu(b,d,e,f,l);break;case 1607:k=c.hu(b,d,e,f,l);break;case 550:k=c.DB(d,b,e,f,l);break;case 33:k=c.au(d,b,e,f,l);break;case 197:k=c.RJ(d,b,e,f)}break;case 197:switch(g){case 1736:k=c.dD(b,d,e,f,l);break;case 1607:k=c.rD(b,d,e,f);break;case 550:k=c.RJ(b,d,e,f)}}return k};c.rO=function(d,b,e,f){if(d.u()||b.u())return 4==f?!0:!1;var h=new a.h,l=new a.h,g=new a.h;d.s(h);b.s(l);g.I(h);
g.Nb(l);d=a.na.be(e,g,!1);switch(f){case 4:return c.Ek(h,l,d);case 2:return c.RE(l,h,d);case 1:return c.RE(h,l,d);case 3:return c.We(h,l,d);case 8:return c.CP(h,l,d);case 32:return c.$O(h,l,d);case 16:return c.DL(h,l,d)}return!1};c.kG=function(d,b,e,f){if(d.u()||b.u())return 4==f?!0:!1;d=d.w();var h=new a.h,l=new a.h;b.s(h);l.I(d);l.Nb(h);b=a.na.be(e,l,!1);switch(f){case 4:return c.Dx(d,h,b);case 2:return c.XC(d,h,b);case 1:return c.DN(d,h,b);case 3:return c.qL(d,h,b);case 8:return c.WC(d,h,b)}return!1};
c.uO=function(d,b,e,f){if(d.u()||b.u())return 4==f?!0:!1;d=d.w();b=b.w();var h=new a.h;h.I(d);h.Nb(b);e=a.na.be(e,h,!1);switch(f){case 4:return c.MN(d,b,e);case 2:return c.eL(b,d,e);case 1:return c.eL(d,b,e);case 3:return c.yL(d,b,e)}return!1};c.gu=function(a,b,e,f,l){switch(f){case 4:return c.hS(a,b,e);case 2:return c.Ex(b,a,e,l);case 1:return c.Ex(a,b,e,l);case 3:return c.iU(a,b,e);case 8:return c.lW(a,b,e);case 32:return c.hV(a,b,e,l)}return!1};c.On=function(a,b,e,f,l){switch(f){case 4:return c.FS(a,
b,e);case 1:return c.LB(a,b,e,l);case 8:return c.vW(a,b,e,l);case 16:return c.DP(a,b,e)}return!1};c.fu=function(a,b,e,f){switch(f){case 4:return c.WR(a,b,e);case 1:return c.wO(a,b,e);case 8:return c.dW(a,b,e)}return!1};c.eu=function(a,b,e,f){switch(f){case 4:return c.BR(a,b,e);case 1:return c.tO(a,b,e);case 8:return c.SV(a,b,e);case 16:return c.tP(a,b,e)}return!1};c.dD=function(a,b,e,f,l){if(c.lQ(a,b,e))return 4==f?!0:!1;if(4==f)return!1;switch(f){case 2:return c.dX(a,b,e);case 1:return c.qO(a,b,
e);case 3:return c.fU(a,b,e);case 8:return c.kV(a,b,e,l);case 32:return c.eV(a,b,e,l);case 16:return c.EL(a,b,e,l)}return!1};c.MB=function(a,b,e,f){switch(f){case 4:return c.yZ(a,b,e);case 2:return c.nD(b,a,e);case 1:return c.nD(a,b,e);case 3:return c.OL(a,b,e);case 8:return c.tD(a,b,e);case 32:return c.cM(a,b,e);case 16:return c.pD(a,b,e)}return!1};c.iu=function(a,b,e,f){switch(f){case 4:return c.wZ(a,b,e);case 1:return c.RY(a,b,e);case 8:return c.yM(a,b,e)}return!1};c.hu=function(a,b,e,f){switch(f){case 4:return c.uZ(a,
b,e);case 1:return c.GX(a,b,e);case 8:return c.nM(a,b,e);case 16:return c.mZ(a,b,e)}return!1};c.rD=function(a,b,e,f){if(c.pZ(a,b,e))return 4==f?!0:!1;if(4==f)return!1;switch(f){case 2:return c.DM(a,b,e);case 1:return c.nX(a,b,e);case 3:return c.IL(a,b,e);case 8:return c.jM(a,b,e);case 32:return c.ZL(a,b,e);case 16:return c.eZ(a,b,e)}return!1};c.DB=function(a,b,e,f){switch(f){case 4:return c.RL(a,b,e);case 2:return c.sJ(b,a,e);case 1:return c.sJ(a,b,e);case 3:return c.bM(a,b,e);case 32:return c.HM(a,
b,e)}return!1};c.au=function(a,b,e,f){switch(f){case 4:return c.AJ(a,b,e);case 2:return c.SM(a,b,e);case 1:return c.oZ(a,b,e);case 3:return c.zx(a,b,e)}return!1};c.RJ=function(a,b,e,f){switch(f){case 4:return c.NL(a,b,e);case 2:return c.OM(a,b,e);case 1:return c.lZ(a,b,e);case 3:return c.YL(a,b,e);case 8:return c.LM(a,b,e);case 16:return c.HL(a,b,e)}return!1};c.iU=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.We(h,f,e))return!1;h=c.vc(d,b,!1);if(4==h||1==h||2==h)return!1;if(c.qJ(d,b,
e))return!0;h=d.Rb();f=b.Rb();return Math.abs(h-f)>4*Math.max(d.D(),b.D())*e?!1:c.OB(d,b,e,!0)};c.hS=function(a,b,e){var d=c.vc(a,b,!0);return 4==d?!0:1==d||2==d||1073741824==d?!1:c.bD(a,b,e)};c.lW=function(a,b,e){var d=c.vc(a,b,!1);return 4==d||1==d||2==d?!1:c.hD(a,b,e,null)};c.hV=function(a,b,e,f){var d=c.vc(a,b,!1);return 4==d||1==d||2==d?!1:c.cD(a,b,e,f)};c.Ex=function(d,b,e,f){var h=new a.h,l=new a.h;d.s(h);b.s(l);if(!c.Ec(h,l,e))return!1;h=c.vc(d,b,!1);return 4==h||2==h?!1:1==h?!0:c.BL(d,b,
e,f)};c.FS=function(a,b,e){var d=c.vc(a,b,!0);return 4==d?!0:1==d||1073741824==d?!1:c.bD(a,b,e)};c.vW=function(a,b,e,f){var d=c.vc(a,b,!1);return 4==d||1==d?!1:c.jD(a,b,e,f)};c.DP=function(a,b,e){var d=c.vc(a,b,!1);return 4==d||1==d?!1:c.aD(a,b,e,null)};c.LB=function(d,b,e,f){var h=new a.h,l=new a.h;d.s(h);b.s(l);if(!c.Ec(h,l,e))return!1;h=c.vc(d,b,!1);return 4==h?!1:1==h?!0:c.CL(d,b,e,f)};c.WR=function(d,b,c){return 0==a.gd.WH(d,b,c)?!0:!1};c.dW=function(a,b,e){b=b.w();return c.eD(a,b,e)};c.wO=function(a,
b,e){b=b.w();return c.AL(a,b,e)};c.BR=function(d,b,e){var h=c.vc(d,b,!1);if(4==h)return!0;if(1==h)return!1;h=new a.h;d.s(h);h.O(e,e);for(var f=new a.b,l=0;l<b.D();l++)if(b.w(l,f),h.contains(f)){var g=a.gd.ge(d,f,e);if(1==g||2==g)return!1}return!0};c.SV=function(d,b,c){var h=this.vc(d,b,!1);if(4==h||1==h)return!1;h=new a.h;d.s(h);h.O(c,c);var e,f=!1,l;l=d;for(var g=!1,k=0;k<b.D();k++){e=b.Ba(k);if(h.contains(e))if(e=a.gd.ge(l,e,c),2==e)f=!0;else if(1==e)return!1;g||(!a.ff.qm(d,b.D()-1)||null!=d.ob&&
null!=d.ob.Mb?l=d:(l=new a.Ja,d.copyTo(l),l.Hj(1)),g=!0)}return f?!0:!1};c.tP=function(d,b,c){var h=this.vc(d,b,!1);if(4==h||1==h)return!1;var e=new a.h,h=new a.h,f=new a.h;d.s(e);b.s(f);h.I(e);h.O(c,c);var f=e=!1,l,g;g=d;for(var k=!1,m=0;m<b.D();m++){l=b.Ba(m);h.contains(l)?(l=a.gd.ge(g,l,c),0==l?f=!0:1==l&&(e=!0)):f=!0;if(e&&f)return!0;k||(!a.ff.qm(d,b.D()-1)||null!=d.ob&&null!=d.ob.Mb?g=d:(g=new a.Ja,d.copyTo(g),g.Hj(1)),k=!0)}return!1};c.tO=function(d,b,c){var h=new a.h,e=new a.h;d.s(h);b.s(e);
if(!this.Ec(h,e,c))return!1;e=this.vc(d,b,!1);if(4==e)return!1;if(1==e)return!0;var e=!1,f,l;l=d;for(var g=!1,k=0;k<b.D();k++){f=b.Ba(k);if(!h.contains(f))return!1;f=a.gd.ge(l,f,c);if(1==f)e=!0;else if(0==f)return!1;g||(!a.ff.qm(d,b.D()-1)||null!=d.ob&&null!=d.ob.Mb?l=d:(l=new a.Ja,d.copyTo(l),l.Hj(1)),g=!0)}return e};c.fU=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.We(h,f,e))return!1;h=new a.Ja;h.jd(b,!1);return c.OB(d,h,e,!0)};c.lQ=function(d,b,e){var h=c.vc(d,b,!1);if(4==h)return!0;
if(1==h||2==h)return!1;var f=new a.h,h=new a.h;d.s(f);b.s(h);if(c.Ec(h,f,e))return!1;f=new a.b;h.Tn(f);b=a.gd.ge(d,f,e);if(0!=b)return!1;h.TJ(f);b=a.gd.ge(d,f,e);if(0!=b)return!1;h.Un(f);b=a.gd.ge(d,f,e);if(0!=b)return!1;h.WJ(f);b=a.gd.ge(d,f,e);if(0!=b)return!1;b=d.Pa(0);f=new a.h;f.I(h);f.O(e,e);for(var l=0,g=d.D();l<g;l++){var k=b.read(2*l),m=b.read(2*l+1);if(f.contains(k,m))return!1}return!c.XH(d,h,e)};c.kV=function(d,b,e,f){var h=c.vc(d,b,!1);if(4==h||1==h||2==h)return!1;var h=new a.h,l=new a.h;
d.s(h);b.s(l);if(c.Ec(l,h,e))return!1;if(l.N()<=e&&l.fa()<=e)return b=b.Bq(),c.eD(d,b,e);if(l.N()<=e||l.fa()<=e)return h=new a.Ua,l=new a.Wa,b.ig(0,l),h.Rf(l),b.ig(2,l),h.lineTo(l),c.jD(d,h,e,f);h=new a.Ja;h.jd(b,!1);return c.hD(d,h,e,f)};c.eV=function(d,b,e,f){var h=c.vc(d,b,!1);if(4==h||1==h||2==h)return!1;var h=new a.h,l=new a.h;d.s(h);b.s(l);if(c.Ec(l,h,e)||l.N()<=e||l.fa()<=e)return!1;h=new a.Ja;h.jd(b,!1);return c.cD(d,h,e,f)};c.dX=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.Ec(f,
h,e)};c.qO=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.Ec(h,f,e))return!1;h=c.vc(d,b,!1);if(4==h||2==h)return!1;if(1==h)return!0;if(f.N()<=e&&f.fa()<=e)return b=b.Bq(),c.AL(d,b,e);if(f.N()<=e||f.fa()<=e)return f=new a.Ua,h=new a.Wa,b.ig(0,h),f.Rf(h),b.ig(2,h),f.lineTo(h),c.CL(d,f,e,null);f=new a.Ja;f.jd(b,!1);return c.BL(d,f,e,null)};c.EL=function(d,b,e,f){var h=new a.h,l=new a.h;d.s(h);b.s(l);if(c.Ec(l,h,e)||l.fa()>e&&l.N()>e||l.fa()<=e&&l.N()<=e)return!1;h=new a.Ua;l=new a.Wa;b.ig(0,
l);h.Rf(l);b.ig(2,l);h.lineTo(l);return c.aD(d,h,e,f)};c.OL=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.We(h,f,e)&&4!=c.vc(d,b,!1)?c.qJ(d,b,e)?!0:c.OB(d,b,e,!1):!1};c.yZ=function(d,b,c){return 4==this.vc(d,b,!1)?!0:(new a.Lm(d,b,c,!0)).next()?!this.fI(d,b,c):!1};c.tD=function(d,b,e){if(4==c.vc(d,b,!1))return!1;var h=new a.Rd(0);if(0!=c.RB(d,b,e,h))return!1;for(var f=new a.Ed,l=0;l<h.size;l+=2){var g=h.read(l),k=h.read(l+1);f.lv(g,k)}d=d.Gg();b=b.Gg();d.Id(b,0,b.D());return c.yx(d,
f,e)};c.pD=function(d,b,e){if(4==c.vc(d,b,!1))return!1;var h=new a.Rd(0);if(0!=c.RB(d,b,e,h))return!1;for(var f=new a.Ed,l=0;l<h.size;l+=2){var g=h.read(l),k=h.read(l+1);f.lv(g,k)}d=d.Gg();b=b.Gg();d.Id(b,0,b.D());return!c.yx(d,f,e)};c.cM=function(a,b,e){return 4==c.vc(a,b,!1)?!1:c.$H(a,b,e)};c.nD=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.Ec(h,f,e)&&4!=c.vc(d,b,!1)?c.Wg(b,d,e,!1):!1};c.wZ=function(a,b,e){if(4==c.vc(a,b,!1))return!0;b=b.w();return!c.HA(a,b,e)};c.yM=function(a,
b,e){if(4==c.vc(a,b,!1))return!1;b=b.w();return c.gC(a,b,e)};c.RY=function(a,b,e){if(4==c.vc(a,b,!1))return!1;b=b.w();return c.yH(a,b,e)};c.uZ=function(a,b,e){return 4==c.vc(a,b,!1)?!0:!c.ZH(a,b,e,!1)};c.nM=function(d,b,c){if(4==this.vc(d,b,!1))return!1;var h=d.Fa(),e=new a.h,f=new a.h,l=new a.h;d.s(e);b.s(f);e.O(c,c);f.O(c,c);l.I(e);l.Ma(f);var g,k,e=null;g=d.ob;null!=g?(k=g.Mb,e=g.np,null==k&&(k=g=a.na.Lj(d,l))):k=g=a.na.Lj(d,l);var m=k.mf(),r=null;null!=e&&(r=e.mf());var q=new a.b,n=new a.b,w=
!1,x=c*c,e=new a.Fm(b.D());for(g=0;g<b.D();g++)e.write(g,0);for(g=0;g<b.D();g++)if(b.w(g,q),l.contains(q))if(f.I(q.x,q.y,q.x,q.y),null==r||(r.Ni(f,c),-1!=r.next())){m.Ni(f,c);for(var p=m.next();-1!=p;p=m.next())if(h.Tb(k.ja(p)),p=h.ba(),p.gc(p.pe(q,!1),n),a.b.sc(q,n)<=x){e.write(g,1);w=!0;break}}if(!w)return!1;d=d.Gg();h=new a.Ed;f=new a.b;for(g=0;g<b.D();g++)0!=e.read(g)&&(b.w(g,f),h.lv(f.x,f.y));return this.yx(d,h,c)};c.mZ=function(d,b,c){if(4==this.vc(d,b,!1))return!1;var h=d.Fa(),e=new a.h,f=
new a.h,l=new a.h;d.s(e);b.s(f);e.O(c,c);f.O(c,c);l.I(e);l.Ma(f);var g,k,e=null;g=d.ob;null!=g?(k=g.Mb,e=g.np,null==k&&(k=g=a.na.Lj(d,l))):k=g=a.na.Lj(d,l);var m=k.mf(),r=null;null!=e&&(r=e.mf());var q=new a.b,n=new a.b,w=!1,x=!1,p=c*c,e=new a.Fm(b.D());for(g=0;g<b.D();g++)e.write(g,0);for(g=0;g<b.D();g++)if(b.w(g,q),l.contains(q))if(f.I(q.x,q.y,q.x,q.y),null!=r&&(r.Ni(f,c),-1==r.next()))x=!0;else{m.Ni(f,c);for(var u=!1,B=m.next();-1!=B;B=m.next())if(h.Tb(k.ja(B)),B=h.ba(),B.gc(B.pe(q,!1),n),a.b.sc(q,
n)<=p){e.write(g,1);u=w=!0;break}u||(x=!0)}else x=!0;if(!w||!x)return!1;d=d.Gg();h=new a.Ed;f=new a.b;for(g=0;g<b.D();g++)0!=e.read(g)&&(b.w(g,f),h.lv(f.x,f.y));return!this.yx(d,h,c)};c.GX=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.Ec(h,f,e)||4==c.vc(d,b,!1)||!c.ZH(d,b,e,!0))return!1;d=d.Gg();return!c.CJ(d,b,e)};c.IL=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return f.fa()>e&&f.N()>e?!1:c.We(h,f,e)};c.pZ=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.Ec(f,
h,e)?!1:!c.XH(d,f,e)};c.jM=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(f.fa()<=e&&f.N()<=e)return f=b.Bq(),c.gC(d,f,e);if(f.fa()<=e||f.N()<=e)return f=new a.Ua,h=new a.Wa,b.ig(0,h),f.Rf(h),b.ig(2,h),f.lineTo(h),c.tD(d,f,e);d=d.Fa();b=new a.h;h=new a.h;b.I(f);h.I(f);b.O(-e,-e);h.O(e,e);for(var f=!1,l=new a.h,g=new a.h;d.Ya();)for(;d.Ea();){d.ba().s(l);g.I(b);g.Ma(l);if(!g.u()&&(g.fa()>e||g.N()>e))return!1;g.I(h);g.Ma(l);g.u()||(f=!0)}return f};c.ZL=function(d,b,e){var h=new a.h,f=new a.h;
d.s(h);b.s(f);if(c.Ec(h,f,e)||c.Ec(f,h,e)||c.Ec(f,h,e)||f.fa()>e&&f.N()>e||f.fa()<=e&&f.N()<=e)return!1;h=new a.Ua;f=new a.Wa;b.ig(0,f);h.Rf(f);b.ig(2,f);h.lineTo(f);return c.$H(d,h,e)};c.DM=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.Ec(f,h,e)||f.fa()<=e&&f.N()<=e)return!1;if(f.fa()<=e||f.N()<=e)return c.Ec(f,h,e);d=d.Fa();b=new a.h;b.I(f);b.O(-e,-e);for(var f=!1,h=new a.h,l=new a.h;d.Ya();)for(;d.Ea();)d.ba().s(h),b.Tm(h)?f=!0:(l.I(b),l.Ma(h),!l.u()&&(l.fa()>e||l.N()>e)&&(f=!0));
return f};c.nX=function(d,b,e){var h=new a.h,f=new a.h;b.s(f);d.s(h);if(!c.Ec(h,f,e)||f.fa()>e&&f.N()>e)return!1;if(f.fa()<=e&&f.N()<=e)return b=b.Bq(),c.yH(d,b,e);h=new a.Ua;f=new a.Wa;b.ig(0,f);h.Rf(f);b.ig(2,f);h.lineTo(f);return c.Wg(h,d,e,!1)};c.eZ=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(c.Ec(f,h,e)||f.fa()<=e&&f.N()<=e)return!1;if(f.fa()<=e||f.N()<=e)return h=new a.Ua,f=new a.Wa,b.ig(0,f),h.Rf(f),b.ig(2,f),h.lineTo(f),c.pD(d,h,e);d=d.Fa();b=new a.h;h=new a.h;h.I(f);b.I(f);h.O(-e,
-e);b.O(e,e);for(var l=f=!1,g=new a.h,k=new a.h;d.Ya();)for(;d.Ea();)if(d.ba().s(g),l||b.contains(g)||(l=!0),f||(k.I(h),k.Ma(g),!k.u()&&(k.fa()>e||k.N()>e)&&(f=!0)),f&&l)return!0;return!1};c.bM=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.We(h,f,e)?c.iM(d,b,e)?!0:c.QC(d,b,e,!1,!0,!1):!1};c.RL=function(a,b,e){return!c.CJ(a,b,e)};c.HM=function(a,b,e){return c.QC(a,b,e,!1,!1,!0)};c.sJ=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.Ec(h,f,e)?c.QC(b,d,e,!0,!1,!1):!1};
c.yx=function(d,b,c){c*=c;for(var h=new a.b,e=new a.b,f=0;f<b.D();f++){b.w(f,e);for(var l=!1,g=0;g<d.D();g++)if(d.w(g,h),a.b.sc(h,e)<=c){l=!0;break}if(!l)return!1}return!0};c.zx=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return c.We(h,f,e)};c.AJ=function(a,b,e){b=b.w();return c.$t(a,b,e)};c.SM=function(a,b,e){return c.zx(a,b,e)};c.oZ=function(a,b,e){return!c.AJ(a,b,e)};c.YL=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);return f.fa()>e||f.N()>e?!1:c.We(h,f,e)};c.NL=function(d,b,
e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(c.Ec(f,h,e))return!1;b=new a.h;b.I(f);b.O(e,e);e=new a.b;for(f=0;f<d.D();f++)if(d.w(f,e),b.contains(e))return!1;return!0};c.LM=function(d,b,c){var h=new a.h,e=new a.h,f=new a.h;b.s(h);if(h.fa()<=c&&h.N()<=c)return!1;if(h.fa()<=c||h.N()<=c){b=new a.b;var l=!1;e.I(h);f.I(h);e.O(c,c);h.fa()>c?f.O(0,-c):f.O(-c,0);for(var g=0;g<d.D();g++)if(d.w(g,b),e.contains(b)){if(h.fa()>c){if(b.y>f.A&&b.y<f.B)return!1}else if(b.x>f.o&&b.x<f.v)return!1;l=!0}return l}e.I(h);
f.I(h);e.O(c,c);f.O(-c,-c);b=new a.b;l=!1;for(g=0;g<d.D();g++)if(d.w(g,b),e.contains(b)){if(f.Tm(b))return!1;l=!0}return l};c.OM=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.Ec(f,h,e))return!1;if(f.fa()<=e&&f.N()<=e)return c.We(h,f,e);if(f.fa()<=e||f.N()<=e){b=!1;var h=new a.h,l=new a.h;h.I(f);l.I(f);f.fa()>e?h.O(0,-e):h.O(-e,0);l.O(e,e);for(var g=new a.b,k=0;k<d.D();k++){d.w(k,g);if(!l.contains(g))return!1;f.fa()>e?g.y>h.A&&g.y<h.B&&(b=!0):g.x>h.o&&g.x<h.v&&(b=!0)}return b}b=!1;h=
new a.h;l=new a.h;h.I(f);l.I(f);h.O(-e,-e);l.O(e,e);g=new a.b;for(k=0;k<d.D();k++){d.w(k,g);if(!l.contains(g))return!1;h.Tm(g)&&(b=!0)}return b};c.lZ=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(!c.Ec(h,f,e)||f.fa()>e||f.N()>e)return!1;b=b.Bq();return!c.$t(d,b,e)};c.HL=function(d,b,e){var h=new a.h,f=new a.h;d.s(h);b.s(f);if(c.Ec(f,h,e)||f.fa()<=e&&f.N()<=e)return!1;if(f.fa()<=e||f.N()<=e){b=new a.h;h=new a.h;b.I(f);f.fa()>e?b.O(0,-e):b.O(-e,0);h.I(f);h.O(e,e);for(var l=new a.b,g=!1,k=
!1,m=0;m<d.D();m++)if(d.w(m,l),g||(f.fa()>e?l.y>b.A&&l.y<b.B&&(g=!0):l.x>b.o&&l.x<b.v&&(g=!0)),k||h.contains(l)||(k=!0),g&&k)return!0;return!1}b=new a.h;h=new a.h;b.I(f);b.O(-e,-e);h.I(f);h.O(e,e);l=new a.b;k=g=!1;for(m=0;m<d.D();m++)if(d.w(m,l),!g&&b.Tm(l)&&(g=!0),k||h.contains(l)||(k=!0),g&&k)return!0;return!1};c.yL=function(d,b,c){return a.b.sc(d,b)<=c*c?!0:!1};c.MN=function(d,b,c){return a.b.sc(d,b)>c*c?!0:!1};c.eL=function(a,b,e){return c.yL(a,b,e)};c.qL=function(d,b,e){var h=new a.h;h.I(d);
return c.We(h,b,e)};c.Dx=function(d,b,c){var h=new a.h;h.I(b);h.O(c,c);return!h.contains(d)};c.WC=function(d,b,c){if(b.fa()<=c&&b.N()<=c)return!1;var h=new a.h,e=new a.h;h.I(b);h.O(c,c);if(!h.contains(d))return!1;if(b.fa()<=c||b.N()<=c){e.I(b);b.fa()>c?e.O(0,-c):e.O(-c,0);if(b.fa()>c){if(d.y>e.A&&d.y<e.B)return!1}else if(d.x>e.o&&d.x<e.v)return!1;return!0}e.I(b);e.O(-c,-c);return e.Tm(d)?!1:!0};c.XC=function(d,b,c){if(b.fa()<=c&&b.N()<=c)return!0;if(b.fa()<=c||b.N()<=c){var h=new a.h;h.I(b);b.fa()>
c?h.O(0,-c):h.O(-c,0);var e=!1;b.fa()>c?d.y>h.A&&d.y<h.B&&(e=!0):d.x>h.o&&d.x<h.v&&(e=!0);return e}h=new a.h;h.I(b);h.O(-c,-c);return h.Tm(d)};c.DN=function(a,b,e){return c.qL(a,b,e)};c.We=function(a,b,e){return c.Ec(a,b,e)&&c.Ec(b,a,e)};c.Ek=function(d,b,c){var h=new a.h;h.I(b);h.O(c,c);return!d.Yb(h)};c.CP=function(d,b,e){if(d.fa()<=e&&d.N()<=e){var h=d.Wf();return c.WC(h,b,e)}if(b.fa()<=e&&b.N()<=e)return h=b.Wf(),c.WC(h,d,e);d.fa()>e&&d.N()>e&&(b.fa()<=e||b.N()<=e)?h=b:(h=d,d=b);if(h.fa()<=e||
h.N()<=e){if(d.fa()<=e||d.N()<=e){b=new a.Hb;var f=new a.Hb,l=[0,0],g=[0,0],k=new a.b;h.Tn(k);b.Mc(k);h.Un(k);b.Zc(k);d.Tn(k);f.Mc(k);d.Un(k);f.Zc(k);b.Ma(f,null,l,g,e);return 1!=b.Ma(f,null,null,null,e)?!1:0==l[0]||1==l[1]||0==g[0]||1==g[1]}b=new a.h;f=new a.h;b.I(d);b.O(-e,-e);f.I(b);f.Ma(h);return!f.u()&&(f.fa()>e||f.N()>e)?!1:!0}d.O(e,e);f=new a.h;f.I(h);f.Ma(d);return f.u()||!f.u()&&f.fa()>e&&f.N()>e?!1:!0};c.$O=function(d,b,e){if(c.Ec(d,b,e)||c.Ec(b,d,e)||d.fa()<=e&&d.N()<=e||b.fa()<=e&&b.N()<=
e)return!1;if(d.fa()<=e||d.N()<=e){if(b.fa()>e&&b.N()>e)return!1;var h=new a.Hb,f=new a.Hb,l=[0,0],g=[0,0],k=new a.b;d.Tn(k);h.Mc(k);d.Un(k);h.Zc(k);b.Tn(k);f.Mc(k);b.Un(k);f.Zc(k);h.Ma(f,null,l,g,e);return 2!=h.Ma(f,null,null,null,e)?!1:(0<l[0]||1>l[1])&&(0<g[0]||1>g[1])}if(b.fa()<=e||b.N()<=e)return!1;h=new a.h;h.I(d);h.Ma(b);return h.u()||h.fa()<=e||h.N()<=e?!1:!0};c.RE=function(d,b,e){if(!c.Ec(d,b,e))return!1;if(d.fa()<=e&&d.N()<=e)return d=d.Wf(),c.XC(d,b,e);if(b.fa()<=e&&b.N()<=e)return b=b.Wf(),
c.XC(b,d,e);if(d.fa()<=e||d.N()<=e)return c.Ec(d,b,e);if(b.fa()<=e||b.N()<=e){var h=new a.h;h.I(d);h.O(-e,-e);if(h.Tm(b))return!0;d=new a.h;d.I(h);d.Ma(b);return d.u()||d.fa()<=e&&d.N()<=e?!1:!0}return c.Ec(d,b,e)};c.DL=function(d,b,e){if(c.Ec(d,b,e)||c.Ec(b,d,e)||d.fa()<=e&&d.N()<=e||b.fa()<=e&&b.N()<=e||b.fa()>e&&b.N()>e&&d.fa()>e&&d.N()>e)return!1;var h;d.fa()>e&&d.N()>e?h=b:(h=d,d=b);if(d.fa()>e&&d.N()>e){b=new a.h;var f=new a.h;f.I(d);f.O(-e,-e);b.I(f);b.Ma(h);return b.u()||b.fa()<=e&&b.N()<=
e?!1:!0}b=new a.Hb;var f=new a.Hb,l=[0,0],g=[0,0],k=new a.b;h.Tn(k);b.Mc(k);h.Un(k);b.Zc(k);d.Tn(k);f.Mc(k);d.Un(k);f.Zc(k);b.Ma(f,null,l,g,e);return 1!=b.Ma(f,null,null,null,e)?!1:0<l[0]&&1>l[1]&&0<g[0]&&1>g[1]};c.bD=function(d,b,c){var h,e,f=new a.h,l=new a.h,g=new a.Lm(d,b,c,!0);if(!g.next())return!0;if(this.fI(d,b,c))return!1;var k;k=d;var m;m=null;1736==b.G()&&(m=b);var q=!1,n=!1;do{h=g.Ql();e=g.Ml();e=b.Ba(b.wa(e));f.I(g.eA());f.O(c,c);if(f.contains(e)&&(e=a.gd.ge(k,e,0),0!=e)||1736==b.G()&&
(h=d.Ba(d.wa(h)),l.I(g.Iz()),l.O(c,c),l.contains(h)&&(e=a.gd.ge(m,h,0),0!=e)))return!1;q||(!a.ff.qm(d,b.aa()-1)||null!=d.ob&&null!=d.ob.Mb?k=d:(k=new a.Ja,d.copyTo(k),k.Hj(1)),q=!0);1736!=b.G()||n||(n=b,!a.ff.qm(n,d.aa()-1)||null!=b.ob&&null!=b.ob.Mb?m=b:(m=new a.Ja,n.copyTo(m),m.Hj(1)),n=!0)}while(g.next());return!0};c.Ec=function(d,b,c){var h=new a.h;h.I(d);h.O(c,c);return h.contains(b)};c.Yp=function(d,b,c){var h=new a.h;h.I(b);h.O(c,c);b=new a.b;d.Tn(b);if(!h.contains(b))return!0;d.TJ(b);if(!h.contains(b))return!0;
d.WJ(b);if(!h.contains(b))return!0;d.Un(b);return h.contains(b)?!1:!0};c.qJ=function(b,c,e){if(b.aa()!=c.aa()||b.D()!=c.D())return!1;var d=new a.b,h=new a.b,f=!0;e*=e;for(var l=0;l<b.aa();l++){if(b.Gc(l)!=c.Gc(l)){f=!1;break}for(var g=b.wa(l);g<c.Gc(l);g++)if(b.w(g,d),c.w(g,h),a.b.sc(d,h)>e){f=!1;break}if(!f)break}return f?!0:!1};c.iM=function(b,c,e){if(b.D()!=c.D())return!1;var d=new a.b,h=new a.b,f=!0;e*=e;for(var l=0;l<b.D();l++)if(b.w(l,d),c.w(l,h),a.b.sc(d,h)>e){f=!1;break}return f?!0:!1};c.QC=
function(b,c,e,f,l,g){var d=!1,h;b.D()>c.D()?(f&&(f=!1,d=!0),h=c):(h=b,b=c);c=null;if(l||g||d){c=new a.Fm(b.D());for(var k=0;k<b.D();k++)c.write(k,0)}var k=new a.h,m=new a.h,q=new a.h;h.s(k);b.s(m);k.O(e,e);m.O(e,e);q.I(k);q.Ma(m);for(var m=new a.b,n=new a.b,w=!0,r=a.na.BF(b,q),x=r.mf(),p=e*e,u=0;u<h.D();u++)if(h.w(u,m),q.contains(m)){var B=!1;k.I(m.x,m.y,m.x,m.y);x.Ni(k,e);for(var z=x.next();-1!=z&&!(z=r.ja(z),b.w(z,n),a.b.sc(m,n)<=p&&((l||g||d)&&c.write(z,1),B=!0,f));z=x.next());if(!B&&(w=!1,l||
f))return!1}else{if(l||f)return!1;w=!1}if(g&&w)return!1;if(f)return!0;for(k=0;k<b.D();k++)if(1==c.read(k)){if(g)return!0}else if(l||d)return!1;return g?!1:!0};c.CJ=function(b,c,e){var d;b.D()>c.D()?d=c:(d=b,b=c);c=new a.h;var h=new a.h,f=new a.h;d.s(c);b.s(h);c.O(e,e);h.O(e,e);f.I(c);f.Ma(h);for(var h=new a.b,l=new a.b,g=e*e,k=a.na.BF(b,f),m=k.mf(),q=0;q<d.D();q++)if(d.w(q,h),f.contains(h)){c.I(h.x,h.y,h.x,h.y);m.Ni(c,e);for(var n=m.next();-1!=n;n=m.next())if(b.w(k.ja(n),l),a.b.sc(h,l)<=g)return!0}return!1};
c.OB=function(a,b,e,f){return c.Wg(a,b,e,f)&&c.Wg(b,a,e,f)};c.Wg=function(d,h,e,f){function l(a,b){return w.WF(a,b)}var g=!0,k=[0,0],m=[0,0],q=0,n=new a.ia(0),w=new c,r,x=new a.h,p=new a.h,u=new a.h;d.s(x);h.s(p);x.O(e,e);p.O(e,e);u.I(x);u.Ma(p);d=d.Fa();var p=h.Fa(),B=null,z=B=null,v=h.ob;null!=v?(B=v.Mb,z=v.np,null==B&&(B=a.na.Lj(h,u))):B=a.na.Lj(h,u);h=B.mf();v=null;for(null!=z&&(v=z.mf());d.Ya();)for(;d.Ea();){var t=!1,C=d.ba();C.s(x);if(!x.Yb(u))return!1;if(null!=v&&(v.Ni(x,e),-1==v.next()))return g=
!1;z=C.Rb();h.Wn(C,e);for(r=h.next();-1!=r;r=h.next()){p.Tb(B.ja(r));r=p.ba();var E=C.Ma(r,null,k,m,e);if(2==E&&(!f||m[0]<=m[1])){var E=k[0],F=k[1],D=m[0],y=m[1];if(E*z<=e&&(1-F)*z<=e){t=!0;q=0;n.resize(0);w.Ph.length=0;for(var G=d.Db(),D=!0;D;){if(d.Ea()){C=d.ba();z=C.Rb();E=C.Ma(r,null,k,m,e);if(2==E&&(!f||m[0]<=m[1])&&(E=k[0],F=k[1],E*z<=e&&(1-F)*z<=e)){G=d.Db();continue}if(p.Ea()&&(r=p.ba(),E=C.Ma(r,null,k,m,e),2==E&&(!f||m[0]<=m[1])&&(E=k[0],F=k[1],E*z<=e&&(1-F)*z<=e))){G=d.Db();continue}}D=
!1}G!=d.Db()&&(d.Tb(G),d.ba());break}else G=d.Db(),r=b.pa(G,d.Ta,E,F,p.Db(),p.Ta,D,y),w.Ph.push(r),n.add(n.size)}}if(!t){if(q==w.Ph.length)return!1;1<n.size-q&&n.Gd(q,n.size,l);for(t=0;q<w.Ph.length;q++)if(r=w.Ph[n.get(q)],!(r.ek<t&&r.rj<t)){if(z*(r.ek-t)>e)return!1;t=r.rj;if(z*(1-t)<=e||1==t)break}if(z*(1-t)>e)return!1;q=0;n.resize(0);w.Ph.length=0}}return g};c.$H=function(b,h,e){if(1>c.RB(b,h,e,null))return!1;var d=new a.h,f=new a.h;b.s(d);h.s(f);var l=c.Yp(d,f,e),d=c.Yp(f,d,e);return l&&d?!0:l&&
!d?!c.Wg(h,b,e,!1):d&&!l?!c.Wg(b,h,e,!1):!c.Wg(b,h,e,!1)&&!c.Wg(h,b,e,!1)};c.RB=function(d,h,e,f){function l(a,b){return p.WF(a,b)}var g,k;d.iA()>h.iA()?(g=h,k=d):(g=d,k=h);d=g.Fa();h=k.Fa();var m=[0,0],q=[0,0],n=-1,w=0,r,x=new a.ia(0),p=new c,u,B=new a.h,z=new a.h,v=new a.h;g.s(B);k.s(z);B.O(e,e);z.O(e,e);v.I(B);v.Ma(z);g=null;null!=f&&(g=new a.b);r=z=z=null;var t=k.ob;null!=t?(z=t.Mb,r=t.np,null==z&&(z=a.na.Lj(k,v))):z=a.na.Lj(k,v);k=z.mf();t=null;for(null!=r&&(t=r.mf());d.Ya();)for(r=0;d.Ea();){var C=
d.ba();C.s(B);if(B.Yb(v)&&(null==t||(t.Ni(B,e),-1!=t.next()))){var E=C.Rb();k.Wn(C,e);for(var F=k.next();-1!=F;F=k.next()){var D=z.ja(F);h.Tb(D);u=h.ba();var y=u.Rb(),G=C.Ma(u,null,m,q,e);if(0<G){var F=m[0],n=q[0],A=2==G?m[1]:NaN,I=2==G?q[1]:NaN;if(2==G){if(E*(A-F)>e)return n=1;var K=E*(A-F);if(h.Ea()){u=h.ba();G=C.Ma(u,null,m,null,e);if(2==G){var G=m[0],M=m[1],G=E*(M-G);if(K+G>e)return n=1}h.Tb(D);h.ba()}if(!h.jn()){h.Li();u=h.Li();G=C.Ma(u,null,m,null,e);if(2==G&&(G=m[0],M=m[1],G=E*(M-G),K+G>e))return n=
1;h.Tb(D);h.ba()}if(d.Ea()){D=d.Db();C=d.ba();G=C.Ma(u,null,m,null,e);if(2==G&&(G=m[0],M=m[1],G=E*(M-G),K+G>e))return n=1;d.Tb(D);d.ba()}if(!d.jn()){D=d.Db();d.Li();C=d.Li();G=C.Ma(u,null,m,null,e);if(2==G&&(G=m[0],M=m[1],G=y*(M-G),K+G>e))return n=1;d.Tb(D);d.ba()}u=b.pa(d.Db(),d.Ta,F,A,h.Db(),h.Ta,n,I);p.Ph.push(u);x.add(x.size)}n=0;null!=f&&(C.gc(F,g),f.add(g.x),f.add(g.y))}}if(w<p.Ph.length){x.Gd(w,x.size,l);C=0;for(F=p.Ph[x.get(w)].zn;w<p.Ph.length;w++)if(u=p.Ph[x.get(w)],!(u.ek<C&&u.rj<C))if(E*
(u.ek-C)>e)r=E*(u.rj-u.ek),C=u.rj,F=u.zn;else{u.zn!=F?(r=E*(u.rj-u.ek),F=u.zn):r+=E*(u.rj-u.ek);if(r>e)return n=1;C=u.rj;if(1==C)break}E*(1-C)>e&&(r=0);w=0;x.resize(0);p.Ph.length=0}}}return n};c.fI=function(b,c,e){var d=b.Fa(),h=c.Fa();for(b=new a.Lm(b,c,e,!1);b.next();){c=b.Ql();var f=b.Ml();d.Tb(c);h.Tb(f);c=d.ba();if(0<h.ba().Ma(c,null,null,null,e))return!0}return!1};c.ZH=function(b,c,e,f){var d=b.Fa(),h=new a.h,l=new a.h,g=new a.h;b.s(h);c.s(l);h.O(e,e);h.contains(l);l.O(e,e);g.I(h);g.Ma(l);
h=b.ob;null!=h?(h=h.Mb,null==h&&(h=a.na.Lj(b,g))):h=a.na.Lj(b,g);b=h.mf();for(var k=new a.b,m=new a.b,q=e*e,n=0;n<c.D();n++)if(c.w(n,k),g.contains(k)){l.I(k.x,k.y,k.x,k.y);b.Ni(l,e);for(var w=!1,r=b.next();-1!=r;r=b.next())if(d.Tb(h.ja(r)),r=d.ba(),r.gc(r.pe(k,!1),m),a.b.sc(m,k)<=q){w=!0;break}if(f){if(!w)return!1}else if(w)return!0}return f?!0:!1};c.HA=function(b,c,e){var d=new a.b,h=e*e,f=b.Fa();b=b.ob;if(null!=b&&(b=b.Mb,null!=b)){var l=new a.h;l.I(c);e=b.Xz(l,e);for(l=e.next();-1!=l;l=e.next())if(f.Tb(b.ja(l)),
f.Ea()){var l=f.ba(),g=l.pe(c,!1);l.gc(g,d);if(a.b.sc(c,d)<=h)return!0}return!1}for(b=new a.h;f.Ya();)for(;f.Ea();)if(l=f.ba(),l.s(b),b.O(e,e),b.contains(c)&&(g=l.pe(c,!1),l.gc(g,d),a.b.sc(c,d)<=h))return!0;return!1};c.yH=function(a,b,e){return c.HA(a,b,e)&&!c.gC(a,b,e)};c.gC=function(a,b,e){a=a.Gg();return!c.$t(a,b,e)};c.XH=function(b,c,e){if(b.hn()){var d=new a.Hb(c.o,c.A,c.o,c.B),h=new a.Hb(c.o,c.B,c.v,c.B),f=new a.Hb(c.v,c.B,c.v,c.A);c=new a.Hb(c.v,c.A,c.o,c.A);for(b=b.Fa();b.Ya();)for(;b.Ea();){var l=
b.ba();if(l.Yb(d,e)||l.Yb(h,e)||l.Yb(f,e)||l.Yb(c,e))return!0}}else{d=new a.h;d.I(c);d.O(e,e);e=b.Pa(0);h=new a.b;f=new a.b;c=new a.b;for(var l=new a.b,g=0,k=b.aa();g<k;g++)for(var m=!0,q=b.wa(g),n=b.Gc(g);q<n;q++)if(m)e.fc(2*q,f),m=!1;else{e.fc(2*q,h);c.L(f);l.L(h);if(0!=d.gz(c,l))return!0;f.L(h)}}return!1};c.vc=function(b,h,e){var d=b.G(),f=h.G();if(a.T.gh(d)){var l=b.ob;if(null!=l&&(l=l.Hi,null!=l))if(33==f){var g=h.w(),g=l.rm(g.x,g.y);if(1==g)return 1;if(0==g)return 4}else{g=new a.h;h.s(g);g=
l.Rn(g);if(1==g)return 1;if(0==g)return 4;if(e&&a.T.gh(f)&&c.ZC(h,l))return 1073741824}}if(a.T.gh(f)&&(l=h.ob,null!=l&&(l=l.Hi,null!=l)))if(33==d){b=b.w();g=l.rm(b.x,b.y);if(1==g)return 2;if(0==g)return 4}else{h=new a.h;b.s(h);g=l.Rn(h);if(1==g)return 2;if(0==g)return 4;if(e&&a.T.gh(d)&&c.ZC(b,l))return 1073741824}return 0};c.ZC=function(b,c){for(var d=b.D(),h=new a.b,e=0;e<d;e++)if(b.w(e,h),1==c.rm(h.x,h.y))return!0;return!1};c.hD=function(b,c,e,f){for(var d=1<=b.Lk(0)&&1<=c.Lk(0),h=b.Fa(),l=c.Fa(),
g=[0,0],k=[0,0],m=new a.Lm(b,c,e,!1),q=!1;m.next();){var n=m.Ql(),w=m.Ml();h.Tb(n);l.Tb(w);n=h.ba();w=l.ba().Ma(n,null,k,g,e);if(2==w){q=g[0];w=g[1];n=n.Rb();if(d&&(w-q)*n>e)return!1;q=!0}else if(0!=w){q=g[0];n=k[0];if(0<q&&1>q&&0<n&&1>n)return!1;q=!0}}if(!q)return!1;h=new a.h;l=new a.h;d=new a.h;b.s(h);c.s(l);h.O(1E3*e,1E3*e);l.O(1E3*e,1E3*e);d.I(h);d.Ma(l);return 10<b.D()&&(b=a.ne.clip(b,d,e,0),b.u())||10<c.D()&&(c=a.ne.clip(c,d,e,0),c.u())?!1:a.Nm.gu(b,c,e,"F********",f)};c.cD=function(b,h,e,f){var d=
1<=b.Lk(0)&&1<=h.Lk(0),l=new a.h,g=new a.h,k=new a.h;b.s(l);h.s(g);for(var m=!1,q=c.Yp(l,g,e),n=c.Yp(g,l,e),w=b.Fa(),r=h.Fa(),x=[0,0],p=[0,0],u=new a.Lm(b,h,e,!1);u.next();){var B=u.Ql(),z=u.Ml();w.Tb(B);r.Tb(z);z=w.ba();B=r.ba().Ma(z,null,p,x,e);if(2==B){var B=x[0],v=x[1],z=z.Rb();if(d&&(v-B)*z>e&&(m=!0,q&&n))return!0}else if(0!=B&&(B=x[0],z=p[0],0<B&&1>B&&0<z&&1>z))return!0}d=new a.h;w=new a.h;d.I(l);d.O(1E3*e,1E3*e);w.I(g);w.O(1E3*e,1E3*e);k.I(d);k.Ma(w);l="";l=m?l+"**":l+"T*";if(q){if(10<h.D()&&
(h=a.ne.clip(h,k,e,0),h.u()))return!1;l+="****"}else l+="T***";if(n){if(10<b.D()&&(b=a.ne.clip(b,k,e,0),b.u()))return!1;l+="***"}else l+="T**";return a.Nm.gu(b,h,e,l.toString(),f)};c.BL=function(b,h,e,f){var d=[!1],l=c.zL(b,h,e,d);if(d[0])return l;d=new a.h;h.s(d);d.O(1E3*e,1E3*e);return 10<b.D()&&(b=a.ne.clip(b,d,e,0),b.u())?!1:a.Nm.Ex(b,h,e,f)};c.zL=function(b,c,e,f){f[0]=!1;for(var d=b.Fa(),h=c.Fa(),l=[0,0],g=[0,0],k=new a.Lm(b,c,e,!1),m=!1;k.next();){var q=k.Ql(),n=k.Ml();d.Tb(q,-1);h.Tb(n,-1);
q=d.ba();q=h.ba().Ma(q,null,g,l,e);if(0!=q&&(m=!0,1==q&&(q=l[0],n=g[0],0<q&&1>q&&0<n&&1>n)))return f[0]=!0,!1}if(!m){f[0]=!0;l=new a.h;b.s(l);l.O(e,e);k=b;m=!1;g=new a.h;f=0;for(d=c.aa();f<d;f++)if(0<c.La(f)){c.jk(f,g);if(l.Yb(g)){if(h=c.Ba(c.wa(f)),h=a.ff.kn(k,h,0),0==h)return!1}else return!1;m||(!a.ff.qm(b,c.aa()-1)||null!=b.ob&&null!=b.ob.Mb?k=b:(h=new a.Ja,b.copyTo(h),h.Hj(1),k=h),m=!0)}if(1==b.aa()||1607==c.G())return!0;l=new a.h;c.s(l);l.O(e,e);g=c;k=!1;e=new a.h;f=0;for(d=b.aa();f<d;f++)if(0<
b.La(f)){b.jk(f,e);if(l.Yb(e)&&(h=b.Ba(b.wa(f)),h=a.ff.kn(g,h,0),1==h))return!1;k||(!a.ff.qm(c,b.aa()-1)||null!=c.ob&&null!=c.ob.Mb?g=c:(h=new a.Ja,c.copyTo(h),h.Hj(1),g=h),k=!0)}return!0}return!1};c.jD=function(b,c,e,f){for(var d=b.Fa(),h=c.Fa(),l=[0,0],g=[0,0],k=new a.Lm(b,c,e,!1),m=!1;k.next();){var q=k.Ql(),n=k.Ml();d.Tb(q);h.Tb(n);q=d.ba();q=h.ba().Ma(q,null,g,l,e);if(2==q)m=!0;else if(0!=q){m=l[0];q=g[0];if(0<m&&1>m&&0<q&&1>q)return!1;m=!0}}if(!m)return!1;h=new a.h;l=new a.h;d=new a.h;b.s(h);
c.s(l);h.O(1E3*e,1E3*e);l.O(1E3*e,1E3*e);d.I(h);d.Ma(l);return 10<b.D()&&(b=a.ne.clip(b,d,e,0),b.u())||10<c.D()&&(c=a.ne.clip(c,d,e,0),c.u())?!1:a.Nm.On(b,c,e,"F********",f)};c.aD=function(b,h,e,f){for(var d=b.Fa(),l=h.Fa(),g=[0,0],k=[0,0],m=new a.Lm(b,h,e,!1),q=!1;m.next();){var n=m.Ql(),w=m.Ml();d.Tb(n);l.Tb(w);n=d.ba();n=l.ba().Ma(n,null,k,g,e);if(2==n)q=!0;else if(0!=n){q=g[0];n=k[0];if(0<q&&1>q&&0<n&&1>n)return!0;q=!0}}if(!q)return!1;l=new a.h;g=new a.h;k=new a.h;m=new a.h;d=new a.h;b.s(l);h.s(g);
return c.Yp(g,l,e)?(k.I(l),k.O(1E3*e,1E3*e),m.I(g),m.O(1E3*e,1E3*e),d.I(k),d.Ma(m),10<b.D()&&(b=a.ne.clip(b,d,e,0),b.u())||10<h.D()&&(h=a.ne.clip(h,d,e,0),h.u())?!1:e=a.Nm.On(b,h,e,"T********",f)):e=a.Nm.On(b,h,e,"T*****T**",f)};c.CL=function(b,h,e,f){var d=[!1],l=c.zL(b,h,e,d);if(d[0])return l;d=new a.h;h.s(d);d.O(1E3*e,1E3*e);return 10<b.D()&&(b=a.ne.clip(b,d,e,0),b.u())?!1:a.Nm.LB(b,h,e,f)};c.AL=function(b,c,e){return 1==a.gd.ge(b,c,e)?!0:!1};c.eD=function(b,c,e){return 2==a.gd.ge(b,c,e)?!0:!1};
c.$t=function(b,c,e){var d=new a.b;e*=e;for(var h=0;h<b.D();h++)if(b.w(h,d),a.b.sc(d,c)<=e)return!1;return!0};c.prototype.WF=function(a,b){a=this.Ph[a];b=this.Ph[b];return a.zn<b.zn||a.zn==b.zn&&(a.bx<b.bx||a.bx==b.bx&&(a.ek<b.ek||a.ek==b.ek&&(a.rj<b.rj||a.rj==b.rj&&a.RI<b.RI)))?-1:1};return c}();a.Fd=c})(D||(D={}));(function(a){var b;(function(a){a[a.InteriorInterior=0]="InteriorInterior";a[a.InteriorBoundary=1]="InteriorBoundary";a[a.InteriorExterior=2]="InteriorExterior";a[a.BoundaryInterior=3]=
"BoundaryInterior";a[a.BoundaryBoundary=4]="BoundaryBoundary";a[a.BoundaryExterior=5]="BoundaryExterior";a[a.ExteriorInterior=6]="ExteriorInterior";a[a.ExteriorBoundary=7]="ExteriorBoundary";a[a.ExteriorExterior=8]="ExteriorExterior"})(b||(b={}));var c;(function(a){a[a.AreaAreaPredicates=0]="AreaAreaPredicates";a[a.AreaLinePredicates=1]="AreaLinePredicates";a[a.LineLinePredicates=2]="LineLinePredicates";a[a.AreaPointPredicates=3]="AreaPointPredicates";a[a.LinePointPredicates=4]="LinePointPredicates";
a[a.PointPointPredicates=5]="PointPointPredicates"})(c||(c={}));b=function(){function b(){this.Ie=0;this.i=new a.Qu;this.H=[0,0,0,0,0,0,0,0,0];this.eb=[0,0,0,0,0,0,0,0,0];this.ga=[!1,!1,!1,!1,!1,!1,!1,!1,!1];this.Fn=this.jx=-1}b.YB=function(b,c,e,f,l){if(9!=f.length)throw a.g.X("relation string length has to be 9 characters");for(var d=0;9>d;d++){var h=f.charAt(d);if("*"!=h&&"T"!=h&&"F"!=h&&"0"!=h&&"1"!=h&&"2"!=h)throw a.g.X("relation string");}d=this.FT(f,b.tb(),c.tb());if(0!=d)return a.Fd.ZB(b,
c,e,d,l);d=new a.h;b.s(d);h=new a.h;c.s(h);var g=new a.h;g.I(d);g.Nb(h);e=a.na.be(e,g,!1);b=this.bG(b,e);c=this.bG(c,e);if(b.u()||c.u())return this.sX(b,c,f);d=c.G();h=!1;switch(b.G()){case 1736:switch(d){case 1736:h=this.gu(b,c,e,f,l);break;case 1607:h=this.On(b,c,e,f,l);break;case 33:h=this.fu(b,c,e,f,l);break;case 550:h=this.eu(b,c,e,f,l)}break;case 1607:switch(d){case 1736:h=this.On(c,b,e,this.Pq(f),l);break;case 1607:h=this.MB(b,c,e,f,l);break;case 33:h=this.iu(b,c,e,f,l);break;case 550:h=this.hu(b,
c,e,f,l)}break;case 33:switch(d){case 1736:h=this.fu(c,b,e,this.Pq(f),l);break;case 1607:h=this.iu(c,b,e,this.Pq(f),l);break;case 33:h=this.GW(b,c,e,f);break;case 550:h=this.au(c,b,e,this.Pq(f),l)}break;case 550:switch(d){case 1736:h=this.eu(c,b,e,this.Pq(f),l);break;case 1607:h=this.hu(c,b,e,this.Pq(f),l);break;case 550:h=this.DB(b,c,e,f,l);break;case 33:h=this.au(b,c,e,f,l)}break;default:h=!1}return h};b.gu=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.oK();var g=new a.h,k=new a.h;d.s(g);c.s(k);
f=!1;a.Fd.Ek(g,k,e)&&(h.mv(d,c),f=!0);f||(g=a.Fd.vc(d,c,!1),4==g?(h.mv(d,c),f=!0):1==g?(h.Sy(c),f=!0):2==g&&(h.lF(d),f=!0));f||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.tq(d,c),h.i.qh());return b.zg(h.H,h.dd)};b.Ex=function(d,c,e,f){var h=new b;h.xj();h.Bj("T*****F**");h.oK();var l=new a.h,g=new a.h;d.s(l);c.s(g);var k=!1;a.Fd.Ek(l,g,e)&&(h.mv(d,c),k=!0);k||(l=a.Fd.vc(d,c,!1),4==l?(h.mv(d,c),k=!0):1==l?(h.Sy(c),k=!0):2==l&&(h.lF(d),k=!0));if(k)return l=this.zg(h.H,h.dd);k=new a.fd;d=k.Jb(d);l=
k.Jb(c);a.sk.V(k,e,f,!1);e=k.Se(l).Gg();k.zq(0,!0,!0);a.lo.V(k,d,-1,!1,f);if(0==k.D(d))return!1;a.lo.V(k,l,-1,!1,f);h.Yr(k,f);c=0==k.D(l);if(!c&&(h.tq(d,l),h.i.qh(),l=this.zg(h.H,h.dd),!l))return l;d=k.Se(d);k=new a.fd;d=k.Jb(d);l=k.Jb(e);h.Yr(k,f);h.Ie=0;h.xj();h.Bj(c?"T*****F**":"******F**");h.hC();h.tq(d,l);h.i.qh();return l=this.zg(h.H,h.dd)};b.On=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.hC();var g=new a.h,k=new a.h;d.s(g);c.s(k);f=!1;a.Fd.Ek(g,k,e)&&(h.nv(d,c),f=!0);f||(g=a.Fd.vc(d,c,
!1),4==g?(h.nv(d,c),f=!0):1==g&&(h.mF(c),f=!0));f||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.Fh=h.i.wq(),b.pv(c,h.i,h.Fh),h.tq(d,c),h.i.xq(h.Fh),h.i.qh());return b.zg(h.H,h.dd)};b.LB=function(d,c,e,f){var h=new b;h.xj();h.Bj("T*****F**");h.hC();var l=new a.h,g=new a.h;d.s(l);c.s(g);var k=!1;a.Fd.Ek(l,g,e)&&(h.nv(d,c),k=!0);k||(l=a.Fd.vc(d,c,!1),4==l?(h.nv(d,c),k=!0):1==l&&(h.mF(c),k=!0));if(k)return e=this.zg(h.H,h.dd);k=new a.fd;d=k.Jb(d);c=k.Jb(c);h.Fp(k,e,f);if(0==k.D(d))return!1;h.tq(d,c);
h.i.qh();return e=this.zg(h.H,h.dd)};b.eu=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.pK();var g=new a.h,k=new a.h;d.s(g);c.s(k);f=!1;a.Fd.Ek(g,k,e)&&(h.ov(d),f=!0);f||(g=a.Fd.vc(d,c,!1),4==g?(h.ov(d),f=!0):1==g&&(h.BP(),f=!0));f||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.lz(d,c),h.i.qh());return b.zg(h.H,h.dd)};b.MB=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.ZX();f=new a.h;var g=new a.h;d.s(f);c.s(g);var k=!1;a.Fd.Ek(f,g,e)&&(h.dI(d,c),k=!0);k||4!=a.Fd.vc(d,c,!1)||(h.dI(d,c),k=!0);
k||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.xi=h.i.wq(),h.Fh=h.i.wq(),b.pv(d,h.i,h.xi),b.pv(c,h.i,h.Fh),h.tq(d,c),h.i.xq(h.xi),h.i.xq(h.Fh),h.i.qh());return b.zg(h.H,h.dd)};b.hu=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.DK();f=new a.h;var g=new a.h;d.s(f);c.s(g);var k=!1;a.Fd.Ek(f,g,e)&&(h.GA(d),k=!0);k||4!=a.Fd.vc(d,c,!1)||(h.GA(d),k=!0);k||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.xi=h.i.wq(),b.pv(d,h.i,h.xi),h.lz(d,c),h.i.xq(h.xi),h.i.qh());return b.zg(h.H,h.dd)};b.DB=function(d,
c,e,f,l){var h=new b;h.xj();h.Bj(f);h.IK();f=new a.h;var g=new a.h;d.s(f);c.s(g);var k=!1;a.Fd.Ek(f,g,e)&&(h.GJ(),k=!0);k||(f=new a.fd,d=f.Jb(d),c=f.Jb(c),h.Fp(f,e,l),h.lz(d,c),h.i.qh());return b.zg(h.H,h.dd)};b.fu=function(d,c,e,f){var h=new b;h.xj();h.Bj(f);h.pK();var l=new a.h;d.s(l);c=c.w();var g=!1;a.Fd.Dx(c,l,e)&&(h.ov(d),g=!0);g||(e=a.gd.ge(d,c,e),1==e?(h.H[0]=0,h.H[2]=2,h.H[3]=-1,h.H[5]=1,h.H[6]=-1):2==e?(h.H[6]=-1,0!=d.hf()?(h.H[0]=-1,h.H[3]=0,h.H[2]=2,h.H[5]=1):(h.H[0]=0,h.H[3]=-1,h.H[5]=
-1,e=new a.h,d.s(e),h.H[2]=0==e.fa()&&0==e.N()?-1:1)):h.ov(d));return this.zg(h.H,f)};b.iu=function(d,c,e,f,l){var h=new b;h.xj();h.Bj(f);h.DK();var g=new a.h;d.s(g);f=c.w();var k=!1;a.Fd.Dx(f,g,e)&&(h.GA(d),k=!0);if(!k){var g=null,m=k=!1;if(h.ga[0]||h.ga[6])a.Fd.HA(d,f,e)?(h.ga[0]&&(g=a.Pi.Rm(d,l),m=!a.Fd.$t(g,f,e),k=!0,h.H[0]=m?-1:0),h.H[6]=-1):(h.H[0]=-1,h.H[6]=0);h.ga[3]&&(null!=g&&g.u()?h.H[3]=-1:(k||(null==g&&(g=a.Pi.Rm(d,l)),m=!a.Fd.$t(g,f,e),k=!0),h.H[3]=m?0:-1));h.ga[5]&&(null!=g&&g.u()?
h.H[5]=-1:k&&!m?h.H[5]=0:(null==g&&(g=a.Pi.Rm(d,l)),l=a.Fd.zx(g,c,e),h.H[5]=l?-1:0));h.ga[2]&&(0!=d.Rb()?h.H[2]=1:(l=new a.Ed(d.description),l.Id(d,0,d.D()),d=a.Fd.zx(l,c,e),h.H[2]=d?-1:0))}return this.zg(h.H,h.dd)};b.au=function(d,c,e,f){var h=new b;h.xj();h.Bj(f);h.IK();var l=new a.h;d.s(l);c=c.w();var g=!1;a.Fd.Dx(c,l,e)&&(h.GJ(),g=!0);if(!g){l=!1;g=!0;e*=e;for(var k=0;k<d.D();k++){var m=d.Ba(k);a.b.sc(m,c)<=e?l=!0:g=!1;if(l&&!g)break}l?(h.H[0]=0,h.H[2]=g?-1:0,h.H[6]=-1):(h.H[0]=-1,h.H[2]=0,h.H[6]=
0)}return b.zg(h.H,f)};b.GW=function(d,c,e,f){d=d.w();c=c.w();for(var h=[],l=0;9>l;l++)h[l]=-1;a.b.sc(d,c)<=e*e?h[0]=0:(h[2]=0,h[6]=0);h[8]=2;return b.zg(h,f)};b.zg=function(a,b){for(var d=0;9>d;d++)switch(b.charAt(d)){case "T":if(-1==a[d])return!1;break;case "F":if(-1!=a[d])return!1;break;case "0":if(0!=a[d])return!1;break;case "1":if(1!=a[d])return!1;break;case "2":if(2!=a[d])return!1}return!0};b.sX=function(b,c,e){var d=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(b.u()&&c.u()){for(var h=0;9>h;h++)d[h]=-1;
return this.zg(d,e)}h=!1;b.u()&&(b=c,h=!0);d[0]=-1;d[1]=-1;d[3]=-1;d[4]=-1;d[6]=-1;d[7]=-1;d[8]=2;c=b.G();a.T.Ic(c)?1736==c?0!=b.hf()?(d[2]=2,d[5]=1):(d[5]=-1,c=new a.h,b.s(c),d[2]=0==c.fa()&&0==c.N()?0:1):(c=0!=b.Rb(),d[2]=c?1:0,d[5]=a.Pi.Rq(b)?0:-1):(d[2]=0,d[5]=-1);h&&this.kL(d);return this.zg(d,e)};b.FT=function(a,c,e){return b.kQ(a)?3:b.sO(a)?4:b.gU(a,c,e)?8:b.jO(a,c,e)?16:b.ON(a)?1:b.ZM(a,c,e)?32:0};b.kQ=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"F"==a.charAt(2)&&"*"==a.charAt(3)&&
"*"==a.charAt(4)&&"F"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.sO=function(a){return"F"==a.charAt(0)&&"F"==a.charAt(1)&&"*"==a.charAt(2)&&"F"==a.charAt(3)&&"F"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.gU=function(a,b,c){if(0==b&&0==c)return!1;if(2!=b||2!=c)if("F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"T"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)||
1==b&&1==c&&"F"==a.charAt(0)&&"T"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0;return 0!=c&&"F"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"T"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.jO=function(a,b,c){return b>c?"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&
"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1:1==b&&1==c&&"0"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"*"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.ON=function(a){return"T"==a.charAt(0)&&"*"==a.charAt(1)&&"*"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"F"==a.charAt(6)&&"F"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1};b.ZM=function(a,b,c){if(b==c){if(1!=b)return"T"==a.charAt(0)&&"*"==a.charAt(1)&&
"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8)?!0:!1;if("1"==a.charAt(0)&&"*"==a.charAt(1)&&"T"==a.charAt(2)&&"*"==a.charAt(3)&&"*"==a.charAt(4)&&"*"==a.charAt(5)&&"T"==a.charAt(6)&&"*"==a.charAt(7)&&"*"==a.charAt(8))return!0}return!1};b.pv=function(a,b,c){a=b.Ia(a);for(var d=b.rf;-1!=d;d=b.og(d))if(0!=(b.Md(d)&a)){var h=b.kf(d);if(-1==h)b.co(d,c,0);else{var e=h,f=0;do 0!=(b.Ah(e)&a)&&f++,e=b.qc(b.Aa(e));while(e!=h);b.co(d,
c,f)}}};b.Pq=function(a){var b;b=""+a.charAt(0);b+=a.charAt(3);b+=a.charAt(6);b+=a.charAt(1);b+=a.charAt(4);b+=a.charAt(7);b+=a.charAt(2);b+=a.charAt(5);return b+=a.charAt(8)};b.prototype.xj=function(){for(var a=0;9>a;a++)this.H[a]=-2,this.eb[a]=-2};b.kL=function(a){var b=a[1],d=a[2],c=a[5];a[1]=a[3];a[2]=a[6];a[5]=a[7];a[3]=b;a[6]=d;a[7]=c};b.prototype.Bj=function(a){this.dd=a;for(a=0;9>a;a++)"*"!=this.dd.charAt(a)?(this.ga[a]=!0,this.Ie++):this.ga[a]=!1};b.prototype.LK=function(){for(var a=0;9>
a;a++)this.ga[a]&&-2==this.H[a]&&(this.H[a]=-1,this.ga[a]=!1)};b.prototype.uc=function(a){if(-2==this.H[a])return!1;if(-1==this.H[a])return this.ga[a]=!1,this.Ie--,!0;if("T"!=this.dd.charAt(a)&&"F"!=this.dd.charAt(a)){if(this.H[a]<this.eb[a])return!1;this.ga[a]=!1;this.Ie--;return!0}this.ga[a]=!1;this.Ie--;return!0};b.prototype.oK=function(){this.jx=0;this.eb[0]=2;this.eb[1]=1;this.eb[2]=2;this.eb[3]=1;this.eb[4]=1;this.eb[5]=1;this.eb[6]=2;this.eb[7]=1;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=
!1,this.Ie--)};b.prototype.hC=function(){this.jx=1;this.Fn=3;this.eb[0]=1;this.eb[1]=0;this.eb[2]=2;this.eb[3]=1;this.eb[4]=0;this.eb[5]=1;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.ZX=function(){this.jx=2;this.Fn=4;this.eb[0]=1;this.eb[1]=0;this.eb[2]=1;this.eb[3]=0;this.eb[4]=0;this.eb[5]=0;this.eb[6]=1;this.eb[7]=0;this.eb[8]=2;this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.pK=function(){this.Fn=3;this.eb[0]=0;this.eb[1]=
-1;this.eb[2]=2;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.DK=function(){this.Fn=4;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=1;this.eb[3]=0;this.eb[4]=-1;this.eb[5]=0;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);
this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.IK=function(){this.Fn=5;this.eb[0]=0;this.eb[1]=-1;this.eb[2]=0;this.eb[3]=-1;this.eb[4]=-1;this.eb[5]=-1;this.eb[6]=0;this.eb[7]=-1;this.eb[8]=2;this.ga[1]&&(this.H[1]=-1,this.ga[1]=!1,this.Ie--);this.ga[3]&&(this.H[3]=-1,this.ga[3]=!1,this.Ie--);this.ga[4]&&(this.H[4]=-1,this.ga[4]=!1,this.Ie--);this.ga[5]&&(this.H[5]=-1,this.ga[5]=
!1,this.Ie--);this.ga[7]&&(this.H[7]=-1,this.ga[7]=!1,this.Ie--);this.ga[8]&&(this.H[8]=2,this.ga[8]=!1,this.Ie--)};b.prototype.zP=function(a,b,c){var d=!0;this.ga[0]&&(this.xU(a,b,c),d=d&&this.uc(0));this.ga[1]&&(this.FH(a,b,1),d=d&&this.uc(1));this.ga[2]&&(this.GH(a,b,c,2),d=d&&this.uc(2));this.ga[3]&&(this.FH(a,c,3),d=d&&this.uc(3));this.ga[4]&&(this.FP(a,b,c),d=d&&this.uc(4));this.ga[5]&&(this.rF(a,c,5),d=d&&this.uc(5));this.ga[6]&&(this.GH(a,c,b,6),d=d&&this.uc(6));this.ga[7]&&(this.rF(a,b,7),
d=d&&this.uc(7));return d};b.prototype.mv=function(a,b){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;this.Ds(a,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5));this.Ds(b,this.ga[6]?6:-1,this.dd.charAt(6),this.ga[7]?7:-1,this.dd.charAt(7))};b.prototype.Ds=function(b,c,e,f,l){if(-1!=c||-1!=f)("T"!=e&&"F"!=e&&-1!=c||"T"!=l&&"F"!=l&&-1!=f?0!=b.hf():1)?(-1!=c&&(this.H[c]=2),-1!=f&&(this.H[f]=1)):(-1!=f&&(this.H[f]=-1),-1!=c&&(e=new a.h,b.s(e),this.H[c]=0==e.fa()&&0==e.N()?0:
1))};b.prototype.Sy=function(a){this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1;this.Ds(a,this.ga[0]?0:-1,this.dd.charAt(0),this.ga[1]?1:-1,this.dd.charAt(1))};b.prototype.lF=function(a){this.Sy(a);b.kL(this.H)};b.prototype.nv=function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[6]){var d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0;this.H[6]=d?1:0}this.ga[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1);this.Ds(b,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?
5:-1,this.dd.charAt(5))};b.prototype.mF=function(b){if(this.ga[0]){var d=this.dd.charAt(0),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[0]=d?1:0}this.ga[1]&&(b=a.Pi.Rq(b),this.H[1]=b?0:-1);this.H[2]=2;this.H[3]=-1;this.H[4]=-1;this.H[5]=1;this.H[6]=-1;this.H[7]=-1};b.prototype.ov=function(a){this.H[0]=-1;this.H[3]=-1;this.H[6]=0;this.Ds(a,this.ga[2]?2:-1,this.dd.charAt(2),this.ga[5]?5:-1,this.dd.charAt(5))};b.prototype.BP=function(){this.H[0]=0;this.H[2]=2;this.H[3]=-1;this.H[5]=1;this.H[6]=-1};b.prototype.dI=
function(b,c){this.H[0]=-1;this.H[1]=-1;this.H[3]=-1;this.H[4]=-1;if(this.ga[2]){var d=this.dd.charAt(2),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[2]=d?1:0}this.ga[5]&&(d=a.Pi.Rq(b),this.H[5]=d?0:-1);this.ga[6]&&(d=this.dd.charAt(6),d="T"!=d&&"F"!=d?0!=c.Rb():!0,this.H[6]=d?1:0);this.ga[7]&&(d=a.Pi.Rq(c),this.H[7]=d?0:-1)};b.prototype.GA=function(b){this.H[0]=-1;this.H[3]=-1;if(this.ga[2]){var d=this.dd.charAt(2),d="T"!=d&&"F"!=d?0!=b.Rb():!0;this.H[2]=d?1:0}this.ga[5]&&(b=a.Pi.Rq(b),this.H[5]=b?0:-1);
this.H[6]=0};b.prototype.GJ=function(){this.H[0]=-1;this.H[2]=0;this.H[6]=0};b.prototype.AP=function(a,b,c){var d=!0;this.ga[0]&&(this.yU(a,b),d=d&&this.uc(0));this.ga[1]&&(this.uU(a,b,c,this.Fh),d=d&&this.uc(1));this.ga[2]&&(this.vU(a,b),d=d&&this.uc(2));this.ga[3]&&(this.JP(a,b,c,this.Fh),d=d&&this.uc(3));this.ga[4]&&(this.GP(a,b,c,this.Fh),d=d&&this.uc(4));this.ga[5]&&(this.HP(a,b,c),d=d&&this.uc(5));this.ga[6]&&(this.dS(a,b),d=d&&this.uc(6));this.ga[7]&&(this.cS(a,b,c,this.Fh),d=d&&this.uc(7));
return d};b.prototype.nV=function(a,b,c){var d=!0;this.ga[0]&&(this.BU(a,b,c,this.xi,this.Fh),d=d&&this.uc(0));this.ga[1]&&(this.HH(a,b,c,this.xi,this.Fh,1),d=d&&this.uc(1));this.ga[2]&&(this.IH(a,b,c,2),d=d&&this.uc(2));this.ga[3]&&(this.HH(a,c,b,this.Fh,this.xi,3),d=d&&this.uc(3));this.ga[4]&&(this.LP(a,b,c,this.xi,this.Fh),d=d&&this.uc(4));this.ga[5]&&(this.sF(a,c,this.xi,5),d=d&&this.uc(5));this.ga[6]&&(this.IH(a,c,b,6),d=d&&this.uc(6));this.ga[7]&&(this.sF(a,b,this.Fh,7),d=d&&this.uc(7));return d};
b.prototype.nF=function(a,b,c){var d=!0;this.ga[0]&&(this.zU(a,b),d=d&&this.uc(0));this.ga[2]&&(this.wU(a,b),d=d&&this.uc(2));this.ga[3]&&(this.KP(a,b,c),d=d&&this.uc(3));this.ga[5]&&(this.IP(a,b),d=d&&this.uc(5));this.ga[6]&&(this.eS(a,b),d=d&&this.uc(6));return d};b.prototype.eI=function(a,b,c){var d=!0;this.ga[0]&&(this.CU(a,b,c,this.xi),d=d&&this.uc(0));this.ga[2]&&(this.AU(a,c),d=d&&this.uc(2));this.ga[3]&&(this.NP(a,b,c,this.xi),d=d&&this.uc(3));this.ga[5]&&(this.MP(a,b,c,this.xi),d=d&&this.uc(5));
this.ga[6]&&(this.fS(a,b,c),d=d&&this.uc(6));return d};b.prototype.FW=function(a,b,c){var d=!0;this.ga[0]&&(this.DU(a,b,c),d=d&&this.uc(0));this.ga[2]&&(this.JH(a,b,c,2),d=d&&this.uc(2));this.ga[6]&&(this.JH(a,c,b,6),d=d&&this.uc(6));return d};b.prototype.xU=function(a,b,c){2!=this.H[0]&&(a=this.i.Ff(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=2))};b.prototype.FH=function(a,b,c){if(1!=this.H[c]){var d=this.i.Ff(this.i.Aa(a));0!=(this.i.Ff(a)&b)&&0!=(d&b)&&(this.H[c]=1)}};b.prototype.GH=function(a,b,c,e){2!=
this.H[e]&&(a=this.i.Ff(a),0!=(a&b)&&0==(a&c)&&(this.H[e]=2))};b.prototype.FP=function(a,b,c){if(1!=this.H[4]){var d=this.i.Ah(a);0!=(d&b)&&0!=(d&c)?this.H[4]=1:0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Md(this.i.Xf(a)),0!=(a&b)&&0!=(a&c)&&(this.H[4]=0))}};b.prototype.rF=function(a,b,c){if(1!=this.H[c]){var d=this.i.Ff(this.i.Aa(a));0==(this.i.Ff(a)&b)&&0==(d&b)&&(this.H[c]=1)}};b.prototype.yU=function(a,b){if(1!=this.H[0]){var d=this.i.Ff(this.i.Aa(a));0!=(this.i.Ff(a)&
b)&&0!=(d&b)&&(this.H[0]=1)}};b.prototype.uU=function(a,b,c,e){if(0!=this.H[1]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var d=this.i.Xf(a),h=this.i.Md(d);0==(h&b)&&0!=(this.i.Ff(a)&b)&&(a=this.i.Hg(d,e),0!=(h&c)&&0!=a%2&&(this.H[1]=0))}};b.prototype.vU=function(a,b){2!=this.H[2]&&0!=(this.i.Ah(a)&b)&&(this.H[2]=2)};b.prototype.JP=function(a,b,c,e){if(1!=this.H[3]){var d=this.i.Ah(a);0!=(d&b)&&0!=(d&c)?this.H[3]=1:0!=this.H[3]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(d=this.i.Xf(a),
a=this.i.Md(d),0!=(a&b)&&(b=this.i.Hg(d,e),0!=(a&c)&&0==b%2&&(this.H[3]=0)))}};b.prototype.GP=function(a,b,c,e){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var d=this.i.Xf(a);a=this.i.Md(d);0!=(a&b)&&(b=this.i.Hg(d,e),0!=(a&c)&&0!=b%2&&(this.H[4]=0))}};b.prototype.HP=function(a,b,c){1!=this.H[5]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[5]=1))};b.prototype.dS=function(a,b){if(1!=this.H[6]){var d=this.i.Ff(this.i.Aa(a));0==(this.i.Ff(a)&b)&&0==(d&b)&&(this.H[6]=1)}};b.prototype.cS=
function(a,b,c,e){if(0!=this.H[7]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){var d=this.i.Xf(a),h=this.i.Md(d);0==(h&b)&&0==(this.i.Ff(a)&b)&&(a=this.i.Hg(d,e),0!=(h&c)&&0!=a%2&&(this.H[7]=0))}};b.prototype.BU=function(a,b,c,e,f){if(1!=this.H[0]){var d=this.i.Ah(a);0!=(d&b)&&0!=(d&c)?this.H[0]=1:0!=this.H[0]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Xf(a),d=this.i.Md(a),0!=(d&b)&&0!=(d&c)&&(b=this.i.Hg(a,e),f=this.i.Hg(a,f),0==b%2&&0==f%2&&(this.H[0]=0)))}};b.prototype.HH=function(a,
b,c,e,f,l){if(0!=this.H[l]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){a=this.i.Xf(a);var d=this.i.Md(a);0!=(d&b)&&0!=(d&c)&&(b=this.i.Hg(a,e),f=this.i.Hg(a,f),0==b%2&&0!=f%2&&(this.H[l]=0))}};b.prototype.IH=function(a,b,c,e){1!=this.H[e]&&(a=this.i.Ah(a),0!=(a&b)&&0==(a&c)&&(this.H[e]=1))};b.prototype.LP=function(a,b,c,e,f){if(0!=this.H[4]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)){a=this.i.Xf(a);var d=this.i.Md(a);0!=(d&b)&&0!=(d&c)&&(b=this.i.Hg(a,e),f=this.i.Hg(a,f),0!=b%2&&0!=f%2&&(this.H[4]=
0))}};b.prototype.sF=function(a,b,c,e){0!=this.H[e]&&1!=this.i.Kb(this.i.Te(this.i.Aa(a)),this.vj)&&(a=this.i.Xf(a),0==(this.i.Md(a)&b)&&0!=this.i.Hg(a,c)%2&&(this.H[e]=0))};b.prototype.zU=function(a,b){0!=this.H[0]&&0==(this.i.Md(a)&b)&&0!=(this.i.Ik(this.i.Kz(a))&b)&&(this.H[0]=0)};b.prototype.wU=function(a,b){2!=this.H[2]&&0!=(this.i.Md(a)&b)&&(this.H[2]=2)};b.prototype.KP=function(a,b,c){0!=this.H[3]&&(a=this.i.Md(a),0!=(a&b)&&0!=(a&c)&&(this.H[3]=0))};b.prototype.IP=function(a,b){1!=this.H[5]&&
0!=(this.i.Md(a)&b)&&(this.H[5]=1)};b.prototype.eS=function(a,b){0!=this.H[6]&&0==(this.i.Md(a)&b)&&0==(this.i.Ik(this.i.Kz(a))&b)&&(this.H[6]=0)};b.prototype.CU=function(a,b,c,e){if(0!=this.H[0]){var d=this.i.Md(a);0!=(d&b)&&0!=(d&c)&&0==this.i.Hg(a,e)%2&&(this.H[0]=0)}};b.prototype.AU=function(a,b){1!=this.H[2]&&(-1!=this.i.kf(a)?this.H[2]=1:0!=this.H[2]&&0==(this.i.Md(a)&b)&&(this.H[2]=0))};b.prototype.NP=function(a,b,c,e){if(0!=this.H[3]){var d=this.i.Md(a);0!=(d&b)&&0!=(d&c)&&0!=this.i.Hg(a,
e)%2&&(this.H[3]=0)}};b.prototype.MP=function(a,b,c,e){if(0!=this.H[5]){var d=this.i.Md(a);0!=(d&b)&&0==(d&c)&&0!=this.i.Hg(a,e)%2&&(this.H[5]=0)}};b.prototype.fS=function(a,b,c){0!=this.H[6]&&(a=this.i.Md(a),0==(a&b)&&0!=(a&c)&&(this.H[6]=0))};b.prototype.DU=function(a,b,c){0!=this.H[0]&&(a=this.i.Md(a),0!=(a&b)&&0!=(a&c)&&(this.H[0]=0))};b.prototype.JH=function(a,b,c,e){0!=this.H[e]&&(a=this.i.Md(a),0!=(a&b)&&0==(a&c)&&(this.H[e]=0))};b.prototype.tq=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);
this.vj=this.i.xh();for(var h=this.i.rf;-1!=h;h=this.i.og(h)){var e=this.i.kf(h);if(-1==e){if(-1!=this.Fn)switch(this.Fn){case 3:d=this.nF(h,b,c);break;case 4:d=this.eI(h,b,c);break;default:throw a.g.X("internal error");}}else{var f=e;do{var l=f;if(1!=this.i.Kb(l,this.vj)){do{switch(this.jx){case 0:d=this.zP(l,b,c);break;case 1:d=this.AP(l,b,c);break;case 2:d=this.nV(l,b,c);break;default:throw a.g.X("internal error");}if(d)break;this.i.Ob(l,this.vj,1);l=this.i.qc(l)}while(l!=f&&!d)}if(d)break;f=this.i.qc(this.i.Aa(l))}while(f!=
e);if(d)break}}d||this.LK();this.i.ni(this.vj)};b.prototype.lz=function(b,c){var d=!1;b=this.i.Ia(b);c=this.i.Ia(c);for(var h=this.i.rf;-1!=h;h=this.i.og(h)){switch(this.Fn){case 3:d=this.nF(h,b,c);break;case 4:d=this.eI(h,b,c);break;case 5:d=this.FW(h,b,c);break;default:throw a.g.za();}if(d)break}d||this.LK()};b.prototype.Yr=function(a,b){this.i.Wr(a,b)};b.prototype.Fp=function(a,b,c){this.VR(a,b,c);this.Yr(a,c)};b.prototype.VR=function(b,c,e){a.sk.V(b,c,e,!1);b.zq(0,!0,!0);for(c=b.sd;-1!=c;c=b.Ue(c))1736==
b.hc(c)&&a.lo.V(b,c,-1,!1,e)};b.bG=function(b,c){var d=b.G();if(a.T.Oc(d))return d=new a.Ua(b.description),d.dc(b,!0),d;if(197==d){d=new a.h;b.s(d);if(d.fa()<=c&&d.N()<=c)return d=new a.Wa(b.description),b.Wf(d),d;if(d.fa()<=c||d.N()<=c)return d=new a.Ua(b.description),c=new a.Wa,b.ig(0,c),d.Rf(c),b.ig(2,c),d.lineTo(c),d;d=new a.Ja(b.description);d.jd(b,!1);return d}return b};return b}();a.Nm=b})(D||(D={}));(function(a){var b=function(){function b(b){this.sn=new a.ia(0);this.Rw=new a.ia(0);this.mu=
new a.b;this.nu=new a.b;this.a=b;this.Dt=-1}b.prototype.ic=function(a){return this.a.ic(this.jA(a))};b.prototype.ow=function(a){var b=this.Rz(a);a=this.SG(a);if(this.a.Ra(b)==a){var d=b,b=a;a=d}this.a.Nc(b,this.mu);this.a.Nc(a,this.nu);return this.mu.y<this.nu.y};b.prototype.jA=function(a){var b=this.Rz(a);a=this.SG(a);return this.a.U(b)==a?b:a};b.prototype.Rz=function(a){return this.sn.get(a)};b.prototype.SG=function(a){return this.Rw.get(a)};b.prototype.CG=function(a){this.sn.set(a,this.Dt);this.Dt=
a};b.prototype.wJ=function(b){if(-1!=this.Dt){var d=this.Dt;this.Dt=this.sn.get(d);this.sn.set(d,b);this.Rw.set(d,this.a.U(b));return d}null==this.sn&&(this.sn=new a.ia(0),this.Rw=new a.ia(0));d=this.sn.size;this.sn.add(b);this.Rw.add(this.a.U(b));return d};b.prototype.cA=function(a){return this.a.ld(this.Rz(a))};return b}();a.LZ=b;var c=function(){function b(b){this.bf=b;this.Fe=new a.Hb;this.An=new a.Hb;this.SI=0;this.op=null;this.eB=-1}b.prototype.compare=function(a,b,d){d=a.ja(d);var c=this.bf.ib,
h;this.eB==b?h=this.SI:(this.op=c.ic(b),null==this.op?(a=c.a,a.pd(c.jA(b),this.Fe),this.op=this.Fe,h=this.Fe.pf(this.bf.Wh,0)):h=this.op.pf(this.bf.Wh,0),this.SI=h,this.eB=b);a=c.ic(d);var e;null==a?(a=c.a,a.pd(c.jA(d),this.An),a=this.An,e=this.An.pf(this.bf.Wh,0)):e=a.pf(this.bf.Wh,0);h==e&&(b=c.ow(b),d=c.ow(d),d=Math.min(b?this.op.oa:this.op.ra,d?a.oa:a.ra),b=.5*(d+this.bf.Wh),b==this.bf.Wh&&(b=d),h=this.op.pf(b,0),e=a.pf(b,0));return h<e?-1:h>e?1:0};b.prototype.reset=function(){this.eB=-1};return b}(),
e=function(){function d(){this.Kn=this.jm=null;this.hb=new a.uk;this.hb.OR();this.we=new c(this);this.hb.Ep(this.we)}d.prototype.yS=function(){var b=!1;this.Vw&&(b=this.zS());if(1==this.a.aa(this.Y)){var d=this.a.Pb(this.Y),b=this.a.gA(d);this.a.oC(d,!0);return 0>b?(b=this.a.cb(d),this.a.fK(b),this.a.sh(d,this.a.Ra(b)),!0):!1}this.hm=this.a.rz();this.kp=this.a.rz();for(d=this.a.Pb(this.Y);-1!=d;d=this.a.Sb(d))this.a.$r(d,this.hm,0),this.a.$r(d,this.kp,-1);d=new a.ia(0);this.Wh=NaN;var c=new a.b;this.Xt=
this.a.aa(this.Y);this.fp=this.a.Vd();this.Mt=this.a.Vd();for(var e=this.jm.xc(this.jm.Ge);-1!=e;e=this.jm.nb(e)){var f=this.jm.getData(e);this.a.Nc(f,c);c.y!=this.Wh&&0!=d.size&&(b=this.ju(d)||b,this.we.reset(),d.clear(!1));d.add(f);this.Wh=c.y;if(0==this.Xt)break}0<this.Xt&&(b=this.ju(d)||b,d.clear(!1));this.a.le(this.fp);this.a.le(this.Mt);for(d=this.a.Pb(this.Y);-1!=d;)if(3==this.a.Tj(d,this.hm)){this.a.oC(d,!0);c=d;for(d=this.a.Tj(d,this.kp);-1!=d;)e=this.a.Tj(d,this.kp),this.a.XV(this.Y,this.a.Sb(c),
d),c=d,d=e;d=this.a.Sb(c)}else this.a.oC(d,!1),d=this.a.Sb(d);this.a.bC(this.hm);this.a.bC(this.kp);return b};d.prototype.ju=function(a){return this.SW(a)};d.prototype.SW=function(d){var c=!1;null==this.ib&&(this.ib=new b(this.a));null==this.Kn?(this.Kn=new a.ia(0),this.Kn.yb(16)):this.Kn.clear(!1);this.RW(d);for(var h=0,e=d.size;h<e;h++){var f=d.get(h);-1!=f&&this.CH(f,-1)}for(h=0;h<this.Kn.size&&0<this.Xt;h++)if(d=this.Kn.get(h),f=this.ib.cA(this.hb.ja(d)),e=-1,0==this.a.Tj(f,this.hm)){for(var f=
this.hb.Ve(d),l=d,g;-1!=f;){var k=this.hb.ja(f),m=this.ib.cA(k),q=this.a.Tj(m,this.hm);if(0!=q){e=m;break}l=f;f=this.hb.Ve(f)}-1==f?(g=!0,f=l):(k=this.hb.ja(f),g=this.ib.ow(k),f=this.hb.nb(f),g=!g);do{k=this.hb.ja(f);m=this.ib.cA(k);q=this.a.Tj(m,this.hm);if(0==q&&(g!=this.ib.ow(k)&&(c=this.a.cb(m),this.a.fK(c),this.a.sh(m,this.a.Ra(c)),c=!0),this.a.$r(m,this.hm,g?3:2),g||(l=this.a.Tj(e,this.kp),this.a.$r(e,this.kp,m),this.a.$r(m,this.kp,l)),this.Xt--,0==this.Xt))return c;e=m;l=f;f=this.hb.nb(f);
g=!g}while(l!=d)}return c};d.prototype.RW=function(a){for(var b=0,d=a.size;b<d;b++){var c=a.get(b),h=this.a.Sa(c,this.fp),e=this.a.Sa(c,this.Mt);if(-1!=h){var f=this.hb.ja(h);this.ib.CG(f);this.a.Va(c,this.fp,-1)}-1!=e&&(f=this.hb.ja(e),this.ib.CG(f),this.a.Va(c,this.Mt,-1));f=-1;-1!=h&&-1!=e?(this.hb.Kd(h,-1),this.hb.Kd(e,-1),a.set(b,-1)):f=-1!=h?h:e;-1!=f&&(this.CH(c,f)||this.hb.Kd(f,-1),a.set(b,-1))}};d.prototype.CH=function(b,d){var c=new a.b,h=new a.b;this.a.Nc(b,c);var e=this.a.U(b);this.a.Nc(e,
h);var f=!1;if(c.y<h.y){var f=!0,l=this.ib.wJ(b),g;-1==d?g=this.hb.addElement(l,-1):(g=d,this.hb.kk(g,l));l=this.a.Sa(e,this.fp);-1==l?this.a.Va(e,this.fp,g):this.a.Va(e,this.Mt,g);e=this.a.ld(b);0==this.a.Tj(e,this.hm)&&this.Kn.add(g)}e=this.a.Ra(b);this.a.Nc(e,h);c.y<h.y&&(f=!0,l=this.ib.wJ(e),-1==d?g=this.hb.addElement(l,-1):(g=d,this.hb.kk(g,l)),l=this.a.Sa(e,this.fp),-1==l?this.a.Va(e,this.fp,g):this.a.Va(e,this.Mt,g),e=this.a.ld(b),0==this.a.Tj(e,this.hm)&&this.Kn.add(g));return f};d.V=function(a,
b,c,e){var h=new d;h.a=a;h.Y=b;h.jm=c;h.Vw=e;return h.yS()};d.prototype.zS=function(){var b=new a.ia(0),d=new a.ia(0),c=-1,e=-1,f=new a.b;f.$c();for(var l=-1,g=-1,k=-1,m=new a.b,q=this.jm.xc(this.jm.Ge);-1!=q;q=this.jm.nb(q)){var n=this.jm.getData(q);this.a.Nc(n,m);var w=this.a.ld(n);f.ub(m)&&g==w?(-1==e&&(c=this.a.rz(),e=this.a.Vd()),-1==k&&(k=d.size,this.a.Va(l,e,k),d.add(1),-1==this.a.Tj(w,c)&&(this.a.$r(w,c,l),b.add(w))),this.a.Va(n,e,k),d.CK(d.Fc()+1)):(k=-1,f.L(m));l=n;g=w}if(0==b.size)return!1;
f=new a.ia(0);l=new a.ia(0);g=0;for(k=b.size;g<k;g++){var w=b.get(g),x=this.a.Tj(w,c),n=this.a.Sa(x,e);f.clear(!1);l.clear(!1);f.add(x);l.add(n);for(n=this.a.U(x);n!=x;n=this.a.U(n)){var p=n,m=this.a.Sa(p,e);if(-1!=m)if(0==l.size)l.add(m),f.add(p);else if(l.Fc()==m){var q=f.Fc(),u=this.a.U(q),x=this.a.U(p);this.a.Kc(q,x);this.a.Lc(x,q);this.a.Kc(p,u);this.a.Lc(u,p);p=[!1];u=this.a.BH(this.Y,u,this.a.cb(w),p);this.a.Va(n,e,-1);p[0]&&this.a.jg(w,x);n=this.a.La(w);x=this.a.La(u);n-=x;this.a.nk(w,n);
d.set(m,d.get(m)-1);1==d.get(m)&&(d.set(m,0),l.Pf(),f.Pf());n=x=q}else f.add(n),l.add(m)}}this.a.bC(c);this.a.le(e);return!0};return d}();a.SN=e})(D||(D={}));(function(a){var b=function(){function b(){}b.prototype.Cg=function(){this.uB=this.wb=null};b.prototype.get=function(){return this.uB};b.prototype.set=function(b){this.uB=b;if(null!=b)throw 322==b.G()&&(this.wb=b),a.g.za();};b.prototype.create=function(b){if(322==b)this.Js();else throw a.g.X("Not Implemented");};b.prototype.Js=function(){null==
this.wb&&(this.wb=new a.Hb);this.uB=this.wb};return b}();a.Cg=b})(D||(D={}));(function(a){a=a.XN||(a.XN={});a[a.enumLineSeg=1]="enumLineSeg";a[a.enumBezierSeg=2]="enumBezierSeg";a[a.enumArcSeg=4]="enumArcSeg";a[a.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask";a[a.enumSegmentMask=7]="enumSegmentMask";a[a.enumDensified=8]="enumDensified"})(D||(D={}));(function(a){var b=function(){return function(a){this.zj=a;this.SC=this.TC=1;this.TB=this.SB=this.UB=0}}(),c=function(){function c(){this.vr=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.dl=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.cg=new a.Wa;this.ta=this.sx=0;this.$o=[];this.Ut=[];this.mx=[];this.yr=[];this.rB=[]}c.prototype.WB=function(a){if(null!=a){for(var b=0,d=a.length;b<d;b++)this.qX(a[b]);a.length=0}};c.prototype.qX=function(a){a.zj=null;this.yr.push(a)};c.prototype.Ax=function(a){if(0===this.yr.length)var d=new b(a);else d=this.yr[this.yr.length-1],d.zj=a,--this.yr.length;return d};c.prototype.LT=function(a,b){return 0==a?this.Ut[b]:this.mx[b]};
c.prototype.GB=function(){this.sx>=this.rB.length&&this.rB.push(new a.Cg);var b=this.rB[this.sx];this.sx++;return b};c.prototype.clear=function(){this.WB(this.$o);this.WB(this.Ut);this.WB(this.mx);this.sx=0};c.prototype.Ap=function(a){this.$o.push(this.Ax(a))};c.prototype.Rl=function(a){return 0==a?this.Ut.length:this.mx.length};c.prototype.Mq=function(a,b){return this.LT(a,b).zj};c.prototype.Ma=function(b,c){if(2!=this.$o.length)throw a.g.za();this.ta=b;var d=a.Ub.Yx(.01*b),e=!1,h=this.$o[0],f=this.$o[1];
if(c||0!=(h.zj.ys(f.zj,b,!0)&5)){if(322==h.zj.G()&&(c=h.zj,322==f.zj.G())){var l=f.zj,g=a.Hb.Gy(c,l,null,this.vr,this.dl,b);if(0==g)throw a.Hb.Gy(c,l,null,this.vr,this.dl,b),a.g.za();b=Array(9);a.J.Nv(b,null);for(var k=0;k<g;k++){var m=this.vr[k],q=this.dl[k],n=h.TB,w=1;0==m?(n=h.UB,w=h.TC):1==m&&(n=h.SB,w=h.SC);var x=f.TB,p=1;0==q?(x=f.UB,p=f.TC):1==q&&(x=f.SB,p=f.SC);var u=new a.b;n==x?(n=new a.b,c.gc(m,n),m=new a.b,l.gc(q,m),q=w+p,p/=q,a.Ub.cI(n,m,p,u),a.b.sc(u,n)+a.b.sc(u,m)>d&&(e=!0)):n>x?(c.gc(m,
u),m=new a.b,l.gc(q,m),a.b.sc(u,m)>d&&(e=!0)):(l.gc(q,u),n=new a.b,c.gc(m,n),a.b.sc(u,n)>d&&(e=!0));b[k]=u}h=0;f=-1;for(k=0;k<=g;k++)p=k<g?this.vr[k]:1,p!=h&&(d=this.GB(),c.yh(h,p,d),-1!=f&&d.get().Mc(b[f]),k!=g&&d.get().Zc(b[k]),h=p,this.Ut.push(this.Ax(d.get()))),f=k;c=[0,0,0,0,0,0,0,0,0];for(k=0;k<g;k++)c[k]=k;1<g&&this.dl[0]>this.dl[1]&&(p=this.dl[0],this.dl[0]=this.dl[1],this.dl[1]=p,k=c[0],c[0]=c[1],c[1]=k);h=0;f=-1;for(k=0;k<=g;k++)p=k<g?this.dl[k]:1,p!=h&&(d=this.GB(),l.yh(h,p,d),-1!=f&&(h=
c[f],d.get().Mc(b[h])),k!=g&&(h=c[k],d.get().Zc(b[h])),h=p,this.mx.push(this.Ax(d.get()))),f=k;return e}throw a.g.za();}return!1};c.prototype.sA=function(b,c,e){c.copyTo(this.cg);if(1!=this.$o.length)throw a.g.za();this.ta=b;var d=this.$o[0];if(e||d.zj.av(c.w(),b,!0))if(322==d.zj.G()){b=d.zj;var h=b.pe(c.w(),!1);this.vr[0]=h;var f=d.TB;e=1;0==h?(f=d.UB,e=d.TC):1==h&&(f=d.SB,e=d.SC);d=new a.b;0==f?(f=new a.b,b.gc(h,f),c=c.w(),a.Ub.cI(f,c,1/(e+1),d)):0<f?(d=new a.b,b.gc(h,d)):d=c.w();e=0;h=-1;for(f=
0;1>=f;f++){c=1>f?this.vr[f]:1;if(c!=e){var l=this.GB();b.yh(e,c,l);-1!=h&&l.get().Mc(d);1!=f&&l.get().Zc(d);e=c;this.Ut.push(this.Ax(l.get()))}h=f}this.cg.rb(d)}else throw a.g.za();};return c}();a.dE=c})(D||(D={}));(function(a){var b=function(){function b(b){this.zt=this.Tk=this.wb=null;this.gm=this.vf=this.cd=this.Ze=this.Oh=this.Ta=0;this.bb=null;this.Sl=this.mn=!1;this.Ze=-1;this.Oh=this.cd=0;this.Ta=-1;this.bb=b;this.vf=this.ws(this.Oh);this.mn=!1;this.Tk=null;this.gm=-1;this.Sl=!1;this.zt=new a.b}
b.$p=function(c,d){if(0>d||d>=c.D())throw a.g.wd();var e=new b(c),f=c.cw(d);e.cd=d-c.wa(f);e.Oh=f+1;e.Ta=f;e.vf=e.ws(e.Ta);e.gm=e.bb.wa(e.Ta);e.Sl=e.bb.Qb(e.Ta);return e};b.Zp=function(c,d,e){if(0>d||d>=c.aa()||0>e)throw a.g.wd();var h=c.Qb(d)?0:1;if(e>=c.La(d)-h)throw a.g.wd();c=new b(c);c.Ze=-1;c.cd=e;c.Ta=d;c.Oh=c.cd+1;c.vf=c.ws(c.Oh);c.gm=c.bb.wa(c.Ta);c.Sl=c.bb.Qb(c.Ta);return c};b.prototype.yX=function(b){if(this.bb!=b.bb)throw a.g.Da();this.Ze=b.Ze;this.cd=b.cd;this.Ta=b.Ta;this.Oh=b.Oh;this.vf=
b.vf;this.mn=b.mn;this.gm=b.gm;this.Tk=null;this.Sl=b.Sl};b.prototype.ba=function(){this.Ze!=this.cd&&this.QE();if(this.mn)this.cd=(this.cd+1)%this.vf;else{if(this.cd==this.vf)throw a.g.wd();this.cd++}return this.Tk};b.prototype.Li=function(){if(this.mn)this.cd=(this.vf+this.cd-1)%this.vf;else{if(0==this.cd)throw a.g.wd();this.cd--}this.cd!=this.Ze&&this.QE();return this.Tk};b.prototype.zX=function(){this.Ze=-1;this.cd=0};b.prototype.AX=function(){this.cd=this.vf;this.Ze=-1};b.prototype.Tb=function(a,
b){void 0===b&&(b=-1);if(0<=this.Ta&&this.Ta<this.bb.aa()){var d=this.OO();if(a>=d&&a<this.bb.Gc(this.Ta)){this.Ze=-1;this.cd=a-d;return}}d=0<=b&&b<this.bb.aa()&&a>=this.bb.wa(b)&&a<this.bb.Gc(b)?b:this.bb.cw(a);this.Oh=d+1;this.Ta=d;this.Ze=-1;this.cd=a-this.bb.wa(d);this.vf=this.ws(d);this.gm=this.bb.wa(this.Ta);this.Sl=this.bb.Qb(this.Ta)};b.prototype.Ya=function(){this.Ta=this.Oh;if(this.Ta>=this.bb.aa())return!1;this.Ze=-1;this.cd=0;this.vf=this.ws(this.Ta);this.gm=this.bb.wa(this.Ta);this.Sl=
this.bb.Qb(this.Ta);this.Oh++;return!0};b.prototype.yj=function(){this.vf=this.cd=this.Ze=-1;this.Oh=0;this.Ta=-1;this.Sl=!1;this.gm=-1};b.prototype.eC=function(b){if(0>b)throw a.g.wd();this.Oh=b;this.gm=this.vf=this.cd=this.Ze=this.Ta=-1;this.Sl=!1};b.prototype.ws=function(a){if(this.bb.Hc())return 0;var b=1;this.bb.Qb(a)&&(b=0);return this.bb.La(a)-b};b.prototype.Fo=function(){return this.Ze==this.vf-1&&this.bb.Qb(this.Ta)};b.prototype.jC=function(){this.mn=!0};b.prototype.Db=function(){return this.bb.kb.f[this.Ta]+
this.Ze};b.prototype.OO=function(){return this.bb.wa(this.Ta)};b.prototype.Jk=function(){return this.Fo()?this.bb.wa(this.Ta):this.Db()+1};b.prototype.jn=function(){return 0==this.Ze};b.prototype.Io=function(){return this.Ze==this.vf-1};b.prototype.Ea=function(){return this.cd<this.vf};b.prototype.oA=function(){return 0<this.cd};b.prototype.Vf=function(){var a=new b(this.bb);a.Ze=this.Ze;a.cd=this.cd;a.vf=this.vf;a.Ta=this.Ta;a.Oh=this.Oh;a.bb=this.bb;a.mn=this.mn;return a};b.prototype.QE=function(){if(0>
this.cd||this.cd>=this.vf)throw a.g.wd();this.Ze=this.cd;var b=this.Db();this.bb.wc();var d=this.bb.cf,c=1;null!=d&&(c=d.read(b)&7);d=this.bb.description;switch(c){case 1:null==this.wb&&(this.wb=new a.Hb);this.Tk=this.wb;break;case 2:throw a.g.X("internal error");case 4:throw a.g.za();default:throw a.g.za();}this.Tk.Fg(d);c=this.Jk();this.bb.Nc(b,this.zt);this.Tk.Mc(this.zt);this.bb.Nc(c,this.zt);this.Tk.Zc(this.zt);for(var e=1,f=d.Ga;e<f;e++)for(var g=d.rd(e),k=a.ma.Xa(g),m=0;m<k;m++){var q=this.bb.Yc(g,
b,m);this.Tk.Tx(g,m,q);q=this.bb.Yc(g,c,m);this.Tk.Lx(g,m,q)}};b.prototype.TU=function(){return this.Ta==this.bb.aa()-1};b.prototype.Go=function(){var a=this.bb.OT();return null!=a?1!=(a.read(this.Ze)&7):!1};return b}();a.YN=b})(D||(D={}));(function(a){var b=function(){function b(b){b instanceof a.T?(this.JI=b,this.Ca=-1,this.dj=1):(this.vV=b.slice(0),this.Ca=-1,this.dj=b.length)}b.prototype.Ia=function(){return this.Ca};b.prototype.next=function(){return this.Ca<this.dj-1?(this.Ca++,null!=this.JI?
this.JI:this.vV[this.Ca]):null};b.prototype.Re=function(){return!0};return b}();a.hd=b})(D||(D={}));(function(a){var b=function(){return function(){this.next=null}}(),c=function(){function c(){this.Mr=this.wx=this.xx=this.Qk=this.ai=0;this.uG=!1;this.XK=0;this.Xn=this.kg=this.Em=this.hi=null;this.tm=0;this.az=null;this.Qk=this.ai=-1}c.prototype.vY=function(b,c,e){this.ai=b;this.Qk=c;this.hi=this.Em=null;this.Mr=0;this.az=e;null==this.Xn&&(this.Xn=a.J.gf(384,0));this.$K()};c.prototype.N=function(){return this.ai};
c.prototype.fa=function(){return this.Qk};c.prototype.flush=function(){0<this.tm&&(this.az.pG(this.Xn,this.tm),this.tm=0)};c.prototype.$K=function(){if(0<this.Mr){for(var a=0;a<this.Qk;a++){for(var b=this.Em[a];null!=b;){var c=b,b=b.next;c.next=null}this.Em[a]=null}this.hi=null}this.xx=this.Qk;this.wx=-1;this.Mr=0};c.prototype.YJ=function(a){this.uG=a==c.py;for(a=this.xx;a<=this.wx;a++)this.sP(),this.jP(a),this.YR();this.$K()};c.prototype.Qy=function(d,c,e,f){if(c!=f){var h=1;c>f&&(h=d,d=e,e=h,h=
c,c=f,f=h,h=-1);if(!(0>f||c>=this.Qk)){0>d&&0>e?e=d=-1:d>=this.ai&&e>=this.ai&&(e=d=this.ai);var l=(e-d)/(f-c);f>this.Qk&&(f=this.Qk,e=l*(f-c)+d);0>c&&(d=l*(0-c)+d,c=0);var g=Math.max(this.ai+1,8388607);-8388607>d?(c=(0-d)/l+c,d=0):d>g&&(c=(this.ai-d)/l+c,d=this.ai);-8388607>e?f=(0-d)/l+c:e>g&&(f=(this.ai-d)/l+c);c=a.J.truncate(c);f=a.J.truncate(f);c!=f&&(e=new b,e.x=a.J.truncate(4294967296*d),e.y=c,e.B=f,e.SR=a.J.truncate(4294967296*l),e.dir=h,null==this.Em&&(this.Em=a.J.gf(this.Qk,null)),e.next=
this.Em[e.y],this.Em[e.y]=e,e.y<this.xx&&(this.xx=e.y),e.B>this.wx&&(this.wx=e.B),this.Mr++)}}};c.prototype.sP=function(){if(null!=this.hi){for(var a=!1,b=null,c=this.hi;null!=c;)if(c.y++,c.y==c.B){var e=c,c=c.next;null!=b?b.next=c:this.hi=c;e.next=null}else c.x+=c.SR,null!=b&&b.x>c.x&&(a=!0),b=c,c=c.next;a&&(this.hi=this.WK(this.hi))}};c.prototype.jP=function(a){if(!(a>=this.Qk)){var b=this.Em[a];if(null!=b){this.Em[a]=null;b=this.WK(b);this.Mr-=this.XK;a=this.hi;for(var d=!0,c=b,e=null;null!=a&&
null!=c;)a.x>c.x?(d&&(this.hi=c),d=c.next,c.next=a,null!=e&&(e.next=c),e=c,c=d):(d=a.next,a.next=c,null!=e&&(e.next=a),e=a,a=d),d=!1;null==this.hi&&(this.hi=b)}}};c.wG=function(a,b){return 0>a?0:a>b?b:a};c.prototype.YR=function(){if(null!=this.hi)for(var b=0,e=this.hi,f=a.J.truncate(a.J.gI(e.x)),l=e.next;null!=l;l=l.next)if(b=this.uG?b^1:b+l.dir,l.x>e.x){var g=a.J.truncate(a.J.gI(l.x));0!=b&&(e=c.wG(f,this.ai),f=c.wG(g,this.ai),f>e&&e<this.ai&&(this.Xn[this.tm++]=e,this.Xn[this.tm++]=f,this.Xn[this.tm++]=
l.y,this.tm==this.Xn.length&&(this.az.pG(this.Xn,this.tm),this.tm=0)));e=l;f=g}};c.prototype.WK=function(b){for(var d=0,e=b;null!=e;e=e.next)d++;this.XK=d;if(1==d)return b;null==this.kg?this.kg=a.J.gf(Math.max(d,16),null):this.kg.length<d&&(this.kg=a.J.gf(Math.max(d,2*this.kg.length),null));for(var f=0,e=b;null!=e;e=e.next)this.kg[f++]=e;2==d?this.kg[0].x>this.kg[1].x&&(b=this.kg[0],this.kg[0]=this.kg[1],this.kg[1]=b):c.UM(this.kg,d,function(a,b){return a==b?0:a.x<b.x?-1:a.x>b.x?1:0});b=this.kg[0];
this.kg[0]=null;e=b;for(f=1;f<d;f++)e.next=this.kg[f],e=this.kg[f],this.kg[f]=null;e.next=null;return b};c.UM=function(a,b,c){if(b==a.length)a.sort(c);else{var d=a.slice(0,0),e=a.slice(b);b=a.slice(0,b).sort(c);a.length=0;a.push.apply(a,d.concat(b).concat(e))}};c.py=0;c.L_=1;return c}();a.zy=c})(D||(D={}));(function(a){var b=function(){function b(){}b.prototype.Ri=function(a,b){var d=this.a.Sa(a,this.Gr);this.fm==d&&(this.fm=this.Me.nb(this.fm));this.Vo==d&&(this.Vo=this.Me.nb(this.Vo));this.Me.kd(this.wB,
d);this.zk(a);if(b&&(d=this.a.ld(a),-1!=d&&this.a.cb(d)==a)){b=this.a.U(a);if(b!=a){var c=this.a.ld(b);if(c==d){this.a.jg(d,b);return}b=this.a.Ra(a);if(b!=a&&(c=this.a.ld(b),c==d)){this.a.jg(d,b);return}}this.a.jg(d,-1);this.a.sh(d,-1)}};b.prototype.GE=function(){for(var b=!1,d=0,c=new a.b;;){d++;null==this.vi?(this.vi=new a.ia(0),this.vt=new a.ia(0),this.Xe=new a.ia(0)):(this.vi.clear(!1),this.vt.clear(!1),this.Xe.clear(!1));for(var e=this.Vo,f=0,g=!0;e!=this.fm;){var k=this.Me.getData(e),m=new a.b;
this.a.Nc(k,m);g&&(this.a.Nc(k,c),g=!1);var m=this.a.Ra(k),q=this.a.U(k);-559038737!=this.a.Sa(m,this.Ug)&&(this.vi.add(m),this.a.Va(m,this.Ug,-559038737),this.vt.add(k),this.Xe.add(f++));-559038737!=this.a.Sa(q,this.Ug)&&(this.vi.add(q),this.a.Va(q,this.Ug,-559038737),this.vt.add(k),this.Xe.add(f++));e=this.Me.nb(e)}if(2>this.vi.size)break;var n=this;this.Xe.Gd(0,this.Xe.size,function(a,b){return n.GO(a,b)});e=0;for(f=this.Xe.size;e<f;e++)g=this.Xe.get(e),g=this.vi.get(g),this.a.Va(g,this.Ug,e),
m=new a.b,this.a.Nc(g,m);m=this.SO(c);e=0;for(f=this.Xe.size;e<f;e++)g=this.Xe.get(e),-1!=g&&(g=this.vi.get(g),this.a.Va(g,this.Ug,-1));if(m)b=!0;else break}return b};b.prototype.SO=function(a){for(var b=!1,c=!0;c;){var c=!1,e=0;-1==this.Xe.get(e)&&(e=this.Pm(e));for(var f=this.Pm(e),l=0,g=this.Xe.size;l<g&&-1!=e&&-1!=f&&e!=f;l++){var k=this.Xe.get(e),f=this.Xe.get(f),k=this.vi.get(k),f=this.vi.get(f),m=this.a.U(k);this.a.qw(m,a)||(m=this.a.Ra(k));var q=this.a.U(f);this.a.qw(q,a)||(q=this.a.Ra(f));
var n=this.Zu(m,k),w=this.Zu(q,f),x=n?this.a.Ra(m):this.a.U(m),p=w?this.a.Ra(q):this.a.U(q),u=!1;this.mq(m)?u=!0:this.mq(q)?u=!0:this.mq(k)?u=!0:this.mq(f)?u=!0:this.mq(x)?u=!0:this.mq(p)&&(u=!0);!u&&this.a.Uq(k,f)&&(u=!0,this.JE(n,w,m,k,q,f));!u&&this.a.Uq(x,p)&&(u=!0,this.JE(!n,!w,m,x,q,p));u&&(b=!0);c=c||u;e=this.Pm(e);f=this.Pm(e)}}if(!b)for(e=0,-1==this.Xe.get(e)&&(e=this.Pm(e)),f=this.Pm(e),l=0,g=this.Xe.size;l<g&&-1!=e&&-1!=f&&e!=f;l++)k=this.Xe.get(e),f=this.Xe.get(f),k=this.vi.get(k),f=this.vi.get(f),
m=this.a.U(k),this.a.qw(m,a)||(m=this.a.Ra(k)),q=this.a.U(f),this.a.qw(q,a)||(q=this.a.Ra(f)),n=this.Zu(m,k),w=this.Zu(q,f),x=n?this.a.Ra(m):this.a.U(m),p=w?this.a.Ra(q):this.a.U(q),this.KO(n,w,k,m,x,f,q,p)&&(b=!0),e=this.Pm(e),f=this.Pm(e);return b};b.prototype.VO=function(){1736==this.a.hc(this.Y)&&1==this.a.xo(this.Y)&&(new a.Dg).yW(this.Vw,this.a,this.Y,this.ke);var b=!1,d=!0;this.Ug=this.Gr=-1;var c=this.a.D(this.Y),e=new a.ia(0);e.yb(c);for(var f=this.a.Pb(this.Y);-1!=f;f=this.a.Sb(f))for(var g=
this.a.cb(f),k=0,m=this.a.La(f);k<m;k++)e.add(g),g=this.a.U(g);var q=this.a.Dd.f,n=this.a.Dd.ed;this.a.xb.wc();var w=this.a.xb.ya[0].f;e.Gd(0,c,function(a,b){var d=q[n*a],c=q[n*b],e=w[2*d],d=w[2*d+1],h=w[2*c],c=w[2*c+1],e=d<c?-1:d>c?1:e<h?-1:e>h?1:0;0==e&&(e=q[n*a+3],c=q[n*b+3],e=e<c?-1:e==c?0:1);return e});this.Gr=this.a.Vd();this.Me=new a.Xp;this.wB=this.Me.mi(0);this.Me.Vn(c);for(f=0;f<c;f++)g=e.get(f),k=this.Me.addElement(this.wB,g),this.a.Va(g,this.Gr,k);this.Ug=this.a.Vd();this.fm=-1;for(this.wE()&&
(b=!0);d;){d=!1;c=0;e=!1;do{e=!1;this.Vo=-1;for(var m=0,f=new a.b,k=new a.b,x=this.Me.xc(this.wB);-1!=x;)g=this.Me.getData(x),-1!=this.Vo?(this.a.Nc(g,k),f.ub(k))?m++:(f.L(k),this.fm=x,0<m&&(g=this.GE())&&(e=!0,-1!=this.fm&&(g=this.Me.getData(this.fm),this.a.Nc(g,f))),this.Vo=x=this.fm,m=0):(this.Vo=x,this.a.Nc(this.Me.getData(x),f),m=0),-1!=x&&(x=this.Me.nb(x));this.fm=-1;0<m&&(g=this.GE())&&(e=!0);if(10<c++)throw a.g.za();e&&this.NO();this.wE()&&(e=!0);d=d||e&&!1;b=b||e}while(e)}this.a.le(this.Gr);
this.a.le(this.Ug);return b=a.SN.V(this.a,this.Y,this.Me,this.Vw)||b};b.prototype.Zu=function(a,b){return this.a.U(b)==a?!1:!0};b.prototype.KO=function(a,b,c,e,f,g,k,m){if(e==k)return this.zk(c),this.zk(g),!1;var d=this.a.Sa(c,this.Ug),h=this.a.Sa(f,this.Ug),l=this.a.Sa(g,this.Ug),q=this.a.Sa(m,this.Ug);c=[0,0,0,0,0,0,0,0];var n=[0,0,0,0];c[0]=0;n[0]=d;c[1]=0;n[1]=h;c[2]=1;n[2]=l;c[3]=1;n[3]=q;for(d=1;4>d;d++){h=n[d];l=c[d];for(q=d-1;0<=q&&n[q]>h;)n[q+1]=n[q],c[q+1]=c[q],q--;n[q+1]=h;c[q+1]=l}n=0;
0!=c[0]&&(n|=1);0!=c[1]&&(n|=2);0!=c[2]&&(n|=4);0!=c[3]&&(n|=8);if(5!=n&&10!=n)return!1;a==b?a?(this.a.Kc(m,e),this.a.Lc(e,m),this.a.Kc(f,k),this.a.Lc(k,f)):(this.a.Lc(m,e),this.a.Kc(e,m),this.a.Lc(f,k),this.a.Kc(k,f)):a?(this.a.Lc(e,g),this.a.Kc(g,e),this.a.Lc(k,f),this.a.Kc(f,k)):(this.a.Kc(e,g),this.a.Lc(g,e),this.a.Kc(k,f),this.a.Lc(f,k));return!0};b.prototype.JE=function(a,b,c,e,f,g){this.C_?this.UO():this.TO(a,b,c,e,f,g)};b.prototype.UO=function(){throw a.g.X("not implemented.");};b.prototype.TO=
function(a,b,c,e,f,g){if(a!=b)a?(this.a.Kc(c,f),this.a.Lc(f,c),this.a.Kc(g,e),this.a.Lc(e,g),this.po(f,c),this.Ri(f,!0),this.a.Mi(f,!0),this.zk(c),this.po(g,e),this.Ri(g,!0),this.a.Mi(g,!1)):(this.a.Kc(f,c),this.a.Lc(c,f),this.a.Kc(e,g),this.a.Lc(g,e),this.po(f,c),this.Ri(f,!0),this.a.Mi(f,!1),this.zk(c),this.po(g,e),this.Ri(g,!0),this.a.Mi(g,!0)),this.zk(e);else{var d=a?c:e,h=b?f:g;a=a?e:c;b=b?g:f;f=!1;this.a.Kc(d,h);this.a.Kc(h,d);this.a.Lc(a,b);this.a.Lc(b,a);for(g=b;g!=h;)c=this.a.Ra(g),e=this.a.U(g),
this.a.Lc(g,e),this.a.Kc(g,c),f=f||g==d,g=e;f||(c=this.a.Ra(h),e=this.a.U(h),this.a.Lc(h,e),this.a.Kc(h,c));this.po(h,d);this.Ri(h,!0);this.a.Mi(h,!1);this.zk(d);this.po(b,a);this.Ri(b,!0);this.a.Mi(b,!1);this.zk(a)}};b.prototype.wE=function(){for(var a=!1,b=this.a.Pb(this.Y);-1!=b;){for(var c=this.a.cb(b),e=0,f=this.a.La(b);e<f&&1<f;){var g=this.a.Ra(c),k=this.a.U(c);this.a.Uq(g,k)?(a=!0,this.Ri(c,!1),this.a.ud(c,!0),this.Ri(k,!1),this.a.ud(k,!0),c=g,e=0,f=this.a.La(b)):(c=k,e++)}if(2>this.a.La(b)){a=
this.a.cb(b);e=0;for(f=this.a.La(b);e<f;e++)this.Ri(a,!1),a=this.a.U(a);b=this.a.Rr(b);a=!0}else b=this.a.Sb(b)}return a};b.prototype.mq=function(a){for(var b=!1;;){var c=this.a.U(a),e=this.a.Ra(a);if(c==a)return this.Ri(a,!0),this.a.Mi(a,!1),!0;if(!this.a.Uq(c,e))break;b=!0;this.zk(e);this.zk(c);this.Ri(a,!0);this.a.Mi(a,!1);this.po(c,e);this.Ri(c,!0);this.a.Mi(c,!0);if(c==e)break;a=e}return b};b.prototype.NO=function(){for(var a=0,b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b)){var c=this.Me.getData(b);
this.a.Aj(c,-1)}for(var e=0,f=this.a.Pb(this.Y);-1!=f;)if(b=this.a.cb(f),-1==b||-1!=this.a.ld(b))c=f,f=this.a.Sb(f),this.a.Sr(c);else{this.a.Aj(b,f);for(var g=1,c=this.a.U(b);c!=b;c=this.a.U(c))this.a.Aj(c,f),g++;this.a.Np(f,!1);this.a.nk(f,g);this.a.sh(f,this.a.Ra(b));e+=g;a++;f=this.a.Sb(f)}for(b=this.Me.xc(this.Me.Ge);-1!=b;b=this.Me.nb(b))c=this.Me.getData(b),-1==this.a.ld(c)&&(f=this.a.BH(this.Y,c,c,null),e+=this.a.La(f),a++);this.a.wm(this.Y,a);this.a.lk(this.Y,e);a=0;for(e=this.a.sd;-1!=e;e=
this.a.Ue(e))a+=this.a.D(e);this.a.zC(a)};b.prototype.Pm=function(a){for(var b=0,c=this.Xe.size-1;b<c;b++)if(a=(a+1)%this.Xe.size,-1!=this.Xe.get(a))return a;return-1};b.prototype.po=function(a,b){var d=this.a.Sa(b,this.Gr),c=this.a.Sa(b,this.Ug);this.a.JC(a,b);this.a.Va(b,this.Gr,d);this.a.Va(b,this.Ug,c)};b.prototype.zk=function(a){var b=this.a.Sa(a,this.Ug);-1!=b&&(this.Xe.set(b,-1),this.a.Va(a,this.Ug,-1))};b.V=function(a,d,c,e,f){var h=new b;h.a=a;h.Y=d;h.dB=c;h.Vw=e;h.ke=f;return h.VO()};b.prototype.GO=
function(b,d){var c=this.vi.get(b),e=new a.b;this.a.Nc(c,e);var c=new a.b,f=this.vi.get(d);this.a.Nc(f,c);if(e.ub(c))return 0;b=this.vt.get(b);f=new a.b;this.a.Nc(b,f);d=this.vt.get(d);b=new a.b;this.a.Nc(d,b);d=new a.b;d.zc(e,f);e=new a.b;e.zc(c,b);return a.b.vs(d,e)};return b}();a.lo=b})(D||(D={}));(function(a){(function(a){a[a.Local=0]="Local";a[a.Geographic=1]="Geographic";a[a.Projected=2]="Projected";a[a.Image=3]="Image";a[a.Unknown=4]="Unknown"})(a.ZN||(a.ZN={}));(function(a){a[a.Integer32=
0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.JN||(a.JN={}));var b=function(){function b(){this.jq="";this.bv=null;this.yg=0;this.lJ=this.tp=-1;this.Uh=null}b.prototype.yc=function(){return this.yg};b.prototype.Rs=function(){return 0};b.prototype.Ss=function(){return 0};b.prototype.Ts=function(){return 0};b.prototype.Qs=function(){return 0};b.prototype.Tz=function(){return 5.7295779513082306E10};b.prototype.Uz=function(){return 1E3};b.prototype.Sz=function(){return 1E3};
b.prototype.bt=function(){return 1};b.prototype.re=function(){var b=.001;0!=this.yg?b=a.us.uS(this.yg):null!=this.Uh&&(b=a.oE.vS(this.Uh));return b};b.prototype.mH=function(){return this.Uh};b.prototype.Nd=function(){if(0!=this.yg)return a.oc.ze(a.us.xG(this.yg));if(null!=this.Uh)return a.oE.wS(this.Uh)};b.Fb=function(b){if(0!=b.yg){if(!0===a.us.SU(b.yg))return 1;if(!0===a.us.UU(b.yg))return 2}return 4};b.prototype.$s=function(){var b=this.yc();if(-1!=this.tp)return this.tp;this.tp=a.us.sZ(b);return-1!=
this.tp?this.tp:b};b.create=function(c){if(0>=c)throw a.g.F("Invalid or unsupported wkid: "+c);var d=new b;d.yg=c;return d};b.oR=function(c){if(null==c||0==c.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");var d=new b;d.Uh=c;return d};b.prototype.Eb=function(a){return this==a?!0:null==a||this.constructor!=a.constructor||this.yg!=a.yg||0==this.yg&&this.Uh!==a.Uh?!1:!0};b.PS=function(b,d){var c=Math.PI/180,e=new a.ea;a.pM.SS(b.w().x*c,b.w().y*c,d.w().x*c,d.w().y*c,e);return e.j};
b.prototype.toString=function(){return"[ tol: "+this.Bo()+"; wkid: "+this.yc()+"; wkt: "+this.mH()+"]"};b.prototype.jc=function(){if(""!==this.jq)return this.jq;var a=this.toString();if(Array.prototype.reduce)return this.jq="S"+a.split("").reduce(function(a,b){a=(a<<5)-a+b.charCodeAt(0);return a&a},0);var b=0;if(0===a.length)return"";for(var c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return this.jq="S"+b};b.prototype.Bo=function(){return this.re(0)};b.prototype.Ao=function(){return null!==
this.bv?this.bv:this.bv=a.Ou.vR(this)};b.q_=!0;b.sv=2147483645;b.tv=9007199254740990;return b}();a.Sd=b})(D||(D={}));(function(a){var b=function(b){function c(){b.apply(this,arguments);this.ij=null;this.lp=new a.eE;this.Xw=this.Fr=null}F(c,b);c.vR=function(b){var d=new c;d.yg=b.yg;d.tp=b.tp;d.lJ=b.lJ;d.Uh=b.Uh;if(""!==d.Uh&&null!==d.Uh){b=c.PY(d.Uh);var e=c.lX(d.Uh);d.lp.Ey(b,e,a.ts.Integer64);d.Ky(b);d.yg=b.$s()}else b=c.DX(d.yg),d.Ky(b),d.lp.Ey(b,null,a.ts.Integer64);return d};c.prototype.re=function(a){return this.lp.Bo(a)};
c.lX=function(b){if(0>=b.length)throw a.g.F();var d=null;try{d=a.QD.fromString(b)}catch(r){d=null}return null==d?null:c.sD(d,!0)};c.prototype.Ky=function(a){this.Pd=a;this.Fr=this.Pd.Nd()};c.prototype.Jc=function(){return 0==this.Fb()||3==this.Fb()?!1:this.Pd.Jc()};c.prototype.UH=function(){return 0==this.Fb()?!1:3==this.Fb()?this.ij.Gk().Jc():this.Pd.Jc()};c.prototype.Kg=function(){return null!=this.Pd?this.Pd.uf:null};c.prototype.bn=function(){return this.Pd.bn()};c.prototype.ee=function(){return this.Pd.ee()};
c.prototype.Ch=function(){return null!=this.Pd?this.Pd.fx:NaN};c.prototype.dn=function(){return this.Pd.dn()};c.prototype.Ws=function(){return this.Pd.Ws()};c.prototype.Sj=function(){return this.Pd.Sj()};c.prototype.hU=function(b){return a.TD.zz(this.Pd,b.Pd)};c.prototype.Mk=function(){return this.Pd.Mk()};c.prototype.Vs=function(){return this.Pd.Vs()};c.prototype.pi=function(){return 3==this.Fb()?this.ij.Gk().pi():this.Pd.pi()};c.prototype.Bh=function(){if(!this.Jc())throw a.g.F("!isPannable()");
var b=new a.h;this.Pd.Bh(b);return b};c.prototype.qe=function(){if(!this.Jc())throw a.g.F("!isPannable()");return this.Pd.gp};c.prototype.AT=function(){if(!this.Jc())throw a.g.F("!isPannable()");var b=new a.h;this.Pd.zT(b);return b};c.prototype.bw=function(){if(!this.Jc())throw a.g.F("!isPannable()");return this.Pd.bw()};c.prototype.aw=function(){if(!this.Jc())throw a.g.F("!isPannable()");return this.Pd.aw()};c.prototype.Xs=function(){return null!=this.ij?this.ij.Gk().Xs():this.Pd.Xs()};c.prototype.DS=
function(){return this.Pd.Uv()};c.prototype.iX=function(a){a.assign(this.lp)};c.prototype.Yi=function(){return this.Fr.getUnitFactor()};c.prototype.fA=function(a){return this.lp.fA(a)};c.prototype.kc=function(){var b=this.Fb();if(1==b)return this;if(3==b)return this.ij.Gk().kc();if(0==b)throw a.g.X("invalid call");if(4===b)throw a.g.X("invalid call");if(null!==this.Xw)return this.Xw;b=this.Kg().getGeogcs();if(null==b)throw a.g.za();return this.Xw=c.iG(b,this.lp.bt())};c.iG=function(b,e){if(null==
b)throw a.g.F("null pointer.");var d=new c;b=c.Pu(b,!0);d.lp.Ey(b,null,e);d.Ky(b);d.yg=b.$s();return d};c.prototype.Fb=function(){var b=this.Kg();if(null!=b)switch(b.getType()){case a.Vc.PE_TYPE_GEOGCS:return 1;case a.Vc.PE_TYPE_PROJCS:return 2}return 4};c.prototype.dA=function(b){var d=new a.b;this.Pd.dA(b,d);return d};c.prototype.Uv=function(){return this.Pd.Uv()};c.Pu=function(b,e){var d=b.getCode();if(0>=d&&(d=a.Tf.getCode(b),0<d)){var h=a.Tf.coordsys(d);if(null==h)throw a.g.F("Text to wkid mapping had failed: "+
d);return c.Pu(h,e)}if(e&&0<d&&(h=c.Mv[d]))return h;h=a.Ib.iw(b,d,!1);if(e=c.zH[h])return e;e=0>=d?b:a.Tf.coordsys(d);e=new a.TD(e);c.zH[h]=e;0<d&&(c.Mv[d]=e);return e};c.DX=function(b){if(0>=b)throw a.g.F("Invalid or unsupported wkid: "+b);var d=c.Mv[b];if(null!=d)return d;d=a.Tf.coordsys(b);if(null==d)throw a.g.F("Invalid or unsupported wkid: "+b);d=c.Pu(d,!1);d.$s()!=b&&(c.Mv[b]=d);return d};c.PY=function(b){if(null==b||void 0===b||0==b.length)throw a.g.F("Cannot create SpatialReference from null or empty text.");
var d=null;try{d=a.Tf.fromString(a.Vc.PE_TYPE_COORDSYS,b)}catch(r){throw a.g.F("Cannot create SpatialReference from text. "+r.message);}if(null===d)throw a.g.F("Cannot create SpatialReference from text. ");return c.Pu(d,!0)};c.sD=function(b,e){var d=b.getCode();if(0>=d&&(d=a.Tf.getCode(b),0<d)){d=a.Tf.vertcs(d);if(null===d)throw a.g.F();return c.sD(d,e)}if(e&&0<d&&(e=c.xH[d]))return e;b=a.Ib.iw(b,d,!1);if(e=c.YH[b])return e;var h;0>=d||(h=a.Tf.vertcs(d));if(null===h)throw a.g.F();e=new a.FN(h);c.YH[b]=
e;0<d&&(c.xH[d]=e);return e};c.jK=function(b,c){var d;if(null===c||c.u())return null;var e=new a.h,h;null!==c&&1!=b.Fb()?(d=b.kc(),h=d.Kg(),d=a.rs.Is(b,d,null,null),d=a.os.local().V(c,d,null),d.s(e)):(h=b.Kg(),c.s(e));d=h.getPrimem().getLongitude();h=h.getUnit().getUnitFactor();return new a.OD(e.o,e.A,e.v,e.B,d,h)};c.EE=function(a){var b={name:"",steps:[],_pt:null,_entry:null},d=0;for(a=a.getEntries();d<a.length;d++){var c=a[d],e={y_:!1,X_:"",W_:-1,geogtran:null};0===c.getDirection()?e.isInverse=
!1:e.isInverse=!0;var f=c.getGeogtran().getCode();-1<f?e.wkid=f:e.wkt=c.getGeogtran().toString();b.steps.push(e)}return b};c.QT=function(b,e,f,l){void 0===f&&(f=null);f=c.jK(l,f);b=a.fq.getGTlist(b.Kg(),e.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,1);e=null;b&&0<b.length&&(e=this.EE(b[0]),a.wy.destroy(b));null!==f&&f.destroy();return e};c.RT=function(b,e,f,l){var d;void 0===f&&(f=null);void 0===l&&(l=null);void 0===d&&(d=30);f=c.jK(l,f);b=a.fq.getGTlist(b.Kg(),e.Kg(),2,a.fq.PE_GTLIST_OPTS_COMMON,f,d);e=
[];if(b&&0<b.length){for(d=0;d<b.length;d++)e.push(this.EE(b[d]));a.wy.destroy(b)}null!==f&&f.destroy();return e};c.Mv={};c.zH={};c.xH={};c.YH={};return c}(a.Sd);a.Ou=b})(D||(D={}));(function(a){(function(a){a[a.Integer32=0]="Integer32";a[a.Integer64=1]="Integer64";a[a.FloatingPoint=2]="FloatingPoint"})(a.ts||(a.ts={}));var b=a.ts,c=function(){function c(){this.kq()}c.prototype.assign=function(a){this.Xl=a.Xl;this.Yl=a.Yl;this.uj=a.uj;this.Tw=a.Tw;this.Jn=a.Jn;this.Sw=a.Sw;this.rx=a.rx;this.jl=a.jl;
this.Cr=a.Cr;this.Br=a.Br;this.En=a.En};c.prototype.Rs=function(){return this.Xl};c.prototype.Ss=function(){return this.Yl};c.prototype.Ts=function(){return this.Tw};c.prototype.Qs=function(){return this.Sw};c.prototype.Tz=function(){return this.uj};c.prototype.Uz=function(){return this.Jn};c.prototype.Sz=function(){return this.rx};c.prototype.bt=function(){return this.En};c.prototype.kq=function(){this.Yl=this.Xl=0;this.uj=1;this.Tw=0;this.Jn=1;this.Sw=0;this.rx=1;this.Br=this.Cr=this.jl=2.220446049250313E-14;
this.En=b.FloatingPoint};c.prototype.Ey=function(d,c,e){this.kq();this.En=e;if(e!=b.FloatingPoint){var h=new a.h;d.ZS(h);this.Xl=h.o;this.Yl=h.A}else this.Yl=this.Xl=-1.7976931348623157E308;h=d.uf.getType();h==a.Vc.PE_TYPE_GEOGCS?(h=(e==b.Integer64?1E-9:1/18E5)*d.ee(),this.uj=1/h):h==a.Vc.PE_TYPE_PROJCS&&(h=(e==b.Integer64?1E-4:.001)*d.bn(),this.uj=1/h);null!=c?(h=(e==b.Integer32?.001:1E-4)*c.XI,this.Jn=1/h):this.Jn=1E4;this.rx=1E4;this.WO();this.jl=d.fx;this.Cr=null!=c?.001*c.XI:.001;this.Br=2.220446049250313E-14};
c.prototype.WO=function(){if(this.En!=b.FloatingPoint){var d=this.En==b.Integer64?a.Sd.tv:a.Sd.sv,c=d/this.uj,e=this.Xl+c,f=a.J.truncate((e-this.Xl)*this.uj);f>d&&(this.uj=d/(e-this.Xl));c=this.Yl+c;f=a.J.truncate((c-this.Yl)*this.uj);f>d&&(this.uj=d/(c-this.Yl))}};c.prototype.yC=function(a,b){switch(a){case 0:this.jl=b;case 1:this.Cr=b;case 2:this.Br=b}};c.prototype.Bo=function(a){switch(a){case 0:return this.jl;case 1:return this.Cr;case 2:return this.Br}return 0};c.prototype.WT=function(){var d=
new a.h;switch(this.bt()){case b.Integer32:var c=a.Sd.sv/this.Tz();d.I(this.Rs(),this.Ss(),this.Rs()+c,this.Ss()+c);break;case b.Integer64:c=a.Sd.tv/this.Tz();d.I(this.Rs(),this.Ss(),this.Rs()+c,this.Ss()+c);break;case b.FloatingPoint:d.I(-1.7976931348623157E308,-1*1.7976931348623157E308,1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return d};c.prototype.XT=function(){var d=new a.Ac;switch(this.bt()){case b.Integer32:var c=a.Sd.sv/this.Uz();d.I(this.Ts(),
this.Ts()+c);break;case b.Integer64:c=a.Sd.tv/this.Uz();d.I(this.Ts(),this.Ts()+c);break;case b.FloatingPoint:d.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;default:throw a.g.X("internal error");}return d};c.prototype.sT=function(){var d=new a.Ac;switch(this.bt()){case b.Integer32:var c=a.Sd.sv/this.Sz();d.I(this.Qs(),this.Qs()+c);break;case b.Integer64:c=a.Sd.tv/this.Sz();d.I(this.Qs(),this.Qs()+c);break;case b.FloatingPoint:d.I(-1*1.7976931348623157E308,1.7976931348623157E308);break;
default:throw a.g.X("internal error");}return d};c.prototype.fA=function(a){if(this.En==b.FloatingPoint)return 0;switch(a){case 0:return 1/this.uj;case 1:return 1/this.Jn;case 2:return 1/this.Jn;default:return 0}};c.prototype.toString=function(){var a;a="SRPD [m_toleranceXY: "+this.jl.toString();a=a+";m_falseX: "+this.Xl.toString();a=a+";m_falseY: "+this.Yl.toString();a=a+";m_unitsXY: "+this.uj.toString();a=a+";m_falseZ: "+this.Tw.toString();a=a+";m_unitsZ: "+this.Jn.toString();a=a+";m_falseM: "+
this.Sw.toString();a=a+";m_toleranceZ: "+this.Cr.toString();a=a+";m_toleranceM: "+this.Br.toString();a=a+";m_precision: "+this.En.toString();return a+"] "};return c}();a.eE=c})(D||(D={}));(function(a){function b(a,b){89.99999<b?b=89.99999:-89.99999>b&&(b=-89.99999);b*=.017453292519943;return[111319.49079327169*a,3189068.5*Math.log((1+Math.sin(b))/(1-Math.sin(b)))]}function c(a,b,d){a=a/6378137*57.29577951308232;return d?[a,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]:
[a-360*Math.floor((a+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*b/6378137)))]}function e(b,d){var c=b.Vf();if(33===b.G()){var e=d(c.Be(),c.nf());c.rb(e[0],e[1])}else if(197===b.G())e=d(b.R.o,b.R.A,!0),b=d(b.R.v,b.R.B,!0),c.I(e[0],e[1],b[0],b[1]);else for(e=new a.b,b=0;b<c.D();b++){c.w(b,e);var h=d(e.x,e.y,!0);e.ka(h[0],h[1]);c.rb(b,e)}return c}function d(a){return e(a,c)}function h(a){return e(a,b)}var f=Math.PI/180,g=function(){function b(){}b.Ru=function(b){var d=Math.sqrt(.006694379990197414),
c=Math.sin(b.y*f);return a.b.pa(6378137*b.x*f,3167719.6636462314*(c/(1-.006694379990197414*c*c)-1/(2*d)*Math.log((1-d*c)/(1+d*c))))};b.DA=function(b,d,c,e){var h=1/298.257223563,l=Math.sin(c);c=Math.cos(c);var g=(1-h)*Math.tan(b);b=1/Math.sqrt(1+g*g);for(var k=g*b,m=Math.atan2(g,c),g=b*l,q=g*g,n=1-q,w=2.7233160610754688E11*n/4.040829998466145E13,x=1+w/16384*(4096+w*(-768+w*(320-175*w))),p=w/1024*(256+w*(-128+w*(74-47*w))),w=e/(6356752.31424518*x),u=2*Math.PI,r,B,z,v;1E-12<Math.abs(w-u);)z=Math.cos(2*
m+w),r=Math.sin(w),B=Math.cos(w),v=p*r*(z+p/4*(B*(-1+2*z*z)-p/6*z*(-3+4*r*r)*(-3+4*z*z))),u=w,w=e/(6356752.31424518*x)+v;e=k*r-b*B*c;n=h/16*n*(4+h*(4-3*n));return a.b.pa((d+(Math.atan2(r*l,b*B-k*r*c)-(1-n)*h*g*(w+n*r*(z+n*B*(-1+2*z*z)))))/f,Math.atan2(k*B+b*r*c,(1-h)*Math.sqrt(q+e*e))/f)};b.BM=function(a,b,d,c){var e=1/298.257223563,h=c-b,f=Math.atan((1-e)*Math.tan(a)),l=Math.atan((1-e)*Math.tan(d)),g=Math.sin(f),f=Math.cos(f),k=Math.sin(l),l=Math.cos(l),m=h,q,n=1E3,w,x,p,r,u,B,z;do{p=Math.sin(m);
r=Math.cos(m);x=Math.sqrt(l*p*l*p+(f*k-g*l*r)*(f*k-g*l*r));if(0===x)return 0;r=g*k+f*l*r;u=Math.atan2(x,r);B=f*l*p/x;w=1-B*B;p=r-2*g*k/w;isNaN(p)&&(p=0);z=e/16*w*(4+e*(4-3*w));q=m;m=h+(1-z)*e*B*(u+z*x*(p+z*r*(-1+2*p*p)))}while(1E-12<Math.abs(m-q)&&0<--n);if(0===n)return g=c-b,{azimuth:Math.atan2(Math.sin(g)*Math.cos(d),Math.cos(a)*Math.sin(d)-Math.sin(a)*Math.cos(d)*Math.cos(g)),geodesicDistance:6371008.771415059*Math.acos(Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos(c-b))};a=2.7233160610754688E11*
w/4.040829998466145E13;b=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(l*Math.sin(m),f*k-g*l*Math.cos(m)),OS:6356752.31424518*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(u-b*x*(p+b/4*(r*(-1+2*p*p)-b/6*p*(-3+4*x*x)*(-3+4*p*p)))),P_:Math.atan2(f*Math.sin(m),f*k*Math.cos(m)-g*l)}};b.AR=function(b){var d=b.hasAttribute(1),c=b.hasAttribute(2),e=[],h=b.aa(),f=null,l=null;d&&(f=b.Pa(1));c&&(l=b.Pa(2));for(var g=new a.b,k=0;k<h;k++){for(var m=b.wa(k),q=b.La(k),n=0,w=0,x=NaN,p=NaN,r=NaN,u=NaN,
B=b.Qb(k),z=[],v=m;v<m+q;v++){b.w(v,g);var u=r=NaN,t=[g.x,g.y];d&&(r=f.get(v),t.push(r));c&&(h=l.get(v),t.push(u));v==m&&B&&(n=g.x,w=g.y,x=r,p=u);z.push(t)}!B||n==g.x&&w==g.y&&(!d||isNaN(x)&&isNaN(r)||x==r)&&(!c||isNaN(p)&&isNaN(u)||p==u)||z.push(z[0].slice(0));e.push(z)}return e};b.Ez=function(a,d){a=b.AR(a);637.100877141506>d&&(d=637.100877141506);for(var c=[],e,h=0;h<a.length;h++){var l=a[h];c.push(e=[]);e.push([l[0][0],l[0][1]]);var g,k,m,q,n,w;g=l[0][0]*f;k=l[0][1]*f;for(n=0;n<l.length-1;n++)if(m=
l[n+1][0]*f,q=l[n+1][1]*f,g!==m||k!==q){q=b.BM(k,g,q,m);m=q.azimuth;q=q.OS;var x=q/d;if(1<x){for(w=1;w<=x-1;w++){var p=b.DA(k,g,m,w*d);e.push([p.x,p.y])}w=b.DA(k,g,m,(q+Math.floor(x-1)*d)/2);e.push([w.x,w.y])}k=b.DA(k,g,m,q);e.push([k.x,k.y]);g=k.x*f;k=k.y*f}}return{gK:c}};b.NS=function(d){for(var c=[],e=0;e<d.length;e++){var h=d[e],h=b.Ez(h,1E4);c.push(h)}d=[];for(var f=0;f<c.length;f++){for(var h=c[f],l=0,e=0;e<h.gK.length;e++){var g=h.gK[e],k=b.Ru(a.b.pa(g[0][0],g[0][1])),m=b.Ru(a.b.pa(g[g.length-
1][0],g[g.length-1][1])),q=m.x*k.y-k.x*m.y,n;for(n=0;n<g.length-1;n++)k=b.Ru(a.b.pa(g[n+1][0],g[n+1][1])),m=b.Ru(a.b.pa(g[n][0],g[n][1])),q+=m.x*k.y-k.x*m.y;l+=q}l/=1;d.push(l/-2)}return d};return b}();a.qM=g;g=function(){function b(){}b.XB=function(a,d,c,e,h,f,l){b.uD[a.jc()]=d;0==isNaN(c)&&(b.wD[a.jc()]=c);0==isNaN(e)&&(b.XD[a.jc()]=e);0==isNaN(h)&&(b.oD[a.jc()]=h);b.yD[a.jc()]=f;null!==l&&(b.AD[a.jc()]=l)};b.Ix=function(a,d,c){b.RD[a.jc()+"-"+d.jc()]=c};b.kc=function(d){d=b.uD[d.jc()];if(void 0==
d)throw a.g.df();return d};b.ee=function(d){d=b.wD[d.jc()];if(void 0==d)throw a.g.df();return d};b.hw=function(d){d=b.XD[d.jc()];if(void 0==d)throw a.g.df();return d};b.Sv=function(d){d=b.oD[d.jc()];if(void 0==d)throw a.g.df();return d};b.Bh=function(d){d=b.AD[d.jc()];if(void 0==d)throw a.g.df();return a.h.pa(d[0],d[1],d[2],d[3])};b.Jc=function(d){d=b.yD[d.jc()];if(void 0==d)throw a.g.df();return d};b.Xg=function(d,c,e){if(c.Eb(e))return d;var h=b.RD[c.jc()+"-"+e.jc()];if(void 0!==h)return h(d,c,
e);throw a.g.df();};b.lu=function(){throw a.g.df();};b.TS=function(){throw a.g.df();};b.UW=function(){throw a.g.df();};b.Mk=function(){throw a.g.df();};b.rX=function(){var b=a.Sd.create(102100),c=a.Sd.create(3857),e=a.Sd.create(4326);a.fb.XB(b,e,NaN,NaN,NaN,!1,null);a.fb.XB(e,e,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]);a.fb.XB(c,e,NaN,NaN,NaN,!1,null);a.fb.Ix(b,e,d);a.fb.Ix(e,b,h);a.fb.Ix(c,e,d);a.fb.Ix(e,c,h)};b.uD=[];b.wD=[];b.XD=[];b.oD=[];b.yD=[];b.AD=[];b.RD=[];return b}();a.fb=g})(D||
(D={}));D.fb.rX();(function(a){var b=function(){function b(a){this.f=null;this.kh=-1;this.yd=this.size=this.Jf=0;this.ed=a}b.prototype.kd=function(a){a<this.Jf?(this.f[a*this.ed]=this.kh,this.kh=a):this.Jf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.ed+b]};b.prototype.P=function(a,b,c){this.f[a*this.ed+b]=c};b.prototype.Pe=function(){var b=this.kh;if(-1==b){if(this.Jf==this.yd){b=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.yd)throw a.g.wd();
this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.f[b*this.ed];this.size++;for(var d=b*this.ed+this.ed,c=b*this.ed;c<d;c++)this.f[c]=-1;return b};b.prototype.nl=function(b){var d=this.kh;if(-1==d){if(this.Jf==this.yd){d=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<d&&(d=2147483647);if(d==this.yd)throw a.g.wd();this.Co(d)}d=this.Jf;this.Jf++}else this.kh=this.f[d*this.ed];this.size++;for(var c=d*this.ed,e=this.ed,f=0;f<e;f++)this.f[c+f]=b[f];return d};b.prototype.Vi=function(a){this.kh=-1;
this.size=this.Jf=0;a&&(this.f=null,this.yd=0)};b.prototype.Qe=function(a){a>this.yd&&this.Co(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.ed*b+c];this.f[this.ed*b+c]=this.f[this.ed*a+c];this.f[this.ed*a+c]=d};b.Im=function(){return-2};b.jo=function(){return-3};b.BA=function(a){return 0<=a};b.prototype.Co=function(a){null==this.f&&(this.f=[]);this.yd=a};return b}();a.ad=b;b=function(){function b(a){this.f=new Int32Array(0);this.kh=-1;this.yd=this.size=this.Jf=0;this.ed=a}b.prototype.kd=function(a){a<
this.Jf?(this.f[a*this.ed]=this.kh,this.kh=a):this.Jf--;this.size--};b.prototype.S=function(a,b){return this.f[a*this.ed+b]};b.prototype.P=function(a,b,c){this.f[a*this.ed+b]=c};b.prototype.Pe=function(){var b=this.kh;if(-1==b){if(this.Jf==this.yd){b=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<b&&(b=2147483647);if(b==this.yd)throw a.g.wd();this.Co(b)}b=this.Jf;this.Jf++}else this.kh=this.f[b*this.ed];this.size++;for(var d=b*this.ed;d<b*this.ed+this.ed;d++)this.f[d]=-1;return b};b.prototype.nl=
function(b){var d=this.kh;if(-1==d){if(this.Jf==this.yd){d=0!=this.yd?a.J.truncate(3*(this.yd+1)/2):1;2147483647<d&&(d=2147483647);if(d==this.yd)throw a.g.wd();this.Co(d)}d=this.Jf;this.Jf++}else this.kh=this.f[d*this.ed];this.size++;for(var c=d*this.ed,e=0;e<b.length;e++)this.f[c+e]=b[e];return d};b.prototype.Vi=function(a){this.kh=-1;this.size=this.Jf=0;a&&(this.f=null,this.yd=0)};b.prototype.Qe=function(a){a>this.yd&&this.Co(a)};b.prototype.ay=function(a,b,c){var d=this.f[this.ed*b+c];this.f[this.ed*
b+c]=this.f[this.ed*a+c];this.f[this.ed*a+c]=d};b.Im=function(){return-2};b.jo=function(){return-3};b.BA=function(a){return 0<=a};b.prototype.Co=function(a){null==this.f&&(this.f=new Int32Array(0));var b=new Int32Array(this.ed*a);b.set(this.f,0);this.f=b;this.yd=a};return b}();a.$N=b;!0===a.Xh.Bm&&(a.ad=a.$N)})(D||(D={}));(function(a){var b;(function(a){a[a.enumInputModeBuildGraph=0]="enumInputModeBuildGraph";a[a.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate";a[a.enumInputModeSimplifyWinding=
5]="enumInputModeSimplifyWinding";a[a.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon"})(b||(b={}));var c=function(){function b(b){this.bf=b;this.Wh=NaN;this.qI=new a.Cg;this.rI=new a.Cg;this.it=new a.Ac;this.jt=new a.Ac}b.prototype.compare=function(a,b,d){a=a.ja(d);this.bf.QB(b,this.qI);this.bf.QB(a,this.rI);b=this.qI.get();a=this.rI.get();this.it.I(b.ua,b.sa);this.jt.I(a.ua,a.sa);if(this.it.ha<this.jt.ca)return-1;if(this.it.ca>this.jt.ha)return 1;d=b.ra==b.oa;var c=a.ra==a.oa;if(d||
c){if(d&&c)return 0;if(b.ra==a.ra&&b.ua==a.ua)return d?1:-1;if(b.oa==a.oa&&b.sa==a.sa)return d?-1:1}d=b.pf(this.Wh,this.it.ca);c=a.pf(this.Wh,this.jt.ca);d==c&&(d=Math.min(b.oa,a.oa),c=.5*(d+this.Wh),c==this.Wh&&(c=d),d=b.pf(c,this.it.ca),c=a.pf(c,this.jt.ca));return d<c?-1:d>c?1:0};b.prototype.RK=function(a){this.Wh=a};return b}(),e=function(){function b(b){this.bb=b;this.jJ=new a.Cg;this.cg=new a.b;this.cB=new a.Ac}b.prototype.eY=function(a){this.cg.L(a)};b.prototype.compare=function(a,b){this.bb.QB(a.ja(b),
this.jJ);a=this.jJ.get();this.cB.I(a.ua,a.sa);if(this.cg.x<this.cB.ca)return-1;if(this.cg.x>this.cB.ha)return 1;a=a.pf(this.cg.y,this.cg.x);return this.cg.x<a?-1:this.cg.x>a?1:0};return b}();b=function(){function b(){this.tI=this.cj=this.fj=this.TA=this.No=this.Ye=this.Rc=this.Eh=this.De=null;this.sp=this.Tg=-1;this.sI=!0;this.XA=!1;this.UA=NaN;this.mj=new a.$d;this.cQ=2147483647;this.bQ=a.J.truncate(-2147483648);this.xg=this.xe=this.km=this.rr=this.qn=this.qr=this.Jt=this.rf=-1;this.qa=0}b.prototype.ez=
function(a){this.UA=a};b.prototype.Mn=function(){null==this.De&&(this.De=new a.ad(8));var b=this.De.Pe();this.De.P(b,1,0);return b};b.prototype.fW=function(){null==this.Rc&&(this.Rc=new a.ad(8));var b=this.Rc.Pe();this.Rc.P(b,2,0);this.Rc.P(b,3,0);var d=this.Rc.Pe();this.Rc.P(d,2,0);this.Rc.P(d,3,0);this.zK(b,d);this.zK(d,b);return b};b.prototype.vJ=function(){null==this.Ye&&(this.Ye=new a.ad(8));var b=this.Ye.Pe();this.Ye.P(b,2,0);return b};b.prototype.QX=function(a,b){this.De.P(a,7,b)};b.prototype.bo=
function(a,b){this.De.P(a,2,b)};b.prototype.PX=function(a,b){this.De.P(a,1,b)};b.prototype.fY=function(a,b){this.De.P(a,3,b)};b.prototype.cY=function(a,b){this.De.P(a,4,b)};b.prototype.Vr=function(a,b){this.De.P(a,5,b)};b.prototype.WS=function(a){return this.De.S(a,5)};b.prototype.OX=function(a,b){this.De.P(a,6,b)};b.prototype.aP=function(a,b){this.OX(b,a)};b.prototype.yK=function(a,b){this.Rc.P(a,1,b)};b.prototype.zK=function(a,b){this.Rc.P(a,4,b)};b.prototype.ym=function(a,b){this.Rc.P(a,5,b)};
b.prototype.xm=function(a,b){this.Rc.P(a,6,b)};b.prototype.VX=function(a,b){this.Rc.P(a,2,b)};b.prototype.Nx=function(a,b){this.Rc.P(a,3,b)};b.prototype.WG=function(a){return this.Rc.S(a,3)};b.prototype.uu=function(a,b){this.Rc.P(a,7,b)};b.prototype.xL=function(a,b){if(-1!=this.$m(a))for(b=b?-1:a,a=this.$m(a);-1!=a;a=this.gt(a))this.a.Va(this.Uj(a),this.rr,b)};b.prototype.ey=function(a,b){-1!=a&&(this.xL(a,b),this.xL(this.Aa(a),b))};b.prototype.su=function(a,b){this.Ye.P(a,1,b)};b.prototype.rh=function(a,
b){this.Ye.P(a,2,b)};b.prototype.Zn=function(a,b){this.Ye.P(a,3,b);this.MX(a,this.VS(b));this.LX(b,a)};b.prototype.LX=function(a,b){this.Ye.P(a,4,b)};b.prototype.MX=function(a,b){this.Ye.P(a,5,b)};b.prototype.tK=function(a,b){this.Ye.P(a,6,b)};b.prototype.rK=function(a,b){this.Ye.P(a,7,b)};b.prototype.qK=function(a,b){this.No.write(a,b)};b.prototype.sK=function(a,b){this.TA.write(a,b)};b.prototype.hZ=function(b){var d=0,c=0,e=this.MG(b),h=new a.b,f=new a.b,l=new a.b;this.Ys(e,h);f.L(h);var g=e;do this.Zm(g,
l),c+=a.b.Cb(f,l),this.Ef(this.Aa(g))!=b&&(d+=(l.x-h.x-(f.x-h.x))*(l.y-h.y+(f.y-h.y))*.5),f.L(l),g=this.qc(g);while(g!=e);this.No.write(b,d);this.TA.write(b,c)};b.prototype.BW=function(b){var d=new c(this),h=new a.uk;h.Qe(a.J.truncate(this.qa/2));h.Ep(d);for(var f=new a.ia(0),l=this.xh(),g=null,k=0,m=new a.b,q=this.rf;-1!=q;q=this.og(q)){k++;var n=this.kf(q);if(-1!=n){f.yf(0);if(!this.aZ(h,l,f,n)){this.w(q,m);d.RK(m.y);var w=n;do{var x=this.Kb(w,l);-1!=x&&(h.Kd(x,-1),this.Ob(w,l,-2));w=this.qc(this.Aa(w))}while(n!=
w);w=n;do x=this.Kb(w,l),-1==x&&(x=h.addElement(w,-1),f.add(x)),w=this.qc(this.Aa(w));while(n!=w)}for(n=f.size-1;0<=n;n--)x=f.get(n),w=h.ja(x),this.Ob(this.Aa(w),l,x),this.AW(h,x,b)}else-1==this.Kz(q)&&(null==g&&(g=new e(this)),this.w(q,m),g.eY(m),w=h.HX(g),n=this.km,-1!=w&&(x=h.ja(w),this.Ef(x)==this.Ef(this.Aa(x))&&(x=this.YG(h,w)),-1!=x&&(n=this.Ef(x))),this.aP(n,q))}this.ni(l)};b.prototype.AW=function(a,b,d){var c=a.ja(b),e=this.Ef(c);if(-1==this.vo(e)){var h=this.YG(a,b),f=this.Aa(c),l=this.Ef(f);
this.Dq(e);this.Dq(l);var g=this.vo(e),k=this.vo(l);-1==h&&-1==g&&(l==e?(this.Zn(l,this.km),g=k=this.km):(-1==k&&(this.Zn(l,this.km),k=this.km),this.Zn(e,l),g=l));if(-1!=h){var m=this.Ef(h);-1==k&&(0>=this.Dq(m)?(k=this.vo(m),this.Zn(l,k)):(this.Zn(l,m),k=m),l==e&&(g=k))}-1==g&&this.bZ(e,l);0==d?this.$W(a,b,c,h,e,l):5==d?this.aX(a,b,c,f,e,l):4==d&&this.ZW(c,h,e,l)}};b.prototype.$W=function(a,b,d,c,e,f){var h=this.Ik(e);if(-1!=c){var l=this.Ik(f),g=this.Ik(this.Ef(c));c=h&l&g;g^=g&this.Ah(d);g|=c;
0!=g&&(this.rh(f,l|g),this.rh(e,g|h),h=h||g)}for(b=a.nb(b);-1!=b;b=a.nb(b)){c=a.ja(b);d=this.Ef(this.Aa(c));e=this.Ik(d);f=this.Ah(c);l=this.Ef(c);g=this.Ik(l);c=e&g&h;h^=h&f;h|=c;if(0==h)break;this.rh(d,e|h);this.rh(l,g|h)}};b.prototype.aX=function(b,d,c,e,f,l){if(f!=l){c=this.Kb(c,this.xg);c+=this.Kb(e,this.xg);e=0;var h=new a.ia(0),g=new a.ia(0);g.add(0);for(var k=b.xc(-1);k!=d;k=b.nb(k)){var m=b.ja(k),q=this.Aa(m),n=this.Ef(m),w=this.Ef(q);if(n!=w){m=this.Kb(m,this.xg);m+=this.Kb(q,this.xg);e+=
m;q=!1;0!=h.size&&h.Fc()==w&&(g.Pf(),h.Pf(),q=!0);if(-1==this.vo(w))throw a.g.za();q&&this.vo(w)==n||(g.add(e),h.add(n))}}e+=c;0!=h.size&&h.Fc()==l&&(g.Pf(),h.Pf());0!=e?0==g.Fc()&&(b=this.a.sd,b=this.Ia(b),this.rh(f,b)):0!=g.Fc()&&(b=this.a.sd,b=this.Ia(b),this.rh(f,b))}};b.prototype.ZW=function(a,b,d,c){var e=this.Ia(this.a.sd);if(-1==b)this.rh(c,this.sp),a=this.Kb(a,this.Tg),0!=(a&1)?this.rh(d,e):this.rh(d,this.sp);else{var h=this.Ik(c);0==h&&(h=this.Ik(this.Ef(b)),this.rh(c,h));a=this.Kb(a,this.Tg);
0!=(a&1)?this.rh(d,h==e?this.sp:e):this.rh(d,h)}};b.prototype.aZ=function(a,b,d,c){var e=c,h=-1,f=-1,l=0;do{if(2==l)return!1;var g=this.Kb(e,b);if(-1!=g){if(-1!=h)return!1;h=g}else{if(-1!=f)return!1;f=e}l++;e=this.qc(this.Aa(e))}while(c!=e);if(-1==f||-1==h)return!1;this.Ob(a.ja(h),b,-2);a.kk(h,f);d.add(h);return!0};b.prototype.bZ=function(a,b){var d=this.Dq(a);if(0!=d){var c=this.Dq(b);0<d&&0>c?this.Zn(a,b):0>d&&0<c?this.Zn(a,b):(d=this.vo(b),-1!=d&&this.Zn(a,d))}};b.prototype.tR=function(b,d){this.rr=
this.a.Vd();for(var c=0,e=d.size;c<e;c++){var h=d.get(c),f=this.a.Sa(h,this.qn),l=this.a.ng(this.a.ld(h)),g=this.a.hc(l);if(a.T.Ic(g)){var k=this.a.U(h);if(-1!=k){var m=this.a.Sa(k,this.qn);if(f!=m){var q=this.fW(),n=this.Aa(q),w=this.Eh.Pe();this.Eh.P(w,0,h);this.Eh.P(w,1,-1);this.uu(q,w);this.yK(q,f);w=this.kf(f);-1==w?(this.bo(f,q),this.ym(q,n),this.xm(n,q)):(f=this.Te(w),this.ym(w,n),this.xm(n,w),this.xm(f,q),this.ym(q,f));this.yK(n,m);f=this.kf(m);-1==f?(this.bo(m,n),this.xm(q,n),this.ym(n,q)):
(m=this.Te(f),this.ym(f,q),this.xm(q,f),this.xm(m,n),this.ym(n,m));l=this.Ia(l);0==b?(this.Ob(n,this.xe,0),this.Ob(q,this.xe,1736==g?l:0)):5==b?(m=new a.b,this.a.w(h,m),h=new a.b,this.a.w(k,h),f=k=0,0>m.compare(h)?k=1:f=-1,this.Ob(n,this.xe,0),this.Ob(q,this.xe,0),this.Ob(q,this.xg,k),this.Ob(n,this.xg,f)):7==b?(this.Ob(n,this.xe,this.sp),this.Ob(q,this.xe,1736==g?l:0)):4==b&&(this.Ob(n,this.xe,0),this.Ob(q,this.xe,0),this.Ob(q,this.Tg,1),this.Ob(n,this.Tg,1));g=1736==g?this.bQ:0;this.Nx(q,l|g);this.Nx(n,
l|g)}}}}};b.prototype.UV=function(a,b){var d=this.$m(b);if(-1!=d){var c=this.$m(a);this.Eh.P(d,1,c);this.uu(a,d);this.uu(b,-1)}a=this.Aa(a);b=this.Aa(b);d=this.$m(b);-1!=d&&(c=this.$m(a),this.Eh.P(d,1,c),this.uu(a,d),this.uu(b,-1))};b.prototype.CY=function(b){function d(a,b){return e.KQ(a,b)}var c=new a.ia(0);c.yb(10);for(var e=this,h=this.rf;-1!=h;h=this.og(h)){c.clear(!1);var f=this.kf(h);if(-1!=f){var l=f;do c.add(l),l=this.qc(this.Aa(l));while(l!=f);if(1<c.size){l=!0;if(2<c.size)c.Gd(0,c.size,
d),c.add(c.get(0));else if(0<this.JQ(c.get(0),c.get(1))){var g=c.get(0);c.set(0,c.get(1));c.set(1,g)}else l=!1;for(var k=g=c.get(0),m=this.Xf(k),q=this.Aa(k),n=-1,w=1,x=c.size;w<x;w++){var p=c.get(w),u=this.Aa(p),B=this.Kk(u);if(B==m&&p!=k){if(0==b)n=this.WG(k)|this.WG(p),this.Nx(k,n),this.Nx(q,n),this.Ob(k,this.xe,this.Kb(k,this.xe)|this.Kb(p,this.xe)),this.Ob(q,this.xe,this.Kb(q,this.xe)|this.Kb(u,this.xe));else if(-1!=this.xg)n=this.Kb(k,this.xg)+this.Kb(p,this.xg),u=this.Kb(q,this.xg)+this.Kb(u,
this.xg),this.Ob(k,this.xg,n),this.Ob(q,this.xg,u);else{if(7==b){this.mj=new a.$d(5,h,-1);return}-1!=this.Tg&&(n=this.Kb(k,this.Tg)+this.Kb(p,this.Tg),u=this.Kb(q,this.Tg)+this.Kb(u,this.Tg),this.Ob(k,this.Tg,n),this.Ob(q,this.Tg,u))}this.UV(k,p);this.sz(p);n=k;c.set(w,-1);p==g&&(c.set(0,-1),g=-1)}else this.ey(n,!1),n=-1,k=p,m=B,q=u}this.ey(n,!1);n=-1;if(l){g=-1;w=0;for(x=c.size;w<x;w++)if(p=c.get(w),-1!=p)if(-1==g)k=g=p,m=this.Xf(k),q=this.Aa(k);else if(p!=k&&(u=this.Aa(p),B=this.Kk(u),this.xm(q,
p),this.ym(p,q),k=p,m=B,q=u,7==b&&(this.Kb(p,this.xe)|this.Kb(this.Te(p),this.xe))==(this.sp|1))){this.mj=new a.$d(5,h,-1);return}this.bo(h,g)}else{g=-1;w=0;for(x=c.size;w<x;w++)if(p=c.get(w),-1!=p){g=p;break}f!=g&&this.bo(h,g)}}}}};b.prototype.ZP=function(){for(var b=-1,d=this.xh(),c=this.rf;-1!=c;c=this.og(c)){var e=this.kf(c);if(-1!=e){var f=e;do{if(1!=this.Kb(f,d)){var l=this.vJ();this.su(l,f);this.rK(l,b);-1!=b&&this.tK(b,l);var b=l,g=0,k=f;do g|=this.Kb(k,this.xe),this.VX(k,l),this.Ob(k,d,1),
k=this.qc(k);while(k!=f);this.rh(l,g)}f=this.qc(this.Aa(f))}while(f!=e)}}l=this.vJ();this.su(l,-1);this.rK(l,b);-1!=b&&this.tK(b,l);this.km=l;this.No=a.Rd.zd(this.Ye.size,NaN);this.TA=a.Rd.zd(this.Ye.size,NaN);this.qK(this.km,Infinity);this.sK(this.km,Infinity);this.ni(d)};b.prototype.iT=function(a,b,d){b=-1!=b?b:this.kf(a);if(-1==b)return-1;for(a=b;;){if(1!=this.Kb(b,d))return b;b=this.qc(this.Aa(b));if(b==a)return-1}};b.prototype.vX=function(){for(var a=this.xh(),b=this.rf;-1!=b;b=this.og(b))for(var d=
-1;;){var c=this.iT(b,d,a);if(-1==c)break;for(var d=this.qc(this.Aa(c)),e=c;;){var f=this.qc(e),l=this.Te(e),g=this.Aa(e);if(l==g){this.ER(e);if(d==e||d==g)d=-1;if(e==c||l==c){c=f;if(e==c||l==c)break;e=f;continue}}else this.Ob(e,a,1);e=f;if(e==c)break}}};b.prototype.mC=function(b,d,c,e){this.qh();this.sI=e;this.a=b;this.qr=this.a.hG();b=new a.ia(0);b.yb(null!=c?this.a.D(c.get(0)):this.a.vd);var h=0,f=1,l=null!=c?c.get(0):this.a.sd;for(e=1;-1!=l;){this.a.xK(l,this.qr,f);for(var f=f<<1,g=this.a.Pb(l);-1!=
g;g=this.a.Sb(g))for(var k=this.a.cb(g),m=0,q=this.a.La(g);m<q;m++)b.add(k),k=this.a.U(k);a.T.Jo(this.a.hc(l))||(h+=this.a.aa(l));null!=c?(l=e<c.size?c.get(e):-1,e++):l=this.a.Ue(l)}this.sp=f;this.qa=b.size;this.a.Xx(b,this.qa);null==this.Eh&&(this.Eh=new a.ad(2),this.De=new a.ad(8),this.Rc=new a.ad(8),this.Ye=new a.ad(8));this.Eh.Qe(this.qa);this.De.Qe(this.qa+10);this.Rc.Qe(2*this.qa+32);this.Ye.Qe(Math.max(32,h));this.qn=this.a.Vd();c=new a.b;e=0;h=new a.b;c.$c();for(f=0;f<=this.qa;f++)if(f<this.qa?
(k=b.get(f),this.a.w(k,h)):h.$c(),!c.ub(h)){if(e<f){k=this.Mn();for(q=m=-1;e<f;e++)q=b.get(e),this.a.Va(q,this.qn,k),l=this.Eh.Pe(),this.Eh.P(l,0,q),this.Eh.P(l,1,m),m=l,g=this.a.ld(q),l=this.a.ng(g),l=this.Ia(l),this.PX(k,this.Md(k)|l);this.QX(k,m);this.Vr(k,this.a.Za(q));-1!=this.Jt&&this.cY(this.Jt,k);this.fY(k,this.Jt);this.Jt=k;-1==this.rf&&(this.rf=k)}e=f;c.L(h)}this.xe=this.xh();5==d&&(this.xg=this.xh());4==d&&(this.Tg=this.xh());this.tR(d,b);0==this.mj.Ii&&(this.CY(d),0==this.mj.Ii&&(isNaN(this.UA)||
this.AQ()?(this.ZP(),0==this.mj.Ii&&(this.ni(this.xe),this.xe=-1,this.sI&&this.BW(d))):this.XA=!0))};b.prototype.sz=function(a){var b=this.qc(a),d=this.Te(a),c=this.Aa(a),e=this.qc(c),h=this.Te(c);b!=c&&(this.xm(h,b),this.ym(b,h));d!=c&&(this.xm(d,e),this.ym(e,d));d=this.Kk(a);this.kf(d)==a&&(e!=a?this.bo(d,e):this.bo(d,-1));e=this.Kk(c);this.kf(e)==c&&(b!=c?this.bo(e,b):this.bo(e,-1));this.Rc.kd(a);this.Rc.kd(c)};b.prototype.YG=function(a,b){for(;;)if(b=a.Ve(b),-1!=b){var d=a.ja(b);if(this.Ef(d)!=
this.Ef(this.Aa(d)))return d}else return-1};b.prototype.Wr=function(a,b,d){void 0===d&&(d=!0);this.mC(a,0,null,d)};b.prototype.mK=function(b,d){var c=new a.ia(0);c.add(d);this.mC(b,4,c,1736==b.hc(d))};b.prototype.nK=function(b,d){var c=new a.ia(0);c.add(d);this.mC(b,5,c,!0)};b.prototype.qh=function(){null!=this.a&&(-1!=this.qr&&(this.a.uX(this.qr),this.qr=-1),-1!=this.qn&&(this.a.le(this.qn),this.qn=-1),-1!=this.rr&&(this.a.le(this.rr),this.rr=-1),-1!=this.xe&&(this.ni(this.xe),this.xe=-1),-1!=this.xg&&
(this.ni(this.xg),this.xg=-1),-1!=this.Tg&&(this.ni(this.Tg),this.Tg=-1),this.a=null,this.De.Vi(!0),this.Eh.Vi(!0),this.Jt=this.rf=-1,null!=this.Rc&&this.Rc.Vi(!0),null!=this.fj&&(this.fj.length=0),null!=this.cj&&(this.cj.length=0),null!=this.tI&&(this.tI.length=0),null!=this.Ye&&this.Ye.Vi(!0),this.km=-1,this.No=null)};b.prototype.kf=function(a){return this.De.S(a,2)};b.prototype.w=function(a,b){this.a.pH(this.WS(a),b)};b.prototype.Md=function(a){return this.De.S(a,1)};b.prototype.og=function(a){return this.De.S(a,
4)};b.prototype.Kz=function(a){return this.De.S(a,6)};b.prototype.Ym=function(a){return this.De.S(a,7)};b.prototype.gt=function(a){return this.Eh.S(a,1)};b.prototype.Uj=function(a){return this.Eh.S(a,0)};b.prototype.Hg=function(a,b){b=this.cj[b];return b.size<=a?-1:b.read(a)};b.prototype.co=function(a,b,d){b=this.cj[b];b.size<=a&&b.resize(this.De.size,-1);b.write(a,d)};b.prototype.wq=function(){null==this.cj&&(this.cj=[]);for(var b=a.ia.zd(this.De.yd,-1),d=0,c=this.cj.length;d<c;d++)if(null==this.cj[d])return this.cj[d]=
b,d;this.cj.push(b);return this.cj.length-1};b.prototype.xq=function(a){this.cj[a]=null};b.prototype.Kk=function(a){return this.Rc.S(a,1)};b.prototype.Xf=function(a){return this.Kk(this.Aa(a))};b.prototype.Aa=function(a){return this.Rc.S(a,4)};b.prototype.Te=function(a){return this.Rc.S(a,5)};b.prototype.qc=function(a){return this.Rc.S(a,6)};b.prototype.Ef=function(a){return this.Rc.S(a,2)};b.prototype.Ff=function(a){return this.Ik(this.Rc.S(a,2))};b.prototype.$m=function(a){return this.Rc.S(a,7)};
b.prototype.Ys=function(a,b){this.w(this.Kk(a),b)};b.prototype.Zm=function(a,b){this.w(this.Xf(a),b)};b.prototype.Ah=function(a){return this.Rc.S(a,3)&this.cQ};b.prototype.Kb=function(a,b){b=this.fj[b];return b.size<=a?-1:b.read(a)};b.prototype.Ob=function(a,b,d){b=this.fj[b];b.size<=a&&b.resize(this.Rc.size,-1);b.write(a,d)};b.prototype.xh=function(){null==this.fj&&(this.fj=[]);for(var b=a.ia.zd(this.Rc.yd,-1),d=0,c=this.fj.length;d<c;d++)if(null==this.fj[d])return this.fj[d]=b,d;this.fj.push(b);
return this.fj.length-1};b.prototype.ni=function(a){this.fj[a]=null};b.prototype.ER=function(a){var b=this.Ef(a),d=this.qc(a);d==this.Aa(a)&&(d=this.qc(d),d==a&&(d=-1));this.MG(b)==a&&this.su(b,d);d=this.No.read(b);isNaN(d)||(this.qK(b,NaN),this.sK(b,NaN));this.ey(a,!0);this.sz(a)};b.prototype.FR=function(a){for(var b=0,d=a.size;b<d;b++){var c=a.get(b),e=this.Ef(this.Aa(c));this.su(this.Ef(c),-1);this.su(e,-1);this.ey(c,!0);this.sz(c)}};b.prototype.MG=function(a){return this.Ye.S(a,1)};b.prototype.Ik=
function(a){return this.Ye.S(a,2)};b.prototype.vo=function(a){return this.Ye.S(a,3)};b.prototype.VS=function(a){return this.Ye.S(a,4)};b.prototype.Dq=function(a){var b=this.No.read(a);isNaN(b)&&(this.hZ(a),b=this.No.read(a));return b};b.prototype.Ia=function(a){return this.a.VG(a,this.qr)};b.prototype.jf=function(a){return this.a.Sa(a,this.qn)};b.prototype.lT=function(a){return this.a.Sa(a,this.rr)};b.prototype.kT=function(a,b){var d=this.kf(a);if(-1==d)return-1;var c=d,e=-1,h=-1;do{if(this.Xf(c)==
b)return c;if(-1==e){e=this.kf(b);if(-1==e)break;h=e}if(this.Xf(h)==a)return c=this.Aa(h);c=this.qc(this.Aa(c));h=this.qc(this.Aa(h))}while(c!=d&&h!=e);return-1};b.prototype.QB=function(b,d){d.Js();d=d.get();var c=new a.b;this.Ys(b,c);d.Mc(c);this.Zm(b,c);d.Zc(c)};b.prototype.KQ=function(b,d){if(b==d)return 0;var c=new a.b;this.Zm(b,c);var e=new a.b;this.Zm(d,e);if(c.ub(e))return 0;d=new a.b;this.Ys(b,d);b=new a.b;b.zc(c,d);c=new a.b;c.zc(e,d);return a.b.vs(b,c)};b.prototype.JQ=function(b,d){if(b==
d)return 0;var c=new a.b;this.Zm(b,c);var e=new a.b;this.Zm(d,e);if(c.ub(e))return 0;d=new a.b;this.Ys(b,d);b=new a.b;b.zc(c,d);c=new a.b;c.zc(e,d);return 0<=c.y&&0<b.y?a.b.vs(b,c):0};b.prototype.AQ=function(){for(var b=a.Ub.Yx(this.UA),d=new a.b,c=new a.b,e=new a.b,f=new a.b,l=new a.b,g=this.rf;-1!=g;g=this.og(g)){var k=this.kf(g);if(-1!=k){var m=k;this.Ys(m,d);this.Zm(m,c);l.zc(c,d);var q=l.qk();do{var n=m,m=this.qc(this.Aa(m));if(m!=n){this.Zm(m,e);f.zc(e,d);var n=f.qk(),w=f.Ui(l);if(w*w/(n*q)*
Math.min(n,q)<=b)return!1;l.L(f);q=n;c.L(e)}}while(m!=k)}}return!0};return b}();a.Qu=b})(D||(D={}));(function(a){var b=function(){function b(){this.i=null;this.AI=new a.b;this.BI=new a.b;this.Mh=null;this.pt=!1;this.Wo=-1}b.prototype.Gf=function(a){return a<this.Mh.length?this.Mh[a]:!1};b.prototype.Hl=function(b,d,c,e){var h=a.T.lf(this.i.a.hc(c));if(2==a.T.lf(this.i.a.hc(d))&&1==h)this.zR(b,d,c,e);else throw a.g.za();};b.prototype.Wr=function(b,d){null==this.i&&(this.i=new a.Qu);this.i.Wr(b,d)};
b.prototype.Xr=function(b,d,c){a.sk.V(b,d,c,!0);for(d=b.sd;-1!=d;d=b.Ue(d))1736==b.hc(d)&&a.lo.V(b,d,-1,this.pt,c);this.Wr(b,c)};b.prototype.SF=function(a,b,c,e,f){var d=this.i.a;if(1736==d.hc(a))for(a=d.Pb(a);-1!=a;a=d.Sb(a)){var h=d.cb(a);this.i.jf(h);this.i.jf(d.U(h));var l=this.i.lT(h);if(-1!=l){var g=this.i.Kb(l,c);if(1!=g&&2!=g)if(this.Gf(this.i.Ff(l))){this.i.Ob(l,c,1);var g=d.Yf(b,-1),k=l,m=this.i.jf(h),q=1;do{var n=this.gn(h,f);d.Kj(g,n);-1!=e&&this.i.co(m,e,1);this.i.Ob(k,c,1);var k=this.i.qc(k),
w;do n=1==q?d.U(h):d.Ra(h),w=-1!=n?this.i.jf(n):-1;while(w==m);var x=this.i.Kk(k);if(x!=w){do n=1==q?d.Ra(h):d.U(h),w=-1!=n?this.i.jf(n):-1;while(w==m);x!=w?(w=x,n=this.i.Uj(this.i.Ym(w))):q=-q}m=w;h=n}while(k!=l);d.$n(g,!0)}else this.i.Ob(l,c,2)}}};b.prototype.nG=function(){for(var b=this.i.xh(),d=new a.ia(0),c=this.i.rf;-1!=c;c=this.i.og(c)){var e=this.i.kf(c),f=e;if(-1!=e){do{if(1!=this.i.Kb(f,b)){var g=this.i.Aa(f);this.i.Ob(g,b,1);this.i.Ob(f,b,1);this.Gf(this.i.Ff(f))&&this.Gf(this.i.Ff(g))&&
d.add(f)}f=this.i.qc(this.i.Aa(f))}while(f!=e)}}this.i.ni(b);this.i.FR(d)};b.prototype.gn=function(a,b){return-1==b?a:this.VT(a,b)};b.prototype.VT=function(a,b){var d=this.i.a,c,e,f=this.i.Ym(this.i.jf(a));do{c=this.i.Uj(f);e=d.ng(d.ld(c));if(e==b)return c;f=this.i.gt(f)}while(-1!=f);return a};b.prototype.es=function(b,d,c){this.nG();var e=this.i.a,h=e.bh(1736),f=this.i.xh();this.hL(b,d,h,c,f,-1);this.i.ni(f);a.lo.V(e,h,1,this.pt,null);return h};b.prototype.hL=function(a,b,c,e,f,g){this.SF(a,c,f,
g,e);-1!=b&&this.SF(b,c,f,g,e);a=this.i.a;for(b=this.i.rf;-1!=b;b=this.i.og(b)){var d=this.i.kf(b);if(-1!=d){var h=d;do{var l=this.i.Kb(h,f);if(1!=l&&2!=l)if(this.Gf(this.i.Ff(h))){var l=a.Yf(c,-1),k=h;do{var m=this.i.$m(k);-1!=m?m=this.i.Uj(m):(m=this.i.Uj(this.i.$m(this.i.Aa(k))),m=this.i.a.U(m));m=this.gn(m,e);a.Kj(l,m);this.i.Ob(k,f,1);-1!=g&&(m=this.i.jf(m),this.i.co(m,g,1));k=this.i.qc(k)}while(k!=h);a.$n(l,!0)}else this.i.Ob(h,f,2);h=this.i.qc(this.i.Aa(h))}while(h!=d)}}};b.prototype.UY=function(b,
d,c){var e=this.i.a,h=e.bh(1736),f=e.bh(1607),l=e.bh(550);this.nG();var g=-1,k=this.i.xh(),m=this.i.wq();this.hL(b,d,h,c,k,m);for(b=this.i.rf;-1!=b;b=this.i.og(b))if(d=this.i.kf(b),-1!=d){var q=d;do{var n=this.i.Kb(q,k),w=this.i.Kb(this.i.Aa(q),k),n=n|w;if(2==n)if(n=this.i.Ah(q),this.Gf(n)){var x=e.Yf(f,-1),p=q,n=this.Jx(b,e),n=this.gn(n,c);e.Kj(x,n);this.i.co(b,m,1);do{n=this.i.Xf(p);w=this.Jx(n,e);w=this.gn(w,c);e.Kj(x,w);this.i.Ob(p,k,1);this.i.Ob(this.i.Aa(p),k,1);this.i.co(n,m,1);p=this.i.qc(p);
n=this.i.Kb(p,k);w=this.i.Kb(this.i.Aa(p),k);n|=w;if(2!=n)break;n=this.i.Ah(p);if(!this.Gf(n)){this.i.Ob(p,k,1);this.i.Ob(this.i.Aa(p),k,1);break}}while(p!=q)}else this.i.Ob(q,k,1),this.i.Ob(this.i.Aa(q),k,1);q=this.i.qc(this.i.Aa(q))}while(q!=d)}for(b=this.i.rf;-1!=b;b=this.i.og(b))n=this.i.Hg(b,m),1!=n&&(n=this.i.Md(b),this.Gf(n)&&(-1==g&&(g=e.Yf(l,-1)),d=this.i.Ym(b),-1!=d&&(d=this.i.Uj(d),n=this.gn(d,c),e.Kj(g,n))));this.i.xq(m);this.i.ni(k);a.lo.V(e,h,1,this.pt,null);c=[];c[0]=l;c[1]=f;c[2]=
h;return c};b.prototype.Jx=function(a,b){var d=-1;for(a=this.i.Ym(a);-1!=a;a=this.i.gt(a)){var c=this.i.Uj(a);-1==d&&(d=c);var e=this.i.Ia(b.ng(b.ld(c)));if(this.Gf(e)){d=c;break}}return d};b.prototype.NB=function(b,d){for(var c=this.i.Kk(d),e=this.i.Xf(d),f=0,l=0,g=this.i.Ym(c);-1!=g;g=this.i.gt(g)){var k=this.i.Uj(g),m=b.ld(k),q=this.i.Ia(b.ng(m)),n=b.U(k),w=b.Ra(k),m=b.cb(m);m==k&&(this.Wo=d);-1!=n&&this.i.jf(n)==e?(f++,this.Gf(q)&&(m==n&&(this.Wo=this.i.qc(d)),l++)):-1!=w&&this.i.jf(w)==e&&(f--,
this.Gf(q)&&(m==w&&(this.Wo=this.i.qc(d)),l--))}this.i.w(c,this.AI);this.i.w(e,this.BI);c=a.b.Cb(this.AI,this.BI);return(0!=l?l:f)*c};b.prototype.Fq=function(a){return this.i.Ah(a)|this.i.Ff(a)|this.i.Ff(this.i.Aa(a))};b.prototype.mL=function(a){for(var b=this.i.Aa(this.i.Te(a)),c=-1;b!=a;){if(this.Gf(this.Fq(b))){if(-1!=c)return-1;c=b}b=this.i.Aa(this.i.Te(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.nL=function(a){for(var b=this.i.Aa(this.i.qc(a)),c=-1;b!=a;){if(this.Gf(this.Fq(b))){if(-1!=c)return-1;
c=b}b=this.i.Aa(this.i.qc(b))}return-1!=c?this.i.Aa(c):-1};b.prototype.cK=function(b,d,c,e,f){var h=this.i.a,l=b,g=this.i.Aa(l);this.i.Ob(l,c,1);this.i.Ob(g,c,1);var k=this.NB(h,l);this.Wo=-1;for(var m=l,q=-1,n=!1,w=1;;){var x=this.i.Te(l);if(x==g)break;g=this.i.qc(g);if(this.i.Aa(x)!=g)if(l=this.mL(l),-1==l)break;else n=!0,g=this.i.Aa(l);else l=x;if(l==b){q=b;break}x=this.Fq(l);if(!this.Gf(x))break;this.i.Ob(l,c,1);this.i.Ob(g,c,1);m=l;k+=this.NB(h,l);w++}if(-1==q)for(l=b,g=this.i.Aa(l),q=l;;){b=
this.i.qc(l);if(b==g)break;g=this.i.Te(g);if(this.i.Aa(b)!=g)if(l=this.nL(l),-1==l){n=!0;break}else g=this.i.Aa(l);else l=b;x=this.Fq(l);if(!this.Gf(x))break;this.i.Ob(l,c,1);this.i.Ob(g,c,1);q=l;k+=this.NB(h,l);w++}else if(-1!=this.Wo&&(m=this.Wo,q=this.i.Te(this.Wo),this.i.Aa(q)!=this.i.qc(this.i.Aa(m))&&(q=this.mL(m),-1==q)))throw a.g.za();0<=k||(l=q,q=this.i.Aa(m),m=this.i.Aa(l));c=h.Yf(d,-1);l=m;m=this.i.Kk(m);n=this.i.Xf(q)==m&&n;k=this.Jx(m,h);k=this.gn(k,f);h.Kj(c,k);-1!=e&&this.i.co(m,e,
1);m=0;for(w=n?a.J.truncate((w+1)/2):-1;;){b=this.i.Xf(l);k=this.Jx(b,h);k=this.gn(k,f);h.Kj(c,k);m++;-1!=e&&this.i.co(b,e,1);n&&m==w&&(c=h.Yf(d,-1),h.Kj(c,k));if(l==q)break;b=this.i.qc(l);if(this.i.Te(this.i.Aa(l))!=this.i.Aa(b)){if(l=this.nL(l),-1==l)throw a.g.za();}else l=b}};b.prototype.fs=function(a){for(var b=this.i.a.bh(1607),c=this.i.xh(),e=this.i.rf;-1!=e;e=this.i.og(e)){var f=this.i.kf(e),l=f;do 1!=this.i.Kb(l,c)&&this.Gf(this.Fq(l))&&this.cK(l,b,c,-1,a),l=this.i.qc(this.i.Aa(l));while(l!=
f)}this.i.ni(c);return b};b.prototype.VY=function(a){for(var b=this.i.a,c=b.bh(1607),e=b.bh(550),f=this.i.xh(),l=this.i.wq(),g=-1,k=this.i.rf;-1!=k;k=this.i.og(k)){var m=this.i.kf(k),q=m;do{var n=this.i.Kb(q,f);1!=n&&(n=this.Fq(q),this.Gf(n)&&this.cK(q,c,f,l,a));q=this.i.qc(this.i.Aa(q))}while(q!=m)}for(k=this.i.rf;-1!=k;k=this.i.og(k))n=this.i.Hg(k,l),1!=n&&(n=this.i.Md(k),this.Gf(n)&&(-1==g&&(g=b.Yf(e,-1)),m=this.i.Ym(k),-1!=m&&(m=this.i.Uj(m),m=this.gn(m,a),b.Kj(g,m))));this.i.ni(f);this.i.xq(l);
a=[];a[0]=e;a[1]=c;return a};b.prototype.Qp=function(){for(var a=this.i.a,b=a.bh(550),c=a.Yf(b,-1),e=this.i.rf;-1!=e;e=this.i.og(e))if(this.Gf(this.i.Md(e))){for(var f=-1,g=this.i.Ym(e);-1!=g;g=this.i.gt(g)){var k=this.i.Uj(g);-1==f&&(f=k);var m=this.i.Ia(a.ng(a.ld(k)));if(this.Gf(m)){f=k;break}}a.Kj(c,f)}return b};b.prototype.Do=function(a){this.Mh=[];for(var b=0;b<a;b++)this.Mh[b]=!1};b.vD=function(b,d,c,e){var h=b.Ka(),f=Array(1E3);a.J.Nv(f,null);var l=a.J.gf(1E3,0),g=b.D(),k=!0,m=2==d.tb();if(1!=
d.tb()&&2!=d.tb())throw a.g.za();for(var q=0;q<g;){var n=a.J.truncate(b.eX(f,q)-q);m?a.gd.fL(d,f,n,c,l):a.gd.gL(d,f,n,c,l);for(var w=0,x=0;x<n;x++){var p=0==l[x];e||(p=!p);p&&(k&&(k=!1,h.Id(b,0,q)),w!=x&&h.Id(b,q+w,q+x),w=x+1)}k||w==n||h.Id(b,q+w,q+n);q+=n}return k?b:h};b.MH=function(c,d,e){return c instanceof a.Ed?b.vD(c,d,e,!0):d instanceof a.Wa?c.u()||d.u()?c.Ka():a.sk.yJ(e,c,d)?a.sk.FQ(c,d):c.Ka():b.xD(c,d,e,!0)};b.nw=function(c,d,e,f){var h=new a.h;c.s(h);var l=new a.h;d.s(l);var g=new a.h;g.I(h);
g.Nb(l);e=a.na.be(e,g,!0);g=new a.h;g.I(l);l=a.na.Cs(e);g.O(l,l);if(!h.Yb(g)){if(c.tb()<=d.tb())return b.bd(b.Bb(c.Ka()),c,"\x26");if(c.tb()>d.tb())return b.bd(b.Bb(d.Ka()),c,"\x26")}l=new b;h=new a.fd;g=h.Jb(b.Bb(c));d=h.Jb(b.Bb(d));l.Xr(h,e,f);f=l.nw(g,d);c=b.bd(h.Se(f),c,"\x26");a.T.Ic(c.G())&&(c.Zg(2,e),1736==c.G()&&c.Al());return c};b.xD=function(b,d,c,e){if(b.u())return b.Ka();if(d.u())return e?b.Ka():null;var h=[null],f=[0],l=2==d.tb();if(1!=d.tb()&&2!=d.tb())throw a.g.za();h[0]=b.w();l?a.gd.fL(d,
h,1,c,f):a.gd.gL(d,h,1,c,f);d=0==f[0];e||(d=!d);return d?b.Ka():b};b.TZ=function(c,d,e){return c instanceof a.Ed?b.vD(c,d,e,!1):d instanceof a.Wa?c.u()?c.Ka():d.u()?c:a.sk.yJ(e,c,d)?c.Ka():c:b.xD(c,d,e,!1)};b.prototype.DJ=function(b,d,c,e,f){if(b.u())return b;var h=new a.fd;b=h.Jb(b);return this.ol(h,b,d,c,e,f)};b.prototype.zW=function(b,d,c,e,f,g){if(f&&550!=b.hc(d)){var h=new a.WD;h.MY(b,c);h.ih?(a.sk.V(b,c,g,!0),f=!1):this.i.ez(c)}else a.sk.V(b,c,g,!0),f=!1;e&&550!=b.hc(d)?this.i.nK(b,d):this.i.mK(b,
d);if(this.i.XA)return this.i.qh(),this.i=null,this.ol(b,d,c,e,!1,g);this.i.ez(NaN);g=this.i.Ia(d);this.Do(g+1);this.Mh[g]=!0;if(1736==b.hc(d)||e&&550!=b.hc(d))return b.Hp(d,0),d=this.es(d,-1,-1),b=b.Se(d),b.Hp(0),f?b.Zg(1,0):(b.Zg(2,c),b.Al()),b;if(1607==b.hc(d))return d=this.fs(-1),b=b.Se(d),f||b.Zg(2,c),b;if(550==b.hc(d))return d=this.Qp(),b=b.Se(d),f||b.Zg(2,c),b;throw a.g.za();};b.prototype.ol=function(b,d,c,e,f,g){this.i=new a.Qu;try{return this.zW(b,d,c,e,f,g)}finally{this.i.qh()}};b.ol=function(a,
d,c,e,f){return(new b).DJ(a,d,c,e,f)};b.prototype.yW=function(b,d,c){this.pt=b;this.i=new a.Qu;b=d.xo(c);var e=d.hc(c);1!=b||550==e?this.i.mK(d,c):this.i.nK(d,c);if(!this.i.XA)if(this.i.ez(NaN),e=this.i.Ia(c),this.Do(e+1),this.Mh[e]=!0,1736==d.hc(c)||1==b&&550!=d.hc(c))d.Hp(c,0),b=this.es(c,-1,-1),d.EC(b,c),d.aC(b);else if(1607==d.hc(c))b=this.fs(-1),d.EC(b,c),d.aC(b);else if(550==d.hc(c))b=this.Qp(),d.EC(b,c),d.aC(b);else throw a.g.X("internal error");};b.DC=function(a,d,c,e){var h=new b;h.pt=!0;
return h.DJ(a,d,!1,c,e)};b.prototype.Vm=function(b,d){var c=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(d));if(c>e)return b;var f=this.i.Ia(b),l=this.i.Ia(d);this.Do((f|l)+1);this.Mh[this.i.Ia(b)]=!0;if(2==c&&2==e)return this.es(b,d,-1);if(1==c&&2==e||1==c&&1==e)return this.fs(-1);if(0==c)return this.Qp();throw a.g.za();};b.prototype.mG=function(b,d){var c=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(d));if(c>e)return b;if(c<e)return d;var f=this.i.Ia(b),l=this.i.Ia(d);this.Do((f|l)+1);this.Mh[this.i.Ia(b)]=
!0;this.Mh[this.i.Ia(d)]=!0;this.Mh[this.i.Ia(b)|this.i.Ia(d)]=!0;if(2==c&&2==e)return this.es(b,d,-1);if(1==c&&1==e)return this.fs(-1);if(0==c&&0==e)return this.Qp();throw a.g.za();};b.prototype.nw=function(b,d){var c=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(d)),f=this.i.Ia(b),l=this.i.Ia(d);this.Do((f|l)+1);this.Mh[this.i.Ia(b)|this.i.Ia(d)]=!0;f=-1;1<this.i.a.Hr.Ga&&(f=b);if(2==c&&2==e)return this.es(b,d,f);if(1==c&&0<e||1==e&&0<c)return this.fs(f);if(0==c||0==e)return this.Qp();throw a.g.za();
};b.prototype.vA=function(b,d){var c=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(d)),f=this.i.Ia(b),l=this.i.Ia(d);this.Do((f|l)+1);this.Mh[this.i.Ia(b)|this.i.Ia(d)]=!0;f=-1;1<this.i.a.Hr.Ga&&(f=b);if(2==c&&2==e)return this.UY(b,d,f);if(1==c&&0<e||1==e&&0<c)return this.VY(f);if(0==c||0==e)return c=[],c[0]=this.Qp(),c;throw a.g.za();};b.prototype.Pp=function(b,d){var c=a.T.lf(this.i.a.hc(b)),e=a.T.lf(this.i.a.hc(d)),f=this.i.Ia(b),l=this.i.Ia(d);this.Do((f|l)+1);this.Mh[this.i.Ia(b)]=!0;this.Mh[this.i.Ia(d)]=
!0;if(2==c&&2==e)return this.es(b,d,-1);if(1==c&&1==e)return this.fs(-1);if(0==c&&0==e)return this.Qp();throw a.g.za();};b.Bb=function(b){var d=b.G();return 197==d?(d=new a.Ja(b.description),b.u()||d.jd(b,!1),d):33==d?(d=new a.Ed(b.description),b.u()||d.add(b),d):322==d?(d=new a.Ua(b.description),b.u()||d.dc(b,!0),d):b};b.bd=function(b,d,c){var e=b.G();return 197==e?(d=new a.Ja(b.description),b.u()||d.jd(b,!1),d):33!=e||"|"!=c&&"^"!=c?322==e?(d=new a.Ua(b.description),b.u()||d.dc(b,!0),d):33==e&&
"-"==c&&33==d.G()||550==e&&"\x26"==c&&33==d.G()?(d=new a.Wa(b.description),b.u()||b.Ae(0,d),d):b:(d=new a.Ed(b.description),b.u()||d.add(b),d)};b.Vm=function(c,d,e,f){if(c.u()||d.u()||c.tb()>d.tb())return b.bd(b.Bb(c),c,"-");var h=new a.h;c.s(h);var l=new a.h;d.s(l);if(!h.Yb(l))return b.bd(b.Bb(c),c,"-");var g=new a.h;g.I(h);g.Nb(l);e=a.na.be(e,g,!0);l=new b;h=new a.fd;g=h.Jb(b.Bb(c));d=h.Jb(b.Bb(d));l.Xr(h,e,f);f=l.Vm(g,d);f=h.Se(f);c=b.bd(f,c,"-");a.T.Ic(c.G())&&(c.Zg(2,e),1736==c.G()&&c.Al());
return c};b.mG=function(c,d,e,f){if(c.tb()>d.tb())return b.bd(b.Bb(c),c,"|");if(c.tb()<d.tb()||c.u())return b.bd(b.Bb(d),c,"|");if(d.u())return b.bd(b.Bb(c),c,"|");var h=new a.h;c.s(h);var l=new a.h;d.s(l);var g=new a.h;g.I(h);g.Nb(l);e=a.na.be(e,g,!0);if(!h.Yb(l.nT(e,e)))switch(c=b.Bb(c),d=b.Bb(d),c.G()){case 550:return c=a.T.oe(c),c.Id(d,0,-1),c;case 1607:return c=a.T.oe(c),c.add(d,!1),c;case 1736:return c=a.T.oe(c),c.add(d,!1),c;default:throw a.g.za();}l=new b;h=new a.fd;g=h.Jb(b.Bb(c));d=h.Jb(b.Bb(d));
l.Xr(h,e,f);d=l.mG(g,d);c=b.bd(h.Se(d),c,"|");a.T.Ic(c.G())&&(c.Zg(2,e),1736==c.G()&&c.Al());return c};b.RR=function(c,d,e){if(2>c.length)throw a.g.F("not enough geometries to dissolve");for(var h=0,f=0,l=c.length;f<l;f++)h=Math.max(c[f].tb(),h);var g=new a.h;g.Oa();for(var k=new a.fd,m=-1,q=0,n=-1,f=0,l=c.length;f<l;f++)if(c[f].tb()==h)if(c[f].u())-1==n&&(n=f);else{n=f;-1==m?m=k.Jb(b.Bb(c[f])):k.wP(m,b.Bb(c[f]));var w=new a.h;c[f].ac(w);g.Nb(w);q++}if(2>q)return b.Bb(c[n]);c=2==h;d=a.na.be(0==h?
d:null,g,!0);return(new b).ol(k,m,d,c,!0,e)};b.vA=function(c,d,e,f){var h=[null,null,null],l=new a.h;c.s(l);var g=new a.h;d.s(g);var k=new a.h;k.I(l);k.Nb(g);e=a.na.be(e,k,!0);k=new a.h;k.I(g);g=a.na.Cs(e);k.O(g,g);if(!l.Yb(k)){if(c.tb()<=d.tb())return c=b.bd(b.Bb(c.Ka()),c,"\x26"),h[c.tb()]=c,h;if(c.tb()>d.tb())return c=b.bd(b.Bb(d.Ka()),c,"\x26"),h[c.tb()]=c,h}g=new b;l=new a.fd;k=l.Jb(b.Bb(c));d=l.Jb(b.Bb(d));g.Xr(l,e,f);f=g.vA(k,d);for(d=0;d<f.length;d++)g=b.bd(l.Se(f[d]),c,"\x26"),a.T.Ic(g.G())&&
(g.Zg(2,e),1736==g.G()&&g.Al()),h[g.tb()]=g;return h};b.Pp=function(c,d,e,f){if(c.tb()>d.tb())return b.bd(b.Bb(c),c,"^");if(c.tb()<d.tb()||c.u())return b.bd(b.Bb(d),c,"^");if(d.u())return b.bd(b.Bb(c),c,"^");var h=new a.h;c.s(h);var l=new a.h;d.s(l);var g=new a.h;g.I(h);g.Nb(l);e=a.na.be(e,g,!0);l=new b;h=new a.fd;g=h.Jb(b.Bb(c));d=h.Jb(b.Bb(d));l.Xr(h,e,f);f=l.Pp(g,d);c=b.bd(h.Se(f),c,"^");a.T.Ic(c.G())&&(c.Zg(2,e),1736==c.G()&&c.Al());return c};b.M_=function(b,d,c){d=d.G();c=c.G();return 550==b.G()&&
(33==d||33==c)&&1>=b.D()?(c=new a.Wa(b.description),b.u()||b.Ae(0,c),c):b};b.prototype.AS=function(a,b){var d=this.i.a;a=d.Yf(a,-1);for(var c=b.size,e=0;e<c;e++){var f=b.get(e);d.Kj(a,f)}d.$n(a,!0)};b.prototype.WX=function(a,b){for(var d=this.i.a,c=d.sd;-1!=c;c=d.Ue(c))if(c==b)for(var e=d.Pb(c);-1!=e;e=d.Sb(e)){var f=d.cb(e);if(-1!=f)for(var l=d.U(f);-1!=l;){var f=this.i.jf(f),g=this.i.jf(l),f=this.i.kT(f,g);-1!=f&&(g=this.i.Aa(f),this.i.Ob(f,a,1),this.i.Ob(g,a,2));f=l;l=d.U(f)}}};b.prototype.TW=
function(b,d,c,e){c=this.i.Ia(c);e=this.i.Ia(e);var h=new a.ia(0);h.yb(256);for(var f=this.i.a,l=this.i.xh(),g=this.i.rf;-1!=g;g=this.i.og(g)){var k=this.i.kf(g);if(-1!=k){var m=k;do{if(1!=this.i.Kb(m,l)){var q=m,n=m,w=!1,x=0;do{this.i.Ob(q,l,1);if(!w){var p=this.i.Ah(q);0!=(p&e)&&0!=(this.i.Ff(q)&c)&&(n=q,w=!0)}w&&(h.add(this.i.Uj(this.i.Ym(this.i.Kk(q)))),-1!=b&&(p=this.i.Ah(q),0!=(p&e)&&(p=this.i.Kb(q,b),x|=p)));q=this.i.qc(q)}while(q!=n);w&&0<this.i.Dq(this.i.Ef(n))&&(q=f.bh(1736),this.AS(q,h),
-1!=d&&f.xK(q,d,x));h.clear(!1)}m=this.i.qc(this.i.Aa(m))}while(m!=k)}}this.i.ni(l)};b.prototype.zR=function(a,b,c,e){this.i.vX();var d=-1;-1!=a&&(d=this.i.xh(),this.WX(d,c));this.TW(d,a,b,c);var h=this.i.a;a=0;for(d=h.sd;-1!=d;d=h.Ue(d))d!=b&&d!=c&&(e.add(d),a++);e.Gd(0,a,function(a,b){a=h.gA(h.Pb(a));b=h.gA(h.Pb(b));return a<b?-1:a==b?0:1})};b.prototype.qh=function(){null!=this.i&&(this.i.qh(),this.i=null)};return b}();a.Dg=b})(D||(D={}));(function(a){var b=function(){function b(a){void 0!==a?this.Op(a):
this.pC()}b.prototype.Vx=function(){this.bc=this.Wb=this.zb=this.sb=this.gb=this.lb=0};b.prototype.Eb=function(a){return this==a?!0:a instanceof b?this.lb==a.lb&&this.sb==a.sb&&this.Wb==a.Wb&&this.zb==a.zb&&this.gb==a.gb&&this.bc==a.bc:!1};b.prototype.jc=function(){a.J.Zi();a.J.Zi();a.J.Zi();a.J.Zi();a.J.Zi();return a.J.Zi()};b.prototype.$h=function(a,b){var d=this.zb*a.x+this.gb*a.y+this.bc;b.x=this.lb*a.x+this.sb*a.y+this.Wb;b.y=d};b.prototype.XY=function(a,b,c,e,f){var d=2*b;e*=2;for(b=2*(b+f);d<
b;d+=2,e+=2){f=a[d];var h=a[d+1];c[e]=this.lb*f+this.sb*h+this.Wb;c[e+1]=this.zb*f+this.gb*h+this.bc}};b.prototype.ZY=function(b,d,c){for(var e=0;e<d;e++){var h=b[e].x,f=b[e].y,l=this.lb*h+this.sb*f+this.Wb,h=this.zb*h+this.gb*f+this.bc;null!=c[e]?c[e].ka(l,h):c[e]=a.b.pa(l,h)}};b.prototype.multiply=function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var d,e,h,f,l;d=a.lb*b.lb+a.zb*b.sb;e=a.sb*b.lb+a.gb*b.sb;h=a.Wb*b.lb+a.bc*b.sb+b.Wb;f=a.lb*b.zb+a.zb*b.gb;l=a.sb*b.zb+a.gb*b.gb;a=a.Wb*
b.zb+a.bc*b.gb+b.bc;c.lb=d;c.sb=e;c.Wb=h;c.zb=f;c.gb=l;c.bc=a};b.prototype.Vf=function(){var a=new b;a.lb=this.lb;a.sb=this.sb;a.Wb=this.Wb;a.zb=this.zb;a.gb=this.gb;a.bc=this.bc;return a};b.prototype.KC=function(b){if(!b.u()){for(var d=[],c=0;4>c;c++)d[c]=new a.b;b.PB(d);this.$Y(d,d);b.Mx(d,4)}};b.prototype.$Y=function(b,d){for(var c=0;c<b.length;c++){var e=new a.b,f=b[c];e.x=this.lb*f.x+this.sb*f.y+this.Wb;e.y=this.zb*f.x+this.gb*f.y+this.bc;d[c]=e}};b.prototype.kU=function(a,b){a.u()||b.u()||0==
a.N()||0==a.fa()?this.Vx():(this.sb=this.zb=0,this.lb=b.N()/a.N(),this.gb=b.fa()/a.fa(),this.Wb=b.o-a.o*this.lb,this.bc=b.A-a.A*this.gb)};b.prototype.YY=function(b){var d=new a.b,c=new a.b;d.ka(this.lb,this.zb);c.ka(this.sb,this.gb);d.sub(d);var e=.5*d.qk();d.ka(this.lb,this.zb);c.ka(this.sb,this.gb);d.add(c);d=.5*d.qk();return b*(e>d?Math.sqrt(e):Math.sqrt(d))};b.prototype.pC=function(){this.lb=1;this.zb=this.Wb=this.sb=0;this.gb=1;this.bc=0};b.prototype.Ho=function(b){if(void 0!==b){var d=a.b.pa(0,
1);this.$h(d,d);d.sub(a.b.pa(0,1));if(d.qk()>b*b)return!1;d.ka(0,0);this.$h(d,d);if(d.qk()>b*b)return!1;d.ka(1,0);this.$h(d,d);d.sub(a.b.pa(1,0));return d.qk()<=b*b}return 1==this.lb&&1==this.gb&&0==this.sb&&0==this.Wb&&0==this.zb&&0==this.bc};b.prototype.fh=function(a){return Math.abs(this.lb*this.gb-this.zb*this.sb)<=2*a*(Math.abs(this.lb*this.gb)+Math.abs(this.zb*this.sb))};b.prototype.Ag=function(a,b){this.lb=1;this.sb=0;this.Wb=a;this.zb=0;this.gb=1;this.bc=b};b.prototype.Op=function(a,b){void 0!==
b?(this.lb=a,this.zb=this.Wb=this.sb=0,this.gb=b,this.bc=0):this.Op(a,a)};b.prototype.xC=function(){this.lb=0;this.sb=1;this.Wb=0;this.zb=1;this.bc=this.gb=0};b.prototype.jY=function(a){this.kY(Math.cos(a),Math.sin(a))};b.prototype.kY=function(a,b){this.lb=a;this.sb=-b;this.Wb=0;this.zb=b;this.gb=a;this.bc=0};b.prototype.shift=function(a,b){this.Wb+=a;this.bc+=b};b.prototype.scale=function(a,b){this.lb*=a;this.sb*=a;this.Wb*=a;this.zb*=b;this.gb*=b;this.bc*=b};b.prototype.rotate=function(a){var d=
new b;d.jY(a);this.multiply(d)};b.prototype.inverse=function(a){if(void 0!==a){var b=this.lb*this.gb-this.sb*this.zb;0==b?a.Vx():(b=1/b,a.Wb=(this.sb*this.bc-this.Wb*this.gb)*b,a.bc=(this.Wb*this.zb-this.lb*this.bc)*b,a.lb=this.gb*b,a.sb=-this.sb*b,a.zb=-this.zb*b,a.gb=this.lb*b)}else this.inverse(this)};return b}();a.Hd=b})(D||(D={}));(function(a){var b=function(){function b(){}b.prototype.Vx=function(){this.bi=this.bc=this.Wb=this.Df=this.Af=this.zf=this.Cf=this.gb=this.sb=this.Sf=this.zb=this.lb=
0};b.prototype.Op=function(a,b,c){this.lb=a;this.sb=this.Sf=this.zb=0;this.gb=b;this.Af=this.zf=this.Cf=0;this.Df=c;this.bi=this.bc=this.Wb=0};b.prototype.KC=function(b){if(b.u())return b;for(var d=new a.qd[8],c=0;8>c;c++)d[c]=new a.qd;b.PB(d);this.transform(d,8,d);b.Mx(d);return b};b.prototype.transform=function(b,d,c){for(var e=0;e<d;e++){var h=new a.qd,f=b[e];h.x=this.lb*f.x+this.sb*f.y+this.zf*f.z+this.Wb;h.y=this.zb*f.x+this.gb*f.y+this.Af*f.z+this.bc;h.z=this.Sf*f.x+this.Cf*f.y+this.Df*f.z+
this.bi;c[e]=h}};b.prototype.Rp=function(b){var d=new a.qd;d.x=this.lb*b.x+this.sb*b.y+this.zf*b.z+this.Wb;d.y=this.zb*b.x+this.gb*b.y+this.Af*b.z+this.bc;d.z=this.Sf*b.x+this.Cf*b.y+this.Df*b.z+this.bi;return d};b.prototype.Vg=function(a){b.multiply(this,a,this)};b.multiply=function(a,b,c){var d,e,h,f,l,g,k,m,q,n,w;d=a.lb*b.lb+a.zb*b.sb+a.Sf*b.zf;e=a.lb*b.zb+a.zb*b.gb+a.Sf*b.Af;h=a.lb*b.Sf+a.zb*b.Cf+a.Sf*b.Df;f=a.sb*b.lb+a.gb*b.sb+a.Cf*b.zf;l=a.sb*b.zb+a.gb*b.gb+a.Cf*b.Af;g=a.sb*b.Sf+a.gb*b.Cf+a.Cf*
b.Df;k=a.zf*b.lb+a.Af*b.sb+a.Df*b.zf;m=a.zf*b.zb+a.Af*b.gb+a.Df*b.Af;q=a.zf*b.Sf+a.Af*b.Cf+a.Df*b.Df;n=a.Wb*b.lb+a.bc*b.sb+a.bi*b.zf+b.Wb;w=a.Wb*b.zb+a.bc*b.gb+a.bi*b.Af+b.bc;a=a.Wb*b.Sf+a.bc*b.Cf+a.bi*b.Df+b.bi;c.lb=d;c.zb=e;c.Sf=h;c.sb=f;c.gb=l;c.Cf=g;c.zf=k;c.Af=m;c.Df=q;c.Wb=n;c.bc=w;c.bi=a};b.inverse=function(b,d){var c=b.lb*(b.gb*b.Df-b.Cf*b.Af)-b.zb*(b.sb*b.Df-b.Cf*b.zf)+b.Sf*(b.sb*b.Af-b.gb*b.zf);if(0!=c){var e,f,l,g,k,m,q,n,w,x;n=1/c;c=(b.gb*b.Df-b.Cf*b.Af)*n;l=-(b.sb*b.Df-b.Cf*b.zf)*n;m=
(b.sb*b.Af-b.gb*b.zf)*n;e=-(b.zb*b.Df-b.Af*b.Sf)*n;g=(b.lb*b.Df-b.Sf*b.zf)*n;q=-(b.lb*b.Af-b.zb*b.zf)*n;f=(b.zb*b.Cf-b.Sf*b.gb)*n;k=-(b.lb*b.Cf-b.Sf*b.sb)*n;n*=b.lb*b.gb-b.zb*b.sb;w=-(b.Wb*c+b.bc*l+b.bi*m);x=-(b.Wb*e+b.bc*g+b.bi*q);b=-(b.Wb*f+b.bc*k+b.bi*n);d.lb=c;d.zb=e;d.Sf=f;d.sb=l;d.gb=g;d.Cf=k;d.zf=m;d.Af=q;d.Df=n;d.Wb=w;d.bc=x;d.bi=b}else throw a.g.X("math singularity");};b.prototype.Vf=function(){var a=new b;a.lb=this.lb;a.zb=this.zb;a.Sf=this.Sf;a.sb=this.sb;a.gb=this.gb;a.Cf=this.Cf;a.zf=
this.zf;a.Af=this.Af;a.Df=this.Df;a.Wb=this.Wb;a.bc=this.bc;a.bi=this.bi;return a};return b}();a.eO=b})(D||(D={}));(function(a){var b=function(b){function d(a){if(void 0!==a)b.call(this,a.jc(),a);else{b.call(this);this.wg=[];this.wg[0]=0;this.Ga=1;this.Sh=[];for(a=0;10>a;a++)this.Sh[a]=-1;this.Sh[this.wg[0]]=0}this.Zq=!0}F(d,b);d.prototype.Ud=function(a){this.hasAttribute(a)||(this.Sh[a]=0,this.CE())};d.prototype.removeAttribute=function(b){if(0==b)throw a.g.F("Position attribue cannot be removed");
this.hasAttribute(b)&&(this.Sh[b]=-1,this.CE())};d.prototype.reset=function(){this.wg[0]=0;this.Ga=1;for(var a=0;a<this.Sh.length;a++)this.Sh[a]=-1;this.Sh[this.wg[0]]=0;this.Zq=!0};d.prototype.Oz=function(){return c.zo().add(this)};d.Ig=function(){return c.zo().TT()};d.eq=function(){return c.zo().UT()};d.prototype.JO=function(){var b=this.jc();return new a.ma(b,this)};d.prototype.CE=function(){for(var a=this.Ga=0,b=0;10>a;a++)0<=this.Sh[a]&&(this.wg[b]=a,this.Sh[a]=b,b++,this.Ga++);this.Zq=!0};d.prototype.jc=
function(){this.Zq&&(this.bm=this.Ak(),this.Zq=!1);return this.bm};d.prototype.Eb=function(a){if(null==a)return!1;if(a==this)return!0;if(!(a instanceof d)||a.Ga!=this.Ga)return!1;for(var b=0;b<this.Ga;b++)if(this.wg[b]!=a.wg[b])return!1;return this.Zq!=a.Zq?!1:!0};d.prototype.SH=function(a){if(a.Ga!=this.Ga)return!1;for(var b=0;b<this.Ga;b++)if(this.wg[b]!=a.wg[b])return!1;return!0};d.vx=function(a,b){for(var d=[],c=0;c<a.Ga;c++)d[c]=-1;for(var c=0,e=a.Ga;c<e;c++)d[c]=b.mg(a.rd(c));return d};d.uT=
function(a,b){a=new d(a);a.Ud(b);return a.Oz()};d.vT=function(a,b){for(var c=null,e=0;10>e;e++)!a.hasAttribute(e)&&b.hasAttribute(e)&&(null==c&&(c=new d(a)),c.Ud(e));return null!=c?c.Oz():a};d.ss=function(a,b){a=new d(a);a.removeAttribute(b);return a.Oz()};return d}(a.ma);a.ye=b;var c=function(){function a(){this.map=[];var a=new b;this.add(a);a=new b;a.Ud(1);this.add(a)}a.zo=function(){return a.iV};a.prototype.TT=function(){return a.aq};a.prototype.UT=function(){return a.bq};a.prototype.add=function(b){var d=
b.jc();if(null!=a.aq&&a.aq.jc()==d&&b.SH(a.aq))return a.aq;if(null!=a.bq&&a.bq.jc()==d&&b.SH(a.bq))return a.bq;var c=null;void 0!==this.map[d]&&(c=this.map[d]);null==c&&(c=b.JO(),1==c.Ga?a.aq=c:2==c.Ga&&1==c.rd(1)?a.bq=c:this.map[d]=c);return c};a.iV=new a;return a}()})(D||(D={}));var Q=0==t.version.indexOf("4."),S;(function(a){a[a.Linear=0]="Linear";a[a.Angular=1]="Angular";a[a.Area=2]="Area";a[a.LinearOrAngular=3]="LinearOrAngular"})(S||(S={}));var T={feet:9002,kilometers:9036,meters:9001,miles:9035,
"nautical-miles":9030,yards:9096},O={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109413,"square-yards":109442},W={degrees:9102,radians:9101};void 0===v.prototype.getCacheValue&&e.extend(v,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,b){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=b}});var U=D.Sd.create(4326),
V=D.Sd.create(102100);p=function(){function e(){}e.extendedSpatialReferenceInfo=function(a){if(null===a)return null;a=C(a);var b=a.Nd();return{tolerance:a.Bo(),unitType:null==b?-1:b.nd,unitID:null==b?-1:b.yc(),unitBaseFactor:null==b?0:b.Ai,unitSquareDerivative:null==b?0:D.oc.lH(b).yc()}};e.clip=function(a,b){if(null===a)return null;b=D.cc.clip(z(a),z(b),E(a));return w(b,a.spatialReference)};e.cut=function(a,b){b=z(b);b=D.cc.Hl(z(a),b,E(a));for(var c=[],d=0;d<b.length;d++)c.push(w(b[d],a.spatialReference));
return c};e.contains=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.contains(z(a),z(b),E(a))};e.crosses=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.yR(z(a),z(b),E(a))};e.distance=function(a,b,e){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.Cb(z(a),z(b),E(a),D.oc.ze(c(e,3)))};e.equals=function(a,b){return null===a&&null!==b||null===b&&null!==a?!1:D.cc.Eb(z(a),z(b),E(a))};e.intersects=
function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.NU(z(a),z(b),E(a))};e.touches=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.touches(z(a),z(b),E(a))};e.within=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.rZ(z(a),z(b),E(a))};e.disjoint=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.QR(z(a),z(b),E(a))};e.overlaps=function(a,b){if(null===
a||null===b)throw Error("Illegal Argument Exception");return D.cc.oW(z(a),z(b),E(a))};e.relate=function(a,b,c){if(null===a||null===b)throw Error("Illegal Argument Exception");return D.cc.YB(z(a),z(b),E(a),c)};e.isSimple=function(a){if(null===a)throw Error("Illegal Argument Exception");return D.cc.YU(z(a),E(a))};e.simplify=function(a){if(null===a)throw Error("Illegal Argument Exception");var b=D.cc.CC(z(a),E(a));return w(b,a.spatialReference)};e.convexHull=function(a,b){void 0===b&&(b=!1);if(null===
a)throw Error("Illegal Argument Exception");return!1===B(a)?(b=D.cc.hR(z(a),E(a)),w(b,a.spatialReference)):e.kZ(a,b)};e.kZ=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(z(a[d]));c=D.cc.iR(c,b);for(d=0;d<c.length;d++)c[d]=w(c[d],a[0].spatialReference);return c};e.difference=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return!1===B(a)?(b=D.cc.Vm(z(a),z(b),E(a)),w(b,a.spatialReference)):e.hM(a,b)};e.hM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(z(a[d]));
c=D.cc.NR(c,z(b),E(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};e.symmetricDifference=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");return!1===B(a)?(b=D.cc.Pp(z(a),z(b),E(a)),w(b,a.spatialReference)):e.KM(a,b)};e.KM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(z(a[d]));c=D.cc.OY(c,z(b),E(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};e.intersect=function(a,b){if(null===a||null===b)throw Error("Illegal Argument Exception");
return!1===B(a)?(b=D.cc.Ma(z(a),z(b),E(a)),w(b,a.spatialReference)):e.wM(a,b)};e.wM=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(z(a[d]));c=D.cc.LU(c,z(b),E(b));for(d=0;d<c.length;d++)c[d]=w(c[d],b.spatialReference);return c};e.union=function(a,b){void 0===b&&(b=null);if(null===a)return null;!1===B(a)&&(a=[a],null!==b&&a.push(b));if(0===a.length)return null;b=[];for(var c=0;c<a.length;c++)b.push(z(a[c]));return w(D.cc.gZ(b,E(a[0])),a[0].spatialReference)};e.offset=function(a,b,f,d,h,g){var l=
0;if(null!=d&&void 0!=d)switch(d){case "round":l=0;break;case "bevel":l=1;break;case "miter":l=2;break;case "square":l=3}return!1===B(a)?(b=D.cc.offset(z(a),E(a),b,l,h,g,D.oc.ze(c(f,3))),w(b,a.spatialReference)):e.GM(a,b,f,l,h,g)};e.GM=function(a,b,e,d,h,f){if(null===a)return null;if(0===a.length)return[];for(var l=[],g=0;g<a.length;g++)l.push(z(a[g]));b=D.cc.mW(l,E(a[0]),b,d,h,f,D.oc.ze(c(e,3)));for(g=0;g<b.length;g++)b[g]=w(b[g],a[0].spatialReference);return b};e.buffer=function(a,b,f,d){void 0===
d&&(d=!1);if(!1===B(a))return b=D.cc.buffer(z(a),E(a),b,D.oc.ze(c(f,3)),!1,0,NaN),w(b,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(b)){for(var h=[],l=0;l<a.length;l++)h.push(b);b=h}if(b.length!=a.length){if(0==b.length)throw Error("Illegal Argument Exception");for(var h=[],g=0,l=0;l<a.length;l++)void 0===b[l]?h.push(g):(h.push(b[l]),g=b[l]);b=h}return e.qD(a,b,f,!1,d,"geodesic",NaN)};e.geodesicBuffer=function(a,b,f,d,h,g){if(!1===B(a))return void 0===h&&(h=NaN),b=D.cc.buffer(z(a),
E(a),b,D.oc.ze(c(f,0)),!0,x(d),h),w(b,a.spatialReference);if("[object Array]"!==Object.prototype.toString.call(b)){for(var l=[],k=0;k<a.length;k++)l.push(b);b=l}if(b.length!=a.length){if(0==b.length)throw Error("Illegal Argument Exception");for(var l=[],m=0,k=0;k<a.length;k++)void 0===b[k]?l.push(m):(l.push(b[k]),m=b[k]);b=l}return e.qD(a,b,f,!0,d,h,g)};e.qD=function(a,b,e,d,h,f,g){if(null===a)return null;if(0===a.length)return[];void 0===g&&(g=NaN);for(var l=[],k=0;k<a.length;k++)l.push(z(a[k]));
b=D.cc.QP(l,E(a[0]),b,D.oc.ze(c(e,0)),d,h,x(f),g);for(k=0;k<b.length;k++)b[k]=w(b[k],a[0].spatialReference);return b};e.nearestCoordinate=function(a,b,c){void 0===c&&(c=!0);b=D.cc.Zz(z(a),z(b),c);return{coordinate:w(b.Nz(),a.spatialReference),distance:b.Qz(),isRightSide:b.zA(),vertexIndex:b.Za(),isEmpty:b.u()}};e.nearestVertex=function(a,b){b=D.cc.$z(z(a),z(b));return{coordinate:w(b.Nz(),a.spatialReference),distance:b.Qz(),isRightSide:b.zA(),vertexIndex:b.Za(),isEmpty:b.u()}};e.nearestVertices=function(a,
b,c,d){b=z(b);c=D.cc.aA(z(a),b,c,d);d=[];for(b=0;b<c.length;b++)!1===c[b].u()&&d.push({coordinate:w(c[b].Nz(),a.spatialReference),distance:c[b].Qz(),isRightSide:c[b].zA(),vertexIndex:c[b].Za(),isEmpty:c[b].u()});return d};e.generalize=function(a,b,e,d){b=D.cc.GS(z(a),E(a),b,e,D.oc.ze(c(d,3)));return w(b,a.spatialReference)};e.densify=function(a,b,e){b=D.cc.Ls(z(a),E(a),b,D.oc.ze(c(e,3)));return w(b,a.spatialReference)};e.geodesicDensify=function(a,b,e,d){void 0===d&&(d=0);b=D.cc.Ez(z(a),E(a),b,D.oc.ze(c(e,
3)),d);return w(b,a.spatialReference)};e.rotate=function(c,e,f){if(void 0===f||null===f)void 0!==c.x?f=c:void 0!==c.xmin?(!1===c instanceof v&&(c=Q?a(c):b(c)),f=Q?c.get("center"):c.getCenter()):(!1===c instanceof v&&(c=Q?a(c):b(c)),f=Q?c.get("extent").get("center"):c.getExtent().getCenter());e=Q?D.Wp.rotate(c.toJSON?c.toJSON():c,e,f.toJSON?f.toJSON():f):D.Wp.rotate(c.toJson?c.toJson():c,e,f.toJson?f.toJson():f);Q?(e=a(e),e.set("spatialReference",c.spatialReference)):(e=b(e),e.setSpatialReference(c.spatialReference));
return e};e.flipHorizontal=function(c,e){if(void 0===e||null===e)void 0!==c.x?e=c:void 0!==c.xmin?(!1===c instanceof v&&(c=Q?a(c):b(c)),e=Q?c.get("center"):c.getCenter()):(!1===c instanceof v&&(c=Q?a(c):b(c)),e=Q?c.get("extent").get("center"):c.getExtent().getCenter());e=Q?D.Wp.zG(c.toJSON?c.toJSON():c,e.toJSON?e.toJSON():e):D.Wp.zG(c.toJson?c.toJson():c,e.toJson?e.toJson():e);Q?(e=a(e),e.set("spatialReference",c.spatialReference)):(e=b(e),e.setSpatialReference(c.spatialReference));return e};e.flipVertical=
function(c,e){if(void 0===e||null===e)void 0!==c.x?e=c:void 0!==c.xmin?(!1===c instanceof v&&(c=Q?a(c):b(c)),e=Q?c.get("center"):c.getCenter()):(!1===c instanceof v&&(c=Q?a(c):b(c)),e=Q?c.get("extent").get("center"):c.getExtent().getCenter());e=Q?D.Wp.AG(c.toJSON?c.toJSON():c,e.toJSON?e.toJSON():e):D.Wp.AG(c.toJson?c.toJson():c,e.toJson?e.toJson():e);Q?(e=a(e),e.set("spatialReference",c.spatialReference)):(e=b(e),e.setSpatialReference(c.spatialReference));return e};e.planarArea=function(a,b){if(null===
a)throw Error("Illegal Argument Exception");return D.cc.wW(z(a),E(a),D.oc.ze(c(b,2)))};e.planarLength=function(a,b){if(null===a)throw Error("Illegal Argument Exception");return D.cc.xW(z(a),E(a),D.oc.ze(c(b,3)))};e.geodesicArea=function(a,b,e){if(null===a)throw Error("Illegal Argument Exception");return D.cc.MS(z(a),E(a),D.oc.ze(c(b,2)),x(e))};e.geodesicLength=function(a,b,e){if(null===a)throw Error("Illegal Argument Exception");return D.cc.QS(z(a),E(a),D.oc.ze(c(b,0)),x(e))};e._enableProjection=
function(a){e.FE=!0;D.AN.bind(a)};e.Mg=function(a){return C(a).Ao()};e._getTransformation=function(a,b,c){void 0===c&&(c=null);var d=null,e=null;if(c){if(!c.spatialReference)throw D.g.F("AOI missing Spatial Reference");d=z(c);e=C(c.spatialReference).Ao()}a=D.Ou.QT(C(a).Ao(),C(b).Ao(),d,e);return null!==a?a:null};e._getTransformationBySuitability=function(a,b,c){void 0===c&&(c=null);var d=null,e=null;if(c){if(!c.spatialReference)throw D.g.F("AOI missing Spatial Reference");d=z(c);e=C(c.spatialReference).Ao()}return D.Ou.RT(C(a).Ao(),
C(b).Ao(),d,e)};e.cZ=function(a,b,c){var d=null;if(c){var h=c.getGTListEntry();if(null!==h){for(var d=new D.ny(null),f=0,g=h.steps;f<g.length;f++){var h=g[f],l=new D.io(h.geogtran);h.isInverse&&l.kt();d.add(l)}d=D.rs.Is(e.Mg(a),e.Mg(b),d);c.assignCachedGe(a,b,d);return d}}if(null===d&&c&&c.steps&&0<c.steps.length){d=new D.ny(null);f=0;for(g=c.steps;f<g.length;f++)h=g[f],-1!=h.wkid&&null!==h.wkid&&void 0!==h.wkid?d.add(D.io.create(h.wkid,h.isInverse)):d.add(D.io.fG(h.wkt,h.isInverse));d=D.rs.Is(e.Mg(a),
e.Mg(b),d);c.assignCachedGe(a,b,d);return d}return D.rs.Is(e.Mg(a),e.Mg(b),d)};e._project=function(a,b,c,d,h){void 0===d&&(d=null);void 0===h&&(h=!1);if(!1===this.FE)throw Error("Projection Engine must be enabled using enableProjection");if(0===a.length)return[];if(d){var f=d.getCachedGeTransformation(b,c);f||(f=e.cZ(b,c,d));b=[];var g=0}else f=D.rs.Is(e.Mg(b),e.Mg(c),null),b=[],g=0;for(;g<a.length;g++)d=a[g],b.push(e.mD(d,c,f,h));return b};e.mD=function(a,b,c,d){a=D.cc.Xg(z(a),c);return d?G(a):w(a,
b)};e.FE=!1;return e}();void 0===v.prototype.getCacheValue&&e.extend(v,{cache:null,getCacheValue:function(a){if(null===this.cache||void 0===this.cache)this.cache={};return this.cache[a]},setCacheValue:function(a,b){if(null===this.cache||void 0===this.cache)this.cache={};this.cache[a]=b}});return p})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(p,g,t,v,n,m,
u,k){return p(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var f=t.map(this.geometries,function(b){return b.toJson()}),e={};e.outSR=this.outSR.wkid||v.toJson(this.outSR.toJson());e.inSR=this.geometries[0].spatialReference.wkid||v.toJson(this.geometries[0].spatialReference.toJson());e.geometries=v.toJson({geometryType:k.getJsonType(this.geometries[0]),geometries:f});this.transformation&&(e.transformation=this.transformation.wkid||
v.toJson(this.transformation));u.isDefined(this.transformForward)&&(e.transformForward=this.transformForward);return e}})})},"esri/IdentityManager":function(){define(["./IdentityManagerDialog","./kernel","./OAuthSignInHandler","dojo/_base/declare"],function(p,g,t,v){p=new p;g.id=v.safeMixin(p,t);return g.id})},"esri/IdentityManagerDialog":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/config dojo/_base/Deferred dojo/_base/lang dojo/has dojo/dom-attr dojo/keys dijit/registry dijit/Dialog ./kernel ./lang ./domUtils ./Credential ./IdentityManagerBase dojo/i18n!./nls/jsapi dojo/query dijit/form/Button dijit/form/Form dijit/form/ValidationTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){return g([w],{declaredClass:"esri.IdentityManager",_eventMap:{"dialog-cancel":["info"]},constructor:function(a){n.mixin(this,a);this.registerConnectEvents()},_dialogContent:"\x3cdiv data-dojo-type\x3d'dijit.form.Form' data-dojo-props\x3d'\"class\":\"esriIdForm\"'\x3e\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${info}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3ctable style\x3d'width: 100%;'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblUser}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"text\", \"class\":\"esriIdUser\", required:true, trim:true, style:\"width: 100%;\", autocapitalize:\"none\", autocorrect:\"off\", spellcheck:false' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel\x3e${lblPwd}\x3cbr/\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' data-dojo-props\x3d'type:\"password\", \"class\":\"esriIdPwd\", required:true, style:\"width: 100%;\"' /\x3e\x3c/label\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e",
onDialogCreate:function(){},onDialogCancel:function(){},signIn:function(a,b,e){this._nls||(this._nls=q.identity);this._loginDialog||(this._loginDialog=this.dialog=this._createLoginDialog(),this.onDialogCreate());var f=this._loginDialog,g=e&&e.error,k=e&&e.token,m=new v(function(){f.onCancel()});if(f.open)return a=Error("BUSY"),a.code="IdentityManager.1",a.log=!!t.isDebug,m.errback(a),m;c.hide(f.errMsg_);g&&403==g.code&&k&&(u.set(f.errMsg_,"innerHTML",this._nls.forbidden),c.show(f.errMsg_));f.dfd_=
m;f.serverInfo_=b;f.resUrl_=a;f.admin_=e&&e.isAdmin;u.set(f.resLink_,{title:a,innerHTML:"("+(this.getResourceName(a)||this._nls.lblItem)+")"});u.set(f.serverLink_,{title:b.server,innerHTML:(-1!==b.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":b.server)+" "});f.txtPwd_.set("value","");f.show();return m},_createLoginDialog:function(){var g=this._nls,m=a.substitute(g,this._dialogContent),m=a.substitute({resource:"\x3cspan class\x3d'resLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e",
server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},m),q=new e({title:g.title,content:m,"class":"esriSignInDialog",style:"width: 18em;",esriIdMgr_:this,keypressed_:function(a){a.charOrCode===k.ENTER&&this.execute_()},execute_:function(){var f=this.txtUser_.get("value"),k=this.txtPwd_.get("value"),m=this.dfd_,q=this;if(this.form_.validate()&&f&&k){this.btnSubmit_.set("label",g.lblSigning);var n=b.id.findCredential(q.resUrl_,f),w=function(b){q.btnSubmit_.set("label",
g.lblOk);q.btnSubmit_.set("disabled",!1);c.hide(q.errMsg_);q.hide();e._DialogLevelManager.hide(q);var k=q.serverInfo_;q.dfd_=q.serverInfo_=q.generateDfd_=q.resUrl_=null;var w,p,u=n,B;b&&(w=b.token,p=a.isDefined(b.expires)?Number(b.expires):null,B=!!b.ssl,u?(u.userId=f,u.token=w,u.expires=p,u.validity=b.validity,u.ssl=B,u.creationTime=(new Date).getTime()):u=new x({userId:f,server:k.server,token:w,expires:p,ssl:B,isAdmin:q.admin_,validity:b.validity}));m.callback(u)};n&&!n._enqueued?w():(q.btnSubmit_.set("disabled",
!0),q.generateDfd_=b.id.generateToken(this.serverInfo_,{username:f,password:k},{isAdmin:this.admin_}).addCallback(w).addErrback(function(a){q.btnSubmit_.set("disabled",!1);q.generateDfd_=null;q.btnSubmit_.set("label",g.lblOk);u.set(q.errMsg_,"innerHTML",a&&a.code?g.invalidUser:g.noAuthService);c.show(q.errMsg_)}))}},cancel_:function(){q.generateDfd_&&q.generateDfd_.cancel();var a=q.dfd_,b=q.resUrl_,f=q.serverInfo_;q.btnSubmit_.set("disabled",!1);q.dfd_=q.serverInfo_=q.generateDfd_=q.resUrl_=null;
c.hide(q.errMsg_);e._DialogLevelManager.hide(q);q.esriIdMgr_.onDialogCancel({resourceUrl:b,serverInfo:f});b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!t.isDebug;a.errback(b)}}),m=q.domNode;q.form_=f.byNode(p.query(".esriIdForm",m)[0]);q.txtUser_=f.byNode(p.query(".esriIdUser",m)[0]);q.txtPwd_=f.byNode(p.query(".esriIdPwd",m)[0]);q.btnSubmit_=f.byNode(p.query(".esriIdSubmit",m)[0]);q.btnCancel_=f.byNode(p.query(".esriIdCancel",m)[0]);q.resLink_=p.query(".resLink",m)[0];q.serverLink_=p.query(".serverLink",
m)[0];q.errMsg_=p.query(".esriErrorMsg",m)[0];q.connect(q.txtUser_,"onKeyPress",q.keypressed_);q.connect(q.txtPwd_,"onKeyPress",q.keypressed_);q.connect(q.btnSubmit_,"onClick",q.execute_);q.connect(q.btnCancel_,"onClick",q.onCancel);q.connect(q,"onCancel",q.cancel_);return q}})})},"dijit/Dialog":function(){define("require dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/ready dojo/sniff dojo/touch dojo/window dojo/dnd/Moveable dojo/dnd/TimedMoveable ./focus ./_base/manager ./_Widget ./_TemplatedMixin ./_CssStateMixin ./form/_FormMixin ./_DialogMixin ./DialogUnderlay ./layout/ContentPane ./layout/utils dojo/text!./templates/Dialog.html ./a11yclick dojo/i18n!./nls/common".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T){function O(){}var W=new n;W.resolve(!0);F=v("dijit._DialogBase"+(q("dojo-bidi")?"_NoBidi":""),[I,J,L,K],{templateString:T,baseClass:"dijitDialog",cssStateNodes:{closeButtonNode:"dijitDialogCloseIcon"},_setTitleAttr:{node:"titleNode",type:"innerHTML"},open:!1,duration:F.defaultDuration,refocus:!0,autofocus:!0,_firstFocusItem:null,_lastFocusItem:null,draggable:!0,_setDraggableAttr:function(a){this._set("draggable",a)},maxRatio:.9,
closable:!0,_setClosableAttr:function(a){this.closeButtonNode.style.display=a?"":"none";this._set("closable",a)},postMixInProperties:function(){var a=b.getLocalization("dijit","common");c.mixin(this,a);this.inherited(arguments)},postCreate:function(){f.set(this.domNode,{display:"none",position:"absolute"});this.ownerDocumentBody.appendChild(this.domNode);this.inherited(arguments);t.after(this,"onExecute",c.hitch(this,"hide"),!0);t.after(this,"onCancel",c.hitch(this,"hide"),!0);x(this.closeButtonNode,
C.press,function(a){a.stopPropagation()});this._modalconnects=[]},onLoad:function(){this.resize();this._position();this.autofocus&&V.isTop(this)&&(this._getFocusItems(),G.focus(this._firstFocusItem));this.inherited(arguments)},focus:function(){this._getFocusItems();G.focus(this._firstFocusItem)},_endDrag:function(){var a=k.position(this.domNode),b=z.getBox(this.ownerDocument);a.y=Math.min(Math.max(a.y,0),b.h-a.h);a.x=Math.min(Math.max(a.x,0),b.w-a.w);this._relativePosition=a;this._position()},_setup:function(){var a=
this.domNode;this.titleBar&&this.draggable?(this._moveable=new (6==q("ie")?B:E)(a,{handle:this.titleBar}),t.after(this._moveable,"onMoveStop",c.hitch(this,"_endDrag"),!0)):u.add(a,"dijitDialogFixed");this.underlayAttrs={dialogId:this.id,"class":g.map(this["class"].split(/\s/),function(a){return a+"_underlay"}).join(" "),_onKeyDown:c.hitch(this,"_onKey"),ownerDocument:this.ownerDocument}},_size:function(){this.resize()},_position:function(){if(!u.contains(this.ownerDocumentBody,"dojoMove")){var a=
this.domNode,b=z.getBox(this.ownerDocument),c=this._relativePosition,d=k.position(a);f.set(a,{left:Math.floor(b.l+(c?Math.min(c.x,b.w-d.w):(b.w-d.w)/2))+"px",top:Math.floor(b.t+(c?Math.min(c.y,b.h-d.h):(b.h-d.h)/2))+"px"})}},_onKey:function(b){if(b.keyCode==a.TAB){this._getFocusItems();var c=b.target;this._firstFocusItem==this._lastFocusItem?(b.stopPropagation(),b.preventDefault()):c==this._firstFocusItem&&b.shiftKey?(G.focus(this._lastFocusItem),b.stopPropagation(),b.preventDefault()):c!=this._lastFocusItem||
b.shiftKey||(G.focus(this._firstFocusItem),b.stopPropagation(),b.preventDefault())}else this.closable&&b.keyCode==a.ESCAPE&&(this.onCancel(),b.stopPropagation(),b.preventDefault())},show:function(){if(this.open)return W.promise;this._started||this.startup();this._alreadyInitialized||(this._setup(),this._alreadyInitialized=!0);this._fadeOutDeferred&&(this._fadeOutDeferred.cancel(),V.hide(this));var a=z.get(this.ownerDocument);this._modalconnects.push(x(a,"scroll",c.hitch(this,"resize",null)));this._modalconnects.push(x(this.domNode,
"keydown",c.hitch(this,"_onKey")));f.set(this.domNode,{opacity:0,display:""});this._set("open",!0);this._onShow();this.resize();this._position();var b;this._fadeInDeferred=new n(c.hitch(this,function(){b.stop();delete this._fadeInDeferred}));this._fadeInDeferred.then(void 0,O);a=this._fadeInDeferred.promise;b=e.fadeIn({node:this.domNode,duration:this.duration,beforeBegin:c.hitch(this,function(){V.show(this,this.underlayAttrs)}),onEnd:c.hitch(this,function(){this.autofocus&&V.isTop(this)&&(this._getFocusItems(),
G.focus(this._firstFocusItem));this._fadeInDeferred.resolve(!0);delete this._fadeInDeferred})}).play();return a},hide:function(){if(!this._alreadyInitialized||!this.open)return W.promise;this._fadeInDeferred&&this._fadeInDeferred.cancel();var a;this._fadeOutDeferred=new n(c.hitch(this,function(){a.stop();delete this._fadeOutDeferred}));this._fadeOutDeferred.then(void 0,O);this._fadeOutDeferred.then(c.hitch(this,"onHide"));var b=this._fadeOutDeferred.promise;a=e.fadeOut({node:this.domNode,duration:this.duration,
onEnd:c.hitch(this,function(){this.domNode.style.display="none";V.hide(this);this._fadeOutDeferred.resolve(!0);delete this._fadeOutDeferred})}).play();this._scrollConnected&&(this._scrollConnected=!1);for(var f;f=this._modalconnects.pop();)f.remove();this._relativePosition&&delete this._relativePosition;this._set("open",!1);return b},resize:function(a){if("none"!=this.domNode.style.display){this._checkIfSingleChild();if(!a){this._shrunk&&(this._singleChild&&"undefined"!=typeof this._singleChildOriginalStyle&&
(this._singleChild.domNode.style.cssText=this._singleChildOriginalStyle,delete this._singleChildOriginalStyle),g.forEach([this.domNode,this.containerNode,this.titleBar,this.actionBarNode],function(a){a&&f.set(a,{position:"static",width:"auto",height:"auto"})}),this.domNode.style.position="absolute");var b=z.getBox(this.ownerDocument);b.w*=this.maxRatio;b.h*=this.maxRatio;var c=k.position(this.domNode);this._shrunk=!1;c.w>=b.w&&(a={w:b.w},k.setMarginBox(this.domNode,a),c=k.position(this.domNode),this._shrunk=
!0);c.h>=b.h&&(a||(a={w:c.w}),a.h=b.h,this._shrunk=!0);a&&(a.w||(a.w=c.w),a.h||(a.h=c.h))}if(a){k.setMarginBox(this.domNode,a);b=[];this.titleBar&&b.push({domNode:this.titleBar,region:"top"});this.actionBarNode&&b.push({domNode:this.actionBarNode,region:"bottom"});c={domNode:this.containerNode,region:"center"};b.push(c);var d=S.marginBox2contentBox(this.domNode,a);S.layoutChildren(this.domNode,d,b);this._singleChild?(b=S.marginBox2contentBox(this.containerNode,c),this._singleChild.resize({w:b.w,h:b.h})):
(this.containerNode.style.overflow="auto",this._layoutChildren())}else this._layoutChildren();q("touch")||a||this._position()}},_layoutChildren:function(){g.forEach(this.getChildren(),function(a){a.resize&&a.resize()})},destroy:function(){this._fadeInDeferred&&this._fadeInDeferred.cancel();this._fadeOutDeferred&&this._fadeOutDeferred.cancel();this._moveable&&this._moveable.destroy();for(var a;a=this._modalconnects.pop();)a.remove();V.hide(this);this.inherited(arguments)}});q("dojo-bidi")&&(F=v("dijit._DialogBase",
F,{_setTitleAttr:function(a){this._set("title",a);this.titleNode.innerHTML=a;this.applyTextDir(this.titleNode)},_setTextDirAttr:function(a){this._created&&this.textDir!=a&&(this._set("textDir",a),this.set("title",this.title))}}));var U=v("dijit.Dialog",[Q,F],{});U._DialogBase=F;var V=U._DialogLevelManager={_beginZIndex:950,show:function(a,b){A[A.length-1].focus=G.curNode;var c=A[A.length-1].dialog?A[A.length-1].zIndex+2:U._DialogLevelManager._beginZIndex;f.set(a.domNode,"zIndex",c);M.show(b,c-1);
A.push({dialog:a,underlayAttrs:b,zIndex:c})},hide:function(a){if(A[A.length-1].dialog==a){A.pop();var b=A[A.length-1];1==A.length?M.hide():M.show(b.underlayAttrs,b.zIndex-1);if(a.refocus&&(a=b.focus,!b.dialog||a&&m.isDescendant(a,b.dialog.domNode)||(b.dialog._getFocusItems(),a=b.dialog._firstFocusItem),a))try{a.focus()}catch(l){}}else b=g.indexOf(g.map(A,function(a){return a.dialog}),a),-1!=b&&A.splice(b,1)},isTop:function(a){return A[A.length-1].dialog==a}},A=U._dialogStack=[{dialog:null,focus:null,
underlayAttrs:null}];G.watch("curNode",function(a,b,c){a=A[A.length-1].dialog;if(c&&a&&!a._fadeOutDeferred&&c.ownerDocument==a.ownerDocument){do if(c==a.domNode||u.contains(c,"dijitPopup"))return;while(c=c.parentNode);a.focus()}});q("dijit-legacy-requires")&&w(0,function(){p(["dijit/TooltipDialog"])});return U})},"dojo/dnd/Moveable":function(){define("../_base/array ../_base/declare ../_base/lang ../dom ../dom-class ../Evented ../has ../on ../topic ../touch ./common ./Mover ../_base/window".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){function x(a,b){"touchAction"in document.body.style?w="touchAction":"msTouchAction"in document.body.style&&(w="msTouchAction");q=function(a,b){a.style[w]=b};q(a,b)}var w,q=function(){};u("touch-action")&&(q=x);return g("dojo.dnd.Moveable",[m],{handle:"",delay:0,skip:!1,constructor:function(b,c){this.node=v.byId(b);q(this.node,"none");c||(c={});this.handle=c.handle?v.byId(c.handle):null;this.handle||(this.handle=this.node);this.delay=0<c.delay?c.delay:0;this.skip=
c.skip;this.mover=c.mover?c.mover:a;this.events=[k(this.handle,e.press,t.hitch(this,"onMouseDown")),k(this.handle,"dragstart",t.hitch(this,"onSelectStart")),k(this.handle,"selectstart",t.hitch(this,"onSelectStart"))]},markupFactory:function(a,b,c){return new c(b,a)},destroy:function(){p.forEach(this.events,function(a){a.remove()});q(this.node,"");this.events=this.node=this.handle=null},onMouseDown:function(a){if(!this.skip||!b.isFormElement(a)){if(this.delay)this.events.push(k(this.handle,e.move,
t.hitch(this,"onMouseMove")),k(this.handle.ownerDocument,e.release,t.hitch(this,"onMouseUp"))),this._lastX=a.pageX,this._lastY=a.pageY;else this.onDragDetected(a);a.stopPropagation();a.preventDefault()}},onMouseMove:function(a){if(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)this.onMouseUp(a),this.onDragDetected(a);a.stopPropagation();a.preventDefault()},onMouseUp:function(a){for(var b=0;2>b;++b)this.events.pop().remove();a.stopPropagation();a.preventDefault()},
onSelectStart:function(a){this.skip&&b.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onDragDetected:function(a){new this.mover(this.node,a,this)},onMoveStart:function(a){f.publish("/dnd/move/start",a);n.add(c.body(),"dojoMove");n.add(this.node,"dojoMoveItem")},onMoveStop:function(a){f.publish("/dnd/move/stop",a);n.remove(c.body(),"dojoMove");n.remove(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(a,b){this.onMoving(a,b);var c=a.node.style;c.left=b.l+"px";c.top=b.t+
"px";this.onMoved(a,b)},onMoving:function(){},onMoved:function(){}})})},"dojo/dnd/common":function(){define(["../sniff","../_base/kernel","../_base/lang","../dom"],function(p,g,t,v){var n=t.getObject("dojo.dnd",!0);n.getCopyKeyState=function(g){return g[p("mac")?"metaKey":"ctrlKey"]};n._uniqueId=0;n.getUniqueId=function(){var m;do m=g._scopeName+"Unique"+ ++n._uniqueId;while(v.byId(m));return m};n._empty={};n.isFormElement=function(g){g=g.target;3==g.nodeType&&(g=g.parentNode);return 0<=" a button textarea input select option ".indexOf(" "+
g.tagName.toLowerCase()+" ")};return n})},"dojo/dnd/Mover":function(){define("../_base/array ../_base/declare ../_base/lang ../sniff ../_base/window ../dom ../dom-geometry ../dom-style ../Evented ../on ../touch ./common ./autoscroll".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){return g("dojo.dnd.Mover",[f],{constructor:function(a,f,g){function k(a){a.preventDefault();a.stopPropagation()}this.node=m.byId(a);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;a=a.ownerDocument;
this.events=[e(a,b.move,t.hitch(this,"onFirstMove")),e(a,b.move,t.hitch(this,"onMouseMove")),e(a,b.release,t.hitch(this,"onMouseUp")),e(a,"dragstart",k),e(a.body,"selectstart",k)];c.autoScrollStart(a);if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(a){c.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){(v("webkit")&&v("mac")&&2==this.mouseButton?0==a.button:this.mouseButton==a.button)&&
this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=this.node.style,c,e=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=u.getMarginBox(this.node);c=n.doc.body;var f=k.getComputedStyle(c),g=u.getMarginBox(c,f),f=u.getContentBox(c,f);c=b.l-(f.l-g.l);b=b.t-(f.t-g.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(e&&e.onFirstMove)e.onFirstMove(this,
a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"dojo/dnd/autoscroll":function(){define("../_base/lang ../sniff ../_base/window ../dom-geometry ../dom-style ../window".split(" "),function(p,g,t,v,n,m){var u={};p.setObject("dojo.dnd.autoscroll",u);u.getViewport=m.getBox;u.V_TRIGGER_AUTOSCROLL=32;u.H_TRIGGER_AUTOSCROLL=32;u.V_AUTOSCROLL_VALUE=16;u.H_AUTOSCROLL_VALUE=
16;var k,f=t.doc,e=Infinity,b=Infinity;u.autoScrollStart=function(a){f=a;k=m.getBox(f);a=t.body(f).parentNode;e=Math.max(a.scrollHeight-k.h,0);b=Math.max(a.scrollWidth-k.w,0)};u.autoScroll=function(a){var c=k||m.getBox(f),g=t.body(f).parentNode,n=0,q=0;a.clientX<u.H_TRIGGER_AUTOSCROLL?n=-u.H_AUTOSCROLL_VALUE:a.clientX>c.w-u.H_TRIGGER_AUTOSCROLL&&(n=Math.min(u.H_AUTOSCROLL_VALUE,b-g.scrollLeft));a.clientY<u.V_TRIGGER_AUTOSCROLL?q=-u.V_AUTOSCROLL_VALUE:a.clientY>c.h-u.V_TRIGGER_AUTOSCROLL&&(q=Math.min(u.V_AUTOSCROLL_VALUE,
e-g.scrollTop));window.scrollBy(n,q)};u._validNodes={div:1,p:1,td:1};u._validOverflow={auto:1,scroll:1};u.autoScrollNodes=function(a){for(var b,e,f,k,m,p=0,E=0,B=a.target;B;){if(1==B.nodeType&&B.tagName.toLowerCase()in u._validNodes){f=n.getComputedStyle(B);m=f.overflowX.toLowerCase()in u._validOverflow;k=f.overflowY.toLowerCase()in u._validOverflow;if(m||k)b=v.getContentBox(B,f),e=v.position(B,!0);if(m){f=Math.min(u.H_TRIGGER_AUTOSCROLL,b.w/2);m=a.pageX-e.x;if(g("webkit")||g("opera"))m+=t.body().scrollLeft;
p=0;0<m&&m<b.w&&(m<f?p=-f:m>b.w-f&&(p=f),B.scrollLeft+=p)}if(k){k=Math.min(u.V_TRIGGER_AUTOSCROLL,b.h/2);f=a.pageY-e.y;if(g("webkit")||g("opera"))f+=t.body().scrollTop;E=0;0<f&&f<b.h&&(f<k?E=-k:f>b.h-k&&(E=k),B.scrollTop+=E)}if(p||E)return}try{B=B.parentNode}catch(G){B=null}}u.autoScroll(a)};return u})},"dojo/dnd/TimedMoveable":function(){define(["../_base/declare","./Moveable"],function(p,g){var t=g.prototype.onMove;return p("dojo.dnd.TimedMoveable",g,{timeout:40,constructor:function(g,n){n||(n=
{});n.timeout&&"number"==typeof n.timeout&&0<=n.timeout&&(this.timeout=n.timeout)},onMoveStop:function(p){p._timer&&(clearTimeout(p._timer),t.call(this,p,p._leftTop));g.prototype.onMoveStop.apply(this,arguments)},onMove:function(g,n){g._leftTop=n;if(!g._timer){var m=this;g._timer=setTimeout(function(){g._timer=null;t.call(m,g,g._leftTop)},this.timeout)}}})})},"dijit/_base/manager":function(){define(["dojo/_base/array","dojo/_base/config","dojo/_base/lang","../registry","../main"],function(p,g,t,v,
n){var m={};p.forEach("byId getUniqueId findWidgets _destroyAll byNode getEnclosingWidget".split(" "),function(g){m[g]=v[g]});t.mixin(m,{defaultDuration:g.defaultDuration||200});t.mixin(n,m);return n})},"dijit/_CssStateMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-class dojo/has dojo/_base/lang dojo/on dojo/domReady dojo/touch dojo/_base/window ./a11yclick ./registry".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a){g=g("dijit._CssStateMixin",[],{hovering:!1,active:!1,
_applyAttributes:function(){this.inherited(arguments);p.forEach("disabled readOnly checked selected focused state hovering active _opened".split(" "),function(a){this.watch(a,m.hitch(this,"_setStateClass"))},this);for(var a in this.cssStateNodes||{})this._trackMouseState(this[a],this.cssStateNodes[a]);this._trackMouseState(this.domNode,this.baseClass);this._setStateClass()},_cssMouseEvent:function(a){if(!this.disabled)switch(a.type){case "mouseover":case "MSPointerOver":case "pointerover":this._set("hovering",
!0);this._set("active",this._mouseDown);break;case "mouseout":case "MSPointerOut":case "pointerout":this._set("hovering",!1);this._set("active",!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":this._set("active",!0);break;case "mouseup":case "dojotouchend":case "MSPointerUp":case "pointerup":case "keyup":this._set("active",!1)}},_setStateClass:function(){function a(a){b=b.concat(p.map(b,function(b){return b+a}),"dijit"+a)}var b=this.baseClass.split(" ");
this.isLeftToRight()||a("Rtl");var e="mixed"==this.checked?"Mixed":this.checked?"Checked":"";this.checked&&a(e);this.state&&a(this.state);this.selected&&a("Selected");this._opened&&a("Opened");this.disabled?a("Disabled"):this.readOnly?a("ReadOnly"):this.active?a("Active"):this.hovering&&a("Hover");this.focused&&a("Focused");var e=this.stateNode||this.domNode,f={};p.forEach(e.className.split(" "),function(a){f[a]=!0});"_stateClasses"in this&&p.forEach(this._stateClasses,function(a){delete f[a]});p.forEach(b,
function(a){f[a]=!0});var g=[],k;for(k in f)g.push(k);e.className=g.join(" ");this._stateClasses=b},_subnodeCssMouseEvent:function(a,b,e){function c(c){v.toggle(a,b+"Active",c)}if(!this.disabled&&!this.readOnly)switch(e.type){case "mouseover":case "MSPointerOver":case "pointerover":v.toggle(a,b+"Hover",!0);break;case "mouseout":case "MSPointerOut":case "pointerout":v.toggle(a,b+"Hover",!1);c(!1);break;case "mousedown":case "touchstart":case "MSPointerDown":case "pointerdown":case "keydown":c(!0);
break;case "mouseup":case "MSPointerUp":case "pointerup":case "dojotouchend":case "keyup":c(!1);break;case "focus":case "focusin":v.toggle(a,b+"Focused",!0);break;case "blur":case "focusout":v.toggle(a,b+"Focused",!1)}},_trackMouseState:function(a,b){a._cssState=b}});k(function(){function c(b,c,e){if(!e||!t.isDescendant(e,c))for(;c&&c!=e;c=c.parentNode)if(c._cssState){var f=a.getEnclosingWidget(c);f&&(c==f.domNode?f._cssMouseEvent(b):f._subnodeCssMouseEvent(c,c._cssState,b))}}var g=e.body(),k;u(g,
f.over,function(a){c(a,a.target,a.relatedTarget)});u(g,f.out,function(a){c(a,a.target,a.relatedTarget)});u(g,b.press,function(a){k=a.target;c(a,k)});u(g,b.release,function(a){c(a,k);k=null});u(g,"focusin, focusout",function(b){var c=b.target;if(c._cssState&&!c.getAttribute("widgetId")){var e=a.getEnclosingWidget(c);e&&e._subnodeCssMouseEvent(c,c._cssState,b)}})});return g})},"dijit/form/_FormMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/on dojo/window".split(" "),
function(p,g,t,v,n,m){return g("dijit.form._FormMixin",null,{state:"",_getDescendantFormWidgets:function(g){var k=[];p.forEach(g||this.getChildren(),function(f){"value"in f?k.push(f):k=k.concat(this._getDescendantFormWidgets(f.getChildren()))},this);return k},reset:function(){p.forEach(this._getDescendantFormWidgets(),function(g){g.reset&&g.reset()})},validate:function(){var g=!1;return p.every(p.map(this._getDescendantFormWidgets(),function(k){k._hasBeenBlurred=!0;var f=k.disabled||!k.validate||
k.validate();f||g||(m.scrollIntoView(k.containerNode||k.domNode),k.focus(),g=!0);return f}),function(g){return g})},setValues:function(g){t.deprecated(this.declaredClass+"::setValues() is deprecated. Use set('value', val) instead.","","2.0");return this.set("value",g)},_setValueAttr:function(g){var k={};p.forEach(this._getDescendantFormWidgets(),function(a){a.name&&(k[a.name]||(k[a.name]=[])).push(a)});for(var f in k)if(k.hasOwnProperty(f)){var e=k[f],b=v.getObject(f,!1,g);void 0!==b&&(b=[].concat(b),
"boolean"==typeof e[0].checked?p.forEach(e,function(a){a.set("value",-1!=p.indexOf(b,a._get("value")))}):e[0].multiple?e[0].set("value",b):p.forEach(e,function(a,c){a.set("value",b[c])}))}},getValues:function(){t.deprecated(this.declaredClass+"::getValues() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},_getValueAttr:function(){var g={};p.forEach(this._getDescendantFormWidgets(),function(k){var f=k.name;if(f&&!k.disabled){var e=k.get("value");"boolean"==typeof k.checked?
/Radio/.test(k.declaredClass)?!1!==e?v.setObject(f,e,g):(e=v.getObject(f,!1,g),void 0===e&&v.setObject(f,null,g)):(k=v.getObject(f,!1,g),k||(k=[],v.setObject(f,k,g)),!1!==e&&k.push(e)):(k=v.getObject(f,!1,g),"undefined"!=typeof k?v.isArray(k)?k.push(e):v.setObject(f,[k,e],g):v.setObject(f,e,g))}});return g},isValid:function(){return""==this.state},onValidStateChange:function(){},_getState:function(){var g=p.map(this._descendants,function(g){return g.get("state")||""});return 0<=p.indexOf(g,"Error")?
"Error":0<=p.indexOf(g,"Incomplete")?"Incomplete":""},disconnectChildren:function(){},connectChildren:function(g){this._descendants=this._getDescendantFormWidgets();p.forEach(this._descendants,function(g){g._started||g.startup()});g||this._onChildChange()},_onChildChange:function(g){g&&"state"!=g&&"disabled"!=g||this._set("state",this._getState());g&&"value"!=g&&"disabled"!=g&&"checked"!=g||(this._onChangeDelayTimer&&this._onChangeDelayTimer.remove(),this._onChangeDelayTimer=this.defer(function(){delete this._onChangeDelayTimer;
this._set("value",this.get("value"))},10))},startup:function(){this.inherited(arguments);this._descendants=this._getDescendantFormWidgets();this.value=this.get("value");this.state=this._getState();var g=this;this.own(n(this.containerNode,"attrmodified-state, attrmodified-disabled, attrmodified-value, attrmodified-checked",function(k){k.target!=g.domNode&&g._onChildChange(k.type.replace("attrmodified-",""))}));this.watch("state",function(g,f,e){this.onValidStateChange(""==e)})},destroy:function(){this.inherited(arguments)}})})},
"dijit/_DialogMixin":function(){define(["dojo/_base/declare","./a11y"],function(p,g){return p("dijit._DialogMixin",null,{actionBarTemplate:"",execute:function(){},onCancel:function(){},onExecute:function(){},_onSubmit:function(){this.onExecute();this.execute(this.get("value"))},_getFocusItems:function(){var p=g._getTabNavigable(this.domNode);this._firstFocusItem=p.lowest||p.first||this.closeButtonNode||this.domNode;this._lastFocusItem=p.last||p.highest||this._firstFocusItem}})})},"dijit/DialogUnderlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/aspect dojo/dom-attr dojo/dom-style dojo/on dojo/window ./_Widget ./_TemplatedMixin ./BackgroundIframe ./Viewport ./main".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){var c=p("dijit.DialogUnderlay",[k,f],{templateString:"\x3cdiv class\x3d'dijitDialogUnderlayWrapper'\x3e\x3cdiv class\x3d'dijitDialogUnderlay' tabIndex\x3d'-1' data-dojo-attach-point\x3d'node'\x3e\x3c/div\x3e\x3c/div\x3e",dialogId:"","class":"",_modalConnects:[],_setDialogIdAttr:function(a){v.set(this.node,"id",a+"_underlay");this._set("dialogId",a)},_setClassAttr:function(a){this.node.className="dijitDialogUnderlay "+a;this._set("class",a)},postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);
this.own(m(this.domNode,"keydown",g.hitch(this,"_onKeyDown")));this.inherited(arguments)},layout:function(){var a=this.node.style,b=this.domNode.style;b.display="none";var c=u.getBox(this.ownerDocument);b.top=c.t+"px";b.left=c.l+"px";a.width=c.w+"px";a.height=c.h+"px";b.display="block"},show:function(){this.domNode.style.display="block";this.open=!0;this.layout();this.bgIframe=new e(this.domNode);var a=u.get(this.ownerDocument);this._modalConnects=[b.on("resize",g.hitch(this,"layout")),m(a,"scroll",
g.hitch(this,"layout"))]},hide:function(){this.bgIframe.destroy();delete this.bgIframe;for(this.domNode.style.display="none";this._modalConnects.length;)this._modalConnects.pop().remove();this.open=!1},destroy:function(){for(;this._modalConnects.length;)this._modalConnects.pop().remove();this.inherited(arguments)},_onKeyDown:function(){}});c.show=function(b,e){var f=c._singleton;!f||f._destroyed?f=a._underlay=c._singleton=new c(b):b&&f.set(b);n.set(f.domNode,"zIndex",e);f.open||f.show()};c.hide=function(){var a=
c._singleton;a&&!a._destroyed&&a.hide()};return c})},"dijit/BackgroundIframe":function(){define("require ./main dojo/_base/config dojo/dom-construct dojo/dom-style dojo/_base/lang dojo/on dojo/sniff".split(" "),function(p,g,t,v,n,m,u,k){k.add("config-bgIframe",(k("ie")||k("trident"))&&!/IEMobile\/10\.0/.test(navigator.userAgent));var f=new function(){var e=[];this.pop=function(){var b;e.length?(b=e.pop(),b.style.display=""):(9>k("ie")?(b=t.dojoBlankHtmlUrl||p.toUrl("dojo/resources/blank.html")||'javascript:""',
b=document.createElement("\x3ciframe src\x3d'"+b+"' role\x3d'presentation' style\x3d'position: absolute; left: 0px; top: 0px;z-index: -1; filter:Alpha(Opacity\x3d\"0\");'\x3e")):(b=v.create("iframe"),b.src='javascript:""',b.className="dijitBackgroundIframe",b.setAttribute("role","presentation"),n.set(b,"opacity",.1)),b.tabIndex=-1);return b};this.push=function(b){b.style.display="none";e.push(b)}};g.BackgroundIframe=function(e){if(!e.id)throw Error("no id");if(k("config-bgIframe")){var b=this.iframe=
f.pop();e.appendChild(b);7>k("ie")||k("quirks")?(this.resize(e),this._conn=u(e,"resize",m.hitch(this,"resize",e))):n.set(b,{width:"100%",height:"100%"})}};m.extend(g.BackgroundIframe,{resize:function(e){this.iframe&&n.set(this.iframe,{width:e.offsetWidth+"px",height:e.offsetHeight+"px"})},destroy:function(){this._conn&&(this._conn.remove(),this._conn=null);this.iframe&&(this.iframe.parentNode.removeChild(this.iframe),f.push(this.iframe),delete this.iframe)}});return g.BackgroundIframe})},"dijit/Viewport":function(){define(["dojo/Evented",
"dojo/on","dojo/domReady","dojo/sniff","dojo/window"],function(p,g,t,v,n){var m=new p,u;t(function(){var k=n.getBox();m._rlh=g(window,"resize",function(){var e=n.getBox();if(k.h!=e.h||k.w!=e.w)k=e,m.emit("resize")});if(8==v("ie")){var f=screen.deviceXDPI;setInterval(function(){screen.deviceXDPI!=f&&(f=screen.deviceXDPI,m.emit("resize"))},500)}v("ios")&&(g(document,"focusin",function(e){u=e.target}),g(document,"focusout",function(e){u=null}))});m.getEffectiveBox=function(g){g=n.getBox(g);var f=u&&
u.tagName&&u.tagName.toLowerCase();v("ios")&&u&&!u.readOnly&&("textarea"==f||"input"==f&&/^(color|email|number|password|search|tel|text|url)$/.test(u.type))&&(g.h*=0==orientation||180==orientation?.66:.4,f=u.getBoundingClientRect(),g.h=Math.max(g.h,f.top+f.height));return g};return m})},"dijit/layout/ContentPane":function(){define("dojo/_base/kernel dojo/_base/lang ../_Widget ../_Container ./_ContentPaneResizeMixin dojo/string dojo/html dojo/_base/array dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-construct dojo/_base/xhr dojo/i18n dojo/when dojo/i18n!../nls/loading".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){return f("dijit.layout.ContentPane",[t,v,n],{href:"",content:"",extractContent:!1,parseOnLoad:!0,parserScope:p._scopeName,preventCache:!1,preload:!1,refreshOnShow:!1,loadingMessage:"\x3cspan class\x3d'dijitContentPaneLoading'\x3e\x3cspan class\x3d'dijitInline dijitIconLoading'\x3e\x3c/span\x3e${loadingState}\x3c/span\x3e",errorMessage:"\x3cspan class\x3d'dijitContentPaneError'\x3e\x3cspan class\x3d'dijitInline dijitIconError'\x3e\x3c/span\x3e${errorState}\x3c/span\x3e",
isLoaded:!1,baseClass:"dijitContentPane",ioArgs:{},onLoadDeferred:null,_setTitleAttr:null,stopParser:!0,template:!1,markupFactory:function(a,b,c){var e=new c(a,b);return!e.href&&e._contentSetter&&e._contentSetter.parseDeferred&&!e._contentSetter.parseDeferred.isFulfilled()?e._contentSetter.parseDeferred.then(function(){return e}):e},create:function(a,c){if(!(a&&a.template||!c||"href"in a||"content"in a)){c=b.byId(c);for(var e=c.ownerDocument.createDocumentFragment();c.firstChild;)e.appendChild(c.firstChild);
a=g.delegate(a,{content:e})}this.inherited(arguments,[a,c])},postMixInProperties:function(){this.inherited(arguments);var a=w.getLocalization("dijit","loading",this.lang);this.loadingMessage=m.substitute(this.loadingMessage,a);this.errorMessage=m.substitute(this.errorMessage,a)},buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.domNode.removeAttribute("title")},startup:function(){this.inherited(arguments);this._contentSetter&&k.forEach(this._contentSetter.parseResults,
function(a){a._started||a._destroyed||!g.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},_startChildren:function(){k.forEach(this.getChildren(),function(a){a._started||a._destroyed||!g.isFunction(a.startup)||(a.startup(),a._started=!0)});this._contentSetter&&k.forEach(this._contentSetter.parseResults,function(a){a._started||a._destroyed||!g.isFunction(a.startup)||(a.startup(),a._started=!0)},this)},setHref:function(a){p.deprecated("dijit.layout.ContentPane.setHref() is deprecated. Use set('href', ...) instead.",
"","2.0");return this.set("href",a)},_setHrefAttr:function(a){this.cancel();this.onLoadDeferred=new e(g.hitch(this,"cancel"));this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._set("href",a);this.preload||this._created&&this._isShown()?this._load():this._hrefChanged=!0;return this.onLoadDeferred},setContent:function(a){p.deprecated("dijit.layout.ContentPane.setContent() is deprecated.  Use set('content', ...) instead.","","2.0");this.set("content",a)},_setContentAttr:function(a){this._set("href",
"");this.cancel();this.onLoadDeferred=new e(g.hitch(this,"cancel"));this._created&&this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._setContent(a||"");this._isDownloaded=!1;return this.onLoadDeferred},_getContentAttr:function(){return this.containerNode.innerHTML},cancel:function(){this._xhrDfd&&-1==this._xhrDfd.fired&&this._xhrDfd.cancel();delete this._xhrDfd;this.onLoadDeferred=null},destroy:function(){this.cancel();this.inherited(arguments)},destroyRecursive:function(a){this._beingDestroyed||
this.inherited(arguments)},_onShow:function(){this.inherited(arguments);if(this.href&&!this._xhrDfd&&(!this.isLoaded||this._hrefChanged||this.refreshOnShow))return this.refresh()},refresh:function(){this.cancel();this.onLoadDeferred=new e(g.hitch(this,"cancel"));this.onLoadDeferred.then(g.hitch(this,"onLoad"));this._load();return this.onLoadDeferred},_load:function(){this._setContent(this.onDownloadStart(),!0);var a=this,b={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text"};
g.isObject(this.ioArgs)&&g.mixin(b,this.ioArgs);var c=this._xhrDfd=(this.ioMethod||x.get)(b),e;c.then(function(b){e=b;try{return a._isDownloaded=!0,a._setContent(b,!1)}catch(F){a._onError("Content",F)}},function(b){c.canceled||a._onError("Download",b);delete a._xhrDfd;return b}).then(function(){a.onDownloadEnd();delete a._xhrDfd;return e});delete this._hrefChanged},_onLoadHandler:function(a){this._set("isLoaded",!0);try{this.onLoadDeferred.resolve(a)}catch(z){console.error("Error "+(this.widgetId||
this.id)+" running custom onLoad code: "+z.message)}},_onUnloadHandler:function(){this._set("isLoaded",!1);try{this.onUnload()}catch(C){console.error("Error "+this.widgetId+" running custom onUnload code: "+C.message)}},destroyDescendants:function(a){this.isLoaded&&this._onUnloadHandler();var b=this._contentSetter;k.forEach(this.getChildren(),function(b){b.destroyRecursive?b.destroyRecursive(a):b.destroy&&b.destroy(a);b._destroyed=!0});b&&(k.forEach(b.parseResults,function(b){b._destroyed||(b.destroyRecursive?
b.destroyRecursive(a):b.destroy&&b.destroy(a),b._destroyed=!0)}),delete b.parseResults);a||c.empty(this.containerNode);delete this._singleChild},_setContent:function(a,b){a=this.preprocessContent(a);this.destroyDescendants();var c=this._contentSetter;c&&c instanceof u._ContentSetter||(c=this._contentSetter=new u._ContentSetter({node:this.containerNode,_onError:g.hitch(this,this._onError),onContentError:g.hitch(this,function(a){a=this.onContentError(a);try{this.containerNode.innerHTML=a}catch(D){console.error("Fatal "+
this.id+" could not change content due to "+D.message,D)}})}));var e=g.mixin({cleanContent:this.cleanContent,extractContent:this.extractContent,parseContent:!a.domNode&&this.parseOnLoad,parserScope:this.parserScope,startup:!1,dir:this.dir,lang:this.lang,textDir:this.textDir},this._contentSetterParams||{}),e=c.set(g.isObject(a)&&a.domNode?a.domNode:a,e),f=this;return q(e&&e.then?e:c.parseDeferred,function(){delete f._contentSetterParams;b||(f._started&&(f._startChildren(),f._scheduleLayout()),f._onLoadHandler(a))})},
preprocessContent:function(a){return a},_onError:function(a,b,c){this.onLoadDeferred.reject(b);a=this["on"+a+"Error"].call(this,b);c?console.error(c,b):a&&this._setContent(a,!0)},onLoad:function(){},onUnload:function(){},onDownloadStart:function(){return this.loadingMessage},onContentError:function(){},onDownloadError:function(){return this.errorMessage},onDownloadEnd:function(){}})})},"dijit/_Container":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dojo/_base/kernel"],
function(p,g,t,v){return g("dijit._Container",null,{buildRendering:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode)},addChild:function(g,m){var n=this.containerNode;if(0<m){for(n=n.firstChild;0<m;)1==n.nodeType&&m--,n=n.nextSibling;n?m="before":(n=this.containerNode,m="last")}t.place(g.domNode,n,m);this._started&&!g._started&&g.startup()},removeChild:function(g){"number"==typeof g&&(g=this.getChildren()[g]);g&&(g=g.domNode)&&g.parentNode&&g.parentNode.removeChild(g)},
hasChildren:function(){return 0<this.getChildren().length},_getSiblingOfChild:function(g,m){var n=this.getChildren();g=p.indexOf(n,g);return n[g+m]},getIndexOfChild:function(g){return p.indexOf(this.getChildren(),g)}})})},"dijit/layout/_ContentPaneResizeMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/query ../registry ../Viewport ./utils".split(" "),function(p,g,t,v,n,m,u,k,f,e){return g("dijit.layout._ContentPaneResizeMixin",
null,{doLayout:!0,isLayoutContainer:!0,startup:function(){if(!this._started){var b=this.getParent();this._childOfLayoutWidget=b&&b.isLayoutContainer;this._needLayout=!this._childOfLayoutWidget;this.inherited(arguments);this._isShown()&&this._onShow();this._childOfLayoutWidget||this.own(f.on("resize",m.hitch(this,"resize")))}},_checkIfSingleChild:function(){if(this.doLayout){var b=[],a=!1;u("\x3e *",this.containerNode).some(function(c){var e=k.byNode(c);e&&e.resize?b.push(e):!/script|link|style/i.test(c.nodeName)&&
c.offsetHeight&&(a=!0)});this._singleChild=1!=b.length||a?null:b[0];t.toggle(this.containerNode,this.baseClass+"SingleChild",!!this._singleChild)}},resize:function(b,a){this._resizeCalled=!0;this._scheduleLayout(b,a)},_scheduleLayout:function(b,a){this._isShown()?this._layout(b,a):(this._needLayout=!0,this._changeSize=b,this._resultSize=a)},_layout:function(b,a){delete this._needLayout;this._wasShown||!1===this.open||this._onShow();b&&v.setMarginBox(this.domNode,b);var c=this.containerNode;c===this.domNode?
(a=a||{},m.mixin(a,b||{}),"h"in a&&"w"in a||(a=m.mixin(v.getMarginBox(c),a)),this._contentBox=e.marginBox2contentBox(c,a)):this._contentBox=v.getContentBox(c);this._layoutChildren()},_layoutChildren:function(){this._checkIfSingleChild();if(this._singleChild&&this._singleChild.resize){var b=this._contentBox||v.getContentBox(this.containerNode);this._singleChild.resize({w:b.w,h:b.h})}else for(var b=this.getChildren(),a,c=0;a=b[c++];)a.resize&&a.resize()},_isShown:function(){if(this._childOfLayoutWidget)return this._resizeCalled&&
"open"in this?this.open:this._resizeCalled;if("open"in this)return this.open;var b=this.domNode,a=this.domNode.parentNode;return"none"!=b.style.display&&"hidden"!=b.style.visibility&&!t.contains(b,"dijitHidden")&&a&&a.style&&"none"!=a.style.display},_onShow:function(){this._wasShown=!0;this._needLayout&&this._layout(this._changeSize,this._resultSize);this.inherited(arguments)}})})},"dijit/layout/utils":function(){define(["dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/lang"],
function(p,g,t,v,n){function m(f){return f.substring(0,1).toUpperCase()+f.substring(1)}function u(f,e){var b=f.resize?f.resize(e):t.setMarginBox(f.domNode,e);b?n.mixin(f,b):(n.mixin(f,t.getMarginBox(f.domNode)),n.mixin(f,e))}var k={marginBox2contentBox:function(f,e){var b=v.getComputedStyle(f),a=t.getMarginExtents(f,b),c=t.getPadBorderExtents(f,b);return{l:v.toPixelValue(f,b.paddingLeft),t:v.toPixelValue(f,b.paddingTop),w:e.w-(a.w+c.w),h:e.h-(a.h+c.h)}},layoutChildren:function(f,e,b,a,c){e=n.mixin({},
e);g.add(f,"dijitLayoutContainer");b=p.filter(b,function(a){return"center"!=a.region&&"client"!=a.layoutAlign}).concat(p.filter(b,function(a){return"center"==a.region||"client"==a.layoutAlign}));p.forEach(b,function(b){var f=b.domNode,k=b.region||b.layoutAlign;if(!k)throw Error("No region setting for "+b.id);var n=f.style;n.left=e.l+"px";n.top=e.t+"px";n.position="absolute";g.add(f,"dijitAlign"+m(k));f={};a&&a==b.id&&(f["top"==b.region||"bottom"==b.region?"h":"w"]=c);"leading"==k&&(k=b.isLeftToRight()?
"left":"right");"trailing"==k&&(k=b.isLeftToRight()?"right":"left");"top"==k||"bottom"==k?(f.w=e.w,u(b,f),e.h-=b.h,"top"==k?e.t+=b.h:n.top=e.t+e.h+"px"):"left"==k||"right"==k?(f.h=e.h,u(b,f),e.w-=b.w,"left"==k?e.l+=b.w:n.left=e.l+e.w+"px"):"client"!=k&&"center"!=k||u(b,e)})}};n.setObject("dijit.layout.utils",k);return k})},"dojo/html":function(){define("./_base/kernel ./_base/lang ./_base/array ./_base/declare ./dom ./dom-construct ./parser".split(" "),function(p,g,t,v,n,m,u){var k=0,f={_secureForInnerHtml:function(e){return e.replace(/(?:\s*<!DOCTYPE\s[^>]+>|<title[^>]*>[\s\S]*?<\/title>)/ig,
"")},_emptyNode:m.empty,_setNodeContent:function(e,b){m.empty(e);if(b)if("number"==typeof b&&(b=b.toString()),"string"==typeof b&&(b=m.toDom(b,e.ownerDocument)),!b.nodeType&&g.isArrayLike(b))for(var a=b.length,c=0;c<b.length;c=a==b.length?c+1:0)m.place(b[c],e,"last");else m.place(b,e,"last");return e},_ContentSetter:v("dojo.html._ContentSetter",null,{node:"",content:"",id:"",cleanContent:!1,extractContent:!1,parseContent:!1,parserScope:p._scopeName,startup:!0,constructor:function(e,b){g.mixin(this,
e||{});b=this.node=n.byId(this.node||b);this.id||(this.id=["Setter",b?b.id||b.tagName:"",k++].join("_"))},set:function(e,b){void 0!==e&&(this.content=e);"number"==typeof e&&(e=e.toString());b&&this._mixin(b);this.onBegin();this.setContent();return(e=this.onEnd())&&e.then?e:this.node},setContent:function(){var e=this.node;if(!e)throw Error(this.declaredClass+": setContent given no node");try{e=f._setNodeContent(e,this.content)}catch(a){var b=this.onContentError(a);try{e.innerHTML=b}catch(c){console.error("Fatal "+
this.declaredClass+".setContent could not change content due to "+c.message,c)}}this.node=e},empty:function(){this.parseDeferred&&(this.parseDeferred.isResolved()||this.parseDeferred.cancel(),delete this.parseDeferred);this.parseResults&&this.parseResults.length&&(t.forEach(this.parseResults,function(e){e.destroy&&e.destroy()}),delete this.parseResults);m.empty(this.node)},onBegin:function(){var e=this.content;if(g.isString(e)&&(this.cleanContent&&(e=f._secureForInnerHtml(e)),this.extractContent)){var b=
e.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(e=b[1])}this.empty();this.content=e;return this.node},onEnd:function(){this.parseContent&&this._parse();return this.node},tearDown:function(){delete this.parseResults;delete this.parseDeferred;delete this.node;delete this.content},onContentError:function(e){return"Error occurred setting content: "+e},onExecError:function(e){return"Error occurred executing scripts: "+e},_mixin:function(e){var b={},a;for(a in e)a in b||(this[a]=e[a])},_parse:function(){var e=
this.node;try{var b={};t.forEach(["dir","lang","textDir"],function(a){this[a]&&(b[a]=this[a])},this);var a=this;this.parseDeferred=u.parse({rootNode:e,noStart:!this.startup,inherited:b,scope:this.parserScope}).then(function(b){return a.parseResults=b},function(b){a._onError("Content",b,"Error parsing in _ContentSetter#"+a.id)})}catch(c){this._onError("Content",c,"Error parsing in _ContentSetter#"+this.id)}},_onError:function(e,b,a){e=this["on"+e+"Error"].call(this,b);a?console.error(a,b):e&&f._setNodeContent(this.node,
e,!0)}}),set:function(e,b,a){void 0==b&&(console.warn("dojo.html.set: no cont argument provided, using empty string"),b="");"number"==typeof b&&(b=b.toString());return a?(new f._ContentSetter(g.mixin(a,{content:b,node:e}))).set():f._setNodeContent(e,b,!0)}};g.setObject("dojo.html",f);return f})},"esri/Credential":function(){define(["dojo/_base/declare","dojo/has","./kernel","./IdentityManagerBase"],function(p,g,t,v){return p(v.Credential,{})})},"esri/IdentityManagerBase":function(){define("dojo/_base/declare dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/_base/url dojo/sniff dojo/cookie dojo/io-query dojo/on dojo/regexp ./kernel ./config ./lang ./ServerInfo ./urlUtils ./deferredUtils ./request ./Evented ./OAuthCredential ./arcgis/OAuthInfo".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F){var D={},I=function(a){var b=(new u(a.owningSystemUrl)).host;a=(new u(a.server)).host;var c=/.+\.arcgis\.com$/i;return c.test(b)&&c.test(a)},K=function(a,b){return!!(I(a)&&b&&v.some(b,function(b){return b.test(a.server)}))},J,L=p(B,{declaredClass:"esri.IdentityManagerBase",constructor:function(){this._portalConfig=t.getObject("esriGeowConfig");this.serverInfos=[];this.oAuthInfos=[];this.credentials=[];this._soReqs=[];this._xoReqs=[];this._portals=
[];this._getOAuthHash();b(window,"pageshow",t.hitch(this,this._pageShowHandler))},defaultOAuthInfo:null,defaultTokenValidity:60,tokenValidity:null,signInPage:null,useSignInPage:!0,normalizeWebTierAuth:!1,_busy:null,_rejectOnPersistedPageShow:!1,_oAuthHash:null,_gwTokenUrl:"/sharing/generateToken",_agsRest:"/rest/services",_agsPortal:/\/sharing(\/|$)/i,_agsAdmin:/https?:\/\/[^\/]+\/[^\/]+\/admin\/?(\/.*)?$/i,_adminSvcs:/\/admin\/services(\/|$)/i,_agolSuffix:".arcgis.com",_gwDomains:[{regex:/https?:\/\/www\.arcgis\.com/i,
tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/dev\.arcgis\.com/i,tokenServiceUrl:"https://dev.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*dev[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://devext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*qa[^.]*\.arcgis\.com/i,tokenServiceUrl:"https://qaext.arcgis.com/sharing/generateToken"},{regex:/https?:\/\/.*\.arcgis\.com/i,tokenServiceUrl:"https://www.arcgis.com/sharing/generateToken"}],_legacyFed:[],
_regexSDirUrl:/http.+\/rest\/services\/?/ig,_regexServerType:/(\/(MapServer|GeocodeServer|GPServer|GeometryServer|ImageServer|NAServer|FeatureServer|GeoDataServer|GlobeServer|MobileServer|GeoenrichmentServer|VectorTileServer)).*/ig,_gwUser:/http.+\/users\/([^\/]+)\/?.*/i,_gwItem:/http.+\/items\/([^\/]+)\/?.*/i,_gwGroup:/http.+\/groups\/([^\/]+)\/?.*/i,_errorCodes:[499,498,403,401],_rePortalTokenSvc:/\/sharing(\/rest)?\/generatetoken/i,_publicUrls:[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,
/\/rest\/info/i],_createDefaultOAuthInfo:!0,_hasTestedIfAppIsOnPortal:!1,registerServers:function(a){var b=this.serverInfos;b?(a=v.filter(a,function(a){return!this.findServerInfo(a.server)},this),this.serverInfos=b.concat(a)):this.serverInfos=a;v.forEach(a,function(a){a.owningSystemUrl&&this._portals.push(a.owningSystemUrl);if(a.hasPortal){this._portals.push(a.server);var b=x.defaults.io.corsEnabledServers,c=this._getOrigin(a.tokenServiceUrl);C.canUseXhr(a.server)||b.push(a.server.replace(/^https?:\/\//i,
""));C.canUseXhr(c)||b.push(c.replace(/^https?:\/\//i,""))}},this)},registerOAuthInfos:function(a){var b=this.oAuthInfos;b?(a=v.filter(a,function(a){return!this.findOAuthInfo(a.portalUrl)},this),this.oAuthInfos=b.concat(a)):this.oAuthInfos=a},registerToken:function(a){a=w.mixin({},a);var b=this._sanitizeUrl(a.server),c=this.findServerInfo(b),e=!0,f;c||(c=new q,c.server=this._getServerInstanceRoot(b),c.tokenServiceUrl=this._getTokenSvcUrl(b),c.hasPortal=!0,this.registerServers([c]));(f=this.findCredential(b,
a.userId))?(delete a.server,t.mixin(f,a),e=!1):(f=new J({userId:a.userId,server:c.server,token:a.token,expires:a.expires,ssl:a.ssl,scope:this._isServerRsrc(b)?"server":"portal"}),f.resources=[b],this.credentials.push(f));f.onTokenChange(!1);e||f.refreshServerTokens()},toJson:function(){return w.fixJson({serverInfos:v.map(this.serverInfos,function(a){return a.toJson()}),oAuthInfos:v.map(this.oAuthInfos,function(a){return a.toJson()}),credentials:v.map(this.credentials,function(a){return a.toJson()})})},
initialize:function(a){if(a){t.isString(a)&&(a=m.fromJson(a));var b=a.serverInfos,c=a.oAuthInfos;a=a.credentials;if(b){var e=[];v.forEach(b,function(a){a.server&&a.tokenServiceUrl&&e.push(a.declaredClass?a:new q(a))});e.length&&this.registerServers(e)}if(c){var f=[];v.forEach(c,function(a){a.appId&&f.push(a.declaredClass?a:new F(a))});f.length&&this.registerOAuthInfos(f)}a&&v.forEach(a,function(a){a.userId&&a.server&&a.token&&a.expires&&a.expires>(new Date).getTime()&&(a=a.declaredClass?a:new J(a),
a.onTokenChange(),this.credentials.push(a))},this)}},findServerInfo:function(a){var b;a=this._sanitizeUrl(a);v.some(this.serverInfos,function(c){this._hasSameServerInstance(c.server,a)&&(b=c);return!!b},this);return b},findOAuthInfo:function(a){var b;a=this._sanitizeUrl(a);v.some(this.oAuthInfos,function(c){this._hasSameServerInstance(c.portalUrl,a)&&(b=c);return!!b},this);return b},findCredential:function(a,b){var c,e;a=this._sanitizeUrl(a);e=this._isServerRsrc(a)?"server":"portal";b?v.some(this.credentials,
function(f){this._hasSameServerInstance(f.server,a)&&b===f.userId&&f.scope===e&&(c=f);return!!c},this):v.some(this.credentials,function(b){this._hasSameServerInstance(b.server,a)&&-1!==this._getIdenticalSvcIdx(a,b)&&b.scope===e&&(c=b);return!!c},this);return c},getCredential:function(a,b){var c,e,k=!0;w.isDefined(b)&&(t.isObject(b)?(c=!!b.token,e=b.error,k=!1!==b.prompt):c=b);a=this._sanitizeUrl(a);var m=new n(z._dfdCanceller),x=this._isAdminResource(a),p=c&&this._doPortalSignIn(a)?this._getEsriAuthCookie():
null;if((c=c?this.findCredential(a):null)&&e&&498===e.code)c.destroy(),p&&p.token===b.token&&f("esri_auth",null,{expires:-1,path:"/",domain:document.domain});else if(p||c)return a=Error("You are currently signed in as: '"+(p&&p.email||c&&c.userId)+"'. You do not have access to this resource: "+a),a.code="IdentityManagerBase.1",a.httpCode=e&&e.httpCode,a.messageCode=e?e.messageCode:null,a.subcode=e?e.subcode:null,a.details=e?e.details:null,a.log=!!g.isDebug,m.errback(a),m;if(e=this._findCredential(a,
b))return m.callback(e),m;e=this.findServerInfo(a);if(e)!e.hasServer&&this._isServerRsrc(a)&&(e._restInfoDfd=this._getTokenSvcUrl(a,!0),e.hasServer=!0);else{p=this._getTokenSvcUrl(a);if(!p)return a=Error("Unknown resource - could not find token service endpoint."),a.code="IdentityManagerBase.2",a.log=!!g.isDebug,m.errback(a),m;e=new q;e.server=this._getServerInstanceRoot(a);t.isString(p)?(e.tokenServiceUrl=p,e.hasPortal=!0):(e._restInfoDfd=p,e.hasServer=!0);this.registerServers([e])}k&&e.hasPortal&&
void 0===e._selfReq&&!this._findOAuthInfo(a)&&(e._selfReq={owningTenant:b&&b.owningTenant,selfDfd:this._getPortalSelf(e.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),a)});return this._enqueue(a,e,b,m,x)},getResourceName:function(a){return this._isRESTService(a)?a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(a)&&a.replace(this._gwUser,"$1")||this._gwItem.test(a)&&a.replace(this._gwItem,"$1")||this._gwGroup.test(a)&&a.replace(this._gwGroup,
"$1")||""},generateToken:function(a,b,e){var f,k,m,q,n,w,x=this._rePortalTokenSvc.test(a.tokenServiceUrl),p=new u(window.location.href.toLowerCase()),l=this._getEsriAuthCookie(),d,h=!b;q=a.shortLivedTokenValidity;var r;b&&(r=c.id.tokenValidity||q||c.id.defaultTokenValidity,r>q&&(r=q));e&&(f=e.isAdmin,k=e.serverUrl,m=e.token,w=e.ssl,a.customParameters=e.customParameters);f?q=a.adminTokenServiceUrl:(q=a.tokenServiceUrl,n=new u(q.toLowerCase()),l&&(d=(d=l.auth_tier)&&d.toLowerCase()),("web"===d||a.webTierAuth)&&
e&&e.serverUrl&&!w&&"http"===p.scheme&&(C.hasSameOrigin(p.uri,q,!0)||"https"===n.scheme&&p.host===n.host&&"7080"===p.port&&"7443"===n.port)&&(q=q.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),h&&x&&(q=q.replace(/\/rest/i,"")));f=t.mixin({url:q,content:t.mixin({request:"getToken",username:b&&b.username,password:b&&b.password,serverUrl:k,token:m,expiration:r,referer:f||x?window.location.host:null,client:f?"referer":null,f:"json"},a.customParameters),handleAs:"json",callbackParamName:h?"callback":
void 0},e&&e.ioArgs);e={usePost:!h,disableIdentityLookup:!0,useProxy:this._useProxy(a,e)};x||(f.withCredentials=!1);x=E(f,e);x.addCallback(function(d){if(!d||!d.token)return d=Error("Unable to generate token"),d.code="IdentityManagerBase.3",d.log=!!g.isDebug,d;var c=a.server;D[c]||(D[c]={});b&&(D[c][b.username]=b.password);d.validity=r;return d});x.addErrback(function(a){});return x},isBusy:function(){return!!this._busy},checkSignInStatus:function(a){var b=new n;this.checkAppAccess(a,"").then(function(a){b.resolve(a.credential)}).catch(function(a){b.reject(a)});
return b},checkAppAccess:function(a,b,c){var e=this;return this.getCredential(a,{prompt:!1}).then(function(f){var k,m={f:"json"};if("portal"===f.scope)if(b&&(e._doPortalSignIn(a,!0)||c&&c.force))k=f.server+"/sharing/rest/oauth2/validateAppAccess",m.client_id=b;else if(f.token)k=f.server+"/sharing/rest";else return{credential:f};else if(f.token)k=f.server+"/rest/services";else return{credential:f};f.token&&(m.token=f.token);return E({url:k,content:m,callbackParamName:"callback"},{disableIdentityLookup:!0}).then(function(a){if(!1===
a.valid)throw a=Error("You are currently signed in as: '"+f.userId+"'.  You do not have access to this app: '"+b+"'."),a.code="IdentityManagerBase.1",a.log=!!g.isDebug,a;return{credential:f}}).catch(function(a){if("IdentityManagerBase.1"===a.code||400===a.code)throw a;if(498===a.code)throw f.destroy(),a=Error("User is not signed in."),a.code="IdentityManagerBase.6",a.log=!!g.isDebug,a;return{credential:f}})})},setRedirectionHandler:function(a){this._redirectFunc=a},setProtocolErrorHandler:function(a){this._protocolFunc=
a},signIn:function(){},oAuthSignIn:function(){},onCredentialCreate:function(){},onCredentialsDestroy:function(){},destroyCredentials:function(){if(this.credentials){var a=this.credentials.slice();v.forEach(a,function(a){a.destroy()})}this.onCredentialsDestroy()},_getOAuthHash:function(){var a=window.location.hash;if(a){"#"===a.charAt(0)&&(a=a.substring(1));var a=e.queryToObject(a),b=!1;a.access_token&&a.expires_in&&a.state&&a.hasOwnProperty("username")?(a.state=m.fromJson(a.state),this._oAuthHash=
a,b=!0):a.error&&a.error_description&&(console.log("IdentityManager OAuth Error: ",a.error," - ",a.error_description),"access_denied"===a.error&&(b=!0));b&&(!k("ie")||8<k("ie"))&&(window.location.hash="")}},_pageShowHandler:function(a){a.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow&&(a=Error("ABORTED"),a.code="IdentityManager.2",a.log=!!g.isDebug,this._errbackFunc(a))},_findCredential:function(a,b){var c=-1,e,f,g,k=b&&b.token;b=b&&b.resource;var m=this._isServerRsrc(a)?"server":"portal",
q=v.filter(this.credentials,function(b){return this._hasSameServerInstance(b.server,a)&&b.scope===m},this);a=b||a;if(q.length)if(1===q.length)if(b=q[0],f=(e=(g=this.findServerInfo(b.server))&&g.owningSystemUrl)&&this.findCredential(e,b.userId),c=this._getIdenticalSvcIdx(a,b),k)-1!==c&&(b.resources.splice(c,1),this._removeResource(a,f));else return-1===c&&b.resources.push(a),this._addResource(a,f),b;else{var n,w;v.some(q,function(b){w=this._getIdenticalSvcIdx(a,b);return-1!==w?(n=b,f=(e=(g=this.findServerInfo(n.server))&&
g.owningSystemUrl)&&this.findCredential(e,n.userId),c=w,!0):!1},this);if(k)n&&(n.resources.splice(c,1),this._removeResource(a,f));else if(n)return this._addResource(a,f),n}},_findOAuthInfo:function(a){var b=this.findOAuthInfo(a);b||v.some(this.oAuthInfos,function(c){this._isIdProvider(c.portalUrl,a)&&(b=c);return!!b},this);return b},_addResource:function(a,b){b&&-1===this._getIdenticalSvcIdx(a,b)&&b.resources.push(a)},_removeResource:function(a,b){var c=-1;b&&(c=this._getIdenticalSvcIdx(a,b),-1<c&&
b.resources.splice(c,1))},_useProxy:function(a,b){return b&&b.isAdmin&&!C.hasSameOrigin(a.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(a.tokenServiceUrl)&&10.1==a.currentVersion&&!C.hasSameOrigin(a.tokenServiceUrl,window.location.href)},_getOrigin:function(a){a=new u(a);return a.scheme+"://"+a.host+(w.isDefined(a.port)?":"+a.port:"")},_getServerInstanceRoot:function(a){var b=a.toLowerCase(),c=b.indexOf(this._agsRest);-1===c&&this._isAdminResource(a)&&(c=b.indexOf("/admin"));-1===
c&&(c=b.indexOf("/sharing"));-1===c&&"/"===b.substr(-1)&&(c=b.length-1);return-1<c?a.substring(0,c):a},_hasSameServerInstance:function(a,b){"/"===a.substr(-1)&&(a=a.slice(0,-1));a=a.toLowerCase();b=this._getServerInstanceRoot(b).toLowerCase();a=this._normalizeAGOLorgDomain(a);b=this._normalizeAGOLorgDomain(b);a=a.substr(a.indexOf(":"));b=b.substr(b.indexOf(":"));return a===b},_normalizeAGOLorgDomain:function(a){var b=/^https?:\/\/.+\.maps\.arcgis\.com/i,c=/^https?:\/\/.+\.mapsdevext\.arcgis\.com/i,
e=/^https?:\/\/.+\.mapsqa\.arcgis\.com/i;b.test(a)?a=a.replace(b,"https://www.arcgis.com"):c.test(a)?a=a.replace(c,"https://devext.arcgis.com"):e.test(a)&&(a=a.replace(e,"https://qaext.arcgis.com"));return a},_sanitizeUrl:function(a){var b=(x.defaults.io.proxyUrl||"").toLowerCase(),c=b?a.toLowerCase().indexOf(b+"?"):-1;-1!==c&&(a=a.substring(c+b.length+1));a=C.normalize(a);return C.urlToObject(a).path},_isRESTService:function(a){return-1<a.indexOf(this._agsRest)},_isAdminResource:function(a){return this._agsAdmin.test(a)||
this._adminSvcs.test(a)},_isServerRsrc:function(a){return this._isRESTService(a)||this._isAdminResource(a)},_isIdenticalService:function(a,b){var c;this._isRESTService(a)&&this._isRESTService(b)?(a=this._getSuffix(a).toLowerCase(),b=this._getSuffix(b).toLowerCase(),c=a===b,c||(c=/(.*)\/(MapServer|FeatureServer).*/ig,c=a.replace(c,"$1")===b.replace(c,"$1"))):this._isAdminResource(a)&&this._isAdminResource(b)?c=!0:this._isServerRsrc(a)||this._isServerRsrc(b)||!this._isPortalDomain(a)||(c=!0);return c},
_isPortalDomain:function(a){a=a.toLowerCase();var b=(new u(a)).authority,c=this._portalConfig,e=-1!==b.indexOf(this._agolSuffix);!e&&c&&(e=this._hasSameServerInstance(this._getServerInstanceRoot(c.restBaseUrl),a));e||(!this._arcgisUrl&&(c=t.getObject("esri.arcgis.utils.arcgisUrl"))&&(this._arcgisUrl=(new u(c)).authority),this._arcgisUrl&&(e=this._arcgisUrl.toLowerCase()===b));e||(e=v.some(this._portals,function(b){return this._hasSameServerInstance(b,a)},this));return e=e||this._agsPortal.test(a)},
_isIdProvider:function(a,b){var c=-1,e=-1;v.forEach(this._gwDomains,function(f,g){-1===c&&f.regex.test(a)&&(c=g);-1===e&&f.regex.test(b)&&(e=g)});var f=!1;if(-1<c&&-1<e)if(0===c||4===c){if(0===e||4===e)f=!0}else if(1===c){if(1===e||2===e)f=!0}else 2===c?2===e&&(f=!0):3===c&&3===e&&(f=!0);if(!f){var g=this.findServerInfo(b),k=g&&g.owningSystemUrl;k&&I(g)&&this._isPortalDomain(k)&&this._isIdProvider(a,k)&&(f=!0)}return f},_isPublic:function(a){a=this._sanitizeUrl(a);return v.some(this._publicUrls,function(b){return b.test(a)})},
_getIdenticalSvcIdx:function(a,b){var c=-1;v.some(b.resources,function(b,e){return this._isIdenticalService(a,b)?(c=e,!0):!1},this);return c},_getSuffix:function(a){return a.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")},_getTokenSvcUrl:function(a){var b,c;if((b=this._isRESTService(a))||this._isAdminResource(a))return c=a.toLowerCase().indexOf(b?this._agsRest:"/admin/"),b=a.substring(0,c)+"/admin/generateToken",a=a.substring(0,c)+"/rest/info",c=E({url:a,content:{f:"json"},handleAs:"json",
callbackParamName:"callback"}),c.adminUrl_=b,c;if(this._isPortalDomain(a)){var e="";v.some(this._gwDomains,function(b){b.regex.test(a)&&(e=b.tokenServiceUrl);return!!e});e||v.some(this._portals,function(b){this._hasSameServerInstance(b,a)&&(e=b+this._gwTokenUrl);return!!e},this);e||(c=a.toLowerCase().indexOf("/sharing"),-1!==c&&(e=a.substring(0,c)+this._gwTokenUrl));e||(e=this._getOrigin(a)+this._gwTokenUrl);e&&(b=(new u(a)).port,/^http:\/\//i.test(a)&&"7080"===b&&(e=e.replace(/:7080/i,":7443")),
e=e.replace(/http:/i,"https:"));return e}if(-1!==a.toLowerCase().indexOf("premium.arcgisonline.com"))return"https://premium.arcgisonline.com/server/tokens"},_getPortalSelf:function(a,b){"https:"===window.location.protocol?a=a.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(b)&&(a=a.replace(/^https:/i,"http:").replace(/:7443/i,":7080"));return E({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{crossOrigin:!1,disableIdentityLookup:!0})},_hasPortalSession:function(){return!!this._getEsriAuthCookie()},
_getEsriAuthCookie:function(){var a=null;if(f.isSupported()){var b=this._getAllCookies("esri_auth"),c;for(c=0;c<b.length;c++){var e=m.fromJson(b[c]);if(e.portalApp){a=e;break}}}a&&(b=null,a.expires&&("number"===typeof a.expires?b=a.expires:"string"===typeof a.expires&&(b=Date.parse(a.expires)),isNaN(b)&&(b=null),a.expires=b),b&&b<(new Date).getTime()&&(a=null));return a},_getAllCookies:function(b){var c=[],e=document.cookie.match(new RegExp("(?:^|; )"+a.escapeString(b)+"\x3d([^;]*)","g"));if(e)for(b=
0;b<e.length;b++){var f=e[b],g=f.indexOf("\x3d");-1<g&&(f=f.substring(g+1),c.push(decodeURIComponent(f)))}return c},_doPortalSignIn:function(a,b){if(f.isSupported()){var c=this._getEsriAuthCookie(),e=this._portalConfig,g=window.location.href,k=this.findServerInfo(a);if((b||this.useSignInPage)&&(e||this._isPortalDomain(g)||c)&&(k?k.hasPortal||k.owningSystemUrl&&this._isPortalDomain(k.owningSystemUrl):this._isPortalDomain(a))&&(this._isIdProvider(g,a)||e&&(this._hasSameServerInstance(this._getServerInstanceRoot(e.restBaseUrl),
a)||this._isIdProvider(e.restBaseUrl,a))||C.hasSameOrigin(g,a,!0)))return!0}return!1},_checkProtocol:function(a,b,c,e){var f=!0;e=e?b.adminTokenServiceUrl:b.tokenServiceUrl;0!==t.trim(e).toLowerCase().indexOf("https:")||0===window.location.href.toLowerCase().indexOf("https:")||x.defaults.io.useCors&&(C.canUseXhr(e)||C.canUseXhr(C.getProxyUrl(!0).path))||(f=this._protocolFunc?!!this._protocolFunc({resourceUrl:a,serverInfo:b}):!1,f||(a=Error("Aborted the Sign-In process to avoid sending password over insecure connection."),
a.code="IdentityManagerBase.4",a.log=!!g.isDebug,console.log(a.message),c(a)));return f},_enqueue:function(a,b,c,e,f,g){e||(e=new n(z._dfdCanceller));e.resUrl_=a;e.sinfo_=b;e.options_=c;e.admin_=f;e.refresh_=g;this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(a),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(e)):this._xoReqs.push(e):this._doSignIn(e);return e},_doSignIn:function(a){this._busy=a;this._rejectOnPersistedPageShow=
!1;var b=this,c=function(c){var e=a.options_&&a.options_.resource,f=a.resUrl_,d=a.refresh_,h=!1;-1===v.indexOf(b.credentials,c)&&(d&&-1!==v.indexOf(b.credentials,d)?(d.userId=c.userId,d.token=c.token,d.expires=c.expires,d.validity=c.validity,d.ssl=c.ssl,d.creationTime=c.creationTime,h=!0,c=d):b.credentials.push(c));c.resources||(c.resources=[]);c.resources.push(e||f);c.scope=b._isServerRsrc(f)?"server":"portal";c.onTokenChange();var e=b._soReqs,g={};b._soReqs=[];v.forEach(e,function(a){if(!this._isIdenticalService(f,
a.resUrl_)){var b=this._getSuffix(a.resUrl_);g[b]||(g[b]=!0,c.resources.push(a.resUrl_))}},b);a.callback(c);v.forEach(e,function(a){this._hasSameServerInstance(this._getServerInstanceRoot(f),a.resUrl_)?a.callback(c):this._soReqs.push(a)},b);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;if(!h)b.onCredentialCreate({credential:c});b._soReqs.length?b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},e=function(c){a.errback(c);b._busy=a.resUrl_=a.sinfo_=a.refresh_=null;b._soReqs.length?
b._doSignIn(b._soReqs.shift()):b._xoReqs.length&&b._doSignIn(b._xoReqs.shift())},f=function(f,k,l,d){var h=a.sinfo_,m=!a.options_||!1!==a.options_.prompt,q=h.hasPortal&&b._findOAuthInfo(a.resUrl_);b._doPortalSignIn(a.resUrl_)?(f=b._getEsriAuthCookie(),q=b._portalConfig,f?(h.webTierAuth||"web"!==(f.auth_tier&&f.auth_tier.toLowerCase())||(h.webTierAuth=!0),c(new J({userId:f.email,server:h.server,token:h.webTierAuth?null:f.token,expires:f.expires}))):m?(m="",f=window.location.href,m=b.signInPage?b.signInPage:
q?q.baseUrl+q.signin:b._isIdProvider(f,a.resUrl_)?b._getOrigin(f)+"/home/signin.html":h.tokenServiceUrl.replace(b._rePortalTokenSvc,"")+"/home/signin.html",m=m.replace(/http:/i,"https:"),q&&!1===q.useSSL&&(m=m.replace(/https:/i,"http:")),0===f.toLowerCase().replace("https","http").indexOf(m.toLowerCase().replace("https","http"))?(h=Error("Cannot redirect to Sign-In page from within Sign-In page. URL of the resource that triggered this workflow: "+a.resUrl_),h.code="IdentityManagerBase.5",h.log=!!g.isDebug,
e(h)):(b._rejectOnPersistedPageShow=!0,b._redirectFunc?b._redirectFunc({signInPage:m,returnUrlParamName:"returnUrl",returnUrl:f,resourceUrl:a.resUrl_,serverInfo:h}):window.location=m+"?returnUrl\x3d"+window.escape(f))):(h=Error("User is not signed in."),h.code="IdentityManagerBase.6",h.log=!!g.isDebug,e(h))):f?c(new J({userId:f,server:h.server,token:l,expires:w.isDefined(d)?Number(d):null,ssl:!!k})):q?(f=q._oAuthCred,f||(k=new G(q,window.localStorage),l=new G(q,window.sessionStorage),k.isValid()&&
l.isValid()?k.expires>l.expires?(f=k,l.destroy()):(f=l,k.destroy()):f=k.isValid()?k:l,q._oAuthCred=f),f.isValid()?c(new J({userId:f.userId,server:h.server,token:f.token,expires:f.expires,ssl:f.ssl,_oAuthCred:f})):b._oAuthHash&&b._oAuthHash.state.portalUrl===q.portalUrl?(m=b._oAuthHash,h=new J({userId:m.username,server:h.server,token:m.access_token,expires:(new Date).getTime()+1E3*Number(m.expires_in),ssl:"true"===m.ssl,oAuthState:m.state,_oAuthCred:f}),f.storage=m.persist?window.localStorage:window.sessionStorage,
f.token=h.token,f.expires=h.expires,f.userId=h.userId,f.ssl=h.ssl,f.save(),b._oAuthHash=null,c(h)):m?a._pendingDfd=b.oAuthSignIn(a.resUrl_,h,q,a.options_).addCallbacks(c,e):(h=Error("User is not signed in."),h.code="IdentityManagerBase.6",h.log=!!g.isDebug,e(h))):m?b._checkProtocol(a.resUrl_,h,e,a.admin_)&&(m=a.options_,a.admin_&&(m=m||{},m.isAdmin=!0),a._pendingDfd=b.signIn(a.resUrl_,h,m).addCallbacks(c,e)):(h=Error("User is not signed in."),h.code="IdentityManagerBase.6",h.log=!!g.isDebug,e(h))},
k=function(){var f=a.sinfo_,g=f.owningSystemUrl,l=a.options_,d,h,k,m;l&&(d=l.token,h=l.error,k=l.prompt);(m=b._findCredential(g,{token:d,resource:a.resUrl_}))||v.some(b.credentials,function(a){this._isIdProvider(g,a.server)&&(m=a);return!!m},b);m?(l=b.findCredential(a.resUrl_,m.userId))?c(l):K(f,b._legacyFed)?(l=m.toJson(),l.server=f.server,l.resources=null,c(new J(l))):(a._pendingDfd=b.generateToken(b.findServerInfo(m.server),null,{serverUrl:a.resUrl_,token:m.token,ssl:m.ssl})).addCallbacks(function(b){c(new J({userId:m.userId,
server:f.server,token:b.token,expires:w.isDefined(b.expires)?Number(b.expires):null,ssl:!!b.ssl,isAdmin:a.admin_,validity:b.validity}))},e):(b._busy=null,d&&(a.options_.token=null),(a._pendingDfd=b.getCredential(g.replace(/\/?$/,"/sharing"),{resource:a.resUrl_,owningTenant:f.owningTenant,token:d,error:h,prompt:k})).addCallbacks(function(d){b._enqueue(a.resUrl_,a.sinfo_,a.options_,a,a.admin_)},function(a){e(a)}))};this._errbackFunc=e;var m=a.sinfo_.owningSystemUrl,q=this._isServerRsrc(a.resUrl_),n=
a.sinfo_._restInfoDfd;n?n.addCallbacks(function(c){var e=a.sinfo_;e.adminTokenServiceUrl=e._restInfoDfd.adminUrl_;e._restInfoDfd=null;e.tokenServiceUrl=t.getObject("authInfo.tokenServicesUrl",!1,c)||t.getObject("authInfo.tokenServiceUrl",!1,c)||t.getObject("tokenServiceUrl",!1,c);e.shortLivedTokenValidity=t.getObject("authInfo.shortLivedTokenValidity",!1,c);e.currentVersion=c.currentVersion;e.owningTenant=c.owningTenant;(c=e.owningSystemUrl=c.owningSystemUrl)&&b._portals.push(c);q&&c?k():f()},function(){a.sinfo_._restInfoDfd=
null;var b=Error("Unknown resource - could not find token service endpoint.");b.code="IdentityManagerBase.2";b.log=!!g.isDebug;e(b)}):q&&m?k():a.sinfo_._selfReq?a.sinfo_._selfReq.selfDfd.then(function(c){var e={},f,d,h,g;c&&(f=c.user&&c.user.username,e.username=f,e.allSSL=c.allSSL,d=c.supportsOAuth,h=c.currentVersion,"multitenant"===c.portalMode&&(g=c.customBaseUrl));a.sinfo_.webTierAuth=!!f;return f&&b.normalizeWebTierAuth?b.generateToken(a.sinfo_,null,{ssl:e.allSSL}).addBoth(function(a){e.portalToken=
a&&a.token;e.tokenExpiration=a&&a.expires;return e}):!f&&d&&4.4<=parseFloat(h)&&!b._doPortalSignIn(a.resUrl_)?b._generateOAuthInfo({portalUrl:a.sinfo_.server,customBaseUrl:g,owningTenant:a.sinfo_._selfReq.owningTenant}).always(function(){return e}):e}).always(function(b){a.sinfo_._selfReq=null;b?f(b.username,b.allSSL,b.portalToken,b.tokenExpiration):f()}):f()},_generateOAuthInfo:function(a){var b=this,c,e=a.portalUrl,f=a.customBaseUrl,g=a.owningTenant;if(a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&
!this._hasTestedIfAppIsOnPortal){c=window.location.href;var k=c.indexOf("?");-1<k&&(c=c.slice(0,k));k=c.search(/\/(apps|home)\//);c=-1<k?c.slice(0,k):null}a&&c?(this._hasTestedIfAppIsOnPortal=!0,a=E({url:c+"/sharing/rest",content:{f:"json"},handleAs:"json"}).then(function(){b.defaultOAuthInfo=new F({appId:"arcgisonline",popup:!0,popupCallbackUrl:c+"/home/oauth-callback.html"})})):(a=new n,a.resolve(),a=a.promise);return a.then(function(){if(b.defaultOAuthInfo)return e=e.replace(/^http:/i,"https:"),
E({url:e+"/sharing/rest/oauth2/validateRedirectUri",content:{accountId:g,client_id:b.defaultOAuthInfo.appId,redirect_uri:C.getAbsoluteUrl(b.defaultOAuthInfo.popupCallbackUrl),f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){if(a.valid){var c=b.defaultOAuthInfo.clone();c.portalUrl=a.urlKey&&f?"https://"+a.urlKey+"."+f:e;b.oAuthInfos.push(c)}})})}});J=p(B,{declaredClass:"esri.Credential",tokenRefreshBuffer:2,constructor:function(a){t.mixin(this,a);this.resources=this.resources||
[];w.isDefined(this.creationTime)||(this.creationTime=(new Date).getTime())},_oAuthCred:null,refreshToken:function(){var a=this,b=this.resources&&this.resources[0],e=c.id.findServerInfo(this.server),f=e&&e.owningSystemUrl,g=!!f&&"server"===this.scope,k=g&&K(e,c.id._legacyFed),m=g&&c.id.findServerInfo(f),q,n=(q=e.webTierAuth)&&c.id.normalizeWebTierAuth,x=D[this.server],x=x&&x[this.userId],p={username:this.userId,password:x},l;if(!q||n)if(g&&!m&&v.some(c.id.serverInfos,function(a){c.id._isIdProvider(f,
a.server)&&(m=a);return!!m}),q=m&&c.id.findCredential(m.server,this.userId),!g||q)if(k)q.refreshToken();else{if(g)l={serverUrl:b,token:q&&q.token,ssl:q&&q.ssl};else if(n)p=null,l={ssl:this.ssl};else if(x)this.isAdmin&&(l={isAdmin:!0});else{var d;b&&(b=c.id._sanitizeUrl(b),this._enqueued=1,d=c.id._enqueue(b,e,null,null,this.isAdmin,this),d.addCallback(function(){a._enqueued=0;a.refreshServerTokens()}).addErrback(function(){a._enqueued=0}));return d}return c.id.generateToken(g?m:e,g?null:p,l).addCallback(function(b){a.token=
b.token;a.expires=w.isDefined(b.expires)?Number(b.expires):null;a.creationTime=(new Date).getTime();a.validity=b.validity;a.onTokenChange();a.refreshServerTokens()}).addErrback(function(){})}},refreshServerTokens:function(){"portal"===this.scope&&v.forEach(c.id.credentials,function(a){var b=c.id.findServerInfo(a.server),e=b&&b.owningSystemUrl;a!==this&&a.userId===this.userId&&e&&"server"===a.scope&&(c.id._hasSameServerInstance(this.server,e)||c.id._isIdProvider(e,this.server))&&(K(b,c.id._legacyFed)?
(a.token=this.token,a.expires=this.expires,a.creationTime=this.creationTime,a.validity=this.validity,a.onTokenChange()):a.refreshToken())},this)},onTokenChange:function(a){clearTimeout(this._refreshTimer);var b=this.server&&c.id.findServerInfo(this.server),e=(b=b&&b.owningSystemUrl)&&c.id.findServerInfo(b);!1!==a&&(!b||"portal"===this.scope||e&&e.webTierAuth&&!c.id.normalizeWebTierAuth)&&(w.isDefined(this.expires)||w.isDefined(this.validity))&&this._startRefreshTimer()},onDestroy:function(){},destroy:function(){this.userId=
this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null;this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);var a=v.indexOf(c.id.credentials,this);-1<a&&c.id.credentials.splice(a,1);this.onTokenChange();this.onDestroy()},toJson:function(){return this._toJson()},_toJson:function(){var a=w.fixJson({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,
scope:this.scope}),b=this.resources;b&&0<b.length&&(a.resources=b.slice());return a},_startRefreshTimer:function(){clearTimeout(this._refreshTimer);var a=6E4*this.tokenRefreshBuffer,b=(this.validity?this.creationTime+6E4*this.validity:this.expires)-(new Date).getTime();0>b&&(b=0);this._refreshTimer=setTimeout(t.hitch(this,this.refreshToken),b>a?b-a:b)}});L.Credential=J;return L})},"esri/ServerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","./kernel","./lang"],function(p,
g,t,v,n){return p(null,{declaredClass:"esri.ServerInfo",constructor:function(m){g.mixin(this,m)},toJson:function(){return n.fixJson({server:this.server,tokenServiceUrl:this.tokenServiceUrl,adminTokenServiceUrl:this.adminTokenServiceUrl,shortLivedTokenValidity:this.shortLivedTokenValidity,owningSystemUrl:this.owningSystemUrl,owningTenant:this.owningTenant,currentVersion:this.currentVersion,hasPortal:this.hasPortal,hasServer:this.hasServer,webTierAuth:this.webTierAuth})}})})},"esri/OAuthCredential":function(){define(["./kernel",
"dojo/_base/declare","dojo/has","dojo/json"],function(p,g,t,v){return g(null,{declaredClass:"esri.OAuthCredential",oAuthInfo:null,storage:null,expires:null,ssl:null,token:null,userId:null,constructor:function(g,m){this.oAuthInfo=g;this.storage=m;this._init()},isValid:function(){var g=!1;if(this.oAuthInfo&&this.token&&this.userId){var m=(new Date).getTime();this.expires>m&&(this.expires-m)/1E3>60*this.oAuthInfo.minTimeUntilExpiration&&(g=!0)}return g},save:function(){if(this.storage){var g=this._load(),
m=this.oAuthInfo;if(m&&m.authNamespace&&m.portalUrl){var p=g[m.authNamespace];p||(p=g[m.authNamespace]={});p[m.portalUrl]={expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem("esriJSAPIOAuth",v.stringify(g))}catch(k){console.log(k)}}}},destroy:function(){var g=this._load(),m=this.oAuthInfo;if(m&&m.appId&&m.portalUrl&&this.token&&this.expires>Date.now()){var p=m.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",k=new FormData;k.append("f",
"json");k.append("auth_token",this.token);k.append("client_id",m.appId);k.append("token_type_hint","access_token");if("function"===typeof navigator.sendBeacon)navigator.sendBeacon(p,k);else{var f=new XMLHttpRequest;f.open("POST",p);f.send(k)}}if(m&&m.authNamespace&&m.portalUrl&&this.storage&&(p=g[m.authNamespace])){delete p[m.portalUrl];try{this.storage.setItem("esriJSAPIOAuth",v.stringify(g))}catch(e){console.log(e)}}m&&(this.oAuthInfo=m._oAuthCred=null)},_init:function(){var g=this._load(),m=this.oAuthInfo;
m&&m.authNamespace&&m.portalUrl&&(g=g[m.authNamespace])&&(g=g[m.portalUrl])&&(this.expires=g.expires,this.ssl=g.ssl,this.token=g.token,this.userId=g.userId)},_load:function(){var g={};if(this.storage){var m=this.storage.getItem("esriJSAPIOAuth");if(m)try{g=v.parse(m)}catch(u){console.log(u)}}return g}})})},"esri/arcgis/OAuthInfo":function(){define(["../kernel","../lang","dojo/_base/declare","dojo/_base/lang","dojo/has"],function(p,g,t,v,n){var m=t(null,{declaredClass:"esri.arcgis.OAuthInfo",constructor:function(g){v.mixin(this,
{expiration:20160,minTimeUntilExpiration:30,portalUrl:"https://www.arcgis.com",authNamespace:"/",forceLogin:!1,popup:!1,popupCallbackUrl:"oauth-callback.html",popupWindowFeatures:"height\x3d490,width\x3d800,resizable,scrollbars,status"},g)},_oAuthCred:null,toJson:function(){return g.fixJson({appId:this.appId,expiration:this.expiration,locale:this.locale,minTimeUntilExpiration:this.minTimeUntilExpiration,portalUrl:this.portalUrl,authNamespace:this.authNamespace,forceLogin:this.forceLogin,popup:this.popup,
popupCallbackUrl:this.popupCallbackUrl,popupWindowFeatures:this.popupWindowFeatures})},clone:function(){return new m(this.toJson())}});return m})},"dijit/form/Button":function(){define("require dojo/_base/declare dojo/dom-class dojo/has dojo/_base/kernel dojo/_base/lang dojo/ready ./_FormWidget ./_ButtonMixin dojo/text!./templates/Button.html ../a11yclick".split(" "),function(p,g,t,v,n,m,u,k,f,e){v("dijit-legacy-requires")&&u(0,function(){p(["dijit/form/DropDownButton","dijit/form/ComboButton","dijit/form/ToggleButton"])});
u=g("dijit.form.Button"+(v("dojo-bidi")?"_NoBidi":""),[k,f],{showLabel:!0,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:e,_setValueAttr:"valueNode",_setNameAttr:function(b){this.valueNode&&this.valueNode.setAttribute("name",b)},postCreate:function(){this.inherited(arguments);this._setLabelFromContainer()},_setLabelFromContainer:function(){this.containerNode&&!this.label&&(this.label=m.trim(this.containerNode.innerHTML),this.onLabelSet())},
_setShowLabelAttr:function(b){this.containerNode&&t.toggle(this.containerNode,"dijitDisplayNone",!b);this._set("showLabel",b)},setLabel:function(b){n.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",b)},onLabelSet:function(){this.inherited(arguments);this.showLabel||"title"in this.params||(this.titleNode.title=m.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});v("dojo-bidi")&&(u=g("dijit.form.Button",u,{onLabelSet:function(){this.inherited(arguments);
this.titleNode.title&&this.applyTextDir(this.titleNode,this.titleNode.title)},_setTextDirAttr:function(b){this._created&&this.textDir!=b&&(this._set("textDir",b),this._setLabelAttr(this.label))}}));return u})},"dijit/form/_FormWidget":function(){define("dojo/_base/declare dojo/sniff dojo/_base/kernel dojo/ready ../_Widget ../_CssStateMixin ../_TemplatedMixin ./_FormWidgetMixin".split(" "),function(p,g,t,v,n,m,u,k){g("dijit-legacy-requires")&&v(0,function(){require(["dijit/form/_FormValueWidget"])});
return p("dijit.form._FormWidget",[n,u,m,k],{setDisabled:function(f){t.deprecated("setDisabled("+f+") is deprecated. Use set('disabled',"+f+") instead.","","2.0");this.set("disabled",f)},setValue:function(f){t.deprecated("dijit.form._FormWidget:setValue("+f+") is deprecated.  Use set('value',"+f+") instead.","","2.0");this.set("value",f)},getValue:function(){t.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");return this.get("value")},postMixInProperties:function(){this.nameAttrSetting=
this.name&&!g("msapp")?'name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"";this.inherited(arguments)}})})},"dijit/form/_FormWidgetMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff dojo/window ../a11y".split(" "),function(p,g,t,v,n,m,u,k,f,e){return g("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:!1,intermediateChanges:!1,
scrollOnFocus:!0,_setIdAttr:"focusNode",_setDisabledAttr:function(b){this._set("disabled",b);/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)?(t.set(this.focusNode,"disabled",b),k("trident")&&"readOnly"in this&&t.set(this.focusNode,"readonly",b||this.readOnly)):this.focusNode.setAttribute("aria-disabled",b?"true":"false");this.valueNode&&t.set(this.valueNode,"disabled",b);b?(this._set("hovering",!1),this._set("active",!1),b="tabIndex"in this.attributeMap?this.attributeMap.tabIndex:
"_setTabIndexAttr"in this?this._setTabIndexAttr:"focusNode",p.forEach(n.isArray(b)?b:[b],function(a){a=this[a];k("webkit")||e.hasDefaultTabStop(a)?a.setAttribute("tabIndex","-1"):a.removeAttribute("tabIndex")},this)):""!=this.tabIndex&&this.set("tabIndex",this.tabIndex)},_onFocus:function(b){if("mouse"==b&&this.isFocusable())var a=this.own(u(this.focusNode,"focus",function(){e.remove();a.remove()}))[0],c=k("pointer-events")?"pointerup":k("MSPointer")?"MSPointerUp":k("touch-events")?"touchend, mouseup":
"mouseup",e=this.own(u(this.ownerDocumentBody,c,n.hitch(this,function(b){e.remove();a.remove();this.focused&&("touchend"==b.type?this.defer("focus"):this.focus())})))[0];this.scrollOnFocus&&this.defer(function(){f.scrollIntoView(this.domNode)});this.inherited(arguments)},isFocusable:function(){return!this.disabled&&this.focusNode&&"none"!=v.get(this.domNode,"display")},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(b){}},compare:function(b,a){return"number"==
typeof b&&"number"==typeof a?isNaN(b)&&isNaN(a)?0:b-a:b>a?1:b<a?-1:0},onChange:function(){},_onChangeActive:!1,_handleOnChange:function(b,a){void 0!=this._lastValueReported||null!==a&&this._onChangeActive||(this._resetValue=this._lastValueReported=b);this._pendingOnChange=this._pendingOnChange||typeof b!=typeof this._lastValueReported||0!=this.compare(b,this._lastValueReported);(this.intermediateChanges||a||void 0===a)&&this._pendingOnChange&&(this._lastValueReported=b,this._pendingOnChange=!1,this._onChangeActive&&
(this._onChangeHandle&&this._onChangeHandle.remove(),this._onChangeHandle=this.defer(function(){this._onChangeHandle=null;this.onChange(b)})))},create:function(){this.inherited(arguments);this._onChangeActive=!0},destroy:function(){this._onChangeHandle&&(this._onChangeHandle.remove(),this.onChange(this._lastValueReported));this.inherited(arguments)}})})},"dijit/form/_ButtonMixin":function(){define(["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(p,g,t,v){var n=p("dijit.form._ButtonMixin"+
(t("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(g){g.stopPropagation();g.preventDefault();this.disabled||this.valueNode.click(g);return!1},_onClick:function(g){if(this.disabled)return g.stopPropagation(),g.preventDefault(),!1;!1===this.onClick(g)&&g.preventDefault();var m=g.defaultPrevented;if(!m&&"submit"==this.type&&!(this.valueNode||this.focusNode).form)for(var k=this.domNode;k.parentNode;k=k.parentNode){var f=v.byNode(k);if(f&&"function"==typeof f._onSubmit){f._onSubmit(g);
g.preventDefault();m=!0;break}}return!m},postCreate:function(){this.inherited(arguments);g.setSelectable(this.focusNode,!1)},onClick:function(){return!0},_setLabelAttr:function(g){this._set("label",g);(this.containerNode||this.focusNode).innerHTML=g;this.onLabelSet()},onLabelSet:function(){}});t("dojo-bidi")&&(n=p("dijit.form._ButtonMixin",n,{onLabelSet:function(){this.inherited(arguments);this.applyTextDir(this.containerNode||this.focusNode)}}));return n})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),
function(p,g,t,v,n,m,u,k){return p("dijit.form.Form",[n,m,u,k],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(f){g.set(this.domNode,
"encType",f);v("ie")&&(this.domNode.encoding=f);this._set("encType",f)},reset:function(f){var e={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:f?f.target:this.domNode,target:f?f.target:this.domNode};!1!==this.onReset(e)&&e.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(f){this.reset(f);f.stopPropagation();f.preventDefault();return!1},_onSubmit:function(f){var e=this.constructor.prototype;if(this.execute!=
e.execute||this.onExecute!=e.onExecute)t.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(f)&&(f.stopPropagation(),f.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/form/ValidationTextBox":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/i18n ./TextBox ../Tooltip dojo/text!./templates/ValidationTextBox.html dojo/i18n!./nls/validate".split(" "),
function(p,g,t,v,n,m,u){var k=p("dijit.form.ValidationTextBox",n,{templateString:u,required:!1,promptMessage:"",invalidMessage:"$_unset_$",missingMessage:"$_unset_$",message:"",constraints:{},pattern:".*",regExp:"",regExpGen:function(){},state:"",tooltipPosition:[],_deprecateRegExp:function(f,e){e!=k.prototype[f]&&(g.deprecated("ValidationTextBox id\x3d"+this.id+", set('"+f+"', ...) is deprecated.  Use set('pattern', ...) instead.","","2.0"),this.set("pattern",e))},_setRegExpGenAttr:function(f){this._deprecateRegExp("regExpGen",
f);this._set("regExpGen",this._computeRegexp)},_setRegExpAttr:function(f){this._deprecateRegExp("regExp",f)},_setValueAttr:function(){this.inherited(arguments);this._refreshState()},validator:function(f,e){return(new RegExp("^(?:"+this._computeRegexp(e)+")"+(this.required?"":"?")+"$")).test(f)&&(!this.required||!this._isEmpty(f))&&(this._isEmpty(f)||void 0!==this.parse(f,e))},_isValidSubset:function(){return 0==this.textbox.value.search(this._partialre)},isValid:function(){return this.validator(this.textbox.value,
this.get("constraints"))},_isEmpty:function(f){return(this.trim?/^\s*$/:/^$/).test(f)},getErrorMessage:function(){var f="$_unset_$"==this.invalidMessage?this.messages.invalidMessage:this.invalidMessage?this.invalidMessage:this.promptMessage,e="$_unset_$"==this.missingMessage?this.messages.missingMessage:this.missingMessage?this.missingMessage:f;return this.required&&this._isEmpty(this.textbox.value)?e:f},getPromptMessage:function(){return this.promptMessage},_maskValidSubsetError:!0,validate:function(f){var e=
"",b=this.disabled||this.isValid(f);b&&(this._maskValidSubsetError=!0);var a=this._isEmpty(this.textbox.value),c=!b&&f&&this._isValidSubset();this._set("state",b?"":((!this._hasBeenBlurred||f)&&a||c)&&(this._maskValidSubsetError||c&&!this._hasBeenBlurred&&f)?"Incomplete":"Error");this.focusNode.setAttribute("aria-invalid","Error"==this.state?"true":"false");"Error"==this.state?(this._maskValidSubsetError=f&&c,e=this.getErrorMessage(f)):"Incomplete"==this.state?(e=this.getPromptMessage(f),this._maskValidSubsetError=
!this._hasBeenBlurred||f):a&&(e=this.getPromptMessage(f));this.set("message",e);return b},displayMessage:function(f){f&&this.focused?m.show(f,this.domNode,this.tooltipPosition,!this.isLeftToRight()):m.hide(this.domNode)},_refreshState:function(){this._created&&this.validate(this.focused);this.inherited(arguments)},constructor:function(f){this.constraints=t.clone(this.constraints);this.baseClass+=" dijitValidationTextBox"},startup:function(){this.inherited(arguments);this._refreshState()},_setConstraintsAttr:function(f){!f.locale&&
this.lang&&(f.locale=this.lang);this._set("constraints",f);this._refreshState()},_setPatternAttr:function(f){this._set("pattern",f);this._refreshState()},_computeRegexp:function(f){var e=this.pattern;"function"==typeof e&&(e=e.call(this,f));if(e!=this._lastRegExp){var b="";this._lastRegExp=e;".*"!=e&&e.replace(/\\.|\[\]|\[.*?[^\\]{1}\]|\{.*?\}|\(\?[=:!]|./g,function(a){switch(a.charAt(0)){case "{":case "+":case "?":case "*":case "^":case "$":case "|":case "(":b+=a;break;case ")":b+="|$)";break;default:b+=
"(?:"+a+"|$)"}});try{"".search(b)}catch(a){b=this.pattern,console.warn("RegExp error in "+this.declaredClass+": "+this.pattern)}this._partialre="^(?:"+b+")$"}return e},postMixInProperties:function(){this.inherited(arguments);this.messages=v.getLocalization("dijit.form","validate",this.lang);this._setConstraintsAttr(this.constraints)},_setDisabledAttr:function(f){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(f){this._set("required",f);this.focusNode.setAttribute("aria-required",
f);this._refreshState()},_setMessageAttr:function(f){this._set("message",f);this.displayMessage(f)},reset:function(){this._maskValidSubsetError=!0;this.inherited(arguments)},_onBlur:function(){this.displayMessage("");this.inherited(arguments)},destroy:function(){m.hide(this.domNode);this.inherited(arguments)}});return k})},"dijit/form/TextBox":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-style dojo/_base/kernel dojo/_base/lang dojo/on dojo/sniff ./_FormValueWidget ./_TextBoxMixin dojo/text!./templates/TextBox.html ../main".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){k=p("dijit.form.TextBox"+(u("dojo-bidi")?"_NoBidi":""),[k,f],{templateString:e,_singleNodeTemplate:'\x3cinput class\x3d"dijit dijitReset dijitLeft dijitInputField" data-dojo-attach-point\x3d"textbox,focusNode" autocomplete\x3d"off" type\x3d"${type}" ${!nameAttrSetting} /\x3e',_buttonInputDisabled:u("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){var a=this.type.toLowerCase();if(this.templateString&&"input"==this.templateString.toLowerCase()||
("hidden"==a||"file"==a)&&this.templateString==this.constructor.prototype.templateString)this.templateString=this._singleNodeTemplate;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);9>u("ie")&&this.defer(function(){try{var a=t.getComputedStyle(this.domNode);if(a){var b=a.fontFamily;if(b){var e=this.domNode.getElementsByTagName("INPUT");if(e)for(a=0;a<e.length;a++)e[a].style.fontFamily=b}}}catch(w){}})},_setPlaceHolderAttr:function(a){this._set("placeHolder",a);this._phspan||
(this._attachPoints.push("_phspan"),this._phspan=g.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after"),this.own(m(this._phspan,"mousedown",function(a){a.preventDefault()}),m(this._phspan,"touchend, pointerup, MSPointerUp",n.hitch(this,function(){this.focus()}))));this._phspan.innerHTML="";this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(a));this._updatePlaceHolder()},_onInput:function(a){this.inherited(arguments);this._updatePlaceHolder()},_updatePlaceHolder:function(){this._phspan&&
(this._phspan.style.display=this.placeHolder&&!this.textbox.value?"":"none")},_setValueAttr:function(a,b,e){this.inherited(arguments);this._updatePlaceHolder()},getDisplayedValue:function(){v.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");return this.get("displayedValue")},setDisplayedValue:function(a){v.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");this.set("displayedValue",
a)},_onBlur:function(a){this.disabled||(this.inherited(arguments),this._updatePlaceHolder(),u("mozilla")&&this.selectOnClick&&(this.textbox.selectionStart=this.textbox.selectionEnd=void 0))},_onFocus:function(a){this.disabled||this.readOnly||(this.inherited(arguments),this._updatePlaceHolder())}});9>u("ie")&&(k.prototype._isTextSelected=function(){var a=this.ownerDocument.selection.createRange();return a.parentElement()==this.textbox&&0<a.text.length},b._setSelectionRange=f._setSelectionRange=function(a,
b,e){a.createTextRange&&(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",-99999),a.moveStart("character",b),a.moveEnd("character",e-b),a.select())});u("dojo-bidi")&&(k=p("dijit.form.TextBox",k,{_setPlaceHolderAttr:function(a){this.inherited(arguments);this.applyTextDir(this._phspan)}}));return k})},"dijit/form/_FormValueWidget":function(){define(["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(p,g,t,v){return p("dijit.form._FormValueWidget",[t,v],{_layoutHackIE7:function(){if(7==
g("ie"))for(var n=this.domNode,m=n.parentNode,p=n.firstChild||n,k=p.style.filter,f=this;m&&0==m.clientHeight;)(function(){var e=f.connect(m,"onscroll",function(){f.disconnect(e);p.style.filter=(new Date).getMilliseconds();f.defer(function(){p.style.filter=k})})})(),m=m.parentNode}})})},"dijit/form/_FormValueMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormWidgetMixin".split(" "),function(p,g,t,v,n,m,u){return p("dijit.form._FormValueMixin",
u,{readOnly:!1,_setReadOnlyAttr:function(k){m("trident")&&"disabled"in this?g.set(this.focusNode,"readOnly",k||this.disabled):g.set(this.focusNode,"readOnly",k);this._set("readOnly",k)},postCreate:function(){this.inherited(arguments);void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.value)},_setValueAttr:function(g,f){this._handleOnChange(g,f)},_handleOnChange:function(g,f){this._set("value",g);this.inherited(arguments)},undo:function(){this._setValueAttr(this._lastValueReported,
!1)},reset:function(){this._hasBeenBlurred=!1;this._setValueAttr(this._resetValue,!0)}})})},"dijit/form/_TextBoxMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/sniff dojo/keys dojo/_base/lang dojo/on ../main".split(" "),function(p,g,t,v,n,m,u,k){var f=g("dijit.form._TextBoxMixin"+(v("dojo-bidi")?"_NoBidi":""),null,{trim:!1,uppercase:!1,lowercase:!1,propercase:!1,maxLength:"",selectOnClick:!1,placeHolder:"",_getValueAttr:function(){return this.parse(this.get("displayedValue"),
this.constraints)},_setValueAttr:function(e,b,a){var c;void 0!==e&&(c=this.filter(e),"string"!=typeof a&&(a=null===c||"number"==typeof c&&isNaN(c)?"":this.filter(this.format(c,this.constraints)),0!=this.compare(c,this.filter(this.parse(a,this.constraints)))&&(a=null)));null==a||"number"==typeof a&&isNaN(a)||this.textbox.value==a||(this.textbox.value=a,this._set("displayedValue",this.get("displayedValue")));this.inherited(arguments,[c,b])},displayedValue:"",_getDisplayedValueAttr:function(){return this.filter(this.textbox.value)},
_setDisplayedValueAttr:function(e){null==e?e="":"string"!=typeof e&&(e=String(e));this.textbox.value=e;this._setValueAttr(this.get("value"),void 0);this._set("displayedValue",this.get("displayedValue"))},format:function(e){return null==e?"":e.toString?e.toString():e},parse:function(e){return e},_refreshState:function(){},onInput:function(){},_onInput:function(e){this._lastInputEventValue=this.textbox.value;this._processInput(this._lastInputProducingEvent||e);delete this._lastInputProducingEvent;this.intermediateChanges&&
this._handleOnChange(this.get("value"),!1)},_processInput:function(){this._refreshState();this._set("displayedValue",this.get("displayedValue"))},postCreate:function(){this.textbox.setAttribute("value",this.textbox.value);this.inherited(arguments);this.own(u(this.textbox,"keydown, keypress, paste, cut, compositionend",m.hitch(this,function(e){var b;if("keydown"==e.type&&229!=e.keyCode){b=e.keyCode;switch(b){case n.SHIFT:case n.ALT:case n.CTRL:case n.META:case n.CAPS_LOCK:case n.NUM_LOCK:case n.SCROLL_LOCK:return}if(!e.ctrlKey&&
!e.metaKey&&!e.altKey){switch(b){case n.NUMPAD_0:case n.NUMPAD_1:case n.NUMPAD_2:case n.NUMPAD_3:case n.NUMPAD_4:case n.NUMPAD_5:case n.NUMPAD_6:case n.NUMPAD_7:case n.NUMPAD_8:case n.NUMPAD_9:case n.NUMPAD_MULTIPLY:case n.NUMPAD_PLUS:case n.NUMPAD_ENTER:case n.NUMPAD_MINUS:case n.NUMPAD_PERIOD:case n.NUMPAD_DIVIDE:return}if(65<=b&&90>=b||48<=b&&57>=b||b==n.SPACE)return;b=!1;for(var a in n)if(n[a]===e.keyCode){b=!0;break}if(!b)return}}(b=32<=e.charCode?String.fromCharCode(e.charCode):e.charCode)||
(b=65<=e.keyCode&&90>=e.keyCode||48<=e.keyCode&&57>=e.keyCode||e.keyCode==n.SPACE?String.fromCharCode(e.keyCode):e.keyCode);b||(b=229);if("keypress"==e.type){if("string"!=typeof b)return;if("a"<=b&&"z">=b||"A"<=b&&"Z">=b||"0"<=b&&"9">=b||" "===b)if(e.ctrlKey||e.metaKey||e.altKey)return}var c={faux:!0},f;for(f in e)/^(layer[XY]|returnValue|keyLocation)$/.test(f)||(a=e[f],"function"!=typeof a&&"undefined"!=typeof a&&(c[f]=a));m.mixin(c,{charOrCode:b,_wasConsumed:!1,preventDefault:function(){c._wasConsumed=
!0;e.preventDefault()},stopPropagation:function(){e.stopPropagation()}});this._lastInputProducingEvent=c;!1===this.onInput(c)&&(c.preventDefault(),c.stopPropagation());if(!c._wasConsumed&&9>=v("ie"))switch(e.keyCode){case n.TAB:case n.ESCAPE:case n.DOWN_ARROW:case n.UP_ARROW:case n.LEFT_ARROW:case n.RIGHT_ARROW:break;default:e.keyCode==n.ENTER&&"textarea"!=this.textbox.tagName.toLowerCase()||this.defer(function(){this.textbox.value!==this._lastInputEventValue&&u.emit(this.textbox,"input",{bubbles:!0})})}})),
u(this.textbox,"input",m.hitch(this,"_onInput")),u(this.domNode,"keypress",function(e){e.stopPropagation()}))},_blankValue:"",filter:function(e){if(null===e)return this._blankValue;if("string"!=typeof e)return e;this.trim&&(e=m.trim(e));this.uppercase&&(e=e.toUpperCase());this.lowercase&&(e=e.toLowerCase());this.propercase&&(e=e.replace(/[^\s]+/g,function(b){return b.substring(0,1).toUpperCase()+b.substring(1)}));return e},_setBlurValue:function(){this._setValueAttr(this.get("value"),!0)},_onBlur:function(e){this.disabled||
(this._setBlurValue(),this.inherited(arguments))},_isTextSelected:function(){return this.textbox.selectionStart!=this.textbox.selectionEnd},_onFocus:function(e){this.disabled||this.readOnly||(this.selectOnClick&&"mouse"==e&&(this._selectOnClickHandle=u.once(this.domNode,"mouseup, touchend",m.hitch(this,function(b){this._isTextSelected()||f.selectInputText(this.textbox)})),this.own(this._selectOnClickHandle),this.defer(function(){this._selectOnClickHandle&&(this._selectOnClickHandle.remove(),this._selectOnClickHandle=
null)},500)),this.inherited(arguments),this._refreshState())},reset:function(){this.textbox.value="";this.inherited(arguments)}});v("dojo-bidi")&&(f=g("dijit.form._TextBoxMixin",f,{_setValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_setDisplayedValueAttr:function(){this.inherited(arguments);this.applyTextDir(this.focusNode)},_onInput:function(){this.applyTextDir(this.focusNode);this.inherited(arguments)}}));f._setSelectionRange=k._setSelectionRange=function(e,b,
a){e.setSelectionRange&&e.setSelectionRange(b,a)};f.selectInputText=k.selectInputText=function(e,b,a){e=t.byId(e);isNaN(b)&&(b=0);isNaN(a)&&(a=e.value?e.value.length:0);try{e.focus(),f._setSelectionRange(e,b,a)}catch(c){}};return f})},"dijit/Tooltip":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/lang dojo/mouse dojo/on dojo/sniff ./_base/manager ./place ./_Widget ./_TemplatedMixin ./BackgroundIframe dojo/text!./templates/Tooltip.html ./main".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){function E(){}var B=g("dijit._MasterTooltip",[x,w],{duration:a.defaultDuration,templateString:C,postCreate:function(){this.ownerDocumentBody.appendChild(this.domNode);this.bgIframe=new q(this.domNode);this.fadeIn=t.fadeIn({node:this.domNode,duration:this.duration,onEnd:k.hitch(this,"_onShow")});this.fadeOut=t.fadeOut({node:this.domNode,duration:this.duration,onEnd:k.hitch(this,"_onHide")})},show:function(a,b,e,f,g,m,q){if(!this.aroundNode||this.aroundNode!==
b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{this.containerNode.innerHTML=a;g&&this.set("textDir",g);this.containerNode.align=f?"right":"left";var n=c.around(this.domNode,b,e&&e.length?e:G.defaultPosition,!f,k.hitch(this,"orient")),w=n.aroundNodePos;"M"==n.corner.charAt(0)&&"M"==n.aroundCorner.charAt(0)?(this.connectorNode.style.top=w.y+(w.h-this.connectorNode.offsetHeight>>1)-n.y+"px",this.connectorNode.style.left=""):"M"==n.corner.charAt(1)&&
"M"==n.aroundCorner.charAt(1)?this.connectorNode.style.left=w.x+(w.w-this.connectorNode.offsetWidth>>1)-n.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");u.set(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=m||E;this.onMouseLeave=q||E}},orient:function(a,c,e,f,g){this.connectorNode.style.top="";var k=f.h;f=f.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove",
"BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[c+"-"+e];this.domNode.style.width="auto";var q=m.position(this.domNode);if(b("ie")||b("trident"))q.w+=2;m.setMarginBox(this.domNode,{w:Math.min(Math.max(f,1),q.w)});"B"==e.charAt(0)&&"B"==c.charAt(0)?(a=m.position(a),c=this.connectorNode.offsetHeight,
a.h>k?(this.connectorNode.style.top=k-(g.h+c>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(g.h/2-c/2,0),a.h-c)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");return Math.max(0,q.w-f)},_onShow:function(){b("ie")&&(this.domNode.style.filter="")},hide:function(a){this._onDeck&&this._onDeck[1]==a?this._onDeck=null:this.aroundNode===a&&(this.fadeIn.stop(),this.isShowingNow=!1,this.aroundNode=
null,this.fadeOut.play());this.onMouseEnter=this.onMouseLeave=E},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";this._onDeck&&(this.show.apply(this,this._onDeck),this._onDeck=null)}});b("dojo-bidi")&&B.extend({_setAutoTextDir:function(a){this.applyTextDir(a);p.forEach(a.children,function(a){this._setAutoTextDir(a)},this)},_setTextDirAttr:function(a){this._set("textDir",a);"auto"==a?this._setAutoTextDir(this.containerNode):this.containerNode.dir=this.textDir}});z.showTooltip=
function(a,b,c,e,f,g,k){c&&(c=p.map(c,function(a){return{after:"after-centered",before:"before-centered"}[a]||a}));G._masterTT||(z._masterTT=G._masterTT=new B);return G._masterTT.show(a,b,c,e,f,g,k)};z.hideTooltip=function(a){return G._masterTT&&G._masterTT.hide(a)};var G=g("dijit.Tooltip",x,{label:"",showDelay:400,hideDelay:400,connectId:[],position:[],selector:"",_setConnectIdAttr:function(a){p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},this);this._connectIds=
p.filter(k.isArrayLike(a)?a:a?[a]:[],function(a){return v.byId(a,this.ownerDocument)},this);this._connections=p.map(this._connectIds,function(a){a=v.byId(a,this.ownerDocument);var b=this.selector,c=b?function(a){return e.selector(b,a)}:function(a){return a},g=this;return[e(a,c(f.enter),function(){g._onHover(this)}),e(a,c("focusin"),function(){g._onHover(this)}),e(a,c(f.leave),k.hitch(g,"_onUnHover")),e(a,c("focusout"),k.hitch(g,"set","state","DORMANT"))]},this);this._set("connectId",a)},addTarget:function(a){a=
a.id||a;-1==p.indexOf(this._connectIds,a)&&this.set("connectId",this._connectIds.concat(a))},removeTarget:function(a){a=p.indexOf(this._connectIds,a.id||a);0<=a&&(this._connectIds.splice(a,1),this.set("connectId",this._connectIds))},buildRendering:function(){this.inherited(arguments);n.add(this.domNode,"dijitTooltipData")},startup:function(){this.inherited(arguments);var a=this.connectId;p.forEach(k.isArrayLike(a)?a:[a],this.addTarget,this)},getContent:function(a){return this.label||this.domNode.innerHTML},
state:"DORMANT",_setStateAttr:function(a){if(!(this.state==a||"SHOW TIMER"==a&&"SHOWING"==this.state||"HIDE TIMER"==a&&"DORMANT"==this.state)){this._hideTimer&&(this._hideTimer.remove(),delete this._hideTimer);this._showTimer&&(this._showTimer.remove(),delete this._showTimer);switch(a){case "DORMANT":this._connectNode&&(G.hide(this._connectNode),delete this._connectNode,this.onHide());break;case "SHOW TIMER":"SHOWING"!=this.state&&(this._showTimer=this.defer(function(){this.set("state","SHOWING")},
this.showDelay));break;case "SHOWING":var b=this.getContent(this._connectNode);if(!b){this.set("state","DORMANT");return}G.show(b,this._connectNode,this.position,!this.isLeftToRight(),this.textDir,k.hitch(this,"set","state","SHOWING"),k.hitch(this,"set","state","HIDE TIMER"));this.onShow(this._connectNode,this.position);break;case "HIDE TIMER":this._hideTimer=this.defer(function(){this.set("state","DORMANT")},this.hideDelay)}this._set("state",a)}},_onHover:function(a){this._connectNode&&a!=this._connectNode&&
this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOW TIMER")},_onUnHover:function(a){this.set("state","HIDE TIMER")},open:function(a){this.set("state","DORMANT");this._connectNode=a;this.set("state","SHOWING")},close:function(){this.set("state","DORMANT")},onShow:function(){},onHide:function(){},destroy:function(){this.set("state","DORMANT");p.forEach(this._connections||[],function(a){p.forEach(a,function(a){a.remove()})},this);this.inherited(arguments)}});G._MasterTooltip=B;G.show=
z.showTooltip;G.hide=z.hideTooltip;G.defaultPosition=["after-centered","before-centered"];return G})},"dijit/place":function(){define("dojo/_base/array dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/_base/window ./Viewport ./main".split(" "),function(p,g,t,v,n,m,u){function k(e,b,a,c){var f=m.getEffectiveBox(e.ownerDocument);e.parentNode&&"body"==String(e.parentNode.tagName).toLowerCase()||n.body(e.ownerDocument).appendChild(e);var k=null;p.some(b,function(b){var m=b.corner,q=b.pos,n=0,w=
{w:{L:f.l+f.w-q.x,R:q.x-f.l,M:f.w}[m.charAt(1)],h:{T:f.t+f.h-q.y,B:q.y-f.t,M:f.h}[m.charAt(0)]},x=e.style;x.left=x.right="auto";a&&(n=a(e,b.aroundCorner,m,w,c),n="undefined"==typeof n?0:n);var p=e.style,u=p.display,z=p.visibility;"none"==p.display&&(p.visibility="hidden",p.display="");x=g.position(e);p.display=u;p.visibility=z;u={L:q.x,R:q.x-x.w,M:Math.max(f.l,Math.min(f.l+f.w,q.x+(x.w>>1))-x.w)}[m.charAt(1)];z={T:q.y,B:q.y-x.h,M:Math.max(f.t,Math.min(f.t+f.h,q.y+(x.h>>1))-x.h)}[m.charAt(0)];q=Math.max(f.l,
u);p=Math.max(f.t,z);u=Math.min(f.l+f.w,u+x.w)-q;z=Math.min(f.t+f.h,z+x.h)-p;n+=x.w-u+(x.h-z);if(null==k||n<k.overflow)k={corner:m,aroundCorner:b.aroundCorner,x:q,y:p,w:u,h:z,overflow:n,spaceAvailable:w};return!n});k.overflow&&a&&a(e,k.aroundCorner,k.corner,k.spaceAvailable,c);b=k.y;var q=k.x,u=n.body(e.ownerDocument);/relative|absolute/.test(t.get(u,"position"))&&(b-=t.get(u,"marginTop"),q-=t.get(u,"marginLeft"));u=e.style;u.top=b+"px";u.left=q+"px";u.right="auto";return k}var f={TL:"BR",TR:"BL",
BL:"TR",BR:"TL"};return u.place={at:function(e,b,a,c,g){a=p.map(a,function(a){var e={corner:a,aroundCorner:f[a],pos:{x:b.x,y:b.y}};c&&(e.pos.x+="L"==a.charAt(1)?c.x:-c.x,e.pos.y+="T"==a.charAt(0)?c.y:-c.y);return e});return k(e,a,g)},around:function(e,b,a,c,f){function m(a,b){J.push({aroundCorner:a,corner:b,pos:{x:{L:F,R:F+I,M:F+(I>>1)}[a.charAt(1)],y:{T:D,B:D+K,M:D+(K>>1)}[a.charAt(0)]}})}var q;if("string"==typeof b||"offsetWidth"in b||"ownerSVGElement"in b){if(q=g.position(b,!0),/^(above|below)/.test(a[0])){var n=
g.getBorderExtents(b),x=b.firstChild?g.getBorderExtents(b.firstChild):{t:0,l:0,b:0,r:0},u=g.getBorderExtents(e),B=e.firstChild?g.getBorderExtents(e.firstChild):{t:0,l:0,b:0,r:0};q.y+=Math.min(n.t+x.t,u.t+B.t);q.h-=Math.min(n.t+x.t,u.t+B.t)+Math.min(n.b+x.b,u.b+B.b)}}else q=b;if(b.parentNode)for(n="absolute"==t.getComputedStyle(b).position,b=b.parentNode;b&&1==b.nodeType&&"BODY"!=b.nodeName;){x=g.position(b,!0);u=t.getComputedStyle(b);/relative|absolute/.test(u.position)&&(n=!1);if(!n&&/hidden|auto|scroll/.test(u.overflow)){var B=
Math.min(q.y+q.h,x.y+x.h),G=Math.min(q.x+q.w,x.x+x.w);q.x=Math.max(q.x,x.x);q.y=Math.max(q.y,x.y);q.h=B-q.y;q.w=G-q.x}"absolute"==u.position&&(n=!0);b=b.parentNode}var F=q.x,D=q.y,I="w"in q?q.w:q.w=q.width,K="h"in q?q.h:(v.deprecated("place.around: dijit/place.__Rectangle: { x:"+F+", y:"+D+", height:"+q.height+", width:"+I+" } has been deprecated.  Please use { x:"+F+", y:"+D+", h:"+q.height+", w:"+I+" }","","2.0"),q.h=q.height),J=[];p.forEach(a,function(a){var b=c;switch(a){case "above-centered":m("TM",
"BM");break;case "below-centered":m("BM","TM");break;case "after-centered":b=!b;case "before-centered":m(b?"ML":"MR",b?"MR":"ML");break;case "after":b=!b;case "before":m(b?"TL":"TR",b?"TR":"TL");m(b?"BL":"BR",b?"BR":"BL");break;case "below-alt":b=!b;case "below":m(b?"BL":"BR",b?"TL":"TR");m(b?"BR":"BL",b?"TR":"TL");break;case "above-alt":b=!b;case "above":m(b?"TL":"TR",b?"BL":"BR");m(b?"TR":"TL",b?"BR":"BL");break;default:m(a.aroundCorner,a.corner)}});e=k(e,J,f,{w:I,h:K});e.aroundNodePos=q;return e}}})},
"esri/OAuthSignInHandler":function(){define("./Credential ./domUtils ./lang ./urlUtils dijit/Dialog dijit/registry dojo/_base/config dojo/_base/Deferred dojo/_base/kernel dojo/dom-attr dojo/i18n!./nls/jsapi dojo/io-query dojo/sniff dojo/json dijit/form/Button dojo/query".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return{_oAuthDfd:null,_oAuthIntervalId:0,_oAuthDialogContent:"\x3cdiv class\x3d'dijitDialogPaneContentArea'\x3e\x3cdiv style\x3d'padding-bottom: 5px; word-wrap: break-word;'\x3e${oAuthInfo}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'esriErrorMsg' style\x3d'display: none; color: white; background-color: #D46464; text-align: center; padding-top: 3px; padding-bottom: 3px;'\x3e${invalidUser}\x3c/div\x3e\x3cdiv style\x3d'margin: 0px; padding: 0px; height: 10px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitDialogPaneActionBar'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdSubmit\"'\x3e${lblOk}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' data-dojo-props\x3d'type:\"button\", \"class\":\"esriIdCancel\"'\x3e${lblCancel}\x3c/button\x3e\x3c/div\x3e",
setOAuthRedirectionHandler:function(a){this._oAuthRedirectFunc=a},oAuthSignIn:function(a,c,f,m){var q=this._oAuthDfd=new k;q.resUrl_=a;q.sinfo_=c;q.oinfo_=f;var n=!m||!1!==m.oAuthPopupConfirmation;if(!f.popup||!n)return this._doOAuthSignIn(a,c,f),q;this._nls||(this._nls=b.identity);this.oAuthDialog||(this.oAuthDialog=this._createOAuthDialog());a=this.oAuthDialog;f=m&&m.error;m=m&&m.token;g.hide(a.errMsg_);f&&403==f.code&&m&&(e.set(a.errMsg_,"innerHTML",this._nls.forbidden),g.show(a.errMsg_));e.set(a.serverLink_,
{title:c.server,innerHTML:-1!==c.server.toLowerCase().indexOf("arcgis.com")?"ArcGIS Online":c.server});a.show();return q},setOAuthResponseHash:function(b){var c=this._oAuthDfd;this._oAuthDfd=null;if(c&&b)if(clearInterval(this._oAuthIntervalId),"#"===b.charAt(0)&&(b=b.substring(1)),b=a.queryToObject(b),b.error)b=Error("access_denied"===b.error?"ABORTED":"OAuth: "+b.error+" - "+b.error_description),b.code="IdentityManagerBase.2",b.log=!!u.isDebug,c.errback(b);else{var e=c.oinfo_._oAuthCred,f=new p({userId:b.username,
server:c.sinfo_.server,token:b.access_token,expires:(new Date).getTime()+1E3*Number(b.expires_in),ssl:"true"===b.ssl,_oAuthCred:e});e.storage=b.persist?window.localStorage:window.sessionStorage;e.token=f.token;e.expires=f.expires;e.userId=f.userId;e.ssl=f.ssl;e.save();c.callback(f)}},_createOAuthDialog:function(){var a=this._nls,b=t.substitute(a,this._oAuthDialogContent),b=t.substitute({server:"\x3cspan class\x3d'serverLink' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e"},b),c=new n({title:a.title,
content:b,"class":"esriOAuthSignInDialog",style:"min-width: 18em;",esriIdMgr_:this,execute_:function(){var a=c.esriIdMgr_._oAuthDfd;c.hide_();c.esriIdMgr_._doOAuthSignIn(a.resUrl_,a.sinfo_,a.oinfo_)},cancel_:function(){var a=c.esriIdMgr_._oAuthDfd;c.esriIdMgr_._oAuthDfd=null;c.hide_();var b=Error("ABORTED");b.code="IdentityManager.2";b.log=!!u.isDebug;a.errback(b)},hide_:function(){g.hide(c.errMsg_);c.hide();n._DialogLevelManager.hide(c)}}),a=c.domNode;c.btnSubmit_=m.byNode(f.query(".esriIdSubmit",
a)[0]);c.btnCancel_=m.byNode(f.query(".esriIdCancel",a)[0]);c.serverLink_=f.query(".serverLink",a)[0];c.errMsg_=f.query(".esriErrorMsg",a)[0];c.connect(c.btnSubmit_,"onClick",c.execute_);c.connect(c.btnCancel_,"onClick",c.onCancel);c.connect(c,"onCancel",c.cancel_);return c},_doOAuthSignIn:function(b,e,f){var g=this,k={client_id:f.appId,response_type:"token",state:x.stringify({portalUrl:f.portalUrl}),expiration:f.expiration,locale:f.locale,redirect_uri:f.popup?v.getAbsoluteUrl(f.popupCallbackUrl):
window.location.href.replace(/#.*$/,"")};f.forceLogin&&(k.force_login=!0);var m=f.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",q=m+"?"+a.objectToQuery(k);if(f.popup){var n;7===c("ie")?(n=window.open(f.popupCallbackUrl,"esriJSAPIOAuth",f.popupWindowFeatures),n.location=q):n=window.open(q,"esriJSAPIOAuth",f.popupWindowFeatures);n?(n.focus(),this._oAuthDfd.oAuthWin_=n,this._oAuthIntervalId=setInterval(function(){if(n.closed){clearInterval(g._oAuthIntervalId);var a=g._oAuthDfd;if(a){var b=
Error("ABORTED");b.code="IdentityManager.2";b.log=!!u.isDebug;a.errback(b)}}},500)):(b=Error("ABORTED"),b.code="IdentityManager.2",b.log=!!u.isDebug,this._oAuthDfd.errback(b))}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:k,authorizeUrl:m,resourceUrl:b,serverInfo:e,oAuthInfo:f}):window.location=q}}})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang","jimu/shared/basePortalUrlUtils"],function(p,g){var t=p.clone(g);t.declaredClass=
"jimu.portalUrlUtils";t.getPortalUrlFromLocation=function(){return t.getPortalServerFromLocation()+t.getDeployContextFromLocation()};t.getPortalSignInUrlFromLocation=function(){var g=t.getPortalUrlFromLocation();return t.setHttpsProtocol(g+"home/signin.html")};t.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};t.getDeployContextFromLocation=function(){var g=window.location.href.split("?")[0],n=g.indexOf("/home/");0>n&&(n=g.indexOf("/apps/"));g=g.substring(g.indexOf(window.location.host)+
window.location.host.length+1,n);"/"!==g&&(g="/"+g+"/");return g};t.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+t.getDeployContextFromLocation()+"sharing/rest/"};return t})},"jimu/shared/basePortalUrlUtils":function(){define(function(){var p={declaredClass:"jimu.shared.basePortalUrlUtils"};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s*/gi,"").replace(/\s*$/gi,"")});"function"!==typeof String.prototype.startWith&&
(String.prototype.startWith=function(g){return this.substr(0,g.length)===g});"function"!==typeof String.prototype.endWith&&(String.prototype.endWith=function(g){return this.substr(this.length-g.length,g.length)===g});p.getServerByUrl=function(g){g=(g||"").trim();g=g.replace(/^(http(s?):?)\/\//gi,"");0===g.indexOf("//")&&(g=g.slice(2));return g.split("/")[0]};p.getServerWithProtocol=function(g){var t="";if(g=(g||"").trim()){var v=p.getServerByUrl(g);if(!v)return t;var n=p.getProtocol(g);n?t=n+"://"+
v:0===g.indexOf("//")&&(t="//"+v)}return t};p.isSameServer=function(g,t){g=p.getServerByUrl(g)||"";t=p.getServerByUrl(t)||"";return g.toLowerCase()===t.toLowerCase()};p.getDomain=function(g){var t="";if(g=p.getServerByUrl(g))g=g.replace(/:\d+$/,""),g=g.match(/[^.]\w+\.\w+$/),null!==g&&(t=g[0],/^\d+\.\d+$/.test(t)&&(t=""));return t};p.isSameDomain=function(g,t){g=p.getDomain(g);t=p.getDomain(t);return""!==g&&g===t};p.isOrgOnline=function(g){return 0<=p.getServerByUrl(g).toLowerCase().indexOf(".maps.arcgis.com")};
p.isOnline=function(g){return 0<=p.getServerByUrl(g).toLowerCase().indexOf(".arcgis.com")};p.isArcGIScom=function(g){g=p.getServerByUrl(g).toLowerCase();return"www.arcgis.com"===g||"arcgis.com"===g};p.getStandardPortalUrl=function(g){var t=p.getServerByUrl(g);if(""===t)return"";p.isOnline(t)?(p.isArcGIScom(t)&&(t="www.arcgis.com"),g=p.addProtocol(g),g=p.getProtocol(g)+"://"+t):(g=(g||"").trim().replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),g=p.addProtocol(g),g.replace(new RegExp("http(s?)://"+t,
"g"),"")||(g+="/arcgis"));return g};p.isSamePortalUrl=function(g,t){var v=/^http(s?):\/\//gi,n=/^\/\//gi;g=p.getStandardPortalUrl(g).toLowerCase().replace(v,"").replace(n,"");t=p.getStandardPortalUrl(t).toLowerCase().replace(v,"").replace(n,"");return g===t};p.addProtocol=function(g){if(-1>=g.toLowerCase().indexOf("http://")&&-1>=g.toLowerCase().indexOf("https://")){var p="";"undefined"!==typeof window&&window.location?(p=window.location.protocol,g=g.startWith("//")?p+g:g.startWith("/")?p+"//"+window.location.host+
g:p+"//"+g):(p="http:",g=g.startWith("//")?p+g:p+"//"+g)}return g};p.getProtocol=function(g){var p="";g=g.toLowerCase();0===g.indexOf("https://")?p="https":0===g.indexOf("http://")&&(p="http");return p};p.updateUrlProtocolByOtherUrl=function(g,t){t=t.toLowerCase();0===t.indexOf("https://")?g=p.setHttpsProtocol(g):0===t.indexOf("http://")&&(g=p.setHttpProtocol(g));return g};p.removeProtocol=function(g){return g.replace(/^http(s?):\/\//i,"//")};p.setHttpProtocol=function(g){g=p.addProtocol(g);return g.replace(/^https:\/\//,
"http://")};p.setHttpsProtocol=function(g){g=p.addProtocol(g);return g.replace(/^http:\/\//,"https://")};p.setProtocol=function(g,t){return 0<=t.indexOf("https")?p.setHttpsProtocol(g):0<=t.indexOf("http")?p.setHttpProtocol(g):g};p.getSharingUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest");return t};p.getOAuth2Url=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest/oauth2");return t};p.getAppIdUrl=function(g,t){var v="";(g=p.getStandardPortalUrl(g))&&
(v=g+"/sharing/rest/oauth2/apps/"+t);return v};p.getSignInUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/signin.html");return t};p.getBaseSearchUrl=function(g){var t="";g=p.getStandardPortalUrl(g);(g=g.replace(/\/*$/g,""))&&(t=g+"/sharing/rest/search");return t};p.getBaseItemUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest/content/items");return t};p.getItemUrl=function(g,t){var v="";(g=p.getBaseItemUrl(g))&&t&&(v=g+"/"+t);return v};p.getItemDataUrl=
function(g,t){var v="";(g=p.getItemUrl(g,t))&&(v=g+"/data");return v};p.getItemGroupsUrl=function(g,t){var v="";(g=p.getItemUrl(g,t))&&(v=g+"/groups");return v};p.getGenerateTokenUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/generateToken");return t};p.getItemDetailsPageUrl=function(g,t){var v="";g&&t&&(g=p.getStandardPortalUrl(g),v=g+"/home/item.html?id\x3d"+t);return v};p.getUserProfilePageUrl=function(g,t){var v="";g&&t&&(g=p.getStandardPortalUrl(g),v=g+"/home/user.html?user\x3d"+
t);return v};p.getBaseGroupUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest/community/groups");return t};p.getPortalSelfInfoUrl=function(g){var t="";(g=p.getStandardPortalUrl(g||""))&&(t=g+"/sharing/rest/portals/self");return t};p.getCommunitySelfUrl=function(g){var t="";(g=p.getStandardPortalUrl(g||""))&&(t=g+"/sharing/rest/community/self");return t};p.getBaseUserUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest/community/users");return t};p.getUserUrl=
function(g,t){var v="",n=p.getBaseUserUrl(g);g&&t&&(v=n+"/"+t);return v};p.getUserTagsUrl=function(g,t){var v="",n=p.getUserUrl(g,t);g&&t&&(v=n+"/tags");return v};p.getUserThumbnailUrl=function(g,t,v){var n="";(g=p.getUserUrl(g,t))&&v&&(n=g+"/info/"+v);return n};p.getContentUrl=function(g){var t="";g&&(g=p.getStandardPortalUrl(g),t=g+"/sharing/rest/content");return t};p.getUserContentUrl=function(g,t,v){var n="",n="";g&&t&&(n=p.getContentUrl(g),n=v?n+"/users/"+t+"/"+v:n+"/users/"+t);return n};p.getUserContentItemUrl=
function(g,t,v){var n="",n="";g&&t&&v&&(n=p.getUserContentUrl(g,t),n=n+"/items/"+v);return n};p.getItemResourceUrl=function(g,t,v){var n="",n="";g&&t&&(n=p.getContentUrl(g),n=v?n+"/items/"+t+"/resources/"+v:n+"/items/"+t+"/resources");return n};p.getAddItemUrl=function(g,t,v){var n="",n="";g&&t&&(n=p.getUserContentUrl(g,t,v),n+="/addItem");return n};p.getDeleteItemUrl=function(g,t,v){var n="";(g=p.getUserItemsUrl(g,t))&&(n=g+"/"+v+"/delete");return n};p.getUserItemsUrl=function(g,t,v){var n="",n=
"";g&&t&&(n=p.getUserContentUrl(g,t,v),n+="/items");return n};p.getUpdateItemUrl=function(g,t,v,n){var m="",m="";g&&t&&(m=p.getUserItemsUrl(g,t,n),m=m+"/"+v+"/update");return m};p.shareItemUrl=function(g,t,v,n){var m="",m="";g&&t&&(m=p.getUserItemsUrl(g,t,n),m=m+"/"+v+"/share");return m};p.getHomeIndexUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/index.html");return t};p.getHomeMapViewerUrl=function(g,t){var v="";if(g=p.getStandardPortalUrl(g))v=g+"/home/webmap/viewer.html",
v=t?v+("?webmap\x3d"+t):v+"?useExisting\x3d1";return v};p.getHomeSceneViewerUrl=function(g,t){var v="";if(g=p.getStandardPortalUrl(g))v=g+"/home/webscene/viewer.html",t&&(v+="?webscene\x3d"+t);return v};p.getHomeGalleryUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/gallery.html");return t};p.getHomeGroupsUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/groups.html");return t};p.getHomeMyContentUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/content.html");
return t};p.getHomeMyOrganizationUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/organization.html");return t};p.getHomeUserUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/home/user.html");return t};p.getPortalHelpUrl=function(g,t){var v="";(g=p.getStandardPortalUrl(g))&&(v=g+"/portalhelp/"+(t||"en")+"/portal/");return v};p.getPortalAdminHelpUrl=function(g,t){var v="";(g=p.getStandardPortalUrl(g))&&(v=g+"/portalhelp/"+(t||"en")+"/admin/help/");return v};p.getPortalProxyUrl=
function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/proxy");return t};p.getOAuth2SignOutUrl=function(g){var t="";(g=p.getStandardPortalUrl(g))&&(t=g+"/sharing/rest/oauth2/signout");return t};p.getNewPrintUrl=function(g){var t="";if(g=p.getStandardPortalUrl(g))g=p.setHttpProtocol(g),t=g+"/sharing/tools/newPrint";return t};p.getSwitchAccoutnsUrl=function(g,t,v){var n="";if(g=p.getStandardPortalUrl(g))n=g+"/home/pages/Account/manage_accounts.html#client_id\x3d"+t,v&&(n+="\x26redirect_uri\x3d"+
v);n&&(n=p.setHttpsProtocol(n));return n};return p})},"jimu/shared/utils":function(){define([],function(){function p(g,n){function m(m,k){var f,e,b,a,c="widgetOnScreen"===m;if(g[m]){if(g[m].groups)for(f=0;f<g[m].groups.length;f++)if(b=g[m].groups[f],k(b,{index:f,isWidget:!1,groupId:b.id,isThemeWidget:!1,isOnScreen:c}),g[m].groups[f].widgets)for(e=0;e<g[m].groups[f].widgets.length;e++)a=g[m].groups[f].widgets[e],k(a,{index:e,isWidget:!0,groupId:b.id,isThemeWidget:a.uri&&-1<a.uri.indexOf("themes/"+
g.theme.name),isOnScreen:c});if(g[m].widgets)for(f=0;f<g[m].widgets.length;f++)a=g[m].widgets[f],k(g[m].widgets[f],{index:f,isWidget:!0,groupId:m,isThemeWidget:a.uri&&-1<a.uri.indexOf("themes/"+g.theme.name),isOnScreen:c})}}m("widgetOnScreen",n);m("widgetPool",n)}var g={},t="inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance mirrorIconForRTL".split(" ");
g.visitElement=p;g.getConfigElementById=function(g,n){var m;if("map"===n)return g.map;p(g,function(g){if(g.id===n)return m=g,!0});return m};g.getConfigElementByLabel=function(g,n){var m;if("map"===n)return g.map;p(g,function(g){if(g.label||g.name===n)return m=g,!0});return m};g.getConfigElementsByName=function(g,n){var m=[];if("map"===n)return[g.map];p(g,function(g){g.name===n&&m.push(g)});return m};g.getWidgetNameFromUri=function(g){g=g.split("/");g.pop();return g.pop()};g.getAmdFolderFromUri=function(g){g=
g.split("/");g.pop();return g.join("/")+"/"};g.widgetProperties=t;g.processWidgetProperties=function(g){"undefined"===typeof g.properties.isController&&(g.properties.isController=!1);"undefined"===typeof g.properties.isThemeWidget&&(g.properties.isThemeWidget=!1);"undefined"===typeof g.properties.hasVersionManager&&(g.properties.hasVersionManager=!1);"undefined"===typeof g.properties.mirrorIconForRTL&&(g.properties.mirrorIconForRTL=!1);t.forEach(function(n){"undefined"===typeof g.properties[n]&&(g.properties[n]=
!0)})};g.getControllerWidgets=function(g){var n=[];g.visitElement(function(g){g.isController&&n.push(g)});return n};g.addI18NLabelToManifest=function(g,n,m){function p(e,b){b[k]&&(g.i18nLabels[e]=b[k]);"theme"===g.category&&(g.layouts&&g.layouts.forEach(function(a){g["i18nLabels_layout_"+a.name]||(g["i18nLabels_layout_"+a.name]={});g["i18nLabels_layout_"+a.name][e]=b["_layout_"+a.name]}),g.styles&&g.styles.forEach(function(a){g["i18nLabels_style_"+a.name]||(g["i18nLabels_style_"+a.name]={});g["i18nLabels_style_"+
a.name][e]=b["_style_"+a.name]}));"widget"===g.category&&g.featureActions&&g.featureActions.forEach(function(a){g["i18nLabels_featureAction_"+a.name]||(g["i18nLabels_featureAction_"+a.name]={});g["i18nLabels_featureAction_"+a.name][e]=b["_featureAction_"+a.name]})}g.i18nLabels={};var k="widget"===g.category?"_widgetLabel":"_themeLabel";n&&n.root&&n.root[k]&&(g.i18nLabels.defaultLabel=n.root[k],"theme"===g.category&&(g.layouts&&g.layouts.forEach(function(e){g["i18nLabels_layout_"+e.name]={};g["i18nLabels_layout_"+
e.name].defaultLabel=n.root["_layout_"+e.name]}),g.styles&&g.styles.forEach(function(e){g["i18nLabels_style_"+e.name]={};g["i18nLabels_style_"+e.name].defaultLabel=n.root["_style_"+e.name]})),"widget"===g.category&&g.featureActions&&g.featureActions.forEach(function(e){g["i18nLabels_featureAction_"+e.name]={};g["i18nLabels_featureAction_"+e.name].defaultLabel=n.root["_featureAction_"+e.name]}));for(var f in m)p(f,m[f])};g.isHostedService=function(g){if(!g)return!1;var n=-1!==g.indexOf(".arcgis.com/");
g=-1!==g.indexOf("//services")||-1!==g.indexOf("//tiles")||-1!==g.indexOf("//features");return n&&g};return g})},"jimu/accessibleUtils":function(){define(["dojo/_base/lang","dojo/_base/html","dojo/query","dojo/keys","dojo/on"],function(p,g,t,v,n){var m={firstFocusNodeClass:"firstFocusNode",lastFocusNodeClass:"lastFocusNode",isInNavMode:function(){return g.hasClass(document.body,"jimu-nav-mode")?!0:!1},initTabIndexAndOrder:function(g){var k=m.getFirstFocusNode(g.domNode,g.inPanel),f=m.getLastFocusNode(g.domNode);
k&&!f&&(f=k);g.isController&&(k=f=null);m.initFirstFocusNode(g.domNode,k);m.initLastFocusNode(g.domNode,f)},isCommonOnScreenWidget:function(g){return g.isOnScreen&&!g.inPanel&&!0!==g.closeable},preventMapNavigation:function(g){0<=[v.NUMPAD_PLUS,61,187,v.NUMPAD_MINUS,173,189,v.UP_ARROW,v.NUMPAD_8,v.RIGHT_ARROW,v.NUMPAD_6,v.DOWN_ARROW,v.NUMPAD_2,v.LEFT_ARROW,v.NUMPAD_4,v.PAGE_UP,v.NUMPAD_9,v.PAGE_DOWN,v.NUMPAD_3,v.END,v.NUMPAD_1,v.HOME,v.NUMPAD_7].indexOf(g.keyCode)&&g.stopPropagation()},_addAttrsOnWidgetDom:function(m){var k=
0<=["MyLocation","HomeButton","FullScreen"].indexOf(m.name)?"button":"application";m.inPanel||g.setAttr(m.domNode,"role",k)},initWidgetCancelEvent:function(u){this._addAttrsOnWidgetDom(u);n(u.domNode,"keydown",p.hitch(this,function(k){m.preventMapNavigation(k);var f=k.target;if(!(u.inPanel||0>[v.ENTER,v.ESCAPE].indexOf(k.keyCode)))if(m.isCommonOnScreenWidget(u))if(k.keyCode===v.ENTER&&g.hasClass(f,u.baseClass))k.preventDefault(),m.focusFirstFocusNode(u.domNode);else{if(k.keyCode===v.ESCAPE)if(!g.hasClass(f,
u.baseClass))k.stopPropagation(),u.domNode.focus();else if("Splash"!==u.name||"none"===g.getStyle(u.domNode,"display"))f=u.domNode.parentNode,"map"===g.getAttr(f,"id")?(k.preventDefault(),f.focus()):(k="jimu-layout-manager"===g.getAttr(f,"id")?u.domNode:u.domNode.parentNode,m.trapToNextFocusContainer(k,!1))}else k.keyCode!==v.ESCAPE||g.hasClass(f,u.baseClass)||(u.domNode.focus(),u.onClose(),k.preventDefault(),k.stopPropagation())}))},initFirstFocusNode:function(u,k){var f=m.getFirstFocusNode(u);f&&
(g.removeClass(f,m.firstFocusNodeClass),f.firstNodeEvent&&f.firstNodeEvent.remove(),f===u&&(g.setAttr(f,"tabindex",null),g.setAttr(f,"role","")));k&&(k===u&&(g.setAttr(k,"tabindex",0),g.setAttr(k,"role","document")),g.addClass(k,m.firstFocusNodeClass),k.firstNodeEvent=n(k,"keydown",p.hitch(this,function(e){if(g.hasClass(e.target,m.firstFocusNodeClass)&&e.keyCode===v.TAB)if(window.currentMsgPopup&&window.currentMsgPopup.firstFocusNode)window.currentMsgPopup.focusedNodeBeforeOpen=e.target,e.preventDefault(),
window.currentMsgPopup.firstFocusNode.focus();else{var b=t(".jimu-widget-splash",t("#jimu-layout-manager")[0])[0];b&&"none"!==g.getStyle(b,"display")&&b!==u?(e.preventDefault(),t("."+m.firstFocusNodeClass,b)[0].focus()):e.shiftKey&&(e.preventDefault(),e=m.getLastFocusNode(u),m.isDomFocusable(e)?e.focus():m.getFocusNodesInDom(e)[0].focus())}})))},initLastFocusNode:function(u,k){var f=m.getLastFocusNode(u);f&&(g.removeClass(f,m.lastFocusNodeClass),f.lastNodeEvent&&f.lastNodeEvent.remove(),f===u&&g.setAttr(f,
"tabindex",null));k&&(k===u&&g.setAttr(k,"tabindex",0),g.addClass(k,m.lastFocusNodeClass),k.lastNodeEvent=n(k,"keydown",p.hitch(this,function(e){if(!e.shiftKey&&e.keyCode===v.TAB)if(u===k)e.preventDefault(),this.focusFirstFocusNode(u);else{var b=this.getFocusNodesInDom(k);0===b.length?(e.preventDefault(),this.focusFirstFocusNode(u)):g.hasClass(e.target,m.lastFocusNodeClass)||b[b.length-1]!==e.target||(e.preventDefault(),this.focusFirstFocusNode(u))}})))},focusFirstFocusNode:function(g){var k=t("."+
m.firstFocusNodeClass,g)[0];(k?k:g).focus()},getFirstFocusNode:function(n,k){var f=g.hasClass(n,m.firstFocusNodeClass)?n:t("."+m.firstFocusNodeClass,n)[0];!f&&k&&(f=n,null===g.getAttr(f,"tabindex")&&g.setAttr(f,"tabindex","0"));return f},getLastFocusNode:function(n){return g.hasClass(n,m.lastFocusNodeClass)?n:t("."+m.lastFocusNodeClass,n)[0]},traversalDom:function(g,k){k=k?k:[];for(var f=g.childNodes,e=0;e<f.length;e++)g=f[e],1===g.nodeType&&(k.push(g),m.traversalDom(g,k));return k},getFocusNodesInDom:function(g){g=
m.traversalDom(g);for(var k=[],f=0;f<g.length;f++){var e=g[f];m.isDomFocusable(e)&&k.push(e)}return k},isDomFocusable:function(m){var k=["A","INPUT","BUTTON","SELECT","TEXTAREA"],f="presentation"!==g.getAttr(m,"role"),e="hidden"!==g.getAttr(m,"type"),b=!0!==g.getAttr(m,"disabled"),a=parseInt(g.getAttr(m,"tabindex"),10);return f&&e&&b&&(0<=k.indexOf(m.tagName)&&-1!==a||0>k.indexOf(m.tagName)&&0<=a)?!0:!1},trapToNextFocusContainer:function(m,k){for(var f=m.parentNode.children,e=[],b=0;b<f.length;b++){var a=
f[b];0<parseInt(g.getAttr(a,"tabindex"),10)&&"none"!==g.getStyle(a,"display")&&e.push(a)}e.sort(function(a,b){a=parseInt(g.getAttr(a,"tabindex"),10);b=parseInt(g.getAttr(b,"tabindex"),10);return a<b?-1:a===b?0:1});f=null;if(k)f=e[0];else if("none"===g.getStyle(m,"display"))f=e[0];else for(m=parseInt(g.getAttr(m,"tabindex"),10),k=0;k<e.length;k++)if(parseInt(g.getAttr(e[k],"tabindex"),10)===m){f=k===e.length-1?e[0]:e[k+1];break}f||(f=t("#skipContainer a")[0]);f.focus();return f},_getTooltipLabel:function(m,
k){var f=g.getAttr(m,"aria-label");m=g.getAttr(m,"title");return f||m||k},focusFirstFocusByTheme:function(g,k){var f=g.appConfig.theme.name;"DashboardTheme"===f&&g.isOnScreen&&"widgetOnScreen"!==g.gid||"JewelryBoxTheme"===f&&g.panel&&g.panel.uri&&g.panel.uri.includes("LDockablePanel")||(!g.openAtStart||g._isNotOpenAtStart&&!g.openAtStartAysn)&&k.focus()},addTooltipByDomNode:function(u,k,f){u.defaultPosition=["below-centered","above-centered","after-centered","before-centered"];var e;n(k,"focus",p.hitch(this,
function(b){m.isInNavMode()&&(e&&g.setAttr(e,"role","presentation"),u.show(m._getTooltipLabel(k,f)+"\x26nbsp;\x26nbsp;",b.target),e||(e=t(".dijitTooltipContainer",document.body)[0],g.setAttr(e,"role","presentation")))}));n(k,"blur",p.hitch(this,function(b){u&&u.hide(b.target)}))}};return m})},"jimu/zoomToUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred esri/config esri/graphic esri/graphicsUtils esri/geometry/Extent esri/geometry/Point esri/SpatialReference esri/geometry/webMercatorUtils esri/tasks/ProjectParameters".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){var a={zoomToFeatureSet:function(b,e,f){var c=e.features&&0<e.features.length&&e.features[0].getLayer&&e.features[0].getLayer(),c=c?c.id:null;e=a.graphicsExtent(e.features,f);return a.zoomToExtent(b,e,c)},zoomToExtent:function(b,e,f){var c;if(!b||!a.isValidExtent(e))return c=new t,c.reject(),c;f?(c=new t,require(["jimu/LayerStructure"],function(g){(g=g.getInstance().getNodeById(f))?g.zoomTo(e).then(function(){c.resolve()},function(){c.reject()}):a.projectToMapSpatialReference(b,
e).then(function(f){e.isSinglePoint&&(f=a.convertSinglePointExtent(b,f));b.setExtent(f,!0);c.resolve()},function(){c.reject()})})):c=a.projectToMapSpatialReference(b,e).then(function(c){e.isSinglePoint&&(c=a.convertSinglePointExtent(b,c));return b.setExtent(c,!0)});return c},isValidExtent:function(b){return b&&a.isTrueOrZero(b.xmin)&&a.isTrueOrZero(b.ymin)&&a.isTrueOrZero(b.xmax)&&a.isTrueOrZero(b.ymax)}};a.isVaildExtent=a.isValidExtent;a.isTrueOrZero=function(a){return 0===a?!0:!!a};a.convertSinglePointExtent=
function(b,e){var c=b.getScale();if(c=a.getMedianScale(b,c,0))e=a.adjustHeightToAspectRatio(b,e),e=a.getExtentForScale(e,b.width,c);return e};a.graphicsExtent=function(a,b){var c=null;try{if(a&&1===a.length&&"esri.geometry.Multipoint"===a[0].geometry.declaredClass&&1===a[0].geometry.points.length){var e=a[0].geometry.points[0],f=new k(e[0],e[1],a[0].geometry.spatialReference);a=[new n(f)]}if(a&&1===a.length&&"esri.geometry.Point"===a[0].geometry.declaredClass){var g=a[0].geometry,c=new u(g.x-1E-4,
g.y-1E-4,g.x+1E-4,g.y+1E-4,g.spatialReference);c.isSinglePoint=!0}else a&&0<a.length&&(c=m.graphicsExtent(a))&&"number"===typeof b&&0<b&&(c=c.expand(b))}catch(E){console.error(E)}return c};a.projectToMapSpatialReference=function(b,e){return a.projectToSpatialReference(e,b.spatialReference)};a.projectToSpatialReference=function(a,g){var c=new t,k=a;if(g&&a)if(g.equals(a.spatialReference))c.resolve(k);else if(g.isWebMercator()&&a.spatialReference.equals(new f(4326)))k=e.geographicToWebMercator(a),k.isSinglePoint=
a.isSinglePoint,c.resolve(k);else if(g.equals(new f(4326))&&a.spatialReference.isWebMercator())k=e.webMercatorToGeographic(a),k.isSinglePoint=a.isSinglePoint,c.resolve(k);else{var m=v&&v.defaults&&v.defaults.geometryService;if(m&&"esri.tasks.GeometryService"===m.declaredClass){var n=new b;n.geometries=[a];n.outSR=g;m.project(n).then(function(b){(k=b&&0<b.length&&b[0])?(k.isSinglePoint=a.isSinglePoint,c.resolve(k)):c.reject()},function(){})}else c.reject()}else c.reject();return c};a.getMapLods=function(a){var b=
null;a._params&&a._params.lods&&(b=g.map(a._params.lods,p.hitch(this,function(a){return a.toJson()})));return b};a.getMedianScale=function(b,e,f){return a.getTargetScale(b,2,e,f)};a.getTargetScale=function(b,e,f,k){b=a.getMapLods(b);var c=1;if(b){var m=[],q=[];g.forEach(b,function(a){0<f&&a.scale>f||(a.scale<k?q.push(a.scale):m.push(a.scale))});m.reverse();1<=m.length?(c=q.length?q.length/b.length:1,e=Math.floor((m.length-1)/(e/c)),e=m[e]):e=null}else e=0===f?null:(f-k)/e;return e};a.getScaleForNextTileLevel=
function(b,e,f){if(b=a.getMapLods(b)){if(f){for(f=0;f<b.length;f++)if(b[f].scale<e)return b[f].scale-1;return b[b.length-1].scale-1}for(f=b.length-1;0<=f;f--)if(b[f].scale>e)return b[f].scale+1;return b[0].scale+1}return f?e-1:e+1};a.adjustExtentToAspectRatio=function(a,b){a=a.width/a.height;var c=b.getWidth()/b.getHeight();c>a?(a=b.getWidth()/a/2,p.mixin(b,{ymin:b.getCenter().y-a,ymax:b.getCenter().y+a})):c<a&&(a=b.getHeight()*a/2,p.mixin(b,{xmin:b.getCenter().x-a,xmax:b.getCenter().x+a}));return b};
a.adjustHeightToAspectRatio=function(a,b){a=b.getWidth()*(a.height/a.width)/5;p.mixin(b,{ymin:b.getCenter().y-a,ymax:b.getCenter().y+a});return b};a.getExtentForScale=function(a,b,e){var c=20015077/180,f=esri.config.defaults,g=esri.WKIDUnitConversion,k,m,n=a.spatialReference;n&&(k=n.wkid,m=n.wkt);n=null;k?n=g.values[g[k]]:m&&-1!==m.search(/^PROJCS/i)&&(g=/UNIT\[([^\]]+)\]\]$/i.exec(m))&&g[1]&&(n=parseFloat(g[1].split(",")[1]));return a.expand(e*b/(39.37*(n||c)*f.screenDPI)/a.getWidth())};a.getScaleForExtent=
function(a,b){var c=20015077/180,e=esri.config.defaults,f=esri.WKIDUnitConversion,g,k,m=a.spatialReference;m&&(g=m.wkid,k=m.wkt);m=null;g?m=f.values[f[g]]:k&&-1!==k.search(/^PROJCS/i)&&(f=/UNIT\[([^\]]+)\]\]$/i.exec(k))&&f[1]&&(m=parseFloat(f[1].split(",")[1]));return a.getWidth()/b*(m||c)*39.37*e.screenDPI};return a})},"jimu/portalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json dojo/request/xhr esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils ./ServiceDefinitionManager".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w=p([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,constructor:function(b){this.portalUrl=a.getStandardPortalUrl(b);this.selfUrl=a.getPortalSelfInfoUrl(b)},loadSelfInfo:function(){var a=this.selfUrl;this.isValidCredential()&&(a=-1<a.indexOf("?")?a+("\x26token\x3d"+this.credential.token):a+("?token\x3d"+this.credential.token));return x.getInstance().getServiceDefinition(a).then(g.hitch(this,function(a){var b=
a.user;delete a.user;g.mixin(this,a);a.user=b;return a}))},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=c.getPortalCredential(this.portalUrl))},signIn:function(){var a=new n;this.updateCredential();this.isValidCredential()?setTimeout(g.hitch(this,function(){a.resolve(this.credential)}),
0):a=c.signInPortal(this.portalUrl);return a},haveSignIn:function(){return c.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new n;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(g.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(g.hitch(this,function(b){this.user=
b;a.resolve(this.user)}),g.hitch(this,function(b){console.error(b);a.reject(b)})):c.getUserIdByToken(this.credential.token,this.portalUrl).then(g.hitch(this,function(b){this.credential.userId=b;this._getUser(this.credential.userId).then(g.hitch(this,function(b){this.user=b;a.resolve(this.user)}),g.hitch(this,function(b){console.error(b);a.reject(b)}))}),g.hitch(this,function(b){console.error(b);a.reject(b)})):setTimeout(g.hitch(this,function(){a.reject("credential is null.")}),0);return a},queryItems:function(b){this.updateCredential();
var c=new n,e=a.getBaseSearchUrl(this.portalUrl),k={f:"json"};b&&(k=g.mixin(k,b));this.isValidCredential()&&(k.token=this.credential.token);k.sortField||k.sortOrder||(k.sortField="title",k.sortOrder="asc");f({url:e,handleAs:"json",content:k,callbackParamName:"callback"}).then(g.hitch(this,function(a){a.results=t.map(a.results,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new z(a)}));c.resolve(a)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));
return c},getItemData:function(b){this.updateCredential();b={url:a.getItemDataUrl(this.portalUrl,b),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};return f(b)},_getItemById:function(b,c){b={url:a.getItemUrl(this.portalUrl,b),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};c&&(b.content.token=c);return f(b).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new z(a)}))},getItemById:function(a,b){this.updateCredential();
return this._getItemById(a).then(g.hitch(this,function(c){return b&&c.owner&&this.isValidCredential()&&this.credential&&this.credential.userId===c.owner?this._getItemById(a,this.credential.token):c}))},getAppById:function(b){var c=new n;this.updateCredential();this.isValidCredential()?(b=a.getAppIdUrl(this.portalUrl,b),c=f({url:b,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(g.hitch(this,function(){c.reject("token is null.")}),0);return c},queryGroups:function(b){this.updateCredential();
var c=new n,e=a.getBaseGroupUrl(this.portalUrl),k={f:"json"};b&&(k=g.mixin(k,b));this.isValidCredential()&&(k.token=this.credential.token);f({url:e,handleAs:"json",content:k,callbackParamName:"callback"}).then(g.hitch(this,function(a){a.results=t.map(a.results,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;return new C(a)}));c.resolve(a)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},registerApp:function(b,c,e){var k=new n;this.updateCredential();
if(this.isValidCredential())var m=this.credential&&this.credential.token,q=a.getOAuth2Url(this.portalUrl),k=f({url:q+"/registerApp",content:{itemId:b,appType:c,redirect_uris:u.stringify(e),token:m,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(g.hitch(this,function(){k.reject("token is null.")}),0);return k},createAndRegisterApp:function(a){var b=new n;this.updateCredential();this.isValidCredential()?this.getUser().then(g.hitch(this,function(c){c.addItem({title:"Web AppBuilder for ArcGIS",
type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(g.hitch(this,function(c){c.success?this.registerApp(c.id,"browser",a).then(g.hitch(this,function(a){b.resolve(a)}),g.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject("create app failed")}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}),g.hitch(this,function(a){console.error(a);b.reject(a)})):setTimeout(g.hitch(this,function(){b.reject("token is null.")}),0);return b},_getUser:function(b){this.updateCredential();
var c=new n;b={url:a.getUserUrl(this.portalUrl,b),content:{f:"json"},handleAs:"json",callbackParamName:"callback"};this.isValidCredential()&&(b.content.token=this.credential&&this.credential.token);f(b).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;this.user=new q(a);c.resolve(this.user)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),q=p([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&
g.mixin(this,a)},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},canCreateItem:function(){var a=new e({id:this.roleId?this.roleId:this.role,role:this.role});this.privileges&&a.setPrivileges(this.privileges);return a.canCreateItem()},
getGroups:function(){var a=[];this.groups&&(a=t.map(this.groups,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this.portal;return new C(a)})));return a},getItemsByKeywords:function(a,b){return this.portal.queryItems({start:b||1,num:100,q:"owner:"+this.username+' AND typekeywords:"'+a+'"'})},getContent:function(){this.updateCredential();var b={url:a.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential&&(b.content.token=this.credential.token);return f(b)},getTags:function(){this.updateCredential();var b={url:a.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(b.content.token=this.credential.token);return f(b)},addItem:function(b,c){this.updateCredential();var e=new n;if(this.isValidCredential()){var k={f:"json",token:this.credential.token};b&&(k=g.mixin(k,b));f({url:a.getAddItemUrl(this.portalUrl,
this.username,c),handleAs:"json",callbackParamName:"callback",content:k},{usePost:!0}).then(g.hitch(this,function(a){e.resolve(a)}),g.hitch(this,function(a){console.error(a);e.reject(a)}))}else setTimeout(g.hitch(this,function(){e.reject("token is null.")}),0);return e},deleteItem:function(b){this.updateCredential();var c=new n;this.isValidCredential()?(b=a.getDeleteItemUrl(this.portalUrl,this.username,b),c=f({url:b,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(g.hitch(this,
function(){c.reject("token is null.")}),0);return c},getItemById:function(b,c){this.updateCredential();var e=new n;b={url:a.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+b,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};f(b).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.portal=this;a=new z(a);e.resolve(a)}),g.hitch(this,function(a){console.error(a);e.reject(a)}));return e},shareItem:function(b,c,e){this.updateCredential();var k=new n;
this.isValidCredential()?(c={url:a.shareItemUrl(this.portalUrl,this.username,c,e),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},b&&(c.content=g.mixin(c.content,b)),f(c,{usePost:!0}).then(g.hitch(this,function(a){k.resolve(a)}),g.hitch(this,function(a){console.error(a);k.reject(a)}))):setTimeout(g.hitch(this,function(){k.reject("token is null.")}),0);return k},updateItem:function(b,c){this.updateCredential();var e=new n;this.isValidCredential()?this.portal.getItemById(b).then(g.hitch(this,
function(k){var m={f:"json",token:this.credential.token};c&&(m=g.mixin(m,c));f({url:a.getUpdateItemUrl(this.portalUrl,k.owner,b,k.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:m},{usePost:!0}).then(g.hitch(this,function(a){e.resolve(a)}),g.hitch(this,function(a){console.error(a);e.reject(a)}))}),g.hitch(this,function(a){console.error(a);e.reject(a)})):setTimeout(g.hitch(this,function(){e.reject("token is null.")}),0);return e},isAdminRole:function(){return"org_admin"===
this.role||"account_admin"===this.role},isPublisherRole:function(){return"org_publisher"===this.role||"account_publisher"===this.role},isUserRole:function(){return"org_user"===this.role||"account_user"===this.role},getRegisteredAppInfo:function(b,c){var e=new n;this.updateCredential();c=a.getUserItemsUrl(this.portalUrl,this.username,c);return e=f({url:c+"/"+b+"/registeredAppInfo",content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})},getRegisteredAppInfoWithXhr:function(b,
c){var e=new n;this.updateCredential();c=a.getUserItemsUrl(this.portalUrl,this.username,c);return e=k(c+"/"+b+"/registeredAppInfo",{data:{token:this.credential.token,f:"json"},method:"POST",handleAs:"json"})}}),C=p([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,portal:null,constructor:function(a){a&&g.mixin(this,a)},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),z=p([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,portal:null,token:null,constructor:function(b){b&&g.mixin(this,b);this.itemUrl=a.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&this.thumbnail&&this.itemUrl&&
(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=a.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=a.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=c.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();
return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)},getItemGroups:function(){this.updateCredential();var b={url:a.getItemGroupsUrl(this.portalUrl,this.id),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(b.content.token=this.credential.token);return f(b)}}),E={portals:[],webMapQueryStr:" "+
b.getItemQueryStringByTypes(["Web Map"])+" ",webSceneQueryStr:" "+b.getItemQueryStringByTypes(["Web Scene"])+" ",_findPortal:function(b){for(var c=0;c<this.portals.length;c++){var e=this.portals[c];if(a.isSamePortalUrl(b,e.portalUrl))return e.updateCredential(),e}return null},getPortal:function(b){if(!b||"string"!==typeof b||!g.trim(b))return null;b=a.getStandardPortalUrl(b);var e=this._findPortal(b);e||(e=new w(b),e.credential=c.getPortalCredential(e.portalUrl),e.updateCredential(),this.portals.push(e));
return e},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var b="english",c="",e=new n;this.getPortal(a).getUser().then(g.hitch(this,function(a){a&&a.units?b=a.units:(c=v.locale,b=c.startWith("en")?"english":"metric");e.resolve(b)}),g.hitch(this,function(f){console.warn(f);
this.getPortalSelfInfo(a).then(g.hitch(this,function(a){var b=null;a&&a.units?b=a.units:(c=a&&a.culture||v.locale,b=c.startWith("en")?"english":"metric");e.resolve(b)}),g.hitch(this,function(a){console.warn(a);c=v.locale;b=c.startWith("en")?"english":"metric";e.resolve(b)}))}));return e.promise},_getPortalSelfGroup:function(a,b){var c=new n,e=this.getPortal(a);e||setTimeout(g.hitch(this,function(){c.reject()}),0);this.getPortalSelfInfo(a).then(g.hitch(this,function(a){e.queryGroups({f:"json",q:a[b]}).then(g.hitch(this,
function(a){0<a.results.length?(a=a.results[0],a.portalUrl=e.portalUrl,a.credential=e.credential,a.portal=e,a=new C(a),c.resolve(a)):c.reject("Can't find portal self group.")}),g.hitch(this,function(a){console.error(a);c.reject(a)}))}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getWebMapsFromBasemapGalleryGroup:function(a){var b=new n;this.getBasemapGalleryGroup(a).then(g.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(g.hitch(this,
function(a){b.resolve(a)}),g.hitch(this,function(a){console.error(a);b.reject(a)})):b.reject()}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getDefaultWebScene:function(b){var c=a.getStandardPortalUrl(b);return this._searchWABDefaultWebScene(c).then(g.hitch(this,function(a){return a?a:this._createWABDefaultWebScene(c).then(g.hitch(this,function(a){return this.getPortal(c).getUser().then(g.hitch(this,function(b){var c=!1;b&&b.privileges&&0<b.privileges.length&&(c=t.some(b.privileges,
function(a){return 0<=a.indexOf("shareToPublic")}));return c?b.shareItem({everyone:!0},a).then(g.hitch(this,function(){return a}),g.hitch(this,function(){return a})):a}),g.hitch(this,function(b){console.error(b);return a}))}))}))},_searchWABDefaultWebScene:function(b){var c=new n;b=a.getStandardPortalUrl(b);b=this.getPortal(b);b.queryItems({q:'typekeywords:"WABDefaultWebScene" orgid:'+b.user.orgId+" access:public "+this.webSceneQueryStr}).then(g.hitch(this,function(a){a&&a.results&&0<a.results.length?
c.resolve(a.results[0].id):c.resolve(null)}),g.hitch(this,function(a){console.error("_searchWABDefaultWebScene error:",a);c.reject(a)}));return c},_createWABDefaultWebScene:function(b){var c=new n;b=a.getStandardPortalUrl(b);this.getPortal(b).getUser().then(g.hitch(this,function(a){var b={title:"Default Web Scene",type:"Web Scene",typeKeywords:"WABDefaultWebScene",tags:"default",text:u.stringify({operationalLayers:[],baseMap:{id:"basemap",title:"Topographic",baseMapLayers:[{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",
id:"worldTopoBase",layerType:"ArcGISTiledMapServiceLayer",title:"Topo"}],elevationLayers:[{url:"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",id:"globalElevation",listMode:"hide",layerType:"ArcGISTiledElevationServiceLayer",title:"Elevation"}]},ground:{layers:[{url:"https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",id:"globalElevation",listMode:"hide",layerType:"ArcGISTiledElevationServiceLayer",title:"Elevation"}]},
viewingMode:"global",spatialReference:{latestWkid:3857,wkid:102100},version:"1.15",authoringApp:"WebAppBuilder",authoringAppVersion:"2.12"}),snippet:""};a.addItem(b,"").then(g.hitch(this,function(a){a.success?c.resolve(a.id):(console.error("Can't create default web scene:",a),c.reject())}))}),g.hitch(this,function(a){console.error("Can't create default web scene");c.reject(a)}));return c},getDefaultWebMap:function(a){var b=new n;this.getPortalSelfInfo(a).then(g.hitch(this,function(c){var e=c.defaultBasemap&&
c.defaultBasemap.id;e?b.resolve(e):this._getDefaultWebMapByBasemapGallery(a,c).then(g.hitch(this,function(c){c?b.resolve(c):this._getMostNumViewsWebMap(a).then(g.hitch(this,function(a){a?b.resolve(a):b.reject()}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getDefaultWebMapByBasemapGallery:function(a,b){var c=new n,e=this.getPortal(a),f=b.defaultBasemap&&b.defaultBasemap.title;
e.queryGroups({f:"json",q:b.basemapGalleryGroupQuery}).then(g.hitch(this,function(a){a=a.results;0<a.length?e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+a[0].id+" AND title:"+f}).then(g.hitch(this,function(a){a=a.results;a=t.filter(a,g.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),e.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+
f}).then(g.hitch(this,function(a){a=a.results;a=t.filter(a,g.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));if(0<a.length){var b=a[0];e.getItemData(b.id).then(g.hitch(this,function(a){a&&(a.operationalLayers||a.baseMap||a.version)?c.resolve(b.id):c.resolve(null)}),g.hitch(this,function(){c.resolve(null)}))}else console.log("Can't find web map by defaultBasemap.title."),c.resolve(null)}),g.hitch(this,function(a){console.error(a);c.reject(a)})))}),g.hitch(this,function(a){console.error(a);
c.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),c.resolve(null))}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getMostNumViewsWebMap:function(a){var b=new n;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND access:public AND owner:esri_en",sortField:"numViews",sortOrder:"desc"}).then(g.hitch(this,function(a){a=a.results;a=t.filter(a,g.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?
b.resolve(a[0].id):b.reject("Can't find most-num-views web map.")}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},comparePortalVersion:function(a,b){var c=a.split(".");a=parseInt(c[0],10);var c=1<c.length?parseInt(c[1],10):0,e=b.split(".");b=parseInt(e[0],10);e=1<e.length?parseInt(e[1],10):0;return a>b?1:a<b?-1:c>e?1:c<e?-1:0},getItemResources:function(b,c,e){e||(e=100);b=a.getStandardPortalUrl(b);b=a.getItemResourceUrl(b,c);return f({url:b,content:{f:"json",num:e}}).then(function(a){if(a&&
a.resources)return a.resources})},addResource:function(b,c,e,g,k){b=a.getStandardPortalUrl(b);var m=this.getPortal(b),q=new FormData;q.append("file",e,g);q.append("fileName",g);q.append("f","json");var n="";k?(q.append("resourcesPrefix",k),n=k+"/"+g):n=g;return m.getItemById(c,!0).then(function(e){e=a.getUserContentItemUrl(b,e.owner,c);return f({url:e+"/addResources",form:q}).then(function(c){var e="";c&&c.success&&(e=a.getItemResourceUrl(b,"${itemId}",n));return e},function(a){console.error(a.message||
a);return a})})},removeResources:function(b,c,e,g){var k={resource:g?g+"/"+e:e,f:"json"};b=a.getStandardPortalUrl(b);return this.getPortal(b).getItemById(c,!0).then(function(e){e=a.getUserContentItemUrl(b,e.owner,c);return f({url:e+"/removeResources",content:k},{usePost:!0}).then(function(a){return a},function(a){console.error(a.message||a);return a})})}};m.subscribe("userSignOut",function(a){(a=E._findPortal(a))&&a.clearCredentialAndUser()});return E})},"jimu/Role":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/json","esri/lang"],function(p,g,t,v,n){return p(null,{id:null,baseRole:null,name:null,description:null,privileges:[],privilegeObj:null,constructor:function(g){g=g||{};this.id=g.id;this.baseRole=g.role;this.name=g.name;this.description=g.description},_initPrivilegesObject:function(){this.privilegeObj={portal:{admin:{inviteUsers:!1,disableUsers:!1,viewUsers:!1,updateUsers:!1,deleteUsers:!1,changeUserRoles:!1,viewGroups:!1,updateGroups:!1,deleteGroups:!1,reassignGroups:!1,
assignToGroups:!1,manageEnterpriseGroups:!1,viewItems:!1,updateItems:!1,deleteItems:!1,reassignItems:!1,manageLicenses:!1},publisher:{publishFeatures:!1,publishTiles:!1,publishScenes:!1},user:{createGroup:!1,joinGroup:!1,joinNonOrgGroup:!1,createItem:!1,shareToGroup:!1,shareToOrg:!1,shareToPublic:!1,shareGroupToOrg:!1,shareGroupToPublic:!1}},features:{user:{edit:!1,fullEdit:!1}},opendata:{user:{openDataAdmin:!1,designateGroup:!1}},premium:{user:{geocode:!1,networkanalysis:!1,spatialanalysis:!1,geoenrichment:!1,
demographics:!1,elevation:!1}},marketplace:{admin:{manage:!1,purchase:!1,startTrial:!1}}}},_readPrivileges:function(m){n.isDefined(m)&&m instanceof Array&&t.forEach(m,g.hitch(this,function(g){this._readPrivilege(g)}))},_readPrivilege:function(g){this._applyEffectToAction(!0,g)},_applyEffectToAction:function(g,n){switch(n){case "portal:admin:inviteUsers":this.privilegeObj.portal.admin.inviteUsers=g;break;case "portal:admin:disableUsers":this.privilegeObj.portal.admin.disableUsers=g;break;case "portal:admin:viewUsers":this.privilegeObj.portal.admin.viewUsers=
g;break;case "portal:admin:updateUsers":this.privilegeObj.portal.admin.updateUsers=g;break;case "portal:admin:deleteUsers":this.privilegeObj.portal.admin.deleteUsers=g;break;case "portal:admin:changeUserRoles":this.privilegeObj.portal.admin.changeUserRoles=g;break;case "portal:admin:viewGroups":this.privilegeObj.portal.admin.viewGroups=g;break;case "portal:admin:updateGroups":this.privilegeObj.portal.admin.updateGroups=g;break;case "portal:admin:deleteGroups":this.privilegeObj.portal.admin.deleteGroups=
g;break;case "portal:admin:reassignGroups":this.privilegeObj.portal.admin.reassignGroups=g;break;case "portal:admin:assignToGroups":this.privilegeObj.portal.admin.assignToGroups=g;break;case "portal:admin:manageEnterpriseGroups":this.privilegeObj.portal.admin.manageEnterpriseGroups=g;break;case "portal:admin:viewItems":this.privilegeObj.portal.admin.viewItems=g;break;case "portal:admin:updateItems":this.privilegeObj.portal.admin.updateItems=g;break;case "portal:admin:deleteItems":this.privilegeObj.portal.admin.deleteItems=
g;break;case "portal:admin:reassignItems":this.privilegeObj.portal.admin.reassignItems=g;break;case "portal:admin:manageLicenses":this.privilegeObj.portal.admin.manageLicenses=g;break;case "portal:publisher:publishFeatures":this.privilegeObj.portal.publisher.publishFeatures=g;break;case "portal:publisher:publishTiles":this.privilegeObj.portal.publisher.publishTiles=g;break;case "portal:publisher:publishScenes":this.privilegeObj.portal.publisher.publishScenes=g;break;case "portal:user:createGroup":this.privilegeObj.portal.user.createGroup=
g;break;case "portal:user:joinGroup":this.privilegeObj.portal.user.joinGroup=g;break;case "portal:user:joinNonOrgGroup":this.privilegeObj.portal.user.joinNonOrgGroup=g;break;case "portal:user:createItem":this.privilegeObj.portal.user.createItem=g;break;case "portal:user:shareToGroup":this.privilegeObj.portal.user.shareToGroup=g;break;case "portal:user:shareToOrg":this.privilegeObj.portal.user.shareToOrg=g;break;case "portal:user:shareToPublic":this.privilegeObj.portal.user.shareToPublic=g;break;case "portal:user:shareGroupToOrg":this.privilegeObj.portal.user.shareGroupToOrg=
g;break;case "portal:user:shareGroupToPublic":this.privilegeObj.portal.user.shareGroupToPublic=g;break;case "features:user:edit":this.privilegeObj.features.user.edit=g;break;case "features:user:fullEdit":this.privilegeObj.features.user.fullEdit=g;break;case "opendata:user:openDataAdmin":this.privilegeObj.opendata.user.openDataAdmin=g;break;case "opendata:user:designateGroup":this.privilegeObj.opendata.user.designateGroup=g;break;case "premium:user:geocode":this.privilegeObj.premium.user.geocode=g;
break;case "premium:user:networkanalysis":this.privilegeObj.premium.user.networkanalysis=g;break;case "premium:user:spatialanalysis":this.privilegeObj.premium.user.spatialanalysis=g;break;case "premium:user:geoenrichment":this.privilegeObj.premium.user.geoenrichment=g;break;case "premium:user:demographics":this.privilegeObj.premium.user.demographics=g;break;case "premium:user:elevation":this.privilegeObj.premium.user.elevation=g;break;case "marketplace:admin:purchase":this.privilegeObj.marketplace.admin.purchase=
g;break;case "marketplace:admin:manage":this.privilegeObj.marketplace.admin.manage=g;break;case "marketplace:admin:startTrial":this.privilegeObj.marketplace.admin.startTrial=g}},_applyToAll:function(g){this.privilegeObj.portal.admin.inviteUsers=g;this.privilegeObj.portal.admin.disableUsers=g;this.privilegeObj.portal.admin.viewUsers=g;this.privilegeObj.portal.admin.updateUsers=g;this.privilegeObj.portal.admin.deleteUsers=g;this.privilegeObj.portal.admin.changeUserRoles=g;this.privilegeObj.portal.admin.viewGroups=
g;this.privilegeObj.portal.admin.updateGroups=g;this.privilegeObj.portal.admin.deleteGroups=g;this.privilegeObj.portal.admin.reassignGroups=g;this.privilegeObj.portal.admin.assignToGroups=g;this.privilegeObj.portal.admin.manageEnterpriseGroups=g;this.privilegeObj.portal.admin.viewItems=g;this.privilegeObj.portal.admin.updateItems=g;this.privilegeObj.portal.admin.deleteItems=g;this.privilegeObj.portal.admin.reassignItems=g;this.privilegeObj.portal.admin.manageLicenses=g;this.privilegeObj.portal.publisher.publishFeatures=
g;this.privilegeObj.portal.publisher.publishTiles=g;this.privilegeObj.portal.publisher.publishScenes=g;this.privilegeObj.portal.user.createGroup=g;this.privilegeObj.portal.user.joinGroup=g;this.privilegeObj.portal.user.joinNonOrgGroup=g;this.privilegeObj.portal.user.createItem=g;this.privilegeObj.portal.user.shareToGroup=g;this.privilegeObj.portal.user.shareToOrg=g;this.privilegeObj.portal.user.shareToPublic=g;this.privilegeObj.portal.user.shareGroupToOrg=g;this.privilegeObj.portal.user.shareGroupToPublic=
g;this.privilegeObj.features.user.edit=g;this.privilegeObj.opendata.user.openDataAdmin=g;this.privilegeObj.opendata.user.designateGroup=g;this.privilegeObj.premium.user.geocode=g;this.privilegeObj.premium.user.networkanalysis=g;this.privilegeObj.premium.user.spatialanalysis=g;this.privilegeObj.premium.user.geoenrichment=g;this.privilegeObj.premium.user.demographics=g;this.privilegeObj.premium.user.elevation=g;this.privilegeObj.marketplace.admin.purchase=g;this.privilegeObj.marketplace.admin.manage=
g;this.privilegeObj.marketplace.admin.startTrial=g},_buildPrivilegesArray:function(){var g=[];!0===this.privilegeObj.portal.admin.inviteUsers&&g.push("portal:admin:inviteUsers");!0===this.privilegeObj.portal.admin.disableUsers&&g.push("portal:admin:disableUsers");!0===this.privilegeObj.portal.admin.viewUsers&&g.push("portal:admin:viewUsers");!0===this.privilegeObj.portal.admin.updateUsers&&g.push("portal:admin:updateUsers");!0===this.privilegeObj.portal.admin.deleteUsers&&g.push("portal:admin:deleteUsers");
!0===this.privilegeObj.portal.admin.changeUserRoles&&g.push("portal:admin:changeUserRoles");!0===this.privilegeObj.portal.admin.viewGroups&&g.push("portal:admin:viewGroups");!0===this.privilegeObj.portal.admin.updateGroups&&g.push("portal:admin:updateGroups");!0===this.privilegeObj.portal.admin.deleteGroups&&g.push("portal:admin:deleteGroups");!0===this.privilegeObj.portal.admin.reassignGroups&&g.push("portal:admin:reassignGroups");!0===this.privilegeObj.portal.admin.assignToGroups&&g.push("portal:admin:assignToGroups");
!0===this.privilegeObj.portal.admin.manageEnterpriseGroups&&g.push("portal:admin:manageEnterpriseGroups");!0===this.privilegeObj.portal.admin.viewItems&&g.push("portal:admin:viewItems");!0===this.privilegeObj.portal.admin.updateItems&&g.push("portal:admin:updateItems");!0===this.privilegeObj.portal.admin.deleteItems&&g.push("portal:admin:deleteItems");!0===this.privilegeObj.portal.admin.reassignItems&&g.push("portal:admin:reassignItems");!0===this.privilegeObj.portal.admin.manageLicenses&&g.push("portal:admin:manageLicenses");
!0===this.privilegeObj.portal.publisher.publishFeatures&&g.push("portal:publisher:publishFeatures");!0===this.privilegeObj.portal.publisher.publishTiles&&g.push("portal:publisher:publishTiles");!0===this.privilegeObj.portal.publisher.publishScenes&&g.push("portal:publisher:publishScenes");!0===this.privilegeObj.portal.user.createGroup&&g.push("portal:user:createGroup");!0===this.privilegeObj.portal.user.joinGroup&&g.push("portal:user:joinGroup");!0===this.privilegeObj.portal.user.joinNonOrgGroup&&
g.push("portal:user:joinNonOrgGroup");!0===this.privilegeObj.portal.user.createItem&&g.push("portal:user:createItem");!0===this.privilegeObj.portal.user.shareToGroup&&g.push("portal:user:shareToGroup");!0===this.privilegeObj.portal.user.shareToOrg&&g.push("portal:user:shareToOrg");!0===this.privilegeObj.portal.user.shareToPublic&&g.push("portal:user:shareToPublic");!0===this.privilegeObj.portal.user.shareGroupToOrg&&g.push("portal:user:shareGroupToOrg");!0===this.privilegeObj.portal.user.shareGroupToPublic&&
g.push("portal:user:shareGroupToPublic");!0===this.privilegeObj.features.user.edit&&g.push("features:user:edit");!0===this.privilegeObj.features.user.fullEdit&&g.push("features:user:fullEdit");!0===this.privilegeObj.opendata.user.openDataAdmin&&g.push("opendata:user:openDataAdmin");!0===this.privilegeObj.opendata.user.designateGroup&&g.push("opendata:user:designateGroup");!0===this.privilegeObj.premium.user.geocode&&g.push("premium:user:geocode");!0===this.privilegeObj.premium.user.networkanalysis&&
g.push("premium:user:networkanalysis");!0===this.privilegeObj.premium.user.spatialanalysis&&g.push("premium:user:spatialanalysis");!0===this.privilegeObj.premium.user.geoenrichment&&g.push("premium:user:geoenrichment");!0===this.privilegeObj.premium.user.demographics&&g.push("premium:user:demographics");!0===this.privilegeObj.premium.user.elevation&&g.push("premium:user:elevation");!0===this.privilegeObj.marketplace.admin.purchase&&g.push("marketplace:admin:purchase");!0===this.privilegeObj.marketplace.admin.manage&&
g.push("marketplace:admin:manage");!0===this.privilegeObj.marketplace.admin.startTrial&&g.push("marketplace:admin:startTrial");return g},isUser:function(){return n.isDefined(this.id)&&("org_user"===this.id||"account_user"===this.id)},isPublisher:function(){return n.isDefined(this.id)&&("org_publisher"===this.id||"account_publisher"===this.id)},isAdmin:function(){return n.isDefined(this.id)&&("org_admin"===this.id||"account_admin"===this.id)},isBasedOnUser:function(){return this.isUser()||n.isDefined(this.baseRole)&&
("org_user"===this.baseRole||"account_user"===this.baseRole)},isBasedOnPublisher:function(){return this.isPublisher()||n.isDefined(this.baseRole)&&("org_publisher"===this.baseRole||"account_publisher"===this.baseRole)},isBasedOnAdmin:function(){return this.isAdmin()||n.isDefined(this.baseRole)&&("org_admin"===this.baseRole||"account_admin"===this.baseRole)},isCustom:function(){return!this.isUser()&&!this.isPublisher()&&!this.isAdmin()&&n.isDefined(this.id)&&0<this.id.length},canInviteUsers:function(){return this.privilegeObj&&
this.privilegeObj.portal.admin.inviteUsers},canDisableUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.disableUsers},canViewUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewUsers},canUpdateUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateUsers},canDeleteUsers:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteUsers},canChangeUserRoles:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.changeUserRoles},
canViewOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewGroups},canUpdateOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateGroups},canDeleteOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteGroups},canReassignOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignGroups},canAssignUsersToOrgGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.assignToGroups},
canManageEnterpriseGroups:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageEnterpriseGroups},canViewOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.viewItems},canUpdateOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.updateItems},canDeleteOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.deleteItems},canReassignOrgItems:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.reassignItems},
canManageLicenses:function(){return this.privilegeObj&&this.privilegeObj.portal.admin.manageLicenses},canCreateGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createGroup},canJoinOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinGroup},canJoinNonOrgGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.joinNonOrgGroup},canPublishFeatures:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishFeatures},
canPublishTiles:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishTiles},canPublishScenes:function(){return this.privilegeObj&&this.privilegeObj.portal.publisher.publishScenes},canCreateItem:function(){return this.privilegeObj&&this.privilegeObj.portal.user.createItem},canShareItemToGroup:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToGroup},canShareItemToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareToOrg},canShareItemToPublic:function(){return this.privilegeObj&&
this.privilegeObj.portal.user.shareToPublic},canShareGroupToOrg:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToOrg},canShareGroupToPublic:function(){return this.privilegeObj&&this.privilegeObj.portal.user.shareGroupToPublic},canEditFeatures:function(){return this.privilegeObj&&this.privilegeObj.features.user.edit},canEditFeaturesFullControl:function(){return this.privilegeObj&&this.privilegeObj.features.user.fullEdit},canManageOpenData:function(){return this.privilegeObj&&
this.privilegeObj.opendata.user.openDataAdmin},canDesignateOpenDataGroups:function(){return this.privilegeObj&&this.privilegeObj.opendata.user.designateGroup},canUseGeocode:function(){return this.privilegeObj&&this.privilegeObj.premium.user.geocode},canUseNetworkAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.networkanalysis},canUseSpatialAnalysis:function(){return this.privilegeObj&&this.privilegeObj.premium.user.spatialanalysis},canUseGeoenrichment:function(){return this.privilegeObj&&
this.privilegeObj.premium.user.geoenrichment},canUseDemographics:function(){return this.privilegeObj&&this.privilegeObj.premium.user.demographics},canUseElevation:function(){return this.privilegeObj&&this.privilegeObj.premium.user.elevation},canPurchaseMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.purchase},canManageMarketplace:function(){return this.privilegeObj&&this.privilegeObj.marketplace.admin.manage},canTrialMarketplace:function(){return this.privilegeObj&&
this.privilegeObj.marketplace.admin.startTrial},setPrivileges:function(g){this.privileges=g;this._initPrivilegesObject();n.isDefined(g)&&this._readPrivileges(g)},stringify:function(){return v.stringify({id:this.id,name:this.name,description:this.description,privileges:this._buildPrivilegesArray()})},stringifyRole:function(){return v.stringify({id:this.id,name:this.name,description:this.description})},stringifyPrivileges:function(){return v.stringify({privileges:this._buildPrivilegesArray()})},stringifyPretty:function(){return v.stringify({id:this.id,
name:this.name,description:this.description,privileges:this._buildPrivilegesArray()},null,"  ")}})})},"jimu/tokenUtils":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils esri/layers/vectorTiles/kernel".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){"function"!==typeof n.getAll&&(n.getAll=
function(a){var b=[];(a=n(a))&&b.push(a);return b});c={portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){return q.isInConfigOrPreviewWindow()},isStringStartWith:function(a,b){return a.substr(0,b.length)===b},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=w.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(b){var c=
new v,g=w.getStandardPortalUrl(b);b=g+"/sharing";var m=w.setHttpsProtocol(g+"/sharing/generateToken?f\x3djson"),q=w.setHttpsProtocol(b);k.get(m,{jsonp:"callback"}).then(p.hitch(this,function(b){b.token?(this.webTierPortalUrls.push(g),this.removeWabAuthCookie(),f.id.getCredential(q).then(p.hitch(this,function(f){function q(a){var b=a.creationTime||(new Date).getTime(),c=a.expires;0<b&&0<c&&c>b&&setTimeout(function(){k.get(m,{jsonp:"callback"}).then(function(b){b.token&&(a.token=b.token,a.expires=b.expires,
a.creationTime=(new Date).getTime(),a.refreshServerTokens(),q(a))},function(a){console.error(a)})},.8*(c-b))}f.token||(f.token=b.token);f.expires||(f.expires=b.expires);var n=a.canUseXhr(f.server,!0);-1<n&&e.defaults.io.corsEnabledServers.splice(n,1);this._pushCorsEnabledServerInfo({host:w.getServerByUrl(g),withCredentials:!0});c.resolve(!0);q(f)}),p.hitch(this,function(){c.resolve(!0)}))):c.resolve(!1)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},addAuthorizedCrossOriginDomains:function(a){if(a&&
0<a.length)for(var b=0;b<a.length;b++)this.addWithCredentialDomain(a[b])},addWithCredentialDomain:function(b){if(b&&"string"===typeof b){var c=e.defaults.io.corsEnabledServers,f=w.getServerByUrl(b);(b=w.getServerWithProtocol(b))||(b="http://"+f);b=a.canUseXhr(b,!0);-1<b&&c.splice(b,1);this._pushCorsEnabledServerInfo({host:f,withCredentials:!0})}},_pushCorsEnabledServerInfo:function(a){if(a){var b=e.defaults.io.corsEnabledServers,c="charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");
if("object"===typeof a&&"string"===typeof a.host){for(var f in a.host)a[f]="function"===typeof a.host[f]?function(){return a.host[f].apply(a.host,arguments)}:a.host[f];a.length=a.host.length;g.forEach(c,function(b){"function"===typeof a.host[b]&&(a[b]=function(){return a.host[b].apply(a.host,arguments)})})}b.push(a)}},tryRegisterCredential:function(a){return this.isValidCredential(a)?g.some(f.id.credentials,p.hitch(this,function(b){return a.token===b.token}))?!1:(f.id.credentials.push(a),!0):!1},
registerToken:function(a){var b=w.getSharingUrl(this.portalUrl);f.id.findCredential(b)&&g.some(f.id.credentials,p.hitch(this,function(a,b){if(this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a))return f.id.credentials.splice(b,1),!0}));return this._getTokenInfo(a).then(function(a){a&&f.id.registerToken(a)})},_getTokenInfo:function(a){var b=w.getPortalSelfInfoUrl(this.portalUrl);return k.get(b+("?f\x3djson\x26token\x3d"+a),{jsonp:"callback"}).then(p.hitch(this,function(b){return b.user?{server:w.getSharingUrl(this.portalUrl),
ssl:b.allSSL,token:a,userId:b.user.username}:null}),function(a){console.error(a);throw Error(window.jimuNls.urlParams.validateTokenError);})},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&p.trim(a)},signInPortal:function(a){var b=new v;if(this._isInvalidPortalUrl(a)){a=w.getStandardPortalUrl(a);var c=w.getSharingUrl(a),e=this.getPortalCredential(a);e?setTimeout(p.hitch(this,function(){b.resolve(e)}),0):b=f.id.getCredential(c)}else setTimeout(p.hitch(this,function(){b.reject("Invalid portalurl.")}),
0);return b},_loadPortalSelfInfo:function(a){a=w.getPortalSelfInfoUrl(a);return b({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(a,b){if(!a||"string"!==typeof a||!b||"string"!==typeof b)return null;var c=f.id.findOAuthInfo(a);c||(c=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",c=new x({appId:b,expiration:20159,portalUrl:a,authNamespace:"/",popup:!0,popupCallbackUrl:c}),f.id.registerOAuthInfos([c]));
c.appId=b;return c},signOutAll:function(){var a=w.getStandardPortalUrl(this.portalUrl),b=!!f.id.findCredential(a+"/sharing/rest");window.appInfo.isRunInPortal?this.removeEsriAuthCookieStorage():this.removeWabAuthCookie();f.id.destroyCredentials();f.id._oAuthHash=null;b&&this._publishCurrentPortalUserSignOut(a)},userHaveSignInPortal:function(a){return!!this.getPortalCredential(p.trim(a||""))},isValidCredential:function(a){var b=!1;if(a){var b=a.token,c=a.server,e=a.scope,b=b&&"string"===typeof b&&
p.trim(b),c=c&&"string"===typeof c&&p.trim(c),e="portal"===e||"server"===e,f=!0;a.expires&&(a=parseInt(a.expires,10),f=(new Date).getTime(),f=a>f);b=b&&c&&e&&f}return b},isValidPortalCredentialOfPortalUrl:function(a,b){var c=!1;this.isValidCredential(b)&&(c="portal"===b.scope,a=w.isSameServer(a,b.server),c=c&&a);return c},getPortalCredential:function(a){var b=null;a=p.trim(a||"");if(!a)return null;a=w.getStandardPortalUrl(a);(b=this._filterPortalCredential(a,f.id.credentials))||this._tryConvertArcGIScomCrendentialToOrgCredential();
return b},_tryConvertArcGIScomCrendentialToOrgCredential:function(){var a=this.portalUrl;if(a&&(a=w.getStandardPortalUrl(a),w.isOrgOnline(a)&&!this._filterPortalCredential(a,f.id.credentials))){var b=this._filterPortalCredential("http://www.arcgis.com",f.id.credentials);b&&f.id.registerToken({token:b.token,scope:"portal",userId:b.userId,server:a+"/sharing/rest",expires:b.expires})}},saveAndRegisterCookieToCredential:function(a){a=p.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=
!!a.isAdmin;this.saveWabCookie(a);var b=a.server+"/sharing/rest";a.server=b;f.id.registerToken(a);return f.id.findCredential(b,a.userId)},registerAuth2Hash:function(a){a=p.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,c=w.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:c,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");
n("wab_auth",m.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,b){var c=null;a=w.getStandardPortalUrl(a);b&&0<b.length&&(b=g.filter(b,p.hitch(this,function(b){return this.isValidPortalCredentialOfPortalUrl(a,
b)})),0<b.length&&(c=b[b.length-1]));return c},_removePortalCredential:function(a){var b=p.trim(a||"");if(b){b=w.getStandardPortalUrl(b);for(a=g.filter(f.id.credentials,p.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);f.id.credentials=g.filter(f.id.credentials,p.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,a)}))}},getUserIdByToken:function(a,c){var e=new v;if(a&&"string"===typeof a&&c&&"string"===typeof c){var k=
w.getStandardPortalUrl(c);c=g.filter(f.id.credentials,p.hitch(this,function(b){var c=b.token===a&&b.userId;b=w.isSameServer(k,b.server);return c&&b}));if(0<c.length){var m=c[0];setTimeout(p.hitch(this,function(){e.resolve(m.userId)}),0);return e}c=w.getCommunitySelfUrl(k);b({url:c,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){e.resolve(a&&a.username||"")}),p.hitch(this,function(a){console.error(a);e.reject("fail to get userId by token")}))}else setTimeout(p.hitch(this,
function(){e.reject("invalid parameters")}),0);return e},xtGetCredentialFromCookie:function(a){var b=n("wab_auth"),c=null;if(b)try{c=m.parse(b)}catch(G){console.error(G)}if(!c||"object"!==typeof c||!w.isSameServer(a,c.server)||window.location.host!==c.referer)return null;c.expires=parseInt(c.expires,10);b=(new Date).getTime();if(!(c.expires>b))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";c.server=a;(b=f.id.findCredential(a))||f.id.registerToken(c);return b=f.id.findCredential(a)},
removeCookie:function(a){var b=this.getCookiePath();q.removeCookie(a,b)},_getDomainsByServerName:function(a){var b=a.split("."),c=b.length;return g.map(b,p.hitch(this,function(a,e){a=b.slice(e,c);var f="",k=a.length-1;g.forEach(a,p.hitch(this,function(a,b){f+=a;b!==k&&(f+=".")}));return f}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{u.publish("userSignIn",a)}catch(E){console.error(E)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{u.publish("anyUserSignIn",
a)}catch(E){console.error(E)}},_publishCurrentPortalUserSignOut:function(a){try{u.publish("userSignOut",a)}catch(E){console.error(E)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a)}catch(E){console.error(E)}},_bindEvents:function(){t.after(f.id,"signIn",p.hitch(this,function(a,b){console.log(b[1]);t.after(a,"callback",p.hitch(this,function(a,b){this._signInSuccess(b[0],!1)}));return a}))},
isStart:function(){return this._started},startup:function(){if(!this._started){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a){var b=a.esri&&a.esri.id;b._wab="builder";if(b){f.id=b;var c=window.esriConfig.defaults.io,a=a.esriConfig.defaults.io;c.corsEnabledServers=a.corsEnabledServers;c.webTierAuthServers=a.webTierAuthServers;c._processedCorsServers=a._processedCorsServers;c.corsStatus=a.corsStatus;Object.defineProperty(C,"id",{get:function(){return b},enumerable:!0,configurable:!0})}}}this._bindEvents();
this._started=!0}}};c.startup();return c})},"esri/layers/vectorTiles/kernel":function(){define(["require","exports","esri/kernel","./identity/IdentityManager"],function(p,g,t,v){return function(){function g(){}Object.defineProperty(g,"id",{get:function(){return t.id?v:null},enumerable:!0,configurable:!0});g.workerMessages={};return g}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(p,g,t){Object.defineProperty(g,"__esModule",
{value:!0});g.findCredential=function(g){return t.findCredential(g)}})},"jimu/ServiceDefinitionManager":function(){define(["dojo/_base/declare","esri/request"],function(p,g){var t=null,v=p(null,{cache:{},getServiceDefinition:function(n,m){m||(m="json");var p=this.cache[n];0>=this._getDefStatus(p)&&(p=g({url:n,handleAs:m,content:{f:m},callbackParamName:"callback"}),this.cache[n]=p);return p},_getDefStatus:function(g){return g?g.isFulfilled()?g.isResolved()?2:-1:1:0}});v.getInstance=function(){t||(t=
new v,window._serviceDefinitionManager=t);return t};return v})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(p,g,t,v,n,m){return p(m,{baseClass:"jimu-popup jimu-message",declaredClass:"jimu.dijit.Message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,customZIndex:null,postMixInProperties:function(){this.content=this.message;window.currentMsgPopup=this},_createTitleNode:function(){this.titleLabel&&
(this.titleNode=t.create("div",{"class":"title"},this.domNode),this.titleLabeNode=t.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=t.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing",role:"button",tabindex:0},this.titleNode),this.own(n(this.closeBtnNode,"click",g.hitch(this,this.close))),this.own(n(this.closeBtnNode,"keydown",g.hitch(this,function(g){g.keyCode===v.ENTER&&(this.close(),this.focusLastActiveNode())}))))},
_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:window.jimuNls.common.ok,key:v.ENTER,onClick:g.hitch(this,this.close)})},_increaseZIndex:function(){t.setStyle(this.domNode,"zIndex",501);t.setStyle(this.overlayNode,"zIndex",500)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/keys dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w=0;return p([c,t],{declaredClass:"jimu.dijit.Popup",baseClass:"jimu-popup",titleLabel:"",content:null,container:null,customZIndex:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,isResize:!0,horizontalWidthRate:0,maxHeight:800,maxWidth:1024,enableMoveable:!0,hasTitle:!0,contentHasNoMargin:!1,hasOverlay:!0,moveToCenter:!0,customPosition:null,hiddenAfterInit:!1,useFocusLogic:!0,constructor:function(){this.buttons=
[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},focusLastActiveNode:function(){this.focusedNodeBeforeOpen&&this.useFocusLogic&&this.focusedNodeBeforeOpen.focus()},postCreate:function(){this.focusedNodeBeforeOpen=document.activeElement;this._preProcessing();this.inherited(arguments);this._initDomNode();this._addStylesByHeightType();this._calcAndSetPosition();n.place(this.domNode,this.container);setTimeout(g.hitch(this,function(){this._calcAndSetPosition(!0,
!1);this.initFocusNodes()}),50);this.isResize&&this.own(u(window,"resize",g.hitch(this,function(){this._calcAndSetPosition(!0,!0)})));this.hasOverlay&&(this.overlayNode=n.create("div",{"class":"jimu-overlay"},this.container));this.customZIndex||0===this.customZIndex?(n.setStyle(this.domNode,"zIndex",this.customZIndex+1),this.overlayNode&&n.setStyle(this.overlayNode,"zIndex",this.customZIndex)):this._increaseZIndex();this.hiddenAfterInit&&this.hide();m.animateProperty({node:this.domNode,properties:{opacity:1},
duration:200}).play();n.setAttr(this.domNode,"role","application");n.setAttr(this.domNode,"aria-label",window.jimuNls.common.popup);this.own(u(this.domNode,"keydown",g.hitch(this,function(a){a.keyCode===k.ESCAPE&&(this.closeBtnNode?this.closeBtnNode.focus():(this.close(),this.focusLastActiveNode()));x.preventMapNavigation(a)})))},initFocusNodes:function(){if(this.useFocusLogic){if("string"===typeof this.content){var a="uniqMsgId_"+x.getUUID();n.setAttr(this.contentContainerNode,"id",a);n.setAttr(this.domNode,
"tabindex","0");n.setAttr(this.domNode,"aria-labelledby",a)}this.firstFocusNode=this._getFirstFocusNode();this.lastFocusNode=this._getLastFocusNode();this.firstFocusNode&&(this.own(u(this.firstFocusNode,"keydown",g.hitch(this,function(a){a.shiftKey&&a.keyCode===k.TAB&&(a.preventDefault(),this.firstFocusNode.focus())}))),this.firstFocusNode.focus());this.lastFocusNode&&this.own(u(this.lastFocusNode,"keydown",g.hitch(this,function(a){a.shiftKey||a.keyCode!==k.TAB||(a.preventDefault(),this.firstFocusNode.focus())})))}},
_getFirstFocusNode:function(){var a=this.closeBtnNode;"string"===typeof this.content&&(a=this.domNode);if(!a){var b;this.content.domNode?b=x.getFocusNodesInDom(this.content.domNode):1===this.content.nodeType&&(b=x.getFocusNodesInDom(this.content));0<b.length?a=b[0]:this.buttons.length&&(a=this._getFirstBtn())}return a},_getLastFocusNode:function(){var a=this._getLastBtn();if(!a)if(this.content&&"string"!==typeof this.content){var b;this.content.domNode?b=x.getFocusNodesInDom(this.content.domNode):
1===this.content.nodeType&&(b=x.getFocusNodesInDom(this.content));a=0<b.length?b[b.length-1]:this.closeBtnNode}else a=this.closeBtnNode;return a},_getFirstBtn:function(){for(var a=null,c=b(".jimu-btn",this.buttonContainer),e=0;e<=c.length-1;e++)if("none"!==n.getStyle(c[e],"display")){a=c[e];break}return a},_getLastBtn:function(){for(var a=null,c=b(".jimu-btn",this.buttonContainer),e=c.length-1;0<=e;e--)if("none"!==n.getStyle(c[e],"display")){a=c[e];break}return a},_preProcessing:function(){"number"!==
typeof this.width&&(this.width=this.maxWidth);"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=n.create("div",{"class":"title"},this.domNode);this.titleLabeNode=n.create("span",{"class":"title-label jimu-float-leading",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=n.create("div",{"class":"close-btn jimu-icon jimu-icon-close jimu-float-trailing",tabindex:0,role:"button"},
this.titleNode);var a=null,a="ontouchstart"in document?e.press:"click";this.own(u(this.closeBtnNode,a,g.hitch(this,this.close)));this.own(u(this.closeBtnNode,"keydown",g.hitch(this,function(a){a.keyCode!==k.ENTER&&a.keyCode!==k.SPACE||this.close()})))},_initDomNode:function(){this.hasTitle&&this._createTitleNode();this.contentContainerNode=n.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?
(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&n.place(this.content,this.contentContainerNode));this.buttonContainer=n.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&n.setStyle(this.buttonContainer,"display","none");for(var a=0;a<=this.buttons.length-1;a++)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=this.enabledButtons.length;if(0!==
a){var b=n.getContentBox(this.buttonContainer),c=n.getMarginExtents(this.enabledButtons[0]),e=n.getPadBorderExtents(this.enabledButtons[0]),k=0,e=8===f("ie")?e.l+e.r:0,k=(b.w-(c.l+c.r+e)*a)/a;0<k&&(v.forEach(this.enabledButtons,g.hitch(this,function(a){n.setStyle(a,"maxWidth",k+"px")})),v.forEach(this.disabledButtons,g.hitch(this,function(a){n.setStyle(a,"maxWidth",k+"px")})))}},_moveableNode:function(b,c){this.moveable&&(this.moveable.destroy(),this.moveable=null);var e=n.getMarginBox(this.container);
e.l=e.l-b+c;e.w+=2*(b-c);this.moveable=new a.boxConstrainedMoveable(this.domNode,{box:e,handle:this.titleNode||this.contentContainerNode,within:!0});this.own(u(this.moveable,"Moving",g.hitch(this,this.onMoving)));this.own(u(this.moveable,"MoveStop",g.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===b("#header").length?{t:0,l:0,w:0,h:0}:n.getMarginBox("header")},_getFooterBox:function(){return 0===b(".footer",this.container).length?{t:0,l:0,w:0,h:0}:n.getMarginBox(b(".footer",this.container)[0])},
_calcAndSetPosition:function(a,b){var c=n.getMarginBox(this.domNode);if("string"!==typeof this.container||n.byId(this.container)){var e=n.getContentBox(this.container),f=this._getHeaderBox(),g=this._getFooterBox(),g=e.h-f.h-g.h-40,k=0,m=0;this.customPosition&&this.customPosition.height?(this.height=this.customPosition.height,m="number"===typeof this.height?this.height+"px":this.height):(this.height=this._fixedHeight?this.height>g?g:this.height:this.autoHeight?(c.h>g?g:c.h)||g-200:g>this.maxHeight?
this.maxHeight:g,m=this.height+"px");this.customPosition&&this.customPosition.width?(this.width=this.customPosition.width,k="number"===typeof this.width?this.width+"px":this.width):("number"===typeof this.horizontalWidthRate&&0<this.horizontalWidthRate?(k=n.getMarginBox(window.document.body).w*this.horizontalWidthRate,this.width=k=k>this.maxWidth?k:this.maxWidth):this.width=this.width||this.maxWidth,k=this.width+"px");var q=c=0;this.customPosition?(c="number"===typeof this.customPosition.left?this.customPosition.left+
"px":this.customPosition.left,q="number"===typeof this.customPosition.top?this.customPosition.top+"px":this.customPosition.top):this.moveToCenter&&(q=(g-this.height)/2+f.h+20,q=q<f.h?f.h:q,c=(e.w-this.width)/2+"px",q+="px");n.setStyle(this.domNode,{width:k,height:this.autoHeight?"auto":m,left:c,top:q});this.enableMoveable&&this._moveableNode(this.width,100);!this.moveToCenter&&a&&"block"===n.getStyle(this.domNode,"display")&&this.emit("popupHasInitedSuccessfully",b)}},setDomNodeStyls:function(a){n.setStyle(this.domNode,
a)},setCustomPosition:function(a,b,c,e){this.width=c||this.width||this.maxWidth;this.height=e||this.height||this.maxHeight;c="number"===typeof this.width?this.width+"px":this.width;e="number"===typeof this.height?this.height+"px":this.height;n.setStyle(this.domNode,{left:"number"===typeof a?a+"px":a,top:"number"===typeof b?b+"px":b,width:c,height:this.autoHeight?"auto":e})},_addStylesByHeightType:function(){this.autoHeight?(n.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&
n.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(n.addClass(this.contentContainerNode,"content-absolute"),this.hasTitle||n.addClass(this.contentContainerNode,"no-popup-title-content-absolute"),n.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&n.setStyle(this.contentContainerNode,{bottom:"15px"}));this.contentHasNoMargin&&n.addClass(this.contentContainerNode,"content-fill-Popup")},_increaseZIndex:function(){n.setStyle(this.domNode,"zIndex",w+200+1);
this.overlayNode&&n.setStyle(this.overlayNode,"zIndex",w+200);w++},setTitleLabel:function(a){this.titleNode.innerHTML=x.stripHTML(a)},onMoving:function(a){n.setStyle(a.node,"opacity",.9)},onMoveStop:function(a){n.setStyle(a.node,"opacity",1)},show:function(){this.overlayNode&&n.setStyle(this.overlayNode,"display","block");n.setStyle(this.domNode,"display","block")},hide:function(){this.overlayNode&&n.setStyle(this.overlayNode,"display","none");n.setStyle(this.domNode,"display","none")},close:function(){if(!this.onClose||
!1!==this.onClose()){var a=this.domNode.parentNode,b=g.clone(this.domNode);n.setStyle(this.domNode,"display","none");this.overlayNode&&n.destroy(this.overlayNode);this.destroy();this.moveable&&this.moveable.destroy();n.place(b,a);m.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){n.destroy(b)}}).play();this.focusLastActiveNode();window.currentMsgPopup=null}},addButton:function(a){this._createButton(a)},_createButton:function(a){var b=" ";a.classNames&&0<a.classNames.length&&
"function"===typeof a.classNames.join&&(b+=a.classNames.join(" "));var c=n.create("div",{"class":"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 "+b,innerHTML:a.label,tabindex:0,role:"button",title:a.title||a.label},this.buttonContainer);this.enabledButtons.push(c);b=n.create("div",{"class":"jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 "+b,title:a.title||a.label,innerHTML:a.label,tabindex:0,role:"button","aria-disabled":"true",style:{display:"none"}},
this.buttonContainer);this.disabledButtons.push(b);this.own(u(c,"click",g.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})));this.own(u(c,"keydown",g.hitch(this,function(b){if(b.keyCode===k.ENTER||b.keyCode===k.SPACE)if(a.onClick)a.onClick(b);else this.close()})))},setButtonProps:function(a,b){"number"===typeof a&&isFinite(a)||(b=a,a=0);if(b&&0!==this.enabledButtons.length)for(var c in b)"title"===c?(n.setAttr(this.enabledButtons[a],"title",b[c]),n.setAttr(this.disabledButtons[a],
"title",b[c])):"label"===c&&(n.setProp(this.enabledButtons[a],"innerHTML",b[c]),n.setProp(this.disabledButtons[a],"innerHTML",b[c]))},enableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.enabledButtons.length?(n.setStyle(this.enabledButtons[a],"display","inline-block"),n.setStyle(this.disabledButtons[a],"display","none")):(v.forEach(this.enabledButtons[a],g.hitch(this,function(a){n.setStyle(a,"display","inline-block")})),v.forEach(this.disabledButtons[a],g.hitch(this,function(a){n.setStyle(a,
"display","none")})))},disableButton:function(a){"number"===typeof a&&isFinite(a)&&a<this.disabledButtons.length?(n.setStyle(this.disabledButtons[a],"display","inline-block"),n.setStyle(this.enabledButtons[a],"display","none")):(v.forEach(this.disabledButtons,g.hitch(this,function(a){n.setStyle(a,"display","inline-block")})),v.forEach(this.enabledButtons,g.hitch(this,function(a){n.setStyle(a,"display","none")})))},showButton:function(a){this.enableButton(a)},hideButton:function(a){"number"===typeof a&&
isFinite(a)&&a<this.disabledButtons.length?(n.setStyle(this.disabledButtons[a],"display","none"),n.setStyle(this.enabledButtons[a],"display","none")):(v.forEach(this.disabledButtons,g.hitch(this,function(a){n.setStyle(a,"display","none")})),v.forEach(this.enabledButtons,g.hitch(this,function(a){n.setStyle(a,"display","none")})))},resize:function(a){a&&(this.width=a.w,this.height=a.h);this._calcAndSetPosition();this.content&&this.content.domNode&&this.content.resize&&this.content.resize()}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),
function(p,g,t,v,n,m){v=p("dojo.dnd.move.constrainedMoveable",m,{constraints:function(){},within:!1,constructor:function(g,k){k||(k={});this.constraints=k.constraints;this.within=k.within},onFirstMove:function(m){var k=this.constraintBox=this.constraints.call(this,m);k.r=k.l+k.w;k.b=k.t+k.h;this.within&&(m=g.getMarginSize(m.node),k.r-=m.w,k.b-=m.h)},onMove:function(g,k){var f=this.constraintBox,e=g.node.style;this.onMoving(g,k);k.l=k.l<f.l?f.l:f.r<k.l?f.r:k.l;k.t=k.t<f.t?f.t:f.b<k.t?f.b:k.t;e.left=
k.l+"px";e.top=k.t+"px";this.onMoved(g,k)}});n=p("dojo.dnd.move.boxConstrainedMoveable",v,{box:{},constructor:function(g,k){var f=k&&k.box;this.constraints=function(){return f}}});p=p("dojo.dnd.move.parentConstrainedMoveable",v,{area:"content",constructor:function(m,k){var f=k&&k.area;this.constraints=function(){var e=this.node.parentNode,b=t.getComputedStyle(e),a=g.getMarginBox(e,b);if("margin"==f)return a;var c=g.getMarginExtents(e,b);a.l+=c.l;a.t+=c.t;a.w-=c.w;a.h-=c.h;if("border"==f)return a;
c=g.getBorderExtents(e,b);a.l+=c.l;a.t+=c.t;a.w-=c.w;a.h-=c.h;if("padding"==f)return a;c=g.getPadExtents(e,b);a.l+=c.l;a.t+=c.t;a.w-=c.w;a.h-=c.h;return a}}});return{constrainedMoveable:v,boxConstrainedMoveable:n,parentConstrainedMoveable:p}})},"jimu/DataSourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Evented dojo/when ./utils jimu/LayerInfos/LayerInfos jimu/portalUtils jimu/portalUrlUtils jimu/filterUtils esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition ./Query".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){var q=null,C=p(n,{constructor:function(){this._listeners=[];this._refreshTimers=[];this._dataStore={};this._jimuQueryObject={};this._dataSourceUsage={};this._itemsFilter={};this.filterUtils=new b;window.isBuilder?(v.subscribe("app/mapLoaded",g.hitch(this,this._onMapLoaded)),v.subscribe("app/mapChanged",g.hitch(this,this._onMapChanged))):(v.subscribe("mapLoaded",g.hitch(this,this._onMapLoaded)),v.subscribe("mapChanged",g.hitch(this,this._onMapChanged)));window.isBuilder?
(v.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)),v.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged))):(v.subscribe("appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)),v.subscribe("appConfigChanged",g.hitch(this,this._onAppConfigChanged)));v.subscribe("updateDataSourceData",g.hitch(this,this._onUpdataDataSourceData));window.isBuilder&&v.subscribe("app/dataSourceDataUpdated",g.hitch(this,this._onDataSourceDataUpdatedInApp))},getData:function(a){return this._dataStore[a]},
getDataSourceConfig:function(a){return this.appConfig.dataSource.dataSources[a]},parseDataSourceId:function(a){var b=a.split("~"),c={};if(2>b.length)return console.error("Bad data source id:",a),c;switch(b[0]){case "map":return b=a.lastIndexOf("~"),c={from:"map",layerId:a.substring(4,b)};case "widget":return c={from:"widget",widgetId:b[1]};case "external":return c={from:"external"};default:console.error("Bad data source id:",a)}},addDataSourceUsage:function(a,b){this._dataSourceUsage[a]?(0>this._dataSourceUsage[a].indexOf(b)&&
this._dataSourceUsage[a].push(b),1===this._dataSourceUsage[a].length&&this._startOneDataSource(this.appConfig.dataSource.dataSources[a])):(this._dataSourceUsage[a]=[b],this._startOneDataSource(this.appConfig.dataSource.dataSources[a]))},removeDataSourceUsage:function(a,b){this._dataSourceUsage[a]&&0<=this._dataSourceUsage[a].indexOf(b)&&(this._dataSourceUsage[a]=t.filter(this._dataSourceUsage[a],function(a){return a!==b}))},_onUpdataDataSourceData:function(a,b){this.appConfig.dataSource.dataSources[a]?
"widget"!==this.parseDataSourceId(a).from?console.error("Please update data source from widget only.",a):this._updateDataSourceData(a,b):console.error("Not found data source id:",a)},_updateDataSourceData:function(a,b){this._dataStore[a]=b;v.publish("dataSourceDataUpdated",a,b);this.emit("update",a,b)},_onDataSourceDataUpdatedInApp:function(a,b){this._updateDataSourceData(a,b)},_onMapLoaded:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapLoaded")},
_onMapChanged:function(a){this.map=a;window.isBuilder||this._handleDataSourceConfigChange(this.appConfig,this.appConfig,"mapChanged")},_onAppConfigLoaded:function(a){this.appConfig=g.clone(a)},_onAppConfigChanged:function(a,b){a=g.clone(a);window.isBuilder||("dataSourceChange"===b?this._handleDataSourceConfigChange(this.appConfig,a,b):"mapChange"===b&&this._cleanForConfigChangedDataSource(this.appConfig,a));this.appConfig=a},_handleDataSourceConfigChange:function(a,b,c){a&&(this._removeListeners(),
this._removeTimers(),this._cleanForConfigChangedDataSource(a,b));t.forEach(Object.keys(b.dataSource.dataSources),function(a){b.dataSource.dataSources[a].idObj=this.parseDataSourceId(a)},this);this._listenDataSourceChange(b.dataSource.dataSources);this._startRefreshTimer(b.dataSource,c);this._initStaticDataSource(b.dataSource)},_cleanForConfigChangedDataSource:function(a,b){var c=a.dataSource.dataSources,e=b.dataSource.dataSources;t.forEach(Object.keys(c),function(a){if(!e[a]||e[a]&&!u.isEqual(e[a],
c[a]))delete this._jimuQueryObject[a],this._updateDataSourceData(a,{features:[]}),delete this._dataStore[a]},this)},_isGlobalRefresh:function(a){return a.unifiedRefreshInterval&&0<a.unifiedRefreshInterval},_startOneDataSource:function(a){var b;b=this._isGlobalRefresh(this.appConfig.dataSource.settings)?this.appConfig.dataSource.settings.unifiedRefreshInterval:a.refreshInterval;if("map"===a.idObj.from)this._listenMapDataSourceChange(a);else if("external"===a.idObj.from&&a.filterByExtent){var c={};
c.handle=this.map.on("extent-change",g.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c)}if("map"===a.idObj.from||"external"===a.idObj.from)this._refeshDataSource(a),a.isDynamic&&(c={},c.handle=setInterval(g.hitch(this,this._refeshDataSource,a),6E4*b),c.dsId=a.id,this._refreshTimers.push(c))},_stopAndCleanOneDataSource:function(a){this._listeners=t.filter(this._listeners,function(b){return b.dsId===a.id?(b.handle.remove(),!1):!0},this);this._refreshTimers=t.filter(this._refreshTimers,
function(b){return b.dsId===a.id?(clearInterval(b.handle),!1):!0},this);this._updateDataSourceData(a.id,{features:[]})},_listenDataSourceChange:function(a){t.forEach(Object.keys(a),function(b){b=a[b];if("map"===b.idObj.from)this._listenMapDataSourceChange(b);else if("external"===b.idObj.from&&b.filterByExtent){var c={};c.handle=this.map.on("extent-change",g.hitch(this,this._onLayerDataChange,b));c.dsId=b.id;this._listeners.push(c)}},this)},_listenMapDataSourceChange:function(a){this._getLayerObject(a.idObj.layerId).then(g.hitch(this,
function(b){if(b){var c={};c.handle=b.on("edits-complete",g.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c);c={};c.handle=this._getLayerInfo(a.idObj.layerId).on("filterChanged",g.hitch(this,this._onLayerDataChange,a));c.dsId=a.id;this._listeners.push(c);a.filterByExtent&&(c={},c.handle=this.map.on("extent-change",g.hitch(this,this._onLayerDataChange,a)),c.dsId=a.id,this._listeners.push(c))}else console.error("Can not find layer that data source depends on.",a.id)}))},_onLayerDataChange:function(a){this._doQueryForDataSource(a)},
_doQueryForDataSource:function(a){("config"===this.appConfig.mode||this._dataSourceUsage[a.id]&&0!==this._dataSourceUsage[a.id].length)&&this.doQuery(a).then(g.hitch(this,function(b){this._updateDataSourceData(a.id,{features:b.features})}))},_getLayerObject:function(a){return(a=k.getInstanceSync().getLayerOrTableInfoById(a))?a.getLayerObject():m(null)},_getLayerInfo:function(a){return k.getInstanceSync().getLayerOrTableInfoById(a)},_startRefreshTimer:function(a,b){var c=a.dataSources,e=a.settings;
t.forEach(Object.keys(c),function(f){f=c[f];if("widget"!==f.idObj.from&&f.isDynamic&&f.url){var k;k=this._isGlobalRefresh(e)?e.unifiedRefreshInterval:f.refreshInterval;"dataSourceChange"===b?"external"!==f.idObj.from&&"map"!==f.idObj.from||this._refeshDataSource(f):"external"===f.idObj.from&&this._refeshDataSource(f);f={handle:setInterval(g.hitch(this,this._refeshDataSource,f),6E4*k),dsId:a.id};this._refreshTimers.push(f)}},this)},_initStaticDataSource:function(a){t.forEach(Object.keys(a.dataSources),
function(b){b=a.dataSources[b];"widget"!==b.idObj.from&&!b.isDynamic&&b.url&&this._doQueryForDataSource(b)},this)},_refeshDataSource:function(a){this._doQueryForDataSource(a)},_getDataSourceFilter:function(a){if("map"===a.idObj.from){var b=k.getInstanceSync().getLayerOrTableInfoById(a.idObj.layerId),c;b&&(c=b.getFilter());var b=a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1",e;e=c?"("+c+") and ("+b+")":b;return m(e)}return"external"===a.idObj.from?a.portalUrl&&a.itemId?this._getFilterFromItem(a.portalUrl,
a.itemId,a.url).then(g.hitch(this,function(b){var c=a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1";return e=b?"("+b+") and ("+c+")":c})):m(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1"):m(a.filter?this._getFilterExpr(a.filter,a.url):"1\x3d1")},_getFilterExpr:function(a,b){return this.filterUtils.hasVirtualDate(a)?(this.filterUtils.isHosted=u.isHostedService(b),this.filterUtils.getExprByFilterObj(a)):a.expr},_getFilterFromItem:function(a,b,c){var k=e.getItemUrl(a,b);if(this._itemsFilter[k])return m(this._itemsFilter[k]);
var q=f.getPortal(a);return q.getItemById(b).then(g.hitch(this,function(a){return"Feature Service"!==a.type?this._itemsFilter[k]=null:q.getItemData(b).then(g.hitch(this,function(a){var b=c.split("/"),e=b.pop();e||(e=b.pop());if(!a.layers)return this._itemsFilter[k]=null;a=a.layers.filter(function(a){return a.id+""===e})[0];return a&&a.layerDefinition?this._itemsFilter[k]=a.layerDefinition.definitionExpression:this._itemsFilter[k]=null}))}))},doQuery:function(b){b.idObj||(b.idObj=this.parseDataSourceId(b.id));
this.emit("begin-update",b.id);return this._getQueryObjectFromDataSource(b).then(g.hitch(this,function(e){var f,k;if("Features"===b.type){if("serviceLimitation"===b.resultRecordType)return f=e,k=new c(b.url),k.execute(f);var m=this._jimuQueryObject[b.id];!m||m.url===b.url&&u.isEqual(m.query.toJson(),e.toJson())||(delete this._jimuQueryObject[b.id],m=null);m||(m={},m.url=b.url,m.query=e,"all"!==b.resultRecordType&&(m.pageSize=b.resultRecordCount),m=new w(m),this._jimuQueryObject[b.id]=m);return"all"===
b.resultRecordType?m.getAllFeatures():m.queryByPage(1)}k=new c(b.url);f=new a;return this._getDataSourceFilter(b).then(g.hitch(this,function(a){f.where=a;b.filterByExtent&&(f.geometry=this.map.extent);b.dataSchema.groupByFields&&0<b.dataSchema.groupByFields.length&&(f.groupByFieldsForStatistics=b.dataSchema.groupByFields);b.dataSchema.orderByFields&&0<b.dataSchema.orderByFields.length&&(f.orderByFields=b.dataSchema.orderByFields);f.outStatistics=b.dataSchema.statistics.map(function(a){var b=a.onStatisticField+
"_"+a.statisticType;"count"===a.statisticType&&(b="STAT_COUNT");var b=u.upperCaseString(b),c=new x;c.statisticType=a.statisticType;c.onStatisticField=a.onStatisticField;c.outStatisticFieldName=b;return c});return k.execute(f)}))}))},_getQueryObjectFromDataSource:function(b){return this._getDataSourceFilter(b).then(g.hitch(this,function(c){var e=new a;e.where=c;b.filterByExtent&&(e.geometry=this.map.extent);e.outFields=b.dataSchema.fields.map(function(a){return a.name});b.dataSchema.orderByFields&&
0<b.dataSchema.orderByFields.length&&(e.orderByFields=b.dataSchema.orderByFields);e.returnGeometry=!0;e.outSpatialReference=this.map.spatialReference;return m(e)}))},_removeListeners:function(){this._listeners.forEach(g.hitch(this,function(a){a.handle.remove()}));this._listeners=[]},_removeTimers:function(){this._refreshTimers.forEach(g.hitch(this,function(a){clearInterval(a.handle)}));this._refreshTimers=[]}});C.getInstance=function(){null===q&&(q=new C,window._datasourceManager=q);return q};return C})},
"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory".split(" "),function(p,g,t,v,n,m,u,k,f){var e=p([u],{declaredClass:"jimu.LayerInfos",map:null,_operLayers:null,_layerInfos:null,_finalLayerInfos:null,_tableInfos:null,_basemapLayerInfos:null,_finalBasemapLayerInfos:null,_basemapLayers:null,_unreachableLayersTitleOfWebmap:null,_objectId:null,_layerInfoFactory:null,constructor:function(a,
b){this._objectId=Math.random();this._unreachableLayersTitleOfWebmap=[];this._basemapLayers=b.baseMap.baseMapLayers;this._operLayers=b.operationalLayers;this._tables=b.tables;this._layerInfoFactory=new f(a,this);this.map=a;this._initLayerInfos();this._initBasemapLayerInfos();this._initTablesInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this._finalLayerInfos);this._clearAddedFlag(this._finalBasemapLayerInfos);this._initFinalLayerInfos();
this._initFinalBasemapLayerInfos();this._markFirstOrLastNode()},getLayerInfoArrayOfWebmap:function(){var a=[];g.forEach(this.getLayerInfoArray(),function(b){for(var c=0;c<this._operLayers.length;c++)if(b.id===this._operLayers[c].id){a.push(b);break}c===this._operLayers.length&&0<=this._removedLayerInfoIdsFromFeatureCollection.indexOf(b.id)&&a.push(b)},this);return a},getTableInfoArrayOfWebmap:function(){var a=[];g.forEach(this.getTableInfoArray(),function(b){for(var c=0;c<this._tables.length;c++)if(b.id===
this._tables[c].id){a.push(b);break}},this);return a},getLayerInfoArray:function(){return g.filter(this._finalLayerInfos,function(a){t.getObject("_wabProperties.isTemporaryLayer",!1,a.layerObject)&&(a._flag._isTemporaryLayerInfo=!0);return!a._flag._isTemporaryLayerInfo})},getTableInfoArray:function(){return this._tableInfos},getBasemapLayerInfoArray:function(){return this._finalBasemapLayerInfos},addFeatureCollection:function(a,b){var c=this._getUniqueTopLayerInfoId(b),e={layers:[]};g.forEach(a,function(a,
b){a.id=c+"_"+b;e.layers.push({id:a.id,layerObject:a})},this);this.map.addLayers(a);var f;try{f=this._layerInfoFactory.create({featureCollection:e,title:b||c,id:c},this.map),f.init()}catch(z){console.warn(z.message),f=null}f&&(f._extraOfWebmapLayerInfo=!0,this._layerInfos.push(f),this.update(),this._onLayersUpdated(f,f.getRootLayerInfo()))},addTable:function(a){a=this._addTables([a],this._tableInfos);return a[0]?a[0]:null},removeTable:function(a){var b=-1;g.forEach(this._tableInfos,function(c,e){a.id===
c.id&&(b=e)});if(0<=b){var c=this._tableInfos[b];this._tableInfos.splice(b,1);c.destroy();this._onTableChange([a],e.REMOVED)}},_addTables:function(a,b){var c=[],f=[];g.forEach(a,function(a){var e;try{a.layerObject={url:a.url,featureCollectionData:a.featureCollectionData,empty:!0},a.id=this._getUniqueTableId(a.id),a.selfType="table",e=this._layerInfoFactory.create(a),e.init()}catch(E){console.warn(E.message),e=null}e&&(c.push(e),b.push(e),f.push(e.getLayerObject()))},this);k(f).then(t.hitch(this,function(a){var b=
[];g.forEach(a,function(a,e){e=c[e];a?b.push(e):(this.removeTable(e),e.destroy())},this);this._onTableChange(b,e.ADDED)}));return c},_getUniqueTableId:function(a){var b=this._tableInfos.concat(this._tableInfos||[]);return this._getUniqueLayerOrTableId(a,b)},_getUniqueTopLayerInfoId:function(a){return this._getUniqueLayerOrTableId(a,this._finalLayerInfos)},_getUniqueLayerOrTableId:function(a,b){var c=1,e;a||(a="table");for(e=a;;){for(var f=0;f<b.length&&b[f].id!==e;f++);if(f===b.length)return e;e=
a+"_"+c.toString();c++}},_traversal:function(a,b){for(var c=0;c<b.length;c++)if(b[c].traversal(a))return!0;return!1},traversal:function(a){var b=this.getLayerInfoArray();return this._traversal(a,b)},traversalLayerInfosOfWebmap:function(a){var b=this.getLayerInfoArrayOfWebmap();return this._traversal(a,b)},traversalAll:function(a){var b=this.getLayerInfoArray(),c=this.getBasemapLayerInfoArray(),e=this.getTableInfoArray(),b=b.concat(c.concat(e));return this._traversal(a,b)},_traversalAllWithSpecialLayerInfo:function(a){return this._traversal(a,
this._finalLayerInfos.concat(this._tableInfos))},getLayerInfoById:function(a){return this._findLayerInfoById(a)},getTableInfoById:function(a){var b=null;g.some(this.getTableInfoArray(),function(c){if(c.id===a)return b=c,!0});return b},getLayerOrTableInfoById:function(a){var b=null;this.traversalAll(function(c){if(c.id===a)return b=c,!0});return b},getLayerInfoByTopLayerId:function(a){return this._findTopLayerInfoById(a)},moveUpLayer:function(a,b){var c=null;b=b?b:1;a=this._getTopLayerInfoIndexById(a.id);
0<=a-b&&(c=this._finalLayerInfos[a-b].obtainLayerIndexesInMap().length,this._finalLayerInfos[a].moveRightOfIndex(this._finalLayerInfos[a-b].obtainLayerIndexesInMap()[c-1].index),c=this._finalLayerInfos[a-b],m.publish("layerInfos/layerReorder",a,b,"moveup"));return c},_reorderLayerInfosArray:function(a,b,e){"moveup"===e?(e=this._finalLayerInfos[a],this._finalLayerInfos.splice(a,1),this._finalLayerInfos.splice(a-b,0,e)):(e=this._finalLayerInfos[a],this._finalLayerInfos.splice(a+b+1,0,e),this._finalLayerInfos.splice(a,
1));this._markFirstOrLastNode();return e},moveDownLayer:function(a,b){var c=null;b=b?b:1;a=this._getTopLayerInfoIndexById(a.id);a+b<=this._finalLayerInfos.length-1&&(this._finalLayerInfos[a].moveLeftOfIndex(this._finalLayerInfos[a+b].obtainLayerIndexesInMap()[0].index),c=this._finalLayerInfos[a+b],m.publish("layerInfos/layerReorder",a,b,"movedown"));return c},getBasemapLayers:function(){var a=[];g.forEach(this.map.layerIds.concat(this.map.graphicsLayerIds||[]),function(b){b=this.map.getLayer(b);"basemap"!==
b._basemapGalleryLayerType&&"reference"!==b._basemapGalleryLayerType||a.push(b)},this);return a.reverse()},getMapNotesLayerInfoArray:function(){return g.filter(this.getLayerInfoArray(),function(a){return a.isMapNotesLayerInfo()},this)},restoreState:function(a){var b=a&&a.layerOptions?a.layerOptions:null;g.forEach(this._finalLayerInfos,function(a){a.resetLayerObjectVisibility(b)},this)},setSimplificationState:function(a){var b={layerOptions:{}};this.traversal(function(c){b.layerOptions[c.id]={};if(a&&
a.showLayers){var e=null;g.some(a.showLayers,function(a){if(c.id===a)return e=c.id,!0;if(c.title.trim&&a.trim&&c.title.trim()===a.trim())return e=c.id,!1});b.layerOptions[c.id].visible=null!==e?!0:!1}});this.restoreState(b)},getSimplificationState:function(){var a={showLayers:[]};this.traversal(function(b){b.isVisible()&&a.showLayers.push(b.id)});return a},getUnreachableLayersTitle:function(){return this._unreachableLayersTitleOfWebmap},getObjectId:function(){return this._objectId},_initLayerInfos:function(){this._layerInfos=
[];this._initSpecifiedLayerInfos(this._operLayers,this._layerInfos)},_initBasemapLayerInfos:function(){this._basemapLayerInfos=[];this._initSpecifiedLayerInfos(this._basemapLayers,this._basemapLayerInfos)},_initSpecifiedLayerInfos:function(a,b){var c;g.forEach(a,function(a){try{c=this._layerInfoFactory.create(a),c.init()}catch(C){console.warn(C.message),c=null,0<=C.message.indexOf("declaredClass")&&this._unreachableLayersTitleOfWebmap.push(a.title)}c&&b.push(c)},this)},_extraSetLayerInfos:function(){this._removedLayerInfoIdsFromFeatureCollection=
[];g.forEach(this._finalLayerInfos||this._layerInfos,function(a,b){var c;if(a._needToRenew()){try{c=this._layerInfoFactory.create(a.originOperLayer),c.init()}catch(C){console.warn(C.message),c=null}c&&(a.destroy(),this._finalLayerInfos[b]=c)}else if(a.originOperLayer.featureCollection){var e=[];g.forEach(a.getSubLayers(),function(a){e.push(a.id)});g.forEach(e,function(b){this.map.getLayer(b)||a.removeSubLayerById(b)},this);1===a.getSubLayers().length&&(b=a.getSubLayers()[0],this.map.getLayer(b.id).title=
a.title,a.removeSubLayerById(b.id),this._removedLayerInfoIdsFromFeatureCollection.push(b.id),a.id+="_logically_removed")}},this)},_refineFinalLayerInfos:function(){this._finalLayerInfos&&(this._finalLayerInfos=g.filter(this._finalLayerInfos,function(a){return!a._flag._invalid}))},_initFinalLayerInfos:function(){var a,b,e=this._finalLayerInfos||this._layerInfos;this._finalLayerInfos=[];for(a=this.map.graphicsLayerIds.length-1;0<=a;a--)b=this.map.graphicsLayerIds[a],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,
e),b,!0);for(a=this.map.layerIds.length-1;0<=a;a--)b=this.map.layerIds[a],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,e),b,!1);this._refineFinalLayerInfos()},_initTablesInfos:function(){this._tableInfos=[];var a=this._tables&&this._tables.reverse();a&&this._addTables(a,this._tableInfos)},_initFinalBasemapLayerInfos:function(){var a=this._finalBasemapLayerInfos||this._basemapLayerInfos;this._finalBasemapLayerInfos=[];g.forEach(this.getBasemapLayers(),function(b){var c;
g.some(a,function(a){if(a.id===b.id)return c=a,!0},this);this._addToFinalBasemapLayerInfos(c,b.id,!1)},this)},_isBasemap:function(a){for(var b=!1,c=this.getBasemapLayers(),e=0;e<c.length;e++)c[e].id===a&&(b=!0);return b},_addToFinalBasemapLayerInfos:function(a,b,e){this._addToSpecifiedLayerInfos(a,b,e,this._finalBasemapLayerInfos)},_addToFinalLayerInfos:function(a,b,e){this._addToSpecifiedLayerInfos(a,b,e,this._finalLayerInfos)},_addToSpecifiedLayerInfos:function(a,b,e,f){var c;if(a)a._addedFlag||
a.isGraphicLayer()!==e||(f.push(a),a._addedFlag=!0);else{a=this.map.getLayer(b);if("esri.layers.GraphicsLayer"!==a.declaredClass&&"esri.layers.LabelLayer"!==a.declaredClass){try{var k={layerObject:a,title:this._getLayerTitle(a),id:a.id||" "};t.mixin(k,t.getObject("_wabProperties.originOperLayer",!1,a));c=this._layerInfoFactory.create(k,this.map);c.init()}catch(E){console.warn(E.message),c=null}c&&(t.getObject("_wabProperties.isTemporaryLayer",!1,a)&&(c._flag._isTemporaryLayerInfo=!0),f.push(c))}("esri.layers.ArcGISDynamicMapServiceLayer"===
a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass)&&c&&c._getServiceDefinition().then(t.hitch(this,function(a){var b=[];g.forEach(a.tables,function(a){a.url=c.getUrl()+"/"+a.id;a.id=c.id+"_"+a.id;a.title=this._getLayerTitle(a);b.push(a)},this);this._addTables(b,this._tableInfos)}))}},_getLayerTitle:function(a){if(a.title)return a.title;if(t.getObject("_wabProperties.originalLayerName",!1,a))return a.name||a.id;var b=a.label||a.name||"";if(a.url&&!t.getObject("_wabProperties.itemLayerInfo",
!1,a)){var c;c=a.url.indexOf("/FeatureServer");-1===c&&(c=a.url.indexOf("/MapServer"));-1===c&&(c=a.url.indexOf("/service"));-1<c&&(c=a.url.substring(0,c),c=c.substring(c.lastIndexOf("/")+1,c.length),b=b?c+" - "+b:c)}return b||a.id},_findLayerInfoByIdAndReturnTopLayer:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length;c++)if(e=b[c].findLayerInfoById(a)){e=b[c];break}return e},_findLayerInfoById:function(a,b){var c,e=null;b||(b=this._finalLayerInfos);for(c=0;c<b.length&&!(e=
b[c].findLayerInfoById(a));c++);return e},_findTopLayerInfoById:function(a){var b,c=null,e=[].concat(this._finalLayerInfos||[],this._tableInfos||[]);for(b=0;b<e.length;b++)if(e[b].id===a){c=e[b];break}return c},_getTopLayerInfoIndexById:function(a){var b,c=-1;for(b=0;b<this._finalLayerInfos.length;b++)if(this._finalLayerInfos[b].id===a){c=b;break}return c},_clearAddedFlag:function(a){g.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this._finalLayerInfos.length){for(a=
0;a<this._finalLayerInfos.length;a++)this._finalLayerInfos[a].isFirst=!1,this._finalLayerInfos[a].isLast=!1;this._finalLayerInfos[0].isFirst=!0;this._finalLayerInfos[this._finalLayerInfos.length-1].isLast=!0;for(a=0;a<this._finalLayerInfos.length;a++)if(!this._finalLayerInfos[a].isGraphicLayer()){a&&(this._finalLayerInfos[a-1].isLast=!0);this._finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,b,e){"BasemapGallery"===a&&(this._basemapLayers.length=0,g.forEach(e,t.hitch(this,
function(a){this._basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var b;for(b=this._basemapLayers.length=0;b<a.layers.length;b++)this._basemapLayers.push({layerObject:a.layer[b],id:a.layers[b].id})},_destroyLayerInfos:function(){g.forEach(this._finalLayerInfos,t.hitch(this,function(a){a.destroy()}))},_bindEvents:function(){var a,b,f,g,k,p,u,v,G,F,D;a=n(this.map,"layer-add-result",t.hitch(this,this._onLayersChange,e.ADDED));
b=n(this.map,"layer-remove",t.hitch(this,this._onLayersChange,e.REMOVED));u=m.subscribe("layerInfos/layerReorder",t.hitch(this,this._onLayerReorder));g=m.subscribe("layerInfos/layerInfo/isShowInMapChanged",t.hitch(this,this._onShowInMapChanged));k=m.subscribe("layerInfos/layerInfo/visibleChanged",t.hitch(this,this._onVisibleChanged));p=m.subscribe("layerInfos/layerInfo/filterChanged",t.hitch(this,this._onFilterChanged));v=m.subscribe("layerInfos/layerInfo/rendererChanged",t.hitch(this,this._onRendererChanged));
G=m.subscribe("layerInfos/layerInfo/opacityChanged",t.hitch(this,this._onOpacityChanged));D=m.subscribe("layerInfos/layerInfo/scaleRangeChanged",t.hitch(this,this._onScaleRangeChanged));F=m.subscribe("layerInfos/layerInfo/timeExtentChanged",t.hitch(this,this._onTimeExtentChanged));f=n(this.map,"before-unload",t.hitch(this,function(){a.remove();b.remove();u.remove();g.remove();k.remove();p.remove();v.remove();f.remove();G.remove();D.remove();F.remove();this._destroyLayerInfos()}))},_emitEvent:function(){try{this.emit.apply(this,
arguments)}catch(c){console.warn(c)}},_emitEventForEveryLayerInfo:function(a,b,e){try{g.forEach(b,function(b){b.emitEvent(a,e)},this)}catch(q){console.warn(q)}},_onLayersChange:function(a,b){var c=null,f;b.error||"esri.layers.GraphicsLayer"===b.layer.declaredClass||"esri.layers.LabelLayer"===b.layer.declaredClass||(a===e.ADDED?(this.update(),c=a=this._findLayerInfoById(b.layer.id,b.layer._basemapGalleryLayerType?this._finalBasemapLayerInfos:this._finalLayerInfos),f=e.ADDED,a&&!a.isRootLayer()&&(c=
a.getRootLayerInfo(),f=e.SUBLAYER_ADDED)):(c=a=this._findLayerInfoById(b.layer.id,b.layer._basemapGalleryLayerType?this._finalBasemapLayerInfos:this._finalLayerInfos),f=e.REMOVED,a&&!a.isRootLayer()&&(c=a.getRootLayerInfo(),f=e.SUBLAYER_REMOVED),a&&a.destroy(),this.update()),c&&(b.layer._basemapGalleryLayerType?(this._emitEvent("basemapLayersChanged"),this._emitEvent("basemapLayerInfosChanged",c,f,a)):this._emitEvent("layerInfosChanged",c,f,a)))},_onTableChange:function(a,b){this._emitEvent("tableInfosChanged",
a,b,a)},_onLayersUpdated:function(a,b){a.isTable?this._emitEvent("tableInfosChanged",[a],e.UPDATED,[b]):this._emitEvent("layerInfosChanged",a,e.UPDATED,b)},_onShowInMapChanged:function(a){this._emitEvent("layerInfosIsShowInMapChanged",a);this._emitEventForEveryLayerInfo("isShowInMapChanged",a)},_onVisibleChanged:function(a){this._emitEvent("layerInfosIsVisibleChanged",a);this._emitEventForEveryLayerInfo("isVisibleChanged",a)},_onFilterChanged:function(a,b){this._emitEvent("layerInfosFilterChanged",
a,b);this._emitEventForEveryLayerInfo("filterChanged",a,b)},_onLayerReorder:function(a,b,f){a=this._reorderLayerInfosArray(a,b,f);this._emitEvent("layerInfosReorder",a,e.REORDERED,a)},_onRendererChanged:function(a){this._emitEvent("layerInfosRendererChanged",a);this._emitEventForEveryLayerInfo("rendererChanged",a)},_onOpacityChanged:function(a){this._emitEvent("layerInfosOpacityChanged",a);this._emitEventForEveryLayerInfo("opacityChanged",a)},_onScaleRangeChanged:function(a){this._emitEvent("layerInfosScaleRangeChanged",
a);this._emitEventForEveryLayerInfo("scaleRangeChanged",a)},_onTimeExtentChanged:function(a){this._emitEvent("layerInfosTimeExtentChanged",a);this._emitEventForEveryLayerInfo("timeExtentChanged",a)}});e.getLayerInfoArrayByType=function(a,b){var c=new v,f=[],m=[];e.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var b=a.getLayerType();b.layerInfo=a;f.push(b)});k(f).then(function(a){g.forEach(a,function(a,c){b===a&&m.push(f[c].layerInfo)});c.resolve(m)})});return c};var b=null,a=
null;e.getInstance=function(a,b){var c=new v;c.resolve(e.getInstanceSyncForInit(a,b));return c};e.getInstanceSyncForInit=function(c,f){b&&b!==c&&(a=b=null);a||(a=new e(c,f.itemData),b=c);return a};e.getInstanceSync=function(){return a};e.setInstance=function(c,e){b=c;a=e};e.createInstance=function(a){var b=null;return b=new e(a,a.itemInfo.itemData)};t.mixin(e,{ADDED:"added",REMOVED:"removed",SUBLAYER_ADDED:"subLayerAdded",SUBLAYER_REMOVED:"subLayerRemoved",UPDATED:"updated",REORDERED:"reordered"});
return e})},"jimu/LayerInfos/LayerInfoFactory":function(){define("dojo/_base/declare jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream jimu/LayerInfos/LayerInfoForDefaultKML".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return p(null,{constructor:function(a,b){this.map=a;this.layerInfos=b},create:function(w){var q=null;if(w.featureCollection)q=new g(w,this.map,this,this.layerInfos);else if("esri.layers.KMLLayer"===w.layerObject.declaredClass)q=new v(w,this.map,this,this.layerInfos);else if("esri.layers.GeoRSSLayer"===w.layerObject.declaredClass)q=new n(w,this.map,this,this.layerInfos);else if("esri.layers.WMSLayer"!==w.layerObject.declaredClass||w.selfType)if("esri.layers.ArcGISDynamicMapServiceLayer"===
w.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===w.layerObject.declaredClass)q=new t(w,this.map,this,this.layerInfos);else if("esri.layers.ArcGISImageServiceLayer"===w.layerObject.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===w.layerObject.declaredClass)q=new a(w,this.map,this,this.layerInfos);else if("esri.layers.StreamLayer"===w.layerObject.declaredClass)q=new c(w,this.map,this,this.layerInfos);else switch("Table"===w.layerObject.type&&(w.selfType="table"),
w.selfType){case "mapservice_dynamic_group":case "mapservice_dynamic":q=new k(w,this.map,this,this.layerInfos);break;case "mapservice_tiled_group":case "mapservice_tiled":q=new f(w,this.map,this,this.layerInfos);break;case "wms":q=new e(w,this.map,this,this.layerInfos);break;case "kml":q=new x(w,this.map,this,this.layerInfos);break;case "table":q=new b(w,this.map,this,this.layerInfos);break;default:q=new m(w,this.map,this,this.layerInfos)}else q=new u(w,this.map,this,this.layerInfos);return q}})})},
"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all esri/lang jimu/utils ./LayerInfo".split(" "),function(p,g,t,v,n,m,u){return p(u,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection",empty:!0}},_getExtent:function(){var k=null,f=[];g.forEach(this.getSubLayers(),function(e){f.push(e._getExtent())},this);return v(f).then(t.hitch(this,function(e){g.forEach(e,function(b){m.isValidExtent(b)&&
(k=k?k.union(b):b)},this);return k}))},_resetLayerObjectVisiblity:function(g){var f=g?g[this.id]:null;if(f){var e={},b;for(b in g)g.hasOwnProperty(b)&&"function"!==typeof g[b]&&(e[b]=g[b].visible);this._setSubLayerVisibleByCheckedInfo(e);this._setTopLayerVisible(f.visible)}},_setSubLayerVisibleByCheckedInfo:function(k){g.forEach(this.newSubLayers,function(f){n.isDefined(k[f.id])&&f.layerObject.setVisibility(k[f.id])},this)},_initVisible:function(){var g=!1,f;for(f=0;f<this.newSubLayers.length;f++)g=
g||this.newSubLayers[f].layerObject.visible;g&&(this._visible=!0)},_setTopLayerVisible:function(k){this._visible=k?!0:!1;g.forEach(this.newSubLayers,function(f){f.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var k=[];g.forEach(this.originOperLayer.featureCollection.layers,function(f){this._getLayerIndexesInMapByLayerId(f.layerObject.id)&&(t.setObject("_wabProperties.originOperLayer.showLegend",this.originOperLayer.featureCollection.showLegend,f.layerObject),
f=this._layerInfoFactory.create({layerObject:f.layerObject,title:f.layerObject.label||f.layerObject.title||f.layerObject.name||f.layerObject.id||" ",id:f.id||"-",subId:f.id||"-",collection:{layerInfo:this},selfType:"collection",showLegend:!0,parentLayerInfo:this}),k.push(f),f.init())},this);k.reverse();return k},_obtainLayerIndexesInMap:function(){var g=[],f,e;for(e=this.newSubLayers.length-1;0<=e;e--)(f=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&g.push(f);return g},
moveLeftOfIndex:function(g){var f;for(f=0;f<this.newSubLayers.length;f++)this.map.reorderLayer(this.newSubLayers[f].layerObject,g)},moveRightOfIndex:function(g){var f;for(f=this.newSubLayers.length-1;0<=f;f--)this.map.reorderLayer(this.newSubLayers[f].layerObject,g)},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.featureCollection.showLegend?this.originOperLayer.featureCollection.showLegend:!0},getOpacity:function(){var g,f=0;for(g=0;g<this.newSubLayers.length;g++)if(this.newSubLayers[g].layerObject.opacity)f=
this.newSubLayers[g].layerObject.opacity>f?this.newSubLayers[g].layerObject.opacity:f;else return 1;return f},setOpacity:function(k){g.forEach(this.newSubLayers,function(f){f.layerObject.setOpacity&&f.layerObject.setOpacity(k)})},getScaleRange:function(){var g=this.getSubLayers();return g[0]?g[0].getScaleRange():{minScale:0,maxScale:0}}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic dojo/aspect dojo/Evented dojo/request/script jimu/portalUrlUtils jimu/portalUtils jimu/LayerNode jimu/utils ./RequestBuffer esri/kernel esri/tasks/query esri/request".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){var E=p([f],{declaredClass:"jimu.LayerInfo",originOperLayer:null,layerObject:null,map:null,title:null,id:null,subId:null,newSubLayers:null,parentLayerInfo:null,isTable:null,isTiled:null,_oldIsShowInMap:null,_oldFilter:null,_eventHandles:null,_subLayerInfoIndex:null,_serviceDefinitionBuffer:null,_flag:null,_objectId:null,_itemInfo:null,_adaptor:null,constructor:function(a,b,e,f){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=b;this.title=
this.originOperLayer.title||this.originOperLayer.id||"";this.id=this.originOperLayer.id;this.subId=void 0!==this.originOperLayer.subId?this.originOperLayer.subId:this.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.isTiled=this.isTable=!1;this._eventHandles=[];this._layerInfoFactory=e;this._layerInfos=f;this._flag={};this._objectId=Math.random();this._adaptor=new c(this)},init:function(){this.newSubLayers=this.obtainNewSubLayers();this._initSubLayerInfoIndex();this._initVisible();
this.originOperLayer.popupInfo&&(this.popupVisible=!0);this._oldIsShowInMap=this.isShowInMap();this._initOldFilter();this._initServiceDefinitionBuffer();this._bindEvent()},_initOldFilter:function(){this._oldFilter=null},_initServiceDefinitionBuffer:function(){this._serviceDefinitionBuffer=new w(t.hitch(this,this._serviceDefinitionRequest))},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},
getObjectId:function(){return this._objectId},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},moveLeftOfIndex:function(a){this.map.reorderLayer(this.layerObject,a)},moveRightOfIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var b=this.getSubLayers(),c=0;c<b.length;c++)if(b[c].traversal(a))return!0},findLayerInfoById:function(a){var b=
null,c=0;if(this.id&&this.id===a)return this;for(c=0;c<this.newSubLayers.length&&!(b=this.newSubLayers[c].findLayerInfoById(a));c++);return b},setTopLayerVisible:function(a){this._setTopLayerVisible(a)},_setTopLayerVisible:function(a){},_setSubLayerVisible:function(a,b){},setLayerVisiblefromTopLayer:function(){},_resetLayerObjectVisiblity:function(){},resetLayerObjectVisibility:function(a){var b=a?a[this.id]:null;this.isRootLayer()&&b&&this._resetLayerObjectVisiblity(a)},_initVisible:function(){},
isVisible:function(){return this._visible?!0:!1},show:function(){this._setTopLayerVisible(!0)},hide:function(){this._setTopLayerVisible(!1)},_obtainLayerIndexesInMap:function(){var a=[],b;(b=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(b);return a},_getLayerIndexesInMapByLayerId:function(a){var b;for(b=0;b<this.map.graphicsLayerIds.length;b++)if(this.map.graphicsLayerIds[b]===a)return{isGraphicLayer:!0,index:b};for(b=0;b<this.map.layerIds.length;b++)if(this.map.layerIds[b]===a)return{isGraphicLayer:!1,
index:b};return null},_isShowInMapChanged:function(){var a=!1,b=this.isShowInMap();!1===b&&this.map.infoWindow.hide();this._oldIsShowInMap!==b&&(this._oldIsShowInMap=b,a=!0);return a},_isShowInMapChanged2:function(){var a=[];this.traversal(function(b){b._isShowInMapChanged()&&a.push(b)});u.publish("layerInfos/layerInfo/isShowInMapChanged",a)},_visibleChanged:function(){u.publish("layerInfos/layerInfo/visibleChanged",[this])},_initSubLayerInfoIndex:function(){var a={};this.isRootLayer()&&this.traversal(function(b){b.isRootLayer()||
(a[b.subId]=b)});this._subLayerInfoIndex=a},_getLayerInfosObj:function(){return this._layerInfos},obtainNewSubLayers:function(){return[]},createLegendsNode:function(){return m.create("div",{"class":"legends-div"})},drawLegends:function(a,b){},_getLayerTypesOfSupportTable:function(){return"FeatureLayer,CSVLayer,Table,ArcGISImageServiceLayer,StreamLayer,ArcGISImageServiceVectorLayer"},_getShowLegendOfWebmap:function(){return void 0!==this.originOperLayer.showLegend?this.originOperLayer.showLegend:!0},
_needToRenew:function(){return!1},_getServiceDefinition:function(){var a=new v;a.resolve(null);return a},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{f:"json"},"json")},getServiceDefinition:function(){return this._getServiceDefinition()},_normalRequest:function(a,b,c){return z({url:a,content:b,handleAs:c,callbackParamName:"callback"})},getLayerObject:function(){var a=new v;this.layerObject?a.resolve(this.layerObject):a.resolve(null);return a},getLayerObjectTryUsingFeatureService:function(){return this.getLayerObject()},
getSubLayers:function(){return this.newSubLayers},isLeaf:function(){return 0===this.getSubLayers().length?!0:!1},isRootLayer:function(){return this.parentLayerInfo?!1:!0},getLayerLevel:function(){for(var a=0,b=this;b.parentLayerInfo;)a++,b=b.parentLayerInfo;return a},getRootLayerInfo:function(){for(var a=this;a.parentLayerInfo;)a=a.parentLayerInfo;return a},isShowInMap:function(){for(var a=!0,b=this;b;)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},getLayerType:function(){var a=[null],b=new v;this.layerObject.declaredClass&&
(a=this.layerObject.declaredClass.split("."));b.resolve(a[a.length-1]);return b},getPopupInfo:function(){return this.originOperLayer.popupInfo},getPopupInfoFromLayerObject:function(){var a=this.getInfoTemplate(),b=null;a&&(b=a.info);return b},loadPopupInfo:function(){var a=new v;this.loadInfoTemplate().then(t.hitch(this,function(b){var c=null;b&&(c=b.info);a.resolve(c)}));return a},loadInfoTemplate:function(){var a=new v;a.resolve(null);return a},getInfoTemplate:function(){return null},getFilterOfWebmap:function(){return this.originOperLayer.layerDefinition?
this.originOperLayer.layerDefinition.definitionExpression:null},getFilter:function(){return null},setFilter:function(){},getShowLegendOfWebmap:function(){for(var a=this,b=!0;a;)b=b&&a._getShowLegendOfWebmap(),a=a.parentLayerInfo;return b},getUrl:function(){return this.layerObject.url||this.layerObject._url},hasLayerTypes:function(a){},getSupportTableInfo:function(){var a=new v,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},c=this.getLayerType(),e=this.getLayerObject();n({type:c,layerObject:e}).then(t.hitch(this,
function(c){var e=c.type;c=c.layerObject;b.layerType=e;0<=this._getLayerTypesOfSupportTable().indexOf(e)&&(b.isSupportedLayer=!0);if(!c)b.isSupportQuery=!1;else if(this.parentLayerInfo&&this.parentLayerInfo.isMapNotesLayerInfo())b.isSupportQuery=!1;else if(!c.url||c.capabilities&&c.capabilities.indexOf&&0<=c.capabilities.indexOf("Query"))b.isSupportQuery=!0;a.resolve(b)}),function(){a.resolve(b)});return a},getRelatedTableInfoArray:function(a){a=new v;a.resolve([]);return a},getRelatedRecords:function(a,
b){a=new v;a.resolve([]);return a},removeSubLayerById:function(a){var b=[];g.forEach(this.newSubLayers,function(c){c.id!==a?b.push(c):c.destroy()});this.newSubLayers=b},releaseResource:function(){g.forEach(this._eventHandles,function(a){a.remove()});this.destroyLabelLayer();this._adaptor&&this._adaptor.destroy()},destroy:function(){g.forEach(this.newSubLayers,function(a){a.destroy()});this.releaseResource();this.inherited(arguments)},update:function(){g.forEach(this.newSubLayers,function(a){a.destroy()});
this.releaseResource();this.init()},isMapNotesLayerInfo:function(){return this.originOperLayer.featureCollection&&0===this.id.indexOf("mapNotes_")&&"ArcGISFeatureLayer"===this.originOperLayer.layerType&&!this.map.getLayer(this.id)?!0:!1},_getExtent:function(){var a=new v;a.resolve(this.layerObject.fullExtent||this.layerObject.initialExtent);return a},getExtent:function(){var a=new v;this._getExtent().then(t.hitch(this,function(b){x.projectToMapSpatialReference(this.map,b).then(t.hitch(this,function(b){a.resolve(b)}),
t.hitch(this,function(){a.resolve(null)}))}),t.hitch(this,function(){a.resolve(null)}));return a},_requerySelectdFeatures:function(){var a=new v;this.getLayerObject().then(t.hitch(this,function(b){var c=[],e;if(b&&b.isEditable&&!b.isEditable()){e=b.objectIdField;var c=b.getSelectedFeatures(),f=b.on("update-end",t.hitch(this,function(){var k=new C,m=[];g.forEach(c,function(a){m.push(a.attributes[e])},this);k.objectIds=m;k.maxAllowableOffset=0;b.queryFeatures(k,t.hitch(this,function(b){g.forEach(b.features,
function(a){g.some(c,function(b){return b.attributes[e]===a.attributes[e]?(b.setGeometry(a.geometry),!0):!1})},this);a.resolve()}),t.hitch(this,function(){a.resolve()}));f&&f.remove&&f.remove()}))}}));return a},zoomTo:function(a){this._requerySelectdFeatures();return a?x.projectToMapSpatialReference(this.map,a).then(t.hitch(this,function(a){return this._zoomTo(a)})):this.getExtent().then(t.hitch(this,function(a){return this._zoomTo(a)}))},_zoomTo:function(a){if(x.isValidExtent(a)){a=t.clone(a);var b=
this.getLayerScaleRange(),c=b.minScale,b=b.maxScale;if(a.isSinglePoint){if(c=x.getTargetScale(this.map,3,c,b))a=x.adjustHeightToAspectRatio(this.map,a),a=x.getExtentForScale(a,this.map.width,c),this.map.setExtent(a)}else{a=x.adjustExtentToAspectRatio(this.map,a);var e=x.getScaleForExtent(a,this.map.width);0<c&&e>c?(c=x.getScaleForNextTileLevel(this.map,c,!0),a=x.adjustHeightToAspectRatio(this.map,a),a=x.getExtentForScale(a,this.map.width,c),this.map.setExtent(a)):e<b?(b=x.getScaleForNextTileLevel(this.map,
b,!1),a=x.adjustHeightToAspectRatio(this.map,a),a=x.getExtentForScale(a,this.map.width,b),this.map.setExtent(a)):this.map.setExtent(a,!0)}}},mergeScale:function(a,b,c,e){var f=0,g=0;0===a&&0<c?f=c:0<a&&0===c?f=a:0<a&&0<c&&(f=Math.min(a,c));g=Math.max(b,e);return{minScale:f,maxScale:g}},unionScale:function(a,b,c,e){var f=0,g=0,f=0===a||0===c?0:Math.max(a,c),g=Math.min(b,e);return{minScale:f,maxScale:g}},getScaleRange:function(){return this.layerObject&&0<=this.layerObject.minScale&&0<=this.layerObject.maxScale?
{minScale:this.layerObject.minScale,maxScale:this.layerObject.maxScale}:{minScale:0,maxScale:0}},setScaleRange:function(a,b){this.layerObject&&this.layerObject.setScaleRange&&this.layerObject.setScaleRange(a,b)},getLayerScaleRange:function(){var a,b=this.getScaleRange();this.traversal(t.hitch(this,function(b){b.id!==this.id&&(b=b.getScaleRange(),a=a?this.unionScale(a.minScale,a.maxScale,b.minScale,b.maxScale):b)}));return a?this.mergeScale(b.minScale,b.maxScale,a.minScale,a.maxScale):b},isCurrentScaleInTheScaleRange:function(){var a=
this.getScaleRange(),b=this.map.getScale();return 0===a.minScale&&0===a.maxScale?!0:(0===a.minScale||a.minScale>=b)&&(0===a.maxScale||b>=a.maxScale)?!0:!1},isInScale:function(){for(var a=!0,b=this;b&&(a=b.isCurrentScaleInTheScaleRange(),b=b.parentLayerInfo,a););return a},enablePopup:function(){},disablePopup:function(){},isPopupEnabled:function(){return!1},enablePopupNested:function(){this.isLeaf()?this.enablePopup():this.traversal(t.hitch(this,function(a){a.isLeaf()&&a.enablePopup()}))},disablePopupNested:function(){this.isLeaf()?
this.disablePopup():this.traversal(t.hitch(this,function(a){a.isLeaf()&&a.disablePopup()}))},isPopupNestedEnabled:function(){var a=!1;this.isLeaf()?a=this.isPopupEnabled():this.traversal(t.hitch(this,function(b){return b.isLeaf()&&b.isPopupEnabled()?a=!0:!1}));return a},getCapabilitiesOfWebMap:function(){return this.originOperLayer.capabilities},isItemLayer:function(){return this._getBasicItemInfo()},isPublicService:function(){var a=new v,c=this.getUrl()+"?f\x3djson";c?("https"===b.getProtocol(window.location.href)&&
(c=b.setHttpsProtocol(c)),e.get(c,{jsonp:"callback"}).then(t.hitch(this,function(b){b&&b.error?a.resolve(!1):a.resolve(!0)}),t.hitch(this,function(){a.resolve(!1)}))):a.resolve(!0);return a},isEditable:function(){var b=!1,c=!0,e=getAppConfig().portalUrl,e=a.getPortal(e),f=this.isPublicService(),k=new v,m=new v;e.getUser().then(t.hitch(this,function(a){m.resolve(a)}),t.hitch(this,function(){m.resolve(null)}));n({user:m,isPublicService:f}).then(t.hitch(this,function(a){var e=a.user&&a.user.privileges;
a=a.isPublicService;e&&-1===g.indexOf(e,"features:user:edit")&&q.id&&!a&&(c=!1);b=this.layerObject&&this.layerObject.isEditable?this.layerObject.isEditable()&&c?!0:!1:!1;k.resolve(b)}),t.hitch(this,function(){k.resolve(!1)}));return k},_getBasicItemInfo:function(){var a=null,c=this.getRootLayerInfo(),e=window.appConfig||window.getAppConfig(),f=t.getObject("_wabProperties.itemLayerInfo",!1,c.layerObject);c.originOperLayer.itemId?(a={},a.itemId=c.originOperLayer.itemId,a.portalUrl=b.getStandardPortalUrl(e.map.portalUrl||
e.portalUrl)):f&&f.portalUrl&&f.itemId&&(a={},a.itemId=f.itemId,a.portalUrl=b.getStandardPortalUrl(f.portalUrl));return a},getItemInfo:function(){var a=new v,b=this.getRootLayerInfo();b.isItemLayer()?(b._itemInfo||(b._itemInfo=new E.ItemInfo(this,b)),b._itemInfo.onLoad().then(t.hitch(this,function(){a.resolve(b._itemInfo)}),t.hitch(this,function(){a.resolve(null)}))):a.resolve(null);return a},isHostedService:function(){var a=new v;this._getServiceDefinition().then(t.hitch(this,function(b){a.resolve(b&&
b.serviceItemId?!0:!1)}));return a},isHostedLayer:function(){var a;this.isItemLayer()?a=this.isHostedService():(a=new v,a.resolve(!1));return a},obtainLabelControl:function(){},restoreLabelControl:function(){},destroyRealtedLabelLayer:function(){},destroyLabelLayer:function(){},canShowLabel:function(){},isShowLabels:function(){},showLabels:function(){},hideLabels:function(){},isBasemap:function(){return this.getRootLayerInfo().layerObject._basemapGalleryLayerType?!0:!1},emitEvent:function(){try{this.emit.apply(this,
arguments),this._adaptor&&this._adaptor.emitEvent.apply(this._adaptor,arguments)}catch(B){console.error(B)}},_bindEvent:function(){var a;this.layerObject&&!this.layerObject.empty&&(a=this.layerObject.on("visibility-change",t.hitch(this,this._onVisibilityChanged)),this._eventHandles.push(a),a=k.after(this.layerObject,"setDefinitionExpression",t.hitch(this,this._onFilterChanged)),this._eventHandles.push(a),a=k.after(this.layerObject,"setRenderer",t.hitch(this,this._onRendererChanged)),this._eventHandles.push(a),
this.isRootLayer()&&(a=this.layerObject.on("opacity-change",t.hitch(this,this._onOpacityChanged)),this._eventHandles.push(a)),a=this.layerObject.on("scale-range-change",t.hitch(this,this._onScaleRangeChanged)),this._eventHandles.push(a),this.isRootLayer()&&(a=this.map.on("time-extent-change",t.hitch(this,function(){this.layerObject&&this.layerObject.useMapTime&&this._onTimeExtentChanged()})),this._eventHandles.push(a)),this.isRootLayer()&&(a=k.after(this.layerObject,"setTimeDefinition",t.hitch(this,
function(){this.layerObject&&this.layerObject.timeInfo&&this.layerObject.mode===esri.layers.FeatureLayer.MODE_SNAPSHOT&&this._onTimeExtentChanged()})),this._eventHandles.push(a)))},_onVisibilityChanged:function(){this._initVisible();this._visibleChanged();this._isShowInMapChanged2()},_onFilterChanged:function(){var a=this._oldFilter?this._oldFilter:null,b=this.layerObject.getDefinitionExpression(),b=b?b:null;a!==b&&(u.publish("layerInfos/layerInfo/filterChanged",[this],t.getObject("_wabProperties.objectPassWithFilterChangeEvent",
!0,this.layerObject)),this._oldFilter=b,t.setObject("_wabProperties.objectPassWithFilterChangeEvent",{},this.layerObject))},_onRendererChanged:function(){u.publish("layerInfos/layerInfo/rendererChanged",[this])},_onOpacityChanged:function(){u.publish("layerInfos/layerInfo/opacityChanged",[this])},_onScaleRangeChanged:function(){u.publish("layerInfos/layerInfo/scaleRangeChanged",[this])},_onTimeExtentChanged:function(){var a=[],b=[];this.traversal(function(c){var e=c.getServiceDefinition().then(function(b){b&&
b.timeInfo&&a.push(c)});b.push(e)});n(b).then(t.hitch(this,function(){u.publish("layerInfos/layerInfo/timeExtentChanged",a)}))}});E.ItemInfo=p(null,{_currentLayerInfo:null,_rootLayerInfo:null,_portalUrl:null,_itemId:null,_item:null,_itemData:null,_serviceDefinition:null,_itemInfoLoadedDef:null,constructor:function(a,b){this._currentLayerInfo=a;this._rootLayerInfo=b;this._loadResource()},_loadResource:function(){this._itemInfoLoadedDef=new v;var b=this._rootLayerInfo.isItemLayer();if(b){this._portalUrl=
b.portalUrl;this._itemId=b.itemId;var c=a.getPortal(this._portalUrl),b=c.getItemById(this._itemId),c=c.getItemData(this._itemId),e=this._currentLayerInfo._getServiceDefinition();n({item:b,itemData:c,serviceDefinition:e}).then(t.hitch(this,function(a){this._item=a.item;this._itemData=a.itemData;this._serviceDefinition=a.serviceDefinition;this._itemInfoLoadedDef.resolve(this)}),t.hitch(this,function(a){a&&a.message&&console.log(a.message);this._itemInfoLoadedDef.reject()}))}else this._itemInfoLoadedDef.reject()},
onLoad:function(){return this._itemInfoLoadedDef},getPortalUrl:function(){return this._portalUrl},getItemId:function(){return this._itemId},getItem:function(){return this._item},getItemData:function(){return this._itemData},isHostedLayer:function(){return this._serviceDefinition&&this._serviceDefinition.serviceItemId?!0:!1}});return E})},"jimu/LayerNode":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Deferred","dojo/Evented"],function(p,g,t,v,n){var m=p([n],{declaredClass:"jimu.LayerNode",
_layerInfo:null,map:null,title:null,id:null,subId:null,layerObject:null,constructor:function(g){this._layerInfo=g;this.map=g.map;this.title=g.title;this.id=g.id;this.subId=g.subId},isLeaf:function(){return this._layerInfo.isLeaf()},isRoot:function(){return this._layerInfo.isRootLayer()},toggle:function(){this._layerInfo.setTopLayerVisible(!this.isToggledOn())},isToggledOn:function(){return this._layerInfo.isVisible()},show:function(){this._layerInfo.show()},hide:function(){this._layerInfo.hide()},
isVisible:function(){return this._layerInfo.isShowInMap()},traversal:function(g){return this._layerInfo.traversal(function(k){return g(k._adaptor)})},getNodeById:function(g){var k=null;if(g=this._layerInfo.findLayerInfoById(g))k=g._adaptor;return k},getExtent:function(){return this._layerInfo.getExtent()},getOpacity:function(){return this._layerInfo.getOpacity()},setOpacity:function(g){this._layerInfo.setOpacity(g)},getServiceDefinition:function(){return this._layerInfo.getServiceDefinition()},getLayerObject:function(){return this._layerInfo.getLayerObject()},
getRootNode:function(){return this._layerInfo.getRootLayerInfo()._adaptor},getParentNode:function(){var g=this._layerInfo.parentLayerInfo;return g?g._adaptor:null},getSubNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfo.getSubLayers())},getNodeLevel:function(){return this._layerInfo.getLayerLevel()},getLayerType:function(){return this._layerInfo.getLayerType()},getPopupInfoFromWebmap:function(){return this._layerInfo.getPopupInfo()},getPopupInfo:function(){return this._layerInfo.getPopupInfoFromLayerObject()},
loadPopupInfo:function(){return this._layerInfo.loadPopupInfo()},getInfoTemplate:function(){return this._layerInfo.getInfoTemplate()},loadInfoTemplate:function(){return this._layerInfo.loadInfoTemplate()},getFilterFromWebmap:function(){return this._layerInfo.getFilterOfWebmap()},getFilter:function(){return this._layerInfo.getFilter()},setFilter:function(g){this._layerInfo.setFilter(g)},isShowLegend:function(){return this.isShowLegendFromWebmap()},isShowLegendFromWebmap:function(){return this._layerInfo.getShowLegendOfWebmap()},
isToggledOnLegendFromWebMap:function(){return this._layerInfo._getShowLegendOfWebmap()},getUrl:function(){return this._layerInfo.getUrl()},getRelatedNodes:function(){var g=new v;this._layerInfo.getRelatedTableInfoArray().then(t.hitch(this,function(k){g.resolve(this._getNodesArrayFromInfosArray(k))}));return g},isVisibleAtMapScale:function(){return this._layerInfo.isInScale()},enablePopup:function(){return this._layerInfo.enablePopup()},disablePopup:function(){return this._layerInfo.disablePopup()},
isPopupEnabled:function(){return this._layerInfo.isPopupEnabled()},isItemLayer:function(){return this._layerInfo.isItemLayer()},getItemInfo:function(){return this._layerInfo.getItemInfo()},isHostedService:function(){return this._layerInfo.isHostedService()},isHostedLayer:function(){return this._layerInfo.isHostedLayer()},canShowLabel:function(){return this._layerInfo.canShowLabel()},isLabelVisble:function(){return this._layerInfo.isShowLabels()},showLabel:function(){this._layerInfo.showLabels()},
hideLabel:function(){this._layerInfo.hideLabels()},isTable:function(){return!!this._layerInfo.isTable},isTiled:function(){return!!this._layerInfo.isTiled},isBasemap:function(){return this._layerInfo.isBasemap()},isEditable:function(g){return this._layerInfo.isEditable(g)},zoomTo:function(g){return this._layerInfo.zoomTo(g)},emitEvent:function(g){try{var k=null;switch(g){case "isVisibleChanged":k=m.EVENT_TOOGLE_CHANGE;break;case "isShowInMapChanged":k=m.EVENT_VISIBILITY_CHANGE;break;case "filterChanged":k=
m.EVENT_FILTER_CHANGE;break;case "rendererChanged":k=m.EVENT_RENDERER_CHANGE;break;case "opacityChanged":k=m.EVENT_OPACITY_CHANGE;break;case "timeExtentChanged":k=m.EVENT_TIME_EXTENT_CHANGE}k&&this.emit(k)}catch(f){console.error(f)}},destroy:function(){this.inherited(arguments)},_getNodesArrayFromInfosArray:function(m){var k=[];g.forEach(m,function(f){k.push(f._adaptor)},this);return k}});t.mixin(m,{EVENT_TOOGLE_CHANGE:"toggle-change",EVENT_VISIBILITY_CHANGE:"visibility-change",EVENT_FILTER_CHANGE:"filter-change",
EVENT_RENDERER_CHANGE:"renderer-change",EVENT_OPACITY_CHANGE:"opacity-change",EVENT_TIME_EXTENT_CHANGE:"time-extent-change"});return m})},"jimu/LayerInfos/RequestBuffer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred"],function(p,g,t){var v=p(null,{_realRequest:null,_buffer:null,constructor:function(g){this._buffer={};this._realRequest=g?g:function(){return new t}},getRequest:function(g){this._buffer[g]||(this._buffer[g]=new v.RequestProxy(this._realRequest,g));return this._buffer[g]},
request:function(g){var m=Array.prototype.slice.apply(arguments);m.splice(0,1);var n=this.getRequest(g);return n.request.apply(n,m)},setResponse:function(g,m){this.getRequest(g).setResponse(m)},isResolved:function(g){return this.getRequest(g).isResolved()}});v.RequestProxy=p(null,{_key:null,_deferred:null,_realRequest:null,constructor:function(g,m){this._realRequest=g;this._key=m},request:function(){this._deferred||(this._deferred=new t,this._realRequest.apply(null,arguments).then(g.hitch(this,function(g){this._deferred.resolve(g)}),
g.hitch(this,function(g){g&&console.warn(g.message||g);g=this._deferred;this._deferred=null;g.resolve(null)})));return this._deferred},fakeRequest:function(){this._deferred||(this._deferred=new t);return this._deferred},setResponse:function(g,m){this._deferred||(this._deferred=new t);null===g||void 0===g?(this._deferred.resolve(null),m&&(this._deferred=null)):this._deferred.resolve(g)},isResolved:function(){return this._deferred&&this._deferred.isResolved()}});return v})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect dojo/topic ./LayerInfo esri/request esri/lang".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return p(k,{_legendInfo:null,_sublayerIdent:null,controlPopupInfo:null,_jsapiLayerInfos:null,_oldFilter:null,_subLayerVisible:null,constructor:function(){},init:function(){this._initJsapiLayerInfos();this._initSubLayerVisible();this._initSubLayerIdent();this._initControlPopup();this.inherited(arguments);this._needToRefresh().then(t.hitch(this,function(b){b&&(this.update(),this._getLayerInfosObj()._onLayersUpdated(this,this))}))},_needToRefresh:function(){var b=new v;
this.layerObject.dynamicLayerInfos&&this.isRootLayer()&&this.isItemLayer()&&!this.originOperLayer.thematicGroup?this.getItemInfo().then(t.hitch(this,function(a){(a=(a=a.getItemData())&&a.thematicGroup)?(this.originOperLayer.thematicGroup=a,b.resolve(!0)):b.resolve(!1)})):b.resolve(!1);return b},_initOldFilter:function(){this._oldFilter=this.layerObject&&this.layerObject.layerDefinitions?this.layerObject.layerDefinitions:[]},_initJsapiLayerInfos:function(){var b=g.filter(this.originOperLayer.layers,
function(a){return e.isDefined(a.id)&&e.isDefined(a.name)&&e.isDefined(a.minScale)&&e.isDefined(a.maxScale)&&e.isDefined(a.parentLayerId)&&e.isDefined(a.defaultVisibility)});this._jsapiLayerInfos=this.layerObject.dynamicLayerInfos?this.originOperLayer.thematicGroup&&this.originOperLayer.thematicGroup.layerIds&&0<=this.originOperLayer.thematicGroup.layerIds.length?g.filter(this.layerObject.dynamicLayerInfos,function(a){return-1<this.originOperLayer.thematicGroup.layerIds.indexOf(a.id)?!0:!1},this):
this.layerObject.dynamicLayerInfos:0<b.length?b:this.layerObject.layerInfos},_cloneInfoTemplates:function(b){var a={},c;for(c in b)if(b.hasOwnProperty(c)&&"function"!==typeof b[c]){var e=b[c];e.infoTemplate&&e.infoTemplate.toJson&&(a[c]={infoTemplate:new e.infoTemplate.constructor(e.infoTemplate.toJson()),layerUrl:e.layerUrl,resourceInfo:e.resourceInfo})}return a},_initControlPopup:function(){this.controlPopupInfo={enablePopup:void 0,infoTemplates:this._cloneInfoTemplates(this.layerObject.infoTemplates)};
this.layerObject._infoTemplates=this._cloneInfoTemplates(this.layerObject.infoTemplates);m.after(this.layerObject,"setInfoTemplates",t.hitch(this,function(){this.layerObject._infoTemplates=this._cloneInfoTemplates(this.layerObject.infoTemplates);this.controlPopupInfo.infoTemplates=this._cloneInfoTemplates(this.layerObject.infoTemplates);this.traversal(function(b){b._afterSetInfoTemplates&&b._afterSetInfoTemplates()})}))},_initSubLayerIdent:function(){this._sublayerIdent={definitions:{},empty:!0,defLoad:new v}},
_initSubLayerVisible:function(b){this._subLayerVisible={};for(var a=0;a<this._jsapiLayerInfos.length;a++)this._subLayerVisible[this._jsapiLayerInfos[a].id]=!1;b?g.forEach(b,function(a){this._subLayerVisible[a]=!0},this):this.originOperLayer.visibleLayers?g.forEach(this.originOperLayer.visibleLayers,function(a){this._subLayerVisible[a]=!0},this):g.forEach(this._jsapiLayerInfos,function(a){a.defaultVisibility&&(this._subLayerVisible[a.id]=!0)},this)},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},
_setTopLayerVisible:function(b){this.originOperLayer.layerObject.setVisibility(b);this._visible=b},_setSubLayerVisible:function(b){var a=[-1,-1,-1],c,e=[],f=g.filter(this.originOperLayer.layerObject.visibleLayers,function(a){return-1!==a});g.forEach(f,function(a){if(!this._isGroupLayerBySubId(a)){var b=this._subLayerInfoIndex[a];b&&b._isAllSubLayerVisibleOnPath()&&e.push(a)}},this);var f=e,k;for(k in b)if(b.hasOwnProperty(k)&&"function"!==typeof b[k]){var m=Number(k);b[k]?(c=g.indexOf(f,m),0>c&&f.push(m)):
(c=g.indexOf(f,m),0<=c&&f.splice(c,1))}a=a.concat(f);this.originOperLayer.layerObject.setVisibleLayers(a)},_resetLayerObjectVisiblity:function(b){var a=b?b[this.id]:null,c=!1;if(b&&(a&&this.layerObject.setVisibility(a.visible),"esri.layers.ArcGISDynamicMapServiceLayer"===this.layerObject.declaredClass)){var a={},e;for(e in b)b.hasOwnProperty(e)&&"function"!==typeof b[e]&&(c=!0,a[e]=b[e].visible);c&&this._setSubLayerVisibleByCheckedInfo(a)}},_setSubLayerVisibleByCheckedInfo:function(b){var a=[];g.forEach(this._jsapiLayerInfos,
function(c){var f=this.id+"_"+c.id;e.isDefined(b[f])?b[f]&&a.push(c.id):this._subLayerVisible[c.id]&&a.push(c.id)},this);this._initSubLayerVisible(a);this.traversal(function(a){a._initVisible()});var c={};this.traversal(function(a){0===a.getSubLayers().length&&(c[a.originOperLayer.mapService.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(c)},_subLayerVisibleChanged:function(){var b=[];this.traversal(function(a){b.push(a)});u.publish("layerInfos/layerInfo/visibleChanged",b)},obtainNewSubLayers:function(){var b=
[],a=this.originOperLayer.layerObject,c=null,c="esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass?"dynamic":"tiled";g.forEach(this._jsapiLayerInfos,function(e){var f=null,f=a.url+"/"+e.id,g=a.id+"_"+e.id;e.subLayerIds&&0<e.subLayerIds.length?(f={url:f,empty:!0},this._addNewSubLayer(b,f,g,e,c+"_group")):(f={url:f,empty:!0},this._addNewSubLayer(b,f,g,e,c))},this);var e=[];g.forEach(this._jsapiLayerInfos,function(a,c){a=a.parentLayerId;if(-1!==a){for(var e=null,f=0;f<b.length;f++)if(b[f].mapService.subId===
a){e=b[f];break}(a=e)&&a.subLayers.push(b[c])}},this);g.forEach(this._jsapiLayerInfos,function(a,c){-1===a.parentLayerId&&(a=this._layerInfoFactory.create(b[c]),e.push(a),a.init())},this);return e},_addNewSubLayer:function(b,a,c,e,f){var g=e.source&&e.source.mapLayerId;if(void 0===g||null===g)g=e.id;b.push({layerObject:a,title:e.name||e.id||" ",id:c||"-",subId:e.id,subLayers:[],mapService:{layerInfo:this,subId:e.id,mapServiceSubId:g},selfType:"mapservice_"+f,parentLayerInfo:this})},_handleErrorSubLayer:function(b,
a,c,e,f,g){b[a]={layerObject:null,title:g.name||g.id||" ",id:c||" ",subLayers:[],mapService:{layerInfo:this,subId:e}}},getLegendInfo:function(b){var a=new v;this._legendInfo?a.resolve(this._legendInfo):this._legendRequest(b).then(t.hitch(this,function(b){this._legendInfo=b.layers;a.resolve(this._legendInfo)}),function(){a.reject()});return a},_legendRequest:function(b){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(b)},_legendRequestServer:function(){var b=
this.layerObject.url+"/legend",a={f:"json"};this.layerObject._params.dynamicLayers&&(a.dynamicLayers=n.stringify(this._createDynamicLayers(this.layerObject)),"[{}]"===a.dynamicLayers&&(a.dynamicLayers="[]"));return f({url:b,content:a,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(b){return f({url:b+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(b){var a=[],c;g.forEach(b.dynamicLayerInfos||
b.layerInfos,function(e){c={id:e.id};c.source=e.source&&e.source.toJson();var f;b.layerDefinitions&&b.layerDefinitions[e.id]&&(f=b.layerDefinitions[e.id]);f&&(c.definitionExpression=f);var g;b.layerDrawingOptions&&b.layerDrawingOptions[e.id]&&(g=b.layerDrawingOptions[e.id]);g&&(c.drawingInfo=g.toJson());c.minScale=e.minScale||0;c.maxScale=e.maxScale||0;a.push(c)});return a},_getServiceDefinition:function(){var b=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(b)},
_getSubserviceDefinition:function(b){return 10.11<=this.layerObject.version?this._getAllLayerAndTable(b):this._getLayerAndTable(b)},_getAllLayerAndTable:function(b){var a=this.layerObject.url+"/layers",c=this._serviceDefinitionBuffer.getRequest("_all_layer_and_table_request");c.isResolved()||c.request(a).then(t.hitch(this,function(a){a||(a={layers:[]});this.traversal(t.hitch(this,function(b){if(!b.isRootLayer()){var c=b.originOperLayer.mapService.mapServiceSubId;b=this._serviceDefinitionBuffer.getRequest(c);
var e=null;g.some(a.layers,function(a){if(a.id===c)return e=a,!0},this);b.setResponse(e)}}))}));return this._serviceDefinitionBuffer.getRequest(b).fakeRequest()},_getLayerAndTable:function(b){var a=this.layerObject.url+"/"+b;return this._serviceDefinitionBuffer.getRequest(b).request(a)},_getSublayerSettingOfWebmap:function(b){var a=g.filter(this.originOperLayer.layers,function(a){return a.id===b});return 1===a.length?a[0]:null},_getSublayerShowLegendOfWebmap:function(b){return(b=this._getSublayerSettingOfWebmap(b))?
void 0!==b.showLegend?b.showLegend:!0:!0},_idIsInJsapiLayerInfos:function(b){return null===this._getJsapiLayerInfoById(b)?!1:!0},_getJsapiLayerInfoById:function(b){for(var a=null,c=0;c<this._jsapiLayerInfos.length;c++)if(this._jsapiLayerInfos[c].id===b){a=this._jsapiLayerInfos[c];break}return a},_isGroupLayerBySubId:function(b){return(b=this._getJsapiLayerInfoById(b))&&b.subLayerIds&&0<b.subLayerIds.length?!0:!1},_bindEvent:function(){var b;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&
(b=this.layerObject.on("visible-layers-change",t.hitch(this,this._onVisibleLayersChanged)),this._eventHandles.push(b),b=m.after(this.layerObject,"setLayerDefinitions",t.hitch(this,this._onFilterChanged)),this._eventHandles.push(b))},_onVisibleLayersChanged:function(b){var a=b.visibleLayers;if(-1===a[0]&&-1===a[1]&&-1===a[2])this._subLayerVisibleChanged(),this._isShowInMapChanged2();else{b=[];var c=[-1,-1,-1],a=this._converVisibleLayers(a);b=a.visibleLayersForUpdateSubLayerVisible;c=c.concat(a.visibleLayersForSetVisibleLayers);
this._initSubLayerVisible(b);this.traversal(function(a){a._initVisible()});this.layerObject.setVisibleLayers(c)}},_converVisibleLayers:function(b){var a={visibleLayersForUpdateSubLayerVisible:[],visibleLayersForSetVisibleLayers:[]};g.forEach(b,function(a){var c=this.findLayerInfoById(this.id+"_"+a);if(this._isGroupLayerBySubId(a))c.traversal(function(a){b.push(a.originOperLayer.mapService.subId)});else for(;c&&c.originOperLayer.mapService;)b.push(c.originOperLayer.mapService.subId),c=c.parentLayerInfo},
this);g.forEach(b,function(b){0<=b&&0>a.visibleLayersForUpdateSubLayerVisible.indexOf(b)&&a.visibleLayersForUpdateSubLayerVisible.push(b)},this);g.forEach(a.visibleLayersForUpdateSubLayerVisible,function(b){this._isGroupLayerBySubId(b)||a.visibleLayersForSetVisibleLayers.push(b)},this);return a},_onFilterChanged:function(){for(var b,a=[],c=this.layerObject.layerDefinitions,e=c.length>this._oldFilter.length?c.length:this._oldFilter.length,f=0;f<e;f++)(c[f]?c[f]:null)!==(this._oldFilter[f]?this._oldFilter[f]:
null)&&(b=this.findLayerInfoById(this.id+"_"+f))&&b.isLeaf()&&a.push(b);0<a.length&&(u.publish("layerInfos/layerInfo/filterChanged",a,t.getObject("_wabProperties.objectPassWithFilterChangeEvent",!0,this.layerObject)),this._oldFilter=c,t.setObject("_wabProperties.objectPassWithFilterChangeEvent",{},this.layerObject))}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/topic ./LayerInfo ./LayerInfoForDefault jimu/utils dojo/Deferred esri/lang".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p(u,{constructor:function(){},_getExtentAsync:function(){var a=this.layerObject.getLayers(),b=null,e=null;if(0<a.length&&"esri.layers.KMLLayer"===a[0].declaredClass){var k=[];this.traversal(t.hitch(this,function(a){a.id!==this.id&&"esri.layers.KMLLayer"===a.layerObject.declaredClass&&k.push(a)}));g.forEach(k,function(a){e=a._getExtentAsync();b=b?b.union(e):e},this)}else g.forEach(a,function(a){e=f.graphicsExtent(a.graphics);b=b?b.union(e):e},this);return b},
_getExtent:function(){var a=new e;a.resolve(this._getExtentAsync());return a},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null;if(b){var e={},f;for(f in a)a.hasOwnProperty(f)&&"function"!==typeof a[f]&&(e[f]=a[f].visible);this._setSubLayerVisibleByCheckedInfo(e);this._setTopLayerVisible(b.visible)}},_setSubLayerVisibleByCheckedInfo:function(a){this.traversal(t.hitch(this,function(c){b.isDefined(a[c.id])&&c._setTopLayerVisible(a[c.id])}))},_initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},
_setTopLayerVisible:function(a){a?this.layerObject.show():this.layerObject.hide()},obtainNewSubLayers:function(){var a=[];g.forEach(this._getOperLayerByParentFolderId(-1,this),function(b){b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_getOperLayerByParentFolderId:function(a,b){var c=[],e=this.layerObject.getLayers()||[],f=g.filter(this.layerObject.folders||[],function(b){return b.parentFolderId===a?!0:!1}),k=[],k=0===f.length?g.filter(e,function(a){return this._flag.kmzSubLayersWereHandled?
!1:!0},this):f;g.forEach(k,function(a){var e;"esri.layers.KMLFolder"===a.declaredClass?e={layerObject:a,title:a.label||a.title||a.name||"\x26lt;no name\x26gt;",id:this._getSubLayerInfoIdForSubFolder(a),subId:a.id,kml:{layerInfo:this,currentFolder:a},selfType:"kml",parentLayerInfo:b}:"esri.layers.KMLLayer"===a.declaredClass?(e=t.getObject("linkInfo.name",!1,a),e={layerObject:a,title:a.label||a.title||e||a.name||a.id||" ",id:a.id||"-",subId:a.id||"-",kml:{layerInfo:this,currentFolder:null},selfType:"kml",
parentLayerInfo:b},t.setObject("_wabProperties.kmllayerWasHandled",!0,a),this._flag.kmzSubLayersWereHandled=!0):(t.setObject("_wabProperties.kmllayerWasHandled",!0,a),t.setObject("_wabProperties.isTemporaryLayer",!0,a));e&&c.push(e)},this);return c},_getAllSubLayerObject:function(){var a=[];this.traversal(t.hitch(this,function(b){b.layerObject&&b.layerObject.getLayers&&(a=a.concat(b.layerObject.getLayers()))}));return a},_getSubLayerInfoIdForSubFolder:function(a){return this.id+"_folder_"+a.id},_needToRenew:function(){return g.some(this._getAllSubLayerObject(),
function(a){if(!t.getObject("_wabProperties.kmllayerWasHandled",!1,a))return!0},this)},_bindEvent:function(){var a;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(a=n.after(this.layerObject,"setFolderVisibility",t.hitch(this,this._onSubFolderVisibleChanged),!0),this._eventHandles.push(a))},_onSubFolderVisibleChanged:function(a){a=this._getSubLayerInfoIdForSubFolder(a);(a=this.findLayerInfoById(a))&&m.publish("layerInfos/layerInfo/visibleChanged",[a])}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/aspect jimu/portalUrlUtils jimu/portalUtils jimu/utils esri/symbols/jsonUtils esri/layers/LabelLayer esri/layers/LabelClass esri/dijit/PopupTemplate esri/dijit/Legend esri/graphic esri/geometry/Point esri/tasks/query esri/tasks/RelationshipQuery esri/tasks/QueryTask".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I){return p(m,{_legendsNode:null,controlPopupInfo:null,constructor:function(){this._initControlPopup();this._updateLayerObjectName();try{this._initToShowLabels()}catch(K){console.warn(K.message)}},_updateLayerObjectName:function(){this.layerObject&&!this.layerObject.empty&&this.layerObject.name&&!t.getObject("_wabProperties.originalLayerName",!1,this.layerObject)&&(t.setObject("_wabProperties.originalLayerName",this.layerObject.name,this.layerObject),
this.layerObject.name=this.title,t.setObject("arcgisProps.title",this.title,this.layerObject))},_initToShowLabels:function(){var a=t.getObject("_wabProperties.itemLayerInfo",!1,this.layerObject);a&&!this.layerObject.empty&&c.getPortal(a.portalUrl).getItemData(a.itemId).then(t.hitch(this,function(a){var b;a&&a.layers&&(g.some(a.layers,function(a){return a.id===this.layerObject.layerId?(b=a,!0):!1},this),b&&b.showLabels&&((a=t.getObject("layerDefinition.drawingInfo.labelingInfo",!1,b))&&!this.layerObject.labelingInfo&&
this.layerObject.setLabelingInfo&&(a=g.map(a,function(a){return new C(a)},this),this.layerObject.setLabelingInfo(a)),this.showLabels()))}),t.hitch(this,function(a){a&&a.message&&console.log(a.message)}))},_initOldFilter:function(){this._oldFilter=this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},_getLayerOptionsForCreateLayerObject:function(){var a={};a.id=this.id;var b=[],c=this.getInfoTemplate();c&&c.info&&c.info.fieldInfos?
g.forEach(c.info.fieldInfos,function(a){a.visible&&b.push(a.fieldName)},this):b=["*"];a.outFields=b;return a},_getExtent:function(){var a=new v,b;b=this.layerObject.graphics&&0<this.layerObject.graphics.length?x.graphicsExtent(this.layerObject.graphics):this.layerObject.fullExtent||this.layerObject.initialExtent;this.layerObject.url?this.getServiceDefinition().then(t.hitch(this,function(c){var e=new I(this.layerObject.url),f=new F,g=this.getFilter();f.where=g?g:"1\x3d1";f.outSpatialReference=this.map.spatialReference;
f.returnGeometry=!0;c&&c.advancedQueryCapabilities&&c.advancedQueryCapabilities.supportsReturningQueryExtent?e.executeForExtent(f,t.hitch(this,function(b){var c=b.extent;1===b.count&&"esriGeometryPoint"===this.layerObject.geometryType&&(b=new G(b.extent.xmin,b.extent.ymin,b.extent.spatialReference),c=x.graphicsExtent([new B(b)]));a.resolve(c)}),t.hitch(this,function(){a.resolve(b);console.log("executeForExtent failed.")})):this.getSupportTableInfo().then(t.hitch(this,function(c){c.isSupportQuery?
e.execute(f).then(t.hitch(this,function(b){b=x.graphicsExtent(b.features);a.resolve(b)}),t.hitch(this,function(){a.resolve(b);console.log("query execute failed.")})):a.resolve(b)}))})):a.resolve(b);return a},_resetLayerObjectVisiblity:function(a){a=a?a[this.id]:null;!this.originOperLayer.collection&&a&&(this.layerObject.setVisibility(a.visible),this._visible=this.layerObject.visible)},_initVisible:function(){var a=!1;if(this.originOperLayer.collection&&this._notFirstInitVisilbeFlag){var a=this.originOperLayer.collection.layerInfo,
b=this.layerObject.visible;if(a._oldIsShowInMap!==a.isShowInMap())return;this._visible=b?!0:!1;a._onVisibilityChanged()}else this._visible=a=this.originOperLayer.layerObject.visible;this._notFirstInitVisilbeFlag=!0},_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=!0):(this.layerObject.hide(),this._visible=
!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},_prepareCheckedInfoForShowOrHide:function(a){for(var b={},c=this;c.parentLayerInfo;)b[c.id]=a,c=c.parentLayerInfo;return b},show:function(){if(this.isRootLayer())this._setTopLayerVisible(!0);else{var a=this.getRootLayerInfo();if(a._setSubLayerVisibleByCheckedInfo){var b=this._prepareCheckedInfoForShowOrHide(!0);
a._setSubLayerVisibleByCheckedInfo(b);a.show()}}},_initControlPopup:function(){this.controlPopupInfo={enablePopup:this.layerObject.infoTemplate?!0:!1,infoTemplate:this.layerObject.infoTemplate};this.layerObject._infoTemplate=this.layerObject.infoTemplate;var a=b.after(this.layerObject,"setInfoTemplate",t.hitch(this,function(){this.layerObject._infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.infoTemplate=this.layerObject.infoTemplate;this.controlPopupInfo.enablePopup||(this.layerObject.infoTemplate=
null)}));this._eventHandles.push(a)},_getServiceDefinition:function(){var a;(a=this.getUrl())&&this.isRootLayer()&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass?a=this._serviceDefinitionBuffer.getRequest(this.subId).request(a):(a=new v,a.resolve(null));return a},createLegendsNode:function(){var a=k.create("div",{"class":"legends-div jimu-legends-div-flag jimu-leading-margin1",legendsDivId:this.id},document.body);k.create("img",{"class":"legends-loading-img",src:require.toUrl("jimu")+
"/images/loading.gif"},a);return a},drawLegends:function(a){this._initLegendsNodeByLegendDijit(a)},_initLegendsNodeByLegendDijit:function(a){if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length)&&this.layerObject.loaded){k.empty(a);e.remove(a,"jimu-legends-div-flag");var b=new E({map:this.map,layerInfos:[{layer:this.layerObject}],arrangement:E.ALIGN_LEFT,respectCurrentMapScale:!1,respectVisibility:!1},k.create("div",{},a));b.startup();
a._legendDijit=b}},_initLegendsNode:function(a){var b=[],c=this.layerObject;!this.layerObject||this.layerObject.empty||this.originOperLayer.subLayer&&0!==this.originOperLayer.subLayers.length||(k.empty(a),c.renderer&&(c.renderer.infos?b=t.clone(c.renderer.infos):b.push({label:c.renderer.label,symbol:c.renderer.symbol}),c.renderer&&c.renderer.defaultSymbol&&0<b.length&&b.push({label:c.renderer.defaultLabel||"others",symbol:c.renderer.defaultSymbol}),g.forEach(b,function(b){b.legendDiv=k.create("div",
{"class":"legend-div"},a);b.symbolDiv=k.create("div",{"class":"legend-symbol jimu-float-leading"},b.legendDiv);b.labelDiv=k.create("div",{"class":"legend-label jimu-float-leading",innerHTML:b.label||" "},b.legendDiv);if("textsymbol"===b.symbol.type)f.set(b.symbolDiv,"innerHTML",b.symbol.text);else{var c=u.createSurface(b.symbolDiv,50,50);b=w.getShapeDescriptors(b.symbol);c.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).setTransform(u.matrix.translate(25,25))}},this)))},obtainNewSubLayers:function(){var a=
[];g.forEach(this.originOperLayer.subLayers,function(b){b.parentLayerInfo=this;b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);return a},_isAllSubLayerVisibleOnPath:function(){for(var a=!0,b=this;!b.isRootLayer();)a=a&&b.isVisible(),b=b.parentLayerInfo;return a},_getCustomPopupInfo:function(a,b){var c=null;a&&a.fields&&(c={title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]},g.forEach(a.fields,function(a){var e=!1;b?g.some(b,t.hitch(this,function(b){return b&&
a.name.toLowerCase()===b.toLowerCase()}))&&(e=!0):e=!0;e&&(e=x.getDefaultPortalFieldInfo(a),e.visible=!0,e.isEditable=a.editable,c.fieldInfos.push(e))},this));return c},_getDefaultPopupInfo:function(a){if(a=this._getCustomPopupInfo(a))a.fieldInfos=g.filter(a.fieldInfos,t.hitch(this,function(a){a=a.fieldName.toLowerCase();return 0>a.indexOf("object")&&0>a.indexOf("globalid")&&0>a.indexOf("shape")&&0>a.indexOf("perimeter")?!0:!1}));return a},_getDefaultPopupTemplate:function(a){var b=null;(a=this.getPopupInfo()||
this._getDefaultPopupInfo(a))&&(b=new z(a));return b},enablePopup:function(){return this.loadInfoTemplate().then(t.hitch(this,function(){return this.controlPopupInfo.infoTemplate?(this.controlPopupInfo.enablePopup=!0,this.layerObject.infoTemplate=this.controlPopupInfo.infoTemplate,!0):!1}))},disablePopup:function(){this.controlPopupInfo.enablePopup=!1;this.layerObject.infoTemplate=null},isPopupEnabled:function(){return this.controlPopupInfo&&this.controlPopupInfo.enablePopup?!0:!1},loadInfoTemplate:function(){var a=
new v;this.controlPopupInfo.infoTemplate?a.resolve(this.controlPopupInfo.infoTemplate):this.getLayerObject().then(t.hitch(this,function(){this.controlPopupInfo.infoTemplate=this._getDefaultPopupTemplate(this.layerObject);a.resolve(this.controlPopupInfo.infoTemplate)}),t.hitch(this,function(){a.resolve(null)}));return a},getInfoTemplate:function(){return this.controlPopupInfo.infoTemplate},_getRelatedUrls:function(a,b){var c=[];if(!a||!a.url||!a.relationships)return c;var e=a.url.lastIndexOf("/"),
f=a.url.slice(0,e);g.forEach(a.relationships,function(a){b&&a.role&&"esriRelCardinalityManyToMany"!==a.cardinality&&b!==a.role||c.push(f+"/"+a.relatedTableId.toString())},this);return c},getRelatedTableInfoArray:function(b){var c=[],e=new v;this.getLayerObject().then(t.hitch(this,function(f){var k=this._getRelatedUrls(f,b);0!==k.length&&this._getLayerInfosObj().traversalAll(t.hitch(this,function(b){var e=-1;if(0===k.length)return!0;g.forEach(k,function(f,g){t.getObject("layerObject.url",!1,b)&&a.removeProtocol(f.toString().toLowerCase()).replace(/\/+/g,
"/")===a.removeProtocol(b.layerObject.url.toString().toLowerCase()).replace(/\/+/g,"/")&&(c.push(b),e=g)},this);0<=e&&k.splice(e,1);return!1}));e.resolve(c)}),t.hitch(this,function(){e.resolve(c)}));return e},_getOrderByFields:function(a){var b=null;if(void 0===a||null===a)return b;var c=this.getPopupInfo();c&&c.relatedRecordsInfo&&c.relatedRecordsInfo.orderByFields&&g.some(c.relatedRecordsInfo.orderByFields,function(c){var e=c.field.split("/");if(e[1]===a.toString())return b=[e[2]+" "+c.order],!0},
this);return b},_getOriRelationshipByDestLayer:function(a,b){var c=null;g.some(a.relationships,function(a){if(a.relatedTableId===b.layerId)return c=a,!0},this);return c},getRelatedRecords:function(a,b){var c=new v,e=new D,f=this.getLayerObject(),g=b.getLayerObject();n({originalLayerObject:f,relatedLayerObject:g}).then(t.hitch(this,function(f){f.originalLayerObject&&f.relatedLayerObject||c.resolve([]);f=this._getOriRelationshipByDestLayer(this.layerObject,f.relatedLayerObject);e.outFields=["*"];e.relationshipId=
f&&f.id;var g=a.attributes[this.layerObject.objectIdField];e.objectIds=[g];e.definitionExpression=b.getFilter();e.orderByFields=this._getOrderByFields(f&&f.id);this.layerObject.queryRelatedFeatures(e,t.hitch(this,function(a){(a=a[g]&&a[g].features)?c.resolve(a):c.resolve([])}),t.hitch(this,function(){c.resolve([])}))}));return c},getFilter:function(){return this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?this.layerObject.getDefinitionExpression():null},setFilter:function(a,
b){this.layerObject&&!this.layerObject.empty&&this.layerObject.setDefinitionExpression&&(b=t.mixin({},b),t.setObject("_wabProperties.objectPassWithFilterChangeEvent",b,this.layerObject),this.layerObject.setDefinitionExpression(a))},_isAlreadyInLabelLayerOfMap:function(a){var b=!1;a&&(b=g.some(a.getFeatureLayers(),function(a){return this.id===a.id},this));return b},_addToLabelLayerOfMap:function(){var a=this.getLabelLayerOfMap();a&&!this._isAlreadyInLabelLayerOfMap(a)&&(a.addFeatureLayer(this.layerObject),
this.map.removeLayer(a),this.map.addLayer(a))},_removeFromLabelLayerOfMap:function(){this.getLabelLayerOfMap().removeFeatureLayer(this.id)},_isSupportLabelControl:function(){return this.isRootLayer()&&!this.layerObject.empty&&"esri.layers.FeatureLayer"===this.layerObject.declaredClass&&this.layerObject.labelingInfo&&0<this.layerObject.labelingInfo.length?!0:!1},getLabelLayerOfMap:function(){var a;this.map._labels?a=this.map._labels:(a=this.map.getLayer("labels"),a||(a=new q({id:"labels"}),this.map.addLayer(a)));
return a},obtainLabelControl:function(){var a=this.id+"_labelLayer",b=this.map.getLayer(a);if(!b&&this._isSupportLabelControl()){var c=this.getLabelLayerOfMap();c&&this._isAlreadyInLabelLayerOfMap(c)&&(b=new q({id:a}),b.addFeatureLayer(this.layerObject),this.map.addLayer(b),this._removeFromLabelLayerOfMap())}return b?b:null},restoreLabelControl:function(){this._isSupportLabelControl()&&(this.destroyRealtedLabelLayer(),this._addToLabelLayerOfMap())},destroyRealtedLabelLayer:function(){var a=this.map.getLayer(this.id+
"_labelLayer");a&&this.map.removeLayer(a)},destroyLabelLayer:function(){this.map.getLayer(this.id)||(this._removeFromLabelLayerOfMap(),this.destroyRealtedLabelLayer())},canShowLabel:function(){return this._isSupportLabelControl()},isShowLabels:function(){var a=this.map.getLayer(this.id+"_labelLayer"),b=this.getLabelLayerOfMap();return this._isSupportLabelControl()&&(a||b&&this._isAlreadyInLabelLayerOfMap(b))?this.layerObject.showLabels:!1},showLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&
(this.map.getLayer(this.id+"_labelLayer")||this._addToLabelLayerOfMap(),this.layerObject.setShowLabels(!0))},hideLabels:function(){this._isSupportLabelControl()&&this.layerObject.setShowLabels&&this.layerObject.setShowLabels(!1)}})})},"esri/layers/LabelLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/i18n!dojo/cldr/nls/number dojo/number dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../ArcadeExpression ../core/timerUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ../renderers/SimpleRenderer ../arcadeProfiles/labelingProfile ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./GraphicsLayer ./LabelClass".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K){function J(a){return"sizeInfo"===a.type}return p(I,{declaredClass:"esri.layers.LabelLayer",constructor:function(a){this._refreshLabels=g.hitch(this,this._refreshLabels);this.id="labels";this.featureLayers=[];this._featureLayerInfos=[];this._preparedLabels=[];this._engineType="STATIC";this._mapEventHandlers=[];a&&(a.id&&(this.id=a.id),a.mode&&(this._engineType="DYNAMIC"===a.mode.toUpperCase()?"DYNAMIC":"STATIC"))},_setMap:function(a){this._mapEventHandlers.push(a.on("extent-change",
g.hitch(this,"_handleLevelChange")));var b=this.inherited(arguments);this.refresh();return b},_unsetMap:function(){var a;for(a=0;a<this._mapEventHandlers.length;a++)v.disconnect(this._mapEventHandlers[a]);this.refresh();x.clearTimeout(this._refreshHandle);this._refreshHandle=null;this.inherited(arguments)},setAlgorithmType:function(a){this._engineType=a&&"DYNAMIC"===a.toUpperCase()?"DYNAMIC":"STATIC";this.refresh()},addFeatureLayer:function(a,b,c,e){if(!this.getFeatureLayer(a.layerId)){var f=[];f.push(a.on("update-end",
g.hitch(this,"refresh")));f.push(a.on("suspend",g.hitch(this,"refresh")));f.push(a.on("resume",g.hitch(this,"refresh")));f.push(a.on("edits-complete",g.hitch(this,"refresh")));f.push(a.on("labeling-info-change",g.hitch(this,"refresh")));f.push(a.on("time-extent-change",g.hitch(this,"refresh")));f.push(a.on("show-labels-change",g.hitch(this,"refresh")));f.push(a.on("feature-reduction-change",g.hitch(this,"refresh")));this._featureLayerInfos.push({FeatureLayer:a,LabelExpressionInfo:c,LabelingOptions:e,
LabelRenderer:b,EventHandlers:f});this.featureLayers.push(a);this.refresh()}},getFeatureLayer:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return c;return null},removeFeatureLayer:function(a){var b;a=this.getFeatureLayer(a);if(void 0!==a&&(b=t.indexOf(this.featureLayers,a),-1<b)){this.featureLayers.splice(b,1);for(a=0;a<this._featureLayerInfos[b].EventHandlers.length;a++)v.disconnect(this._featureLayerInfos[b].EventHandlers[a]);this._featureLayerInfos.splice(b,
1);this.refresh()}},removeAllFeatureLayers:function(){var a;for(a=0;a<this.featureLayers.length;a++){for(var b=0;b<this._featureLayerInfos[a].EventHandlers.length;b++)v.disconnect(this._featureLayerInfos[a].EventHandlers[b]);this.featureLayers=[];this._featureLayerInfos=[]}this.refresh()},getFeatureLayers:function(){return this.featureLayers},getFeatureLayerInfo:function(a){var b,c;for(b=0;b<this.featureLayers.length;b++)if(c=this.featureLayers[b],void 0!==c&&c.id==a)return this._featureLayerInfos[b];
return null},refresh:function(){null==this._refreshHandle&&(this._refreshHandle=x.setTimeout(this._refreshLabels,x.priority.LOW))},_handleLevelChange:function(a){a.levelChange&&this.clear();this.refresh()},_refreshLabels:function(a){this._refreshHandle=null;var b,c,e,f,g,k=[],m,n="DYNAMIC"===this._engineType?new F:new D;if(this._map){n.setMap(this._map,this);this._preparedLabels=[];for(a=0;a<this.featureLayers.length;a++)if(c=this.featureLayers[a],c.visible&&c.showLabels&&c.visibleAtMapScale&&!c._suspended)if(b=
this._featureLayerInfos[a],g=this._convertOptions(null),b.LabelRenderer){if(k=c.labelingInfo)if(m=k[0])f=this._getLabelExpression(m),g=this._convertOptions(m);e=b.LabelRenderer;b.LabelExpressionInfo&&(f=b.LabelExpressionInfo);b.LabelingOptions&&(g=this._convertOptions(null),void 0!==b.LabelingOptions.pointPriorities&&(k=b.LabelingOptions.pointPriorities,g.pointPriorities="above-center"==k||"AboveCenter"==k||"esriServerPointLabelPlacementAboveCenter"==k?"AboveCenter":"above-left"==k||"AboveLeft"==
k||"esriServerPointLabelPlacementAboveLeft"==k?"AboveLeft":"above-right"==k||"AboveRight"==k||"esriServerPointLabelPlacementAboveRight"==k?"AboveRight":"below-center"==k||"BelowCenter"==k||"esriServerPointLabelPlacementBelowCenter"==k?"BelowCenter":"below-left"==k||"BelowLeft"==k||"esriServerPointLabelPlacementBelowLeft"==k?"BelowLeft":"below-right"==k||"BelowRight"==k||"esriServerPointLabelPlacementBelowRight"==k?"BelowRight":"center-center"==k||"CenterCenter"==k||"esriServerPointLabelPlacementCenterCenter"==
k?"CenterCenter":"center-left"==k||"CenterLeft"==k||"esriServerPointLabelPlacementCenterLeft"==k?"CenterLeft":"center-right"==k||"CenterRight"==k||"esriServerPointLabelPlacementCenterRight"==k?"CenterRight":"AboveRight"),void 0!==b.LabelingOptions.lineLabelPlacement&&(g.lineLabelPlacement=b.LabelingOptions.lineLabelPlacement),void 0!==b.LabelingOptions.lineLabelPosition&&(g.lineLabelPosition=b.LabelingOptions.lineLabelPosition),void 0!==b.LabelingOptions.labelRotation&&(g.labelRotation=b.LabelingOptions.labelRotation),
void 0!==b.LabelingOptions.howManyLabels&&(g.howManyLabels=b.LabelingOptions.howManyLabels));e instanceof K&&(f=this._getLabelExpression(e),e=new B(e.symbol),g=this._convertOptions(e));this._addLabels(c,e,f,g)}else if(k=c.labelingInfo)for(b=k.length-1;0<=b;b--)if(m=k[b])e=new K(m instanceof K?m.toJson():m),f=this._getLabelExpression(m),g=this._convertOptions(m),this._addLabels(c,e,f,g);f=n._process(this._preparedLabels);this.clear();this.drawLabels(this._map,f)}},drawLabels:function(a,c){this._scale=
(a.extent.xmax-a.extent.xmin)/a.width;var e;for(e=0;e<c.length;e++){var f=c[e],g=f.x,k=f.y,m=f.text,n=f.angle,q=f.layer.labelSymbol;"polyline"==f.layer.geometry.type&&f.layer.options.labelRotation&&q.setAngle(180/Math.PI*n);q.setText(m);q instanceof w&&(m=q.getHeight(),g-=.25*m*this._scale*Math.sin(n),k-=.33*m*this._scale);n=new b(new z(g,k,a.extent.spatialReference));n.setParentGraphic(f.layer.graphic);n.setSymbol(q);this.add(n)}},_addLabels:function(a,b,c,e){var f,g,k,m;if(this._isWithinScaleRange(b.minScale,
b.maxScale)&&c&&""!==c){var n=this._map,q=!a.url&&!n.spatialReference.equals(a.spatialReference);for(f=0;f<a.graphics.length;f++)if(g=a.graphics[f],!1!==g.visible&&!g._suspended){k=g.geometry;if(q){if(!E.canProject(k,n))continue;k=E.project(k,n)}k&&this._isWhere(b.where,g.attributes)&&this._isWithinScreenArea(k)&&(m=this._buildLabelText(c,g,a.fields,e),this._addLabel(m,b,a.renderer,g,e,k,n))}}},_isWithinScreenArea:function(a){a="point"===a.type?new C(a.x,a.y,a.x,a.y,a.spatialReference):a.getExtent();
if(void 0===a)return!1;a=this._intersects(this._map,a);return null===a||0===a.length?!1:!0},_isWithinScaleRange:function(a,b){var c=this._map.getScale();return 0<a&&c>=a||0<b&&c<b?!1:!0},_isWhere:function(a,b){try{if(!a)return!0;if(a){var c=a.split(" ");if(3===c.length)return this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2]));if(7===c.length){var e=this._sqlEquation(b[this._removeQuotes(c[0])],c[1],this._removeQuotes(c[2])),f=c[3],g=this._sqlEquation(b[this._removeQuotes(c[4])],
c[5],this._removeQuotes(c[6]));switch(f){case "AND":return e&&g;case "OR":return e||g}}}return!1}catch(W){console.log("Error.: can't parse \x3d "+a)}},_sqlEquation:function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1},_removeQuotes:function(a){var b=a.indexOf('"'),c=a.lastIndexOf('"');if(-1!=b&&-1!=c)return a.substr(1,a.length-
2);b=a.indexOf("'");c=a.lastIndexOf("'");return-1!=b&&-1!=c?a.substr(1,a.length-2):a},_getSizeInfo:function(a){return a?a.sizeInfo||t.filter(a.visualVariables,J)[0]:null},_addLabel:function(a,b,c,e,f,m,n){var p,x,u,v;if(a&&""!==g.trim(a)&&b){a=a.replace(/\s+/g," ");p=b.getSymbol(e);p instanceof w?(p=new w(p.toJson()),p.setVerticalAlignment("baseline"),p.setHorizontalAlignment("center")):p=p instanceof q?new q(p.toJson()):new w;p.setText(a);b.symbol=p;if(u=this._getProportionalSize(b.sizeInfo,e.attributes))p instanceof
w?p.setSize(u):p instanceof q&&(p.setWidth(u),p.setHeight(u));v=u=0;if(c){x=c.getSymbol(e);var t=this._getSizeInfo(c);if((c=t?c.getSize(e,{sizeInfo:t,resolution:n.getResolutionInMeters()}):e.size)&&null!==c)u=v=c;else if(x)if("simplemarkersymbol"==x.type)v=u=x.size;else if("picturemarkersymbol"==x.type)u=x.width,v=x.height;else if("simplelinesymbol"==x.type||"cartographiclinesymbol"==x.type)u=x.width}c={};c.graphic=e;c.options=f;c.geometry=m;c.labelRenderer=b;c.labelSymbol=p;c.labelWidth=p.getWidth()/
2;c.labelHeight=p.getHeight()/2;c.symbolWidth=k.normalizedLength(u)/2;c.symbolHeight=k.normalizedLength(v)/2;c.text=a;c.angle=p.angle;this._preparedLabels.push(c)}},_buildLabelText:function(b,c,f,k){if(k.hasExpression)return b=G.getEvalOptions({expression:k.arcadeExpr,feature:c,layer:c.getLayer(),spatialReference:this._map.spatialReference}),c=c.evaluateExpression(k.arcadeExpr,b),e.isDefined(c)?""+c:"";var q=c.attributes;return b.replace(/{[^}]*}/g,function(b){var c,w=b;for(c=0;c<f.length;c++)if("{"+
f[c].name+"}"==b){var w=q[f[c].name],p=f[c].domain;if(p&&g.isObject(p)){if("codedValue"==p.type&&k.useCodedValues)for(c=w,b=0;b<p.codedValues.length;b++)if(p.codedValues[b].code==c){w=p.codedValues[b].name;break}break}p=f[c].type;if(k.fieldInfos){var x=k.fieldInfos;for(c=0;c<x.length;c++)if("{"+x[c].fieldName+"}"==b){b=x[c].format;"esriFieldTypeDate"==p?w=e.substitute({myKey:w},"${myKey}",{format:{myKey:g.mixin({formatType:"DateFormat"},a.prototype._dateFormatsJson[b&&b.dateFormat||"shortDate"])}}):
"esriFieldTypeInteger"!=p&&"esriFieldTypeSingle"!=p&&"esriFieldTypeSmallInteger"!=p&&"esriFieldTypeLong"!=p&&"esriFieldTypeDouble"!=p||!b||(w=m.format(w,{places:b.places}),b.digitSeparator||n.group&&(w=w.replace(new RegExp("\\"+n.group,"g"),"")));break}}break}else w="";return null==w?"":w})},_getLabelExpression:function(a){var b="";a.labelExpressionInfo?b=a.labelExpressionInfo.value||a.labelExpressionInfo.expression:this._validSyntax(a.labelExpression)&&(b=this._convertLabelExpression(a.labelExpression));
return b},_validSyntax:function(a){return/^(\s*\[[^\]]+\]\s*)+$/i.test(a)},_convertLabelExpression:function(a){return a.replace(/\[/g,"{").replace(/\]/g,"}")},_getProportionalSize:function(a,b){if(!a)return null;b=e.substitute(b,"${"+a.field+"}",{first:!0});return!(a.minSize&&a.maxSize&&a.minDataValue&&a.maxDataValue&&b)||0>=a.maxDataValue-a.minDataValue?null:(a.maxSize-a.minSize)/(a.maxDataValue-a.minDataValue)*(b-a.minDataValue)+a.minSize},_convertOptions:function(a){var b=!0,e="shortDate",f=null,
g=null,k="",m=!0,n,q;if(a&&(a.format&&(e=a.format.dateFormat,f={places:a.format.places,digitSeparator:a.format.digitSeparator}),g=a.fieldInfos,k=a.labelPlacement,null!=a.useCodedValues&&(b=a.useCodedValues),a=a.labelExpressionInfo)){var w=a.expression;w&&!a.value&&(q=!0,n=new c({expression:w,returnType:"string",profile:G}))}if("always-horizontal"==k||"esriServerPolygonPlacementAlwaysHorizontal"==k)m=!1;return{useCodedValues:b,dateFormat:e,numberFormat:f,fieldInfos:g,pointPriorities:"above-center"==
k||"esriServerPointLabelPlacementAboveCenter"==k?"AboveCenter":"above-left"==k||"esriServerPointLabelPlacementAboveLeft"==k?"AboveLeft":"above-right"==k||"esriServerPointLabelPlacementAboveRight"==k?"AboveRight":"below-center"==k||"esriServerPointLabelPlacementBelowCenter"==k?"BelowCenter":"below-left"==k||"esriServerPointLabelPlacementBelowLeft"==k?"BelowLeft":"below-right"==k||"esriServerPointLabelPlacementBelowRight"==k?"BelowRight":"center-center"==k||"esriServerPointLabelPlacementCenterCenter"==
k?"CenterCenter":"center-left"==k||"esriServerPointLabelPlacementCenterLeft"==k?"CenterLeft":"center-right"==k||"esriServerPointLabelPlacementCenterRight"==k?"CenterRight":"AboveRight",lineLabelPlacement:"above-start"==k||"below-start"==k||"center-start"==k?"PlaceAtStart":"above-end"==k||"below-end"==k||"center-end"==k?"PlaceAtEnd":"PlaceAtCenter",lineLabelPosition:"above-after"==k||"esriServerLinePlacementAboveAfter"==k||"above-along"==k||"esriServerLinePlacementAboveAlong"==k||"above-before"==k||
"esriServerLinePlacementAboveBefore"==k||"above-start"==k||"esriServerLinePlacementAboveStart"==k||"above-end"==k||"esriServerLinePlacementAboveEnd"==k?"Above":"below-after"==k||"esriServerLinePlacementBelowAfter"==k||"below-along"==k||"esriServerLinePlacementBelowAlong"==k||"below-before"==k||"esriServerLinePlacementBelowBefore"==k||"below-start"==k||"esriServerLinePlacementBelowStart"==k||"below-end"==k||"esriServerLinePlacementBelowEnd"==k?"Below":"center-after"==k||"esriServerLinePlacementCenterAfter"==
k||"center-along"==k||"esriServerLinePlacementCenterAlong"==k||"center-before"==k||"esriServerLinePlacementCenterBefore"==k||"center-start"==k||"esriServerLinePlacementCenterStart"==k||"center-end"==k||"esriServerLinePlacementCenterEnd"==k?"OnLine":"Above",labelRotation:m,howManyLabels:"OneLabel",hasExpression:q,arcadeExpr:n}}})})},"esri/layers/labelLayerUtils/DynamicLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),
function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.layers.labelLayerUtils.DynamicLabelClass",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._y1=this._x1=this._y0=this._x0=this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1},setMap:function(g,k){this._labelLayer=k;this._xmin=g.extent.xmin;this._xmax=g.extent.xmax;this._ymin=g.extent.ymin;this._ymax=g.extent.ymax;this._scale=(this._xmax-this._xmin)/g.width},_process:function(g){this._preparedLabels=
g;this._placedLabels=[];var k;for(g=this._preparedLabels.length-1;0<=g;g--){var f=this._preparedLabels[g],e=Math.min(f.labelWidth,f.labelHeight),b=f.labelWidth+0*e,e=f.labelHeight+0*e,a=(k=f.options)&&void 0!==k.lineLabelPlacement?k.lineLabelPlacement:"PlaceAtCenter",c=k&&void 0!==k.lineLabelPosition?k.lineLabelPosition:"Above",m=k&&void 0!==k.pointPriorities?k.pointPriorities:"AboveRight",n=[2,2,1,3,0,2,3,3,2];"AboveLeft"==m?n=[1,2,2,2,0,3,2,3,3]:"AboveCenter"==m?n=[2,1,2,2,0,2,3,3,3]:"AboveRight"==
m?n=[2,2,1,3,0,2,3,3,2]:"CenterLeft"==m?n=[2,2,3,1,0,3,2,2,3]:"CenterCenter"==m?n=[0,0,0,0,1,0,0,0,0]:"CenterRight"==m?n=[3,2,2,3,0,1,3,2,2]:"BelowLeft"==m?n=[2,3,3,2,0,3,1,2,2]:"BelowCenter"==m?n=[3,3,3,2,0,2,2,1,2]:"BelowRight"==m&&(n=[3,3,2,3,0,2,2,2,1]);var q=k&&void 0!==k.labelRotation?k.labelRotation:!0,m=Math.PI/180*f.angle;k=k&&void 0!==k.howManyLabels?k.howManyLabels:"OneLabel";if("point"==f.geometry.type)this._generatePointPositions(f,f.geometry.x,f.geometry.y,f.text,m,b,e,f.symbolWidth,
f.symbolHeight,n);else if("multipoint"==f.geometry.type)for(a=f.geometry,c=0;c<a.points.length;c++)this._generatePointPositions(f,a.points[c][0],a.points[c][1],f.text,m,b,e,f.symbolWidth,f.symbolHeight,n);else"polyline"==f.geometry.type?this._generateLinePositions(f,f.geometry,f.text,b,e,2*f.symbolHeight+e,a,c,q):"polygon"==f.geometry.type&&this._generatePolygonPositions(f,k,f.geometry,f.text,m,b,e)}return this._placedLabels},_generatePointPositions:function(g,k,f,e,b,a,c,m,n,q){m=(m+a)*this._scale;
n=(n+c)*this._scale;var w,p;for(w=1;3>=w;w++)for(p=1;9>=p;p++)if(q[p-1]==w)switch(p){case 1:if(this._findPlace(g,e,k-m,f+n,b,a,c))return;break;case 2:if(this._findPlace(g,e,k,f+n,b,a,c))return;break;case 3:if(this._findPlace(g,e,k+m,f+n,b,a,c))return;break;case 4:if(this._findPlace(g,e,k-m,f,b,a,c))return;break;case 5:if(this._findPlace(g,e,k,f,b,a,c))return;break;case 6:if(this._findPlace(g,e,k+m,f,b,a,c))return;break;case 7:if(this._findPlace(g,e,k-m,f-n,b,a,c))return;break;case 8:if(this._findPlace(g,
e,k,f-n,b,a,c))return;break;case 9:if(this._findPlace(g,e,k+m,f-n,b,a,c))return}},_generateLinePositions:function(g,k,f,e,b,a,c,m,n){var q=e*this._scale*e*this._scale,w,p,x;for(w=0;w<k.paths.length;w++){var u=k.paths[w],v=u.length,t=Math.floor((v-1)/2),D=0!==(v-1)%2?1:-1;"PlaceAtStart"==c&&(t=0,D=1);"PlaceAtEnd"==c&&(t=v-2,D=-1);for(;0<=t&&t<v-1;){for(p=t;p<v;p++){var I=u[t][0],K=u[t][1],J=u[p][0]-I,L=u[p][1]-K;if(J*J+L*L>q){for(var M=Math.atan2(L,J);M>Math.PI/2;)M-=Math.PI;for(;M<-(Math.PI/2);)M+=
Math.PI;var Q=Math.sin(M),S=Math.cos(M),T=0,O=0;"Above"==m&&(T=a*Q*this._scale,O=a*S*this._scale);"Below"==m&&(T=-a*Q*this._scale,O=-a*S*this._scale);if(1==p-t){if(this._clipLine(I,K,u[p][0],u[p][1])&&(I=this._x1-this._x0,x=this._y1-this._y0,I*I+x*x>q&&(p=Math.atan2(x,I),J=e/2+2*b,K=J*this._scale*Math.cos(p),J=J*this._scale*Math.sin(p),"PlaceAtStart"==c?(I=this._x0+K,x=this._y0+J):"PlaceAtEnd"==c?(I=this._x1-K,x=this._y1-J):(I=this._x0+I/2,x=this._y0+x/2),this._findPlace(g,f,I-T,x+O,n?-p:0,e,b))))return}else{var W=
0;for(x=t;x<=p;x++)W=Math.max(W,Math.abs((u[x][1]-K)*S-(u[x][0]-I)*Q));if(W<b&&this._findPlace(g,f,I+J/2-T,K+L/2+O,n?-M:0,e,b))return}break}}t+=D}}},_generatePolygonPositions:function(g,k,f,e,b,a,c){var n;if("ManyLabels"==k)for(k=0;k<f.rings.length;k++)n=f.rings[k],m.prototype.isClockwise(n)&&(n=this._findCentroid(n,this._xmin,this._ymin,this._xmax,this._ymax),this._findPlace(g,e,n[0],n[1],b,a,c));else{n=this._findCentroidForFeature(f,this._xmin,this._ymin,this._xmax,this._ymax);var w=n[1],q=0;for(k=
0;10>k;k++){q+=c/4;n=this._findCentroidForFeature(f,this._xmin,w+(q-c/4),this._xmax,w+(q+c/4));if(this._findPlace(g,e,n[0],n[1],b,a,c))break;n=this._findCentroidForFeature(f,this._xmin,w-(q+c/4),this._xmax,w-(q-c/4));if(this._findPlace(g,e,n[0],n[1],b,a,c))break}}},_findCentroid:function(g,k,f,e,b){var a=g.length,c=[0,0],m=0,n=g[0][0],q=g[0][1];n>e&&(n=e);n<k&&(n=k);q>b&&(q=b);q<f&&(q=f);for(var p=1;p<a-1;p++){var u=g[p][0],v=g[p][1],t=g[p+1][0],G=g[p+1][1];u>e&&(u=e);u<k&&(u=k);v>b&&(v=b);v<f&&(v=
f);t>e&&(t=e);t<k&&(t=k);G>b&&(G=b);G<f&&(G=f);var F=(u-n)*(G-q)-(t-n)*(v-q);c[0]+=F*(n+u+t);c[1]+=F*(q+v+G);m+=F}c[0]/=3*m;c[1]/=3*m;if(isNaN(c[0])||isNaN(c[1]))return c;f=[];this._fillBuffer(g,f,c);c[0]=this._sortBuffer(f,c[0],k,e);return c},_findCentroidForFeature:function(g,k,f,e,b){for(var a,c=0,m=[0,0],n=0;n<g.rings.length;n++){var q=g.rings[n],p=q.length,u=q[0][0],v=q[0][1];u>e&&(u=e);u<k&&(u=k);v>b&&(v=b);v<f&&(v=f);for(a=1;a<p-1;a++){var t=q[a][0],G=q[a][1],F=q[a+1][0],D=q[a+1][1];t>e&&(t=
e);t<k&&(t=k);G>b&&(G=b);G<f&&(G=f);F>e&&(F=e);F<k&&(F=k);D>b&&(D=b);D<f&&(D=f);var I=(t-u)*(D-v)-(F-u)*(G-v);m[0]+=I*(u+t+F);m[1]+=I*(v+G+D);c+=I}}m[0]/=3*c;m[1]/=3*c;if(isNaN(m[0])||isNaN(m[1]))return m;f=[];for(a=0;a<g.rings.length;a++)this._fillBuffer(g.rings[a],f,m);m[0]=this._sortBuffer(f,m[0],k,e);return m},_fillBuffer:function(g,k,f){for(var e=g.length-1,b=g[0][1]>=g[e][1]?1:-1,a=0;a<=e;a++){var c=a,m=a+1;a==e&&(m=0);var n=g[c][0],c=g[c][1],q=g[m][0],m=g[m][1],p=m>=c?1:-1;if(c<=f[1]&&f[1]<=
m||m<=f[1]&&f[1]<=c)f[1]!=c&&f[1]!=m?(k.push((f[1]-c)*(q-n)/(m-c)+n),b=p):f[1]==c&&f[1]!=m?(b!=p&&k.push(n),b=p):f[1]!=c&&f[1]==m?(k.push(q),b=p):f[1]==c&&f[1]==m&&(1==b&&k.push(n),k.push(q),b=p)}},_sortBuffer:function(g,k,f,e){var b=g.length;g.sort();if(0<b){for(var a=0,c=k=0;c<b-1;c+=2){var m=Math.abs(g[c+1]-g[c]);!(g[c]<=f&&g[c+1]<=f||g[c]>=e&&g[c+1]>=e)&&m>a&&(a=m,k=c)}b=g[k];g=g[k+1];b>e&&(b=e);b<f&&(b=f);g>e&&(g=e);g<f&&(g=f);k=(b+g)/2}return k},_findPlace:function(g,k,f,e,b,a,c){if(isNaN(f)||
isNaN(e))return!1;for(var p=0;p<this._placedLabels.length;p++){var w=this._placedLabels[p].angle,q=this._placedLabels[p].width*this._scale,u=this._placedLabels[p].height*this._scale,v=this._placedLabels[p].x-f,t=this._placedLabels[p].y-e;if(0===b&&0===w){if(this._findPlace2(-a*this._scale,-c*this._scale,a*this._scale,c*this._scale,v-q,t-u,v+q,t+u))return!1}else{var B=new n(-a*this._scale,-c*this._scale,a*this._scale,c*this._scale,null),G=0,F=1;0!==b&&(G=Math.sin(b),F=Math.cos(b));var D=v*F-t*G,v=
v*G+t*F,w=w-b,G=Math.sin(w),F=Math.cos(w),I=-q*F- -u*G,t=-q*G+-u*F,w=+q*F- -u*G,K=+q*G+-u*F,q=D+I,u=v-t,G=D+w,F=v-K,I=D-I,t=v+t,D=D-w,v=v+K,w=new m;w.addRing([[q,u],[G,F],[I,t],[D,v],[q,u]]);if(B.intersects(w))return!1}}for(;b>Math.PI/2;)b-=Math.PI;for(;b<-(Math.PI/2);)b+=Math.PI;p={};p.layer=g;p.text=k;p.angle=b;p.x=f;p.y=e;p.width=a;p.height=c;this._placedLabels.push(p);return!0},_findPlace2:function(g,k,f,e,b,a,c,m){return(g>=b&&g<=c||f>=b&&f<=c||g<=b&&f>=c)&&(k>=a&&k<=m||e>=a&&e<=m||k<=a&&e>=
m)?!0:!1},_clipLine:function(g,k,f,e){for(var b=this._code(g,k),a=this._code(f,e);0!==b||0!==a;){if(0!==(b&a))return!1;var c=f-g,m=e-k;0!==b?(g<this._xmin?(k+=m*(this._xmin-g)/c,g=this._xmin):g>this._xmax?(k+=m*(this._xmax-g)/c,g=this._xmax):k<this._ymin?(g+=c*(this._ymin-k)/m,k=this._ymin):k>this._ymax&&(g+=c*(this._ymax-k)/m,k=this._ymax),b=this._code(g,k)):(f<this._xmin?(e+=m*(this._xmin-f)/c,f=this._xmin):f>this._xmax?(e+=m*(this._xmax-f)/c,f=this._xmax):e<this._ymin?(f+=c*(this._ymin-e)/m,e=
this._ymin):e>this._ymax&&(f+=c*(this._ymax-e)/m,e=this._ymax),a=this._code(f,e))}this._x0=g;this._y0=k;this._x1=f;this._y1=e;return!0},_code:function(g,k){var f=0;g<this._xmin&&(f+=8);g>this._xmax&&(f+=4);k<this._ymin&&(f+=2);k>this._ymax&&(f+=1);return f}})})},"esri/layers/labelLayerUtils/StaticLabelClass":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),function(p,g,t,v,n,m,u){return p(null,
{declaredClass:"esri.layers.labelLayerUtils.StaticLabel",constructor:function(){this._preparedLabels=[];this._placedLabels=[];this._extent=null;this._ymax=this._ymin=this._xmax=this._xmin=0;this._scale=1;this._LINE_STEP_CONST=1.5;this._POLYGON_X_STEP_CONST=1;this._POLYGON_Y_STEP_CONST=.75;this._OVERRUN=2},setMap:function(g,f){this._labelLayer=f;this._map=g;this._xmin=g.extent.xmin;this._xmax=g.extent.xmax;this._ymin=g.extent.ymin;this._ymax=g.extent.ymax;this._scale=(this._xmax-this._xmin)/g.width},
_process:function(g){var f,e,b,a,c,k,n,q,p;this._preparedLabels=g;this._placedLabels=[];for(g=this._preparedLabels.length-1;0<=g;g--){f=this._preparedLabels[g];c=f.labelWidth;k=f.labelHeight;q=(n=f.options)&&n.lineLabelPlacement?n.lineLabelPlacement:"PlaceAtCenter";p=n&&n.lineLabelPosition?n.lineLabelPosition:"Above";e=n&&n.labelRotation?n.labelRotation:!0;b=Math.PI/180*f.angle;a=n&&n.howManyLabels?n.howManyLabels:"OneLabel";var v=[];if("point"===f.geometry.type)this._generatePointPositions(f.geometry.x,
f.geometry.y,f.text,b,c,k,f.symbolWidth,f.symbolHeight,n,v);else if("multipoint"===f.geometry.type)for(e=0;e<f.geometry.points.length;e++)this._generatePointPositions(f.geometry.points[e][0],f.geometry.points[e][1],f.text,b,c,k,f.symbolWidth,f.symbolHeight,n,v);else if("polyline"===f.geometry.type)if("PlaceAtStart"===q)this._generateLinePositionsPlaceAtStart(f.geometry,!0,f.text,c,k,2*f.symbolHeight+k,q,p,e,v);else if("PlaceAtEnd"===q)this._generateLinePositionsPlaceAtEnd(f.geometry,!0,f.text,c,k,
2*f.symbolHeight+k,q,p,e,v);else{n=[];var t=f.geometry.getExtent(),B=this._map.extent;if(t.getWidth()<c*this._scale/this._OVERRUN&&t.getHeight()<c*this._scale/this._OVERRUN)continue;else.5*t.getWidth()<B.getWidth()&&.5*t.getHeight()<B.getHeight()?this._generateLinePositionsPlaceAtCenter(f.geometry,!1,.1*Math.min(this._map.width,this._map.height)*this._scale,f.text,c,k,2*f.symbolHeight+k,q,p,e,n):this._generateLinePositionsPlaceAtCenter(f.geometry,!0,.2*Math.min(this._map.width,this._map.height)*this._scale,
f.text,c,k,2*f.symbolHeight+k,q,p,e,n);this._postSorting(B,n,v)}else if("polygon"===f.geometry.type){q=[];for(e=0;e<f.geometry.rings.length;e++)p=f.geometry.rings[e],1<f.geometry.rings.length&&!u.prototype.isClockwise(p)||(n=this._calcRingExtent(p),n.xmax-n.xmin<4*c*this._scale/this._OVERRUN&&n.ymax-n.ymin<4*k*this._scale/this._OVERRUN||q.push(p));q.sort(function(a,b){return b.length-a.length});for(e=0;e<q.length;e++)this._generatePolygonPositionsForManyLabels(q[e],f.geometry.spatialReference,f.text,
b,c,k,v)}for(e=0;e<v.length&&(q=v[e].x,p=v[e].y,void 0!==v[e].angle&&(b=v[e].angle),n=this._findPlace(f,f.text,q,p,b,c,k),"OneLabel"!==a||!n||!this._labelLayer._isWithinScreenArea(new m(q,p,f.geometry.spatialReference)));e++);}return this._placedLabels},_generatePointPositions:function(g,f,e,b,a,c,m,n,q,p){e=q&&q.pointPriorities?q.pointPriorities:"AboveRight";a=(m+a)*this._scale;c=(n+c)*this._scale;switch(e.toLowerCase()){case "aboveleft":g-=a;f+=c;break;case "abovecenter":f+=c;break;case "aboveright":g+=
a;f+=c;break;case "centerleft":g-=a;break;case "centercenter":break;case "centerright":g+=a;break;case "belowleft":g-=a;f-=c;break;case "belowcenter":f-=c;break;case "belowright":g+=a;f-=c;break;default:return}p.push({x:g,y:f})},_generateLinePositionsPlaceAtStart:function(g,f,e,b,a,c,m,n,q,p){m=b*this._scale;var k=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,w,x,u,v,t,C,K,J;for(w=0;w<g.paths.length;w++){var L=g.paths[w],M=m,Q=0;for(x=0;x<L.length-1;x++)u=L[x][0],v=
L[x][1],t=L[x+1][0],C=L[x+1][1],K=t-u,J=C-v,K=Math.sqrt(K*K+J*J),Q+K>M?(Q=this._generatePositionsOnLine(g.spatialReference,f,M,k,Q,u,v,t,C,e,b,a,c,n,q,p),M=k):Q+=K}},_generateLinePositionsPlaceAtEnd:function(g,f,e,b,a,c,m,n,q,p){m=b*this._scale;var k=this._LINE_STEP_CONST*Math.min(this._map.width,this._map.height)*this._scale,w,x,u,v,t,C,K,J;for(w=0;w<g.paths.length;w++){var L=g.paths[w],M=m,Q=0;for(x=L.length-2;0<=x;x--)u=L[x+1][0],v=L[x+1][1],t=L[x][0],C=L[x][1],K=t-u,J=C-v,K=Math.sqrt(K*K+J*J),
Q+K>M?(Q=this._generatePositionsOnLine(g.spatialReference,f,M,k,Q,u,v,t,C,e,b,a,c,n,q,p),M=k):Q+=K}},_generateLinePositionsPlaceAtCenter:function(g,f,e,b,a,c,m,n,q,p,u){var k,w,x,v,t,z,C,J;for(n=0;n<g.paths.length;n++){var L=g.paths[n];if(!(2>L.length)){if(2==L.length){v=L[0];k=L[1];x=v[0];v=v[1];L=k[0];z=k[1];t=(L-x)*(L-x)+(z-v)*(z-v);C=Math.atan2(z-v,L-x);z=Math.cos(C);C=Math.sin(C);L=[];J=x;for(var M=v;(J-x)*(J-x)+(M-v)*(M-v)<t;)L.push([J,M]),J+=e/2*z,M+=e/2*C;L.push(k)}var Q=0;for(k=0;k<L.length-
1;k++)x=L[k][0],v=L[k][1],t=L[k+1][0],z=L[k+1][1],C=t-x,J=z-v,Q+=Math.sqrt(C*C+J*J);for(k=M=0;k<L.length-1;k++){x=L[k][0];v=L[k][1];t=L[k+1][0];z=L[k+1][1];C=t-x;J=z-v;C=Math.sqrt(C*C+J*J);if(M+C>Q/2)break;M+=C}k==L.length-1&&k--;x=L[k][0];v=L[k][1];t=L[k+1][0];z=L[k+1][1];C=t-x;J=z-v;M=Q/2-M;C=Math.atan2(J,C);J=x+M*Math.cos(C);C=v+M*Math.sin(C);x=this._angleAndShifts(x,v,t,z,m,q,p);u.push({x:J+x.shiftX,y:C+x.shiftY,angle:x.angle});var Q=J,S=C,M=0;for(w=k;w<L.length-1;w++)w==k?(x=Q,v=S):(x=L[w][0],
v=L[w][1]),t=L[w+1][0],z=L[w+1][1],C=t-x,J=z-v,C=Math.sqrt(C*C+J*J),M=M+C>e?this._generatePositionsOnLine(g.spatialReference,f,e,e,M,x,v,t,z,b,a,c,m,q,p,u):M+C;M=0;for(w=k;0<=w;w--)w==k?(x=Q,v=S):(x=L[w+1][0],v=L[w+1][1]),t=L[w][0],z=L[w][1],C=t-x,J=z-v,C=Math.sqrt(C*C+J*J),M=M+C>e?this._generatePositionsOnLine(g.spatialReference,f,e,e,M,x,v,t,z,b,a,c,m,q,p,u):M+C}}},_generatePositionsOnLine:function(g,f,e,b,a,c,m,w,q,p,u,v,t,G,F,D){p=Math.atan2(q-m,w-c);u=c;v=m;var k=u,x=v;do if(a=e-a,u+=a*Math.cos(p),
v+=a*Math.sin(p),this._belongs(u,v,c,m,w,q))a=this._angleAndShifts(c,m,w,q,t,G,F),e=u+a.shiftX,x=v+a.shiftY,f?this._labelLayer._isWithinScreenArea(new n(e,x,e,x,g))&&D.push({x:e,y:x,angle:a.angle}):D.push({x:e,y:x,angle:a.angle}),k=u,x=v,a=0,e=b;else return g=w-k,q-=x,Math.sqrt(g*g+q*q);while(1)},_postSorting:function(g,f,e){if(g&&0<f.length){var b=.5*(g.xmin+g.xmax);g=.5*(g.ymin+g.ymax);for(var a=f[0].x,c=f[0].y,k=Math.sqrt((a-b)*(a-b)+(c-g)*(c-g)),m=f[0].angle,n=0;n<f.length;n++){var p=f[n].x,u=
f[n].y,v=Math.sqrt((p-b)*(p-b)+(u-g)*(u-g));v<k&&(a=p,c=u,k=v,m=f[n].angle)}e.push({x:a,y:c,angle:m})}},_belongs:function(g,f,e,b,a,c){if(a==e&&c==b)return!1;if(a>e){if(g>a||g<e)return!1}else if(g<a||g>e)return!1;if(c>b){if(f>c||f<b)return!1}else if(f<c||f>b)return!1;return!0},_angleAndShifts:function(g,f,e,b,a,c,m){for(g=Math.atan2(b-f,e-g);g>Math.PI/2;)g-=Math.PI;for(;g<-(Math.PI/2);)g+=Math.PI;b=Math.sin(g);var k=Math.cos(g);e=f=0;"Above"==c&&(f=a*b*this._scale,e=a*k*this._scale);"Below"==c&&(f=
-a*b*this._scale,e=-a*k*this._scale);a=[];a.angle=m?-g:0;a.shiftX=-f;a.shiftY=e;return a},_generatePolygonPositionsForManyLabels:function(g,f,e,b,a,c,m){a=this._findCentroidForRing(g);b=a[0];var k=a[1],n=this._calcRingExtent(g);a=n.xmin;c=n.ymin;var p=n.xmax,n=n.ymax,x=(n-c)/(this._map.height*this._scale);if(!(10<(p-a)/(this._map.width*this._scale)&&10<x)){var u=!0;if(p-a>this._map.width*this._scale||n-c>this._map.height*this._scale)u=!1;var x=this._map.width*this._scale*(u?.1875:.5),u=this._map.height*
this._scale*(u?.1875:.5),v=!0,t=!0,F=0;do{k+=(F%2?-1:1)*F*u;if(this._scanRingByX(e,f,g,b,k,a,p,x,m))break;k<c&&(v=!1);k>n&&(t=!1);F++}while(v||t)}},_scanRingByX:function(g,f,e,b,a,c,m,w,q){var k=!0,p=!0,x=0,u=1E3;do{b+=(x%2?-1:1)*x*w;var v=this._movePointInsideRing(e,b,a),t=this._labelLayer._isWithinScreenArea(new n(v,a,v,a,f)),D=this._isPointWithinRing(g,e,v,a);if(t&&D)return q.push({x:v,y:a}),!0;b<c&&(k=!1);b>m&&(p=!1);x++;u--;if(0>=u)return!0}while(k||p);return!1},_movePointInsideRing:function(g,
f,e){for(var b=[],a=g.length-1,c=g[0][1]>=g[a][1]?1:-1,k=0;k<=a;k++){var m=k,n=k+1;k==a&&(n=0);var p=g[m][0],m=g[m][1],u=g[n][0],n=g[n][1],v=n>=m?1:-1;if(m<=e&&e<=n||n<=e&&e<=m)e!=m&&e!=n?(b.push((e-m)*(u-p)/(n-m)+p),c=v):e==m&&e!=n?(c!=v&&b.push(p),c=v):e!=m&&e==n?(b.push(u),c=v):e==m&&e==n&&(1==c&&b.push(p),b.push(u),c=v)}b.sort(function(a,b){return a-b});g=b.length;if(0<g){for(k=e=f=0;k<g-1;k+=2)a=Math.abs(b[k+1]-b[k]),a>f&&(f=a,e=k);f=(b[e]+b[e+1])/2}return f},_calcRingExtent:function(g){var f,
e;e=new n;for(f=0;f<g.length-1;f++){var b=g[f][0],a=g[f][1];if(void 0===e.xmin||b<e.xmin)e.xmin=b;if(void 0===e.ymin||a<e.ymin)e.ymin=a;if(void 0===e.xmax||b>e.xmax)e.xmax=b;if(void 0===e.ymax||a>e.ymax)e.ymax=a}return e},_isPointWithinPolygon:function(g,f,e,b){var a;for(a=0;a<f.rings.length;a++)if(this._isPointWithinRing(g,f.rings[a],e,b))return!0;return!1},_isPointWithinRing:function(g,f,e,b){var a,c,k,m,n=[],p=f.length;for(g=0;g<p-1;g++)if(a=f[g][0],c=f[g][1],k=f[g+1][0],m=f[g+1][1],a!=k||c!=m){if(c==
m)if(b==c)n.push(a);else continue;a==k?(c<m&&b>=c&&b<m&&n.push(a),c>m&&b<=c&&b>m&&n.push(a)):(c=(k-a)/(m-c)*(b-c)+a,a<k&&c>=a&&c<k&&n.push(c),a>k&&c<=a&&c>k&&n.push(c))}n.sort(function(a,b){return a-b});for(g=0;g<n.length-1;g++)if(a=n[g],k=n[g+1],e>=a&&e<k)if(g%2)break;else return!0;return!1},_findCentroidForRing:function(g){for(var f=g.length,e=[0,0],b=0,a=g[0][0],c=g[0][1],k=1;k<f-1;k++){var m=g[k][0],n=g[k][1],p=g[k+1][0],u=g[k+1][1],v=(m-a)*(u-c)-(p-a)*(n-c);e[0]+=v*(a+m+p);e[1]+=v*(c+n+u);b+=
v}e[0]/=3*b;e[1]/=3*b;return e},_findCentroidForFeature:function(g){for(var f=0,e=[0,0],b=0;b<g.rings.length;b++)for(var a=g.rings[b],c=a.length,k=a[0][0],m=a[0][1],n=1;n<c-1;n++){var p=a[n][0],u=a[n][1],v=a[n+1][0],t=a[n+1][1],G=(p-k)*(t-m)-(v-k)*(u-m);e[0]+=G*(k+p+v);e[1]+=G*(m+u+t);f+=G}e[0]/=3*f;e[1]/=3*f;return e},_findPlace:function(g,f,e,b,a,c,m){if(isNaN(e)||isNaN(b))return!1;for(var k=0;k<this._placedLabels.length;k++){var q=this._placedLabels[k].angle,p=this._placedLabels[k].width*this._scale,
x=this._placedLabels[k].height*this._scale,v=this._placedLabels[k].x-e,t=this._placedLabels[k].y-b;if(0===a&&0===q){if(this._findPlace2(-c*this._scale,-m*this._scale,c*this._scale,m*this._scale,v-p,t-x,v+p,t+x))return!1}else{var G=new n(-c*this._scale,-m*this._scale,c*this._scale,m*this._scale,null),F=0,D=1;0!==a&&(F=Math.sin(a),D=Math.cos(a));var I=v*D-t*F,v=v*F+t*D,q=q-a,F=Math.sin(q),D=Math.cos(q),K=-p*D- -x*F,t=-p*F+-x*D,q=+p*D- -x*F,J=+p*F+-x*D,p=I+K,x=v-t,F=I+q,D=v-J,K=I-K,t=v+t,I=I-q,v=v+J,
q=new u;q.addRing([[p,x],[F,D],[K,t],[I,v],[p,x]]);if(G.intersects(q))return!1}}for(;a>Math.PI/2;)a-=Math.PI;for(;a<-(Math.PI/2);)a+=Math.PI;k={};k.layer=g;k.text=f;k.angle=a;k.x=e;k.y=b;k.width=c;k.height=m;this._placedLabels.push(k);return!0},_findPlace2:function(g,f,e,b,a,c,m,n){return(g>=a&&g<=m||e>=a&&e<=m||g<=a&&e>=m)&&(f>=c&&f<=n||b>=c&&b<=n||f<=c&&b>=n)?!0:!1}})})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/utils ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U,V,A,X,aa,l,d,h,r,y){var H=L.getClassValuesForRelationship(),P={defaultShape:{type:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15"},stroke:{width:1,color:"#555555"}},ba={HH:315,HL:45,LL:135,LH:225},ea=g([r,z],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,dotDensitySwatchSize:26,dotCoverage:75,gradientHeight:30,transparencyRampColor:new u([64,64,64]),defaultText:"Aa",sizeRampLightColor:new u([255,
255,255]),sizeRampDarkColor:new u([128,128,128]),gradientWidth:34,colorRampBorder:"1px solid",_specialChars:{lt:"\x3c",gt:"\x3e"},_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,_preserveCacheOnDestroy:!1,_layerConnects:null,_mapConnects:null,constructor:function(a,b){t.mixin(this,y.widgets.legend);this._i18n=y.widgets.legend;a=a||{};a.map?b?(this.map=a.map,this.layerInfos=a.layerInfos,this._respectCurrentMapScale=!1===a.respectCurrentMapScale?!1:!0,this._respectVisibility=!1===a.respectVisibility?
!1:!0,this._preserveCacheOnDestroy=a.preserveCacheOnDestroy?!0:!1,this.arrangement=a.arrangement===ea.ALIGN_RIGHT?ea.ALIGN_RIGHT:ea.ALIGN_LEFT,this.arrangement===ea.ALIGN_RIGHT&&(this.alignRight=!0),this.autoUpdate=!1===a.autoUpdate?!1:!0,this._surfaceItems=[],this.hideLayersInLegend={},this.refresh=k(this.refresh,0)):console.error("esri.dijit.Legend: must specify a container for the legend"):console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);
var a=["ar","he"],b,d;for(b=0;b<a.length;b+=1)d=a[b],p.locale&&-1!==p.locale.indexOf(d)&&(-1!==p.locale.indexOf("-")?-1!==p.locale.indexOf(d+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();
9>f("ie")&&(this._repaintItems=t.hitch(this,this._repaintItems),setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();this._removeCachedLegendResponses();this._removeHoverHandlers();this.inherited(arguments)},_removeCachedLegendResponses:function(){this._preserveCacheOnDestroy||v.forEach(this.layers,function(a){delete a.legendResponse})},refresh:function(a){if(this.domNode){a?(this.layerInfos=a,this.layers=[],v.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&
(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layers=this.layerInfos=null);for(a=this.domNode.children.length-1;0<=a;a--)w.destroy(this.domNode.children[a]);
this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){this.layerInfos&&(this.layers=[],v.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(this.hideLayersInLegend[a.layer.id]=a.hideLayers,this._addSubLayersToHide(a)):this.hideLayersInLegend[a.layer.id]=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),
a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this));this.useAllMapLayers=!1;if(!this.layers){this.useAllMapLayers=!0;this.layers=[];var a=[],b=[];v.forEach(this.map.layerIds,function(d){d=this.map.getLayer(d);var c;this._isSupportedLayerType(d)&&(d.arcgisProps&&d.arcgisProps.title&&(d._titleForLegend=d.arcgisProps.title),this.layers.push(d));"esri.layers.KMLLayer"==d.declaredClass&&(c=d.getLayers(),v.forEach(c,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==
d.declaredClass&&(c=d.getFeatureLayers(),v.forEach(c,function(a){b.push(a.id)},this))},this);v.forEach(this.map.graphicsLayerIds,function(d){var c=this.map.getLayer(d);-1==v.indexOf(a,d)&&-1==v.indexOf(b,d)&&this._isSupportedLayerType(c)&&this._isLayerDrawingEnabled(c)&&(c.arcgisProps&&c.arcgisProps.title&&(c._titleForLegend=c.arcgisProps.title),this.layers.push(c))},this)}this._createLegend()},_isLayerDrawingEnabled:function(a){return a&&(a._params&&a._params.drawMode||a.isFeatureReductionActive&&
a.isFeatureReductionActive())},_activate:function(){this._deactivate();if(this.autoUpdate){this._mapConnects=[];this._layerConnects={};var a=this._mapConnects;this._respectCurrentMapScale&&a.push(n.connect(this.map,"onZoomEnd",this,"_refreshLayers"));this.useAllMapLayers&&(a.push(n.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers")),a.push(n.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers")),a.push(n.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")));v.forEach(this.layers,
function(a){var b=[n.connect(a,"onFeatureReductionRendererChange",this,"_refreshLayers"),n.connect(a,"onFeatureReductionChange",this,"_refreshLayers"),n.connect(a,"onVisibilityChange",this,"_refreshLayers"),n.connect(a,"onOpacityChange",this,"_refreshLayers"),n.connect(a,"onScaleRangeChange",this,"_refreshLayers")];"esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass&&a.supportsDynamicLayers&&b.push(n.connect(a,"_onDynamicLayersChange",t.hitch(this,"_updateDynamicLayers",a)));"esri.layers.ArcGISImageServiceLayer"===
a.declaredClass&&(b.push(n.connect(a,"onRenderingChange",t.partial(this._updateImageServiceLayers,this,a))),b.push(n.connect(a,"onRendererChange",t.partial(this._updateImageServiceLayers,this,a))));("esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass||a.setWebGLEnabled)&&b.push(n.connect(a,"onRendererChange",t.hitch(this,"_refreshLayers")));this._layerConnects[a.id]=b},this)}},_deactivate:function(){v.forEach(this._mapConnects,function(a){n.disconnect(a)});v.forEach(this.layers,function(a){var b=
this._layerConnects;b&&v.forEach(b[a.id],function(a){n.disconnect(a)})},this);this._mapConnects=this._layerConnects=null},_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];v.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this.layers.push(a)},this);v.forEach(this.map.graphicsLayerIds,
function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this._isLayerDrawingEnabled(a)&&this.layers.push(a)},this);this.refresh()},_createLegend:function(){var b=!1,d=!1;q.set(this.domNode,"position","relative");w.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var c=[];v.forEach(this.layers,function(a){if("esri.layers.KMLLayer"==a.declaredClass||"esri.layers.GeoRSSLayer"==a.declaredClass){var e;a.loaded?("esri.layers.KMLLayer"==
a.declaredClass?e=a.getLayers():"esri.layers.GeoRSSLayer"==a.declaredClass&&(e=a.getFeatureLayers(),this.hideLayersInLegend[a.id]&&(e=v.filter(e,function(b){return-1==v.indexOf(this.hideLayersInLegend[a.id],b.id)},this))),v.forEach(e,function(b){"esri.layers.FeatureLayer"==b.declaredClass&&a._titleForLegend&&(b._titleForLegend=a._titleForLegend+" - ","esriGeometryPoint"==b.geometryType?b._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==b.geometryType?b._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==
b.geometryType&&(b._titleForLegend+=this.NLS_areas),c.push(b))},this)):n.connect(a,"onLoad",t.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===a.declaredClass)if(!a.loaded)n.connect(a,"onLoad",t.hitch(this,function(){this.refresh(this.layerInfos)}));else{if((!this._respectVisibility||this._respectVisibility&&a.visible)&&0<a.layerInfos.length&&v.some(a.layerInfos,function(a){return a.legendURL})){var h=!1;v.forEach(a.layerInfos,function(d){if(d.legendURL&&-1<
v.indexOf(a.visibleLayers,d.name)){h||(w.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(a._titleForLegend||a.name||a.id)+"\x3c/span\x3e"},this.domNode),h=!0);var c;d=d.legendURL;if(a.customParameters||a.customLayerParameters){var e=t.clone(a.customParameters||{});t.mixin(e,a.customLayerParameters||{});for(c in e)d+=(-1===d.indexOf("?")?"?":"\x26")+c+"\x3d"+e[c]}w.create("div",{innerHTML:"\x3cimg src\x3d'"+d+"'/\x3e"},this.domNode);b=!0}},this)}}else"esri.layers.WFSLayer"!==
a.declaredClass||a.renderer?c.push(a):(e=w.create("div",{id:this.id+"_"+a.id,"class":"esriLegendService"}),w.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},w.create("td",{align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%"},e))))),w.place(e,this.id,"first"),e=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),e=w.create("tbody",{},e),"esriGeometryComplex"===a.geometryType?(this._buildRow_Renderer(a,
a._pointSymbol,null,this.NLS_points,null,e),this._buildRow_Renderer(a,a._lineSymbol,null,this.NLS_lines,null,e),this._buildRow_Renderer(a,a._polygonSymbol,null,this.NLS_areas,null,e)):"esriGeometryPoint"===a.geometryType?this._buildRow_Renderer(a,a._pointSymbol,null,"",null,e):"esriGeometryPolyline"===a.geometryType?this._buildRow_Renderer(a,a._lineSymbol,null,"",null,e):"esriGeometryPolygon"===a.geometryType&&this._buildRow_Renderer(a,a._polygonSymbol,null,"",null,e),d=!0)},this);var e=[];v.forEach(c,
function(a){if(!a.loaded)var b=n.connect(a,"onLoad",this,function(a){n.disconnect(b);b=null;this.refresh()});else if((!this._respectVisibility||this._respectVisibility&&a.visible)&&(a.layerInfos||a.renderer||"esri.layers.ArcGISImageServiceLayer"==a.declaredClass)){var d=w.create("div",{id:this.id+"_"+a.id,style:{display:"none"},"class":"esriLegendService"});w.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},w.create("td",{align:this._align},w.create("tr",{},w.create("tbody",
{},w.create("table",{width:"95%"},d)))));w.place(d,this.id,"first");a.legendResponse||a.renderer&&"esri.renderer.StretchRenderer"!==a.renderer.declaredClass||a.renderer&&"esri.renderer.StretchRenderer"===a.renderer.declaredClass&&1===a.bandCount?this._createLegendForLayer(a):this.isHostedTileService(a)?this._getLayerInfos(a).then(t.hitch(this,function(a){this._createLegendForLayer(a)}),t.hitch(this,function(a){e.push(this._legendRequest(a))})):e.push(this._legendRequest(a))}},this);0!==e.length||
b||d?(new a(e)).addCallback(t.hitch(this,function(a){b||d?x.byId(this.id+"_msg").innerHTML="":x.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()})):(x.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate())},_createLegendForLayer:function(a){if(a.legendResponse||a.renderer||this.isHostedTileService(a)){var b=!1;if(a.legendResponse||this.isHostedTileService(a)){var d=a.dynamicLayerInfos||a.layerInfos;d&&d.length?v.forEach(d,function(d,c){this.hideLayersInLegend[a.id]&&-1!==
v.indexOf(this.hideLayersInLegend[a.id],d.id)||(d=this._buildLegendItems(a,d,c),b=b||d)},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(d=a.url?a.url.substring(a.url.lastIndexOf("/")+1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:d,name:null,subLayerIds:null,parentLayerId:-1},0));b&&(q.set(x.byId(this.id+"_"+a.id),"display","block"),q.set(x.byId(this.id+"_msg"),
"display","none"))}},_legendRequest:function(a){if(a.loaded)return 10.01<=a.version?this._legendRequestServer(a):this._legendRequestTools(a);n.connect(a,"onLoad",t.hitch(this,"_legendRequest"))},_legendRequestServer:function(a){var b=a.url,d=b.indexOf("?"),b=-1<d?b.substring(0,d)+"/legend"+b.substring(d):b+"/legend";(d=a._getToken())&&(b+="?token\x3d"+d);var e=t.hitch(this,"_processLegendResponse"),h={f:"json"};a._params.dynamicLayers&&(h.dynamicLayers=c.stringify(this._createDynamicLayers(a)),"[{}]"===
h.dynamicLayers&&(h.dynamicLayers="[]"));a._params.bandIds&&(h.bandIds=a._params.bandIds);a._params.renderingRule?h.renderingRule=a._params.renderingRule:a.rasterFunctionInfos&&0<a.rasterFunctionInfos.length&&v.forEach(a.rasterFunctionInfos,function(a){a&&a.name&&"none"===a.name.toLowerCase()&&(h.renderingRule=c.stringify({rasterFunction:a.name}))});return I({url:b,content:h,callbackParamName:"callback",load:function(b,d){e(a,b,d)},error:D.defaults.io.errorHandler})},_legendRequestTools:function(a){var b=
a.url.toLowerCase().indexOf("/rest/"),b=a.url.substring(0,b)+a.url.substring(b+5,a.url.length),b=this._legendUrl+"?soapUrl\x3d"+window.escape(b);if(!f("ie")||8<f("ie"))b+="\x26returnbytes\x3dtrue";var d=t.hitch(this,"_processLegendResponse");return I({url:b,content:{f:"json"},callbackParamName:"callback",load:function(b,c){d(a,b,c)},error:D.defaults.io.errorHandler})},_processLegendResponse:function(a,b){b&&b.layers?(a.legendResponse=b,x.byId(this.id+"_"+a.id)&&w.empty(x.byId(this.id+"_"+a.id)),w.create("span",
{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},w.create("td",{align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%"},x.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a)):console.log("Legend could not get generated for "+a.url+": "+m.toJson(b))},_buildLegendItems:function(a,b,d){var c=!1,e=x.byId(this.id+"_"+a.id),h=b.parentLayerId;if(b.subLayerIds)a=w.create("div",{id:this.id+"_"+a.id+"_"+b.id+"_group",style:{display:"none"},"class":-1==
h?0<d?"esriLegendGroupLayer":"":this._legendAlign},-1==h?e:x.byId(this.id+"_"+a.id+"_"+h+"_group")),w.create("td",{innerHTML:G.encode(b.name),align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(this._respectVisibility&&a.visibleLayers)if(d=a.dynamicLayerInfos||a.layerInfos)if(a._params&&a._params.layers){if(-1===v.indexOf(a.visibleLayers,b.id))return c}else{if(d=this._getReallyVisibleLayers(d,a.visibleLayers),-1===v.indexOf(d,
b.id))return c}else if(-1===v.indexOf(a.visibleLayers,b.id))return c;e=w.create("div",{id:this.id+"_"+a.id+"_"+b.id,style:{display:"none"},"class":-1<h?this._legendAlign:""},-1==h?e:x.byId(this.id+"_"+a.id+"_"+h+"_group"));w.create("td",{innerHTML:G.encode(b.name)||"",align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%","class":"esriLegendLayerLabel"},e))));d=a.dynamicLayerInfos||a.layerInfos;h=!1;d&&d.length&&(h=v.some(d,function(a){return!!a.drawingInfo}));if(a.legendResponse)c=
c||this._buildLegendItems_Tools(a,b,e);else if(a.renderer||h)c=c||this._buildLegendItems_Renderer(a,b,e)}return c},_getReallyVisibleLayers:function(a,b){if(!a||!b||!b.length)return[];var d=[],c=[],e;for(e=0;e<a.length;e++)if(a[e].subLayerIds){if(-1===v.indexOf(b,a[e].id)||-1<v.indexOf(c,a[e].id))c=c.concat(a[e].subLayerIds)}else-1<v.indexOf(b,a[e].id)&&-1===v.indexOf(c,a[e].id)&&d.push(a[e].id);return d},_buildLegendItems_Tools:function(a,b,d){var c=b.parentLayerId,e=this.map.getScale(),h=!1,f=function(a,
b){var d,c;for(d=0;d<a.length;d++)if(b.dynamicLayerInfos)for(c=0;c<b.dynamicLayerInfos[c].length;c++){if(b.dynamicLayerInfos[c].mapLayerId==a[d].layerId)return a[d]}else if(b.id==a[d].layerId)return a[d];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,b,e)){var g=!0;if(this._respectCurrentMapScale&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass)){var l=this._getEffectiveScale(a,b);
if(l.minScale&&l.minScale<e||l.maxScale&&l.maxScale>e)g=!1}if(g){var e=f(a.legendResponse.layers,b),k=e.legendType,m=e.layerType,n=e.legend;if(n){"esri.layers.ArcGISImageServiceLayer"!==a.declaredClass&&this._sanitizeLegendResponse(a,e,b);d=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);var p=w.create("tbody",{},d);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(d,a,b);var u=[];v.forEach(n,function(d){if(!(10.1<=a.version&&!d.values&&1<n.length)||
!a._hideDefaultSymbol&&"\x3call other values\x3e"!==d.label&&(d.label||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version||"Raster Layer"===m)){var c=d.label;if(d.url&&0===d.url.indexOf("http")||d.imageData&&0<d.imageData.length)h=!0,c&&-1!==v.indexOf(u,c)||(u.push(c),this._buildRow_Tools(d,p,a,b.id,k))}},this)}}}h&&(q.set(x.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<c&&(q.set(x.byId(this.id+"_"+a.id+"_"+c+"_group"),"display","block"),this._findParentGroup(a.id,a,
c)));return h},_getLayerInfos:function(a){var d=new b,c=a.dynamicLayerInfos||a.layerInfos;if(c&&c.length)if(v.some(c,function(a){return!!a.drawingInfo}))d.resolve(a);else{var e=a.url,h=e.indexOf("?"),e=-1==h?e+"/layers":e.substring(0,h)+"/layers"+e.substring(h,e.length);I({url:e,content:{f:"json"},callbackParamName:"callback",load:function(b,e){b.layers?(v.forEach(c,function(a){var d=v.filter(b.layers,function(b){return a.source?b.id===a.source.mapLayerId:b.id===a.id});d&&d[0]&&d[0].drawingInfo&&
(a.drawingInfo=d[0].drawingInfo,a.fields=d[0].fields)}),d.resolve(a)):d.reject(a)},error:function(b){d.reject(a)}})}return d},_sanitizeLegendResponse:function(a,b,d){var c=b.legend;if(10.1<=a.version&&1<c.length&&!b._sanitized){a=t.getObject("layerDefinition.drawingInfo.renderer",!1,d);var e,h;a||(a=t.getObject("drawingInfo.renderer",!1,d));v.some(c,function(a){if(a.values)return!0})&&v.some(c,function(a,b){a.values||(h=b,e=a);return!!e});a?"uniqueValue"===a.type?e&&(c.splice(h,1),c.push(e)):"classBreaks"===
a.type&&(e&&c.splice(h,1),c.reverse(),e&&c.push(e)):e&&(c.splice(h,1),c.push(e));b._sanitized=!0}},_buildRow_Tools:function(a,b,d,c,e){var h=w.create("tr",{},b),g;this.alignRight?(b=w.create("td",{align:this._isRightToLeft?"left":"right"},h),g=w.create("td",{align:this._isRightToLeft?"left":"right",width:35},h)):(g=w.create("td",{width:35,align:"center"},h),b=w.create("td",{},h));h=a.url;(!f("ie")||9<=f("ie")||9>f("ie")&&"esri.layers.ArcGISImageServiceLayer"===d.declaredClass)&&a.imageData&&0<a.imageData.length?
h="data:image/png;base64,"+a.imageData:0!==a.url.indexOf("http")&&(h=d.url+"/"+c+"/images/"+a.url,(c=d._getToken())&&(h+="?token\x3d"+c));c=w.create("img",{src:h,border:0,style:"opacity:"+d.opacity},g);a=w.create("td",{innerHTML:G.encode(a.label),align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%",dir:"ltr"},b))));e&&"Stretched"===e&&10.3<=d.version&&"esri.layers.ArcGISImageServiceLayer"===d.declaredClass&&(a.style.verticalAlign="top",a.style.lineHeight="1",c.style.marginBottom=
"-1px",c.style.display="block",b.style.verticalAlign="top");9>f("ie")&&(c.style.filter="alpha(opacity\x3d"+100*d.opacity+")")},_getVariable:function(a,b,d){var c;a&&(c=(a=a.getVisualVariablesForType(b,d))&&a[0]);return c},_getVariables:function(a,b,d){a=[this._getVariable(a,"colorInfo",!1),this._getVariable(a,"opacityInfo",!1),this._getVariable(a,"sizeInfo",!1)];return b?v.filter(a,function(a){return!(!a||a.field!==b||a.normalizationField!=d)}):a},_getFieldAlias:function(a,b,d){var c=b.infoTemplate||
(b.infoTemplates&&d&&b.infoTemplates[d.id]?b.infoTemplates[d.id].infoTemplate:null),c=c&&c.getFieldInfo&&c.getFieldInfo(a);a=t.isFunction(a)?null:this.getField(b,a,d);b=c||a;d="";b&&(d=c&&c.label||a&&a.alias||b.name||b.fieldName);return d},_getDomainName:function(a,b,d,c){var e;a&&!t.isFunction(a)&&(e=(d=(a=this.getField(d,a,c))&&d.getDomain?d.getDomain(a.name):null)&&d.codedValues?d.getName(b):null);return e},_getRampTitle:function(a,b,d){var c,e=a.field,h=a.normalizationField,f=!1,g=!1,l=!1,e=t.isFunction(e)?
null:e,h=t.isFunction(h)?null:h;if(a.legendOptions&&a.legendOptions.title)c=a.legendOptions.title;else if(a.valueExpressionTitle)c=a.valueExpressionTitle;else{if(b.renderer&&b.renderer.authoringInfo&&b.renderer.authoringInfo.visualVariables){var k=b.renderer.authoringInfo.visualVariables;for(a=0;a<k.length;a++){var m=k[a];if("colorInfo"===m.type&&"ratio"===m.style){f=!0;break}else if("colorInfo"===m.type&&"percent"===m.style){g=!0;break}else if("colorInfo"===m.type&&"percentTotal"===m.style){l=!0;
break}}}(f=l&&"showRatioPercentTotal"||g&&"showRatioPercent"||f&&"showRatio"||h&&"showNormField"||e&&"showField"||null)&&(c=K.substitute({field:e&&this._getFieldAlias(e,b,d),normField:h&&this._getFieldAlias(h,b,d)},"showField"===f?"${field}":this._i18n[f]))}return c},_getRendererTitle:function(a,b,d){var c;if(a){var e,h,f;"esri.renderer.ClassBreaksRenderer"===a.declaredClass&&(e=a.attributeField,h=a.normalizationField,f="percent-of-total"===a.normalizationType);e=t.isFunction(e)?null:e;h=t.isFunction(h)?
null:h;a.legendOptions&&a.legendOptions.title?c=a.legendOptions.title:a.valueExpressionTitle?c=a.valueExpressionTitle:(a=h&&"showNormField"||(f?"showNormPct":null)||e&&"showField"||null)&&(c=K.substitute({field:e&&this._getFieldAlias(e,b,d),normField:h&&this._getFieldAlias(h,b,d)},"showField"===a?"${field}":this._i18n[a]))}return c},_buildLegendItems_Renderer:function(a,b,d){var c=b.parentLayerId,e=this.map,f=e.getScale(),g,l=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(a,b,f)){var k,
m,n,p,u,r,B;m="esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass?a.renderer.renderer:b&&b.drawingInfo?h.fromJson(t.clone(b.drawingInfo.renderer)):a.isFeatureReductionActive&&a.isFeatureReductionActive()?a.getFeatureReductionRenderer():a.renderer;if("esri.renderer.ScaleDependentRenderer"===m.declaredClass&&(m=(e="zoom"===m.rangeType?m.getRendererInfoByZoom(e.getZoom()):m.getRendererInfoByScale(f))&&e.renderer,!m))return!1;e=m&&m.authoringInfo&&"relationship"===m.authoringInfo.type;if("esri.renderer.StretchRenderer"!==
m.declaredClass){var z=this._getVariables(m),C=v.filter(z,function(a){return!!a}).length,F=z[0],D=z[1],z=z[2],E,I,A,J,y;F&&(n=this._getMedianColor(m,F),F.field&&(u=t.isFunction(F.field)?null:this.getField(a,F.field,b)),E=!(F.legendOptions&&!1===F.legendOptions.showLegend));D&&(D.field&&(B=t.isFunction(D.field)?null:this.getField(a,D.field,b)),I=!(D.legendOptions&&!1===D.legendOptions.showLegend));z&&(z.field&&(r=t.isFunction(z.field)?null:this.getField(a,z.field,b)),A=!(z.legendOptions&&!1===z.legendOptions.showLegend))}if("esri.renderer.HeatmapRenderer"===
m.declaredClass)g=l=!0,this._showHeatRamp(a,b,m,d);else if("esri.renderer.DotDensityRenderer"===m.declaredClass)g=l=!0,this._showDotDensityLegend(a,b,m,d);else if("esri.renderer.TemporalRenderer"===m.declaredClass)g=l=!0,f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),k=w.create("tbody",{},f),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,b),m.latestObservationRenderer&&"esri.renderer.SimpleRenderer"===m.latestObservationRenderer.declaredClass&&
this._buildRow_Renderer(a,m.latestObservationRenderer.symbol,n,G.encode(m.latestObservationRenderer.label)||this.NLS_currentObservations,null,k),m.observationRenderer&&"esri.renderer.SimpleRenderer"===m.observationRenderer.declaredClass&&this._buildRow_Renderer(a,m.observationRenderer.symbol,n,G.encode(m.observationRenderer.label)||this.NLS_previousObservations,null,k);else if("esri.renderer.UniqueValueRenderer"===m.declaredClass){if(m.infos&&0<m.infos.length){g=l=!0;if(m.legendOptions&&m.legendOptions.title||
m.valueExpressionTitle)f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),k=w.create("tbody",{},f),C=m.legendOptions&&m.legendOptions.title?m.legendOptions.title:m.valueExpressionTitle,this._buildRow_Renderer(a,null,n,G.encode(C),null,k);f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);k=w.create("tbody",{},f);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,b);m.attributeField&&z&&this._addSubHeader(k,this._getFieldAlias(m.attributeField,
a,b));if(e){var M=m.authoringInfo;y=M.focus;var C=M.numClasses,L=M.field1.field,f=M.field2.field;if(C&&L&&f){var O=M.field1.normalizationField,M=M.field2.normalizationField,W=O&&this._i18n.showNormField||L&&"${field}",Q=M&&this._i18n.showNormField||f&&"${field}",L=K.substitute({field:this._getFieldAlias(L,a,b),normField:O&&this._getFieldAlias(O,a,b)},W),f=K.substitute({field:this._getFieldAlias(f,a,b),normField:M&&this._getFieldAlias(M,a,b)},Q),O={shapeDescriptor:P,rotation:this._getRotationAngleForFocus(y)||
0};this._buildRow_Renderer(a,null,null,G.encode(L),null,k,null,O);O.rotation+=90;this._buildRow_Renderer(a,null,null,G.encode(f),null,k,null,O);this._drawRelationshipLegend(d,{numClasses:C,focus:y,uvInfos:m.infos})}}else{var V=[];v.forEach(m.infos,function(d){var c=null;this._isLayerEditable(a)&&a.types&&(c=this._getTemplateFromTypes(a.types,d.value));var e=d.label;null==e&&(e=this._getDomainName(m.attributeField,d.value,a,b)||d.value);-1===v.indexOf(V,e)&&(V.push(e),this._buildRow_Renderer(a,d.symbol,
n,G.encode(e),c,k))},this)}}y=!e&&this._displayDefaultSymbol(a,m,d)}else if("esri.renderer.ClassBreaksRenderer"===m.declaredClass){if(m.infos&&0<m.infos.length||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass)g=l=!0,J=this._isUnclassedRenderer(m),F||1!==m.infos.length||(p=(p=m.infos[0])&&p.symbol),J||(f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),k=w.create("tbody",{},f),C=this._getRendererTitle(m,a,b),this._buildRow_Renderer(a,null,n,G.encode(C),
null,k)),f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),k=w.create("tbody",{},f),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,b),J&&z&&A||(e=m.infos.slice(0).reverse(),v.forEach(e,function(b){var d=b.label;null!=d||J||(d=b.minValue+" - "+b.maxValue);this._buildRow_Renderer(a,b.symbol,n,G.encode(d),null,k)},this)),"esri.layers.ArcGISImageServiceVectorLayer"!==a.declaredClass||a.renderer.style!==U.STYLE_SCALAR&&a.renderer.style!==U.STYLE_SINGLE_ARROW||
(this._buildRow_Renderer(a,m.defaultSymbol,null,"",null,k),a._hideDefaultSymbol=!0);J||(y=this._displayDefaultSymbol(a,m,d))}else if("esri.renderer.StretchRenderer"===m.declaredClass){g=l=!0;f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%",class:"esriLegendLayer"},d);k=w.create("tbody",{},f);var T=this;a.renderingRule?a.getRenderingRuleServiceInfo(a.renderingRule).then(function(b){var d=b&&b.minValues&&0<b.minValues.length&&b.maxValues&&0<b.maxValues.length;b&&1<b.bandCount||!d?T._legendRequest(a).then(function(b){T._processLegendResponse(a,
b)}):T._createStretchLegend(k,m,b.minValues[0],b.maxValues[0])}):this.createStretchLegend(k,m,a.serviceInfo.minValues[0],a.serviceInfo.maxValues[0])}else"esri.renderer.SimpleRenderer"===m.declaredClass&&(g=l=!0,f=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d),k=w.create("tbody",{},f),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,b),p=null,this._isLayerEditable(a)&&a.templates&&0<a.templates.length&&(p=a.templates[0]),e=1<C?null:u&&E||B&&I||r&&
A,this._buildRow_Renderer(a,m.symbol,n,G.encode(e?this._getRampTitle(1<C?null:F||D||z,a,b):m.label),p,k),p=F?null:m.symbol,e&&(u=B=r=null));g&&(F&&E&&(F.field||F.valueExpression)&&this._showGradientRamp(a,b,m,null,d,F,u,null,z&&A?!0:!1),z&&A&&(z.field||z.valueExpression)&&(g=F&&E||"esri.renderer.UniqueValueRenderer"===m.declaredClass?!1:!0,this._showSizeLegend(a,b,m,z,n,d,r,null,g)),D&&I&&(D.field||D.valueExpression)&&this._showGradientRamp(a,b,m,p&&!p.url&&p.color?p.color:this.transparencyRampColor,
d,D,B,null,!1));y||J&&!E&&!A&&!I||(y=this._displayDefaultSymbol(a,m,d));l=l||y}l&&(q.set(x.byId(this.id+"_"+a.id+"_"+b.id),"display","block"),-1<c&&(q.set(x.byId(this.id+"_"+a.id+"_"+c+"_group"),"display","block"),this._findParentGroup(a.id,c)));return l},_createStretchLegend:function(a,b,d,c){var e=w.create("tr",{},a),h;h=w.create("td",{rowspan:2,"class":"esriStretchLegend"},e);b=w.toDom(this._addColorRamp(b.colorRamp));w.place(b,h);w.create("td",{},e).innerHTML=this._i18n.high+": "+Math.round(c*
Math.pow(10,3))/Math.pow(10,3);a=w.create("tr",{},a);w.create("td",{},a).innerHTML=this._i18n.low+": "+Math.round(d*Math.pow(10,3))/Math.pow(10,3)},_addColorRamp:function(a){a||(a={algorithm:"hsv",fromColor:[0,0,0,1],toColor:[255,255,255,1]});var b=this._generateColorRampDivs(a);a.label="\x3cdiv class\x3d'esriStretchLegendGradientLabel'\x3e"+b+"\x3c/div\x3e";return a.label},_generateColorRampDivs:function(a){if(a){var b,d="";"multipart"===a.type?(b=100/a.colorRamps.length,v.forEach(a.colorRamps.reverse(),
function(a){d+=this._generateSingleGradientDiv(a.fromColor,a.toColor,b)},this)):d=this._generateSingleGradientDiv(a.fromColor,a.toColor,100);return d}},_generateSingleGradientDiv:function(a,b,d){if(a&&b){var c,e="";a=a.toRgb?a.toRgb():a;b=b.toRgb?b.toRgb():b;c="(0deg, rgb("+a.slice(0,3).join()+"), rgb("+b.slice(0,3).join()+"));";v.forEach(["-webkit-linear-gradient","-o-linear-gradient","-moz-linear-gradient","linear-gradient"],function(a){e+="background: "+a+c});return"\x3cdiv class\x3d'esriStretchLegendSingleGradient' style\x3d'height:"+
d+"%;"+e+"'\x3e\x3c/div\x3e"}},_isLayerEditable:function(a){return"function"===typeof a.isEditable&&a.isEditable()},_isUnclassedRenderer:function(a,b){var d;if("esri.renderer.ClassBreaksRenderer"===a.declaredClass&&a.infos&&1===a.infos.length){d=a.attributeField;var c=a.normalizationField;d=b?d===b:!!this._getVariables(a,d,c).length}return d},_displayDefaultSymbol:function(a,b,d){var c;!a._hideDefaultSymbol&&b.defaultSymbol&&(c=!0,d=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},
d),d=w.create("tbody",{},d),this._buildRow_Renderer(a,b.defaultSymbol,null,G.encode(b.defaultLabel)||"others",null,d));return c},_showGradientRamp:function(a,b,d,c,e,h,f,g,l){l=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(l?"":" esriLegendSubFragment")},e);e=w.create("tbody",{},l);(a._hoverLabel||a._hoverLabels||g)&&this._createHoverAction(l,a,b,g);(f||h.valueExpression||h.legendOptions&&h.legendOptions.title)&&this._addSubHeader(e,this._getRampTitle(h,a,b));
f=h.field;var k;f&&(k=t.isFunction(f)?null:this.getField(a,f,b));(b=this._getRampStops(d,h,c,k&&"esriFieldTypeDate"===k.type))&&b.length&&this._drawGradientRamp(e,b,!0,a,this._getRampBorderColor(d),!!c)},_getMedianColor:function(a,b){var d,c;b.colors?(d=b.minDataValue,c=b.maxDataValue):b.stops&&(d=b.stops[0].value,c=b.stops[b.stops.length-1].value);return a.getColor(d+(c-d)/2,{colorInfo:b})},_getRampStops:function(a,b,d,c){var e,h,f,g,l=!1;b.colors||b.opacityValues?(h=b.maxDataValue-b.minDataValue,
e=v.map([0,.25,.5,.75,1],function(a){f=b.minDataValue+a*h;return Number(f.toFixed(6))}),this._checkPrecision(0,4,e)):b.stops&&(e=v.map(b.stops,function(a){return a.value}),(l=v.some(b.stops,function(a){return!!a.label}))&&(g=v.map(b.stops,function(a){return a.label})));var k=e[0],m,n;h=e[e.length-1]-k;return v.map(e,function(f,q){d?(m=new u(d.toRgba()),n=a.getOpacity(f,{opacityInfo:b}),null!=n&&(m.a=n)):m=a.getColor(f,{colorInfo:b});var p="";if(l)p=g[q];else{var p=c?L.formatDate(f,L.timelineDateFormatOptions):
J.format(f),w="";0===q?w=this._specialChars.lt+" ":q===e.length-1&&(w=this._specialChars.gt+" ");p=w+p}return{value:f,color:m,offset:1-(f-k)/h,label:p}},this).reverse()},_checkPrecision:function(a,b,d){var c=a+(b-a)/2,e=d[a],h=d[c],f=d[b],g=Math.floor(e),l=Math.floor(h),k=Math.floor(f);g===e&&k===f&&l!==h&&g!==l&&k!==l&&(d[c]=l);a+1!==c&&this._checkPrecision(a,c,d);c+1!==b&&this._checkPrecision(c,b,d)},_getRampBorderColor:function(a){var b;if("esri.renderer.SimpleRenderer"===a.declaredClass)b=a.symbol;
else if("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)b=a.infos[0].symbol;return(a=b&&-1===b.type.indexOf("linesymbol")?b.getStroke():null)&&a.color},_drawGradientRamp:function(a,b,d,c,e,h){var g=w.create("tr",{},a),l,k,m,n,p,x=b.length-1,r;n=0;this.alignRight?(a=w.create("td",{align:this._isRightToLeft?"left":"right"},g),l=w.create("td",{align:this._isRightToLeft?"left":"right",width:this.gradientWidth},g)):(l=w.create("td",{width:this.gradientWidth,
align:"center"},g),a=w.create("td",{},g));g=e&&0<e.a&&!(240<=e.r&&240<=e.g&&240<=e.b);k=w.create("div",{"class":g?"":"esriLegendBorderLessColorRamp",style:"position: relative; width:"+this.gradientWidth+"px;"},l);l=w.create("div",{"class":"esriLegendColorRamp"+(h?" esriLegendTransparencyRamp":"")},k);h=q.get(l,"width");g&&(e=9>f("ie")?e.toHex():"rgba("+e.toRgba().join(",")+")",q.set(l,"border",this.colorRampBorder+" "+e));d?(e=this.gradientHeight*x,q.set(l,"height",e+"px")):e=q.get(l,"height");q.set(k,
"height",e+"px");g=E.createSurface(l,h,e);9>f("ie")&&(n=g.getEventSource(),q.set(n,"position","relative"),q.set(n.parentNode,"position","relative"),n=1);try{d&&v.forEach(b,function(a,b){a.offset=b/x}),p=g.createRect({x:-n,y:-n,width:h+n,height:e+n}),p.setFill({type:"linear",x1:0,y1:0,x2:0,y2:e,colors:b}).setStroke(null),g.createRect({width:h,height:e}).setFill(new u([255,255,255,1-c.opacity])).setStroke(null),this._surfaceItems.push(g)}catch(fa){g.clear(),g.destroy()}v.forEach(b,function(a,d){a.label&&
(r="top:"+100*a.offset+"%;",a="",0===d&&(a+=" esriLegendColorRampTickFirst"),d===b.length-1&&(a+=" esriLegendColorRampTickLast"),w.create("div",{"class":"esriLegendColorRampTick"+a,innerHTML:"\x26nbsp;",style:r},k))});m=w.create("div",{"class":"esriLegendColorRampLabels",style:{height:e+this.gradientHeight+"px"}},a);d?v.forEach(b,function(a){w.create("div",{"class":"esriLegendColorRampLabel",innerHTML:G.encode(a.label)||"\x26nbsp;"},m)}):(w.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.high},
m),w.create("div",{"class":"esriLegendColorRampLabel",innerHTML:this._i18n.low,style:"top: "+(e+this.gradientHeight-2*this.gradientHeight)+"px;"},m))},_showHeatRamp:function(a,b,d,c,e){var h,f=d.field;h=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);c=w.create("tbody",{},h);(a._hoverLabel||a._hoverLabels||e)&&this._createHoverAction(h,a,b,e);(f=f&&this.getField(a,f,b))&&this._addSubHeader(c,this._getFieldAlias(f.name,a,b));b=this._getHeatmapStops(d);b.length&&
this._drawGradientRamp(c,b,!1,a)},_getHeatmapStops:function(a){var b=a.colorStops;a=a.colors;var d,c,e,h;b&&b[0]?(d=b.length-1,(a=b[0]&&null!=b[0].ratio)?(a=b[d])&&1!==a.ratio&&(b=b.slice(0),b.push({ratio:1,color:a.color}),d++):(c=b[0].value,e=b[d].value-c,b=v.map(b,function(a){return{color:a.color,ratio:(a.value-c)/e}}))):a&&a[0]&&(d=a.length-1,h=1/(a.length-1),b=v.map(a,function(a,b){return{color:a,ratio:b*h}}));b=v.map(b,function(a,b){var c="";0===b?c="Low":b===d&&(c="High");return{color:a.color,
label:c,offset:1-a.ratio}});return b.reverse()},_showDotDensityLegend:function(a,b,d,c){var e=d.legendOptions,h,f,g,l,k,m,n,q=this.dotDensitySwatchSize,p=Math.round(q/2);e&&(f=e.backgroundColor,g=e.outline,l=e.valueUnit,k=e.dotCoverage);k=(k||this.dotCoverage)/100;n=Math.round(q*q/Math.pow(d.dotSize,2)*k);c=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);m=w.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,b);this._addSubHeader(m,
K.substitute({value:d.dotValue,unit:l||""},this.NLS_dotValue));v.forEach(d.fields,function(c){c=t.mixin({},c);c.numPoints=n;h=new A(d._generateImageSrc(q,q,[c],{x:0,y:0},{x:q,y:q},f),g||d.outline,q,q);c=this.getField(a,c.name,b)||c;this._buildRow_Renderer(a,h,null,G.encode(this._getFieldAlias(c.name,a,b)),null,m,{type:"path",path:"M "+-p+","+-p+" L "+p+","+-p+" L "+p+","+p+" L "+-p+","+p+" L "+-p+","+-p+" E"})},this)},_showSizeLegend:function(a,b,c,e,h,f,g,l,k){var m=e.legendOptions,m=m&&m.customValues;
h=this._getSizeSymbol(c,h);if((!e.valueUnit||"unknown"===e.valueUnit)&&h&&(m||null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue||e.stops&&!(1>=e.stops.length))){k=w.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"+(k?"":" esriLegendSubFragment")},f);f=w.create("tbody",{},k);(a._hoverLabel||a._hoverLabels||l)&&this._createHoverAction(k,a,b,l);(g||e.valueExpression||e.legendOptions&&e.legendOptions.title)&&this._addSubHeader(f,this._getRampTitle(e,
a,b));g=(k=(l=e.field)&&!t.isFunction(l))&&"cluster_count"===l.toLowerCase();b=(b=k?a.isFeatureReductionActive&&a.isFeatureReductionActive()?a.getFeatureReductionField(l):this.getField(a,l,b):null)&&"esriFieldTypeDate"===b.type;var m=m||this._getDataValues(c,h,e,b,g),n,q=m.length-1;for(l=q;0<=l;l--)k=m[l],h=d.fromJson(h.toJson()),this._applySize(h,c,e,k),k=b?L.formatDate(k,L.timelineDateFormatOptions):J.format(k),n="",l===q?n=this._specialChars.gt+" ":0===l&&(n=g&&1===m[l]?"":this._specialChars.lt+
" "),n="\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e"+G.encode(n+k)+"\x3c/span\x3e",this._buildRow_Renderer(a,h,null,n,null,f)}},_getSizeSymbol:function(a,b){var c,e;if("esri.renderer.SimpleRenderer"===a.declaredClass)c=a.symbol;else if("esri.renderer.VectorFieldRenderer"===a.declaredClass)c=a.defaultSymbol;else if("esri.renderer.UniqueValueRenderer"===a.declaredClass||"esri.renderer.ClassBreaksRenderer"===a.declaredClass)c=a.infos[0].symbol,e=1<a.infos.length;if(c=c&&-1!==c.type.indexOf("fillsymbol")?
null:c)if(c=d.fromJson(c.toJson()),b||e)-1!==c.type.indexOf("linesymbol")?c.setColor(new u(this.sizeRampDarkColor)):(c.setColor(new u(this.sizeRampLightColor)),c.setOutline&&(a=new aa,a.setColor(new u(this.sizeRampDarkColor)),a.setWidth(1.5),c.setOutline(a)));return c},_getDataValues:function(a,b,d,c,e){if(e){var h;v.some([5,3,2],function(e){e=this._getDataValuesByCount(a,b,d,c,e);this._hasFractionalValues(e)||(h=e);return!!h},this);return h}return this._getDataValuesByCount(a,b,d,c,5)},_getDataValuesByCount:function(a,
b,d,c,e,h){e=null==e?5:e;h=null==h?20:h;var f=a.getSizeRangeAtScale(d,this.map.getScale());e=this._interpolateSizeRange(f,e);var g=this._getDataRange(d),l=v.map(e,function(a){return this._getDataValueFromSize(a,g,f)},this);if(!c){var k,l=J.round(l);for(c=1;c<l.length-1;c++)if(k=this._roundDataValue(a,b,d,l[c],l[c-1],h))l[c]=k[0],e[c]=k[1]}return l},_hasFractionalValues:function(a){return v.some(a,function(a){return a!==Math.floor(a)})},_getDataRange:function(a){var b=a.stops;return b?{min:b[0].value,
max:b[b.length-1].value}:{min:a.minDataValue,max:a.maxDataValue}},_interpolateSizeRange:function(a,b){var d=a.minSize;a=(a.maxSize-d)/(b-1);var c,e=[];for(c=0;c<b;c++)e.push(d+a*c);return e},_getDataValueFromSize:function(a,b,d){var c=d.minSize;d=d.maxSize;var e=b.min;b=b.max;return a<=c?e:a>=d?b:(a-c)/(d-c)*(b-e)+e},_roundDataValue:function(a,b,d,c,e,h){var f=this._getSize(b,a,d,c);e=this._getSize(b,a,d,e);var g,l=J.getDigits(c),k=l.integer,l=l.fractional,m,n,q,p,w,x,u,r,v,t,B;0<c&&1>c&&(g=Math.pow(10,
l),c*=g,k=J.getDigits(c).integer);for(--k;0<=k&&(m=Math.pow(10,k),l=Math.floor(c/m)*m,m*=Math.ceil(c/m),null!=g&&(l/=g,m/=g),n=(l+m)/2,n=J.round([l,n,m],{indexes:[1]})[1],q=this._getSize(b,a,d,l),p=this._getSize(b,a,d,m),w=this._getSize(b,a,d,n),x=J.getPctChange(f,q,e,null),u=J.getPctChange(f,p,e,null),r=J.getPctChange(f,w,e,null),v=x.prev<=h,t=u.prev<=h,v&&t&&(x.prev<=u.prev?(v=!0,t=!1):(t=!0,v=!1)),v?B=[l,q]:t?B=[m,p]:r.prev<=h&&(B=[n,w]),!B);k--);return B},_applySize:function(a,b,d,c){var e=a.type;
b=this._getSize(a,b,d,c);switch(e){case "simplemarkersymbol":a.setSize(b);break;case "picturemarkersymbol":e=a.width;d=a.height;a.setHeight(b);a.setWidth(e/d*b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b);break;case "textsymbol":a.font&&a.font.setSize(b)}},_getSize:function(a,b,d,c){return b.getSize(c,{sizeInfo:d,scale:this.map.getScale(),shape:-1!==a.type.indexOf("markersymbol")?a.style:null})},_buildRow_Renderer:function(a,b,d,c,e,h,f,g){var l=!!g,k=w.create("tr",{},
h),m;if(this.alignRight){if(h=w.create("td",{align:this._isRightToLeft?"left":"right"},k),b||l)m=w.create("td",{align:this._isRightToLeft?"left":"right",width:35},k)}else{if(b||l)m=w.create("td",{width:35,align:"center"},k);h=w.create("td",{},k)}var n=k=30,q;if(b)if("simplemarkersymbol"==b.type)k=Math.min(Math.max(k,b.size+12),125),n=Math.min(Math.max(n,b.size+12),125);else if("picturemarkersymbol"==b.type)k=Math.min(Math.max(k,b.width),125),n=Math.min(b.height||n,125);else if("textsymbol"==b.type){var p,
x;b.text||(p=b.text,x=!0,b.setText(this.defaultText));k=Math.min(Math.max(k,b.getWidth()+12),125);n=Math.min(Math.max(n,b.getHeight()+12),125);x&&b.setText(p)}if(b||l)q=w.create("div",{style:"width:"+k+"px;height:"+n+"px;"},m);K.isDefined(c)&&"number"===typeof c&&(c=""+c);w.create("td",{innerHTML:c||"",align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%"},h))));if(b||l)a=this._drawSymbol(q,b,d,k,n,e,a,f,g),this._surfaceItems.push(a)},_addSubHeader:function(a,b){a=
w.create("tr",{},a);a=w.create("td",{align:this._align,colspan:2},a);w.create("td",{innerHTML:G.encode(b)||"",align:this._align},w.create("tr",{},w.create("tbody",{},w.create("table",{width:"95%"},a))))},_drawSymbol:function(a,b,c,e,h,g,l,k,m){var n=b&&d.fromJson(b.toJson()),p=l.opacity;b=!!m;if(n)if(c&&n.setColor(new u(c.toRgba())),"simplelinesymbol"===n.type||"cartographiclinesymbol"===n.type||"textsymbol"===n.type){if(!n.color)return;c=n.color.toRgba();c[3]*=p;n.color.setColor(c)}else"simplemarkersymbol"===
n.type||"simplefillsymbol"===n.type?(n.color&&(c=n.color.toRgba(),c[3]*=p,n.color.setColor(c)),n.outline&&n.outline.color&&(c=n.outline.color.toRgba(),c[3]*=p,n.outline.color.setColor(c))):"picturemarkersymbol"===n.type&&(a.style.opacity=p,a.style.filter="alpha(opacity\x3d("+100*p+"))");a=E.createSurface(a,e,h);9>f("ie")&&(c=a.getEventSource(),q.set(c,"position","relative"),q.set(c.parentNode,"position","relative"));g=b?m.shapeDescriptor:this._getDrawingToolShape(n,g)||d.getShapeDescriptors(n);var w,
p=(c=g.defaultShape)&&"text"===c.type;try{p&&!c.text&&(c.text=this.defaultText),w=a.createShape(k||c).setFill(g.fill).setStroke(g.stroke),p&&w.setFont(g.font)}catch(fa){a.clear();a.destroy();return}var x=w.getBoundingBox();k=x.width;g=x.height;var p=-(x.x+k/2),r=-(x.y+g/2);c=a.getDimensions();p={dx:p+c.width/2,dy:r+c.height/2};if(n&&"simplemarkersymbol"===n.type&&"path"===n.style)e=l._getScaleMatrix(x,n.size),w.applyTransform(B.scaleAt(e.xx,e.yy,{x:c.width/2,y:c.height/2}));else if(k>e||g>h)l=k/e>
g/h,e=((l?e:h)-5)/(l?k:g),t.mixin(p,{xx:e,yy:e});w.applyTransform(p);b&&w.applyTransform(B.rotategAt(m.rotation,k/2,g/2));return a},_getDrawingToolShape:function(a,b){switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":b={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z"};break;case "esriFeatureEditToolTriangle":b={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 Z"};break;case "esriFeatureEditToolRectangle":b={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"};
break;case "esriFeatureEditToolCircle":b={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":b={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:b,fill:a.getFill(),stroke:a.getStroke()}},_drawRelationshipLegend:function(a,b){var d=b.focus,c=b.numClasses,e=H[c],h=!!d,f=Math.sqrt(Math.pow(75,2)+Math.pow(75,2)),g={};b.uvInfos.forEach(function(a){g[a.value]={label:a.label,fill:this._getSymbolColor(a.symbol)}},this);b=[];for(var k=0;k<c;k++){for(var m=
[],n=0;n<c;n++)m.push(g[e[k][n]].fill);b.push(m)}e=this._getRelationshipCornerLabels(d,g);a=this._drawRampLayout(a,e,f,h);a=E.createSurface(a,f,f);h||(a.rawNode.style.margin="-15px -15px -18px -15px");b=l.create2DColorRamp({surface:a,colors:b,numClasses:c,size:75});c=(f-75)/2;f=(f-75)/2;b.applyTransform(B.translate(c,f));h&&b.applyTransform(B.rotategAt(this._getRotationAngleForFocus(d),37.5,37.5));b=a.createGroup();e={width:1,color:"#555555"};k=a.defNode;this._createArrowMarker(k,"start");this._createArrowMarker(k,
"end");k=b.createLine({x1:-10,y1:60,x2:-10,y2:15}).setStroke(e);e=b.createLine({x1:15,y1:85,x2:60,y2:85}).setStroke(e);this._setLineArrow(k.rawNode,"left",d);this._setLineArrow(e.rawNode,"right",d);b.applyTransform(B.translate(c,f));h&&b.applyTransform(B.rotategAt(-45,37.5,37.5));this._surfaceItems.push(a)},_drawRampLayout:function(a,b,d,c){var e=w.create("div",{style:{padding:"10px"}},a);a=d+"px";d+="px";c?(c=w.create("div",{style:{display:"flex"}},e),w.create("div",{class:"esriLegendRelationshipLabel",
style:{alignSelf:"center",maxWidth:a,textAlign:"right"},innerHTML:b.left},c),e=w.create("div",{style:{display:"flex",flexDirection:"column",textAlign:"center"}},c),w.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:a},innerHTML:b.right},c),c=w.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",maxWidth:a},innerHTML:b.top},e),c=w.create("div",{style:{height:d,width:d}},e),e=w.create("div",{class:"esriLegendRelationshipLabel",style:{alignSelf:"center",
maxWidth:a},innerHTML:b.bottom},e)):(e=w.create("div",{style:{display:"table",color:"#555555"}},e),c=w.create("div",{style:{display:"table-row"}},e),d=w.create("div",{style:{display:"table-row"}},e),e=w.create("div",{style:{display:"table-row"}},e),w.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:a,textAlign:"right",verticalAlign:"bottom"},innerHTML:b.left},c),w.create("div",{style:{display:"table-cell"}},c),w.create("div",{class:"esriLegendRelationshipLabel",
style:{display:"table-cell",maxWidth:a,textAlign:"left",verticalAlign:"bottom"},innerHTML:b.top},c),w.create("div",{style:{display:"table-cell"}},d),c=w.create("div",{style:{display:"table-cell"}},d),w.create("div",{style:{display:"table-cell"}},d),w.create("div",{class:"esriLegendRelationshipLabel",style:{display:"table-cell",maxWidth:a,textAlign:"right",verticalAlign:"top"},innerHTML:b.bottom},e),w.create("div",{style:{display:"table-cell"}},e),w.create("div",{class:"esriLegendRelationshipLabel",
style:{display:"table-cell",maxWidth:a,textAlign:"left",verticalAlign:"top"},innerHTML:b.right},e));return c},_getSymbolColor:function(a){if(a)return"simplelinesymbol"===a.type||"simplemarkersymbol"===a.type&&(a.style===X.STYLE_X||a.style===X.STYLE_CROSS)?(a=a.getStroke())&&a.color:a.getFill()},_getRotationAngleForFocus:function(a){var b=ba[a];a&&null==b&&(b=ba.HH);return b},_setLineArrow:function(a,b,d){var c=this.id+"_arrowStart",e=this.id+"_arrowEnd";b="left"===b;switch(d){case "HL":a.setAttribute(b?
"marker-start":"marker-end","url(#"+(b?e:c)+")");break;case "LL":a.setAttribute("marker-start","url(#"+e+")");break;case "LH":a.setAttribute(b?"marker-end":"marker-start","url(#"+(b?c:e)+")");break;default:a.setAttribute("marker-end","url(#"+c+")")}},_createArrowMarker:function(a,b){var d="start"===b,c=this.id+(d?"_arrowStart":"_arrowEnd");b=d?"0,0 5,5 0,10":"5,0 0,5 5,10";var e=d?5:0,d=document.createElementNS("http://www.w3.org/2000/svg","marker");d.setAttribute("id",c);d.setAttribute("markerWidth",
"10");d.setAttribute("markerHeight","10");d.setAttribute("refX",e);d.setAttribute("refY","5");d.setAttribute("markerUnits","strokeWidth");d.setAttribute("orient","auto");c=document.createElementNS("http://www.w3.org/2000/svg","polyline");c.setAttribute("points",b);c.setAttribute("fill","none");c.setAttribute("stroke","#555555");c.setAttribute("stroke-width","1");d.appendChild(c);a.appendChild(d)},_getRelationshipCornerLabels:function(a,b){var d=b.HH.label,c=b.LL.label,e=b.HL.label;b=b.LH.label;switch(a){case "HH":return{top:d,
bottom:c,left:e,right:b};case "HL":return{top:e,bottom:b,left:c,right:d};case "LL":return{top:c,bottom:d,left:b,right:e};case "LH":return{top:b,bottom:e,left:d,right:c};default:return{top:d,bottom:c,left:e,right:b}}},_repaintItems:function(){v.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},_repaint:function(a){if(a){a.getStroke&&a.setStroke&&a.setStroke(a.getStroke());try{a.getFill&&a.setFill&&a.setFill(a.getFill())}catch(N){}a.children&&t.isArray(a.children)&&v.forEach(a.children,
this._repaint,this)}},_createHoverAction:function(a,b,d,c){if(c=b._hoverLabel||b._hoverLabels&&b._hoverLabels[d.id]||c)c=G.encode(c),b.mouseMoveHandler=b.mouseMoveHandler||{},b.mouseMoveHandler[d.id]=n.connect(a,"onmousemove",t.hitch(this,function(a,b){this.mouseX=b.clientX;this.mouseY=b.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,q.set(x.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(t.hitch(this,function(a,b,d){if(a==this.mouseX&&b==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=
!0,x.byId(this.id+"_hoverLabel")){var c=x.byId(this.id+"_hoverLabel");c.innerHTML="\x3cspan\x3e"+d+"\x3c/span\x3e";q.set(c,"top",b+"px");q.set(c,"left",a+15+"px");q.set(c,"display","")}else w.create("div",{innerHTML:"\x3cspan\x3e"+d+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:b+"px",left:a+15+"px"}},document.body)},b.clientX,b.clientY,a),500)},c)),b.mouseOutHandler=b.mouseOutHandler||{},b.mouseOutHandler[d.id]=n.connect(a,"onmouseout",t.hitch(this,function(a){this.mouseY=
this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,q.set(x.byId(this.id+"_hoverLabel"),"display","none"))}))},_removeHoverHandlers:function(){var a;v.forEach(this.layers,function(b){if(b.mouseMoveHandler)for(a in b.mouseMoveHandler)n.disconnect(b.mouseMoveHandler[a]);if(b.mouseOutHandler)for(a in b.mouseOutHandler)n.disconnect(b.mouseOutHandler[a])})},_createDynamicLayers:function(a){var b=[],d;v.forEach(a.dynamicLayerInfos||a.layerInfos,function(c){d={id:c.id};d.source=c.source&&c.source.toJson();
var e;a.layerDefinitions&&a.layerDefinitions[c.id]&&(e=a.layerDefinitions[c.id]);e&&(d.definitionExpression=e);var h;a.layerDrawingOptions&&a.layerDrawingOptions[c.id]&&(h=a.layerDrawingOptions[c.id]);h&&(d.drawingInfo=h.toJson());d.minScale=c.minScale||0;d.maxScale=c.maxScale||0;b.push(d)});return b},_getTemplateFromTypes:function(a,b){var d;for(d=0;d<a.length;d++)if(a[d].id==b&&a[d].templates&&0<a[d].templates.length)return a[d].templates[0];return null},_findParentGroup:function(a,b,d){var c,e=
b.dynamicLayerInfos||b.layerInfos;for(c=0;c<e.length;c++)if(d==e[c].id){-1<e[c].parentLayerId&&(q.set(x.byId(this.id+"_"+a+"_"+e[c].parentLayerId+"_group"),"display","block"),this._findParentGroup(a,b,e[c].parentLayerId));break}},_addSubLayersToHide:function(a){function b(d,c){var e=a.layer.dynamicLayerInfos||a.layer.layerInfos,h,f;for(h=0;h<e.length;h++)if(e[h].id===d&&e[h].subLayerIds)for(f=0;f<e[h].subLayerIds.length;f++){var g=e[h].subLayerIds[f];-1===v.indexOf(c,g)&&(c.push(g),b(g,c))}}a.layer.layerInfos&&
v.forEach(this.hideLayersInLegend[a.layer.id],function(d){b(d,this.hideLayersInLegend[a.layer.id])},this)},_isLayerInScale:function(a,b,d){var c,e=!0;if(a.legendResponse&&a.legendResponse.layers)for(c=0;c<a.legendResponse.layers.length;c++){var h=a.legendResponse.layers[c];if(b.id==h.layerId){var f,g;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0==h.minScale&&a.tileInfo&&(f=a.tileInfo.lods[0].scale),0==h.maxScale&&a.tileInfo&&(g=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(f=Math.min(a.minScale,
h.minScale)||a.minScale||h.minScale,g=Math.max(a.maxScale,h.maxScale));if(0<f&&f<d||g>d)e=!1;break}}else if(a.minScale||a.maxScale)if(a.minScale&&a.minScale<d||a.maxScale&&a.maxScale>d)e=!1;return e},_getServiceTitle:function(a){var b=a._titleForLegend;b||(b=a.url,a.url?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+
1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(b=0<b.length?b+(" - "+a.name):a.name));"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass&&a.vectorFieldPixelFilter&&(a=a.vectorFieldPixelFilter.outputUnit?this["NLS_"+a.vectorFieldPixelFilter.outputUnit]:this["NLS_"+a.vectorFieldPixelFilter.inputUnit],K.isDefined(a)&&(b+=" ("+a+")"));return G.encode(b)},_getEffectiveScale:function(a,
b){var d=b.minScale,c=b.maxScale;if(K.isDefined(b.parentLayerId)){a=a.layerInfos;b=b.parentLayerId;var e;for(e=a.length-1;0<=e;e--)if(a[e].id==b)if(0==d&&0<a[e].minScale?d=a[e].minScale:0<d&&0==a[e].minScale||0<d&&0<a[e].minScale&&(d=Math.min(d,a[e].minScale)),c=Math.max(c||0,a[e].maxScale||0),-1<a[e].parentLayerId)b=a[e].parentLayerId;else break}return{minScale:d,maxScale:c}},_isSupportedLayerType:function(a){return!(!a||!("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===
a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===a.declaredClass||"esri.layers.WMSLayer"===a.declaredClass||"esri.layers.WFSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass))},isHostedTileService:function(a){var b=
/(https?:)?\/\/services.*\.arcgis\.com/i;return!("esri.layers.ArcGISTiledMapServiceLayer"!==a.declaredClass||!b.test(a.url))},getField:function(a,b,d){if(a.getField)return a.getField(b);if(d&&d.fields){var c;v.forEach(d.fields,function(a){a.name===b&&(c=a)});return c}return null}});t.mixin(ea,{ALIGN_LEFT:0,ALIGN_RIGHT:1});return ea})},"dojo/debounce":function(){define([],function(){return function(p,g){var t;return function(){t&&clearTimeout(t);var v=this,n=arguments;t=setTimeout(function(){p.apply(v,
n)},g)}}})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(p,g,t,v){var n=function(g,k){return g-k},m={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(g){var k=String(g),f=k.match(m._reNumber);g={integer:0,fractional:0};f&&f[1]?(g.integer=f[1].split("").length,g.fractional=f[3]?f[3].split("").length:0):-1<k.toLowerCase().indexOf("e")&&(f=k.split("e"),k=f[0],f=f[1],k&&f&&(k=Number(k),f=Number(f),(g=0<f)||(f=Math.abs(f)),k=m.getDigits(k),
g?(k.integer+=f,k.fractional=f>k.fractional?0:k.fractional-f):(k.fractional+=f,k.integer=f>k.integer?1:k.integer-f),g=k));return g},getFixedNumbers:function(g,k){var f;f=Number(g.toFixed(k));f<g?g=f+1/Math.pow(10,k):(g=f,f-=1/Math.pow(10,k));f=Number(f.toFixed(k));g=Number(g.toFixed(k));return[f,g]},getPctChange:function(g,k,f,e){var b={prev:null,next:null},a;null!=f&&(a=g-f,b.prev=Math.floor(Math.abs(100*(k-f-a)/a)));null!=e&&(a=e-g,b.next=Math.floor(Math.abs(100*(e-k-a)/a)));return b},round:function(g,
k){g=g.slice(0);var f,e,b,a,c,p,w,q,u=k&&null!=k.tolerance?k.tolerance:2,v=k&&k.indexes,t=k&&null!=k.strictBounds?k.strictBounds:!1;if(v)v.sort(n);else for(v=[],c=0;c<g.length;c++)v.push(c);for(c=0;c<v.length;c++)if(q=v[c],k=g[q],f=0===q?null:g[q-1],e=q===g.length-1?null:g[q+1],b=m.getDigits(k),b=b.fractional){p=0;for(w=!1;p<=b&&!w;)a=m.getFixedNumbers(k,p),a=t&&0===c?a[1]:a[0],w=m.hasMinimalChange(k,a,f,e,u),p++;w&&(g[q]=a)}return g},hasMinimalChange:function(g,k,f,e,b){g=m.getPctChange(g,k,f,e);
k=null==g.prev||g.prev<=b;f=null==g.next||g.next<=b;return k&&f||g.prev+g.next<=2*b},_reAllZeros:new RegExp("\\"+t.decimal+"0+$","g"),_reSomeZeros:/(\d)0*$/g,format:function(n,k){k=k||{places:20,round:-1};(n=g.format(n,k))&&(n=n.replace(m._reSomeZeros,"$1").replace(m._reAllZeros,""));return n}};return m})},"esri/renderers/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!dojo/cldr/nls/gregorian".split(" "),function(p,g,
t,v,n,m,u,k){function f(a){return a&&g.map(a,function(a){return new u(a)})}function e(b,c,e){var f="";0===c?f=a.lt+" ":c===e&&(f=a.gt+" ");return f+b}var b={},a={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%"},c={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},x={millisecond:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},second:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"medium"}},minute:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},
hour:{dateOptions:{formatLength:"long"},timeOptions:{formatLength:"short"}},day:{selector:"date",dateOptions:{formatLength:"long"}},month:{selector:"date",dateOptions:{formatLength:"long"}},year:{selector:"date",dateOptions:{selector:"year"}}},w={formatLength:"short",fullYear:!0},q={formatLength:"short"};p.mixin(b,{timelineDateFormatOptions:{selector:"date",dateOptions:{formatLength:"short",fullYear:!0}},formatDate:function(a,b){var c=[];null==a||a instanceof Date||(a=new Date(a));b=b||{};b=p.mixin({},
b);var e=b.selector?b.selector.toLowerCase():null,f=!e||-1<e.indexOf("time"),e=!e||-1<e.indexOf("date");f&&(b.timeOptions=b.timeOptions||q,b.timeOptions&&(b.timeOptions=p.mixin({},b.timeOptions),b.timeOptions.selector=b.timeOptions.selector||"time",c.push(b.timeOptions)));e&&(b.dateOptions=b.dateOptions||w,b.dateOptions&&(b.dateOptions=p.mixin({},b.dateOptions),b.dateOptions.selector=b.dateOptions.selector||"date",c.push(b.dateOptions)));c&&c.length?(c=g.map(c,function(b){return v.format(a,b)}),b=
1==c.length?c[0]:k["dateTimeFormat-medium"].replace(/\'/g,"").replace(/\{(\d+)\}/g,function(a,b){return c[b]})):b=v.format(a);return b},createColorStops:function(a){var c=a.values,f=a.colors,k=a.labelIndexes,n=a.isDate,q=a.dateFormatOptions;a=[];return a=g.map(c,function(a,p){var w=null;if(!k||-1<g.indexOf(k,p)){var x;(x=n?b.formatDate(a,q):m.format(a))&&(w=e(x,p,c.length-1))}return{value:a,color:f[p],label:w}})},updateColorStops:function(a){var c=a.stops,f=a.changes,k=a.isDate,n=a.dateFormatOptions,
q=[],p,w=g.map(c,function(a){return a.value});g.forEach(f,function(a){q.push(a.index);w[a.index]=a.value});p=m.round(w,{indexes:q});g.forEach(c,function(a,f){a.value=w[f];if(null!=a.label){var g,q=null;(g=k?b.formatDate(p[f],n):m.format(p[f]))&&(q=e(g,f,c.length-1));a.label=q}})},createClassBreakLabel:function(b){var c=b.minValue,e=b.maxValue,f=b.isFirstBreak?"":a.gt+" ";b="percent-of-total"===b.normalizationType?a.pct:"";c=null==c?"":m.format(c);e=null==e?"":m.format(e);return f+c+b+" \u2013 "+e+
b},setLabelsForClassBreaks:function(a){var c=a.classBreaks,e=a.classificationMethod,f=a.normalizationType,k=[];c&&c.length&&("standard-deviation"===e?console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method."):a.round?(k.push(c[0].minValue),g.forEach(c,function(a){k.push(a.maxValue)}),k=m.round(k),g.forEach(c,function(a,c){a.label=b.createClassBreakLabel({minValue:0===c?k[0]:k[c],maxValue:k[c+1],isFirstBreak:0===c,normalizationType:f})})):
g.forEach(c,function(a,c){a.label=b.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===c,normalizationType:f})}))},updateClassBreak:function(a){var c=a.classBreaks,e=a.normalizationType,f=a.change,g=f.index,f=f.value,k=-1,m=-1,n=c.length;"standard-deviation"===a.classificationMethod?console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method."):(0===g?k=g:g===n?m=g-1:(m=g-1,k=g),-1<k&&k<n&&(a=c[k],a.minValue=f,a.label=
b.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===k,normalizationType:e})),-1<m&&m<n&&(a=c[m],a.maxValue=f,a.label=b.createClassBreakLabel({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===m,normalizationType:e})))},calculateDateFormatInterval:function(a){var b,e,f=a.length,k,m,n,q,p,w,x=Infinity,u;a=g.map(a,function(a){return new Date(a)});for(b=0;b<f-1;b++){k=a[b];n=[];p=Infinity;w="";for(e=b+1;e<f;e++)m=a[e],m=k.getFullYear()!==m.getFullYear()&&"year"||k.getMonth()!==
m.getMonth()&&"month"||k.getDate()!==m.getDate()&&"day"||k.getHours()!==m.getHours()&&"hour"||k.getMinutes()!==m.getMinutes()&&"minute"||k.getSeconds()!==m.getSeconds()&&"second"||"millisecond",q=c[m],q<p&&(p=q,w=m),n.push(m);p<x&&(x=p,u=w)}return u},createUniqueValueLabel:function(a){var c=a.value,e=a.fieldInfo,f=a.domain;a=a.dateFormatInterval;var g=String(c);(f=f&&f.codedValues?f.getName(c):null)?g=f:"number"===typeof c&&(g=e&&"esriFieldTypeDate"===e.type?b.formatDate(c,a&&x[a]):m.format(c));return g},
cloneColorInfo:function(a){var b;a&&(b=p.mixin({},a),b.colors=f(b.colors),b.stops=b.stops&&g.map(b.stops,function(a){a=p.mixin({},a);a.color&&(a.color=new u(a.color));return a}),b.legendOptions&&(b.legendOptions=p.mixin({},b.legendOptions)));return b},cloneOpacityInfo:function(a){var b;if(a){b=p.mixin({},a);if(a=b.opacityValues)b.opacityValues=a.slice(0);if(a=b.stops)b.stops=g.map(a,function(a){return p.mixin({},a)});if(a=b.legendOptions)b.legendOptions=p.mixin({},a)}return b},cloneSizeInfo:function(a){var c;
a&&(c=p.mixin({},a),c.stops&&(c.stops=g.map(c.stops,function(a){return p.mixin({},a)})),(a=c.minSize)&&"object"===typeof a&&(c.minSize=b.cloneSizeInfo(a)),(a=c.maxSize)&&"object"===typeof a&&(c.maxSize=b.cloneSizeInfo(a)),a=c.legendOptions)&&(c.legendOptions=p.mixin({},a),a=a.customValues)&&(c.legendOptions.customValues=a.slice(0));return c},getClassCodesForRelationship:function(){return p.clone({2:["L","H"],3:["L","M","H"],4:["L","M1","M2","H"]})},getClassValuesForRelationship:function(){return p.clone({2:[["HL",
"HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]})}});return b})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define("dojo/_base/declare dojo/_base/array dojo/Deferred esri/lang jimu/utils ./LayerInfo".split(" "),function(p,g,t,v,n,m){return p(m,{constructor:function(){},_getExtent:function(){var g=new t,k=this.layerObject.items,f=this.layerObject.fullExtent||this.layerObject.initialExtent;
0===k.length?g.resolve(f):g.resolve(n.graphicsExtent(k));return g},_resetLayerObjectVisiblity:function(g){var k=g?g[this.id]:null;if(k){var f={},e;for(e in g)g.hasOwnProperty(e)&&"function"!==typeof g[e]&&(f[e]=g[e].visible);this._setSubLayerVisibleByCheckedInfo(f);this._setTopLayerVisible(k.visible)}},_setSubLayerVisibleByCheckedInfo:function(m){g.forEach(this.newSubLayers,function(g){v.isDefined(m[g.id])&&g.layerObject.setVisibility(m[g.id])},this)},_initVisible:function(){var g=!1,k;for(k=0;k<
this.newSubLayers.length;k++)g=g||this.newSubLayers[k].layerObject.visible;g&&(this._visible=!0)},_setTopLayerVisible:function(m){this._visible=m?!0:!1;g.forEach(this.newSubLayers,function(g){g.setLayerVisiblefromTopLayer()},this);this._onVisibilityChanged()},obtainNewSubLayers:function(){var m=[],k=this.layerObject.getFeatureLayers();g.forEach(k,function(f){f=this._layerInfoFactory.create({layerObject:f,title:f.label||f.title||f.name||f.id||" ",id:f.id||" ",subId:f.id||" ",collection:{layerInfo:this},
selfType:"geo_rss",parentLayerInfo:this});m.push(f);f.init()},this);this._markInvalidSubLayerInfoThatAsRootLayer(k);return m},_markInvalidSubLayerInfoThatAsRootLayer:function(m){var k;g.forEach(m,function(f){if(k=this._getLayerInfosObj()._findTopLayerInfoById(f.id))k._flag._invalid=!0},this)},_needToRenew:function(){var g=this.layerObject.getFeatureLayers();return(g?g.length:0)===this.newSubLayers.length?!1:!0},_obtainLayerIndexesInMap:function(){var g=[],k,f;for(f=0;f<this.newSubLayers.length;f++)(k=
this._getLayerIndexesInMapByLayerId(this.newSubLayers[f].layerObject.id))&&g.push(k);return g},moveLeftOfIndex:function(g){var k;for(k=this.newSubLayers.length-1;0<=k;k--)this.map.reorderLayer(this.newSubLayers[k].layerObject,g)},moveRightOfIndex:function(g){var k;for(k=0;k<this.newSubLayers.length;k++)this.map.reorderLayer(this.newSubLayers[k].layerObject,g)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS esri/layers/FeatureLayer esri/lang".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p(k,{constructor:function(a,b){},_getExtent:function(){var a=new n;a.resolve(this.layerObject.extent||this.layerObject.fullExtent);return a},_initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(a){this._visible=a;this.layerObject.setVisibility(a)},_setSubLayerVisible:function(a){var b=[],e,b=t.clone(this.originOperLayer.layerObject.visibleLayers),f;for(f in a)if(a.hasOwnProperty(f)&&"function"!==typeof a[f]){var k=a[f],
m=f.toString();e=g.indexOf(b,m);k?0>e&&b.push(m):0<=e&&b.splice(e,1)}this._setVisibleLayersBySelfFlag=!0;this.layerObject.setVisibleLayers(b)},_resetLayerObjectVisiblity:function(a){var b=a?a[this.id]:null,e=!1;if(a){b&&this.layerObject.setVisibility(b.visible);var b={},f;for(f in a)a.hasOwnProperty(f)&&"function"!==typeof a[f]&&(e=!0,b[f]=a[f].visible);e&&this._setSubLayerVisibleByCheckedInfo(b)}},_setSubLayerVisibleByCheckedInfo:function(a){var c={};this.traversal(function(c){c.isRootLayer()||b.isDefined(a[c.id])&&
c._setVisible(a[c.id])});this.traversal(function(a){0===a.getSubLayers().length&&(c[a.subId]=a._isAllSubLayerVisibleOnPath())});this._setSubLayerVisible(c)},_getServiceDefinition:function(){var a=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(a)},_serviceDefinitionRequest:function(a){return this._normalRequest(a,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var a=[];g.forEach(this.layerObject.layerInfos,function(b,e){b=this._getOperLayerFromWMSLayerInfo(b,
this);b=this._layerInfoFactory.create(b);a.push(b);b.init()},this);a.reverse();return a},_getOperLayerFromWMSLayerInfo:function(a,b){return{layerObject:this.layerObject,title:a.label||a.title||a.name||" ",id:this.id+"_"+(a.name||a.title+"-"+Math.random()),subId:a.name||"-",wms:{layerInfo:this,subId:a.name||"-",wmsLayerInfo:a},selfType:"wms",parentLayerInfo:b}},_bindEvent:function(){this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&u.after(this.layerObject,"setVisibleLayers",t.hitch(this,
this._onVisibleLayersChanged))},_onVisibleLayersChanged:function(){var a=[];this._setVisibleLayersBySelfFlag||(this.traversal(function(a){a.isRootLayer()||a._initVisible()}),this._setVisibleLayersBySelfFlag=!1);this.traversal(function(b){b.isRootLayer()||a.push(b)});this._setVisibleLayersBySelfFlag=!1;v.publish("layerInfos/layerInfo/visibleChanged",a);this._isShowInMapChanged2()}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),
function(p,g,t,v,n,m){return p(m,{constructor:function(g,k){this.layerObject=g.layerObject},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var m=!1;this.traversal(function(k){if(0<=g.indexOf(k.layerObject.visibleLayers,k.subId))return m=!0});this._visible=m},_setVisible:function(g){this._visible=g?!0:!1},_setTopLayerVisible:function(g){var k=this.originOperLayer.wms;this._visible=g?!0:!1;var f={};this.traversal(function(e){0===e.getSubLayers().length&&(f[e.subId]=e._isAllSubLayerVisibleOnPath())});
k.layerInfo._setSubLayerVisible(f)},_getServiceDefinition:function(){var g=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(g)},_serviceDefinitionRequest:function(g){return this._normalRequest(g,{SERVICE:"WMS",REQUEST:"GetCapabilities"},"xml")},obtainNewSubLayers:function(){var m=[],k=this.originOperLayer.wms;g.forEach(k.wmsLayerInfo.subLayers,function(f){f=k.layerInfo._getOperLayerFromWMSLayerInfo(f,this);f=this._layerInfoFactory.create(f);m.push(f);f.init()},this);
return m},drawLegends:function(g){this._initLegendsNode(g)},_initLegendsNode:function(g){if(this.originOperLayer.wms.wmsLayerInfo.legendURL){var k=v.create("img",{"class":"legend-div-image",src:this.originOperLayer.wms.wmsLayerInfo.legendURL});n(k,"load",function(){v.empty(g);var f=v.create("div",{"class":"legend-div"},g);t.place(k,f)})}else v.empty(g)},getOpacity:function(){},setOpacity:function(g){},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.originOperLayer.wms.layerInfo.getScaleRange()}})})},
"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(p,g){return p(g,{constructor:function(g,p){},_initVisible:function(){var g=!1,p=this.originOperLayer.mapService;p&&p.layerInfo._subLayerVisible[p.subId]&&(g=!0);this._visible=g},_setTopLayerVisible:function(g){var p=this.originOperLayer.mapService;if(p){p.layerInfo._subLayerVisible[p.subId]=g?!0:!1;this._visible=g;var n={};this.traversal(function(g){0===g.getSubLayers().length&&
(n[g.originOperLayer.mapService.subId]=g._isAllSubLayerVisibleOnPath())});p.layerInfo._setSubLayerVisible(n)}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/topic dojo/dom-construct ./LayerInfoForDefault ./LayerObjectFacory".split(" "),function(p,g,t,v,n,m,u,k){return p(u,{_legendsNode:null,_layerObjectFacory:null,constructor:function(){this._layerObjectFacory=new k(this)},_resetLayerObjectVisiblity:function(){},
_loadLegends:function(f){var e=new v;this.originOperLayer.mapService.layerInfo.getLegendInfo(f).then(t.hitch(this,function(b){e.resolve(b)}));return e},drawLegends:function(f,e){this._loadLegends(e).then(t.hitch(this,function(b){this._initLegendsNode(b,f)}))},_initLegendsNode:function(f,e){var b=this.originOperLayer.mapService;if(f){m.empty(e);for(var a=null,c=0;c<f.length;c++)if(f[c].layerId===b.subId){a=f[c];break}if(a){var k=m.create("table",{"class":"legend-table",style:"font-size: 12px"},e);
g.forEach(a.legend,function(a){if("\x3call other values\x3e"!==a.label){var b=m.create("tr",{"class":"legend-tr",style:"border: 1px solid"},k),c=m.create("td",{"class":"legend-symbol-td",style:""},b),e=null,e=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;m.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;top:0;left:0;bottom:0;right:0",src:e},c);m.create("td",{"class":"legend-label-td",innerHTML:a.label||" ",style:"padding-left: 5px"},b)}},this)}}},_initControlPopup:function(){var f=
this.originOperLayer.mapService.layerInfo.layerObject,e=this.originOperLayer.mapService.subId;this.controlPopupInfo={enablePopup:f.infoTemplates&&f.infoTemplates[e]?!0:!1,infoTemplates:void 0}},_afterSetInfoTemplates:function(){var f=this.originOperLayer.mapService.layerInfo.layerObject,e=this.originOperLayer.mapService.subId;!this.controlPopupInfo.enablePopup&&f.infoTemplates&&delete f.infoTemplates[e]},_getShowLegendOfWebmap:function(){return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId)},
_getServiceDefinition:function(){return this.originOperLayer.mapService.layerInfo._getSubserviceDefinition(this.originOperLayer.mapService.mapServiceSubId)},_getLayerObject:function(f){var e=new v;(f?this._layerObjectFacory.getLayerObjectWithUrl(f):this._layerObjectFacory.getLayerObject()).then(t.hitch(this,function(b){this.layerObject.empty&&b&&(this.layerObject=b);e.resolve(b)}));return e},getLayerObject:function(){return this._getLayerObject()},getLayerObjectTryUsingFeatureService:function(){var f;
return this.isItemLayer()?this.getItemInfo().then(t.hitch(this,function(e){e&&e.getItemData()&&e.getItemData().layers&&g.some(e.getItemData().layers,function(b){if(b.id===this.subId)return f=b.layerUrl,!0},this);return f?this._getLayerObject(f):this._getLayerObject()})):this.getLayerObject()},getPopupInfo:function(){var f=null,e=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(e)for(var b=0;b<e.length;b++)if(e[b].id===this.originOperLayer.mapService.subId){f=e[b].popupInfo;break}return f},
getFilterOfWebmap:function(){var f=null,e=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(e)for(var b=0;b<e.length;b++)if(e[b].id===this.originOperLayer.mapService.subId){f=e[b].layerDefinition?e[b].layerDefinition.definitionExpression:null;break}return f},getFilter:function(){var f=this.originOperLayer.mapService;return f.layerInfo.layerObject&&f.layerInfo.layerObject.layerDefinitions?f.layerInfo.layerObject.layerDefinitions[f.subId]:null},setFilter:function(f,e){var b,a=this.originOperLayer.mapService;
a.layerInfo.layerObject&&a.layerInfo.layerObject.setLayerDefinitions&&(b=a.layerInfo.layerObject.layerDefinitions?g.map(a.layerInfo.layerObject.layerDefinitions,function(a){return a}):[],e=t.mixin({},e),t.setObject("_wabProperties.objectPassWithFilterChangeEvent",e,a.layerInfo.layerObject),b[a.subId]=f,a.layerInfo.layerObject.setLayerDefinitions(b))},getLayerType:function(){var f=new v;0<this.getSubLayers().length?f.resolve("GroupLayer"):this._getServiceDefinition().then(t.hitch(this,function(e){e?
f.resolve(e.type.replace(/\ /g,"")):f.resolve(null)}),function(){f.resolve(null)});return f},getSupportTableInfo:function(){var f=new v,e={isSupportedLayer:!1,isSupportQuery:!1,layerType:null};this.getLayerType().then(t.hitch(this,function(b){e.layerType=b;0<=this._getLayerTypesOfSupportTable().indexOf(b)&&(e.isSupportedLayer=!0);this._getServiceDefinition().then(t.hitch(this,function(a){a&&0<=a.capabilities.indexOf("Data")&&(e.isSupportQuery=!0);f.resolve(e)}),function(){f.resolve(e)})}),function(){f.resolve(e)});
return f},enablePopup:function(){var f=this.originOperLayer.mapService.layerInfo,e=f.layerObject,b=this.originOperLayer.mapService.subId;return this.loadInfoTemplate().then(t.hitch(this,function(){return f.controlPopupInfo.infoTemplates&&f.controlPopupInfo.infoTemplates[b]?(this.controlPopupInfo.enablePopup=!0,e.infoTemplates||(e.infoTemplates={}),e.infoTemplates[b]=f.controlPopupInfo.infoTemplates[b],!0):!1}))},disablePopup:function(){var f=this.originOperLayer.mapService.layerInfo.layerObject,e=
this.originOperLayer.mapService.subId;this.controlPopupInfo.enablePopup=!1;f.infoTemplates&&delete f.infoTemplates[e]},loadInfoTemplate:function(){var f=new v,e=this.originOperLayer.mapService.layerInfo,b=this.originOperLayer.mapService.subId;e.controlPopupInfo.infoTemplates&&e.controlPopupInfo.infoTemplates[b]&&e.controlPopupInfo.infoTemplates[b].infoTemplate?f.resolve(e.controlPopupInfo.infoTemplates[b].infoTemplate):(e.controlPopupInfo.infoTemplates||(e.controlPopupInfo.infoTemplates={}),this.getLayerObject().then(t.hitch(this,
function(a){a=this._getDefaultPopupTemplate(a);e.controlPopupInfo.infoTemplates[b]={infoTemplate:a,layerUrl:null};f.resolve(a)}),t.hitch(this,function(){f.resolve(null)})));return f},getInfoTemplate:function(){var f=this.originOperLayer.mapService.layerInfo,e=this.originOperLayer.mapService.subId;return f.controlPopupInfo.infoTemplates&&f.controlPopupInfo.infoTemplates[e]&&f.controlPopupInfo.infoTemplates[e].infoTemplate?f.controlPopupInfo.infoTemplates[e].infoTemplate:null},getScaleRange:function(){var f=
this.originOperLayer.mapService;return(f=f.layerInfo._getJsapiLayerInfoById(f.subId))&&0<=f.minScale&&0<=f.maxScale?{minScale:f.minScale,maxScale:f.maxScale}:{minScale:0,maxScale:0}},setScaleRange:function(f,e){var b=this.originOperLayer.mapService,a=b.layerInfo._getJsapiLayerInfoById(b.subId);b.layerInfo.layerObject&&b.layerInfo.layerObject.supportsDynamicLayers&&b.layerInfo.layerObject.setDynamicLayerInfos&&a&&(a.minScale!==f||a.maxScale!==e)&&(a.minScale=f,a.maxScale=e,b.layerInfo.layerObject.setDynamicLayerInfos(b.layerInfo._jsapiLayerInfos),
n.publish("layerInfos/layerInfo/scaleRangeChanged",[this]))},_onVisibilityChanged:function(){}})})},"jimu/LayerInfos/LayerObjectFacory":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred ./RequestBuffer esri/layers/FeatureLayer esri/layers/RasterLayer esri/layers/StreamLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISImageServiceVectorLayer".split(" "),function(p,g,t,v,n,m,u,k,f,e){return p(null,{_layerInfo:null,_layerObjectBuffer:null,constructor:function(b){this._layerInfo=
b;this._initLayerObjectBuffer()},_initLayerObjectBuffer:function(){this._layerObjectBuffer=new n(g.hitch(this,this._getLayerObject))},getLayerObject:function(){var b=this._layerInfo.getUrl();return this._layerObjectBuffer.getRequest(this._layerInfo.subId).request(b)},getLayerObjectWithUrl:function(b){return this._layerObjectBuffer.getRequest(this._layerInfo.subId+"_url").request(b)},_getLayerObject:function(b){var a,c=new v;this._layerInfo.getLayerType().then(g.hitch(this,function(n){var p=g.mixin(this._getLayerOptionsForCreateLayerObject(),
this._layerInfo.originOperLayer.options||{})||{};switch(n){case "FeatureLayer":a=new m(b,p);break;case "RasterLayer":a=new u(b);break;case "StreamLayer":a=new k(b);break;case "ArcGISImageServiceLayer":a=new f(b);break;case "ArcGISImageServiceVectorLayer":a=new e(b);break;case "Table":if(this._layerInfo.layerObject&&!this._layerInfo.layerObject.empty)return this._setLayerObjectProperties(this._layerInfo.layerObject),c.resolve(this._layerInfo.layerObject),c;if(this._layerInfo.layerObject&&this._layerInfo.layerObject.url)a=
new m(b,p);else return this._layerInfo.layerObject&&this._layerInfo.layerObject.featureCollectionData?(a=new m(this._layerInfo.layerObject.featureCollectionData,p),this._setLayerObjectProperties(a),c.resolve(a)):c.resolve(null),c;break;case "GroupLayer":return c=this._getGroupLayerObject();default:return c.resolve(null),c}var q=a.on("load",g.hitch(this,function(){this._setLayerObjectProperties(a);c.resolve(a);q.remove&&q.remove()})),x=a.on("error",g.hitch(this,function(a){c.reject(a);x.remove&&x.remove()}))}),
g.hitch(this,function(){c.reject()}));return c},_getGroupLayerObject:function(){var b=new v;this._layerInfo._getServiceDefinition().then(g.hitch(this,function(a){if(null===a)b.reject();else{var c=this._layerInfo.getUrl();a.url=c;a.id=this._layerInfo.id;b.resolve(a)}}));return b},_getLayerOptionsForCreateLayerObject:function(){var b={},a=[],c=this._layerInfo.getInfoTemplate();c&&c.info&&c.info.fieldInfos?t.forEach(c.info.fieldInfos,function(b){b.visible&&a.push(b.fieldName)},this):a=["*"];b.outFields=
a;return b},_setLayerObjectProperties:function(b){b.name&&!g.getObject("_wabProperties.originalLayerName",!1,b)&&(g.setObject("_wabProperties.originalLayerName",b.name,b),b.name=this._layerInfo.title);b.id=this._layerInfo.id;this._layerInfo.loadInfoTemplate().then(g.hitch(this,function(a){b.infoTemplate=a}))}})})},"esri/layers/RasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojo/number ../lang ../domUtils ./BaseRasterLayer ./ImageServiceLayerMixin ./pixelFilters/StretchFilter ../SpatialReference ../geometry/Point".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return p([b,a],{declaredClass:"esri.layers.RasterLayer",constructor:function(a,b){this.pixelData=null;null!==this.format&&void 0!==this.format||this.setImageFormat("LERC",!0)},_setDefaultFilter:function(){if(this.loaded&&this.drawType&&!this._isVectorData()&&(!this.pixelFilter||this._isDefaultPixelFilter))if("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))this._isDefaultPixelFilter&&(this.pixelFilter=
null,this._isDefaultPixelFilter=!1);else{var a,b;if(this.minValues&&this.maxValues&&this.stdvValues&&this.meanValues){a=[];for(b=0;b<this.minValues.length;b++)a.push([this.minValues[b],this.maxValues[b],this.meanValues[b],this.stdvValues[b]]);this.bandCount!==a.length&&(a=null)}b=0;var e=!1;"U8"===this.pixelType?(b=5,e=a?!1:!0):a?(b=5,e=!1):(b=6,e=!0);this.renderingRule&&(b=5,e=!0);this.pixelFilter=(new c({stretchType:b,min:0,max:255,dra:e,minPercent:.25,maxPercent:.25,useGamma:!1,computeGamma:!1,
statistics:a,numberOfStandardDeviations:2.5})).filter;this._isDefaultPixelFilter=!0}}})})},"esri/layers/BaseRasterLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../lang ../domUtils ../geometry/Point ./layer".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w=e.defaults.map.zoomDuration;return p([x],{declaredClass:"esri.layers.BaseRasterLayer",managedSuspension:!0,
opacity:1,constructor:function(a,b){this.drawMode=b&&void 0!==b.drawMode?b.drawMode:!0;this.drawType=b&&b.drawType?b.drawType:"2d";this.pixelData=null;this._initialize(a,b)},setDrawMode:function(a){this.drawMode=a},setOpacity:function(a){this.opacity!==a&&(this.opacity=a,this.onOpacityChange(a))},onOpacityChange:function(){},refresh:function(){if(!this._canDraw()||10>n("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else this._map&&this._extentChangeHandler(this._map.extent)},
clear:function(){this._canDraw()&&"2d"===this.drawType&&this._context.clearRect(0,0,this._mapWidth,this._mapHeight)},getContext:function(){return this._context},onResume:function(){this.inherited(arguments);this._toggleTime();if("css-transforms"===this._map.navigationMode){var a=this._map.__visibleDelta;this._left=this._tdx=a.x;this._top=this._tdy=a.y;u.set(this._div,f._css.names.transform,f._css.translate(this._left,this._top))}this._displayTimer=this._displayTimer||setTimeout(g.hitch(this,function(){this._extentChangeHandler(this._map.extent,
null,!0)}),0)},onSuspend:function(){this.inherited(arguments);this._toggleTime();clearTimeout(this._displayTimer);this._displayTimer=null},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getCurrentResolution:function(){var a=this._map.extent;return new c((a.xmax-a.xmin)/this._map.width,(a.ymax-a.ymin)/this._map.height,a.spatialReference)},setPixelFilter:function(a,b){this.pixelFilter=a;b||this.redraw()},_toggleTime:function(){},_setMap:function(a,c){this.inherited(arguments);
this._dragOrigin={x:0,y:0};var e=this._div=m.create("div",null,c),g={width:a.width+"px",height:a.height+"px",position:"absolute"};"css-transforms"===a.navigationMode?(g[f._css.names.transform]=f._css.translate(a.__visibleDelta.x,a.__visibleDelta.y),this._left=a.__visibleDelta.x,this._top=a.__visibleDelta.y):this._left=this._top=0;u.set(e,g);this._canvas=m.create("canvas",{id:"canvas",width:a.width+"px",height:a.height+"px",style:"position: absolute;"},e);b.isDefined(this.opacity)&&u.set(e,"opacity",
this.opacity);(this._context=this._canvas.getContext(this.drawType))||console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements.");this._mapWidth=a.width;this._mapHeight=a.height;this._connects=[];this._connects.push(t.connect(a,"onPan",this,this._panHandler));this._connects.push(t.connect(a,"onPanEnd",this,this._panEndHandler));"css-transforms"===a.navigationMode?this._connects.push(t.connect(a,"onScale",this,this._onScaleHandler)):(this._connects.push(t.connect(a,
"onZoom",this,this._onZoomHandler)),this._connects.push(t.connect(a,"onZoomEnd",this,this._onZoomEndHandler)));this._connects.push(t.connect(a,"onResize",this,this._onResizeHandler));this._connects.push(t.connect(a,"onExtentChange",this,this._extentChangeHandler));this._connects.push(t.connect(this,"onVisibilityChange",this,this._visibilityChangeHandler));this._connects.push(t.connect(this,"onOpacityChange",this,this._opacityChangeHandler));this._startRect={left:0,top:0,width:a.width,height:a.height};
this.evaluateSuspension();if(this.suspended&&!a.loaded)var k=t.connect(a,"onLoad",this,function(){t.disconnect(k);k=null;this.evaluateSuspension()});return e},_unsetMap:function(a,b){v.forEach(this._connects,t.disconnect,this);var c=this._div;c&&(b.removeChild(c),m.destroy(c));this.updating&&a._jobs&&a._jobs--;this._rasterReadPromise&&this._rasterReadPromise.cancel();this._map=this._canvas=this._context=this.data=this._connects=null;clearTimeout(this._displayTimer);this._displayTimer=null;this.inherited(arguments)},
_canDraw:function(){return!!(this._map&&this._canvas&&this._context)},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_drawPixelData:function(){if(this._map){this._startRect={left:0,top:0,width:this._map.width,height:this._map.height};var a=this._useBrowserDecoding();!a&&this.drawMode||"css-transforms"!==this._map.navigationMode||(this._tdx=this._left,this._tdy=this._top,this._multiply=null,u.set(this._div,f._css.names.transform,f._css.translate(this._left,
this._top)),u.set(this._canvas,f._css.names.transform,f._css.translate(-this._left,-this._top)),this._dragOrigin={x:0,y:0});if(this._canDraw&&this.drawMode)if(a)this._fireUpdateEnd();else if(this.drawMode)if(this.pixelData&&this.pixelData.pixelBlock){var a=this.pixelData.pixelBlock,b=this._context,c=b.createImageData(a.width,a.height);c.data.set(a.getAsRGBA());var e=this.pixelData.extent,g=this._map.extent,k=this.getCurrentResolution(),m=0,n=0;Math.abs(e.xmin-g.xmin)>k.x&&(m=Math.round((e.xmin-g.xmin)/
k.x));Math.abs(g.ymax-e.ymax)>k.y&&(n=Math.round((g.ymax-e.ymax)/k.y));this.clear();"css-transforms"===this._map.navigationMode?(this._tdx=this._left,this._tdy=this._top,this._multiply=null,u.set(this._div,f._css.names.transform,f._css.translate(this._left,this._top)),u.set(this._canvas,f._css.names.transform,f._css.translate(-this._left,-this._top))):(u.set(this._div,{left:"0px",top:"0px",width:this._map.width+"px",height:this._map.height+"px"}),u.set(this._canvas,{left:"0px",top:"0px",width:this._map.width+
"px",height:this._map.height+"px"}));this._dragOrigin={x:0,y:0};b.putImageData(c,m,n,0,0,a.width,a.height);this._fireUpdateEnd()}else this.clear()}},_panHandler:function(a,b){"css-transforms"===this._map.navigationMode?(this._left=this._map.__visibleDelta.x+b.x,this._top=this._map.__visibleDelta.y+b.y,u.set(this._div,f._css.names.transform,f._css.translate(this._left,this._top))):u.set(this._div,{left:this._startRect.left+b.x+"px",top:this._startRect.top+b.y+"px"})},_panEndHandler:function(a,b){b&&
(this._startRect.left+=b.x,this._startRect.top+=b.y)},_onScaleHandler:function(a,b){var c={},e=f._css.names;u.set(this._canvas,e.transition,b?"none":e.transformName+" "+w+"ms ease");this._matrix=a;a=this._multiply?k.multiply(a,this._multiply):a;if(this._tdx||this._tdy)a=k.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:-this._tdx,dy:-this._tdy});c[e.transform]=f._css.matrix(a);u.set(this._canvas,c)},_onZoomHandler:function(a,b,c){var e=this._startRect;a=e.width*b;b*=e.height;var f=e.left-(a-e.width)*(c.x-e.left)/
e.width;c=e.top-(b-e.height)*(c.y-e.top)/e.height;u.set(this._canvas,{left:f+"px",top:c+"px",width:a+"px",height:b+"px"});this._endRect={left:f,top:c,width:a,height:b}},_onZoomEndHandler:function(){this._endRect&&(this._startRect=this._endRect)},_onResizeHandler:function(a,b,c){u.set(this._div,{width:b+"px",height:c+"px"});u.set(this._canvas,{width:b+"px",height:c+"px"});this._startRect.width=this._canvas.width=b;this._startRect.height=this._canvas.height=c},_extentChangeHandler:function(a,b,c,e){this.suspended||
b&&0===b.x&&0===b.y&&!c||("css-transforms"===this._map.navigationMode&&(b&&(this._dragOrigin.x+=b.x,this._dragOrigin.y+=b.y),c||(this._left=this._map.__visibleDelta.x,this._top=this._map.__visibleDelta.y,u.set(this._div,f._css.names.transform,f._css.translate(this._left,this._top))),c&&(u.set(this._canvas,f._css.names.transition,"none"),this._multiply=this._multiply?k.multiply(this._matrix,this._multiply):this._matrix)),this._fireUpdateStart(),a=this._map,this._requestData(a.extent,a.width,a.height))},
_visibilityChangeHandler:function(b){b?a.show(this._div):a.hide(this._div)},_opacityChangeHandler:function(a){u.set(this._div,"opacity",a)}})})},"esri/layers/ImageServiceLayerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query dojo/DeferredList ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T){return p(null,{declaredClass:"esri.layers.ImageServiceLayerMixin",_rasterFieldPrefix:"Raster.",_renderingRuleFieldSubPrefix:"ServicePixelValue.",_rasterFunctionServiceInfoProps:"bandCount pixelType hasRasterAttributeTable hasHistograms minValues maxValues meanValues stdvValues serviceDataType".split(" "),_pixelTypeRanges:{U1:[0,1],U2:[0,3],U4:[0,15],U8:[0,255],S8:[-128,127],U16:[0,65535],S16:[-32768,32767]},_eventMap:{"rendering-change":!0,
"mosaic-rule-change":!0,"spatial-reference-change":!0,"renderer-change":!0},constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0},_initialize:function(a,b){this._url=q.urlToObject(a);this.raster=new D(this._url.path);this._rasterFunctionTemplateInfos={};this._customRenderingRuleId={};this.infoTemplate=b&&b.infoTemplate;this.format=(a=b&&b.imageServiceParameters)&&a.format;this.compressionTolerance=a&&a.compressionTolerance?a.compressionTolerance:.01;this.interpolation=
a?a.interpolation:null;this.compressionQuality=a?a.compressionQuality:null;this.bandIds=a?a.bandIds:null;this.mosaicRule=a?a.mosaicRule:null;this.renderingRule=a?a.renderingRule:null;this.renderer=a?a.renderer:null;this.useMapDimensionValue=b&&b.hasOwnProperty("useMapDimensionValue")?!!b.useMapDimensionValue:!0;this.hasImageFilter=b&&b.hasImageFilter;this.activeMapDimensions=b&&b.activeMapDimensions;this._params=g.mixin({},this._url.query,{f:"image",interpolation:this.interpolation,format:this.format,
compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null},a?a.toJson():{});this.pixelFilter=b&&b.pixelFilter;this.originalPixelData=this.pixelData=null;this.hasDataChanged=!0;this._requestDataHandler=g.hitch(this,this._requestDataHandler);this._requestDataErrorHandler=g.hitch(this,this._requestDataErrorHandler);this._rasterReadPromise=null;this._initLayer=g.hitch(this,this._initLayer);this._queryVisibleRastersHandler=g.hitch(this,this._queryVisibleRastersHandler);
this._visibleRasters=[];this._rasterAttributeTableFields=[];this._rasterAttributeTableFeatures=[];this._renderingRuleAttributeTable={};this._useRenderingRuleAttributeTable=!1;this._loadCallback=b&&b.loadCallback;(b=b&&b.resourceInfo)?this._initLayer(b):x({url:this._url.path,content:g.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});this.registerConnectEvents()},disableClientCaching:!1,_initLayer:function(a,b){if(null!==a&&void 0!==a){this._findCredential();
(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();b=this.minScale;var e=this.maxScale;g.mixin(this,a);this.minScale=b;this.maxScale=e;this.initialExtent=this.fullExtent=this.extent=new C(a.extent);this.spatialReference=this.initialExtent.spatialReference;this.pixelSizeX=parseFloat(this.pixelSizeX);this.pixelSizeY=parseFloat(this.pixelSizeY);var f=this.minValues,k=this.maxValues,m=this.meanValues,n=this.stdvValues,l=this.bands=[];b=0;for(e=this.bandCount;b<e;b++)l[b]={min:f[b],max:k[b],
mean:m[b],stddev:n[b]};this.timeInfo=(b=this.timeInfo)&&b.timeExtent?new L(b):null;e=this.fields=[];if(f=a.fields)for(b=0;b<f.length;b++)e.push(new M(f[b]));this._updateInfoTemplateFields(this.fields);this.version=a.currentVersion;this.version||(this.version="fields"in a||"objectIdField"in a||"timeInfo"in a?10:9.3);c.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);c.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale);b={};a.defaultMosaicMethod?(b.method=a.defaultMosaicMethod,
b.operation=a.mosaicOperator,b.sortField=a.sortField,b.sortValue=a.sortValue):b.method=B.METHOD_NONE;this.defaultMosaicRule=new B(b);this.defaultMosaicRule.ascending=!0;this._useRenderingRuleAttributeTable=10<this.version&&"esriImageServiceDataTypeThematic"===this.serviceDataType;this._setDefaultRenderingRule(!0);this.renderingRule&&this.getRenderingRuleServiceInfo(this.renderingRule).then(g.hitch(this,function(a){a.hasRasterAttributeTable&&this.getRenderingRuleAttributeTable({renderingRule:this.renderingRule}).then(g.hitch(this,
function(){!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh()}))}));this._isScientificData()&&(!this.mosaicRule||this.mosaicRule&&!this.mosaicRule.multidimensionalDefinition)&&this._setDefaultMultidimensionalDefinition(!0);10<this.version&&this.hasRasterAttributeTable&&this.getRasterAttributeTable().then(g.hitch(this,function(a){a&&(a.features&&a.fields&&(this.rasterAttributeTable=g.clone(a)),
a.features&&0<a.features.length&&(this._rasterAttributeTableFeatures=g.clone(a.features)),a.fields&&0<a.fields.length&&(this._rasterAttributeTableFields=g.clone(a.fields)),this.renderingRule||!this.renderer||"esri.renderer.ClassBreaksRenderer"!==this.renderer.declaredClass&&"esri.renderer.UniqueValueRenderer"!==this.renderer.declaredClass||this.refresh())}));this._initVectorPixelFilter();10.3<=this.version&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&this.getRasterFunctionInfos().then(g.hitch(this,
function(a){if(a&&a.length){this.rasterFunctionInfos=a;var b=[],d;v.forEach(a,function(a){if(a){var c=a.functionType;d=d||1===c||2===c;b.push(a.name)}},this);this._hasItemLevelRFT=d;this._rasterFunctionNames=b;d&&(this._initVectorPixelFilter(),this.refresh())}}));this.loaded=!0;this._setDefaultFilter();this.onLoad(this);if(a=this._loadCallback)delete this._loadCallback,a(this)}},_updateInfoTemplateFields:function(a){if(a&&!(1>a.length)&&this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.fieldInfos&&
!(1>this.infoTemplate.info.fieldInfos.length)){var b,c,e,f;f=this.infoTemplate.info.fieldInfos;for(b=0;b<a.length;b++)for(e=a[b],c=0;c<f.length;c++)if(f[c].fieldName.toLowerCase()===e.name.toLowerCase()&&f[c].fieldName!==e.name){f[c].fieldName=e.name;break}}},getKeyProperties:function(a){var b=this._url.path+"/keyProperties",c=new t(w._dfdCanceller),e={f:"json"};a&&a.renderingRule&&(e.renderingRule=n.toJson(a.renderingRule.toJson()));10<this.version?(c._pendingDfd=x({url:b,content:e,handleAs:"json",
callbackParamName:"callback"}),c._pendingDfd.then(function(a){c.callback(a)},function(a){c.errback(a)})):(a=Error("Layer does not have key properties"),a.log=!!m.isDebug,c.errback(a));return c},getRasterAttributeTable:function(a){var b=this._url.path+"/rasterAttributeTable",c=new t(w._dfdCanceller),e={f:"json"},f=this.hasRasterAttributeTable;a&&a.renderingRule&&(e.renderingRule=n.toJson(a.renderingRule.toJson()),f=!0);10<this.version&&f?(c._pendingDfd=x({url:b,content:e,handleAs:"json",callbackParamName:"callback"}),
c._pendingDfd.then(function(a){c.callback(a)},function(a){c.errback(a)})):(a=Error("Layer does not support raster attribute table"),a.log=!!m.isDebug,c.errback(a));return c},getRenderingRuleAttributeTable:function(a){var b=new t(w._dfdCanceller);if(!a||!a.renderingRule)return b.errback(Error("Rendering rule is not specified")),b;a=a.renderingRule;var c=this._getRenderingRuleId(a);this._renderingRuleAttributeTable&&c&&this._renderingRuleAttributeTable.hasOwnProperty(c)?b.resolve(this._renderingRuleAttributeTable[c]):
b=this.getRasterAttributeTable({renderingRule:a}).then(g.hitch(this,function(a){var b;a&&a.features&&a.features.length&&a.fields&&a.fields.length&&(b={features:g.clone(a.features),fields:g.clone(a.fields)},c&&(this._renderingRuleAttributeTable[c]=b));return b}));return b},_initVectorPixelFilter:function(){var a;this._hasItemLevelRFT&&this.renderingRule&&(a=this._getItemLevelRenderingRule(this.renderingRule));if(a=a||this.renderingRule)return this.getRenderingRuleServiceInfo(a).then(g.hitch(this,function(a){a&&
this._isVectorData(a)&&!c.isDefined(this.pixelFilter)&&"esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&(this.vectorFieldPixelFilter=new K,this.vectorFieldPixelFilter.isDataUV="esriImageServiceDataTypeVector-UV"===a.serviceDataType,this.pixelFilter=this.vectorFieldPixelFilter.computeMagnitudeAndDirection,this.getKeyProperties().then(g.hitch(this,this._setFlowRepresentation)),this._applyVectorResamplingType(a.serviceDataType))}))},_applyVectorResamplingType:function(a){if(a){var b=
this.renderingRule;b&&"Resample"===b.functionName&&((b.functionArguments||{}).ResamplingType="esriImageServiceDataTypeVector-UV"===a?7:10,this.setRenderingRule(new G(b.toJson())))}},_getRasterAttributeTableFeatures:function(){var a=new t;if(this._rasterAttributeTableFeatures&&0<this._rasterAttributeTableFeatures.length)return a.resolve(this._rasterAttributeTableFeatures),a;if(10<this.version&&this.hasRasterAttributeTable)return a=this.getRasterAttributeTable(),a.then(g.hitch(this,function(a){a&&a.features&&
0<a.features.length&&(this._rasterAttributeTableFeatures=g.clone(a.features))})),a;a.resolve(this._rasterAttributeTableFeatures);return a},_getRenderingRuleAttributeTableFeatures:function(a){a=a&&a.renderingRule;return a?this.getRenderingRuleAttributeTable({renderingRule:a}).then(function(a){return a&&a.features}):(a=new t,a.errback(Error("Rendering rule is not specified")),a)},getCustomRasterFields:function(a){var b=a?a.rasterAttributeTableFieldPrefix:this._rasterFieldPrefix;a=10.3<=this.version?
"esriFieldTypeDouble":"esriFieldTypeString";var e={name:this._rasterFieldPrefix+"ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:a},f={name:this._rasterFieldPrefix+"ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:a},k={name:this._rasterFieldPrefix+"ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"},m=this.fields?g.clone(this.fields):[];a=m.length;m[a]=f;10.4<=this.version&&
"esri.layers.ArcGISImageServiceLayer"===this.declaredClass&&(!this.rasterFunctionInfos||!this.rasterFunctionInfos.length||this._isRenderingRuleAProcessingTemplate({functionName:"none"}))&&(a++,m[a]=k);if(this.capabilities&&-1<this.capabilities.toLowerCase().indexOf("catalog")||this.fields&&0<this.fields.length)a++,m[a]=e;!c.isDefined(this.pixelFilter)||"esriImageServiceDataTypeVector-UV"!==this.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.serviceDataType||(e={name:this._rasterFieldPrefix+
"Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"esriFieldTypeDouble"},f={name:this._rasterFieldPrefix+"Direction",alias:"Direction",domain:null,editable:!1,type:"esriFieldTypeDouble"},a++,m[a]=e,a++,m[a]=f);a=this._rasterAttributeTableFields;(e=this.renderingRule&&this._getRenderingRuleId(this.renderingRule))&&this._renderingRuleAttributeTable&&this._renderingRuleAttributeTable.hasOwnProperty(e)&&(a=this._renderingRuleAttributeTable[e].fields);a&&0<a.length&&(a=v.filter(a,function(a){return"esriFieldTypeOID"!==
a.type&&"value"!==a.name.toLowerCase()}),a=v.map(a,function(a){var d=g.clone(a);d.name=b+a.name;return d}),m=m.concat(a));var n=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;10.4<=this.version&&this.rasterFunctionInfos&&v.forEach(this.rasterFunctionInfos,function(a){a&&a.name&&"none"!==a.name.toLowerCase()&&(a={name:n+a.name.replace(/ /gi,"_"),alias:a.name,domain:null,editable:!1,type:"esriFieldTypeDouble"},m.push(a))});return m},_prepareGetImageParameters:function(a,b,e,f){f=c.isDefined(f)?
f:this._params;if(this.renderer||this._hasItemLevelRFT&&this.renderingRule){var k=this.getExportImageRenderingRule();f.renderingRule=k?n.toJson(k.toJson()):null;k=this.getExportImageMosaicRule(f);f.mosaicRule=k?n.toJson(k.toJson()):null}k=a.spatialReference.wkid||n.toJson(a.spatialReference.toJson(!1));delete f._ts;g.mixin(f,{bbox:a.xmin+","+a.ymin+","+a.xmax+","+a.ymax,imageSR:k,bboxSR:k,size:b+","+e},this.disableClientCaching?{_ts:(new Date).getTime()}:{});delete f.compressionTolerance;f.format&&
"LERC"===f.format.toUpperCase()&&(f.compressionTolerance=this.compressionTolerance);f.token=this._getToken()},getImageUrl:function(b,e,k,m,n){n=c.isDefined(n)?n:this._params;this._prepareGetImageParameters(b,e,k,n);b=g.clone(n);this._cleanupRequestParams(b);e=this._url.path+"/exportImage?";k=q.addProxy(e+f.objectToQuery(g.mixin(b,{f:"image"})));var p=b.token;k.length>a.defaults.io.postLength||this.useMapImage?this._jsonRequest=x({url:e,content:g.mixin(b,{f:"json"}),callbackParamName:"callback",load:function(a,
b){a=a.href;p&&(a+=-1===a.indexOf("?")?"?token\x3d"+p:"\x26token\x3d"+p);m(q.addProxy(a))},error:this._errorHandler}):m(k)},onRenderingChange:function(){},onMosaicRuleChange:function(){},onRendererChange:function(){},setInterpolation:function(a,b){this.interpolation=this._params.interpolation=a;b||this.refresh(!0)},setCompressionQuality:function(a,b){this.compressionQuality=this._params.compressionQuality=a;b||this.refresh(!0)},setCompressionTolerance:function(a,b){this.compressionTolerance=a;b||
this.refresh(!0)},setBandIds:function(a,b){var c=!1;this.bandIds!==a&&(c=!0);this.bandIds=a;this._params.bandIds=a.join(",");if(c&&!b)this.onRenderingChange();b||this.refresh(!0)},setDefaultBandIds:function(a){this.bandIds=this._params.bandIds=null;a||this.refresh(!0)},setDisableClientCaching:function(a){this.disableClientCaching=a},setMosaicRule:function(a,b){var c=!1;this.mosaicRule!==a&&(c=!0);this.mosaicRule=a;this._params.mosaicRule=n.toJson(a.toJson());if(c&&!b)this.onMosaicRuleChange();b||
this.refresh(!0)},getRasterFunctionInfos:function(){if(10.3>this.version||!this.rasterFunctionInfos||!this.rasterFunctionInfos.length)console.log("Layer doesn't support /rasterFunctionInfos resource.");else return x({url:this._url.path+"/rasterFunctionInfos",content:{f:"json"},handleAs:"json",load:function(a){return a&&a.rasterFunctionInfos}})},setRenderingRule:function(a,b){var c=!1;this.renderingRule!==a&&(c=!0);this.renderingRule=a;this._params.renderingRule=a?n.toJson(a.toJson()):null;this._useRenderingRuleAttributeTable&&
this.getRenderingRuleAttributeTable({renderingRule:a});if(c)this.onRenderingChange();this._setDefaultFilter();b||this.refresh(!0)},setImageFormat:function(a,b){this.format=this._params.format=a;this._setDefaultFilter();b||this.refresh(!0)},setInfoTemplate:function(a){this.infoTemplate=a;this._updateInfoTemplateFields(this.fields)},setDefinitionExpression:function(a,b){var c=this.mosaicRule?this.mosaicRule.toJson():{};this.mosaicRule||(this.defaultMosaicRule?c=this.defaultMosaicRule.toJson():c.method=
B.METHOD_NONE);c.where=a;a=new B(c);this.setMosaicRule(a,b);return this},getDefinitionExpression:function(){return this.mosaicRule?this.mosaicRule.where:null},setPixelFilter:function(a){this.pixelFilter=a;this._isDefaultPixelFilter=!1},getPixelData:function(a){return a?(this._useBrowserDecoding()&&(this.originalPixelData={pixelBlock:this._getPixelBlockFromCanvas(this._context,this._map.width,this._map.height),extent:this._map.extent}),this.originalPixelData):this.pixelData},getExportImageRenderingRule:function(){var a;
this._hasItemLevelRFT&&this.renderingRule&&(a=this._getServiceLevelRenderingRule(this.renderingRule));a=a||this.renderingRule;this._isItemLevelRasterFunction(this.renderingRule)&&(a=void 0);return this._combineRenderingRule(this._convertRendererToRenderingRule(this.renderer),a)},getExportImageMosaicRule:function(){var a=this.mosaicRule,b;this._hasItemLevelRFT&&this.renderingRule&&(b=this._getItemLevelRenderingRule(this.renderingRule));b&&(a=a||this.defaultMosaicRule||new B,a.itemRenderingRule=b);
return a},redraw:function(){this.hasDataChanged=!1;this._setPixelData(this.originalPixelData)},getHistograms:function(){var a=new t(w._dfdCanceller);if(this.hasHistograms)a._pendingDfd=x({url:this._url.path+"/histograms",content:{f:"json"},handleAs:"json",callbackParamName:"callback"}),a._pendingDfd.then(function(b){a.callback(b)},function(b){a.errback(b)});else{var b=Error("Layer does not have histograms.");b.log=!!m.isDebug;a.errback(b)}return a},computeHistograms:function(a){var b=new t(w._dfdCanceller);
if(10.1<=this.currentVersion){a=a||{};var c=a.geometry||this.fullExtent,e=(a.geometry||this.fullExtent).toJson(),c="extent"===c.type?"esriGeometryEnvelope":"esriGeometryPolygon",f=a.renderingRule||this.renderingRule||this.defaultRenderingRule,f=f?f.toJson():null,k=a.mosaicRule||this.mosaicRule||this.defaultMosaicRule,k=k?k.toJson():null;a=a.pixelSize||{x:this.pixelSizeX,y:this.pixelSizeY};b._pendingDfd=x({url:this._url.path+"/computeHistograms",content:g.mixin({f:"json",geometry:JSON.stringify(e),
geometryType:c,renderingRule:JSON.stringify(f),mosaicRule:JSON.stringify(k),pixelSize:JSON.stringify(a),callbackParamName:"callback"}),handleAs:"json"});b._pendingDfd.then(function(a){b.callback(a)},function(a){b.errback(a)})}else e=Error("Layer doesn't support computeHistograms."),e.log=!!m.isDebug,b.errback(e);return b},getRenderingRuleServiceInfo:function(a){var b=new w._fixDfd(new t(w._dfdCanceller));if(!a)return b.errback(Error("Rendering rule is not specified")),b;var c=this._getRenderingRuleId(a);
return c&&this._rasterFunctionTemplateInfos[c]?(b.resolve(this._rasterFunctionTemplateInfos[c]),b):x({url:this._url.path,content:g.mixin(g.mixin({f:"json",renderingRule:JSON.stringify(a.toJson())},this._url.query)),callbackParamName:"callback",load:g.hitch(this,function(a){var b={};v.forEach(this._rasterFunctionServiceInfoProps,function(c){b[c]=a[c]});return this._rasterFunctionTemplateInfos[c]=b}),error:this._errorHandler})},queryVisibleRasters:function(a,b,c,e){var f=this._map,k=w._fixDfd(new t(w._dfdCanceller));
this._visibleRasters=[];var m,l,d=!0,h=!0,n=null,q=this.infoTemplate?this.infoTemplate.info:null,p=q?g.clone(this.infoTemplate.info.fieldInfos):null;b=b||{};if(q&&this.infoTemplate.info.mediaInfos&&this.infoTemplate.info.mediaInfos.length){var x=[];v.forEach(this.infoTemplate.info.mediaInfos,function(a){x=x.concat(a&&a.value&&a.value.fields||[])});x.length&&v.forEach(p,function(a){a&&-1<x.indexOf(a.fieldName)&&(a.visible=!0)})}if(p&&0<p.length)for(d=!1,m=0;m<p.length;m++)if((l=p[m])&&l.fieldName.toLowerCase()!==
this._rasterFieldPrefix.toLowerCase()+"servicepixelvalue"&&(l.visible||q.title&&-1<q.title.toLowerCase().indexOf(l.fieldName.toLowerCase()))){d=!0;break}this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("returnTopmostRaster")&&(n=this.infoTemplate.info.layerOptions.returnTopmostRaster?1:null);p&&0<p.length&&(h=!1,v.some(p,function(a){if(a&&a.fieldName.toLowerCase()===this._rasterFieldPrefix.toLowerCase()+"itempixelvalue"&&
a.visible)return h=!0},this));var u=(l=this._removeVisualizationStretchFunction(this.renderingRule))&&l.functionName,B=[];if(10.4<=this.version){var C=!1;if(this.rasterFunctionInfos&&p){var F=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;v.forEach(this.rasterFunctionInfos,function(a){var b=F+a.name.replace(/ /gi,"_");v.some(p,function(a){return a.visible&&a.fieldName===b})&&(C=C||u&&u===a.name,B.push(new G({rasterFunction:a.name})))})}l&&!C&&B.push(l)}m=new T;m.geometry=a.geometry;m.returnGeometry=
this._map.spatialReference.equals(this.spatialReference);m.returnCatalogItems=d;m.timeExtent=a.timeExtent;m.returnPixelValues=h;m.maxItemCount=n||a.maxItemCount;this._params.time&&this.mosaicRule?(a=g.clone(this.mosaicRule),a=this._filterOutTimeDimension(a),m.mosaicRule=a):m.mosaicRule=this.mosaicRule||null;m.renderingRule=10.4>this.version&&l||null;m.renderingRules=B||null;10.61>this.version&&(m.returnPixelValues=void 0,m.maxItemCount=void 0);f&&(f=new z((f.extent.xmax-f.extent.xmin)/f.width,(f.extent.ymax-
f.extent.ymin)/f.height,f.extent.spatialReference),m.pixelSize=f);b.requestParams=m;var D=this,f=new S(this.url);(k._pendingDfd=f.execute(m)).addCallbacks(function(a){D._queryVisibleRastersHandler(a,b,c,e,k)},function(a){D._resolve([a],null,e,k,!0)});return k},_queryVisibleRastersHandler:function(a,b,e,f,k){function m(){var a=this.getCustomRasterFields(b),f=this._getDomainFields(a),m=b?b.returnDomainValues:!1,n=b&&b.rasterAttributeTableFieldPrefix,p,w,x,u,r,t,B,z,D,E,a=(a=this._getRenderingRuleId(this.renderingRule))&&
this._rasterFunctionTemplateInfos[a];this.renderingRule&&(this._useRenderingRuleAttributeTable||a)?(a=this._getRenderingRuleAttributeTableFeatures({renderingRule:this.renderingRule}),E=q):a=this._getRasterAttributeTableFeatures();a.then(g.hitch(this,function(a){for(p=0;p<h.length;p++){O=h[p];O.setInfoTemplate(this.infoTemplate);O._layer=this;if(q){D=q.replace(/ /gi,"").split(",");w=q;x=D;d&&d.length>=p&&(w=d[p].replace(/ /gi,", "),x=d[p].split(" "));O.attributes[this._rasterFieldPrefix+"ItemPixelValue"]=
x;O.attributes[this._rasterFieldPrefix+"ServicePixelValue"]=D;l&&(O.attributes[this._rasterFieldPrefix+"ServicePixelValue.Raw"]=l.replace(/ /gi,"").split(","));if(this.pixelFilter){var b=new I({height:1,width:1,pixelType:"F32",pixels:[],statistics:[]});v.forEach(x,function(a){b.addData({pixels:[a],statistics:{minValue:a,maxValue:a,noDataValue:null}})});this.pixelFilter({pixelBlock:b,extent:new C(0,0,0,0,this._map.spatialReference)});if("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===
this.serviceDataType)O.attributes[this._rasterFieldPrefix+"Magnitude"]=b.pixels[0][0],O.attributes[this._rasterFieldPrefix+"Direction"]=b.pixels[1][0]}v.forEach(F,function(a){O.attributes[a.name]=a.value});var G=E||w;if(a&&0<a.length&&(u=v.filter(a,function(a){if(a&&a.attributes)return a.attributes.hasOwnProperty("Value")?a.attributes.Value==G:a.attributes.VALUE==G}),0<u.length&&(r=g.clone(u[0]),n&&r))){z={};for(t in r.attributes)r.attributes.hasOwnProperty(t)&&(B=n+t,z[B]=r.attributes[t]);r.attributes=
z;O.attributes=g.mixin(O.attributes,r.attributes)}}m&&f&&0<f.length&&v.forEach(f,function(a){if(a){var b=O.attributes[a.name];c.isDefined(b)&&(b=this._getDomainValue(a.domain,b),c.isDefined(b)&&(O.attributes[a.name]=b))}},this);T.push(O);this._visibleRasters.push(O)}this._resolve([T,null,!0],null,e,k)}))}var q=a.value,l=a.value,d,h,p=0,w=0,u=this,t=this.objectIdField,B,z,F=[];f=b.requestParams.renderingRules;var D=a.processedValues,G=this.renderingRule&&n.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson());
if(f&&D&&f.length===D.length){var K=this._rasterFieldPrefix+this._renderingRuleFieldSubPrefix;v.forEach(f,function(a,b){if(a.functionName){var d={name:K+a.functionName.replace(/ /gi,"_"),value:D[b].replace(/ /gi,"").split(",")};F.push(d);G&&G===n.toJson(a.toJson())&&(q=D[b])}})}f=this.infoTemplate&&this.infoTemplate.info&&this.infoTemplate.info.layerOptions&&this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords")?this.infoTemplate.info.layerOptions.showNoDataRecords:!0;if(a.catalogItems){var A=
0,J,M,L=a.catalogItems.features.length;z=0;h=Array(L);d=Array(L);B=Array(L);if(a.properties&&a.properties.Values){L=a.properties.Values.length;for(p=0;p<L;p++)-1<a.properties.Values[p].toLowerCase().indexOf("nodata")&&z++;J=L-z;for(p=0;p<L;p++)z=!0,-1<a.properties.Values[p].toLowerCase().indexOf("nodata")?(M=J++,f||(z=!1,h.length--,d.length--,B.length--)):M=A++,z&&(h[M]=a.catalogItems.features[p],d[M]=a.properties.Values[p],B[M]=h[M].attributes[t])}else{for(p=0;p<L;p++)h[p]=a.catalogItems.features[p],
B[p]=h[p].attributes[t];d=null}}this._visibleRasters=[];var O;(a=-1<q.toLowerCase().indexOf("nodata"))&&!f&&(h=[],d=[],B=[]);!q||h||a||(t="ObjectId",h=[],O=new Q(new C(this.fullExtent),null,{ObjectId:0}),h.push(O));var T=[];h?!this._map.spatialReference.equals(this.spatialReference)&&B&&0<B.length?x({url:this._url.path+"/query",content:{f:"json",objectIds:B.join(","),returnGeometry:!0,outSR:n.toJson(u._map.spatialReference.toJson()),outFields:t},handleAs:"json",callbackParamName:"callback",load:function(a){if(0===
a.features.length)u._resolve([T,null,null],null,e,k);else{for(p=0;p<a.features.length;p++)for(w=0;w<h.length;w++)h[w].attributes[t]==a.features[p].attributes[t]&&(h[w].geometry=new E(a.features[p].geometry),h[w].geometry.setSpatialReference(u._map.spatialReference));m.call(u)}},error:function(a){u._resolve([T,null,null],null,e,k)}}):m.call(this):this._resolve([T,null,null],null,e,k)},getVisibleRasters:function(){var a=this._visibleRasters,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},
_getDomainFields:function(a){if(a){var b=[];v.forEach(a,function(a){if(a.domain){var c={};c.name=a.name;c.domain=a.domain;b.push(c)}});return b}},_getDomainValue:function(a,b){if(a&&a.codedValues){var c;v.some(a.codedValues,function(a){return a.code===b?(c=a.name,!0):!1});return c}},_requestData:function(a,b,c){this._rasterReadPromise&&this._rasterReadPromise.cancel();a=g.clone(a);var e=a._normalize(!0);this._prepareGetImageParameters(e,b,c);b=g.clone(this._params);this._cleanupRequestParams(b);b.extent=
a;b.format=b.format||(10.3<=this.version?"lerc":"jpgpng");"lerc"===b.format.toLowerCase()&&!b.lercVersion&&10.5<=this.version&&(b.lercVersion=2);c=null;this._useBrowserDecoding()&&(c=new J({ctx:this._context}));b={imageServiceParameters:b,nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,decodeFunc:c?g.hitch(c,"decode"):null};this._rasterReadPromise=this.raster.read(b,this._requestDataHandler,this._requestDataErrorHandler)},_requestDataHandler:function(a){this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||
(this.originalPixelData=a,this.hasDataChanged=!0,this._setPixelData(a))},_setPixelData:function(a){a=this._clonePixelData(a);this.pixelFilter&&this.pixelFilter(a);this.pixelData=a;this._rasterReadPromise&&this._rasterReadPromise.isCanceled()||(this._drawPixelData(),this._rasterReadPromise=null)},_clonePixelData:function(a){if(null===a||void 0===a)return a;var b={};a.extent&&(b.extent=g.clone(a.extent));a=a.pixelBlock;if(null===a||void 0===a)return b;b.pixelBlock=a.clone();return b},_setDefaultFilter:function(){},
_getPixelBlockFromCanvas:function(a,b,c){a=a.getImageData(0,0,b,c).data;for(var e=b*c,f=0,g=0,k=new Uint8Array(e),l=new Uint8Array(e),d=new Uint8Array(e),h=new Uint8Array(e),m=Infinity,n=Infinity,q=Infinity,p=-Infinity,w=-Infinity,x=-Infinity,u,v,t,f=0;f<e;f++)u=a[g++],v=a[g++],t=a[g++],m=m<u?m:u,p=p>u?p:u,n=n<v?n:v,w=w>v?w:v,q=q<t?q:t,x=x>t?x:t,k[f]=u,l[f]=v,d[f]=t,h[f]=a[g++]&1;return new I({width:b,height:c,pixels:[k,l,d],pixelType:"U8",mask:h,statistics:[{minValue:m,maxValue:p},{minValue:n,maxValue:w},
{minValue:q,maxValue:x}]})},_useBrowserDecoding:function(){return(void 0===this.pixelFilter||null===this.pixelFilter)&&("jpeg"===this.format.toLowerCase()||"jpg"===this.format.toLowerCase()||-1<this.format.toLowerCase().indexOf("png"))},getMultidimensionalInfo:function(){var a=this._url.path+"/multiDimensionalInfo",b=new t(w._dfdCanceller);if(this._multidimensionalInfo)return b.resolve(this._multidimensionalInfo),b;10.3<=this.version&&this.hasMultidimensions?(b._pendingDfd=x({url:a,content:{f:"json"},
handleAs:"json",callbackParamName:"callback"}),b._pendingDfd.then(g.hitch(this,function(a){this._multidimensionalInfo=a.multidimensionalInfo;b.callback(a.multidimensionalInfo)}),function(a){b.errback(a)})):(a=Error("Layer does not support multidimensional info"),a.log=!!m.isDebug,b.errback(a));return b},getDefaultMultidimensionalDefinition:function(){var a,b,c,e=[],f=new t(w._dfdCanceller),k;if(this._defaultMultidimensionalDefinition)return f.resolve(g.clone(this._defaultMultidimensionalDefinition)),
f;f._pendingDfd=this.getMultidimensionalInfo();f._pendingDfd.then(g.hitch(this,function(m){a=m;b=a.variables[0].dimensions;for(c in b)b.hasOwnProperty(c)&&"StdTime"!==b[c].name&&(k=b[c],e.push(new F({variableName:"",dimensionName:k.name,isSlice:!k.hasRanges,values:[this._getDefaultDimensionValue(k)]})));this._defaultMultidimensionalDefinition=e;f.callback(g.clone(e))}),function(a){f.errback(a)});return f},_getDefaultDimensionValue:function(a){if(a&&a.values&&a.values.length){var b,c,e=Infinity,f,
g;if(a.hasRanges)return a.values[0];if(a.name&&"stdz"===a.name.toLowerCase()){for(g=0;g<a.values.length&&(f=a.values[g],c=Math.abs(f-0),c<e&&(e=c,b=f),0!==c);g++);return b}return a.extent[0]}},_setDefaultMultidimensionalDefinition:function(a){var b,c={};this.getDefaultMultidimensionalDefinition().then(g.hitch(this,function(e){b=e;0<b.length&&(this.mosaicRule?(c=g.clone(this.mosaicRule),c.multidimensionalDefinition=b):this.defaultMosaicRule?(c=g.clone(this.defaultMosaicRule),c.multidimensionalDefinition=
b):c=new B({multidimensionalDefinition:b}),this.setMosaicRule(c,a))}))},_setDefaultRenderingRule:function(a){var b={},c=this.renderingRule;if(!c&&"esri.layers.ArcGISImageServiceVectorLayer"!==this.declaredClass&&!this.bandIds&&this.rasterFunctionInfos&&this.rasterFunctionInfos.length&&"none"!==this.rasterFunctionInfos[0].name.toLowerCase())b.rasterFunction=this.rasterFunctionInfos[0].name;else if("esri.layers.ArcGISImageServiceVectorLayer"===this.declaredClass&&10.3<this.version&&(!c||"Resample"!==
c.functionName)){var e="esriImageServiceDataTypeVector-UV"===this.serviceDataType?7:10;b.rasterFunction="Resample";b.rasterFunctionArguments={ResamplingType:e,InputCellSize:{x:this.pixelSizeX,y:this.pixelSizeY}};c&&(b.rasterFunctionArguments.Raster=c.toJson())}b.hasOwnProperty("rasterFunction")&&(this.defaultRenderingRule=new G(b),this.setRenderingRule(this.defaultRenderingRule,a))},_cleanupRequestParams:function(a){if(!a)return a;if(a.time&&a.mosaicRule){var b=new B(n.fromJson(a.mosaicRule)),b=this._filterOutTimeDimension(b);
a.mosaicRule=n.toJson(b.toJson())}var b="displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent renderer".split(" "),c;for(c in b)a.hasOwnProperty(b[c])&&delete a[b[c]];return a},_filterOutTimeDimension:function(a){if(a&&a.multidimensionalDefinition&&0<a.multidimensionalDefinition.length){var b=v.filter(a.multidimensionalDefinition,function(a){return"StdTime"!==a.dimensionName});a.multidimensionalDefinition=b}return a},_removeVisualizationStretchFunction:function(a){var b=
a&&a.functionName;if(!b||"stretch"!==b.toLowerCase())return a;var c=a.functionArguments.Raster;return c&&c.functionName&&v.some(this.rasterFunctionInfos,function(a){return c.functionName===a.name})?c:a},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_isVectorData:function(a){a=(a=a||this)&&a.serviceDataType;return"esriImageServiceDataTypeVector-UV"===
a||"esriImageServiceDataTypeVector-MagDir"===a},_isRenderingRuleAProcessingTemplate:function(a){var b=a&&a.functionName;return!b||a.functionArguments?!1:v.some(b&&(this.rasterFunctionInfos||[]),function(a){return a&&a.name&&a.name.toLowerCase()===b.toLowerCase()})},_getRenderingRuleId:function(a){var b=a&&a.functionName;if(b){if(this._isRenderingRuleAProcessingTemplate(a))return b;var c=this._customRenderingRuleId[b];if(c){if(c!==a){for(var e in this._customRenderingRuleId)if(this._customRenderingRuleId[e]===
a)return e;for(c=0;this._customRenderingRuleId[f];)c+=1;var f;this._customRenderingRuleId[b+c]=a}}else this._customRenderingRuleId[b]=a;return b}},_createPixelData:function(a){a=new I({width:2,height:2,pixels:a,pixelType:this.pixelType,statistics:a});var b=this.fullExtent.getCenter(),b=new C(b.x,b.y,b.x+this.pixelSizeX,b.y+this.pixelSizeY,this.spatialReference);return{pixelBlock:a,extent:b}},_convertRendererToRenderingRule:function(a){var b=a&&a.declaredClass;if(!b||"esri.renderer.UniqueValueRenderer"!==
b&&"esri.renderer.ClassBreaksRenderer"!==b&&"esri.renderer.StretchRenderer"!==b)return null;var c=null;"esri.renderer.StretchRenderer"===b?c=a.toRenderingRule({convertToColormap:10.6>this.version}):"esri.renderer.ClassBreaksRenderer"===b?c=this._convertClassifyRenderer(a):"esri.renderer.UniqueValueRenderer"===b&&(c=this._convertUniqueValueRenderer(a));return c},_getValueField:function(a){if(a&&a.length){var b,c;v.some(a,function(a){if((c=a.name)&&"value"===c.toLowerCase())return b=c,!0});return b}},
_convertClassifyRenderer:function(a){var b,c=[],e=[],f=[],g=[],k;b=this.renderingRule&&this._getRenderingRuleId(this.renderingRule);var l,d,h=this.hasRasterAttributeTable,m,n;b&&(h=this._rasterFunctionTemplateInfos[b]?this._rasterFunctionTemplateInfos[b].hasRasterAttributeTable:this.hasRasterAttributeTable,d=this._renderingRuleAttributeTable[b],n=this._rasterFunctionTemplateInfos[b]);l=d&&d.features?d.features:this._rasterAttributeTableFeatures;m=this._getValueField(d&&d.fields?d.fields:this._rasterAttributeTableFields);
h&&l?(v.forEach(a.infos,function(b,d){var c,e=b.symbol.color;e.a&&v.forEach(l,function(h){c=h.attributes[a.attributeField];(c>=b.minValue&&c<b.maxValue||d===a.infos.length-1&&c>=b.minValue)&&g.push([h.attributes[m],e.r,e.g,e.b])},this)},this),b=n&&n.pixelType||this.pixelType,this._adjustColormapToPixelTypeRange(g,b),b=new G,b.functionName="Colormap",b.functionArguments={},b.functionArguments.Colormap=g,b.variableName="Raster"):(v.forEach(a.infos,function(a,b){k=a.symbol&&a.symbol.color;k.a?(0===b?
c.push.call(c,a.minValue,a.maxValue+1E-4):c.push.call(c,a.minValue+1E-4,a.maxValue+1E-4),e.push(b),g.push([b,k.r,k.g,k.b])):f.push(a.minValue,a.maxValue)}),b=n&&n.pixelType||this.pixelType,this._adjustColormapToPixelTypeRange(g,b),b=new G,b.functionName="Remap",b.functionArguments={InputRanges:c,OutputValues:e,NoDataRanges:f},b.variableName="Raster",d=new G,d.functionName="Colormap",d.functionArguments={Colormap:g,Raster:b},b=d);return b},_convertUniqueValueRenderer:function(a){var b=[],c=this.renderingRule&&
this._getRenderingRuleId(this.renderingRule),e,f,g,k;c&&(f=this._renderingRuleAttributeTable[c],k=this._rasterFunctionTemplateInfos[c]);e=f&&f.features?f.features:this._rasterAttributeTableFeatures;g=(c=f&&f.fields?f.fields:this._rasterAttributeTableFields)&&c.length?this._getValueField(c):"Value";v.forEach(a.infos,function(c){var d=c.symbol.color;d.a&&(a.attributeField!==g&&e?v.forEach(e,function(e){e.attributes[a.attributeField]==c.value&&b.push([e.attributes[g],d.r,d.g,d.b])},this):b.push([c.value,
d.r,d.g,d.b]))},this);this._adjustColormapToPixelTypeRange(b,k&&k.pixelType||this.pixelType);k=new G;k.functionName="Colormap";k.functionArguments={};k.functionArguments.Colormap=b;k.variableName="Raster";return k},_adjustColormapToPixelTypeRange:function(a,b){(b=this._pixelTypeRanges[b])&&a.push([Math.floor(b[0]-1),0,0,0],[Math.ceil(b[1]+1),0,0,0]);return a},_combineRenderingRule:function(a,b){if(!a||!b)return a||b;var c=function(a){var b=a.Raster;return b=b&&"esri.layers.RasterFunction"===b.declaredClass?
c(b.functionArguments):a};a=g.clone(a);"none"!==b.functionName.toLocaleLowerCase()&&(c(a.functionArguments).Raster=b);return a},_isItemLevelRasterFunction:function(a){var b=a&&a.functionName;if(!b||!this._hasItemLevelRFT)return!1;var c=!1;v.some(this.rasterFunctionInfos,function(a){if(a&&a.name===b){if(1===a.functionType||2===a.functionType)c=!0;return!0}});return c},_getServiceLevelRenderingRule:function(a){if(!this._hasItemLevelRFT||!a)return a;a=new G(a.toJson());var b;b=a.functionArguments;for(var c;;)if((c=
b&&b.Raster)&&c.functionArguments&&c.functionArguments.Raster)b=c,b=b.functionArguments;else{this._isItemLevelRasterFunction(c)&&delete b.Raster;break}return a},_getItemLevelRenderingRule:function(a){if(!this._hasItemLevelRFT||!a)return null;if(this._isItemLevelRasterFunction(a))return a;a=new G(a.toJson());for(a=a.functionArguments;;)if((a=a&&a.Raster)&&a.functionArguments&&a.functionArguments.Raster)a=a.functionArguments;else{if(this._isItemLevelRasterFunction(a))return a;break}},_resolve:function(a,
b,c,e,f){b&&this[b].apply(this,a);c&&c.apply(null,a);e&&w._resDfd(e,a,f)},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=u.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(u.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();!b&&this._map&&this.refresh(!0)},_setTime:function(a){this._params&&
(this._params.time=a?a.toJson().join(","):null)},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},handleSpatialReferenceChange:function(){this.onSpatialReferenceChange()}})})},"esri/layers/MosaicRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point ./RasterFunction".split(" "),function(p,g,t,v,n,m,u){var k=p(null,{declaredClass:"esri.layers.MosaicRule",method:null,where:null,sortField:null,sortValue:null,
ascending:!1,lockRasterIds:null,viewpoint:null,objectIds:null,operation:null,multidimensionalDefinition:[],itemRenderingRule:null,constructor:function(f){g.isObject(f)&&(g.mixin(this,f),f.mosaicMethod&&(this.method=f.mosaicMethod),this.method&&"esri"!==this.method.toLowerCase().substring(0,4)&&(this.method=this._getMethodEnum(this.method)),f.mosaicOperation&&(this.operation=f.mosaicOperation),this.operation&&"MT_"!==this.operation.toUpperCase().substring(0,3)&&(this.operation=this._getOperatorEnum(this.operation)),
f.fids&&(this.objectIds=f.fids),f.viewpoint&&(this.viewpoint=new m(f.viewpoint)),f.itemRenderingRule&&(this.itemRenderingRule=new u(f.itemRenderingRule)),this.multidimensionalDefinition=f.multidimensionalDefinition||[])},toJson:function(){var f=null,e=this.multidimensionalDefinition?this.multidimensionalDefinition.length:0;if(e)for(var f=[],b=0;b<e;b++)f.push("esri.layers.DimensionalDefinition"===this.multidimensionalDefinition[b].declaredClass?this.multidimensionalDefinition[b].toJson():this.multidimensionalDefinition[b]);
f={mosaicMethod:this.method,where:this.where,sortField:this.sortField,sortValue:this.sortValue,ascending:this.ascending,lockRasterIds:g.clone(this.lockRasterIds),viewpoint:this.viewpoint?this.viewpoint.toJson():null,fids:g.clone(this.objectIds),mosaicOperation:this.operation,multidimensionalDefinition:f,itemRenderingRule:this.itemRenderingRule?this.itemRenderingRule.toJson():null};return n.filter(f,function(a){if(null!==a)return!0})},_getMethodEnum:function(f){if(f){var e=k.METHOD_NONE;switch(f.toLowerCase()){case "byattribute":e=
k.METHOD_ATTRIBUTE;break;case "center":e=k.METHOD_CENTER;break;case "lockraster":e=k.METHOD_LOCKRASTER;break;case "nadir":e=k.METHOD_NADIR;break;case "northwest":e=k.METHOD_NORTHWEST;break;case "seamline":e=k.METHOD_SEAMLINE;break;case "viewpoint":e=k.METHOD_VIEWPOINT}return e}},_getOperatorEnum:function(f){if(f)switch(f.toLowerCase()){case "first":return k.OPERATION_FIRST;case "last":return k.OPERATION_LAST;case "max":return k.OPERATION_MAX;case "min":return k.OPERATION_MIN;case "blend":return k.OPERATION_BLEND;
case "mean":return k.OPERATION_MEAN;case "sum":return k.OPERATION_SUM}}});g.mixin(k,{METHOD_NONE:"esriMosaicNone",METHOD_CENTER:"esriMosaicCenter",METHOD_NADIR:"esriMosaicNadir",METHOD_VIEWPOINT:"esriMosaicViewpoint",METHOD_ATTRIBUTE:"esriMosaicAttribute",METHOD_LOCKRASTER:"esriMosaicLockRaster",METHOD_NORTHWEST:"esriMosaicNorthwest",METHOD_SEAMLINE:"esriMosaicSeamline",OPERATION_FIRST:"MT_FIRST",OPERATION_LAST:"MT_LAST",OPERATION_MIN:"MT_MIN",OPERATION_MAX:"MT_MAX",OPERATION_MEAN:"MT_MEAN",OPERATION_BLEND:"MT_BLEND",
OPERATION_SUM:"MT_SUM"});return k})},"esri/layers/DimensionalDefinition":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,t,v,n){return p(null,{declaredClass:"esri.layers.DimensionalDefinition",variableName:null,dimensionName:null,values:[],isSlice:!1,constructor:function(m){g.isObject(m)&&g.mixin(this,m)},toJson:function(){var m={variableName:this.variableName,dimensionName:this.dimensionName,values:g.clone(this.values),isSlice:this.isSlice};
return n.filter(m,function(g){return null!==g})}})})},"esri/layers/Raster":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){var z,E,B,G,F,D,I=null,K=null,J=function(a){if("U1"===a||"U2"===a||"U4"===a||"U8"===
a)return K=Math.pow(2,8)-1,I=Uint8Array,"U8";"U16"===a?(K=K||Math.pow(2,16)-1,I=Uint16Array):"U32"===a?(K=K||Math.pow(2,32)-1,I=Uint32Array):"S8"===a?(K=K||0-Math.pow(2,7),I=Int8Array):"S16"===a?(K=K||0-Math.pow(2,15),I=Int16Array):"S32"===a?(K=K||0-Math.pow(2,31),I=Int32Array):I=Float32Array;return a},L=function(a,b){return a.height!==b.height||a.width!==b.width?!1:!0};return g(e,{declaredClass:"esri.layers.Raster",imageServiceUrl:null,validPixelTypes:"U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "),
validFormats:"lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "),_eventMap:{"raster-read-complete":["pixelData","params"]},constructor:function(a){this.imageServiceUrl=a;this.registerConnectEvents();this._loadRasterFormatModules()},read:function(a,c,e){var f=this,g=new v(x._dfdCanceller);if(10>k("ie"))throw"This browser is not supported.";if(!a.imageServiceParameters)throw"Insufficient parameters to read data";var m=t.clone(a.imageServiceParameters),q=a.pixelType;n.some(this.validPixelTypes,
function(a){return a===q})||(m.pixelType="F32");n.some(this.validFormats,function(a){return a.toLowerCase()===m.format.toLowerCase()})||(m.format="lerc");var p=a.decodeFunc,w;this._prepareGetImageParameters(m);var u=m.width,B=m.height,l=m.extent;delete m.width;delete m.height;delete m.extent;g._pendingDfd=b({url:this.imageServiceUrl+"/exportImage",handleAs:"arraybuffer",content:t.mixin(m,{f:"image"}),load:function(a){f.decode(a,{width:u,height:B,planes:null,pixelType:q,noDataValue:m.noData,format:m.format,
decodeFunc:p}).then(function(a){w={pixelBlock:a,extent:l};f._resolve([w,m],"onRasterReadComplete",c,g)},function(a){f._resolve([a],null,e,g,!0)})},error:function(a){f._resolve([a],null,e,g,!0)}});return g.promise},decode:function(a,b){if(void 0===b||null===b)throw"missing decode options";var c,e;b.format&&(c=b.format.toUpperCase());"BSQ"!==c&&"BIP"!==c&&(c=this._getFormat(a));e=b.decodeFunc;if(void 0===e||null===e)e=this._getFormatDecoderDfd(c);return e(a,b)},onRasterReadComplete:function(){},_prepareGetImageParameters:function(b){if(b.size&&
b.bbox){var e=b.size.split(",");b.width=parseFloat(e[0]);b.height=parseFloat(e[1]);b.extent||(e=b.bbox.split(","),b.extent=new a(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),new c(b.bboxSR)))}else{if(!b.width||Math.floor(b.width)!==b.width||!b.height||Math.floor(b.height)!==b.height)throw"Incorrect Image Dimensions";if(!b.extent||"esri.geometry.Extent"!==b.extent.declaredClass)throw"Incorrect extent";var e=b.extent,f=e.spatialReference.wkid||u.toJson(e.spatialReference.toJson());
delete b._ts;t.mixin(b,{bbox:e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,imageSR:f,bboxSR:f,size:b.width+","+b.height},b.disableClientCaching?{_ts:(new Date).getTime()}:{})}},_adjustExtent:function(a,b,c){var e=a.ymax-a.ymin,f=a.xmax-a.xmin;c>=b?a.ymax=a.ymin+f*b/c:a.xmax=a.xmin+e*c/b;return a},_resolve:function(a,b,c,e,f){b&&this[b].apply(this,a);c&&c.apply(null,a);e&&x._resDfd(e,a,f)},_getFormatDecoderDfd:function(a){var b=null;switch(a){case "LERC":b=this._decodeLerc;break;case "LERC2":b=this._decodeLerc2;
break;case "JPEG":b=this._decodeJpeg;break;case "PNG":b=this._decodePng;break;case "BSQ":b=this._decodeBsq;break;case "BIP":b=this._decodeBip;break;case "TIFF":b=this._decodeTiff;break;default:b=function(a,b){throw"The raster format is not supported";}}b=t.hitch(this,b);return function(c,e){var f=new v;try{var g;"LERC"===a||!0===F?(g=b(c,e),f.resolve(g)):D.then(function(){g=b(c,e);f.resolve(g)})}catch(U){f.reject(U)}return f}},_getFormat:function(a){a=new Uint8Array(a,0,10);var b="";if(255===a[0]&&
216===a[1])b="JPEG";else if(137===a[0]&&80===a[1]&&78===a[2]&&71===a[3])b="PNG";else if(67===a[0]&&110===a[1]&&116===a[2]&&90===a[3]&&73===a[4]&&109===a[5]&&97===a[6]&&103===a[7]&&101===a[8]&&32===a[9])b="LERC";else if(76===a[0]&&101===a[1]&&114===a[2]&&99===a[3]&&50===a[4]&&32===a[5])b="LERC2";else if(-1<String.fromCharCode.apply(null,a).toLowerCase().indexOf("error"))b="ERROR";else if(73===a[0]&&73===a[1]&&42===a[2]&&0===a[3]||77===a[0]&&77===a[1]&&0===a[2]&&42===a[3])b="TIFF";return b},_validateDecodeParams:function(a){if(!a.height||
Math.floor(a.height)!==a.height)throw"Height not provided.";if(!a.width||Math.floor(a.width)!==a.width)throw"Width not provided.";},_decodeJpeg:function(a,b){if(!z)throw"The jpeg decoder module is not loaded.";this._validateDecodeParams(b);a=(new z).decode(a);if(!L(a,b))throw"The decoded image dimensions are incorrect.";b=[];var c,e;for(c=0;c<a.pixels.length;c++)e=a.pixels[c],b.push(this._calculateBandStatistics(e));return new w({width:a.width,height:a.height,pixels:a.pixels,pixelType:"U8",mask:a.mask,
statistics:b})},_decodePng:function(a,b){if(!E)throw"The png decoder module is not loaded.";this._validateDecodeParams(b);a=new Uint8Array(a);var c=new E(a);a=new Uint8Array(b.width*b.height*4);c.copyToImageData(a,c.decodePixels());for(var e=c=0,f,e=new Uint8Array(b.width*b.height),c=0;c<b.width*b.height;c++)e[c]=a[4*c+3];for(var g=new w({width:b.width,height:b.height,pixels:[],pixelType:"U8",mask:e,statistics:[]}),c=0;3>c;c++){f=new Uint8Array(b.width*b.height);for(e=0;e<b.width*b.height;e++)f[e]=
a[4*e+c];g.addData({pixels:f,statistics:this._calculateBandStatistics(f)})}return g},_decodeBsq:function(a,b){if(!B)throw"The bsq decoder module is not loaded.";this._validateDecodeParams(b);K=b.noDataValue;b.pixelType=J(b.pixelType);a=B.decodeBSQ(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:I,noDataValue:K});var c=[],e,f=null;for(e=0;e<a.pixels.length;e++)f=a.pixels[e],c.push(this._calculateBandStatistics(f));return new w({width:b.width,height:b.height,pixels:a.pixels,pixelType:b.pixelType,
mask:a.maskData,statistics:c})},_decodeBip:function(a,b){this._validateDecodeParams(b);K=b.noDataValue;b.pixelType=J(b.pixelType);a=B.decodeBIP(a,{bandCount:b.planes,width:b.width,height:b.height,pixelType:I,noDataValue:K});var c=[],e,f=null;for(e=0;e<a.pixels.length;e++)f=a.pixels[e],c.push(this._calculateBandStatistics(f));return new w({width:b.width,height:b.height,pixels:a.pixels,pixelType:b.pixelType,mask:a.maskData,statistics:c})},_decodeTiff:function(a,b){this._validateDecodeParams(b);K=b.noDataValue;
b.pixelType=J(b.pixelType);a=G.decode(a);b=[];var c,e=null;for(c=0;c<a.pixels.length;c++)e=a.pixels[c],b.push(this._calculateBandStatistics(e,a.maskData));return new w({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType,mask:a.maskData,statistics:b})},_decodeLerc:function(a,b){this._validateDecodeParams(b);K=b.noDataValue;b.pixelType=J(b.pixelType);for(var c=0,e,f=0,g,k=a.byteLength-10;f<k;){var m=q.decode(a,{inputOffset:f,encodedMaskData:e,returnMask:0===c?!0:!1,returnEncodedMask:0===
c?!0:!1,returnFileInfo:!0,pixelType:I,noDataValue:K}),f=m.fileInfo.eofOffset;0===c&&(e=m.encodedMaskData,g=new w({width:b.width,height:b.height,pixels:[],pixelType:b.pixelType,mask:m.maskData,statistics:[]}));c++;if(!L(m,b))throw"The decoded image dimensions are incorrect";g.addData({pixels:m.pixelData,statistics:{minValue:m.minValue,maxValue:m.maxValue,noDataValue:m.noDataValue}})}return g},_decodeLerc2:function(a,b){this._validateDecodeParams(b);K=b.noDataValue;b.pixelType=J(b.pixelType);for(var c=
0,e,f,g=0,k,m=a.byteLength-10,n=[];g<m;){f=C.decode(a,{inputOffset:g,maskData:e,returnFileInfo:!0});g=f.fileInfo.eofOffset;0===c&&(e=f.maskData,k=new w({width:b.width,height:b.height,pixels:[],pixelType:f.fileInfo.pixelType,mask:f.maskData,statistics:[]}));f.fileInfo.mask&&0<f.fileInfo.mask.numBytes&&n.push(f.maskData);c++;if(!L(f,b))throw"The decoded image dimensions are incorrect";k.addData({pixels:f.pixelData,statistics:{minValue:f.minValue,maxValue:f.maxValue,noDataValue:f.noDataValue}})}if(1<
n.length){f=k.width*k.height;k.bandMasks=n;e=new Uint8Array(f);e.set(n[0]);for(b=1;b<n.length;b++)for(a=n[b],c=0;c<f;c++)e[c]&=a[c];k.maskData=e}return k},_calculateBandStatistics:function(a,b){var c=Infinity,e=-Infinity,f=a.length,g,k=0;if(b)for(g=0;g<f;g++)b[g]&&(k=a[g],c=k<c?k:c,e=k>e?k:e);else for(g=0;g<f;g++)k=a[g],c=k<c?k:c,e=k>e?k:e;return{minValue:c,maxValue:e}},_loadRasterFormatModules:function(){F||(D||(D=new v),10>k("ie")?D.isRejected()||D.reject("unsupported browser version"):p(["./rasterFormats/JpgPlus",
"./rasterFormats/Png","./rasterFormats/Raw","./rasterFormats/TiffDecoder","./rasterFormats/Zlib"],function(a,b,c,e){z=a;E=b;B=c;G=e;F=!0;D.isResolved()||D.resolve(!0)}))}})})},"esri/layers/PixelBlock":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,g,t,v){return p([],{declaredClass:"esri.layers.PixelBlock",planes:null,width:null,height:null,pixelType:null,pixels:[],statistics:[],maskIsAlpha:!1,validPixelCount:null,constructor:function(g){if(g){if(!g.width||
Math.floor(g.width)!==g.width)throw"PixelBlock: incorrect width";if(!g.height||Math.floor(g.height)!==g.height)throw"PixelBlock: incorrect height";if(!g.pixels)throw"PixelBlock: pixel data not present";this.width=g.width;this.height=g.height;this.pixels=g.pixels;this.pixelType=g.pixelType||null;this.statistics=g.statistics;this.mask=g.mask||null;this.maskIsAlpha=g.maskIsAlpha||!1;g=g.validPixelCount;null==g&&(g=this.mask?this._getValidPixelCount(this.mask):this.width*this.height);this.validPixelCount=
g}},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(g){if(!g.pixels||!g.statistics)throw"Pixel data or statistics are not present";if(g.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(g.statistics);this.pixels.push(g.pixels)},getAsRGBA:function(){var g=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "S8":case "S16":case "U16":case "S32":case "U32":case "F32":case "F64":this._fillFromNon8Bit(g);
break;default:this._fillFrom8Bit(g)}return new Uint8ClampedArray(g)},getAsRGBAFloat:function(){var g=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(g);return g},clone:function(n){n=n||this;var m=new this.constructor;m.width=n.width;m.height=n.height;m.pixelType=n.pixelType;m.maskIsAlpha=n.maskIsAlpha;n.mask&&(m.mask=new Uint8Array(n.mask));var p,k,f;if(n.pixels)for(m.pixels=[],f=(k=n.pixels.length)&&n.pixels[0].slice,p=0;p<k;p++)m.pixels[p]=f?n.pixels[p].slice(0,n.pixels[p].length):
new n.pixels[p].constructor(n.pixels[p]);if(n.statistics)for(m.statistics=[],k=n.statistics.length,p=0;p<k;p++)m.statistics[p]=g.clone(n.statistics[p]);n=n.validPixelCount;null==n&&(n=m.mask?this._getValidPixelCount(m.mask):m.width*m.height);return m},clamp:function(g){if("F64"!==g&&"F32"!==g){var m;switch(g){case "U8":m=[0,255];break;case "U16":m=[0,65535];break;case "U32":m=[0,4294967295];break;case "S8":m=[-128,127];break;case "S16":m=[-32768,32767];break;case "S32":m=[-2147483648,2147483647];
break;default:m=[-3.4*1E39,3.4*1E39]}var n=m[0];m=m[1];var k=this.pixels,f=this.width*this.height,e=k.length,b,a,c,p,w,q=[];for(p=0;p<e;p++){c=this._createEmptyBand(g,f);b=k[p];for(w=0;w<f;w++)a=b[w],c[w]=a>m?m:a<n?n:a;q.push(c)}this.pixels=q;this.pixelType=g}},calculateStatistics:function(){var g,m=[],p,k=this.mask;for(g=0;g<this.pixels.length;g++)p=this.pixels[g],m.push(this._calculateBandStatistics(p,k));this.statistics=m},_getValidPixelCount:function(g){var m,n=0;for(m=0;m<g.length;m++)g[m]&&
n++;return n},_createEmptyBand:function(g,m){switch(g){case "U8":g=new Uint8Array(m);break;case "U16":g=new Uint16Array(m);break;case "U32":g=new Uint32Array(m);break;case "S8":g=new Int8Array(m);break;case "S16":g=new Int16Array(m);break;case "S32":g=new Int32Array(m);break;case "U32":g=new Uint32Array(m);break;case "F32":g=new Float32Array(m);break;case "F64":g=new Float64Array(m);break;default:g=new Float32Array(m)}return g},_fillFrom8Bit:function(g){var m=this.pixels,n=this.mask;if(!g||!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");
var k,f,e;k=f=e=m[0];3<=m.length&&(f=m[1],e=m[2]);var m=new Uint32Array(g),b=this.width*this.height;if(k.length!==b)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(n&&n.length===b)if(this.maskIsAlpha)for(g=0;g<b;g++)n[g]&&(m[g]=n[g]<<24|e[g]<<16|f[g]<<8|k[g]);else for(g=0;g<b;g++)n[g]&&(m[g]=-16777216|e[g]<<16|f[g]<<8|k[g]);else for(g=0;g<b;g++)m[g]=-16777216|e[g]<<16|f[g]<<8|k[g]},_fillFromNon8Bit:function(g){var m=this.pixels,n=this.mask,k=this.statistics;if(!g||
!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var f=1,e=0,f=1;k&&0<k.length?(e=k.map(function(a){return a.minValue}).reduce(function(a,b){return Math.min(a,b)}),f=k.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,b){return Math.max(a,b)}),f=255/f):(f=255,"S8"===this.pixelType?(e=-128,f=127):"U16"===this.pixelType?f=65535:"S16"===this.pixelType?(e=-32768,f=32767):"U32"===this.pixelType?f=4294967295:"S32"===this.pixelType?(e=-2147483648,
f=2147483647):"F32"===this.pixelType?(e=-3.4*1E39,f=3.4*1E39):"F64"===this.pixelType&&(e=-Number.MAX_VALUE,f=Number.MAX_VALUE),f=255/(f-e));g=new Uint32Array(g);var k=this.width*this.height,b,a,c;b=m[0];if(b.length!==k)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(3<=m.length)if(a=m[1],c=m[2],n&&n.length===k)for(m=0;m<k;m++)n[m]&&(g[m]=-16777216|(c[m]-e)*f<<16|(a[m]-e)*f<<8|(b[m]-e)*f);else for(m=0;m<k;m++)g[m]=-16777216|(c[m]-e)*f<<16|(a[m]-e)*f<<8|(b[m]-e)*f;else if(n&&
n.length===k)for(m=0;m<k;m++)a=(b[m]-e)*f,n[m]&&(g[m]=-16777216|a<<16|a<<8|a);else for(m=0;m<k;m++)a=(b[m]-e)*f,g[m]=-16777216|a<<16|a<<8|a},_fillFrom32Bit:function(g){var m=this.pixels,n=this.mask;if(!g||!m||!m.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var k,f,e;k=f=e=m[0];3<=m.length&&(f=m[1],e=m[2]);var b=this.width*this.height;if(k.length!==b)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var a=0;if(n&&n.length===b)for(m=
0;m<b;m++)g[a++]=k[m],g[a++]=f[m],g[a++]=e[m],g[a++]=n[m]&1;else for(m=0;m<b;m++)g[a++]=k[m],g[a++]=f[m],g[a++]=e[m],g[a++]=1},_calculateBandStatistics:function(g,m){var n=Infinity,k=-Infinity,f=g.length,e,b=0;if(m)for(e=0;e<f;e++)m[e]&&(b=g[e],n=b<n?b:n,k=b>k?b:k);else for(e=0;e<f;e++)b=g[e],n=b<n?b:n,k=b>k?b:k;return{minValue:n,maxValue:k}}})})},"esri/layers/rasterFormats/LercCodec":function(){define([],function(){var p={defaultNoDataValue:-3.4027999387901484E38,decode:function(t,v){var n;v=v||
{};var m=v.inputOffset||0,u=v.encodedMaskData||null===v.encodedMaskData,k={},f=new Uint8Array(t,m,10);k.fileIdentifierString=String.fromCharCode.apply(null,f);if("CntZImage"!=k.fileIdentifierString.trim())throw"Unexpected file identifier string: "+k.fileIdentifierString;m+=10;f=new DataView(t,m,24);k.fileVersion=f.getInt32(0,!0);k.imageType=f.getInt32(4,!0);k.height=f.getUint32(8,!0);k.width=f.getUint32(12,!0);k.maxZError=f.getFloat64(16,!0);m+=24;if(!u)if(f=new DataView(t,m,16),k.mask={},k.mask.numBlocksY=
f.getUint32(0,!0),k.mask.numBlocksX=f.getUint32(4,!0),k.mask.numBytes=f.getUint32(8,!0),k.mask.maxValue=f.getFloat32(12,!0),m+=16,0<k.mask.numBytes){var u=new Uint8Array(Math.ceil(k.width*k.height/8)),f=new DataView(t,m,k.mask.numBytes),e=f.getInt16(0,!0),b=2,a=0;do{if(0<e)for(;e--;)u[a++]=f.getUint8(b++);else for(var c=f.getUint8(b++),e=-e;e--;)u[a++]=c;e=f.getInt16(b,!0);b+=2}while(b<k.mask.numBytes);if(-32768!==e||a<u.length)throw"Unexpected end of mask RLE encoding";k.mask.bitset=u;m+=k.mask.numBytes}else 0===
(k.mask.numBytes|k.mask.numBlocksY|k.mask.maxValue)&&(u=new Uint8Array(Math.ceil(k.width*k.height/8)),k.mask.bitset=u);f=new DataView(t,m,16);k.pixels={};k.pixels.numBlocksY=f.getUint32(0,!0);k.pixels.numBlocksX=f.getUint32(4,!0);k.pixels.numBytes=f.getUint32(8,!0);k.pixels.maxValue=f.getFloat32(12,!0);m+=16;u=k.pixels.numBlocksX;f=k.pixels.numBlocksY;u+=0<k.width%u?1:0;e=f+(0<k.height%f?1:0);k.pixels.blocks=Array(u*e);for(a=b=0;a<e;a++)for(c=0;c<u;c++){var x=0,f=new DataView(t,m,Math.min(10,t.byteLength-
m)),w={};k.pixels.blocks[b++]=w;var q=f.getUint8(0);x++;w.encoding=q&63;if(3<w.encoding)throw"Invalid block encoding ("+w.encoding+")";if(2===w.encoding)m++;else{if(0!==q&&2!==q){q>>=6;w.offsetType=q;if(2===q)w.offset=f.getInt8(1),x++;else if(1===q)w.offset=f.getInt16(1,!0),x+=2;else if(0===q)w.offset=f.getFloat32(1,!0),x+=4;else throw"Invalid block offset type";if(1===w.encoding)if(q=f.getUint8(x),x++,w.bitsPerPixel=q&63,q>>=6,w.numValidPixelsType=q,2===q)w.numValidPixels=f.getUint8(x),x++;else if(1===
q)w.numValidPixels=f.getUint16(x,!0),x+=2;else if(0===q)w.numValidPixels=f.getUint32(x,!0),x+=4;else throw"Invalid valid pixel count type";}m+=x;if(3!=w.encoding)if(0===w.encoding){q=(k.pixels.numBytes-1)/4;if(q!==Math.floor(q))throw"uncompressed block has invalid length";f=new ArrayBuffer(4*q);x=new Uint8Array(f);x.set(new Uint8Array(t,m,4*q));f=new Float32Array(f);w.rawData=f;m+=4*q}else 1===w.encoding&&(q=Math.ceil(w.numValidPixels*w.bitsPerPixel/8),f=new ArrayBuffer(4*Math.ceil(q/4)),x=new Uint8Array(f),
x.set(new Uint8Array(t,m,q)),w.stuffedData=new Uint32Array(f),m+=q)}}k.eofOffset=m;t=null!=v.noDataValue?v.noDataValue:p.defaultNoDataValue;var u=v.encodedMaskData,q=v.returnMask,e=0,b=k.pixels.numBlocksX,a=k.pixels.numBlocksY,c=Math.floor(k.width/b),w=Math.floor(k.height/a),x=2*k.maxZError,m=Number.MAX_VALUE,C,u=u||(k.mask?k.mask.bitset:null),z,f=new (v.pixelType||Float32Array)(k.width*k.height);q&&u&&(z=new Uint8Array(k.width*k.height));for(var q=new Float32Array(c*w),E,B,G=0;G<=a;G++){var F=G!==
a?w:k.height%a;if(0!==F)for(var D=0;D<=b;D++){var I=D!==b?c:k.width%b;if(0!==I){var K=G*k.width*w+D*c,J=k.width-I,L=k.pixels.blocks[e],M,Q;if(2>L.encoding){if(0===L.encoding)M=L.rawData;else{M=L.stuffedData;Q=L.bitsPerPixel;C=L.numValidPixels;E=L.offset;B=x;var S=q,T=k.pixels.maxValue,O=(1<<Q)-1,W=0,U=void 0,V=0,A=void 0,X=void 0,aa=Math.ceil((T-E)/B);M[M.length-1]<<=8*(4*M.length-Math.ceil(Q*C/8));for(U=0;U<C;U++)0===V&&(X=M[W++],V=32),V>=Q?(A=X>>>V-Q&O,V-=Q):(V=Q-V,A=(X&O)<<V&O,X=M[W++],V=32-V,
A+=X>>>V),S[U]=A<aa?E+A*B:T;M=q}Q=0}else n=2===L.encoding?0:L.offset;var l;if(u)for(B=0;B<F;B++){K&7&&(l=u[K>>3],l<<=K&7);for(E=0;E<I;E++)K&7||(l=u[K>>3]),l&128?(z&&(z[K]=1),C=2>L.encoding?M[Q++]:n,m=m>C?C:m,f[K++]=C):(z&&(z[K]=0),f[K++]=t),l<<=1;K+=J}else if(2>L.encoding)for(B=0;B<F;B++){for(E=0;E<I;E++)C=M[Q++],m=m>C?C:m,f[K++]=C;K+=J}else for(m=m>n?n:m,B=0;B<F;B++){for(E=0;E<I;E++)f[K++]=n;K+=J}if(1===L.encoding&&Q!==L.numValidPixels)throw"Block and Mask do not match";e++}}}n=z;z={width:k.width,
height:k.height,pixelData:f,minValue:m,maxValue:k.pixels.maxValue,noDataValue:t};n&&(z.maskData=n);v.returnEncodedMask&&k.mask&&(z.encodedMaskData=k.mask.bitset?k.mask.bitset:null);if(v.returnFileInfo&&(z.fileInfo=g(k),v.computeUsedBitDepths)){v=z.fileInfo;n=k.pixels.numBlocksX*k.pixels.numBlocksY;l={};for(M=0;M<n;M++)Q=k.pixels.blocks[M],0===Q.encoding?l.float32=!0:1===Q.encoding?l[Q.bitsPerPixel]=!0:l[0]=!0;k=Object.keys(l);v.bitDepths=k}return z}},g=function(g){return{fileIdentifierString:g.fileIdentifierString,
fileVersion:g.fileVersion,imageType:g.imageType,height:g.height,width:g.width,maxZError:g.maxZError,eofOffset:g.eofOffset,mask:g.mask?{numBlocksX:g.mask.numBlocksX,numBlocksY:g.mask.numBlocksY,numBytes:g.mask.numBytes,maxValue:g.mask.maxValue}:null,pixels:{numBlocksX:g.pixels.numBlocksX,numBlocksY:g.pixels.numBlocksY,numBytes:g.pixels.numBytes,maxValue:g.pixels.maxValue,noDataValue:this.noDataValue}}};return p})},"esri/layers/rasterFormats/Lerc2Codec":function(){define([],function(){var p={unstuff:function(g,
n,m,p,k,f,e,b){var a=(1<<m)-1,c=0,x,w=0,q,u;g[g.length-1]<<=8*(4*g.length-Math.ceil(m*p/8));if(k)for(x=0;x<p;x++)0===w&&(u=g[c++],w=32),w>=m?(q=u>>>w-m&a,w-=m):(w=m-w,q=(u&a)<<w&a,u=g[c++],w=32-w,q+=u>>>w),n[x]=k[q];else for(k=Math.ceil((b-f)/e),x=0;x<p;x++)0===w&&(u=g[c++],w=32),w>=m?(q=u>>>w-m&a,w-=m):(w=m-w,q=(u&a)<<w&a,u=g[c++],w=32-w,q+=u>>>w),n[x]=q<k?f+q*e:b},unstuffLUT:function(g,n,m,p,k,f){var e=(1<<n)-1,b=0,a=0,c=0,x=c=0,w,q=[];g[g.length-1]<<=8*(4*g.length-Math.ceil(n*m/8));for(var u=Math.ceil((f-
p)/k),a=0;a<m;a++)0===c&&(w=g[b++],c=32),c>=n?(x=w>>>c-n&e,c-=n):(c=n-c,x=(w&e)<<c&e,w=g[b++],c=32-c,x+=w>>>c),q[a]=x<u?p+x*k:f;q.unshift(p);return q},unstuff2:function(g,n,m,p,k,f,e,b){var a=(1<<m)-1,c=0,x,w=0,q=0,u,v,t;if(k)for(x=0;x<p;x++)0===w&&(v=g[c++],w=32,q=0),w>=m?(u=v>>>q&a,w-=m,q+=m):(t=m-w,u=v>>>q&a,v=g[c++],w=32-t,u|=(v&(1<<t)-1)<<m-t,q=t),n[x]=k[u];else for(k=Math.ceil((b-f)/e),x=0;x<p;x++)0===w&&(v=g[c++],w=32,q=0),w>=m?(u=v>>>q&a,w-=m,q+=m):(t=m-w,u=v>>>q&a,v=g[c++],w=32-t,u|=(v&(1<<
t)-1)<<m-t,q=t),n[x]=u<k?f+u*e:b;return n},unstuffLUT2:function(g,n,m,p,k,f){for(var e=(1<<n)-1,b=0,a=0,c=0,x=0,w=0,q=0,u,v=[],t=Math.ceil((f-p)/k),a=0;a<m;a++)0===x&&(u=g[b++],x=32,q=0),x>=n?(w=u>>>q&e,x-=n,q+=n):(c=n-x,w=u>>>q&e,u=g[b++],x=32-c,w|=(u&(1<<c)-1)<<n-c,q=c),v[a]=w<t?p+w*k:f;v.unshift(p);return v},originalUnstuff:function(g,n,m,p){var k=(1<<m)-1,f=0,e,b=0,a,c;g[g.length-1]<<=8*(4*g.length-Math.ceil(m*p/8));for(e=0;e<p;e++)0===b&&(c=g[f++],b=32),b>=m?(a=c>>>b-m&k,b-=m):(b=m-b,a=(c&k)<<
b&k,c=g[f++],b=32-b,a+=c>>>b),n[e]=a;return n},originalUnstuff2:function(g,n,m,p){var k=(1<<m)-1,f=0,e,b=0,a=0,c,x,w;for(e=0;e<p;e++)0===b&&(x=g[f++],b=32,a=0),b>=m?(c=x>>>a&k,b-=m,a+=m):(w=m-b,c=x>>>a&k,x=g[f++],b=32-w,c|=(x&(1<<w)-1)<<m-w,a=w),n[e]=c;return n}},g={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(g){for(var n=65535,m=65535,p=g.length,k=Math.floor(p/2),f=0;k;){var e=359<=k?359:k,k=k-e;do n+=g[f++]<<8,m+=n+=g[f++];while(--e);n=(n&65535)+(n>>>16);m=(m&65535)+(m>>>16)}p&1&&
(m+=n+=g[f]<<8);return((m&65535)+(m>>>16)<<16|(n&65535)+(n>>>16))>>>0},readHeaderInfo:function(g,n){var m=n.ptr,p=new Uint8Array(g,m,6),k={};k.fileIdentifierString=String.fromCharCode.apply(null,p);if(0!==k.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+k.fileIdentifierString;var m=m+6,p=new DataView(g,m,8),f=p.getInt32(0,!0);k.fileVersion=f;m+=4;3<=f&&(k.checksum=p.getUint32(4,!0),m+=4);p=new DataView(g,m,12);k.height=p.getUint32(0,!0);k.width=
p.getUint32(4,!0);m+=8;4<=f?(k.numDims=p.getUint32(8,!0),m+=4):k.numDims=1;p=new DataView(g,m,40);k.numValidPixel=p.getUint32(0,!0);k.microBlockSize=p.getInt32(4,!0);k.blobSize=p.getInt32(8,!0);k.imageType=p.getInt32(12,!0);k.maxZError=p.getFloat64(16,!0);k.zMin=p.getFloat64(24,!0);k.zMax=p.getFloat64(32,!0);m+=40;n.headerInfo=k;n.ptr=m;if(3<=f&&(g=this.computeChecksumFletcher32(new Uint8Array(g,m-(4<=f?52:48),k.blobSize-14)),g!==k.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(g,
n){var m=n.headerInfo,p=this.getDataTypeArray(m.imageType),k=m.numDims*this.getDataTypeSize(m.imageType),f=this.readSubArray(g,n.ptr,p,k);g=this.readSubArray(g,n.ptr+k,p,k);n.ptr+=2*k;k=!0;for(n=0;n<m.numDims;n++)if(f[n]!==g[n]){k=!1;break}m.minValues=f;m.maxValues=g;return k},readSubArray:function(g,n,m,p){if(m===Uint8Array)g=new Uint8Array(g,n,p);else{var k=new ArrayBuffer(p);(new Uint8Array(k)).set(new Uint8Array(g,n,p));g=new m(k)}return g},readMask:function(g,n){var m=n.ptr,p=n.headerInfo,k=
p.width*p.height,f=p.numValidPixel,e=new DataView(g,m,4),p={};p.numBytes=e.getUint32(0,!0);m+=4;if((0===f||k===f)&&0!==p.numBytes)throw"invalid mask";if(0===f)f=new Uint8Array(Math.ceil(k/8)),p.bitset=f,e=new Uint8Array(k),n.pixels.resultMask=e,m+=p.numBytes;else if(0<p.numBytes){f=new Uint8Array(Math.ceil(k/8));e=new DataView(g,m,p.numBytes);g=e.getInt16(0,!0);var b=2,a=0,c=0;do{if(0<g)for(;g--;)f[a++]=e.getUint8(b++);else for(c=e.getUint8(b++),g=-g;g--;)f[a++]=c;g=e.getInt16(b,!0);b+=2}while(b<
p.numBytes);if(-32768!==g||a<f.length)throw"Unexpected end of mask RLE encoding";e=new Uint8Array(k);for(b=b=g=0;b<k;b++)b&7?(g=f[b>>3],g<<=b&7):g=f[b>>3],g&128&&(e[b]=1);n.pixels.resultMask=e;p.bitset=f;m+=p.numBytes}n.ptr=m;n.mask=p;return!0},readDataOneSweep:function(p,n,m){var u=n.ptr,k=n.headerInfo,f=k.numDims,e=k.width*k.height,k=k.numValidPixel*g.getDataTypeSize(k.imageType)*f,b=n.pixels.resultMask;if(m===Uint8Array)p=new Uint8Array(p,u,k);else{var a=new ArrayBuffer(k);(new Uint8Array(a)).set(new Uint8Array(p,
u,k));p=new m(a)}if(p.length===e*f)n.pixels.resultPixels=p;else{n.pixels.resultPixels=new m(e*f);var c=a=m=0,x=0;if(1<f)for(c=0;c<f;c++)for(x=c*e,a=0;a<e;a++)b[a]&&(n.pixels.resultPixels[x+a]=p[m++]);else for(a=0;a<e;a++)b[a]&&(n.pixels.resultPixels[a]=p[m++])}n.ptr=u+k;return!0},readHuffmanTree:function(p,n){var m=this.HUFFMAN_LUT_BITS_MAX,u=new DataView(p,n.ptr,16);n.ptr+=16;if(2>u.getInt32(0,!0))throw"unsupported Huffman version";var k=u.getInt32(4,!0),f=u.getInt32(8,!0),u=u.getInt32(12,!0);if(f>=
u)return!1;var e=new Uint32Array(u-f);g.decodeBits(p,n,e);var b=[],a,c,x;for(a=f;a<u;a++)c=a-(a<k?0:k),b[c]={first:e[a-f],second:null};a=p.byteLength-n.ptr;e=new ArrayBuffer(4*Math.ceil(a/4));(new Uint8Array(e)).set(new Uint8Array(p,n.ptr,a));p=new Uint32Array(e);n=0;var w,e=0;w=p[0];for(a=f;a<u;a++)c=a-(a<k?0:k),x=b[c].first,0<x&&(b[c].second=w<<n>>>32-x,32-n>=x?(n+=x,32===n&&(n=0,e++,w=p[e])):(n+=x-32,e++,w=p[e],b[c].second|=w>>>32-n));var q=w=0,v=new t;for(a=0;a<b.length;a++)void 0!==b[a]&&(w=
Math.max(w,b[a].first));q=w>=m?m:w;30<=w&&console.log("WARning, large NUM LUT BITS IS "+w);var m=[],z,E;for(a=f;a<u;a++)if(c=a-(a<k?0:k),x=b[c].first,0<x)if(f=[x,c],x<=q)for(c=b[c].second<<q-x,z=1<<q-x,x=0;x<z;x++)m[c|x]=f;else for(c=b[c].second,z=v,--x;0<=x;x--)(E=c>>>x&1)?(z.right||(z.right=new t),z=z.right):(z.left||(z.left=new t),z=z.left),0!==x||z.val||(z.val=f[1]);return{decodeLut:m,numBitsLUTQick:q,numBitsLUT:w,tree:v,stuffedData:p,srcPtr:e,bitPos:n}},readHuffman:function(g,n,m){var p=n.headerInfo,
k=p.numDims,f=n.headerInfo.height,e=n.headerInfo.width,b=e*f,a=this.readHuffmanTree(g,n);g=a.decodeLut;var c=a.tree,x=a.stuffedData,w=a.srcPtr,q=a.bitPos,v=a.numBitsLUTQick,a=a.numBitsLUT,t=0===n.headerInfo.imageType?128:0,E,B,G=n.pixels.resultMask,F,D,I,K,J,L,M=0;0<q&&(w++,q=0);var Q=x[w],S=1===n.encodeMode,T=new m(b*k),O=T,W;for(W=0;W<p.numDims;W++){1<k&&(O=new m(T.buffer,b*W,b),M=0);if(n.headerInfo.numValidPixel===e*f)for(I=J=0;I<f;I++)for(K=0;K<e;K++,J++){B=0;E=F=Q<<q>>>32-v;32-q<v&&(E=F|=x[w+
1]>>>64-q-v);if(g[E])B=g[E][1],q+=g[E][0];else for(E=F=Q<<q>>>32-a,32-q<a&&(E=F|=x[w+1]>>>64-q-a),E=c,L=0;L<a;L++)if(E=(D=F>>>a-L-1&1)?E.right:E.left,!E.left&&!E.right){B=E.val;q=q+L+1;break}32<=q&&(q-=32,w++,Q=x[w]);B-=t;S?(B=0<K?B+M:0<I?B+O[J-e]:B+M,B&=255,M=O[J]=B):O[J]=B}else for(I=J=0;I<f;I++)for(K=0;K<e;K++,J++)if(G[J]){B=0;E=F=Q<<q>>>32-v;32-q<v&&(E=F|=x[w+1]>>>64-q-v);if(g[E])B=g[E][1],q+=g[E][0];else for(E=F=Q<<q>>>32-a,32-q<a&&(E=F|=x[w+1]>>>64-q-a),E=c,L=0;L<a;L++)if(E=(D=F>>>a-L-1&1)?
E.right:E.left,!E.left&&!E.right){B=E.val;q=q+L+1;break}32<=q&&(q-=32,w++,Q=x[w]);B-=t;S?(B=0<K&&G[J-1]?B+M:0<I&&G[J-e]?B+O[J-e]:B+M,B&=255,M=O[J]=B):O[J]=B}n.ptr=n.ptr+4*(w+1)+(0<q?4:0)}n.pixels.resultPixels=T},decodeBits:function(g,n,m,u,k){var f=n.headerInfo,e=f.fileVersion,b=0,a=new DataView(g,n.ptr,5<=g.byteLength-n.ptr?5:g.byteLength-n.ptr),c=a.getUint8(0);b++;var x=c>>6,w=0===x?4:3-x,q=0<(c&32)?!0:!1,x=c&31,c=0;if(1===w)c=a.getUint8(b),b++;else if(2===w)c=a.getUint16(b,!0),b+=2;else if(4===
w)c=a.getUint32(b,!0),b+=4;else throw"Invalid valid pixel count type";var w=2*f.maxZError,v,t;k=1<f.numDims?f.maxValues[k]:f.zMax;if(q){n.counter.lut++;q=a.getUint8(b);b++;f=Math.ceil((q-1)*x/8);v=Math.ceil(f/4);v=new ArrayBuffer(4*v);t=new Uint8Array(v);n.ptr+=b;t.set(new Uint8Array(g,n.ptr,f));b=new Uint32Array(v);n.ptr+=f;for(a=0;q-1>>>a;)a++;f=Math.ceil(c*a/8);v=Math.ceil(f/4);v=new ArrayBuffer(4*v);t=new Uint8Array(v);t.set(new Uint8Array(g,n.ptr,f));g=new Uint32Array(v);n.ptr+=f;n=3<=e?p.unstuffLUT2(b,
x,q-1,u,w,k):p.unstuffLUT(b,x,q-1,u,w,k);3<=e?p.unstuff2(g,m,a,c,n):p.unstuff(g,m,a,c,n)}else n.counter.bitstuffer++,a=x,n.ptr+=b,0<a&&(f=Math.ceil(c*a/8),v=Math.ceil(f/4),v=new ArrayBuffer(4*v),t=new Uint8Array(v),t.set(new Uint8Array(g,n.ptr,f)),g=new Uint32Array(v),n.ptr+=f,3<=e?null==u?p.originalUnstuff2(g,m,a,c):p.unstuff2(g,m,a,c,!1,u,w,k):null==u?p.originalUnstuff(g,m,a,c):p.unstuff(g,m,a,c,!1,u,w,k))},readTiles:function(p,n,m){var u=n.headerInfo,k=u.width,f=u.height,e=u.microBlockSize,b=u.imageType,
a=g.getDataTypeSize(b),c=Math.ceil(k/e),x=Math.ceil(f/e);n.pixels.numBlocksY=x;n.pixels.numBlocksX=c;for(var w=n.pixels.ptr=0,q=0,v=0,t=0,E=0,B=0,G=0,F=0,D=w=0,I=0,K=0,G=G=w=G=0,J,L=new m(e*e),M=f%e||e,Q=k%e||e,u=u.numDims,S,T=n.pixels.resultMask,O=n.pixels.resultPixels,v=0;v<x;v++)for(E=v!==x-1?e:M,t=0;t<c;t++)for(B=t!==c-1?e:Q,I=v*k*e+t*e,K=k-B,S=0;S<u;S++){1<u&&(O=new m(n.pixels.resultPixels.buffer,k*f*S*a,k*f));G=p.byteLength-n.ptr;q=new DataView(p,n.ptr,Math.min(10,G));J={};G=0;F=q.getUint8(0);
G++;w=F>>6&255;D=F>>2&15;if(D!==(t*e>>3&15))throw"integrity issue";F&=3;if(3<F)throw n.ptr+=G,"Invalid block encoding ("+F+")";if(2===F)n.counter.constant++,n.ptr+=G;else if(0===F){n.counter.uncompressed++;n.ptr+=G;G=E*B*a;w=p.byteLength-n.ptr;G=G<w?G:w;w=new ArrayBuffer(0===G%a?G:G+a-G%a);q=new Uint8Array(w);q.set(new Uint8Array(p,n.ptr,G));J=new m(w);G=0;if(T)for(w=0;w<E;w++){for(q=0;q<B;q++)T[I]&&(O[I]=J[G++]),I++;I+=K}else for(w=0;w<E;w++){for(q=0;q<B;q++)O[I++]=J[G++];I+=K}n.ptr+=G*a}else if(w=
g.getDataTypeUsed(b,w),J=g.getOnePixel(J,G,w,q),G+=g.getDataTypeSize(w),3===F)if(n.ptr+=G,n.counter.constantoffset++,T)for(w=0;w<E;w++){for(q=0;q<B;q++)T[I]&&(O[I]=J),I++;I+=K}else for(w=0;w<E;w++){for(q=0;q<B;q++)O[I++]=J;I+=K}else if(n.ptr+=G,g.decodeBits(p,n,L,J,S),G=0,T)for(w=0;w<E;w++){for(q=0;q<B;q++)T[I]&&(O[I]=L[G++]),I++;I+=K}else for(w=0;w<E;w++){for(q=0;q<B;q++)O[I++]=L[G++];I+=K}}},formatFileInfo:function(p){return{fileIdentifierString:p.headerInfo.fileIdentifierString,fileVersion:p.headerInfo.fileVersion,
imageType:p.headerInfo.imageType,height:p.headerInfo.height,width:p.headerInfo.width,numValidPixel:p.headerInfo.numValidPixel,microBlockSize:p.headerInfo.microBlockSize,blobSize:p.headerInfo.blobSize,maxZError:p.headerInfo.maxZError,pixelType:g.getPixelType(p.headerInfo.imageType),eofOffset:p.eofOffset,mask:p.mask?{numBytes:p.mask.numBytes}:null,pixels:{numBlocksX:p.pixels.numBlocksX,numBlocksY:p.pixels.numBlocksY,maxValue:p.headerInfo.zMax,minValue:p.headerInfo.zMin,noDataValue:p.noDataValue}}},
constructConstantSurface:function(g){var n=g.headerInfo.zMax,m=g.headerInfo.numDims,p=g.headerInfo.height*g.headerInfo.width,k=p*m,f=0,e=0,b=0,a=g.pixels.resultMask;if(a)if(1<m)for(f=0;f<m;f++)for(b=f*p,e=0;e<p;e++)a[e]&&(g.pixels.resultPixels[b+e]=n);else for(e=0;e<p;e++)a[e]&&(g.pixels.resultPixels[e]=n);else if(g.pixels.resultPixels.fill)g.pixels.resultPixels.fill(n);else for(e=0;e<k;e++)g.pixels.resultPixels[e]=n},getDataTypeArray:function(g){switch(g){case 0:g=Int8Array;break;case 1:g=Uint8Array;
break;case 2:g=Int16Array;break;case 3:g=Uint16Array;break;case 4:g=Int32Array;break;case 5:g=Uint32Array;break;case 6:g=Float32Array;break;case 7:g=Float64Array;break;default:g=Float32Array}return g},getPixelType:function(g){switch(g){case 0:g="S8";break;case 1:g="U8";break;case 2:g="S16";break;case 3:g="U16";break;case 4:g="S32";break;case 5:g="U32";break;case 6:g="F32";break;case 7:g="F64";break;default:g="F32"}return g},isValidPixelValue:function(g,n){if(null==n)return!1;switch(g){case 0:g=-128<=
n&&127>=n;break;case 1:g=0<=n&&255>=n;break;case 2:g=-32768<=n&&32767>=n;break;case 3:g=0<=n&&65536>=n;break;case 4:g=-2147483648<=n&&2147483647>=n;break;case 5:g=0<=n&&4294967296>=n;break;case 6:g=-3.4027999387901484E38<=n&&3.4027999387901484E38>=n;break;case 7:g=4.9E-324<=n&&1.7976931348623157E308>=n;break;default:g=!1}return g},getDataTypeSize:function(g){var n=0;switch(g){case 0:case 1:n=1;break;case 2:case 3:n=2;break;case 4:case 5:case 6:n=4;break;case 7:n=8;break;default:n=g}return n},getDataTypeUsed:function(g,
n){var m=g;switch(g){case 2:case 4:m=g-n;break;case 3:case 5:m=g-2*n;break;case 6:m=0===n?g:1===n?2:1;break;case 7:m=0===n?g:g-2*n+1;break;default:m=g}return m},getOnePixel:function(g,n,m,p){g=0;switch(m){case 0:g=p.getInt8(n);break;case 1:g=p.getUint8(n);break;case 2:g=p.getInt16(n,!0);break;case 3:g=p.getUint16(n,!0);break;case 4:g=p.getInt32(n,!0);break;case 5:g=p.getUInt32(n,!0);break;case 6:g=p.getFloat32(n,!0);break;case 7:g=p.getFloat64(n,!0);break;default:throw"the decoder does not understand this pixel type";
}return g}},t=function(g,n,m){this.val=g;this.left=n;this.right=m};return{decode:function(p,n){n=n||{};var m=n.noDataValue,u=0,k={};k.ptr=n.inputOffset||0;k.pixels={};if(g.readHeaderInfo(p,k)){var u=k.headerInfo,f=u.fileVersion,e=g.getDataTypeArray(u.imageType);g.readMask(p,k);u.numValidPixel===u.width*u.height||k.pixels.resultMask||(k.pixels.resultMask=n.maskData);var b=u.width*u.height;k.pixels.resultPixels=new e(b*u.numDims);k.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};
if(0!==u.numValidPixel)if(u.zMax===u.zMin)g.constructConstantSurface(k);else if(4<=f&&g.checkMinMaxRanges(p,k))g.constructConstantSurface(k);else{var a=new DataView(p,k.ptr,2),c=a.getUint8(0);k.ptr++;if(c)g.readDataOneSweep(p,k,e);else if(1<f&&1>=u.imageType&&1E-5>Math.abs(u.maxZError-.5)){a=a.getUint8(1);k.ptr++;k.encodeMode=a;if(2<a||4>f&&1<a)throw"Invalid Huffman flag "+a;a?g.readHuffman(p,k,e):g.readTiles(p,k,e)}else g.readTiles(p,k,e)}k.eofOffset=k.ptr;n.inputOffset?(p=k.headerInfo.blobSize+
n.inputOffset-k.ptr,1<=Math.abs(p)&&(k.eofOffset=n.inputOffset+k.headerInfo.blobSize)):(p=k.headerInfo.blobSize-k.ptr,1<=Math.abs(p)&&(k.eofOffset=k.headerInfo.blobSize));p={width:u.width,height:u.height,pixelData:k.pixels.resultPixels,minValue:u.zMin,maxValue:u.zMax,validPixelCount:u.numValidPixel,dimCount:u.numDims,dimStats:{minValues:u.minValues,maxValues:u.maxValues},maskData:k.pixels.resultMask};if(k.pixels.resultMask&&g.isValidPixelValue(u.imageType,m)){f=k.pixels.resultMask;for(u=0;u<b;u++)f[u]||
(p.pixelData[u]=m);p.noDataValue=m}k.noDataValue=m;n.returnFileInfo&&(p.fileInfo=g.formatFileInfo(k));return p}},getBandCount:function(p){for(var n=0,m=0,u={ptr:0,pixels:{}};m<p.byteLength-58;)g.readHeaderInfo(p,u),m+=u.headerInfo.blobSize,n++,u.ptr=m;return n}}})},"esri/layers/pixelFilters/VectorFieldPixelFilter":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.layers.pixelFilters.VectorFieldPixelFilter",
speedUnits:["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"],constructor:function(m){g.mixin(this,m);this.isDataUV=m&&m.isDataUV?m.isDataUV:!1;this.computeMagnitudeAndDirection=g.hitch(this,this.computeMagnitudeAndDirection);this.unitConversionFactor=1;this._updateUnitConvFactor()},setUnits:function(g,k){this.inputUnit=g;this.outputUnit=k;this.unitConversionFactor=1;this._updateUnitConvFactor()},_updateUnitConvFactor:function(){var g=m.indexOf(this.speedUnits,
this.inputUnit),k=m.indexOf(this.speedUnits,this.outputUnit);if(this.inputUnit&&this.outputUnit&&0<=g&&0<=k){var f=[1,.277778,.514444,.3048,.44704,0];this.unitConversionFactor=f[g]/f[k]}},computeMagnitudeAndDirection:function(g){if(!n.isDefined(g))throw"Could not compute magnitude and direction. No pixel data is available.";var k=g.pixelBlock;if(!n.isDefined(k)||2!==k.getPlaneCount())throw"Could not compute magnitude and direction. Pixel data does not contain two bands.";var f=g.extent,e=(f.xmax-
f.xmin)/k.width,b=(f.ymax-f.ymin)/k.height,a=f.xmin+e/2,f=f.ymax-b/2;k.statistics[0].minValue=0;k.statistics[0].maxValue=0;var c=180/Math.PI,m=[],p=0,q=0,u=0,t=!n.isDefined(k.mask),v,B,G,F,D,I,K,J;D=K=Infinity;I=J=-Infinity;for(p=0;p<k.height;p++)for(q=0;q<k.width;q++,u++)if(m.push([a+e*q,f-b*p]),t||k.mask[u])G=v=k.pixels[0][u]*this.unitConversionFactor,F=B=k.pixels[1][u],this.isDataUV&&(G=Math.sqrt(v*v+B*B),F=90-c*Math.atan2(B,v),k.pixels[0][u]=G*this.unitConversionFactor,k.pixels[1][u]=F),G>I&&
(I=G),G<D&&(D=G),F>J&&(J=F),F<K&&(K=F);k.statistics[0].maxValue=I;k.statistics[0].minValue=D;k.statistics[1].maxValue=J;k.statistics[1].minValue=K;g.locations=m;return g}})})},"esri/layers/rasterFormats/ImageCanvasDecoder":function(){define(["require","dojo/_base/declare","dojo/Deferred","dojo/sniff"],function(p,g,t,v){var n;return g(null,{constructor:function(g){this.ctx=g.ctx;this._loadRasterFormatModule()},decode:function(g,n){if(!n.width||!n.height)throw"Native decoding requires the image format, width and height";
var k=new t,f,e=new Uint8Array(g);g=this._getFormat(g);if("error"===g)throw"invalid format";"jpeg"===g&&(f=this._getMask(e,n));var b="",a,c;for(a=0;a<e.length;a+=65535)c=e.subarray(a,a+65535>e.length-1?e.length-1:a+65535),b+=String.fromCharCode.apply(null,c);var e="data:image/"+g+";base64,"+window.btoa(b),m=new Image,p;m.src=e;var q=this;m.onload=function(){q.ctx.clearRect(0,0,n.width,n.height);q.ctx.drawImage(m,0,0);var b=q.ctx.getImageData(0,0,m.width,m.height);p=b.data;if(f)for(a=0;a<f.length;a++)p[4*
a+3]=f[a]?255:0;q.ctx.putImageData(b,0,0);k.resolve(null)};m.onerror=function(){k.reject("cannot load image")};return k},_getFormat:function(g){g=new Uint8Array(g,0,10);var m="error";255===g[0]&&216===g[1]?m="jpeg":137===g[0]&&80===g[1]&&78===g[2]&&71===g[3]&&(m="png");return m},_getMask:function(g,p){var k;try{if(!n)throw"The zlib decoder module is not loaded.";var f=0,e=0,b=Math.round(g.length/2);1===b%2&&(b+=1);for(var a=g.length-2,f=b;f<a&&(255!==g[f]||217!==g[f+1]);f++);b=f+=2;if(b<g.length-
1){var c=(new n(g.subarray(b))).getBytes();k=new Uint8Array(p.width*p.height);for(f=g=0;f<c.length;f++)for(e=7;0<=e;e--)k[g++]=c[f]>>e&1}}catch(x){}return k},_loadRasterFormatModule:function(){10>v("ie")||p(["./Zlib"],function(g){n=g})}})})},"esri/tasks/ImageServiceIdentifyTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),function(p,g,t,v,n,m,u,k){p=p(u,{declaredClass:"esri.tasks.ImageServiceIdentifyTask",
constructor:function(f){this._url.path+="/identify";this._handler=g.hitch(this,this._handler)},__msigns:[{n:"execute",c:3,a:[{i:0,p:["geometry"]}],e:2}],_handler:function(f,e,b,a,c){try{var g=new k(f);this._successHandler([g],"onComplete",b,c)}catch(w){this._errorHandler(w,a,c)}},execute:function(f,e,b,a){var c=a.assembly;f=this._encode(g.mixin({},this._url.query,{f:"json"},f.toJson(c&&c[0])));var k=this._handler,m=this._errorHandler;return n({url:this._url.path,content:f,callbackParamName:"callback",
load:function(c,f){k(c,f,e,b,a.dfd)},error:function(c){m(c,b,a.dfd)}})},onComplete:function(){}});m._createWrappers(p);return p})},"esri/tasks/ImageServiceIdentifyResult":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "),function(p,g,t,v,n,m){return p(null,{declaredClass:"esri.tasks.ImageServiceIdentifyResult",constructor:function(g){g.catalogItems&&(this.catalogItems=new m(g.catalogItems));g.location&&(this.location=n.fromJson(g.location));
this.catalogItemVisibilities=g.catalogItemVisibilities;this.name=g.name;this.objectId=g.objectId;this.value=g.value;this.processedValues=g.processedValues;this.properties=g.properties}})})},"esri/tasks/ImageServiceIdentifyParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(p,g,t,v,n,m,u,k){return p(null,{declaredClass:"esri.tasks.ImageServiceIdentifyParameters",geometry:null,mosaicRule:null,
renderingRule:null,renderingRules:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null,maxItemCount:null,returnPixelValues:!0,toJson:function(f){var e=f&&f.geometry||this.geometry;f={geometry:e,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?t.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?t.toJson(this.renderingRule.toJson()):null};e&&(f.geometryType=k.getJsonType(e));
e=this.timeExtent;f.time=e?e.toJson().join(","):null;u.isDefined(this.pixelSizeX)&&u.isDefined(this.pixelSizeY)?f.pixelSize=t.toJson({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(f.pixelSize=this.pixelSize?t.toJson(this.pixelSize.toJson()):null);this.renderingRules&&(f.renderingRules=t.toJson(v.map(this.renderingRules,function(b){return b.toJson()})));u.isDefined(this.returnPixelValues)&&(f.returnPixelValues=this.returnPixelValues);u.isDefined(this.maxItemCount)&&
(f.maxItemCount=this.maxItemCount);return f}})})},"esri/layers/pixelFilters/StretchFilter":function(){define(["dojo/_base/declare","dojo/_base/lang","../PixelBlock"],function(p,g,t){var v;return p(null,{stretchType:0,min:0,max:255,numberOfStandardDeviations:2,statistics:null,histograms:null,dra:!1,minPercent:.25,maxPercent:.5,useGamma:!1,gamma:null,raster:null,outputPixelType:"U8",computeGamma:!1,constructor:function(g){this.stretchType=g.stretchType||g.StretchType||this.stretchType;this.min=g.min||
g.Min||this.min;this.max=g.max||g.Max||this.max;this.numberOfStandardDeviations=g.numberOfStandardDeviations||g.NumberOfStandardDeviations||this.numberOfStandardDeviations;this.statistics=g.statistics||g.Statistics||this.statistics;this.dra=g.dra||g.DRA||g.dRA||this.dra;this.minPercent=g.minPercent||g.MinPercent||this.minPercent;this.maxPercent=g.maxPercent||g.MaxPercent||this.maxPercent;this.useGamma=g.useGamma||g.UseGamma||this.useGamma;this.gamma=g.gamma||g.Gamma||this.gamma;this.computeGamma=
g.computeGamma||g.ComputeGamma||this.computeGamma;this.raster=g.raster||g.Raster||this.raster;this.outputPixelType=g.outputPixelType||g.OutputPixelType||this.outputPixelType;this.raster=g.raster||g.Raster||this.raster;v=this},filter:function(g){if(null!==g&&null!==g.pixelBlock&&null!==g.pixelBlock.pixels){var m=g.pixelBlock,n=m.pixels,k=m.width*m.height,f=n.length,e;(e=6===v.stretchType||3===v.stretchType&&v.dra)&&v._calculateStatisticsHistograms(g);if(v.dra)if(e)v._statistics=m.statistics,v._histograms=
m.histograms;else{var b=m.statistics;v._statistics=[];for(e=0;e<f;e++)v._statistics[e]=[b[e].minValue,b[e].maxValue,0,0]}else v._statistics=v.statistics,v._histograms=v.histograms;v.computeGamma&&(v.gamma=v._computeGammaValues(m.pixelType),v.useGamma=!0);v._createLUT(g);if(void 0===v.LUT||null===v.LUT)return v._filterNoLUT(g);var b=v.LUT,a=v.LUTOffset,c,p;for(e=0;e<f;e++)for(p=b[e],m=0;m<k;m++)c=n[e][m],n[e][m]=p[c-a];g.pixelBlock.pixelType="U8";return g}},_calculateStatisticsHistograms:function(n){n=
n.pixelBlock;var m=n.pixelType,p=n.pixels,k=n.mask,f=p.length,e,b,a,c,x=function(a){this.min=-.5;this.max=255.5;this.size=256;g.mixin(this,a);this.counts=this.counts||new Uint32Array(this.size)},w=[],q,t,v,E,B,G;for(a=0;a<f;a++){q=new x;t=q.counts;E=p[a];if("U8"===m)if(k)for(c=0;c<n.width*n.height;c++)k[c]&&t[E[c]]++;else for(c=0;c<n.width*n.height;c++)t[E[c]]++;else{e=n.statistics[a].minValue;b=n.statistics[a].maxValue;q.min=e;q.max=b;b=(b-e)/256;v=new Uint32Array(257);if(k)for(c=0;c<n.width*n.height;c++)k[c]&&
v[Math.floor((E[c]-e)/b)]++;else for(c=0;c<n.width*n.height;c++)v[Math.floor((E[c]-e)/b)]++;for(c=0;255>c;c++)t[c]=v[c];t[255]=v[255]+v[256]}w.push(q);E=[];e=n.statistics[a].minValue;b=n.statistics[a].maxValue;for(c=G=B=v=0;c<q.size;c++)v+=t[c],B+=c*t[c];B/=v;for(c=0;c<q.size;c++)G+=t[c]*Math.pow(c-B,2);t=Math.sqrt(G/(v-1));c=(B+.5)*(q.max-q.min)/q.size+q.min;q=t*(q.max-q.min)/q.size;E.push(e);E.push(b);E.push(c);E.push(q);n.statistics[a]=E}n.histograms=w},_getCutOffPoints:function(g){g=g.pixelBlock.pixels.length;
var m=[],n=[],k,f,e,b,a,c;switch(v.stretchType){case 5:for(a=0;a<g;a++)m[a]=v._statistics[a][0],n[a]=v._statistics[a][1];break;case 3:for(a=0;a<g;a++)m[a]=v._statistics[a][2]-v.numberOfStandardDeviations*v._statistics[a][3],n[a]=v._statistics[a][2]+v.numberOfStandardDeviations*v._statistics[a][3],m[a]<v._statistics[a][0]&&(m[a]=v._statistics[a][0]),n[a]>v._statistics[a][1]&&(n[a]=v._statistics[a][1]);break;case 6:for(a=0;a<g;a++){k=v._histograms[a];b=new Uint32Array(k.size);e=k.counts;for(c=f=0;c<
k.size;c++)f+=e[c],b[c]=f;e=v.minPercent*f/100;for(c=1;c<k.size;c++)if(b[c]>e){m[a]=k.min+(k.max-k.min)/k.size*(c-.5);break}e=(1-v.maxPercent/100)*f;for(c=k.size-2;0<=c;c--)if(b[c]<e){n[a]=k.min+(k.max-k.min)/k.size*(c+.5);break}}break;default:for(a=0;a<g;a++)m[a]=0,n[a]=255}return{minCutOff:m,maxCutOff:n}},_createLUT:function(g){var m=g.pixelBlock,n=m.pixelType;if("U8"===n||"U16"===n||"S8"===n||"S16"===n){if(v._LUTSignature&&(n=v._computeLutSignature(),n.length===v._LUTSignature.length&&!n.some(function(a,
b){return a!==v._LUTSignature[b]})))return;var n=m.pixels.length,k=[],f=[],e=[],b,a,c,p=v.max,w=v.min,q=v.gamma,t=p-w,z=v._getCutOffPoints(g);g=z.minCutOff;var z=z.maxCutOff,E=0,B=256,G;"S8"===m.pixelType?E=-127:"S16"===m.pixelType&&(E=-32767);if("U16"===m.pixelType||"S16"===m.pixelType)B=65536;for(m=0;m<n;m++)k[m]=z[m]-g[m];if(v.useGamma&&null!==q&&q.length===n)for(m=0;m<n;m++)e[m]=1<q[m]?2<q[m]?6.5+Math.pow(q[m]-2,2.5):6.5+100*Math.pow(2-q[m],4):1;if(v.useGamma)for(var F,m=0;m<n;m++){G=[];for(b=
0;b<B;b++)a=b+E,F=(a-g[m])/k[m],c=1,1<q[m]&&(c-=Math.pow(1/t,F*e[m])),a<z[m]&&a>g[m]?G[b]=Math.floor(c*t*Math.pow(F,1/q[m]))+w:a>z[m]?G[b]=p:a<g[m]&&(G[b]=w);f[m]=G}else for(m=0;m<n;m++){G=[];for(b=0;b<B;b++)a=b+E,G[b]=a<g[m]?w:a>z[m]?p:Math.floor((a-g[m])/k[m]*t)+w;f[m]=G}v.LUT=f;v.LUTOffset=E;v._LUTSignature=v._computeLutSignature()}},_computeLutSignature:function(){var g=[],m,p;g.push(v.stretchType);g.push(v.min);g.push(v.max);g.push(v.numberOfStandardDeviations);if(v._statistics)for(m=0;m<v._statistics.length;m++)for(p=
0;p<v._statistics[m].length;p++)g.push(v._statistics[m][p]);g.push(v.dra?1:0);g.push(v.minPercent);g.push(v.maxPercent);if(v.gamma)for(m=0;m<v._statistics.length;m++)g.push(v.gamma[m]);g.push(v.useGamma?1:0);return g},_filterNoLUT:function(g){if(null!==g&&null!==g.pixelBlock&&null!==g.pixelBlock.pixels){var m=g.pixelBlock,n=m.pixels,k=m.mask,m=m.width*m.height,f=n.length,e=[],b=[],a,c,p,w,q,t=v.max,z=v.min,E=v.gamma,B=t-z;a=v._getCutOffPoints(g);var G=a.minCutOff,F=a.maxCutOff;for(a=0;a<f;a++)e[a]=
F[a]-G[a];if(v.useGamma&&null!==E&&E.length===f)for(a=0;a<f;a++)b[a]=1<E[a]?2<E[a]?6.5+Math.pow(E[a]-2,2.5):6.5+100*Math.pow(2-E[a],4):1;if(v.useGamma)if(void 0!==k&&null!==k)for(c=0;c<m;c++){if(k[c])for(a=0;a<f;a++)p=n[a][c],q=(p-G[a])/e[a],w=1,1<E[a]&&(w-=Math.pow(1/B,q*b[a])),p<F[a]&&p>G[a]?n[a][c]=Math.floor(w*B*Math.pow(q,1/E[a]))+z:p>F[a]?n[a][c]=t:p<G[a]&&(n[a][c]=z)}else for(c=0;c<m;c++)for(a=0;a<f;a++)p=n[a][c],q=(p-G[a])/e[a],w=1,1<E[a]&&(w-=Math.pow(1/B,q*b[a])),p<F[a]&&p>G[a]?n[a][c]=
Math.floor(w*B*Math.pow(q,1/E[a]))+z:p>F[a]?n[a][c]=t:p<G[a]&&(n[a][c]=z);else if(void 0!==k&&null!==k)for(c=0;c<m;c++){if(k[c])for(a=0;a<f;a++)p=n[a][c],p<F[a]&&p>G[a]?n[a][c]=Math.floor((p-G[a])/e[a]*B)+z:p>F[a]?n[a][c]=t:p<G[a]&&(n[a][c]=z)}else for(c=0;c<m;c++)for(a=0;a<f;a++)p=n[a][c],p<F[a]&&p>G[a]?n[a][c]=Math.floor((p-G[a])/e[a]*B)+z:p>F[a]?n[a][c]=t:p<G[a]&&(n[a][c]=z);g.pixelBlock.pixelType="U8";return g}},_computeGammaValues:function(g){var m=this._statistics.length,n,k=[],f;for(n=0;n<
m;n++)f=this._statistics[n][2],"U8"!==g&&(f=255*(f-this._statistics[n][0])/(this._statistics[n][1]-this._statistics[n][0])),k.push(this._computeGammaValue(f));return k},_computeGammaValue:function(g){if(0!==g&&!(255<g||0>g)){var m=0;0<g&&150!=g&&255>g&&(m=150>=g?45*Math.cos(.01047*g):17*Math.sin(.021*g));m=Math.log((g+m)/255);if(0!==m&&(g=Math.log(g/255)/m,!isNaN(g)))return Math.min(9.9,Math.max(.01,g))}}})})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/Deferred dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F){return p([x],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(b,c){c=c||{};c.mode&&c.mode!==x.MODE_STREAM||(this._isStream=!0,this.currentMode=this.mode=x.MODE_STREAM,this._mode=new w(this));this.purgeOptions=new F(this,c.purgeOptions||{});this.purgeInterval=c.purgeInterval||0;this._reconnectAttempts=0;this.maxReconnectAttempts=10;this.socket=this._reconnectTimeoutId=null;this._keepLatestQueried=!1;this._keepLatestUrl=
null;this._relatedQueried=!1;this._joinField=this._relatedUrl=null;this._refreshing=!1;this._attemptReconnect=n.hitch(this,this._attemptReconnect);this._purge=n.hitch(this,this._purge);this._processServiceJson=n.hitch(this,this._processServiceJson);if(n.isObject(b)&&b.layerDefinition)this._initFeatureLayer(b,c);else{var e=this;a({url:b,content:n.mixin({f:"json"}),callbackParamName:"callback"}).then(function(a){e._processServiceJson(a,c)},function(a){e._errorHandler(a)})}},_processServiceJson:function(b,
c){var e=this;b.relatedFeatures&&b.relatedFeatures.featuresUrl&&b.relatedFeatures.joinField?(this._relatedUrl=b.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=b.relatedFeatures.joinField,a({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(a){a=a.fields||[];var f=t.map(b.fields,function(a){return a.name.toLowerCase()});t.forEach(a,function(a){-1===t.indexOf(f,a.name.toLowerCase())&&b.fields.push(a)});c.resourceInfo=b;e._initFeatureLayer(e._url,c)},
function(a){e.onError({error:a})})):(c.resourceInfo=b,this._initFeatureLayer(this._url,c))},_initLayer:function(a,b){this.inherited(arguments);if(a){var c;if(a.layerDefinition)this.purgeOptions=new F(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||a.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var e=this._getWebsocketConnectionInfo(a),f=e.urls;f&&f.length?(this._socketUrls=f,this.socketUrl=f[0],this.socketDirection=
"broadcast"===this._params.socketDirection?"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=e.token,f.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=f.length)):(this.socketUrl=void 0,e="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(e+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(e)))}if(this._params.filter)try{this._filter=
c=this._makeFilter(this._params.filter)}catch(M){this.onError(Error("Error trying to create filter object: "+M+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){c=c||{};c.geometry=this._params.geometryDefinition;c.outFields=this._outFields;c.where=this._defnExpr;try{this._filter=c=this._makeFilter(c)}catch(M){this.onError(Error("Error trying to create filter object: "+M+". Layer will not have filter applied")),this._filter=
null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=a.keepLatestArchive?a.keepLatestArchive.featuresUrl:null;a.relatedFeatures&&a.relatedFeatures.featuresUrl&&a.relatedFeatures.joinField&&(this._relatedUrl=a.relatedFeatures.featuresUrl,this.objectIdField=
this._joinField=a.relatedFeatures.joinField);this.objectIdField||this._makeObjectIdField();this._map&&this.socketUrl&&!this._connected&&this.connect()}},_isWebGLCompatible:function(){return!1},_setMap:function(a){var b=this.inherited(arguments),c=this._getRenderer();this.timeInfo&&(this._trackIdField||c&&(c.latestObservationRenderer||c.trackRenderer))&&(this._trackManager=new q(this),this._trackManager.initialize(a));this.socketUrl&&!this._connected&&this._map&&this.connect();return b},_unsetMap:function(a,
b){t.forEach(this._connects,g.disconnect);(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&this._mode._clearFeatureMap&&
this._mode._clearFeatureMap(),this._trackManager&&this._trackManager.clearTracks()}catch(D){}this.inherited(arguments);this._trackManager&&this._trackManager.createTracklineContainer()},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(a){this.setFilter({where:a})},getDefinitionExpression:function(){var a;this._filter&&(a=this._filter.where);return a},destroy:function(){this.disconnect();this.inherited(arguments)},
onResume:function(a){this.inherited(arguments)},setGeometryDefinition:function(a){this.setFilter({geometry:a})},getGeometryDefinition:function(){var a;this._filter&&(a=this._filter.geometry);return a},connect:function(a){var b=new m,c={},e=this._filter,f,g,n=this.socketUrl,q;try{this._connected||this._connecting?b.reject(Error("Cannot start new connection process. Layer is connecting.")):(this._connecting=!0,this._getRelatedFeatures().then(function(){return this._getKeepLatestFeatures()}.bind(this)).then(function(){this._websocketToken&&
(c.token=this._websocketToken);this._map&&this._map.spatialReference&&this.spatialReference&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(c.outSR=this._map.spatialReference.wkid);if(e)for(g in e)null!==e[g]&&(f="geometry"===g?JSON.stringify(e[g]):e[g],c[g]=f);n+="?"+k.objectToQuery(c);q=this._createConnection(n,a);b.resolve(q)}.bind(this)).otherwise(function(a){b.reject(a)}))}catch(T){a&&(a(T,!1),b.reject(T)),this.onConnectionError({error:T})}return b.promise},disconnect:function(a){var b=
this._refreshing?"Disconnecting as part of layer refresh cycle":"Connection closed from client",c=this._refreshing?!0:!1;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connecting=this._connected=!1;this.socket&&this.socket.close();this.onDisconnect({willReconnect:c,message:b});a&&a(null,!0)},setFilter:function(a){var b,c;if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;
try{if(void 0!==a.outFields)return c=Error("Outfields property cannot be changed after layer is created"),this.onFilterChange({filter:this.getFilter(),error:c}),!1;b=this._makeFilter(a)}catch(J){return c=Error(J),this.onFilterChange({filter:this.getFilter(),error:c}),!1}if(this.socket)a={filter:b},this.socket.send(JSON.stringify(a));else f.once(this,"connect",function(a){this.setFilter(b)});return!0},getFilter:function(){var a=this._filter,b={},c=["geometry","outFields","where"];a&&t.forEach(c,function(c){var e=
a[c];e&&("geometry"===c?e=C.fromJson(e):"outFields"===c&&(e=e.split(",")),b[c]=e)});return b},setMaximumTrackPoints:function(a){if(!a&&0!==a)return!1;this.maximumTrackPoints=a;this._mode.propertyChangeHandler(3)},getUniqueValues:function(a){var b,c={},e=[];b=this._getField(a,!0);if(!b)return e;a=b.name;t.forEach(this.graphics||[],function(b){b=(b.attributes||{})[a];void 0===b||c[b]||(c[b]=1,e.push(b))});e.sort(function(a,b){return a<b?-1:a>b?1:0});return e},getLatestObservations:function(){var a=
[];return a=this._trackManager?this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(a){var b=this.purgeInterval;this.purgeInterval=a;this._togglePurgeT();a&&this._togglePurgeT(!0);if(b!==a)this.onPurgeIntervalChange();return this},_togglePurgeT:function(a){if(a&&this.purgeInterval){var b=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&(this._purgeT=setTimeout(function(){b.updating||b.suspended||(b._mode._flushDrawBuffer(),b._togglePurgeT(!0))},
6E4*this.purgeInterval))}else this._purgeT&&(clearTimeout(this._purgeT),this._purgeT=null)},onMessage:function(){},onConnect:function(){},onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},_createConnection:function(a,b){var c=this,e=new WebSocket(a);e.onopen=function(){c.socket=e;c._connected=!0;c._connecting=!1;c._reconnecting=!1;c._reconnectAttempts=0;c._bind();c.onConnect();b&&b(null,!0)};e.onclose=
function(a){var b,e=!0,f=c._connected,g=null;if(c._connected||c._reconnecting){if(a.code)if(b="Connection failed: ",1001===a.code)b+=a.reason||"Service is going away.",e=!1;else if(4400===a.code)b+=a.reason||"Invalid url parameters. Check filter properties.",e=!1;else if(4404===a.code)b+="Service not found",e=!1;else if(4401===a.code||4403===a.code)b+="Not authorized",e=!1;e&&(c._reconnectAttempts+=1,c._reconnectAttempts>c.maxReconnectAttempts&&(b="Maximum reconnect attempts exceeded",e=!1,f=!0));
c._connected=!1;f&&(b&&(g=Error(b)),c.onDisconnect({error:g,willReconnect:e}));e?c._attemptReconnect():c.socket=null}else c.socket||(g=Error("Could not make connection to service"),c.onConnectionError({error:g})),c.socket=null,c._connected=!1};e.onerror=function(a){console.log("Socket error")};return e},_getKeepLatestFeatures:function(){var a=new m;this._map&&this._keepLatestUrl&&!this._keepLatestQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._keepLatestUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(b){a.reject(b)}).always(function(){this._keepLatestQueried=
!0}.bind(this)):a.resolve();return a.promise},_getRelatedFeatures:function(){var a=new m;this._map&&this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive?this._mode._fetchArchive(this._relatedUrl).then(function(){a.resolve()}.bind(this)).otherwise(function(b){a.reject(b)}).always(function(){this._relatedQueried=!0}.bind(this)):a.resolve();return a.promise},_purge:function(){var a,b=[],c;if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(a=0;a<this.graphics.length-
this.purgeOptions.displayCount;a++)c=this.graphics[a],b.push(c);0<b.length&&(this._mode._removeFeatures(b),this._trackManager&&this._trackManager.removeFeatures(b))},_bind:function(){var a=this;this.socket.onmessage=function(b){a._onMessage(JSON.parse(b.data))}},_onMessage:function(a){var b=this;this.onMessage(a);var c={create:function(a){b._create(a)},update:function(a){b._update(a)},"delete":function(a){b._delete(a)}};if(a.type)c[a.type](a.feature);else a.hasOwnProperty("filter")?b._handleFilterMessage(a):
this._create(a)},_create:function(a){function b(a){if(!e._featureHasOID(a,f)){if(!a.geometry)return!1;a.attributes=a.attributes||{};a.attributes[f]=e._nextId++}a=a.declaredClass?a:new c(a);e._mode.drawFeature(a)}var e=this,f=e.objectIdField;a.length?a.forEach(function(a){a&&b(a)}):a&&b(a)},_delete:function(a){var b=this,c=a[b.objectIdField]||a.attributes[b.objectIdField],e=!1;this.graphics.forEach(function(a){a.attributes[b.objectIdField]==c&&(e=a)});e&&this.remove(e)},_update:function(a){var b=this,
c=!1;this.graphics.forEach(function(e){e.attributes[b.objectIdField]==a.attributes[b.objectIdField]&&(c=e)});c&&(a.attributes&&c.setAttributes(a.attributes),a.geometry&&c.setGeometry(C.fromJson(a.geometry)))},_makeFilter:function(a){var b,c=null;a=a||{};if(void 0!==a.geometry)if(c=c||{},null===a.geometry)c.geometry=null;else{b="string"===typeof a.geometry?C.fromJson(JSON.parse(a.geometry)):a.geometry.declaredClass?a.geometry:C.fromJson(a.geometry);if(!b||"point"===b.type)throw"Query object contains invalid geometry";
"extent"!==b.type&&(b=b.getExtent());if(!b||0===b.getHeight()&&0===b.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";c.spatialRel="esriSpatialRelIntersects";c.geometryType="esriGeometryEnvelope";c.geometry=b.toJson()}void 0!==a.where&&(c=c||{},c.where=a.where);if(void 0!==a.outFields&&(c=c||{},a="string"===typeof a.outFields?"*"===a.outFields?null:a.outFields.replace(/,\s+/g,",").split(","):null===a.outFields?null:a.outFields,a=this._makeOutFields(a))){if(a.errors&&
0<a.errors.length)throw"Invalid filter outFields. "+a.errors.join(",");c.outFields=a.fields?a.fields.join(","):null}return c},_makeOutFields:function(a){var b=this,c=[],e=[],f={fields:null};if(!a||0===a.length)return f;t.forEach(a,function(a){if("*"===a)return f;var g=b._getField(a,!0);g?c.push(g.name):e.push("Field named "+a+" not found in schema.")});a=b._getOutFields();t.forEach(a,function(a){b._getField(a)&&-1===t.indexOf(c,a)&&c.push(a)});f.fields=c;f.errors=e;return f},_handleFilterMessage:function(a){a.error?
(a=Error(a.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:a})):(a=a.filter,a.geometry&&"string"===typeof a.geometry&&(a.geometry=JSON.parse(a.geometry)),this._filter=a,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(a){var b={urls:[]},c,e=[],f=[],g,k,m;a.streamUrls&&t.forEach(a.streamUrls,function(a){"ws"===a.transport&&(c=a.urls,b.token=a.token)});if(!c)return b;t.forEach(c,function(a){0===a.lastIndexOf("wss",0)?f.push(a):e.push(a)});a="https:"===
location.protocol||0===this.url.lastIndexOf("https:",0)?f:0===e.length?f:e;if(1<a.length)for(g=0;g<a.length-1;g++)k=g+Math.floor(Math.random()*(a.length-g)),m=a[k],a[k]=a[g],a[g]=m;b.urls=a;return b},_attemptReconnect:function(){var a=this,b;this._reconnectTimeoutId=null;a._connected=!1;if(!a._socketUrls)return!1;if(!a._collection&&!a._reconnecting&&a.socket&&a.credential)return a._reconnecting=!0,a._getServiceConnectionMetadata(a._attemptReconnect),!1;a._reconnecting=!0;a.socket=null;if(a._reconnectAttempts>
a.maxReconnectAttempts)return a._reconnecting=!1;a.socketUrl=a._socketUrls[a._reconnectAttempts>a._socketUrls.length-1?a._reconnectAttempts%a._socketUrls.length:a._reconnectAttempts];a.socketUrl+="/"+a.socketDirection;b=a._randomIntFromInterval(0,1E3);this._reconnectTimeoutId=setTimeout(function(){a.onAttemptReconnect({count:a._reconnectAttempts,url:a.socketUrl});a.connect()},1E3*a._reconnectAttempts+b)},_getServiceConnectionMetadata:function(b){var c=this,e=c._url.path;b="function"===typeof b?b:
null;a({url:e,content:n.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(a){a=c._getWebsocketConnectionInfo(a);c._websocketToken=a.token;b&&b()},function(a){c.onError(Error(a))})},_setDefaultRenderer:function(){var a=this.geometryType,b=new v([5,112,176,.8]),c=new v([255,255,255]),c=new E(E.STYLE_SOLID,c,1),e;if("esriGeometryPoint"===a||"esriGeometryMultipoint"===a)e=new B(B.STYLE_CIRCLE,10,c,b);else if("esriGeometryPolyline"===a)e=new E(E.STYLE_SOLID,b,2);else if("esriGeometryPolygon"===
a||"esriGeometryEnvelope"===a)b=new v([5,112,176,.2]),c=new v([5,112,176,.8]),c=new E(E.STYLE_SOLID,c,1),e=new z(z.STYLE_SOLID,c,b);e&&this.setRenderer(new G(e))},_makeObjectIdField:function(){var a=1,b,c,e=[];if(!this.objectIdField){b=this.fields.length;for(c=0;c<b;c++)e.push(this.fields[c].name.toLowerCase());for(;-1!==t.indexOf(e,"objectid_"+a);)a+=1;this.objectIdField="objectid_"+a;this.fields.push({name:"objectid_"+a,type:"esriFieldTypeOID",alias:"objectid_"+a,nullable:!1})}},_featureHasOID:function(a,
b){return a.attributes&&(a.attributes[b]||0===a.attributes[b])},_randomIntFromInterval:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)}})})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Point ../geometry/Polyline ./TrackManager".split(" "),function(p,g,t,v,n,m,u,k,f){return p([f],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(e){this.inherited(arguments);var b=e.getMap().spatialReference;
this.isWebMercator=b.isWebMercator();this.canWrap=b._isWrappable();this.wrapThreshold=this.isWebMercator?2.0037508342788905E7:180},initialize:function(e){this.inherited(arguments)},addFeatures:function(e,b){function a(a,b){var e,f,g;c[a]||(c[a]=[]);a=c[a];0<k&&(b.length>k&&b.splice(0,b.length-k),f=b.length+a.length,f>k&&(e=a.splice(0,f-k)));f=b.length;for(g=0;g<f;g+=1)a.push(b[g]);return{deletes:e,adds:b}}var c,f,g,k,m={},n={},p;if(b)return this.inherited(arguments),m;c=this.trackMap;f=this.layer;
g=f._trackIdField;k=f.maximumTrackPoints||0;t.forEach(e,function(a){var b=a.attributes[g];a.visible&&(n[b]||(n[b]=[]),n[b].push(a))});for(p in n)n.hasOwnProperty(p)&&(f=a(p,n[p]),m[p]=f);return m},removeFeatures:function(e){var b=[],a=this.layer.objectIdField,c=this.layer._trackIdField;e&&(t.forEach(e,function(e){var f,g,k,m;g=e.attributes[c];f=e.attributes[a];if(k=this.trackMap[g])for(e=0;e<k.length;e+=1)if(m=k[e],m.attributes[a]===f){this.trackMap[g].splice(e,1);-1===t.indexOf(g)&&b.push(g);break}},
this),0<e.length&&this.refreshTracks(b))},drawTracks:function(e){function b(b){var e=f[b],q=e&&1<e.length,p=a.trackLineMap[b];p&&!q&&(c.remove(p),delete a.trackLineMap[b],p=null);if(!q)return!1;for(var w,q=[],x=[],t,v=e.length,z=0;z<v;z++)if(t=e[z].geometry){t=t.normalize();var C=t.x,M=0,Q=!1;w&&a.canWrap&&(M=C-w.x,Math.abs(M)>a.wrapThreshold&&(Q=!0));Q?(x.push([a.getWrappedX(C),t.y]),q.push(x.slice(0)),x=[[C,t.y]]):x.push([C,t.y]);w=new u(C,t.y,g)}1<x.length&&q.push(x);e={};e[n]=b;if(q.length)if(p){for(var S=
p.geometry;S.paths.length;)S.removePath(S.paths.length-1);q.forEach(function(a){S.addPath(a)});p.setGeometry(S)}else p=new m(new k({paths:q,spatialReference:g}),null,e),c.add(p),a.trackLineMap[b]=p}var a=this,c=this.container,f,g,n,p;if(c)if(f=this.trackMap,g=this.map.spatialReference,n=this.layer._trackIdField,e)t.forEach(e,function(a){b(a)});else for(p in f)f.hasOwnProperty(p)&&b(p)},refreshTracks:function(e){function b(b){var e,f;b=a[b]||[];e=b.length;for(f=0;f<e;f++)c._repaint(b[f],null,!0)}var a=
this.trackMap,c=this.layer,f;this.drawTracks(e);if(e)t.forEach(e,function(a){b(a)});else for(f in a)a.hasOwnProperty(f)&&b(f)},getLatestObservations:function(){var e,b,a=this.trackMap,c=[];for(e in a)a.hasOwnProperty(e)&&(b=a[e],c.push(b[b.length-1]));return c},destroy:function(){this.inherited(arguments);this.trackLineMap=null},getWrappedX:function(e){var b=this.isWebMercator,a=b?2.0037508342788905E7:180,b=b?-2.0037508342788905E7:-180;return(0<e?b:a)-((0<e?a:b)-e)}})})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/Stateful","dojo/has","../kernel"],function(p,g,t,v,n){return p([t],{declaredClass:"esri.layers.PurgeOptions",constructor:function(g,n){this.parent=g;for(var k in n)this[k]=n[k]},_displayCountSetter:function(g){this.displayCount=g;this.parent.refresh()}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(p,g,t,v,n,m,u){return p([m,
u],{declaredClass:"esri.layers.ArcGISImageServiceLayer",constructor:function(g,f){this._initialize(g,f);this.useMapImage=f&&f.useMapImage||!1},refresh:function(g){if(g)this.inherited(arguments);else{var f=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=f}},setRenderer:function(g,f){this.renderer=g;this.onRendererChange();f||this.refresh(!0)},exportMapImage:function(k,f){var e=n.defaults.map;k=g.mixin({size:e.width+","+e.height},this._params,
k?k.toJson(this.normalization):{},{f:"json"});delete k._ts;this._exportMapImage(this._url.path+"/exportImage",k,f)}})})},"esri/layers/DynamicMapServiceLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../sniff ../request ../domUtils ./layer ./MapImage".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){var x=k.defaults.map.zoomDuration;return p(a,{declaredClass:"esri.layers.DynamicMapServiceLayer",_eventMap:{"map-image-export":["mapImage"]},
constructor:function(a,b){this.useMapTime=b&&b.hasOwnProperty("useMapTime")?!!b.useMapTime:!0;this.extentProcessor=b&&b.extentProcessor;a=t.hitch;this._exportMapImageHandler=a(this,this._exportMapImageHandler);this._imgSrcFunc=a(this,this._imgSrcFunc);this._divAlphaImageFunc=a(this,this._divAlphaImageFunc);this._tileLoadHandler=a(this,this._tileLoadHandler);this._tileErrorHandler=a(this,this._tileErrorHandler);this.registerConnectEvents()},opacity:1,isPNG32:!1,_setMap:function(a,b,c){this.inherited(arguments);
this._map=a;var e=this._div=v.create("div",null,b),k=u._css.names,m={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible",opacity:this.opacity},q=f("ie"),p=g.connect,w=a.__visibleDelta;8===q&&delete m.opacity;"css-transforms"===a.navigationMode?(this._isChildLayer||(m[k.transform]=u._css.translate(w.x,w.y),n.set(e,m)),this._left=w.x,this._top=w.y):(m.left="0px",m.top="0px",n.set(e,m),this._left=this._top=0);n.set(e,m);this._onResizeHandler_connect=p(a,"onResize",this,"_onResizeHandler");
this._opacityChangeHandler_connect=p(this,"onOpacityChange",this,"_opacityChangeHandler");this._img_loading=null;this._dragOrigin={x:0,y:0};this.evaluateSuspension();if(this.suspended&&!a.loaded)var x=g.connect(a,"onLoad",this,function(){g.disconnect(x);x=null;this.evaluateSuspension()});this.extentProcessor&&(this._panEndEvalHandle=g.connect(a,"onPanEnd",this,this.evaluateSuspension),this._zoomEndEvalHandle=g.connect(a,"onZoomEnd",this,this.evaluateSuspension));return e},_unsetMap:function(a,b){this._img&&
this._clearEventListeners(this._img);this._img_loading&&this._clearEventListeners(this._img_loading);v.destroy(this._div);this._map=this._div=this._img=this._img_loading=null;var c=g.disconnect;c(this._onResizeHandler_connect);c(this._opacityChangeHandler_connect);c(this._panEndEvalHandle);c(this._zoomEndEvalHandle);this._panEndEvalHandle=this._zoomEndEvalHandle=this._onResizeHandler_connect=this._opacityChangeHandler_connect=null;this._fireUpdateEnd();this._toggleTime();clearTimeout(this._wakeTimer);
this._wakeTimer=null;this._disableDrawConnectors();this.inherited(arguments)},_onResizeHandler:function(a,b,c){n.set(this._div,{width:b+"px",height:c+"px"});this._onExtentChangeHandler(a)},onSuspend:function(){this.inherited(arguments);this._fireUpdateEnd();this._toggleTime();b.hide(this._div);clearTimeout(this._wakeTimer);this._wakeTimer=null;this._disableDrawConnectors()},onResume:function(){this.inherited(arguments);var a=this._map;this._toggleTime();"css-transforms"===a.navigationMode&&(a=a.__visibleDelta,
this._left=a.x,this._top=a.y,this._isChildLayer||n.set(this._div,u._css.names.transform,u._css.translate(this._left,this._top)));this._enableDrawConnectors();this._wakeTimer=this._wakeTimer||setTimeout(t.hitch(this,function(){this.suspended||this._onExtentChangeHandler(this._map.extent,null,!0)}),0)},canResume:function(){var a=this.inherited(arguments);if(a){var b=this._map.extent;this.extentProcessor&&b&&(a=!!this.extentProcessor({layer:this,extent:b,width:this._map.width}).extent)}return a},_enableDrawConnectors:function(){var a=
g.connect,b=this._map;b&&(this._onPanHandler_connect=a(b,"onPan",this,"_onPanHandler"),this._onExtentChangeHandler_connect=a(b,"onExtentChange",this,"_onExtentChangeHandler"),"css-transforms"===b.navigationMode?this._onScaleHandler_connect=a(b,"onScale",this,this._onScaleHandler):this._onZoomHandler_connect=a(b,"onZoom",this,"_onZoomHandler"))},_disableDrawConnectors:function(){var a=g.disconnect;a(this._onPanHandler_connect);a(this._onExtentChangeHandler_connect);a(this._onZoomHandler_connect);a(this._onScaleHandler_connect);
this._onPanHandler_connect=this._onExtentChangeHandler_connect=this._onZoomHandler_connect=this._onScaleHandler_connect=null},_toggleTime:function(){var a=this._map;this.timeInfo&&this.useMapTime&&a&&!this.suspended?(this._timeConnect||(this._timeConnect=g.connect(a,"onTimeExtentChange",this,this._onTimeExtentChangeHandler)),this._setTime(a.timeExtent)):(g.disconnect(this._timeConnect),this._timeConnect=null,this._setTime(null))},_setTime:function(a){this._params&&(this._params.time=a?a.toJson().join(","):
null)},_onPanHandler:function(a,b){this._panDx=b.x;this._panDy=b.y;a=this._dragOrigin;var c=this._map.__visibleDelta,e=this._img;e&&("css-transforms"===this._map.navigationMode?(this._left=c.x+b.x,this._top=c.y+b.y,this._isChildLayer||n.set(this._div,u._css.names.transform,u._css.translate(this._left,this._top))):n.set(e,{left:a.x+b.x+"px",top:a.y+b.y+"px"}))},_onExtentChangeHandler:function(a,b,c){if(!this.suspended){clearTimeout(this._wakeTimer);this._wakeTimer=null;var e=this._map,k=this._img,
q=k&&k.style,p=this._dragOrigin;!b||c||!k||b.x===this._panDx&&b.y===this._panDy||("css-transforms"===e.navigationMode?(b=e.__visibleDelta,this._left=b.x,this._top=b.y,this._isChildLayer||n.set(this._div,u._css.names.transform,u._css.translate(this._left,this._top))):n.set(k,{left:p.x+b.x+"px",top:p.y+b.y+"px"}));k?(p.x=parseInt(q.left,10),p.y=parseInt(q.top,10)):p.x=p.y=0;"css-transforms"===e.navigationMode&&c&&k&&(n.set(k,u._css.names.transition,"none"),k._multiply=k._multiply?m.multiply(k._matrix,
k._multiply):k._matrix);this._fireUpdateStart();if(c=this._img_loading)if(this._clearEventListeners(c),v.destroy(c),this._img_loading=null,c=this._jsonRequest){try{c.cancel()}catch(M){}this._jsonRequest=null}var w=e.width;c=e.height;b=w;var t=0;10<=this.version&&e.wrapAround180&&(a=a._normalize(!0));this.extentProcessor&&(t=this.extentProcessor({layer:this,extent:a,width:b}),a=t.extent,b=t.width,t=t.marginLeft||0);if(this.isPNG32)k=this._img_loading=v.create("div"),k.id=e.id+"_"+this.id+"_"+(new Date).getTime(),
n.set(k,{position:"absolute",left:"0px",top:"0px",width:b+"px",height:c+"px"}),e=k.appendChild(v.create("div")),n.set(e,{opacity:0,width:b+"px",height:c+"px"}),this.getImageUrl(a,b,c,this._divAlphaImageFunc),k=null;else{var C=this._img_loading=v.create("img"),K=u._css.names,J=f("ie"),L={position:"absolute",width:b+"px",height:c+"px"};C.setAttribute("decoding","sync");8===J&&(L.opacity=this.opacity);null!=t&&0!==t&&(L.marginLeft=t+"px");"css-transforms"===e.navigationMode?(L[K.transform]=u._css.translate(-this._left,
-this._top),C._tdx=-this._left,C._tdy=-this._top,L[K.transition]=K.transformName+" "+x+"ms ease",this.extentProcessor&&(L[K.origin]=w/2-t+"px "+c/2+"px")):(L.left="0px",L.top="0px");C.id=e.id+"_"+this.id+"_"+(new Date).getTime();n.set(C,L);C._onload_connect=g.connect(C,"onload",this,"_onLoadHandler");C._onerror_connect=g.connect(C,"onerror",this,"_onErrorHandler");C._onabort_connect=g.connect(C,"onabort",this,"_onErrorHandler");this._startRect={left:p.x,top:p.y,width:k?parseInt(q.width,10):b,height:k?
parseInt(q.height,10):c,marginLeft:k?parseInt(q.marginLeft||"0",10):t,zoom:q&&q.zoom?parseFloat(q.zoom):1};this.getImageUrl(a,b,c,this._imgSrcFunc);C=null}}},_onTimeExtentChangeHandler:function(a){this.suspended||(this._setTime(a),this.refresh(!0))},getImageUrl:function(a,b,c,e){},_imgSrcFunc:function(a){this._img_loading.src=a},_divAlphaImageFunc:function(a){n.set(this._img_loading,"filter","progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+a+"', sizingMethod\x3d'scale')");this._onLoadHandler({currentTarget:this._img_loading})},
_onLoadHandler:function(a){a=a.currentTarget;var c=this._map;this._clearEventListeners(a);!c||c.__panning||c.__zooming?v.destroy(a):(this._img&&this._div.removeChild(this._img),this._img=a,c=a.style,this._startRect={left:0,top:0,width:parseInt(c.width,10),height:parseInt(c.height,10),marginLeft:parseInt(c.marginLeft||"0",10),zoom:1},this._div.appendChild(a),this.suspended||b.show(this._div),this._img_loading=null,a=this._dragOrigin,a.x=a.y=0,this.onUpdate());this._fireUpdateEnd()},_onErrorHandler:function(a){a=
a.currentTarget;n.set(a,"visibility","hidden");this._clearEventListeners(a);a=Error("Unable to load image: "+a.src);this.onError(a);this._fireUpdateEnd(a)},_clearEventListeners:function(a){g.disconnect(a._onload_connect);g.disconnect(a._onerror_connect);g.disconnect(a._onabort_connect);a._onload_connect=a._onerror_connect=a._onabort_connect=null},setUseMapTime:function(a,b){this.useMapTime=a;this._toggleTime();b||this.refresh(!0)},refresh:function(){this._map&&this._onExtentChangeHandler(this._map.extent)},
_onScaleHandler:function(a,b){var c={},e=u._css.names,f=this._img;if(f){n.set(f,e.transition,b?"none":e.transformName+" "+x+"ms ease");f._matrix=a;a=f._multiply?m.multiply(a,f._multiply):a;if(f._tdx||f._tdy)a=m.multiply(a,{xx:1,xy:0,yx:0,yy:1,dx:f._tdx,dy:f._tdy});c[e.transform]=u._css.matrix(a);n.set(f,c)}},_onZoomHandler:function(a,b,c){a=this._startRect;var e=a.width*b,g=a.height*b,k=a.marginLeft*b,m=this._img,q=f("ie");m&&(q&&8>q?n.set(m,{left:a.left-(e-a.width)*(c.x-a.left)/a.width+"px",top:a.top-
(g-a.height)*(c.y-a.top)/a.height+"px",zoom:b*a.zoom}):n.set(m,{left:a.left-(e-a.width)*(c.x-a.left)/a.width+"px",top:a.top-(g-a.height)*(c.y-a.top)/a.height+"px",width:e+"px",height:g+"px"}),null!=k&&0!==k&&n.set(m,{marginLeft:k+"px"}))},_exportMapImage:function(a,b,c){var f=this._exportMapImageHandler;b.token=this._getToken();e({url:a,content:b,callbackParamName:"callback",load:function(a,b){f(a,b,c)},error:k.defaults.io.errorHandler})},_exportMapImageHandler:function(a,b,e){a=new c(a);this.onMapImageExport(a);
e&&e(a)},onMapImageExport:function(){},setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_opacityChangeHandler:function(a){var b=8===f("ie")?this._img:this._div;n.set(b,"opacity",a)}})})},"esri/layers/ArcGISImageServiceVectorLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return p([k,f],{declaredClass:"esri.layers.ArcGISImageServiceVectorLayer",constructor:function(a,b){this.symbolTileSize=b&&b.symbolTileSize?b.symbolTileSize:50;this._maxMag=this._minMag=null;var c=g.clone(this._params);delete c.imageServiceParameters;delete c.pixelFilter;delete c.rendererStyle;delete c.symbolTileSize;this._initialize(a,b);this.renderer||this.setVectorRendererStyle(b&&b.rendererStyle?b.rendererStyle:e.STYLE_SINGLE_ARROW);this.geometryType="esriGeometryPoint";
this.symbolTileSizeUnits="Pixels";g.mixin(this._params,c)},getField:function(a){return this._getField(a,!0)},setVectorRendererStyle:function(a){this.rendererStyle=a;this._updateVectorFieldRenderer();this.useDefaultRenderer=!0},setRenderer:function(){this.useDefaultRenderer=!1;this.inherited(arguments)},getFlowRepresentation:function(){return this._vectorFlowRepresentation},onResume:function(){this.inherited(arguments);this._toggleTime()},onSuspend:function(){this.inherited(arguments);this._toggleTime()},
_refresh:function(a){if(10>n("ie"))this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));else if(this._map){this.setImageFormat("LERC",!0);a=this.fullExtent&&this.fullExtent.xmin;var b=this.fullExtent&&this.fullExtent.ymax,c=g.clone(this._map.extent),e=1/this.symbolTileSize*this._map.width,e=e?Math.ceil(e):50,f=1/this.symbolTileSize*this._map.height,f=f?Math.ceil(f):Math.ceil((c.ymax-c.ymin)/(c.xmax-c.xmin)*e),k=(c.xmax-c.xmin)/e,m=(c.ymax-c.ymin)/f;c.xmin=
a+Math.floor((c.xmin-a)/k)*k;c.xmax=a+Math.ceil((c.xmax-a)/k)*k;c.ymin=b+Math.floor((c.ymin-b)/m)*m;c.ymax=b+Math.ceil((c.ymax-b)/m)*m;this._requestData(c,e,f)}},_drawPixelData:function(){this.clear();if(this.pixelData){var e=this.pixelData.pixelBlock,f=this.pixelData.extent,g=this.pixelData.locations,k=u.isDefined(e.mask)&&0<e.mask.length;if(e&&f&&g){if(this.useDefaultRenderer&&this.renderer&&(!u.isDefined(this._minMag)||!u.isDefined(this._maxMag))){var m=this._getServiceMinMaxStats();m?(this._minMag=
m.min,this._maxMag=m.max):(this._minMag=e.statistics[0].minValue,this._maxMag=e.statistics[0].maxValue);var m={type:"sizeInfo",minSize:x.px2pt(.2*this.symbolTileSize),maxSize:x.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},n=[];n.push(m);n.push({type:"colorInfo"});this.renderer.setVisualVariables(n)}for(var p=n=m=0,t,D=f.spatialReference?f.spatialReference._getInfo():null,m=0;m<e.height;m++)for(n=0;n<e.width;n++,p++)if(t=g[p],(!k||e.mask[p])&&t&&2===t.length){t=
new b(t[0],t[1],f.spatialReference);D&&(t.x=a.prototype._normalizeX(t.x,D).x);var I={Magnitude:e.pixels[0][p],Direction:e.pixels[1][p],Location:v.toJson(t.toJson())};t=new c(t,null,I);this.add(t)}}}},_getServiceMinMaxStats:function(){if(!u.isDefined(this.minValues)||!u.isDefined(this.maxValues)||2>this.minValues.length||2>this.maxValues.length)return null;var a=this.minValues[0],b=this.maxValues[0],c=this.minValues[1],e=this.maxValues[1];if(this.pixelFilter&&a&&b&&c&&e){var f=[];f.push([a,b]);f.push([c,
e]);c=this._createPixelData(f);this.pixelFilter(c);c&&c.pixelBlock&&c.pixelBlock.pixels&&0<c.pixelBlock.pixels.length&&(a=c.pixelBlock.pixels[0][0],b=c.pixelBlock.pixels[0][1])}return a&&b?{min:a,max:b}:null},_updateVectorFieldRenderer:function(){var a={type:"sizeInfo",minSize:x.px2pt(.2*this.symbolTileSize),maxSize:x.px2pt(.8*this.symbolTileSize),minDataValue:this._minMag,maxDataValue:this._maxMag},b=[];b.push(a);a=new e({style:this.rendererStyle,visualVariables:b,flowRepresentation:this._vectorFlowRepresentation});
this.setRenderer(a)},_getField:function(a,b){if(u.isDefined(a))return b&&(a=a.toLowerCase()),"magnitude"!==a&&"direction"!==a?null:{name:a,alias:a,domain:null,editable:!1,length:50,type:"esriFieldTypeDouble"}},_requestDataErrorHandler:function(a){"CancelError"!==a.name&&(this.clear(),this.onError(a))},_setFlowRepresentation:function(a){a&&this.renderer&&u.isDefined(a.FlowDirection)&&(this._vectorFlowRepresentation="oceanographic"===a.FlowDirection.toLowerCase()?this.renderer.FLOW_TO:this.renderer.FLOW_FROM);
this.renderer&&(this.renderer.flowRepresentation=this._vectorFlowRepresentation)}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define(["dojo/_base/declare","./LayerInfoForDefaultService"],function(p,g){return p(g,{constructor:function(g,p){this.isTiled=!0},_initVisible:function(){},_setTopLayerVisible:function(g){},setLayerVisiblefromTopLayer:function(){},getOpacity:function(){},setOpacity:function(g){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},
"jimu/LayerInfos/LayerInfoForDefaultTable":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/aspect ./LayerInfoForDefault ./LayerObjectFacory esri/dijit/PopupTemplate".split(" "),function(p,g,t,v,n,m,u,k){return p(m,{_layerObjectFacory:null,constructor:function(){this.newSubLayers=[];this.isTable=!0;this._layerObjectFacory=new u(this)},init:function(){},_getLayerObject:function(){var f=new v;this._layerObjectFacory.getLayerObject().then(g.hitch(this,function(e){this.layerObject.empty&&
e&&(this.layerObject=e,this._bindEventAfterLayerObjectLoaded());f.resolve(e)}));return f},getLayerObject:function(){return this._getLayerObject()},getPopupInfoFromLayerObject:function(){var f=this.getPopupInfo();f||!this.layerObject||this.layerObject.empty||(f=this._getDefaultPopupInfo(this.layerObject));return f},loadPopupInfo:function(){var f=new v,e=this.getPopupInfo();e?f.resolve(e):this.getLayerObject().then(g.hitch(this,function(){e=this._getDefaultPopupInfo(this.layerObject);f.resolve(e)}));
return f},getLayerType:function(){var f=new v;f.resolve("Table");return f},isVisible:function(){return!1},isLeaf:function(){return!0},isRootLayer:function(){return!1},createLegendsNode:function(){return t.create("div",{"class":"legends-div"})},_initControlPopup:function(){this.inherited(arguments);this.controlPopupInfo={enablePopup:this.originOperLayer.popupInfo?!0:!1,infoTemplate:this.originOperLayer.popupInfo?new k(this.originOperLayer.popupInfo):null}},_bindEventAfterLayerObjectLoaded:function(){var f=
n.after(this.layerObject,"setDefinitionExpression",g.hitch(this,this._onFilterChanged));this._eventHandles.push(f)},getFilter:function(){var f;this.layerObject&&!this.layerObject.empty&&this.layerObject.getDefinitionExpression?(f=this.layerObject.getDefinitionExpression(),void 0===f&&(f=this.getFilterOfWebmap())):f=this.getFilterOfWebmap();return f}})})},"jimu/LayerInfos/LayerInfoForDefaultImage":function(){define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/aspect esri/request ./LayerInfoForDefault".split(" "),
function(p,g,t,v,n,m,u,k,f){return p(f,{constructor:function(){this._addImageServiceLayerType()},_addImageServiceLayerType:function(){this.layerObject.type=!this.layerObject.serviceDataType||"esriImageServiceDataTypeVector-UV"!==this.layerObject.serviceDataType&&"esriImageServiceDataTypeVector-MagDir"!==this.layerObject.serviceDataType?"ArcGISImageServiceLayer":"ArcGISImageServiceVectorLayer"},_initLegendsNode:function(e){10.2<=this.layerObject.version?this._legendRequestServer().then(v.hitch(this,
function(b){g.empty(e);t.forEach(b.layers,function(a){t.forEach(a.legend,function(a){if("\x3call other values\x3e"!==a.label){var b=g.create("div",{"class":"legend-div"},e),c=g.create("div",{"class":"legend-symbol jimu-float-leading",style:"width:50px;height:50px;position:relative"},b),f=null,f=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;g.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:f},c);g.create("div",
{"class":"legend-label jimu-float-leading",innerHTML:a.label||" "},b)}},this)},this)}),v.hitch(this,function(){g.empty(e)})):g.empty(e)},_legendRequestServer:function(){var e=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.bandIds&&(b.bandIds=this.layerObject._params.bandIds);this.layerObject._params.renderingRule&&(b.renderingRule=this.layerObject._params.renderingRule);return k({url:e,content:b,handleAs:"json",callbackParamName:"callback"})},getSupportTableInfo:function(){var e=
new n,b={isSupportedLayer:!1,isSupportQuery:!1,layerType:null},a=this.getLayerType(),c=this.getLayerObject();m({type:a,layerObject:c}).then(v.hitch(this,function(a){var c=a.type;a=a.layerObject;b.layerType=c;0<=this._getLayerTypesOfSupportTable().indexOf(c)&&(b.isSupportedLayer=!0);a.capabilities&&0<=a.capabilities.indexOf("Catalog")?b.isSupportQuery=!0:b.isSupportedLayer=!1;e.resolve(b)}),function(){e.resolve(b)});return e},_getServiceDefinition:function(){var e=this.getUrl();return this._serviceDefinitionBuffer.getRequest(this.subId).request(e)},
_bindEvent:function(){var e;this.inherited(arguments);this.layerObject&&!this.layerObject.empty&&(e=u.after(this.layerObject,"setRenderingRule",v.hitch(this,this._onRendererChanged)),this._eventHandles.push(e))}})})},"jimu/LayerInfos/LayerInfoForDefaultStream":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","dojo/promise/all","./LayerInfoForDefault"],function(p,g,t,v,n){return p(n,{getSupportTableInfo:function(){var m=new t,n={isSupportedLayer:!1,isSupportQuery:!0,layerType:null,
otherReasonCanNotSupport:!0},k=this.getLayerType(),f=this.getLayerObject();v({type:k,layerObject:f}).then(g.hitch(this,function(e){var b=e.type;e=e.layerObject;n.layerType=b;0<=this._getLayerTypesOfSupportTable().indexOf(b)&&(n.isSupportedLayer=!0);(b=e.getLatestObservations())&&0<b.length&&(n.otherReasonCanNotSupport=!1);m.resolve(n)}),function(){m.resolve(n)});return m}})})},"jimu/LayerInfos/LayerInfoForDefaultKML":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/dom-construct",
"./LayerInfoForDefault"],function(p,g,t,v){return p(v,{constructor:function(g,m){this.layerObject=g.layerObject},_resetLayerObjectVisiblity:function(){},_initVisible:function(){var g=this.originOperLayer.kml,m=g.layerInfo.originOperLayer.visibleFolders;g.layerInfo.isRootLayer()&&m?-1<m.indexOf(this.subId)?this._visible=!0:this._visible=!1:this._visible=this.originOperLayer.kml.currentFolder.visible},_setTopLayerVisible:function(g){var m=this.originOperLayer.kml.currentFolder;this._visible=g;this.originOperLayer.kml.layerInfo.layerObject.setFolderVisibility(m,
g)},obtainNewSubLayers:function(){var n=[],m=this.originOperLayer.kml;m.currentFolder&&g.forEach(m.layerInfo._getOperLayerByParentFolderId(m.currentFolder.id,this),function(g){g=this._layerInfoFactory.create(g);n.push(g);g.init()},this);return n},getOpacity:function(){},setOpacity:function(g){},drawLegends:function(g){t.empty(g)},_bindEvent:function(){},_onVisibleLayersChanged:function(){},getScaleRange:function(){return this.getRootLayerInfo().getScaleRange()}})})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale dojo/number esri/lang dojo/data/ItemFileWriteStore jimu/utils moment/moment".split(" "),
function(p,g,t,v,n,m,u,k,f){var e=p([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,MinuteInMS:59E3,SecInMS:1E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=function(b){return 0===this.indexOf(b)};String.prototype.endsWith=function(b){return this.substring(this.length-
b.length)===b};String.prototype.count=function(b){return this.split(b).length-1};String.prototype.trim||(String.prototype.trim=g.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",
stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsAnyOf:"stringOperatorIsAnyOf",stringOperatorIsNoneOf:"stringOperatorIsNoneOf",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",numberOperatorIsAtMost:"numberOperatorIsAtMost",
numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsAnyOf:"numberOperatorIsAnyOf",numberOperatorIsNoneOf:"numberOperatorIsNoneOf",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",
dateOperatorIsOnOrBefore:"dateOperatorIsOnOrBefore",dateOperatorIsOnOrAfter:"dateOperatorIsOnOrAfter",dateOperatorIsBetween:"dateOperatorIsBetween",dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast",dateOperatorIsIn:"dateOperatorIsIn",dateOperatorIsNotIn:"dateOperatorIsNotIn",dateOperatorMinutes:"dateOperatorMinutes",
dateOperatorHours:"dateOperatorHours",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorYears:"dateOperatorYears"},prepare:function(b,a){this.isHosted=k.isHostedService(b);a=a||[];this.setFieldsStoreByFieldInfos(a)},isPartsObjHasError:function(b){var a=!1;b&&(a=b.parts&&0<=b.parts.length?t.every(b.parts,g.hitch(this,function(a){return a.parts?0<a.parts.length?t.every(a.parts,g.hitch(this,function(a){return!a.error})):!1:!a.error})):
!1);return!a},isAskForValues:function(b){return e.isAskForValues(b)},hasVirtualDate:function(b){return e.hasVirtualDate(b)},setFieldsStoreByFieldInfos:function(b){b=t.filter(b,g.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)}));b=t.map(b,function(a,b){var c;switch(a.type){case "esriFieldTypeString":c="string";break;case "esriFieldTypeDate":c="date";break;default:c="number"}return{id:b,label:a.name,shortType:c,alias:a.alias,editable:a.editable,name:a.name,nullable:a.nullable,
type:a.type}},this);this.fieldsStore=new u({data:{identifier:"id",label:"label",items:b}});return b.length},_validatePartsObj:function(b){return b&&"object"===typeof b},_isObject:function(b){return b&&"object"===typeof b},_isString:function(b){return b&&"string"===typeof b},containsNonLatinCharacter:function(b){for(var a=0;a<b.length;a++)if(255<b.charCodeAt(a))return!0;return!1},containsNonLatinCharacterBatch:function(b){for(var a=!1,c=0;c<b.length;c++){var e=b[c],e=g.isObject(e)?e.value:e;a||(a=
this.containsNonLatinCharacter(e))}return a},getExprByFilterObj:function(b){if(!t.every(b.parts,function(a){return!!a}))return null;if(!this.isPartsObjReadyToBuild(b))return b.expr="",b.displaySQL="",b.expr;this._handleVirtualDate(b);var a="",c="",e,f;if(0===b.parts.length)c=a="1\x3d1";else if(1===b.parts.length)e=b.parts[0],e.valueObj&&g.isArray(e.valueObj.value)&&"multiple"!==e.valueObj.type?(f=this._checkIfValObjArrayAndChecked(e.valueObj.value))?(a=this.builtFilterString(e),c=e.displaySQL):c=
a="1\x3d1":(a=this.builtFilterString(e),c=e.displaySQL);else for(var k="",n=0;n<b.parts.length;n++){e=b.parts[n];e.valueObj&&g.isArray(e.valueObj.value)&&"multiple"!==e.valueObj.type?(f=this._checkIfValObjArrayAndChecked(e.valueObj.value))?(f=this.builtFilterString(e),e=e.displaySQL):e=f="1\x3d1":(f=this.builtFilterString(e),e=e.displaySQL);if(!m.isDefined(f))return null;a+=k+"("+f+")";c+=k+"("+e+")";k=k||" "+b.logicalOperator+" "}b.expr=a;b.displaySQL=c;return a},_checkIfValObjArrayAndChecked:function(b){var a=
!1,c;for(c in b)if(b[c].isChecked){a=!0;break}return a},_handleVirtualDate:function(b){this.hasVirtualDate(b)&&t.forEach(b.parts,g.hitch(this,function(a){a.parts?t.forEach(a.parts,g.hitch(this,function(a){this._updateRealDateByVirtualDate(a)})):this._updateRealDateByVirtualDate(a)}))},_updateRealDateByVirtualDate:function(b){var a;a=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsOnOrBefore,
this.OPERATORS.dateOperatorIsOnOrAfter];b.valueObj.virtualDate?b.operator===this.OPERATORS.dateOperatorIsIn||b.operator===this.OPERATORS.dateOperatorIsNotIn?(a=e.getRealDateByVirtualDate(b.valueObj.virtualDate),b.value1=a[0],b.value2=a[1],b.valueObj.value1=a[0].toDateString(),b.valueObj.value2=a[1].toDateString()):-1<a.indexOf(b.operator)&&(a=e.getRealDateByVirtualDate(b.valueObj.virtualDate),b.value=a,b.valueObj.value=a.toDateString()):(b.valueObj.virtualDate1&&(a=e.getRealDateByVirtualDate(b.valueObj.virtualDate1),
b.value1=a,b.valueObj.value1=a.toDateString()),b.valueObj.virtualDate2&&(a=e.getRealDateByVirtualDate(b.valueObj.virtualDate2),b.value2=a,b.valueObj.value2=a.toDateString()))},isPartsObjReadyToBuild:function(b){return t.every(b.parts,g.hitch(this,function(a){return a.parts?t.every(a.parts,g.hitch(this,function(a){return this._isPartReadyToBuild(a)})):this._isPartReadyToBuild(a)}))},_isPartReadyToBuild:function(b){var a=b.fieldObj.shortType,c=b.operator,e=b.valueObj;b=e.type||"value";var f=e.value,
g=e.value1,e=e.value2;if("value"===b){if("string"===a)return c===this.OPERATORS.stringOperatorIsBlank||c===this.OPERATORS.stringOperatorIsNotBlank?!0:k.isNotEmptyString(f);if("number"===a)return c===this.OPERATORS.numberOperatorIsBlank||c===this.OPERATORS.numberOperatorIsNotBlank?!0:c===this.OPERATORS.numberOperatorIsBetween||c===this.OPERATORS.numberOperatorIsNotBetween?k.isValidNumber(g)&&k.isValidNumber(e):k.isValidNumber(f);if("date"===a)return c===this.OPERATORS.dateOperatorIsBlank||c===this.OPERATORS.dateOperatorIsNotBlank?
!0:c===this.OPERATORS.dateOperatorIsBetween||c===this.OPERATORS.dateOperatorIsNotBetween||c===this.OPERATORS.dateOperatorIsIn||c===this.OPERATORS.dateOperatorIsNotIn?k.isNotEmptyString(g)&&k.isNotEmptyString(e):c===this.OPERATORS.dateOperatorInTheLast||c===this.OPERATORS.dateOperatorNotInTheLast?void 0!==f&&null!==f:k.isNotEmptyString(f)}else{if("field"===b)return k.isNotEmptyString(f);if("unique"===b){if("string"===a)return k.isNotEmptyString(f);if("number"===a)return k.isValidNumber(f);if("date"===
a)return k.isValidDate(f)}else if("multiple"===b){if("string"===a)return k.isNotEmptyStringArray(f);if("number"===a)return k.isValidNumberArray(f)}else if("values"!==b&&("uniquePredefined"===b||"multiplePredefined"===b)){if("string"===a)return k.isNotEmptyStringArray(f);if("number"===a)return k.isValidNumberArray(f)}}return!1},builtFilterString:function(b){var a="",c="";if(b.parts)for(var e="",f=0;f<b.parts.length;f++){var g=b.parts[f],k=this.builtSingleFilterString(g);g.expr=k.whereClause;if(!m.isDefined(k.whereClause))return null;
a+=e+k.whereClause;c+=e+g.displaySQL;e=" "+b.logicalOperator+" "}else b&&b.valueObj&&"multiple"===b.valueObj.type&&0===b.valueObj.value.length?a=c="1\x3d1":(a=this.builtSingleFilterString(b).whereClause,c=b.displaySQL);b.expr=a;b.displaySQL=c;return a},_preBuiltSingleFilterString:function(b){if("string"===b.fieldObj.shortType&&"\x3cNull\x3e"===b.valueObj.value){if(b.operator===this.OPERATORS.stringOperatorIs)return{whereClause:b.fieldObj.name+" IS NULL"};if(b.operator===this.OPERATORS.stringOperatorIsNot)return{whereClause:b.fieldObj.name+
" IS NOT NULL"}}if("number"===b.fieldObj.shortType&&"\x3cNull\x3e"===b.valueObj.value){if(b.operator===this.OPERATORS.numberOperatorIs)return{whereClause:b.fieldObj.name+" IS NULL"};if(b.operator===this.OPERATORS.numberOperatorIsNot)return{whereClause:b.fieldObj.name+" IS NOT NULL"}}return null},_handlePrefixStringsForIn:function(b,a){for(var c=[],e=0;e<a.length;e++){var f=a[e],f=f.replace(/\'/g,"''");c.push(f)}return""+b+"'"+c.join("',"+b+"'")+"'"},builtSingleFilterString:function(b,a){this.isHosted&&
(b.caseSensitive=!1);if(m.isDefined(b.valueObj.isValid)&&!b.valueObj.isValid)return{whereClause:null};var c=this._preBuiltSingleFilterString(b);if(c)return c;var e=b.valueObj.value,f=b.valueObj.value1,k=b.valueObj.value2,n=!1;b.interactiveObj&&m.isDefined(a)&&(n=!0,m.isDefined(b.valueObj.value)&&(e="{"+a+"}"),m.isDefined(b.valueObj.value1)&&(f="{"+a+"}"),m.isDefined(b.valueObj.value2)&&(k="{"+(a+1)+"}"));var p=c="",p="",u=[];if("string"===b.fieldObj.shortType){var v="";n&&this.isHosted?v="N":e&&"field"!==
b.valueObj.type&&this.isHosted&&(g.isArray(e)&&this.containsNonLatinCharacterBatch(e)||!g.isArray(e)&&this.containsNonLatinCharacter(e))&&(v="N");if(e&&"multiple"===b.valueObj.type){if(b.operator===this.OPERATORS.stringOperatorIsAnyOf||b.operator===this.OPERATORS.stringOperatorIsNoneOf)e=this._handlePrefixStringsForIn(v,e)}else!e||"multiplePredefined"!==b.valueObj.type&&"uniquePredefined"!==b.valueObj.type||(u=[],t.forEach(e,g.hitch(this,function(a){a.isChecked&&u.push(a.value)})),e=b.operator===
this.OPERATORS.stringOperatorIs||b.operator===this.OPERATORS.stringOperatorIsNot?u[0]:b.operator===this.OPERATORS.stringOperatorIsAnyOf||b.operator===this.OPERATORS.stringOperatorIsNoneOf?this._handlePrefixStringsForIn(v,u):u);var G=[];switch(b.operator){case this.OPERATORS.stringOperatorIs:"field"===b.valueObj.type?c=b.fieldObj.name+" \x3d "+e:"multiple"===b.valueObj.type?(p=e.join("','"),c=b.caseSensitive?b.fieldObj.name+" IN ("+v+"'"+p.replace(/\'/g,"'")+"')":"UPPER("+b.fieldObj.name+") IN ("+
v+"'"+p.replace(/\'/g,"'").toUpperCase()+"')"):c=b.caseSensitive?b.fieldObj.name+" \x3d "+v+"'"+e.replace(/\'/g,"''")+"'":"UPPER("+b.fieldObj.name+") \x3d "+v+"'"+e.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorIsNot:"field"===b.valueObj.type?c=b.fieldObj.name+" \x3c\x3e "+e:"multiple"===b.valueObj.type?(p=e.join("','"),c=b.caseSensitive?b.fieldObj.name+" NOT IN ("+v+"'"+p.replace(/\'/g,"'")+"')":"UPPER("+b.fieldObj.name+") NOT IN ("+v+"'"+p.replace(/\'/g,"'").toUpperCase()+
"')"):c=b.caseSensitive?b.fieldObj.name+" \x3c\x3e "+v+"'"+e.replace(/\'/g,"''")+"'":"UPPER("+b.fieldObj.name+") \x3c\x3e "+v+"'"+e.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorStartsWith:G=[];"multiple"===b.valueObj.type||"multiplePredefined"===b.valueObj.type||"uniquePredefined"===b.valueObj.type?(t.forEach(e,g.hitch(this,function(a){b.caseSensitive?G.push(b.fieldObj.name+" LIKE "+v+"'"+a.replace(/\'/g,"''")+"%'"):G.push("UPPER("+b.fieldObj.name+") LIKE "+v+"'"+
a.replace(/\'/g,"''").toUpperCase()+"%'")})),c="(("+G.join(") or (")+"))"):c=b.caseSensitive?b.fieldObj.name+" LIKE "+v+"'"+e.replace(/\'/g,"''")+"%'":"UPPER("+b.fieldObj.name+") LIKE "+v+"'"+e.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorEndsWith:G=[];"multiple"===b.valueObj.type||"multiplePredefined"===b.valueObj.type||"uniquePredefined"===b.valueObj.type?(t.forEach(e,g.hitch(this,function(a){b.caseSensitive?G.push(b.fieldObj.name+" LIKE "+v+"'%"+a.replace(/\'/g,
"''")+"'"):G.push("UPPER("+b.fieldObj.name+") LIKE "+v+"'%"+a.replace(/\'/g,"''").toUpperCase()+"'")})),c="(("+G.join(") or (")+"))"):c=b.caseSensitive?b.fieldObj.name+" LIKE "+v+"'%"+e.replace(/\'/g,"''")+"'":"UPPER("+b.fieldObj.name+") LIKE "+v+"'%"+e.replace(/\'/g,"''").toUpperCase()+"'";break;case this.OPERATORS.stringOperatorContains:G=[];"multiple"===b.valueObj.type||"multiplePredefined"===b.valueObj.type||"uniquePredefined"===b.valueObj.type?(t.forEach(e,g.hitch(this,function(a){b.caseSensitive?
G.push(b.fieldObj.name+" LIKE "+v+"'%"+a.replace(/\'/g,"''")+"%'"):G.push("UPPER("+b.fieldObj.name+") LIKE "+v+"'%"+a.replace(/\'/g,"''").toUpperCase()+"%'")})),c="(("+G.join(") or (")+"))"):c=b.caseSensitive?b.fieldObj.name+" LIKE "+v+"'%"+e.replace(/\'/g,"''")+"%'":"UPPER("+b.fieldObj.name+") LIKE "+v+"'%"+e.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorDoesNotContain:G=[];"multiple"===b.valueObj.type||"multiplePredefined"===b.valueObj.type||"uniquePredefined"===
b.valueObj.type?(t.forEach(e,g.hitch(this,function(a){b.caseSensitive?G.push(b.fieldObj.name+" NOT LIKE "+v+"'%"+a.replace(/\'/g,"''")+"%'"):G.push("UPPER("+b.fieldObj.name+") NOT LIKE "+v+"'%"+a.replace(/\'/g,"''").toUpperCase()+"%'")})),c="(("+G.join(") or (")+"))"):c=b.caseSensitive?b.fieldObj.name+" NOT LIKE "+v+"'%"+e.replace(/\'/g,"''")+"%'":"UPPER("+b.fieldObj.name+") NOT LIKE "+v+"'%"+e.replace(/\'/g,"''").toUpperCase()+"%'";break;case this.OPERATORS.stringOperatorIsAnyOf:c=b.fieldObj.name+
" IN ("+e+")";break;case this.OPERATORS.stringOperatorIsNoneOf:c=b.fieldObj.name+" NOT IN ("+e+")";break;case this.OPERATORS.stringOperatorIsBlank:c=b.fieldObj.name+" IS NULL";break;case this.OPERATORS.stringOperatorIsNotBlank:c=b.fieldObj.name+" IS NOT NULL"}}else if("number"===b.fieldObj.shortType)switch(!e||"uniquePredefined"!==b.valueObj.type&&"multiplePredefined"!==b.valueObj.type?e&&"multiple"===b.valueObj.type&&(e=e.join(",")):(u=[],t.forEach(e,g.hitch(this,function(a){a.isChecked&&u.push(a.value)})),
e=u.join(",")),b.operator){case this.OPERATORS.numberOperatorIs:c=b.fieldObj.name+" \x3d "+e;break;case this.OPERATORS.numberOperatorIsNot:c=b.fieldObj.name+" \x3c\x3e "+e;break;case this.OPERATORS.numberOperatorIsAtLeast:c=b.fieldObj.name+" \x3e\x3d "+e;break;case this.OPERATORS.numberOperatorIsLessThan:c=b.fieldObj.name+" \x3c "+e;break;case this.OPERATORS.numberOperatorIsAtMost:c=b.fieldObj.name+" \x3c\x3d "+e;break;case this.OPERATORS.numberOperatorIsGreaterThan:c=b.fieldObj.name+" \x3e "+e;break;
case this.OPERATORS.numberOperatorIsAnyOf:c=b.fieldObj.name+" IN ("+e+")";break;case this.OPERATORS.numberOperatorIsNoneOf:c=b.fieldObj.name+" NOT IN ("+e+")";break;case this.OPERATORS.numberOperatorIsBetween:c=b.fieldObj.name+" BETWEEN "+f+" AND "+k;break;case this.OPERATORS.numberOperatorIsNotBetween:c=b.fieldObj.name+" NOT BETWEEN "+f+" AND "+k;break;case this.OPERATORS.numberOperatorIsBlank:c=b.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:c=b.fieldObj.name+" IS NOT NULL"}else switch(m.isDefined(e)&&
"field"!==b.valueObj.type&&"string"===typeof e&&(e=new Date(e)),"field"!==b.valueObj.type&&(e&&(e=new Date(e)),f&&(f=new Date(f)),k&&(k=new Date(k))),b.operator){case this.OPERATORS.dateOperatorIsOn:c="field"===b.valueObj.type?b.fieldObj.name+" \x3d "+e:n?b.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+a+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(a+1)+"}'":b.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(e)+"' AND "+(this.isHosted?"":"timestamp ")+
"'"+this.formatDate(this.addDay(e))+"'";break;case this.OPERATORS.dateOperatorIsNotOn:c="field"===b.valueObj.type?b.fieldObj.name+" \x3c\x3e "+e:n?b.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+a+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(a+1)+"}'":b.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(e)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(e))+"'";break;case this.OPERATORS.dateOperatorIsBefore:c="field"===
b.valueObj.type?b.fieldObj.name+" \x3c "+e:b.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(e)+"'";break;case this.OPERATORS.dateOperatorIsAfter:c="field"===b.valueObj.type?b.fieldObj.name+" \x3e "+e:b.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(e))+"'";break;case this.OPERATORS.dateOperatorIsOnOrBefore:c="field"===b.valueObj.type?b.fieldObj.name+" \x3c\x3d "+e:b.fieldObj.name+" \x3c\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(e))+
"'";break;case this.OPERATORS.dateOperatorIsOnOrAfter:c="field"===b.valueObj.type?b.fieldObj.name+" \x3e\x3d "+e:b.fieldObj.name+" \x3e\x3d "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(e)+"'";break;case this.OPERATORS.dateOperatorInTheLast:c=b.fieldObj.name+" BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(b.valueObj.value,b.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorNotInTheLast:c=b.fieldObj.name+" NOT BETWEEN CURRENT_TIMESTAMP - "+this._convertRangeToDays(b.valueObj.value,
b.valueObj.range)+" AND CURRENT_TIMESTAMP";break;case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsIn:c=n?b.fieldObj.name+" BETWEEN '"+f+"' AND '"+k+"'":b.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(f)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(k))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:case this.OPERATORS.dateOperatorIsNotIn:c=n?b.fieldObj.name+" NOT BETWEEN '"+f+"' AND '"+k+"'":b.fieldObj.name+
" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(f)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(k))+"'";break;case this.OPERATORS.dateOperatorIsBlank:c=b.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:c=b.fieldObj.name+" IS NOT NULL"}"date"===b.fieldObj.shortType?(a=g.clone(b.valueObj),a.dateFormat=b.fieldObj.dateFormat,p=this.getDisplaySQL(b.fieldObj.name,a,b.operator)):p=c;b.displaySQL=p;return{whereClause:c}},_dateENUM:{dateOperatorIsOn:"is on ",
dateOperatorIsNotOn:"is not on ",dateOperatorIsIn:"is in ",dateOperatorIsNotIn:"is not in ",dateOperatorIsBefore:"is before ",dateOperatorIsAfter:"is after ",dateOperatorIsOnOrBefore:"is on or before ",dateOperatorIsOnOrAfter:"is on or after ",dateOperatorInTheLast:["is in the last "," from CURRENT_TIMESTAMP"],dateOperatorNotInTheLast:["is not in the last "," from CURRENT_TIMESTAMP"],dateOperatorIsBetween:["is between "," and "],dateOperatorIsNotBetween:["is not between "," and "],dateOperatorIsBlank:"is blank",
dateOperatorIsNotBlank:"is not blank"},_getDisplayDates:function(b){var a={value:b.virtualDate,value1:b.virtualDate1,value2:b.virtualDate2},c=""===b.dateFormat?{}:{format:{dateFormat:b.dateFormat}};if(""===b.virtualDate||void 0===b.virtualDate)a.value=k.localizeDateByFieldInfo(new Date(b.value),c);""===b.virtualDate1&&(a.value1=k.localizeDateByFieldInfo(new Date(b.value1),c));""===b.virtualDate2&&(a.value2=k.localizeDateByFieldInfo(new Date(b.value2),c));return a},getDisplaySQL:function(b,a,c){var e=
"",e=this._dateENUM[c];0<c.indexOf("InTheLast")?e=e[0]+a.value+" "+this._getDateRangeEnum(a.value,a.range)+e[1]:(a=this._getDisplayDates(a,c),e=0<c.indexOf("Between")?e[0]+a.value1+e[1]+a.value2:0<c.indexOf("Blank")?this._dateENUM[c]:this._dateENUM[c]+a.value);return b+" "+e},_getDateRangeEnum:function(b,a){a={dateOperatorYears:"year",dateOperatorDays:"day",dateOperatorMonths:"month",dateOperatorWeeks:"week",dateOperatorHours:"hour",dateOperatorMinutes:"minute"}[a];return 1<b?a+"s":a},_convertRangeToDays:function(b,
a){var c=b;a===this.OPERATORS.dateOperatorYears?c=365*b:a===this.OPERATORS.dateOperatorMonths?c=30*b:a===this.OPERATORS.dateOperatorWeeks?c=7*b:a===this.OPERATORS.dateOperatorHours?c=b/24:a===this.OPERATORS.dateOperatorMinutes&&(c=b/1440);return c=Math.round(1E6*c)/1E6},formatDate:function(b){b=new Date(b);return""+b.getUTCFullYear()+"-"+n.format(b.getUTCMonth()+1,{pattern:"00"})+"-"+n.format(b.getUTCDate(),{pattern:"00"})+" "+n.format(b.getUTCHours(),{pattern:"00"})+":"+n.format(b.getUTCMinutes(),
{pattern:"00"})+":"+n.format(b.getSeconds(),{pattern:"00"})},addDay:function(b){return new Date(b.getTime()+this.dayInMS)},addMinute:function(b){return new Date(b.getTime()+this.MinuteInMS)},addSec:function(b){return new Date(b.getTime()+this.SecInMS)},getFilterObjByExpr:function(b){if(b&&this.fieldsStore){var a=this.replaceStrings(b);b=a.defExpr;var c=this.findParts(b,"AND");1===c.parts.length&&(c=this.findParts(b,"OR"),1===c.parts.length&&(c.logicalOperator="AND"));t.forEach(c.parts,function(a){a.expr=
a.expr.trim();if(a.expr.startsWith("(")&&-1<a.expr.search(/\)$/)){var b=a.expr.substring(1,a.expr.length-1),c=b.indexOf("("),e=b.indexOf(")");if(-1===c&&-1===e||c<e)a.expr=b}b=this.findParts(a.expr,"AND");1===b.parts.length&&(b=this.findParts(a.expr,"OR"));1<b.parts.length&&(a.parts=b.parts,a.logicalOperator=b.logicalOperator)},this);this.parseExpr(c);this.reReplaceStrings(a,c,g.hitch(this,function(){c&&c.parts&&t.forEach(c.parts,g.hitch(this,function(a){a&&(a.parts?t.forEach(a.parts,g.hitch(this,
function(a){this._handleParsedValuesForSinglePart(a);this._addDefalutValueTypeForSinglePart(a)})):(this._handleParsedValuesForSinglePart(a),this._addDefalutValueTypeForSinglePart(a)))}))}));this.isPartsObjHasError(c)&&(c=null);return c}},_handleParsedValuesForSinglePart:function(b){b&&b.fieldObj&&"number"===b.fieldObj.shortType&&b.valueObj&&(b.valueObj.hasOwnProperty("value")&&(b.valueObj.value=parseFloat(b.valueObj.value)),b.valueObj.hasOwnProperty("value1")&&(b.valueObj.value1=parseFloat(b.valueObj.value1)),
b.valueObj.hasOwnProperty("value2")&&(b.valueObj.value2=parseFloat(b.valueObj.value2)))},_addDefalutValueTypeForSinglePart:function(b){b&&b.valueObj&&!b.valueObj.type&&(b.valueObj.type="value")},replaceStrings:function(b){for(var a=b,c=function(a,b,e){var f=-1,f=a.indexOf("'",e+1);return f===e+1?(f=a.indexOf("'",f+1),c(a,b,f)):e},e=[],f=b.indexOf("'");-1<f;){var g=f,f=b.indexOf("'",f+1),k=0,f=c(b,g,f);"%"===b[g+1]&&g++;"%"===b[f-1]&&(--f,k++);var m=b.substring(g+1,f);"N"===b[g-1]&&(b=b.substring(0,
g-1)+b.substring(g),--g,--f);this.isDateString(m)||-1!==m.indexOf("{")?f=b.indexOf("'",f+1+k):(e.push(m),b=b.substring(0,g+1)+"#"+(e.length-1)+"#"+b.substring(f),f=b.indexOf("'",b.lastIndexOf("#")+2+k))}return{origDefExpr:a,defExpr:b,savedStrings:e}},reReplaceStrings:function(b,a,c){var e=b.savedStrings;if(!e.length)c&&"function"===typeof c&&c();else if(e.length){var f=function(a,b){if(void 0===a.valueObj||null===a.valueObj||void 0===a.valueObj.value||null===a.valueObj.value||"string"!==a.fieldObj.shortType)return!1;
var c=a.valueObj.value.indexOf("#"),e=a.valueObj.value.lastIndexOf("#");return m.isDefined(a.valueObj.value)&&-1<c?(a.valueObj.value=b[parseInt(a.valueObj.value.substring(c+1,e),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(a),!0):!1},f=g.hitch(this,f),k=!1;t.forEach(a.parts,function(a){if(a.parts){var b=!1;t.forEach(a.parts,function(a){b=f(a,e)||b});b&&(k=b,a.expr=this.builtFilterString(a))}else(k=f(a,e)||k)&&this.builtFilterString(a)},this);c&&"function"===typeof c&&c();k&&(a.expr=null,
this.getExprByFilterObj(a))}},isDateString:function(b){return 19===b.length&&"-"===b.charAt(4)&&"-"===b.charAt(7)&&" "===b.charAt(10)&&":"===b.charAt(13)&&":"===b.charAt(16)?!0:!1},findParts:function(b,a){for(var c=b.toLowerCase(),e=" "+a.toLowerCase()+" ",f=[],g=0,k=c.indexOf(e);0<k;){var m=b.substring(g,k),n=m.toLowerCase(),p=m.count("("),u=m.count(")"),t=m.count("'");p!==u||1===t%2?k=c.indexOf(e,k+1):-1<n.indexOf(" between ")&&-1===n.indexOf(" and ")?k=c.indexOf(e,k+1):(f.push({expr:m}),g=k+e.length,
k=c.indexOf(e,g))}f.push({expr:b.substring(g)});for(c=f.length-1;0<=c;c--)!this.hasOperator(f[c].expr)&&0<c&&(f[c-1].expr+=" "+a+" "+f[c].expr,f.splice(c,1));return{expr:b,parts:f,logicalOperator:a}},hasOperator:function(b){b=b.toLowerCase();return-1<b.indexOf("{")&&-1<b.indexOf("}")||-1<b.indexOf(" \x3d ")||-1<b.indexOf(" \x3c ")||-1<b.indexOf(" \x3e ")||-1<b.indexOf(" \x3c\x3e ")||-1<b.indexOf(" \x3c\x3d ")||-1<b.indexOf(" \x3e\x3d ")||-1<b.indexOf(" like ")||-1<b.indexOf(" between ")||-1<b.indexOf(" date")||
-1<b.indexOf(" is null")||-1<b.indexOf(" is not null")?!0:!1},parseExpr:function(b){t.forEach(b.parts,function(a){a.parts?this.parseExpr(a):this.parseSingleExpr(a)},this)},_preParseSingleExpr:function(b){var a=null;try{if(a=g.clone(b),a.expr=a.expr.trim(),/^UPPER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+UPPER\(N?'(.*)'\)$/i.test(a.expr)){var c=b="",e=a.expr.match(/^UPPER\((.*)\)\s+/i);if(e&&2<=e.length)b=e[1];else return null;var f=a.expr.match(/UPPER\(N?'(.*)'\)$/i);if(f&&2<=f.length)c="'"+f[1]+"'";else return null;
a.expr=a.expr.replace(/^UPPER\((.*)\)\s+/i,b+" ");a.expr=a.expr.replace(/UPPER\(N?'(.*)'\)$/i,c);a.caseSensitive=!1}else/^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(a.expr)&&(a.caseSensitive=!0)}catch(q){return console.log(q),null}a&&this.isHosted&&(a.caseSensitive=!1);return a},_removeOperator:function(b,a,c){a=a.substring(c).trim();"date"===b&&!this.isHosted&&a.toLowerCase().startsWith("timestamp ")&&(a=a.substring(10).trim());return a},parseSingleExpr:function(b){var a=this._preParseSingleExpr(b);
a&&(b=g.mixin(b,a));var a=b.expr.trim(),c=a.indexOf(" "),e=a.substring(0,c);b.fieldObj={name:e};b.valueObj={};this.getFieldItemByName({name:e},function(a){b.fieldObj.shortType=a.shortType[0];b.fieldObj.label=a.label[0]},function(){b.error={msg:"unknown field name ("+e+")",code:1}});a=a.substring(c+1).trim();c=a.toLowerCase();c.startsWith("\x3d ")?(a=this._removeOperator(b.fieldObj.shortType,a,2),this.storeValue(a,b),b.operator="date"===b.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===
b.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):c.startsWith("\x3c ")?(a=this._removeOperator(b.fieldObj.shortType,a,2),this.storeValue(a,b),"date"===b.fieldObj.shortType?b.operator=this.OPERATORS.dateOperatorIsBefore:"number"===b.fieldObj.shortType?b.operator=this.OPERATORS.numberOperatorIsLessThan:b.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3e ")?(a=this._removeOperator(b.fieldObj.shortType,a,2),this.storeValue(a,b),"date"===
b.fieldObj.shortType?b.operator=this.OPERATORS.dateOperatorIsAfter:"number"===b.fieldObj.shortType?b.operator=this.OPERATORS.numberOperatorIsGreaterThan:b.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3c\x3e ")?(a=this._removeOperator(b.fieldObj.shortType,a,3),this.storeValue(a,b),b.operator="date"===b.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===b.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):c.startsWith("\x3c\x3d ")?
(a=this._removeOperator(b.fieldObj.shortType,a,3),this.storeValue(a,b),"date"===b.fieldObj.shortType?b.operator=this.OPERATORS.dateOperatorIsOnOrBefore:"number"===b.fieldObj.shortType?b.operator=this.OPERATORS.numberOperatorIsAtMost:b.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("\x3e\x3d ")?(a=this._removeOperator(b.fieldObj.shortType,a,3),this.storeValue(a,b),"date"===b.fieldObj.shortType?b.operator=this.OPERATORS.dateOperatorIsOnOrAfter:"number"===b.fieldObj.shortType?
b.operator=this.OPERATORS.numberOperatorIsAtLeast:b.error={msg:"operator ("+c+") not supported for string",code:3}):c.startsWith("like ")?(a=a.substring(5).trim(),a.startsWith("N'")&&(a=a.substring(1,a.length)),a.startsWith("'%")&&a.endsWith("%'")?(this.storeValue(a.substring(2,a.length-2),b),b.operator=this.OPERATORS.stringOperatorContains):a.startsWith("'%")&&a.endsWith("'")?(this.storeValue(a.substring(2,a.length-1),b),b.operator=this.OPERATORS.stringOperatorEndsWith):a.startsWith("'")&&a.endsWith("%'")?
(this.storeValue(a.substring(1,a.length-2),b),b.operator=this.OPERATORS.stringOperatorStartsWith):b.error={msg:"value ("+c+") not supported for LIKE",code:3}):c.startsWith("not like ")?(a=a.substring(9).trim(),a.startsWith("N'")&&(a=a.substring(1,a.length)),a.startsWith("'%")&&a.endsWith("%'")?(this.storeValue(a.substring(2,a.length-2),b),b.operator=this.OPERATORS.stringOperatorDoesNotContain):b.error={msg:"value ("+c+") not supported for NOT LIKE",code:3}):c.startsWith("between ")?this._updatePartForBetween(a,
!0,b):c.startsWith("not between ")?this._updatePartForBetween(a,!1,b):"is null"===c?(b.valueObj.value=null,b.operator="date"===b.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===b.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):"is not null"===c?(b.valueObj.value=null,b.operator="date"===b.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===b.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):
b.error={msg:"unknown operator ("+c+")",code:2};if(m.isDefined(b.valueObj.value)&&"string"===typeof b.valueObj.value&&b.valueObj.value.startsWith("{")&&b.valueObj.value.endsWith("}")||m.isDefined(b.valueObj.value1)&&"string"===typeof b.valueObj.value1&&b.valueObj.value1.startsWith("{")&&b.valueObj.value1.endsWith("}"))b.isInteractive=!0},getFieldItemByName:function(b,a,c){this.fieldsStore.fetch({query:b,onComplete:g.hitch(this,function(b){b&&b.length?a(b[0]):c()})})},subtractDay:function(b){return new Date(b.getTime()-
this.dayInMS)},_updatePartForBetween:function(b,a,c){var e,f,g,k,m;b=this._removeOperator(c.fieldObj.shortType,b,(a?"between ":"not between ").length);e=b.toLowerCase().indexOf(" and ");if(-1<e)if(f=b.substring(0,e).trim(),f.startsWith("CURRENT_TIMESTAMP "))if(f=f.substring(18).trim(),f.startsWith("-")){c.operator=a?this.OPERATORS.dateOperatorInTheLast:this.OPERATORS.dateOperatorNotInTheLast;try{m=parseFloat(f.substring(1).trim()),1<=m?(g=this.OPERATORS.dateOperatorDays,k=m/365,1E-4>Math.abs(k-Math.round(k))?
(m=Math.round(k),g=this.OPERATORS.dateOperatorYears):(k=m/30,1E-4>Math.abs(k-Math.round(k))?(m=Math.round(k),g=this.OPERATORS.dateOperatorMonths):(k=m/7,1E-4>Math.abs(k-Math.round(k))&&(m=Math.round(k),g=this.OPERATORS.dateOperatorWeeks)))):(g=this.OPERATORS.dateOperatorMinutes,m*=24,1E-4>Math.abs(m-Math.round(m))?g=this.OPERATORS.dateOperatorHours:m*=60),c.valueObj.value=m,c.valueObj.range=g}catch(E){c.error={msg:"missing count for '"+(a?"":"not ")+"in the last'",code:3}}}else c.error={msg:"'"+(a?
"":"not ")+"in the next' not supported",code:3};else if(b=this._removeOperator(c.fieldObj.shortType,b.substring(e),5),this.storeValue1(f,c),this.storeValue2(b,c),"date"===c.fieldObj.shortType){if(c.operator=a?this.OPERATORS.dateOperatorIsBetween:this.OPERATORS.dateOperatorIsNotBetween,"object"===typeof c.valueObj.value1&&"object"===typeof c.valueObj.value2)try{1E3>Math.abs(this.subtractDay(c.valueObj.value2).getTime()-c.valueObj.value1.getTime())&&(c.valueObj.value=c.valueObj.value1,delete c.valueObj.value1,
delete c.valueObj.value2,c.operator=a?this.OPERATORS.dateOperatorIsOn:this.OPERATORS.dateOperatorIsNotOn)}catch(E){}}else"number"===c.fieldObj.shortType||"oid"===c.fieldObj.shortType?c.operator=a?this.OPERATORS.numberOperatorIsBetween:this.OPERATORS.numberOperatorIsNotBetween:c.error={msg:c.fieldObj.shortType+" field not supported for "+(a?"":"NOT ")+"BETWEEN",code:3};else c.error={msg:"missing AND operator for "+(a?"":"NOT ")+"BETWEEN",code:3}},storeValue:function(b,a){if(b.startsWith("{")&&b.endsWith("}"))a.valueObj.value=
b;else if(b.startsWith("'{")&&b.endsWith("}'"))a.valueObj.value=b.substring(1,b.length-1);else if("date"===a.fieldObj.shortType)if(b.startsWith("'")&&b.endsWith("'")){var c=b.substring(1,b.length-1);a.valueObj.value=this.parseDate(c)}else a.valueObj.value=b,a.valueObj.type="field";else"string"===a.fieldObj.shortType?(b.startsWith("#")||b.startsWith("%#"))&&(b.endsWith("#")||b.endsWith("#%"))?a.valueObj.value=b:b.startsWith("'")&&b.endsWith("'")?a.valueObj.value=b.substring(1,b.length-1).replace(/\'\'/g,
"'"):(a.valueObj.value=b,a.valueObj.type="field",this.getFieldItemByName({name:b},function(b){a.valueObj.label=b.label[0]},function(){a.error={msg:"unknown field name ("+b+")",code:1}})):(a.valueObj.value=b,isNaN(b)&&(a.valueObj.type="field",this.getFieldItemByName({name:b},function(b){a.valueObj.label=b.label[0]},function(){a.error={msg:"unknown field name ("+b+")",code:1}})))},storeValue1:function(b,a){b.startsWith("{")&&b.endsWith("}")?a.valueObj.value1=b:b.startsWith("'{")&&b.endsWith("}'")?a.valueObj.value1=
b.substring(1,b.length-1):"date"===a.fieldObj.shortType?b.startsWith("'")&&b.endsWith("'")?(b=b.substring(1,b.length-1),a.valueObj.value1=this.parseDate(b)):(a.valueObj.value1=b,a.valueObj.type="field"):(a.valueObj.value1=b,isNaN(b)&&(a.valueObj.type="field"))},storeValue2:function(b,a){b.startsWith("{")&&b.endsWith("}")?a.valueObj.value2=b:b.startsWith("'{")&&b.endsWith("}'")?a.valueObj.value2=b.substring(1,b.length-1):"date"===a.fieldObj.shortType?b.startsWith("'")&&b.endsWith("'")?(b=b.substring(1,
b.length-1),a.valueObj.value2=this.parseDate(b)):(a.valueObj.value2=b,a.valueObj.type="field"):(a.valueObj.value2=b,isNaN(b)&&(a.valueObj.type="field"))},parseDate:function(b){var a=v.parse(b,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});a||(a=v.parse(b.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(a=v.parse(b.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return a}});e.VIRTUAL_DATE_TODAY="today";e.VIRTUAL_DATE_YESTERDAY="yesterday";e.VIRTUAL_DATE_TOMORROW=
"tomorrow";e.VIRTUAL_DATE_THIS_WEEK="thisWeek";e.VIRTUAL_DATE_THIS_MONTH="thisMonth";e.VIRTUAL_DATE_THIS_QUARTER="thisQuarter";e.VIRTUAL_DATE_THIS_YEAR="thisYear";e.isAskForValues=function(b){var a=!1;return a=t.some(b.parts,function(a){return a.parts?t.some(a.parts,function(a){return!!a.interactiveObj}):!!a.interactiveObj})};e.hasVirtualDate=function(b){var a=!1;return a=t.some(b.parts,function(a){return a.parts?t.some(a.parts,function(a){return!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||
!!a.valueObj.virtualDate2}):!!a.valueObj.virtualDate||!!a.valueObj.virtualDate1||!!a.valueObj.virtualDate2})};e.getRealDateByVirtualDate=function(b){var a=null,c=new Date,g=c.getTime();switch(b){case e.VIRTUAL_DATE_TODAY:a=c;break;case e.VIRTUAL_DATE_YESTERDAY:a=new Date(g-864E5);break;case e.VIRTUAL_DATE_TOMORROW:a=new Date(g+864E5);break;case e.VIRTUAL_DATE_THIS_WEEK:a=[f().startOf("week").toDate(),f().endOf("week").toDate()];break;case e.VIRTUAL_DATE_THIS_MONTH:a=[f().startOf("month").toDate(),
f().endOf("month").toDate()];break;case e.VIRTUAL_DATE_THIS_QUARTER:a=[f().startOf("quarter").toDate(),f().endOf("quarter").toDate()];break;case e.VIRTUAL_DATE_THIS_YEAR:a=[f().startOf("year").toDate(),f().endOf("year").toDate()]}return a};return e})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(p,g,t,v,n,m,u){return g("dojo.data.ItemFileWriteStore",m,{constructor:function(g){this._features["dojo.data.api.Write"]=
!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(f){return u.toISOString(f,{zulu:!0})});g&&!1===g.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(g){if(!g)throw Error("assertion failed in ItemFileWriteStore");},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},
newItem:function(g,f){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof g&&"undefined"!=typeof g)throw Error("newItem() was passed something other than an object");var e=null,b=this._getIdentifierAttribute();if(b===Number)e=this._arrayOfAllItems.length;else{e=g[b];if("undefined"===typeof e)throw Error("newItem() was not passed an identity for the new item");if(p.isArray(e))throw Error("newItem() was not passed an single-valued identity");}this._itemsByIdentity&&
this._assert("undefined"===typeof this._itemsByIdentity[e]);this._assert("undefined"===typeof this._pending._newItems[e]);this._assert("undefined"===typeof this._pending._deletedItems[e]);var a={};a[this._storeRefPropName]=this;a[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[e]=a,a[b]=[e]);this._arrayOfAllItems.push(a);b=null;if(f&&f.parent&&f.attribute){var b={item:f.parent,attribute:f.attribute,oldValue:void 0},c=this.getValues(f.parent,f.attribute);
if(c&&0<c.length){var k=c.slice(0,c.length);b.oldValue=1===c.length?c[0]:c.slice(0,c.length);k.push(a);this._setValueOrValues(f.parent,f.attribute,k,!1);b.newValue=this.getValues(f.parent,f.attribute)}else this._setValueOrValues(f.parent,f.attribute,a,!1),b.newValue=a}else a[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(a);this._pending._newItems[e]=a;for(var m in g){if(m===this._storeRefPropName||m===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
f=g[m];p.isArray(f)||(f=[f]);a[m]=f;if(this.referenceIntegrity)for(e=0;e<f.length;e++)c=f[e],this.isItem(c)&&this._addReferenceToMap(c,a,m)}this.onNew(a,b);return a},_removeArrayElement:function(g,f){f=t.indexOf(g,f);return-1!=f?(g.splice(f,1),!0):!1},deleteItem:function(g){this._assert(!this._saveInProgress);this._assertIsItem(g);var f=g[this._itemNumPropName],e=this.getIdentity(g);if(this.referenceIntegrity){var b=this.getAttributes(g);g[this._reverseRefMap]&&(g["backup_"+this._reverseRefMap]=p.clone(g[this._reverseRefMap]));
t.forEach(b,function(a){t.forEach(this.getValues(g,a),function(b){this.isItem(b)&&(g["backupRefs_"+this._reverseRefMap]||(g["backupRefs_"+this._reverseRefMap]=[]),g["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(b),attr:a}),this._removeReferenceFromMap(b,g,a))},this)},this);if(b=g[this._reverseRefMap])for(var a in b){var c=null;if(c=this._itemsByIdentity?this._itemsByIdentity[a]:this._arrayOfAllItems[a])for(var k in b[a]){var m=this.getValues(c,k)||[],n=t.filter(m,function(a){return!(this.isItem(a)&&
this.getIdentity(a)==e)},this);this._removeReferenceFromMap(g,c,k);n.length<m.length&&this._setValueOrValues(c,k,n,!0)}}}this._arrayOfAllItems[f]=null;g[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[e];this._pending._deletedItems[e]=g;g[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,g);this.onDelete(g);return!0},setValue:function(g,f,e){return this._setValueOrValues(g,f,e,!0)},setValues:function(g,f,e){return this._setValueOrValues(g,
f,e,!0)},unsetAttribute:function(g,f){return this._setValueOrValues(g,f,[],!0)},_setValueOrValues:function(g,f,e,b){this._assert(!this._saveInProgress);this._assertIsItem(g);this._assert(p.isString(f));this._assert("undefined"!==typeof e);var a=this._getIdentifierAttribute();if(f==a)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var a=this._getValueOrValues(g,f),c=this.getIdentity(g);if(!this._pending._modifiedItems[c]){var k={},m;for(m in g)k[m]=
m===this._storeRefPropName||m===this._itemNumPropName||m===this._rootItemPropName?g[m]:m===this._reverseRefMap?p.clone(g[m]):g[m].slice(0,g[m].length);this._pending._modifiedItems[c]=k}c=!1;if(p.isArray(e)&&0===e.length){if(c=delete g[f],e=void 0,this.referenceIntegrity&&a){m=a;p.isArray(m)||(m=[m]);for(var n=0;n<m.length;n++)k=m[n],this.isItem(k)&&this._removeReferenceFromMap(k,g,f)}}else{c=p.isArray(e)?e.slice(0,e.length):[e];if(this.referenceIntegrity)if(a){m=a;p.isArray(m)||(m=[m]);var u={};t.forEach(m,
function(a){this.isItem(a)&&(a=this.getIdentity(a),u[a.toString()]=!0)},this);t.forEach(c,function(a){if(this.isItem(a)){var b=this.getIdentity(a);u[b.toString()]?delete u[b.toString()]:this._addReferenceToMap(a,g,f)}},this);for(n in u)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[n]:this._arrayOfAllItems[n],g,f)}else for(n=0;n<c.length;n++)k=c[n],this.isItem(k)&&this._addReferenceToMap(k,g,f);g[f]=c;c=!0}if(b)this.onSet(g,f,a,e);return c},_addReferenceToMap:function(g,
f,e){f=this.getIdentity(f);var b=g[this._reverseRefMap];b||(b=g[this._reverseRefMap]={});(g=b[f])||(g=b[f]={});g[e]=!0},_removeReferenceFromMap:function(g,f,e){f=this.getIdentity(f);var b=g[this._reverseRefMap],a;if(b){for(a in b)a==f&&(delete b[a][e],this._isEmpty(b[a])&&delete b[a]);this._isEmpty(b)&&delete g[this._reverseRefMap]}},_dumpReferenceMap:function(){var g;for(g=0;g<this._arrayOfAllItems.length;g++){var f=this._arrayOfAllItems[g];f&&f[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(f)+
"] is referenced by: "+v.toJson(f[this._reverseRefMap]))}},_getValueOrValues:function(g,f){var e=void 0;this.hasAttribute(g,f)&&(g=this.getValues(g,f),e=1==g.length?g[0]:g);return e},_flatten:function(g){if(this.isItem(g))return{_reference:this.getIdentity(g)};if("object"===typeof g)for(var f in this._datatypeMap){var e=this._datatypeMap[f];if(p.isObject(e)&&!p.isFunction(e)){if(g instanceof e.type){if(!e.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+f+"]");
return{_type:f,_value:e.serialize(g)}}}else if(g instanceof e)return{_type:f,_value:g.toString()}}return g},_getNewFileContentString:function(){var g={},f=this._getIdentifierAttribute();f!==Number&&(g.identifier=f);this._labelAttr&&(g.label=this._labelAttr);g.items=[];for(f=0;f<this._arrayOfAllItems.length;++f){var e=this._arrayOfAllItems[f];if(null!==e){var b={},a;for(a in e)if(a!==this._storeRefPropName&&a!==this._itemNumPropName&&a!==this._reverseRefMap&&a!==this._rootItemPropName){var c=this.getValues(e,
a);if(1==c.length)b[a]=this._flatten(c[0]);else for(var m=[],n=0;n<c.length;++n)m.push(this._flatten(c[n])),b[a]=m}g.items.push(b)}}return v.toJson(g,!0)},_isEmpty:function(g){var f=!0;if(p.isObject(g))for(var e in g){f=!1;break}else p.isArray(g)&&0<g.length&&(f=!1);return f},save:function(g){this._assert(!this._saveInProgress);this._saveInProgress=!0;var f=this,e=function(){f._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};f._saveInProgress=!1;g&&g.onComplete&&g.onComplete.call(g.scope||
n.global)},b=function(a){f._saveInProgress=!1;g&&g.onError&&g.onError.call(g.scope||n.global,a)};if(this._saveEverything){var a=this._getNewFileContentString();this._saveEverything(e,b,a)}this._saveCustom&&this._saveCustom(e,b);this._saveEverything||this._saveCustom||e()},revert:function(){this._assert(!this._saveInProgress);for(var g in this._pending._modifiedItems){var f=this._pending._modifiedItems[g],e=null,e=this._itemsByIdentity?this._itemsByIdentity[g]:this._arrayOfAllItems[g];f[this._storeRefPropName]=
this;for(var b in e)delete e[b];p.mixin(e,f)}var a;for(g in this._pending._deletedItems)a=this._pending._deletedItems[g],a[this._storeRefPropName]=this,f=a[this._itemNumPropName],a["backup_"+this._reverseRefMap]&&(a[this._reverseRefMap]=a["backup_"+this._reverseRefMap],delete a["backup_"+this._reverseRefMap]),this._arrayOfAllItems[f]=a,this._itemsByIdentity&&(this._itemsByIdentity[g]=a),a[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(a);for(g in this._pending._deletedItems)a=this._pending._deletedItems[g],
a["backupRefs_"+this._reverseRefMap]&&(t.forEach(a["backupRefs_"+this._reverseRefMap],function(b){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[b.id]:this._arrayOfAllItems[b.id],a,b.attr)},this),delete a["backupRefs_"+this._reverseRefMap]);for(g in this._pending._newItems)f=this._pending._newItems[g],f[this._storeRefPropName]=null,this._arrayOfAllItems[f[this._itemNumPropName]]=null,f[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,f),this._itemsByIdentity&&
delete this._itemsByIdentity[g];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(g){return g?(g=this.getIdentity(g),(new Boolean(this._pending._newItems[g]||this._pending._modifiedItems[g]||this._pending._deletedItems[g])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(g,f,e,b){},onNew:function(g,f){},onDelete:function(g){},close:function(g){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(p,g,t,v,n,m,u,k,f){t=t("dojo.data.ItemFileReadStore",[m],{constructor:function(e){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=e.url;this._jsonData=e.data;this.data=null;this._datatypeMap=e.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(b){return f.fromISOString(b)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==e.urlPreventCache&&(this.urlPreventCache=e.urlPreventCache?!0:!1);void 0!==e.hierarchical&&(this.hierarchical=e.hierarchical?
!0:!1);e.clearOnClose&&(this.clearOnClose=!0);"failOk"in e&&(this.failOk=e.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(e){if(!this.isItem(e))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(e){if("string"!==typeof e)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(e,b,a){e=this.getValues(e,b);return 0<e.length?e[0]:a},getValues:function(e,
b){this._assertIsItem(e);this._assertIsAttribute(b);return(e[b]||[]).slice(0)},getAttributes:function(e){this._assertIsItem(e);var b=[],a;for(a in e)a!==this._storeRefPropName&&a!==this._itemNumPropName&&a!==this._rootItemPropName&&a!==this._reverseRefMap&&b.push(a);return b},hasAttribute:function(e,b){this._assertIsItem(e);this._assertIsAttribute(b);return b in e},containsValue:function(e,b,a){var c=void 0;"string"===typeof a&&(c=u.patternToRegExp(a,!1));return this._containsValue(e,b,a,c)},_containsValue:function(e,
b,a,c){return v.some(this.getValues(e,b),function(b){if(null!==b&&!g.isObject(b)&&c){if(b.toString().match(c))return!0}else if(a===b)return!0})},isItem:function(e){return e&&e[this._storeRefPropName]===this&&this._arrayOfAllItems[e[this._itemNumPropName]]===e?!0:!1},isItemLoaded:function(e){return this.isItem(e)},loadItem:function(e){this._assertIsItem(e.item)},getFeatures:function(){return this._features},getLabel:function(e){if(this._labelAttr&&this.isItem(e))return this.getValue(e,this._labelAttr)},
getLabelAttributes:function(e){return this._labelAttr?[this._labelAttr]:null},filter:function(e,b,a){var c=[],f,g;if(e.query){var k;f=e.queryOptions?e.queryOptions.ignoreCase:!1;var m={};for(g in e.query)k=e.query[g],"string"===typeof k?m[g]=u.patternToRegExp(k,f):k instanceof RegExp&&(m[g]=k);for(f=0;f<b.length;++f){var n=!0,p=b[f];if(null===p)n=!1;else for(g in e.query)k=e.query[g],this._containsValue(p,g,k,m[g])||(n=!1);n&&c.push(p)}}else for(f=0;f<b.length;++f)g=b[f],null!==g&&c.push(g);a(c,e)},
_fetchItems:function(e,b,a){var c=this;if(this._loadFinished)this.filter(e,this._getItemsArray(e.queryOptions),b);else if(this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:e,
filter:g.hitch(c,"filter"),findCallback:g.hitch(c,b)});else{this._loadInProgress=!0;var f=n.get({url:c._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});f.addCallback(function(f){try{c._getItemsFromLoadedData(f),c._loadFinished=!0,c._loadInProgress=!1,c.filter(e,c._getItemsArray(e.queryOptions),b),c._handleQueuedFetches()}catch(C){c._loadFinished=!0,c._loadInProgress=!1,a(C,e)}});f.addErrback(function(b){c._loadInProgress=!1;a(b,e)});var k=null;e.abort&&
(k=e.abort);e.abort=function(){var a=f;a&&-1===a.fired&&(a.cancel(),a=null);k&&k.call(e)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,c.filter(e,this._getItemsArray(e.queryOptions),b)}catch(q){a(q,e)}else a(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),e)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var e=0;e<this._queuedFetches.length;e++){var b=
this._queuedFetches[e],a=b.args,c=b.filter,b=b.findCallback;c?c(a,this._getItemsArray(a.queryOptions),b):this.fetchItemByIdentity(a)}this._queuedFetches=[]}},_getItemsArray:function(e){return e&&e.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(e){this.clearOnClose&&this._loadFinished&&!this._loadInProgress&&(""!=this._jsonFileUrl&&null!=this._jsonFileUrl||""!=this.url&&null!=this.url||null!=this.data||console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(e){function b(a){return null!==a&&"object"===typeof a&&(!g.isArray(a)||c)&&!g.isFunction(a)&&(a.constructor==Object||g.isArray(a))&&"undefined"===typeof a._reference&&"undefined"===typeof a._type&&"undefined"===typeof a._value&&f.hierarchical}function a(c){f._arrayOfAllItems.push(c);for(var e in c){var k=c[e];if(k)if(g.isArray(k))for(var m=
0;m<k.length;++m){var n=k[m];b(n)&&a(n)}else b(k)&&a(k)}}var c=!1,f=this;this._labelAttr=e.label;var k,m;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=e.items;for(k=0;k<this._arrayOfTopLevelItems.length;++k)m=this._arrayOfTopLevelItems[k],g.isArray(m)&&(c=!0),a(m),m[this._rootItemPropName]=!0;var n={},p;for(k=0;k<this._arrayOfAllItems.length;++k)for(p in m=this._arrayOfAllItems[k],m){if(p!==this._rootItemPropName){var u=m[p];null!==u?g.isArray(u)||(m[p]=[u]):m[p]=[null]}n[p]=p}for(;n[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;n[this._itemNumPropName];)this._itemNumPropName+="_";for(;n[this._reverseRefMap];)this._reverseRefMap+="_";if(n=e.identifier)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=n,k=0;k<this._arrayOfAllItems.length;++k)if(m=this._arrayOfAllItems[k],e=m[n],e=e[0],Object.hasOwnProperty.call(this._itemsByIdentity,e)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
n+"].  Value collided: ["+e+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+n+"].  Value collided: ["+e+"]");}else this._itemsByIdentity[e]=m;else this._features["dojo.data.api.Identity"]=Number;for(k=0;k<this._arrayOfAllItems.length;++k)m=this._arrayOfAllItems[k],m[this._storeRefPropName]=this,m[this._itemNumPropName]=k;for(k=0;k<this._arrayOfAllItems.length;++k)for(p in m=this._arrayOfAllItems[k],
m)for(e=m[p],n=0;n<e.length;++n)if(u=e[n],null!==u&&"object"==typeof u){if("_type"in u&&"_value"in u){var t=u._type,v=this._datatypeMap[t];if(v)if(g.isFunction(v))e[n]=new v(u._value);else if(g.isFunction(v.deserialize))e[n]=v.deserialize(u._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
t+"'");}if(u._reference){u=u._reference;if(g.isObject(u))for(t=0;t<this._arrayOfAllItems.length;++t){var v=this._arrayOfAllItems[t],F=!0,D;for(D in u)v[D]!=u[D]&&(F=!1);F&&(e[n]=v)}else e[n]=this._getItemByIdentity(u);this.referenceIntegrity&&(u=e[n],this.isItem(u)&&this._addReferenceToMap(u,m,p))}else this.isItem(u)&&this.referenceIntegrity&&this._addReferenceToMap(u,m,p)}},_addReferenceToMap:function(e,b,a){},getIdentity:function(e){var b=this._features["dojo.data.api.Identity"];return b===Number?
e[this._itemNumPropName]:(e=e[b])?e[0]:null},fetchItemByIdentity:function(e){var b,a;if(this._loadFinished)b=this._getItemByIdentity(e.identity),e.onItem&&(a=e.scope?e.scope:p.global,e.onItem.call(a,b));else{var c=this;this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:e}):(this._loadInProgress=!0,a=n.get({url:c._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),a.addCallback(function(a){var f=e.scope?e.scope:p.global;try{c._getItemsFromLoadedData(a),c._loadFinished=!0,c._loadInProgress=!1,b=c._getItemByIdentity(e.identity),e.onItem&&e.onItem.call(f,b),c._handleQueuedFetches()}catch(q){c._loadInProgress=
!1,e.onError&&e.onError.call(f,q)}}),a.addErrback(function(a){c._loadInProgress=!1;e.onError&&e.onError.call(e.scope?e.scope:p.global,a)})):this._jsonData&&(c._getItemsFromLoadedData(c._jsonData),c._jsonData=null,c._loadFinished=!0,b=c._getItemByIdentity(e.identity),e.onItem&&(a=e.scope?e.scope:p.global,e.onItem.call(a,b)))}},_getItemByIdentity:function(e){var b=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,e)&&(b=this._itemsByIdentity[e]):Object.hasOwnProperty.call(this._arrayOfAllItems,
e)&&(b=this._arrayOfAllItems[e]);void 0===b&&(b=null);return b},getIdentityAttributes:function(e){e=this._features["dojo.data.api.Identity"];return e===Number?null:[e]},_forceLoad:function(){var e=this;this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var b=n.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});b.addCallback(function(a){try{if(!0!==e._loadInProgress&&!e._loadFinished)e._getItemsFromLoadedData(a),e._loadFinished=!0;else if(e._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(c){throw console.log(c),c;}});b.addErrback(function(a){throw a;
})}else this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0)}});g.extend(t,k);return t})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(p){var g={};p.setObject("dojo.data.util.filter",g);g.patternToRegExp=function(g,p){for(var n="^",m=null,u=0;u<g.length;u++)switch(m=g.charAt(u),m){case "\\":n+=m;u++;n+=g.charAt(u);break;case "*":n+=".*";break;case "?":n+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":n+=
"\\";default:n+=m}n+="$";return p?new RegExp(n,"mi"):new RegExp(n,"m")};return g})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(p,g,t){var v={};p.setObject("dojo.data.util.simpleFetch",v);v.errorHandler=function(n,m){m.onError&&m.onError.call(m.scope||g.global,n,m)};v.fetchHandler=function(n,m){var p=m.abort||null,k=!1,f=m.start?m.start:0,e=m.count&&Infinity!==m.count?f+m.count:n.length;m.abort=function(){k=!0;p&&p.call(m)};var b=m.scope||
g.global;m.store||(m.store=this);m.onBegin&&m.onBegin.call(b,n.length,m);m.sort&&n.sort(t.createSortFunction(m.sort,this));if(m.onItem)for(var a=f;a<n.length&&a<e;++a){var c=n[a];k||m.onItem.call(b,c,m)}m.onComplete&&!k&&(a=null,m.onItem||(a=n.slice(f,e)),m.onComplete.call(b,a,m))};v.fetch=function(g){g=g||{};g.store||(g.store=this);this._fetchItems(g,p.hitch(this,"fetchHandler"),p.hitch(this,"errorHandler"));return g};return v})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(p){var g=
{};p.setObject("dojo.data.util.sorter",g);g.basicComparator=function(g,p){var n=-1;null===g&&(g=void 0);null===p&&(p=void 0);if(g==p)n=0;else if(g>p||null==g)n=1;return n};g.createSortFunction=function(p,v){function n(a,b,e,f){return function(c,g){c=f.getValue(c,a);g=f.getValue(g,a);return b*e(c,g)}}for(var m=[],u,k=v.comparatorMap,f=g.basicComparator,e=0;e<p.length;e++){u=p[e];var b=u.attribute;if(b){u=u.descending?-1:1;var a=f;k&&("string"!==typeof b&&"toString"in b&&(b=b.toString()),a=k[b]||f);
m.push(n(b,u,a,v))}}return function(a,b){for(var c=0;c<m.length;){var e=m[c++](a,b);if(0!==e)return e}return 0}};return g})},"jimu/Query":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils jimu/ServiceDefinitionManager esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet".split(" "),function(p,g,t,v,n,m,u,k,f,e){var b=p(null,{queryType:0,nextPageIndex:1,pageSizeOption:null,layerDefinition:null,layerDefinitionDef:null,type1CountDef:null,
type2ObjectIdsDef:null,type3QueryDef:null,sdf:null,url:null,query:null,pageSize:1E3,constructor:function(a){this.sdf=u.getInstance();this.url=a.url;this.query=a.query;this.pageSizeOption=a.pageSize;this.query.outFields&&0!==this.query.outFields.length||(this.query.outFields=["*"]);this.pageSize=0<a.pageSize?a.pageSize:1E3;this.getFeatureCount()},getFeatureCount:function(){return this._getQueryType().then(g.hitch(this,function(a){return 1===a?this._getCountForQueryType1():2===a?this._getCountForQueryType2():
this._getCountForQueryType3()}))},getPageCount:function(){return this.getFeatureCount().then(g.hitch(this,function(a){return 0===a?0:Math.ceil(a/this.pageSize)}))},getAllFeatures:function(){return this.getPageCount().then(g.hitch(this,function(a){if(0<a){for(var b=[],e=1;e<=a;e++)b.push(this.queryByPage(e));return v(b).then(g.hitch(this,function(a){for(var b=[],c=0;c<a.length;c++)a[c].features&&0<a[c].features.length&&(b=b.concat(a[c].features));b=this._setOrderByFieldValue(b);a=a[0];a.features=b;
return a}))}this._getEmptyFeatureSet().then(g.hitch(this,function(a){return a}))}))},_setOrderByFieldValue:function(a){if(2===this.queryType||3===this.queryType){var b=this.query.outFields;a.sort(function(a,c){a=a.attributes[b];c=c.attributes[b];return"string"===typeof a&&"string"===typeof c?a.localeCompare(c):a<c?-1:a===c?0:1})}return a},_getEmptyFeatureSet:function(){var a=new n;this.layerDefinition&&this.layerDefinition.geometryType?a.resolve(this._getEmptyFeatureSetHandler()):this._getLayerDefinition().then(g.hitch(this,
function(){a.resolve(this._getEmptyFeatureSetHandler())}));return a},_getEmptyFeatureSetHandler:function(){var a=new e;a.features=[];a.geometryType=this.layerDefinition.geometryType;a.fields=[];var b=g.clone(this.layerDefinition.fields);0<=this.query.outFields.indexOf("*")?a.fields=b:a.fields=t.filter(b,g.hitch(this,function(a){return 0<=this.query.outFields.indexOf(a.name)}));return a},getCurrentPageIndex:function(){return this.nextPageIndex},queryNextPage:function(){var a=this.nextPageIndex;this.nextPageIndex++;
return this.queryByPage(a)},queryByPage:function(a){var b=null;0>=a?(b=new n,this._getEmptyFeatureSet().then(g.hitch(this,function(a){b.resolve(a)}))):b=this.getPageCount().then(g.hitch(this,function(b){a>b&&this._getEmptyFeatureSet().then(g.hitch(this,function(a){return a}));return 1===this.queryType?this._queryPageForType1(a):2===this.queryType?this._queryPageForType2(a):this._queryPageForType3(a)}));return b},_getQueryType:function(){var a=new n;if(0<this.queryType)a.resolve(this.queryType);else return this._getLayerDefinition().then(g.hitch(this,
function(a){return this.queryType=b.getQueryType(a)}));return a},_getDefStatus:function(a){return a?a.isFulfilled()?a.isResolved()?2:-1:1:0},_getLayerDefinition:function(){0>=this._getDefStatus(this.layerDefinitionDef)&&(this.layerDefinitionDef=this.sdf.getServiceDefinition(this.url).then(g.hitch(this,function(a){this.layerDefinition=a;var b=a.maxRecordCount;0<b&&(!(0<this.pageSizeOption)||this.pageSize>a.maxRecordCount)&&(this.pageSize=b);return this.layerDefinition})));return this.layerDefinitionDef},
_getCountForQueryType1:function(){0>=this._getDefStatus(this.type1CountDef)&&(this.type1CountDef=this._queryCount());return this.type1CountDef},_getCountForQueryType2:function(){return this._getObjectIdsForQueryType2().then(g.hitch(this,function(a){return a.length}))},_getObjectIdsForQueryType2:function(){0>=this._getDefStatus(this.type2ObjectIdsDef)&&(this.type2ObjectIdsDef=this._queryIds());return this.type2ObjectIdsDef},_getCountForQueryType3:function(){return this._doQueryForQueryType3().then(g.hitch(this,
function(a){return(a.features||[]).length}))},_doQueryForQueryType3:function(){0>=this._getDefStatus(this.type3QueryDef)&&(this.type3QueryDef=this._query());return this.type3QueryDef},_queryPageForType1:function(a){return this._queryWithPaginationAndOrder((a-1)*this.pageSize)},_queryPageForType2:function(a){return this._getObjectIdsForQueryType2().then(g.hitch(this,function(b){var c=(a-1)*this.pageSize;b=b.slice(c,c+this.pageSize);return this._queryByObjectIds(b)}))},_queryPageForType3:function(a){return this._doQueryForQueryType3().then(g.hitch(this,
function(b){var c=g.mixin({},b);c.features=[];var e=(a-1)*this.pageSize;c.features=(b.features||[]).slice(e,e+this.pageSize);return c}))},_tryLocaleNumber:function(a){var b=m.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_tryLocaleDate:function(a){var b=m.localizeDate(a);b||(b=a.toLocaleDateString());return b},_getLayerIndexByLayerUrl:function(a){var b=a.lastIndexOf("/");a=a.slice(b+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var b=a.lastIndexOf("/");return a.slice(0,
b)},_isImageServiceLayer:function(a){return-1<a.indexOf("/ImageServer")},_isTable:function(a){return"Table"===a.type},_getObjectIdField:function(){return this.layerDefinition.objectIdField},_query:function(a){var b=new k;b.where=a||this.query.where;b.geometry=this.query.geometry;b.outSpatialReference=this.query.outSpatialReference;b.returnGeometry=this.query.returnGeometry;b.spatialRelationship=this.query.spatialRelationship;b.outFields=this.query.outFields;b.returnDistinctValues=this.query.returnDistinctValues;
return(new f(this.url)).execute(b)},_queryIds:function(){var a=new k;a.where=this.query.where;a.geometry=this.query.geometry;a.returnGeometry=!1;a.spatialRelationship=this.query.spatialRelationship;a.outSpatialReference=this.query.outSpatialReference;return(new f(this.url)).executeForIds(a).then(g.hitch(this,function(a){a||(a=[]);return a}))},_queryByObjectIds:function(a){var b=new n,e=new k;e.returnGeometry=this.query.returnGeometry;e.outSpatialReference=this.query.outSpatialReference;e.spatialRelationship=
this.query.spatialRelationship;e.outFields=this.query.outFields;e.objectIds=a;(new f(this.url)).execute(e).then(g.hitch(this,function(a){b.resolve(a)}),g.hitch(this,function(c){if(400===c.code){var e=this._getObjectIdField(),f="",k=a.length;t.forEach(a,g.hitch(this,function(a,b){f+=e+" \x3d "+a;b!==k-1&&(f+=" OR ")}));this._query(f).then(g.hitch(this,function(a){b.resolve(a)}),g.hitch(this,function(a){b.reject(a)}))}else b.reject(c)}));return b},_queryCount:function(){var a=new k;a.where=this.query.where;
a.geometry=this.query.geometry;a.outSpatialReference=this.query.outSpatialReference;a.spatialRelationship=this.query.spatialRelationship;a.returnGeometry=!1;return(new f(this.url)).executeForCount(a)},_queryWithPaginationAndOrder:function(a){var b=new k;b.where=this.query.where;b.geometry=this.query.geometry;b.outSpatialReference=this.query.outSpatialReference;b.returnGeometry=this.query.returnGeometry;b.spatialRelationship=this.query.spatialRelationship;b.outFields=this.query.outFields;b.returnDistinctValues=
this.query.returnDistinctValues;b.start=a;b.num=this.pageSize;(a=this.query.orderByFields)&&0<a.length&&(b.orderByFields=a,a=t.map(a,g.hitch(this,function(a){return a.split(" ")[0]})),t.forEach(a,g.hitch(this,function(a){0>b.outFields.indexOf(a)&&b.outFields.push(a)})));return(new f(this.url)).execute(b)}});b._isServiceSupportsOrderBy=function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b};b._isServiceSupportsPagination=function(a){var b=!1;
a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsPagination&&(b=!0);return b};b._isSupportObjectIds=function(a){var b=0;a=a.currentVersion?a:a.toJson().layerDefinition;a.currentVersion&&(b=parseFloat(a.currentVersion));return 10<=b||a.hasOwnProperty("typeIdField")};b.getQueryType=function(a){var c=-1;return c=b._isServiceSupportsOrderBy(a)&&b._isServiceSupportsPagination(a)?1:b._isSupportObjectIds(a)?2:3};return b})},"builder/tokenUtils":function(){define(["jimu/tokenUtils"],function(p){return p})},
"builder/utils":function(){define(["dojo/request/xhr","dojo/cookie","jimu/portalUrlUtils","jimu/utils","dojo/i18n!./nls/builder"],function(p,g,t,v,n){return{appendParamsToAppPath:function(g,n){for(var k in n)n.hasOwnProperty(k)&&(g=0>g.indexOf("?")?g+"?"+k+"\x3d"+n[k]:g+"\x26"+k+"\x3d"+n[k]);return g},removeActionFromUrl:function(g){return v.url.removeQueryParamFromUrl(g,"action")},checkProtocolAndUpdateSigninInfo:function(m,n){var k=n.portalUrl,f=k,e="https"===t.getProtocol(k);m=!!m.allSSL;e!==m&&
m&&(f=t.setHttpsProtocol(k));n.portalUrl=f;return p("/webappbuilder/rest/signininfo/setsignininfo",{handleAs:"json",data:n,method:"POST"}).then(function(b){b.success&&(g("wab_portalurl",f,{path:"/webappbuilder"}),g("wab_portalurl",f,{path:"/webappviewer"}),g("wab_portalurl_persistent",f,{path:"/",expires:365}));return b})},localizeErrMessageByCode:function(g){return g.errCode&&n[g.errCode]?n[g.errCode]:g.message?g.message:""}}})},"builder/PluginManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/Evented dojo/aspect dojo/promise/all jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f){var e=null,b=p(m,{constructor:function(a){this.loaded=[];a&&(this.pluginsMeta=a)},loadPlugin:function(a){var b=new n,e;a=g.clone(a);if(e=this.getPluginByName(a.name))b.resolve(e);else{if(!1===a.properties.hasClass)return e={name:a.name},this.loaded.push(e),b.resolve(e),b;this.loadPluginClass(a).then(g.hitch(this,function(c){this.loadPluginResources(a).then(g.hitch(this,function(e){try{var f=this.createPlugin(a,c,e)}catch(z){console.log("create ["+a.uri+"] error:"+z.stack),
b.reject(z)}setTimeout(g.hitch(this,function(){b.resolve(f);this.emit("pluginCreated",f)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)})}return b},getExtensions:function(a){var b=[],e;for(e in this.pluginsMeta)for(var f=this.pluginsMeta[e],g=0;g<f.extensions.length;g++){var k=f.extensions[g];k.point===a&&b.push(k)}return b},getStemappInfo:function(a){for(var b=this.getExtensions("startup.stemapps"),e={},f=0;f<b.length;f++){var g=b[f];if(g.parameters.appType===a){var k=this.pluginsMeta[g.pluginName];
e.appPath=g.parameters.appPath?k.folderUrl+g.parameters.appPath:k.folderUrl;e.appVersionManager=g.parameters.appVersionManager;e.appType=a;e.thumbnail=e.appPath+"images/thumbnail.png"}}return e},loadPluginClass:function(a){var b=new n;require([a.uri],g.hitch(this,function(a){b.resolve(a)}));return b},loadPluginResources:function(a){var b=new n,e,f,m=[];e=this.loadPluginI18n(a);f=this.loadPluginStyle(a);a=this.loadPluginTemplate(a);m.push(e);m.push(a);m.push(f);k(m).then(g.hitch(this,function(a){var c=
{};c.i18n=a[0];c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){b.reject(a)});return b},createPlugin:function(a,b,e){if(this.getPluginByName(a.name))return this.getPluginByName(a.name);a.nls=e.i18n||{};e.template&&(a.templateString=e.template);a["class"]="builder-plugin";a.pluginsMeta=this.pluginsMeta;a.pluginManager=this;a=new b(a);u.before(a,"destroy",g.hitch(this,this._onDestroyPlugin,a));this.loaded.push(a);return a},getAllPlugins:function(){return this.loaded},destroyAllPlugins:function(){var a=
t.map(this.loaded,function(a){return a.id});t.forEach(a,function(a){this.destroyPlugin(a)},this);this.loaded=[]},getPluginByName:function(a){var b;t.some(this.loaded,function(c){if(c.name===a)return b=c,!0},this);return b},loadPluginStyle:function(a){var b="plugin/style/"+a.uri,e=new n;if(!1===a.properties.hasStyle)return e.resolve(null),e;b=this._replaceId(b);return v.byId(b)?(e.resolve("load"),e):f.loadStyleLink(b,a.amdFolder+"css/style.css")},loadPluginI18n:function(a){var b=new n;if(!1===a.properties.hasLocale)return b.resolve(null),
b;require(["dojo/i18n!"+a.amdFolder+"nls/strings"],function(a){b.resolve(a)});return b},loadPluginTemplate:function(a){var b=new n;if(!1===a.properties.hasUIFile)return b.resolve(null),b;require(["dojo/text!"+a.amdFolder+"Plugin.html"],function(a){b.resolve(a)});return b},removePluginStyle:function(a){v.destroy(this._replaceId("plugin/style/"+a.uri))},_remove:function(a){return t.some(this.loaded,function(b,e){if(b.id===a)return this.loaded.splice(e,1),!0},this)},_replaceId:function(a){return a.replace(/\//g,
"_").replace(/\./g,"_")},_onDestroyPlugin:function(a){"closed"!==a.state&&this.closePlugin(a);this._removePlugin(a)},_removePlugin:function(a){if("string"===typeof a&&(a=this.getPluginByName(a),!a))return;this.removePluginStyle(a);this._remove(a.id)}});b.getInstance=function(a){null===e?e=new b(a):a&&(e.pluginsMeta=a);return e};return b})},"builder/plugins/_build-generate_plugins_module":function(){define("builder/plugins/app-actions/launch-app/_build-generate_module builder/plugins/app-actions/preview-app/_build-generate_module builder/plugins/app-actions/save-app/_build-generate_module builder/plugins/app-actions/to-template-config/_build-generate_module builder/plugins/app-config/_build-generate_module builder/plugins/app-config-configpart/_build-generate_module builder/plugins/app-config-morepreview-selectionpart/_build-generate_module builder/plugins/app-config-template-configpart/_build-generate_module builder/plugins/app-config-templateconfig/_build-generate_module builder/plugins/app-list/_build-generate_module builder/plugins/attribute-config/_build-generate_module builder/plugins/creation-entry/_build-generate_module builder/plugins/header/_build-generate_module builder/plugins/map-config/_build-generate_module builder/plugins/popup-actions/configmode-switch/_build-generate_module builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module builder/plugins/popup-actions/popup-saveas/_build-generate_module builder/plugins/popup-actions/popup-share/_build-generate_module builder/plugins/startup/_build-generate_module builder/plugins/stemapps/web2d/_build-generate_module builder/plugins/stemapps/web3d/_build-generate_module builder/plugins/theme-config/_build-generate_module builder/plugins/widget-config/_build-generate_module".split(" "),
function(){})},"builder/plugins/app-actions/launch-app/_build-generate_module":function(){define(["builder/plugins/app-actions/launch-app/Plugin","dojo/text!builder/plugins/app-actions/launch-app/css/style.css","dojo/i18n!builder/plugins/app-actions/launch-app/nls/strings"],function(){})},"builder/plugins/app-actions/launch-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/topic builder/BasePlugin dojo/_base/html jimu/portalUrlUtils jimu/utils builder/utils".split(" "),
function(p,g,t,v,n,m,u,k,f){return p([n],{baseClass:"plugin-app-actions-launch-app",postCreate:function(){this.inherited(arguments);var e;if(window.isXT)e=window.appInfo.appPath;else{var b=k.urlToObject(window.location.href).query||{};e="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer";var a=window.appInfo.id;"HTML"===a?a="stemapp":"HTML3D"===a&&(a="stemapp3d");e=b.appid?window.portalUrl+"apps/"+e+"/index.html?appid\x3d"+a:window.portalUrl+"apps/"+e+"/index.html?id\x3d"+a;delete b.id;
delete b.appid;delete b.apiurl;delete b.apiurl3d;delete b.edit;delete b.folderid;e=f.appendParamsToAppPath(e,b)}b=m.create("a",{href:e,target:"_blank"},this.domNode);m.create("div",{"class":"footer-button",title:this.nls.label,innerHTML:this.nls.label},b);this._bindEvent()},_bindEvent:function(){this.own(v.subscribe("app/appConfigLoaded",g.hitch(this,this._setAppConfig)));this.own(v.subscribe("app/appConfigChanged",g.hitch(this,this._setAppConfig)))},_setAppConfig:function(e){this.appConfig=e;this.visible=
!e.templateConfig||e.isTemplateApp||e._appData?!0:!1}})})},"builder/BasePlugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,g,t,v,n,m){return p([n,m],{id:void 0,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",constructor:function(){this.extensions={};this.own(v.subscribe("publishData",g.hitch(this,this._onReceiveData)));
this.own(v.subscribe("dataFetched",g.hitch(this,this._onReceiveData)));this.own(v.subscribe("noData",g.hitch(this,this._onNoData)))},getPluginsMetaByExtensionPoint:function(g){var k=[];t.forEach(this.extensionPoints[g].extensions,function(f){k.push(this.pluginsMeta[f.pluginName])},this);return k},filterExtensionsByAppType:function(g,k){if(!this.extensionPoints[g].parameters||!this.extensionPoints[g].parameters.supportAppTypes)return this.extensionPoints[g].extensions;var f=[];t.forEach(this.extensionPoints[g].extensions,
function(e){("all"===e.parameters.supportAppTypes||-1<e.parameters.supportAppTypes.indexOf(k))&&f.push(e)},this);return f},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(g){},onSignOut:function(){},setState:function(g){this.state=g},setWindowState:function(g){this.windowState=g},resize:function(){},publishData:function(g,k){"undefined"===typeof k&&(k=!1);v.publish("publishData",this.name,this.id,g,k)},fetchData:function(g){g?
v.publish("fetchData",g):0!==this.listenWidgetIds.length?t.forEach(this.listenWidgetIds,function(g){v.publish("fetchData",g)},this):v.publish("fetchData")},fetchDataByName:function(g){g=this.widgetManager.getWidgetsByName(g);t.forEach(g,function(g){this.fetchData(g.id)},this)},_onReceiveData:function(g,k,f,e){if(k!==this.id&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(k)))this.onReceiveData(g,k,f,e)},onReceiveData:function(g,k,f,e){},_onNoData:function(g,k){if(!(0!==this.listenWidgetIds.length&&
0>this.listenWidgetIds.indexOf(k)))this.onNoData(g,k)},onNoData:function(g,k){}})})},"builder/plugins/app-actions/preview-app/_build-generate_module":function(){define(["builder/plugins/app-actions/preview-app/Plugin","dojo/text!builder/plugins/app-actions/preview-app/Plugin.html","dojo/text!builder/plugins/app-actions/preview-app/css/style.css","dojo/i18n!builder/plugins/app-actions/preview-app/nls/strings"],function(){})},"builder/plugins/app-actions/preview-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin dojo/_base/html dojo/on dojo/topic".split(" "),
function(p,g,t,v,n,m){return p([t],{baseClass:"plugin-app-actions-preview-app",postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"click",g.hitch(this,this._onClick)));this._bindEvent();this.mode="config"},_onClick:function(){var g=this.pluginManager.getPluginByName("app-config"),k=this.pluginManager.getPluginByName("popup-actions.configmode-switch");"none"===v.getStyle(this.btnConfig,"display")?(g.switchToPreviewMore(),k.visible=!1,v.setStyle(this.btnPreview,"display","none"),
v.setStyle(this.btnConfig,"display","inline-block"),this.mode="preview"):(k.visible=this.appConfig.templateConfig&&this.appConfig.isTemplateApp||this.appConfig.templateConfig&&this.appConfig._appData?!0:!1,k.isAdvance?g.switchToPreviewConfig():g.switchToTemplateConfigPart(),v.setStyle(this.btnPreview,"display","inline-block"),v.setStyle(this.btnConfig,"display","none"),this.mode="config")},_bindEvent:function(){this.own(m.subscribe("app/appConfigLoaded",g.hitch(this,this._setAppConfig)));this.own(m.subscribe("app/appConfigChanged",
g.hitch(this,this._setAppConfig)))},_setAppConfig:function(g){this.appConfig=g}})})},"builder/plugins/app-actions/save-app/_build-generate_module":function(){define(["builder/plugins/app-actions/save-app/Plugin","dojo/text!builder/plugins/app-actions/save-app/Plugin.html","dojo/text!builder/plugins/app-actions/save-app/css/style.css","dojo/i18n!builder/plugins/app-actions/save-app/nls/strings"],function(){})},"builder/plugins/app-actions/save-app/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic dojo/Deferred dojo/on dojo/promise/all jimu/utils jimu/dijit/Message jimu/dijit/Popup builder/BasePlugin builder/serviceUtils jimu/portalUrlUtils builder/portalUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return p([b],{baseClass:"plugin-app-actions-save-app",lastAppConfig:null,disabled:null,boxNodeOfMainAppActionPlugin:null,boxNodeOfSaveAppPluginInConfigTemplatePage:null,_user:null,_itemGroups:null,postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);var b=c.getStandardPortalUrl(window.portalUrl),e=x.getPortal(b);"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this._blockSaveButton():
(b=e.getUser(),window.isXT?(e=new n,e.resolve()):e=e.getItemById(window.appInfo.id).then(g.hitch(this,function(a){return a.getItemGroups()})),u({user:b,itemGroups:e}).then(g.hitch(this,function(b){this._user=b.user;this._itemGroups=b.itemGroups;a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||this._blockSaveButton()}),g.hitch(this,function(a){this._blockSaveButton();console.log(a)})));this.own(v.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.own(v.subscribe("app/appConfigLoaded",
g.hitch(this,this._onAppConfigLoaded)));this.own(v.subscribe("closeAppConfigPage",g.hitch(this,this._onLeavePage)));this.own(m(this.domNode,"click",g.hitch(this,this._onClick)));this.label=this.nls.label},_onClick:function(){this.saveApp()},_enableSaveButton:function(){t.addClass(this.actionNode,"save-enable");t.removeClass(this.actionNode,"save-disabled");t.setStyle(this.domNode,"cursor","pointer");t.setAttr(this.actionNode,"innerHTML",this.nls.save);t.setAttr(this.actionNode,"title",this.nls.save);
this.disabled=!1},_disableSaveButton:function(){t.removeClass(this.actionNode,"save-enable");t.addClass(this.actionNode,"save-disabled");t.setStyle(this.domNode,"cursor","default");t.setAttr(this.actionNode,"innerHTML",this.nls.saved);t.setAttr(this.actionNode,"title",this.nls.saved);this.disabled=!0},_blockSaveButton:function(){t.addClass(this.actionNode,"save-block");t.setStyle(this.domNode,"cursor","default")},_onAppConfigLoaded:function(a){this.lastAppConfig=g.clone(a);this._setAppConfig(a)},
_onAppConfigChanged:function(a){this.lastAppConfig||(this.lastAppConfig=g.clone(a));this._setAppConfig(a)},_setAppConfig:function(a){this.appConfig=g.clone(a);this._appHasChanged()?(this._enableSaveButton(),this._enableUnloadDlg()):(this._disableSaveButton(),this._disableUnloadDlg())},_appHasChanged:function(){if(!a.canSaveApp(this._user,window.appInfo.appOwner,this._itemGroups)||!this.appConfig)return!1;var b=g.clone(this.appConfig.getCleanConfig()),c=g.clone(this.lastAppConfig.getCleanConfig());
b.theme&&b.theme.styles&&c.theme&&c.theme.styles&&(b.theme.styles.splice(1,b.theme.styles.length),c.theme.styles.splice(1,c.theme.styles.length));return!k.isEqual(b,c)},saveApp:function(){var a=new n;this._appHasChanged()?(t.setAttr(this.actionNode,"innerHTML",this.nls.saving),t.setAttr(this.actionNode,"title",this.nls.saving),this._saveApp().then(g.hitch(this,function(b){b.success?(this._disableSaveButton(),this._disableUnloadDlg(),a.resolve()):a.reject()}),g.hitch(this,function(b){this._enableSaveButton();
a.reject(b)}))):a.resolve();return a},_saveApp:function(){var b=new n,c=this.appConfig;a.saveApp(window.appInfo.id,c.getCleanConfig()).then(g.hitch(this,function(a){a.success?(this.lastAppConfig=g.clone(c),b.resolve(a),(a=this.pluginManager.getPluginByName("app-list"))&&window.isXT&&a.refreshAppPage()):(new f({message:this.nls.saveFailedMeg+": "+a.message}),b.reject())}),g.hitch(this,function(a){new f({message:this.nls.saveFailedMeg});console.error(a);b.reject()}));return b},_enableUnloadDlg:function(){window.onbeforeunload=
g.hitch(this,function(){return this.nls.theApp+' "'+this.options.name+'" '+this.nls.unloadMessage})},_disableUnloadDlg:function(){window.onbeforeunload=null},_onLeavePage:function(a){var b=this.pluginManager.getPluginByName("header");if(this._appHasChanged())var c=new e({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
this.nls.unSaveMegBegin+this.options.name+this.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.toHomeTitle,width:565,height:180,buttons:[{label:this.nls.save,onClick:g.hitch(this,function(){this._saveApp().then(g.hitch(this,function(e){c.close();e.success&&(window.onbeforeunload=null,b.setAppName(""),a())}),g.hitch(this,function(a){console.error(this.nls.saveFailedMeg,a)}))})},{label:this.nls.doNotSave,onClick:g.hitch(this,function(){c.close();window.onbeforeunload=null;b.setAppName("");
a()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){c.close()})}]});else window.onbeforeunload=null,a()}})})},"builder/serviceUtils":function(){define("dojo/_base/lang dojo/request/xhr dojo/Deferred dojo/json dojo/_base/array jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/appConfigResourceUtils jimu/ConfigLoader jimu/Role builder/portalUtils dojo/promise/all builder/tokenUtils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){function w(a){return g("/webappbuilder/rest/signininfo/getsignininfo",
{query:{portalUrl:a},handleAs:"json"})}function q(a){var b=[];a&&0<a.length&&n.forEach(a,function(a){a&&"string"===typeof a&&(a=u.getServerByUrl(a),b.push(a))});return b}function C(a,b,c,e,f,g){b.title=a.name;b.isWebTier=g;b.authorizedCrossOriginDomains=q(f.authorizedCrossOriginDomains);b.portalUrl=c;b.map.itemId=e;b.geometryService=f.helperServices.geometry.url;b.map.mapOptions||(b.map.mapOptions={});"HTML"!==a.appType||a.webmap||(b.map.mapOptions.extent=f.defaultExtent);a="/proxy.js";window.isXT||
(a=u.getPortalProxyUrl(b.portalUrl),a=u.removeProtocol(a));b.httpProxy={useProxy:!0,url:a};f.portalProperties&&f.portalProperties.sharedTheme?(a=f.portalProperties.sharedTheme.header.background?!0:!1,f=f.portalProperties.sharedTheme.logo.small?!0:!1,b.theme?(b.theme.sharedTheme={isPortalSupport:!0,useHeader:a,useLogo:f},a&&(f=b.theme.styles.pop(),b.theme.styles.unshift(f))):b.theme={sharedTheme:{isPortalSupport:!0,useHeader:a,useLogo:f}}):b.theme?b.theme.sharedTheme={isPortalSupport:!1,useHeader:!1,
useLogo:!1}:b.theme={sharedTheme:{isPortalSupport:!1,useHeader:!1,useLogo:!1}}}function z(b,c,e){var f=new t,g=new t,k=u.getStandardPortalUrl(window.portalUrl),m=a.getPortal(k),n={title:b.name,type:"Web Mapping Application",typeKeywords:"Web AppBuilder, Ready To Use, JavaScript, "+("HTML"===b.appType?"WAB2D":"WAB3D"),text:v.stringify(c),snippet:b.description,tags:b.tags,categories:b.categories};m.getUser().then(function(a){b.folderId===a.username&&(b.folderId="");var c={q:"owner:"+a.username+" title:"+
n.title+' type:"Web Mapping Application"'};e?g.resolve(a):m.queryItems(c).then(function(b){0<b.total?(g.reject(),f.resolve({success:!1,unsuccessCode:"01-01"})):g.resolve(a)},function(a){g.reject();f.reject(a)})},function(a){g.reject();f.reject(a)});g.then(function(a){a.addItem(n,b.folderId).then(function(e){if(e.success){if(e.user=a,f.resolve(e),!(c.appConfig&&c.appConfig.templateConfig&&c.appConfig._appData)){var g=u.getStandardPortalUrl(window.portalUrl),g=u.getItemUrl(g,e.id),g=u.removeProtocol(g);
a.addItem({title:b.name,type:"Code Attachment",typeKeywords:"Code, Web Mapping Application, Javascript",relationshipType:"WMA2Code",originItemId:e.id,url:g+"/package"},b.folderId).then(function(a){a.success||console.error(builderNls.createCodeAttachmentError)},function(a){console.error(builderNls.createCodeAttachmentError,a.message)});I.updateAppItemThumbnail(e.id,c.map&&c.map.itemId||c.appConfig.map.itemId)}}else f.resolve(e)},function(a){f.reject(a)})});return f}function E(a){var b=new t;g(window.stemappInfo.name+
"/"+a+"/list.json",{handleAs:"json"}).then(function(c){return B(c,a).then(function(a){b.resolve({success:!0,manifests:a})})},function(a){b.reject({success:!1,message:a.message})});return b}function B(a,b){var e=[],f=new t;a._buildInfo&&a._buildInfo.manifestsMerged?g(window.stemappInfo.name+"/"+b+"/"+b+"-manifest-builder.json",{handleAs:"json"}).then(function(k){var m=[];n.forEach(a[b],function(a){var c;(c="themes"===b?k["themes/"+a+"/main"]:k["widgets/"+a+"/Widget"])?m.push(c):e.push(g(window.stemappInfo.name+
"/"+b+"/"+a+"/manifest.json",{handleAs:"json"}))});c(e).then(function(a){m=m.concat(a);G(m,b).then(function(){f.resolve(m)})})}):(n.forEach(a[b],function(a){e.push(g(window.stemappInfo.name+"/"+b+"/"+a+"/manifest.json",{handleAs:"json"}))}),c(e).then(function(a){G(a,b).then(function(){f.resolve(a)})}));return f}function G(a,b){var e=[],f=new t;n.forEach(a,function(a){a.isRemote||(a.category="widgets"===b?"widget":"theme",p.mixin(a,m.getUriInfo(a.category+"s/"+a.name+"/Widget.js")));e.push(F(a))});
c(e).then(function(){f.resolve()},function(a){f.reject(a)});return f}function F(a){return m.manifest.addI18NLabel(a).then(function(){m.manifest.addManifestProperies(a);m.manifest.processManifestLabel(a,window.dojoConfig.locale);return a})}function D(a){var c=!1;if(a){var e=new b({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&e.setPrivileges(a.privileges);e.isAdmin()&&(c=!0)}return c}var I={},K=["HTML","HTML3D"];I.checkAppVersion=function(a,b){var c=new t;g("/webappbuilder/rest/apps/checkVersion",
{method:"POST",data:{appConfig:v.stringify(a),appType:b.appType},handleAs:"json"}).then(p.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),p.hitch(this,function(a){c.reject(a)}));return c.promise};I.importPortalApp=function(a,b){var c=new t;delete a.agolTemplateInfo;g("/webappbuilder/rest/apps/importportalapp",{method:"POST",handleAs:"json",data:{appConfig:v.stringify(a),appInfo:v.stringify(b)}}).then(p.hitch(this,function(a){a.success?c.resolve(a):c.reject(a)}),p.hitch(this,function(a){c.reject(a)}));
return c.promise};I.getTemplateList=function(b){var c=new t,e=u.getStandardPortalUrl(window.portalUrl),f;isXT?(f=a.getPortal(e),f.getUser().then(function(a){var f=D(a);g((b||f?"/webappbuilder/rest/apps/templatelist?portalUrl\x3d"+e:"/webappbuilder/rest/apps/templatelist?username\x3d"+a.username+"\x26portalUrl\x3d"+e)+"\x26locale\x3d"+dojoConfig.locale,{handleAs:"json"}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)})):c.resolve([]);return c};I.getAppList=function(){var b=
new t,c=u.getStandardPortalUrl(window.portalUrl),e;isXT?(e=a.getPortal(c),e.getUser().then(function(a){a=D(a)?"/webappbuilder/rest/apps/list?portalUrl\x3d"+c:"/webappbuilder/rest/apps/list?username\x3d"+a.username+"\x26portalUrl\x3d"+c;g(a,{handleAs:"json"}).then(function(a){b.resolve(a)},function(a){b.reject(a)})},function(a){b.reject(a)})):(e=a.getPortal(c))?e.getUser().then(function(a){a.getItemsByKeywords("Web AppBuilder").then(function(a){var c=[];(a=a&&a.results)&&0<a.length&&(c=n.map(a,function(a){return{name:a.title,
description:a.description,id:a.id}}));b.resolve(c)},function(a){console.error(a);b.reject({success:!1,message:""})})},function(a){console.error(a);b.reject({success:!1,message:""})}):b.reject({success:!1,message:""});return b};I.getAppInfo=function(b){var c=new t;if(isXT)return-1<K.indexOf(b)?(c.resolve({id:b,appType:b,name:"stem app"}),c):g("/webappbuilder/rest/apps/"+b,{handleAs:"json"});var e=u.getStandardPortalUrl(window.portalUrl);if(-1<K.indexOf(b))return c.resolve({id:b,appType:b,name:"stem app"}),
c;a.getPortal(e).getItemById(b).then(function(a){var b;b=0<=a.typeKeywords.indexOf("Web AppBuilder")?0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML":a.url&&0<=a.url.indexOf("webappviewer3d")?"HTML3D":"HTML";c.resolve({name:a.title,description:a.description,id:a.id,owner:a.owner,appType:b})});return c};I.updateApp=function(b){var c=new t,e=u.getStandardPortalUrl(window.portalUrl);isXT?a.getPortal(e).getUser().then(function(a){g("/webappbuilder/rest/apps/updateapp",{handleAs:"json",method:"POST",
data:{id:b.id,name:b.name,description:b.description,modified:a.username||"",creator:b.creator,thumbnail:b.thumbnail,icon:b.icon,portalUrl:e}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){c.reject(a)}):c.resolve({success:!0});return c};I.createApp=function(b){var e=new t,f,k=u.getStandardPortalUrl(window.portalUrl),m=a.getPortal(k);f=m.loadSelfInfo();var n=m.getUser(),m=null;b.webmap?(m=new t,m.resolve(b.webmap)):b.webscene?(m=new t,m.resolve(b.webscene)):m="HTML3D"===b.appType?
a.getDefaultWebScene(k):a.getDefaultWebMap(k);if(isXT){var q=w(k);f=[f,n,m,q];c(f).then(function(a){var c=a[0],f=a[1],m=a[2];a=a[3];var n={map:{}};C(b,n,u.getStandardPortalUrl(a.info.portalUrl),m,c,a.info.isWebTier?!0:!1);g("/webappbuilder/rest/apps/createapp",{handleAs:"json",method:"POST",data:{name:b.name,description:b.description,creator:f.username||"",modified:f.username||"",extraPropertyOfAppConfig:JSON.stringify(n),portalUrl:k,fromAppId:b.fromAppId,icon:b.icon,thumbnail:b.thumbnail}}).then(function(a){e.resolve(a)},
function(a){e.reject(a)})},function(a){console.error(a);e.reject({success:!1,message:builderNls.createError})})}else n=I.getPredefinedAppConfig(b.appType),q=x.isWebTierPortal(k),f=[f,n,m,q],c(f).then(function(a){var c=a[1];C(b,c,k,a[2],a[0],a[3]);z(b,c,!0).then(function(a){var c=u.getStandardPortalUrl(window.portalUrl);if(a.success)e.resolve({success:!0,newAppId:a.id}),setTimeout(p.hitch(this,function(){a.user.updateItem(a.id,{url:"HTML3D"===b.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+a.id:
c+"/apps/webappviewer/index.html?id\x3d"+a.id}).then(function(a){a.success||console.error(builderNls.createUrlError)},function(a){console.error(builderNls.createUrlError,a.message||"")})}),2E3);else{var f=builderNls.titleExist.replace("${TITLE}",b.name),g;g=b.webmap?c+"/home/webmap/viewer.html?webmap\x3d"+b.webmap:b.webscene?c+"/home/webscene/viewer.html?webmap\x3d"+b.webscene:c+"/home/content.html";switch(a.unsuccessCode){case "01-01":e.resolve({success:!1,message:f,href:g});console.error(builderNls.createError,
f);break;default:e.resolve({success:!1,message:builderNls.createError,href:g}),console.error(builderNls.createError,builderNls.addItemUnsuccess)}}},function(a){e.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")})},function(a){e.reject({success:!1,message:builderNls.createError});console.error(builderNls.createError,a.message||"")});return e};I.duplicateApp=function(b){var c=new t,e=u.getStandardPortalUrl(window.portalUrl);isXT?a.getPortal(e).getUser().then(function(a){g("/webappbuilder/rest/apps/duplicateapp",
{handleAs:"json",method:"POST",data:{fromAppId:b.fromAppId,creator:a.username||"",modified:a.username||"",portalUrl:e}}).then(function(a){c.resolve(a)},function(a){c.reject(a)})},function(a){console.error(builderNls.createError,a);c.reject({message:builderNls.createError})}):c.resolve();return c};I.saveAs=function(b,e){var k=new t,m=u.getStandardPortalUrl(window.portalUrl),n=a.getPortal(m),q=e.getCleanConfig?p.clone(e.getCleanConfig()):p.clone(e);if(isXT)a.getPortal(m).getUser().then(function(a){g("/webappbuilder/rest/apps/"+
b.fromAppId+"/saveas",{handleAs:"json",method:"POST",data:{name:b.name,description:b.description,fromAppId:b.fromAppId,creator:a.username||"",modified:a.username||"",portalUrl:m,appConfig:v.stringify(q),saveAsTemplate:b.saveAsTemplate,thumbnail:b.thumbnail}}).then(function(a){k.resolve(a)},function(a){k.reject(a)})},function(a){console.error(builderNls.createError,a);k.reject({message:builderNls.createError})});else{delete q.agolTemplateInfo;var w=I.switchImageFormatOfAppConfig({appConfig:q}),x=new t,
B=u.getStandardPortalUrl(window.portalUrl),C;e.templateConfig&&e._appData?n.getItemData(b.fromAppId).then(function(a){C="HTML3D"===b.appType?B+"/apps/webappviewer3d/index.html?appid\x3d":B+"/apps/webappviewer/index.html?appid\x3d";a.appConfig=q;a.values.app_title=q.title;a.values.app_subtitle=q.subtitle;a.values.webmap=q.map.itemId;x.resolve(a)},function(a){x.reject({success:!1,message:a.message})}):(C="HTML3D"===b.appType?B+"/apps/webappviewer3d/index.html?id\x3d":B+"/apps/webappviewer/index.html?id\x3d",
x.resolve(q));e=n.getItemById(b.fromAppId);c({itemData:x,item:e}).then(function(a){var c=a.itemData,e=a.item;z(b,c).then(function(a){if(a.success)f.AddResourcesToItemForAppSave(window.portalUrl,w.result,c.appItemId,a.id).then(function(){k.resolve({success:!0,newAppId:a.id})},function(a){k.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")}),setTimeout(p.hitch(this,function(){C+=a.id;c.appItemId=a.id;a.user.updateItem(a.id,{url:C,typeKeywords:e.typeKeywords.join(","),
text:v.stringify(c)}).then(function(a){},function(a){console.error(builderNls.duplicateUrlError,a.message||"")})}),2E3);else{var d=builderNls.titleExist.replace("${TITLE}",b.name);switch(a.unsuccessCode){case "01-01":k.resolve({success:!1,message:d});console.error(builderNls.saveAsError,d);break;default:k.resolve({success:!1,message:builderNls.saveAsError}),console.error(builderNls.saveAsError,builderNls.addItemUnsuccess)}}},function(a){k.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,
a.message||"")})},function(a){k.reject({success:!1,message:builderNls.saveAsError});console.error(builderNls.saveAsError,a.message||"")})}return k};I.removeApp=function(a){if(isXT)return g("/webappbuilder/rest/apps/removeapp",{handleAs:"json",method:"POST",data:{id:a}})};I.updateAppItemThumbnail=function(b,e){var f=new t,g=u.getStandardPortalUrl(window.portalUrl),k=a.getPortal(g),n=k.credential.token,p=window.appConfig&&window.appConfig.map.portalUrl||window.portalUrl,p=u.getStandardPortalUrl(p),
q=a.getPortal(p),w=k.getUser(),k=k.getItemById(b);e=q.getItemById(e);c({user:w,appItemInfo:k,mapItemInfo:e}).then(function(a){var c=a.user,e=a.appItemInfo;a=a.mapItemInfo;e.properties||(e.properties={});a&&a.thumbnailUrl?e.thumbnail&&e.properties.lastUpdatedThumbnailUrlByWab&&(0!==e.thumbnail.indexOf("thumbnail/ago_downloaded")||m.url.compareUrl(a.thumbnailUrl,e.properties.lastUpdatedThumbnailUrlByWab))?f.resolve():(e.properties.lastUpdatedThumbnailUrlByWab=m.url.getUrlPath(a.thumbnailUrl),a=I.getWiderThumbnailUrl(e.properties.lastUpdatedThumbnailUrlByWab),
c.updateItem(b,{thumbnailUrl:I.getThumbnailUrl(g,p,a,n),properties:v.stringify(e.properties)}).then(function(){f.resolve()},function(){f.resolve()})):f.resolve()});return f};I.getThumbnailUrl=function(a,b,c,e){return a===b?m.url.addQueryParamToUrl(c,"token",e):c};I.getWiderThumbnailUrl=function(a){return m.url.addQueryParamToUrl(a,"w",400)};I.removeWiderThumbnailUrl=function(a){return m.url.removeQueryParamFromUrl(a,"w")};I.saveApp=function(b,e){var k=new t,m=u.getStandardPortalUrl(window.portalUrl),
x=a.getPortal(m),B=x.getUser(),z;e.authorizedCrossOriginDomains=q(x.authorizedCrossOriginDomains);isXT?(z=w(m),c({user:B,signininfo:z}).then(function(a){e.portalUrl=u.getStandardPortalUrl(a.signininfo.info.portalUrl);g("/webappbuilder/rest/apps/"+b+"/saveconfig",{data:{appConfig:v.stringify(e),modified:a.user.username},method:"POST",handleAs:"json"}).then(function(a){k.resolve(a)},function(a){k.reject(a)})},function(a){k.reject(a)})):B.then(function(a){x.getItemData(b).then(function(c){var g,q;e.templateConfig&&
e._appData?(g=c.appConfig,q=c,q.appConfig=e,q.values.app_title=e.title,q.values.app_subtitle=e.subtitle,q.values.webmap=e.map.itemId):(g=c,q=e);c=I.switchImageFormatOfAppConfig({appConfig:q});var w=[],x=[];n.forEach(c.result,function(a){a.b64&&x.push(a);w.push(a.resUrl)});f.AddResourcesToItemForAppSave(m,x,window.appInfo.id).then(p.hitch(this,function(){I.removeUnusedResources(w,m,b).then(p.hitch(this,function(){e.agolTemplateInfo=g?g.agolTemplateInfo:null;e.portalUrl=m;q.appItemId=b;a.updateItem(b,
{text:v.stringify(q)}).then(function(a){k.resolve({success:!0,newAppId:a.id});I.updateAppItemThumbnail(b,e.map.itemId)})}),function(a){k.reject({success:!1,message:a.message})})}),function(a){k.reject({success:!1,message:a.message})})});x.getItemById(b,!0).then(p.hitch(this,function(c){c.url&&""!==c.url?c=c.url:(c=u.getStandardPortalUrl(window.portalUrl),c="HTML3D"===window.appInfo.appType?c+"/apps/webappviewer3d/index.html?id\x3d"+b:c+"/apps/webappviewer/index.html?id\x3d"+b,a.updateItem(b,{url:c}).then(function(a){}))}))},
function(a){k.reject({success:!1,message:a.message})});return k};I.getPredefinedAppConfig=function(a){return g(("HTML"===a?"stemapp":"HTML3D"===a?"stemapp3d":window.stemappInfo.name)+"/predefined-apps/default/config.json",{handleAs:"json"})};I.copyThemeToApp=function(a,b,c){if(isXT)return-1<K.indexOf(a)?(a=new t,a.resolve({success:!0}),a):g("/webappbuilder/rest/apps/"+a+"/copytheme",{handleAs:"json",method:"POST",data:{themeName:b,layoutConfig:JSON.stringify(c)}});a=new t;a.resolve({success:!0});
return a};I.copyWidgetToApp=function(a,b){var c=new t;if(b.isRemote)return c.resolve({success:!0}),c;if(isXT)return-1<K.indexOf(a)?(c=new t,c.resolve({success:!0}),c):g.post("/webappbuilder/rest/apps/"+a+"/copywidget",{data:{widgetName:b.name},handleAs:"json"});c=new t;c.resolve({success:!0});return c};I.getAllThemes=function(){if(isXT)return g("/webappbuilder/rest/themes/search?q\x3d"+JSON.stringify({platform:window.stemappInfo.appType}),{handleAs:"json"}).then(function(a){n.forEach(a.themes,function(a){m.manifest.processManifestLabel(a,
window.dojoConfig.locale)},this);return a});var a=new t;E("themes").then(function(b){n.forEach(b.manifests,function(a){m.manifest.processManifestLabel(a,window.dojoConfig.locale)},this);a.resolve({success:!0,themes:b.manifests})},function(b){a.reject(b)});return a};I.searchWidgets=function(a){if(isXT)return g("/webappbuilder/rest/widgets/search?q\x3d"+JSON.stringify(a),{handleAs:"json"}).then(function(a){a.widgets&&a.widgets.forEach(function(a){p.mixin(a,m.getUriInfo("widgets/"+a.name+"/Widget"));
m.manifest.processManifestLabel(a,window.dojoConfig.locale)});a.widgets=a.widgets.sort(function(a,b){return a.label.localeCompare(b.label,window.dojoConfig.locale)});if(!u.isOnline(window.portalUrl)){var b=!0;window.portalVersion&&0<=k.comparePortalVersion(window.portalVersion,"3.10")&&(b=!1);var c=n.filter(a.widgets,function(a){return"Analysis"===a.name&&b?!1:!0});a.widgets=c}return a});var b=new t;E("widgets").then(function(c){var e=[];n.forEach(c.manifests,function(b){if("undefined"===typeof a["properties.inPanel"]||
a["properties.inPanel"]===b.properties.inPanel)a.support2D!==b.support2D&&a.support3D!==b.support3D||e.push(b)});e=e.sort(function(a,b){return a.label.localeCompare(b.label,window.dojoConfig.locale)});b.resolve({success:!0,widgets:e})},function(a){b.reject(a)});return b};I.getManifestFromItem=function(a){var b=m.widgetJson.getFolderUrlFromItem(a)+"manifest.json";return g(b,{handleAs:"json",headers:{"X-Requested-With":null}}).then(function(b){b.isRemote=!0;b.category="widget";b.itemId=a.id;p.mixin(b,
m.getUriInfo(m.widgetJson.getUriFromItem(a)));return F(b)})};I.saveAgolTemplate=function(b,c){var e=new t,f=u.getStandardPortalUrl(window.portalUrl);if(isXT)g("/webappbuilder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:b.id,agolTemplateInfo:v.stringify(c)}}).then(p.hitch(this,function(a){!0===a.success?e.resolve():(console.error("The response of save agol template is 'unsuccess'!"),e.reject("The response of save agol template is 'unsuccess'!"))}),function(a){console.error(a.message||
a);e.reject("Save AGOLTemplate failed!")});else{var k=a.getPortal(f);k.getUser().then(function(a){k.getItemData(b.id).then(function(f){delete f.agolTemplateJson;f.agolTemplateInfo=c;a.updateItem(b.id,{text:v.stringify(f)}).then(function(){e.resolve()},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when updateItem!")})},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when get app's itemData!")})},function(a){console.error(a.message||a);e.reject("Save AGOLTemplate failed when get current user!")})}return e};
I.canSaveApp=function(a,c,e){var f=!1;if(a){var g=new b({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&g.setPrivileges(a.privileges);if(window.isXT)g.isAdmin()?f=!0:a.username===c&&(f=!0);else if(g.isAdmin())f=!0;else if(a.username===c&&g.canCreateItem())f=!0;else if(g.canCreateItem()){var k;k=e?[].concat(e.admin,e.member,e.other):[];n.some(a.groups,function(a){return-1<a.capabilities.indexOf("updateitemcontrol")?n.some(k,function(b){return a.id===b.id?f=!0:!1}):!1})}}return f};I.switchImageFormatOfAppConfig=
function(b,c){function f(a,b){var c=a.obj,e=a.key;"number"===typeof a.i?c[e][a.i]=b:c[e]=b}function g(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(a)}function k(a,b){a=e.getInstance().processItemIDAndTokenOfResources(b.value,a);return m.getBase64Data(a).then(function(a){f(b,a)})}var n=b.appConfig;b=b.appId?b.appId:window.appInfo.id;var q=u.getStandardPortalUrl(window.portalUrl),w={appId:b};"undefined"!==typeof n.appConfig&&(n=n.appConfig);"undefined"!==
typeof n._wabAppId&&(w.wabAppId=n._wabAppId);var x={},t={appId:b,portalUrl:q};if("import"===c)return x={test:g,func:p.hitch(this,k,t)},a.getPortal(q).getItemById(b).then(p.hitch(this,function(a){t.isPublic="public"===a.access;return m.processItemResourceOfAppConfig(n,x)}));x={test:p.hitch(this,function(a,b){var c;(c=/^data:image\/(png|jpg|jpeg|gif);base64,/.test(b))||(c=a.wabAppId,a="^https?://(.)+/sharing/rest/content/items/("+a.appId,c&&(a+="|"+c),c=(new RegExp(a+")/resources/inConfig/")).test(b));
return c},w),func:p.hitch(this,function(a,b){if(/^data:image\/(png|jpg|jpeg|gif);base64,/.test(b.value)){var c=b.value.match(/^data:image\/(png|jpg|jpeg|gif)/)[1],c="."+c,e=m.getRandomString();a=u.getItemResourceUrl(a.portalUrl,"${itemId}","inConfig/"+(e+c));f(b,a);return{resUrl:a,b64:b.value}}if(/^https?:\/\/(.)+\/sharing\/rest\/content\/items/.test(b.value))return a=b.value,/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,"")),f(b,a.replace(/items\/.+\/resources/,"items/${itemId}/resources")),
{resUrl:a}},t)};return m.processItemResourceOfAppConfig(n,x)};I.removeUnusedResources=function(b,e,f){b=b?b:[];0!==b.length&&(b=n.map(b,function(a){/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));return a.split("resources/")[1]}));return a.getItemResources(e,f).then(function(g){g=n.map(g,function(a){return a.resource});g=g.filter(function(a){return-1<a.indexOf("inConfig/")});g=g.filter(function(a){return 0>b.indexOf(a)});if(0===g.length)return g=new t,g.resolve(),g;if(g instanceof Array&&
0<g.length)return g=n.map(g,function(b){return a.removeResources(e,f,b)}),c(g).then(function(a){if(a instanceof Array&&0<a.length&&a[0].success)return a})})};return I})},"jimu/appConfigResourceUtils":function(){define(["dojo/Deferred","dojo/promise/all","jimu/portalUtils","jimu/utils"],function(p,g,t,v){return{AddResourcesToItemForAppSave:function(n,m,u,k){m=m||[];if(0===m.length){var f=new p;f.resolve(m);return f}m=m.map(function(e){var b=e.resUrl.split("resources/")[1],a=new p;e.b64?(e=v.b64toBlob(e.b64),
a.resolve({blob:e,fileName:b.split("/")[1],prefixName:b.split("/")[0]})):(e=e.resUrl,0<e.indexOf("${itemId}")&&(e=e.replace("${itemId}",u)),v.resourcesUrlToBlob(e).then(function(c){a.resolve({blob:c,fileName:b.split("/")[1],prefixName:b.split("/")[0]},function(b){console.error(b.message||b);a.reject(b)})}));return a});return g(m).then(function(e){if(e instanceof Array&&0<e.length)return e=e.map(function(b){var a=u;k&&(a=k);return t.addResource(n,a,b.blob,b.fileName,b.prefixName)}.bind(this)),g(e).then(function(b){return b})}.bind(this))}}})},
"jimu/ConfigLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr ./utils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./appConfigResourceUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){var F=null,D;D=p(null,{urlParams:null,appConfig:null,rawAppConfig:null,
configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a,c){this._removeHash(a);this.urlParams=a||{};this.widgetManager=b.getInstance();g.mixin(this,c)},loadConfig:function(){console.time("Load Config");return this._tryLoadConfig().then(g.hitch(this,function(a){var b=this.checkConfig(a);if(b)throw Error(b);this.rawAppConfig=g.clone(a);C.getInstance().setRawAppConfig(this.rawAppConfig);a=this._upgradeAppConfig(a);this._processAfterTryLoad(a);this.appConfig=a;if(this.urlParams.id)return this.loadWidgetsManifest(a).then(g.hitch(this,
function(){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(g.hitch(this,function(a){return this.updateNecessaryAttrOfResourceUrlInAppConfig(a,this.urlParams.id)})).then(g.hitch(this,function(){this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}));c.setPortalUrl(a.portalUrl);G.arcgisUrl=q.getBaseItemUrl(a.portalUrl);return this._proesssWebTierAndSignin(a).then(g.hitch(this,function(){if(this.urlParams.appid){if(window.appInfo.isRunInPortal){var b=
q.getStandardPortalUrl(a.portalUrl),b=x.getPortal(b);return e.checkEssentialAppsLicense(this.urlParams.appid,b,c.isInBuilderWindow()).then(g.hitch(this,function(){return this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(g.hitch(this,function(a){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)}))}),g.hitch(this,function(a){console.error(a);throw Error(window.jimuNls.essentialAppsLicenseErrorForApp);}))}return this._processNotInPortalAppProtocol(a).then(g.hitch(this,
function(a){return this._getAppDataAddTemplateDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(g.hitch(this,function(b){b.appData.appConfig&&(a=b.appData.appConfig);a._appData=b.appData;a.templateConfig=b.templateData;a.isTemplateApp=!0;return a}))}))}return this._processNotInPortalAppProtocol(a)})).then(g.hitch(this,function(a){this._processAfterTryLoad(a);this.appConfig=a;return a.map.itemId?a:(a.map["3D"]?x.getDefaultWebScene(a.portalUrl):x.getDefaultWebMap(a.portalUrl)).then(function(b){a.map.itemId=
b;return a})})).then(g.hitch(this,function(a){return this.loadWidgetsManifest(a)})).then(g.hitch(this,function(a){return a._appData?a._appData.values&&a._appData.values.webmap?x.getPortal(a.portalUrl).getItemById(a._appData.values.webmap).then(g.hitch(this,function(b){return e.template.mergeTemplateAppConfigToAppConfig(a,a._appData,b)})):e.template.mergeTemplateAppConfigToAppConfig(a,a._appData):a})).then(g.hitch(this,function(a){return this.loadAndUpgradeAllWidgetsConfig(a)})).then(g.hitch(this,
function(a){return a._wabAppId?this.processResourceInAppConfigForConfigLoader(a,this.urlParams):a.appItemId&&-1<window.JSON.stringify(a).indexOf("${itemId}")?this.updateNecessaryAttrOfResourceUrlInAppConfig(a,a.appItemId):a})).then(g.hitch(this,function(a){this.appConfig=a;this._configLoaded=!0;this._setDocumentTitle(a);this._readAndSetSharedTheme(a);return this.getAppConfig()}))}),g.hitch(this,function(a){var b=new u;b.reject(a);return b}))},processResourceInAppConfigForConfigLoader:function(a,b){var c=
a.portalUrl,e=a.appItemId,f=b.appid,k=new u,m=g.clone(a);this.updateNecessaryAttrOfResourceUrlInAppConfig(m,f).then(function(){if("config"===b.mode){var g=this.getResourceUrlsOfAppConfig(a).result;0!==g.length?x.getItemResources(c,f).then(function(a){if(0===a.length)return g=g.map(function(a){return{resUrl:a}}),w.AddResourcesToItemForAppSave(c,g,e,f).then(function(){k.resolve(m)},function(a){console.warn("Add resource to template based app error:"+a.message||a);k.resolve(m)});k.resolve(m)},function(a){console.warn("Get resource of template based item error:"+
a.message||a);k.resolve(m)}):k.resolve(m)}else k.resolve(m)}.bind(this),function(a){console.warn("Insert appId to resource url of appConfig error:"+a.message||a);k.resolve(m)});return k},getResourceUrlsOfAppConfig:function(a){var b={test:function(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(a)},func:g.hitch(this,function(a){return a.value})};return e.processItemResourceOfAppConfig(a,b)},updateNecessaryAttrOfResourceUrlInAppConfig:function(a,b){function c(a){return/^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(a)}
function f(a,b){a=m.processItemIDAndTokenOfResources(b.value,a);a=m.setResouceProtocolForHttps(a);var c=b.obj,e=b.key;"number"===typeof b.i?c[e][b.i]=a:c[e]=a;return!0}var k=a.portalUrl,m=this;return x.getPortal(k).getItemById(b).then(g.hitch(this,function(m){m={test:c,func:g.hitch(this,f,{appId:b,isPublic:"public"===m.access,portalUrl:k})};return e.processItemResourceOfAppConfig(a,m).appConfig}))},setResouceProtocolForHttps:function(a){var b=a;"https:"===window.location.protocol&&(b=a.replace(/^http(s?):\/\//i,
"https://"));return b},processItemIDAndTokenOfResources:function(a,b){0<a.indexOf("${itemId}")&&(a=a.replace("${itemId}",b.appId));/(\?|\&)token=.+/.test(a)&&(a=a.replace(/(\?|\&)token=.+/,""));b.isPublic||(b=c.getPortalCredential(b.portalUrl))&&(a+="?token\x3d"+b.token);return a},_setDocumentTitle:function(a){!window.isBuilder&&a&&a.title&&(document.title=e.stripHTML(a.title))},getAppConfig:function(){var a=g.clone(this.appConfig);a.getConfigElementById=function(a){return e.getConfigElementById(this,
a)};a.getConfigElementsByName=function(a){return e.getConfigElementsByName(this,a)};a.visitElement=function(a){e.visitElement(this,a)};this._addAuthorizedCrossOriginDomains(this.portalSelf,a);return a},_addAuthorizedCrossOriginDomains:function(a,b){a&&a.authorizedCrossOriginDomains&&c.addAuthorizedCrossOriginDomains(a.authorizedCrossOriginDomains);b&&b.authorizedCrossOriginDomains&&c.addAuthorizedCrossOriginDomains(b.authorizedCrossOriginDomains)},checkConfig:function(){return!1},processProxy:function(a){E.defaults.io.alwaysUseProxy=
a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;E.defaults.io.proxyUrl="";E.defaults.io.proxyRules=[];a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.url&&(E.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.rules&&t.forEach(a.httpProxy.rules,function(a){B.addProxyRule(a)})},addNeedValues:function(a){this._processNoUriWidgets(a);this._processEmptyGroups(a);this._addElementId(a);this._fixRepeatedId(a)},showError:function(a){a&&a.message&&(v.create("div",
{"class":"app-error",innerHTML:e.sanitizeHTML(a.message)},document.body),v.setStyle(jimuConfig.loadingId,"display","none"))},_tryLoadConfig:function(){"stemapp"===this.urlParams.id&&(this.urlParams.config=window.appInfo.appPath+"config.json",delete this.urlParams.id);if(this.urlParams.config)return this.configFile=this.urlParams.config,f(this.configFile,{handleAs:"json",headers:{"X-Requested-With":null}}).then(g.hitch(this,function(a){c.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);
return this.urlParams.token?c.registerToken(this.urlParams.token).then(function(){return a}):a}));if(this.urlParams.id){window.appInfo.isRunInPortal=!0;var a=q.getPortalUrlFromLocation(),b=new u;c.setPortalUrl(a);window.portalUrl=a;G.arcgisUrl=q.getBaseItemUrl(a);var k;this.urlParams.token?k=c.registerToken(this.urlParams.token):(k=new u,k.resolve());k.then(g.hitch(this,function(){var f=x.getPortal(a);f.loadSelfInfo().then(g.hitch(this,function(k){this.portalSelf=k;k.allSSL&&"http:"===window.location.protocol?
(console.log("redirect from http to https"),window.location.href=q.setHttpsProtocol(window.location.href),b.reject()):this._processSignIn(a).then(g.hitch(this,function(){this._getAppConfigFromAppId(a,this.urlParams.id).then(g.hitch(this,function(a){return e.checkEssentialAppsLicense(this.urlParams.id,f,c.isInBuilderWindow()).then(g.hitch(this,function(){this._tryUpdateAppConfigByLocationUrl(a);return this._processInPortalAppProtocol(a)}),g.hitch(this,function(a){console.error(a);throw Error(window.jimuNls.essentialAppsLicenseErrorForApp);
}))})).then(function(a){b.resolve(a)},function(a){b.reject(a)})}))}))}),g.hitch(this,function(a){this.showError(a)}));return b}this.configFile="config.json";return f(this.configFile,{handleAs:"json"}).then(g.hitch(this,function(a){c.setPortalUrl(a.portalUrl);a.portalUrl&&(window.portalUrl=a.portalUrl);return this.urlParams.token?c.registerToken(this.urlParams.token).then(function(){return a}):a}))},_upgradeAppConfig:function(a){var b=window.wabVersion,c=a.wabVersion;a.configWabVersion=a.wabVersion;
if(b===c)return a;var e=this.versionManager.getVersionIndex(c),f=this.versionManager.getVersionIndex(b);if(e>f)throw Error("Bad version number, "+c);a=this.versionManager.upgrade(a,c,b);a.wabVersion=b;return a},loadAndUpgradeAllWidgetsConfig:function(b){var c=new u,e=[];a.visitElement(b,g.hitch(this,function(a){a.uri&&(a=this.widgetManager.tryLoadWidgetConfig(a),e.push(a))}));k(e).then(g.hitch(this,function(){c.resolve(b)}),function(a){c.reject(a)});return c},_processAfterTryLoad:function(a){this._setPortalUrl(a);
this._tryUpdateAppConfigByLocationUrl(a);this._processUrlParams(a);this.addNeedValues(a);this.processProxy(a);z.tokenValidity=10080;return a},_readAndSetSharedTheme:function(a){a.theme.sharedTheme||(a.theme.sharedTheme={useHeader:!1,useLogo:!1},a.theme.sharedTheme.isPortalSupport=this.portalSelf.portalProperties&&this.portalSelf.portalProperties.sharedTheme?!0:!1);a.theme.sharedTheme.useHeader&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.theme.customStyles={mainBackgroundColor:this.portalSelf.portalProperties.sharedTheme.header.background},
a.titleColor=this.portalSelf.portalProperties.sharedTheme.header.text):console.error("Portal does not support sharedTheme."));a.theme.sharedTheme.useLogo&&(a.theme.sharedTheme.isPortalSupport&&this.portalSelf.portalProperties?(a.logo=this.portalSelf.portalProperties.sharedTheme.logo.small?this.portalSelf.portalProperties.sharedTheme.logo.small:"images/app-logo.png",!a.logoLink&&this.portalSelf.portalProperties.sharedTheme.logo.link&&(a.logoLink=this.portalSelf.portalProperties.sharedTheme.logo.link)):
(console.error("Portal does not support sharedTheme, use default logo."),a.logo="images/app-logo.png"))},_tryUpdateAppConfigByLocationUrl:function(a){if(!(this.urlParams.config&&-1<this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))){var b=q.getPortalUrlFromLocation(),b=q.getStandardPortalUrl(b);q.isOnline(b)&&(b=q.updateUrlProtocolByOtherUrl(b,a.portalUrl),a.map.portalUrl&&q.isSamePortalUrl(a.portalUrl,a.map.portalUrl)&&(a.map.portalUrl=b),a.portalUrl=b,a.httpProxy&&a.httpProxy.url&&
(a.httpProxy.url=q.getPortalProxyUrl(b)))}},_processWidgetJsons:function(b){a.visitElement(b,function(a,b){b.isWidget&&a.uri&&e.widgetJson.processWidgetJson(a)})},_processNoUriWidgets:function(b){var c=0;a.visitElement(b,function(a,b){b.isWidget&&!a.uri&&(c++,a.placeholderIndex=c)})},_processEmptyGroups:function(a){var b=0;a.widgetOnScreen.groups&&t.forEach(a.widgetOnScreen.groups,function(a){if(!a.widgets||a.widgets&&0===a.widgets.length)b++,a.placeholderIndex=b})},_addElementId:function(b){var c=
0,e;a.visitElement(b,function(a){if(a.id){a.id=a.id.replace(/\//g,"_");var b=a.id.lastIndexOf("_");-1<b&&(e=a.id.substr(b+1),c=Math.max(c,e))}});a.visitElement(b,function(a){a.id||(c++,a.id=a.itemId?a.itemId+"_"+c:a.uri?a.uri.replace(/\//g,"_")+"_"+c:"_"+c)})},_setPortalUrl:function(a){if(a.portalUrl){var b=q.getPortalUrlFromLocation(),c=q.isOnline(b);q.isSamePortalUrl(a.portalUrl,b)||c||(window.appInfo.isRunInPortal=!1)}else window.isXT&&m("wab_portalurl")?a.portalUrl=m("wab_portalurl"):(window.appInfo.isRunInPortal=
!0,a.portalUrl=q.getPortalUrlFromLocation())},_changePortalUrlProtocol:function(a,b){a.portalUrl=q.setProtocol(a.portalUrl,b);a.map.portalUrl&&(a.map.portalUrl=q.setProtocol(a.map.portalUrl,b));a.httpProxy&&(a.httpProxy.url=q.setProtocol(a.httpProxy.url,b),a.httpProxy&&a.httpProxy.rules&&t.forEach(a.httpProxy.rules,g.hitch(this,function(a){a.proxyUrl=q.setProtocol(a.proxyUrl,b)})))},_processInPortalAppProtocol:function(a){var b=new u,c=x.getPortal(a.portalUrl),e=g.hitch(this,function(c){if("https:"===
window.location.protocol)this._changePortalUrlProtocol(a,"https");else{if(c){console.log("redirect from http to https");window.location.href=q.setHttpsProtocol(window.location.href);b.reject();return}this._changePortalUrlProtocol(a,"http")}this._checkLocale();b.resolve(a)});c.loadSelfInfo().then(g.hitch(this,function(b){this.portalSelf=b;"private"===b.access?(b=0===a.portalUrl.toLowerCase().indexOf("https://"),e(b)):e(b.allSSL)}),g.hitch(this,function(a){b.reject(a)}));return b},_processNotInPortalAppProtocol:function(a){var b=
new u;a.portalUrl?x.getPortal(a.portalUrl).loadSelfInfo().then(g.hitch(this,function(e){this.portalSelf=e;var f="https:"===window.location.protocol;(e.allSSL||f)&&this._changePortalUrlProtocol(a,"https");0!==a.portalUrl.toLowerCase().indexOf("https://")||f||c.isInConfigOrPreviewWindow()?b.resolve(a):(console.log("redirect from http to https"),window.location.href=q.setHttpsProtocol(window.location.href),b.reject())}),g.hitch(this,function(a){b.reject(a)})):b.resolve(a);return b},_proesssWebTierAndSignin:function(a){var b=
new u,c=!1,e=a.portalUrl;this._processWebTier(a).then(g.hitch(this,function(a){c=a;return x.getPortal(e).loadSelfInfo()})).then(g.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(e,c)})).then(g.hitch(this,function(){b.resolve()}),function(a){b.reject(a)});return b},_processWebTier:function(a){var b=new u,e=a.portalUrl;a.isWebTier?(c.addAuthorizedCrossOriginDomains([e]),c.isWebTierPortal(e).then(g.hitch(this,function(){var f=c.getPortalCredential(e);f&&f.ssl&&"http:"===window.location.protocol&&
!c.isInConfigOrPreviewWindow()?(console.log("redirect from http to https"),window.location.href=q.setHttpsProtocol(window.location.href)):b.resolve(a.isWebTier)}),g.hitch(this,function(a){b.reject(a)}))):b.resolve(!1);return b},_processSignIn:function(a,b){var e=new u,f=x.getPortal(a),k=q.getSharingUrl(a);window.appInfo.isRunInPortal?(b=z.checkSignInStatus(k),b.promise.always(g.hitch(this,function(){e.resolve()}))):(!c.isInBuilderWindow()&&!c.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&
this.rawAppConfig&&this.rawAppConfig.appId&&!b&&c.registerOAuthInfo(a,this.rawAppConfig.appId),b=z.checkSignInStatus(k),b.promise.always(g.hitch(this,function(){c.xtGetCredentialFromCookie(a);f.loadSelfInfo().then(g.hitch(this,function(a){this.portalSelf=a;this._checkLocale();e.resolve()}))})));return e},_checkLocale:function(){if(!c.isInConfigOrPreviewWindow()){var a=this.portalSelf.user&&this.portalSelf.user.culture||n.locale,a=a.toLowerCase();!this.urlParams.locale&&e.isLocaleChanged(n.locale,
a)&&(m("wab_app_locale",a),window.location.reload())}},_getAppConfigFromTemplateAppId:function(a,b){var c=x.getPortal(a);return this._getWabAppIdAndDataFromTemplateAppId(a,b).then(g.hitch(this,function(b){var e=b.appId,f=b.appData;return k([this._getAppConfigFromAppId(a,e),c.getItemData(f.source)]).then(g.hitch(this,function(a){var b;f.appConfig?(b=f.appConfig,delete f.appConfig):b=a[0];b=this._upgradeAppConfig(b);a=a[1];b._appData=f;b._wabAppId=e;b.templateConfig=a;b.isTemplateApp=!0;return b}))}))},
_getAppDataAddTemplateDataFromTemplateAppId:function(a,b){var c=x.getPortal(a);return c.getItemData(b).then(function(a){return c.getItemData(a.source).then(function(b){return{appData:a,templateData:b}})})},_getWabAppIdAndDataFromTemplateAppId:function(a,b){var c=new u,e=x.getPortal(a);e.getItemData(b).then(g.hitch(this,function(a){e.getItemById(a.source).then(g.hitch(this,function(b){b=B.urlToObject(b.url);c.resolve({appId:b.query.id,appData:a})}))}),function(a){c.reject(a)});return c},_getAppConfigFromAppId:function(a,
b){return x.getPortal(a).getItemData(b)},_removeHash:function(a){for(var b in a)a[b]&&(a[b]=a[b].replace("#",""))},loadWidgetsManifest:function(b){function c(a,c,g){function k(c){return a.loadWidgetManifest(c).then(function(a){return a},function(a){console.log("Widget failed to load, it is removed.",c.name);a.stack?console.error(a.stack):console.log(a);f(b,c)})}return c.itemId?x.getPortal(g).getItemById(c.itemId).then(function(a){c.uri=e.widgetJson.getUriFromItem(a);return k(c)},function(a){console.log("Widget is not loaded, it is removed.",
c.name,a);f(b,c)}):k(c)}function f(a,b){function c(c){a[c]&&a[c].widgets&&(a[c].widgets=a[c].widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}));a[c]&&a[c].groups&&a[c].groups.forEach(function(a){a.widgets&&(a.widgets=a.widgets.filter(function(a){if(b)return a.id!==b.id;a.uri&&!a.manifest&&console.error("Widget is removed because it is not loaded successfully.",a.uri);return a.manifest}))})}
c("widgetOnScreen");c("widgetPool")}var m=[],n=new u;this.urlParams.manifest&&b._buildInfo&&b._buildInfo.widgetManifestsMerged&&delete b._buildInfo.widgetManifestsMerged;b._buildInfo&&b._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(g.hitch(this,function(f){a.visitElement(b,g.hitch(this,function(a){a.widgets||!a.uri&&!a.itemId||(a.uri&&f[a.uri]?(this._addNeedValuesForManifest(f[a.uri],a.uri),e.widgetJson.addManifest2WidgetJson(a,f[a.uri])):m.push(c(this.widgetManager,a,b.portalUrl)))}));
k(m).then(function(){n.resolve(b)})})):(a.visitElement(b,g.hitch(this,function(a){a.widgets||!a.uri&&!a.itemId||m.push(c(this.widgetManager,a,b.portalUrl))})),k(m).then(function(){n.resolve(b)}));setTimeout(function(){n.isResolved()||(f(b),n.resolve(b))},6E4);return n},_addNeedValuesForManifest:function(a,b){g.mixin(a,e.getUriInfo(b));e.manifest.addManifestProperies(a);e.manifest.processManifestLabel(a,n.locale)},_loadMergedWidgetManifests:function(){return f(window.appInfo.appPath+"widgets/widgets-manifest.json",
{handleAs:"json"})},_fixRepeatedId:function(b){var c=[];a.visitElement(b,function(a){0<=c.indexOf(a.id)&&(a.id+="_");c.push(a.id)})},_processUrlParams:function(a){var b=this.urlParams.itemid||this.urlParams.webmap;b&&a.map.itemId!==b&&(a.map.mapOptions&&e.deleteMapOptions(a.map.mapOptions),a.map.itemId=b);this.urlParams.mode&&(a.mode=this.urlParams.mode);a.map.mapOptions||(a.map.mapOptions={});this.urlParams.scale&&(a.map.mapOptions.scale=this.urlParams.scale);if(this.urlParams.level||this.urlParams.zoom)a.map.mapOptions.zoom=
this.urlParams.level||this.urlParams.zoom}});D.getInstance=function(a,b){null===F?F=new D(a,b):(F.urlParams=a||{},F.options=b);return F};return D})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dijit/Tooltip dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all dijit/registry ./utils jimu/tokenUtils ./dijit/Message ./DataSourceManager".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,
a,c,x,w,q,C,z,E){var B=null,G=p(u,{constructor:function(){this.loaded=[];this.missedActions=[];this.activeWidget=null;window.isBuilder?(m.subscribe("app/mapLoaded",g.hitch(this,this._onMapLoaded)),m.subscribe("app/mapChanged",g.hitch(this,this._onMapChanged))):(m.subscribe("mapLoaded",g.hitch(this,this._onMapLoaded)),m.subscribe("mapChanged",g.hitch(this,this._onMapChanged)));window.isBuilder?(m.subscribe("app/sceneViewLoaded",g.hitch(this,this._onSceneViewLoaded)),m.subscribe("app/sceneViewChanged",
g.hitch(this,this._onSceneViewChanged))):(m.subscribe("sceneViewLoaded",g.hitch(this,this._onSceneViewLoaded)),m.subscribe("sceneViewChanged",g.hitch(this,this._onSceneViewChanged)));window.isBuilder?(m.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)),m.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged))):(m.subscribe("appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)),m.subscribe("appConfigChanged",g.hitch(this,this._onAppConfigChanged)));m.subscribe("userSignIn",
g.hitch(this,this._onUserSignIn));m.subscribe("userSignOut",g.hitch(this,this._onUserSignOut));m.subscribe("builder/actionTriggered",g.hitch(this,this._onActionTriggered));m.subscribe("/dnd/move/start",g.hitch(this,this._onMoveStart))},loadWidget:function(a){var b=new n,c;a=g.clone(a);(c=this.getWidgetById(a.id))?b.resolve(c):x([this.loadWidgetClass(a),this.loadWidgetManifest(a)]).then(g.hitch(this,function(a){var c=a[0],e=a[1];this.loadWidgetResources(e).then(g.hitch(this,function(a){try{var f=this.createWidget(e,
c,a);v.setAttr(f.domNode,"data-widget-name",e.name);console.log("widget ["+e.uri+"] created.")}catch(S){console.log("create ["+e.uri+"] error:"+S.stack),new z({message:window.jimuNls.widgetManager.createWidgetError+": "+e.uri}),w.byId(e.id)&&w.byId(e.id).destroy(),b.reject(S)}setTimeout(g.hitch(this,function(){b.resolve(f);this.emit("widget-created",f);m.publish("widgetCreated",f)}),50)}),function(a){b.reject(a)})}),function(a){b.reject(a)});return b},loadWidgetClass:function(a){var b=new n,c;c=a.isRemote?
a.uri+".js":a.uri;require(q.getRequireConfig(),[c],g.hitch(this,function(a){b.resolve(a)}));q.checkError(a.uri,b);return b},loadWidgetResources:function(a){var b=new n,c,e,f,k=[];f=g.clone(a);a=this.tryLoadWidgetConfig(f);c=this._tryLoadResource(f,"i18n");e=this._tryLoadResource(f,"style");f=this._tryLoadResource(f,"template");k.push(a);k.push(c);k.push(f);k.push(e);x(k).then(g.hitch(this,function(a){var c={};c.config=a[0];c.i18n=a[1];c.template=a[2];c.style=a[3];b.resolve(c)}),function(a){b.reject(a)});
return b},loadWidgetManifest:function(a){var b=new n,e=q.getUriInfo(a.uri),e=e.isRemote?e.folderUrl+"manifest.json?f\x3djson":e.folderUrl+"manifest.json";if(a.manifest)return b.resolve(a),b;c(e,{handleAs:"json",headers:{"X-Requested-With":null}}).then(g.hitch(this,function(c){if(c.error&&c.error.code)return b.reject(c.error);c.category="widget";g.mixin(c,q.getUriInfo(a.uri));q.manifest.addI18NLabel(c).then(g.hitch(this,function(){this._processManifest(c);q.widgetJson.addManifest2WidgetJson(a,c);b.resolve(a)}))}),
function(a){b.reject(a)});return b},getWidgetMarginBox:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return{};if(a._marginBox)return a._marginBox;var b={left:-9999,top:-9999,relativeTo:a.position.relativeTo};a._isTestSizeFlag=!0;a.setPosition(b);this.openWidget(a);a._marginBox=a.getMarginBox();this.closeWidget(a);"undefined"!==typeof a._isTestSizeFlag&&delete a._isTestSizeFlag;return a._marginBox},_processManifest:function(a){q.manifest.addManifestProperies(a);q.manifest.processManifestLabel(a,
window.dojoConfig.locale)},createWidget:function(a,b,c){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);c.config&&c.i18n&&(c.config=q.replacePlaceHolder(c.config,c.i18n));a.rawConfig=a.config;a.config=c.config||{};this.appConfig._appData&&this._mergeAgolConfig(a);a.nls=c.i18n||{};c.template&&(a.templateString=c.template);a["class"]="jimu-widget";a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;c={};for(var f in a)a.hasOwnProperty(f)&&(c[f]=a[f]);c.widgetManager=
this;a=new b(c);a.clazz=b;e.after(a,"startup",g.hitch(this,this._postWidgetStartup,a));e.before(a,"destroy",g.hitch(this,this._onDestroyWidget,a));a.domNode.addEventListener(this._getActiveEventName(),g.hitch(this,this._onClickWidget,a),{capture:!0});this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=t.map(this.loaded,function(a){return a.id});t.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var b=
new n;a=g.clone(a);a.id+="_setting";x([this.loadWidgetSettingClass(a)]).then(g.hitch(this,function(c){var f=c[0];this.loadWidgetSettingPageResources(a).then(g.hitch(this,function(c){var k,m={nls:c.i18n,appConfig:this.appConfig,"class":"jimu-widget-setting"};null!==c.template&&(m.templateString=c.template);"HTML3D"===window.appInfo.appType?m.sceneView=this.sceneView:m.map=this.map;for(var n in a)a.hasOwnProperty(n)&&(m[n]=a[n]);try{k=new f(m),v.setAttr(k.domNode,"data-widget-name-setting",m.name),
e.before(k,"destroy",g.hitch(this,this._onDestroyWidgetSetting,k)),b.resolve(k)}catch(S){new z({message:window.jimuNls.widgetManager.createWidgetSettingPageError+":"+a.uri}),w.byId(m.id)&&w.byId(m.id).destroy(),b.reject(S)}}),function(a){console.log(a)})}),function(a){b.reject(a)});return b},loadWidgetSettingClass:function(a){var b=new n,c;c=a.isRemote?a.folderUrl+"setting/Setting.js":a.amdFolder+"setting/Setting";require(q.getRequireConfig(),[c],g.hitch(this,function(a){b.resolve(a)}));q.checkError(a.folderUrl+
"setting/Setting.js",b);return b},loadWidgetSettingPageResources:function(a){var b=new n,c,e,f=[];a=g.clone(a);c=this._tryLoadResource(a,"settingI18n");e=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");f.push(c);f.push(e);f.push(a);x(f).then(g.hitch(this,function(a){var c={};c.i18n=a[0]||{};c.template=a[1];c.style=a[2];b.resolve(c)}),function(a){console.log(a)});return b},getWidgetById:function(a){var b;t.some(this.loaded,function(c){if(c.id===a)return b=c,!0},
this);return b},getWidgetByLabel:function(a){var b;t.some(this.loaded,function(c){if(c.label===a)return b=c,!0},this);return b},getWidgetsByName:function(a){var b=[];t.some(this.loaded,function(c){c.name===a&&b.push(c)},this);return b},changeWindowStateTo:function(a,b){"normal"===b?this.normalizeWidget(a):"minimized"===b?this.minimizeWidget(a):"maximized"===b?this.maximizeWidget(a):console.log("error state: "+b)},closeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;
if("closed"!==a.state){this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget.onDeActive(),this.activeWidget=null);v.setStyle(a.domNode,"display","none");a.setState("closed");try{a.onClose()}catch(D){console.log(console.error("fail to close widget "+a.name+". "+D.stack))}}this.appConfig.mode||this._removeDataSourceUsage(a)},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if(!a.started)try{a.started=!0,a.startup()}catch(D){console.error("fail to startup widget "+
a.name+". "+D.stack)}if("closed"===a.state){v.setStyle(a.domNode,"display","");a.setState("opened");try{a.onOpen()}catch(D){console.error("fail to open widget "+a.name+". "+D.stack)}q.isCommonOnScreenWidget(a)||(a.openAtStart&&!a._isNotOpenAtStart?a._isNotOpenAtStart=!0:q.focusFirstFocusNode(a.domNode));this.appConfig.mode||this._addDataSourceUsage(a)}},activateWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"opened"===a.state&&this._activeWidget(a)},maximizeWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(D){console.log(console.error("fail to maximize widget "+a.name+". "+D.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(D){console.log(console.error("fail to minimize widget "+a.name+". "+D.stack))}},normalizeWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(D){console.log(console.error("fail to normalize widget "+a.name+". "+D.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(D){console.log(console.error("fail to destroy widget "+a.name+". "+D.stack))}},tryLoadWidgetConfig:function(a){return this._tryLoadWidgetConfig(a).then(g.hitch(this,
function(b){return this._upgradeWidgetConfig(a,b).then(function(b){return a.config=b})}))},triggerWidgetOpen:function(a){function b(a){var b=e.after(a,"onOpen",function(){b.remove();c.resolve(a)})}var c=new n,f=this.getWidgetById(a);if(f){if("closed"!==f.state)return c.resolve(f),c;b(f)}else var k=m.subscribe("widgetCreated",g.hitch(this,function(b){b.id===a&&(k.remove(),c.resolve(b))}));m.publish("openWidget",a);return c},_tryLoadWidgetConfig:function(a){var e=new n;if(a.config&&g.isObject(a.config))return e.resolve(a.config),
e;if(a.config){if(require.cache["url:"+a.config])return e.resolve(b.parse(require.cache["url:"+a.config])),e;e=q.processUrlInAppConfig(a.config);e=e.split("/");e[e.length-1]=encodeURIComponent(e[e.length-1]);e=e.join("/");return c(e,{handleAs:"json",headers:{"X-Requested-With":null}})}return this._tryLoadResource(a,"config").then(function(b){a.isDefaultConfig=!0;return b})},_upgradeWidgetConfig:function(a,b){var c=new n,e=a.manifest.version,f=a.version,k;if(e===f)return c.resolve(b),c;if(!1===a.hasVersionManager)return a.version=
e,c.resolve(b),c;require(q.getRequireConfig(),[a.amdFolder+(a.isRemote?"VersionManager.js":"VersionManager")],g.hitch(this,function(g){g=new g;var m=g.getVersionIndex(f),n=g.getVersionIndex(e);if(m>n)c.reject("Bad widget version number, "+a.name+","+f);else try{k=g.upgrade(b,f,e),a.version=e,c.resolve(k)}catch(T){console.log("Read widget ["+a.name+"] old config error,"+T.stack),c.resolve(b)}}));return c},loadWidgetStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,!1),c=new n;return v.byId(b)?
(c.resolve("load"),c):q.loadStyleLink(b,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var b=this._getStyleIdFromWidgetJson(a,!0),c=new n;return v.byId(b)?(c.resolve("load"),c):q.loadStyleLink(b,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(q.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var e=new n;e.resolve(b.parse(require.cache["url:"+a]));return e}return c(a,{handleAs:"json",headers:{"X-Requested-With":null}})},
loadWidgetI18n:function(a){var b=new n;require(q.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){b.resolve(a)});return b},loadWidgetSettingI18n:function(a){var b=new n;require(q.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){b.resolve(a)});return b},loadWidgetTemplate:function(a){var b=new n;require(q.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){b.resolve(a)});q.checkError(a.templateFile,b);return b},loadWidgetSettingTemplate:function(a){var b=new n;require(q.getRequireConfig(),
["dojo/text!"+a.settingTemplateFile],function(a){b.resolve(a)});q.checkError(a.settingTemplateFile,b);return b},removeWidgetStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!1))},removeWidgetSettingStyle:function(a){this._removeStyle(this._getStyleIdFromWidgetJson(a,!0))},_removeStyle:function(a){if(v.byId(a)){var b=v.attr(a,"data-import-styles");if(b)for(var c=0;c<parseInt(b,10);c++)v.destroy(a+"_import_"+c);v.destroy(a)}},_getStyleIdFromWidgetJson:function(a,b){return this._replaceId("widget/style/"+
(a.itemId?a.itemId:a.uri)+(b?"/setting":""))},getControllerWidgets:function(){return t.filter(this.loaded,function(a){return a.isController})},getOffPanelWidgets:function(){return t.filter(this.loaded,function(a){return!a.inPanel})},getOnScreenOffPanelWidgets:function(){return t.filter(this.loaded,function(a){return a.isOnScreen&&!a.inPanel})},closeOtherWidgetsInTheSameGroup:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===
a.gid&&this.loaded[b].id!==a.id&&this.closeWidget(this.loaded[b])},closeAllWidgetsInGroup:function(a){for(var b=0;b<this.loaded.length;b++)this.loaded[b].gid===a&&this.closeWidget(this.loaded[b])},_addDataSourceUsage:function(a){t.forEach(this._getUsedDataSourceIdFromWidget(a),function(b){E.getInstance().addDataSourceUsage(b,a.id)})},_removeDataSourceUsage:function(a){t.forEach(this._getUsedDataSourceIdFromWidget(a),function(b){E.getInstance().removeDataSourceUsage(b,a.id)})},_getUsedDataSourceIdFromWidget:function(a){if((a=
this.appConfig.getConfigElementById(a.id))&&a.config){var c=b.stringify(a.config);return t.filter(Object.keys(this.appConfig.dataSource.dataSources),function(a){return-1<c.indexOf(a)},this)}},_mergeAgolConfig:function(a){var b=this.appConfig._appData.values,c="widgets["+a.id+"]",e;for(e in b){var f=e.replace(/\//g,"_").indexOf(c+"_config");0<=f&&q.template.setConfigValue(a,e.replace(/\//g,"_").substr(f,e.length).replace(c,"widget"),b[e])}},_onUserSignIn:function(a){t.forEach(this.loaded,function(b){b.onSignIn(a)},
this)},_onUserSignOut:function(){t.forEach(this.loaded,function(a){a.onSignOut()},this)},_activeWidget:function(a){if(this.activeWidget){if(this.activeWidget.id===a.id){!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&v.setStyle(this.activeWidget.domNode,"zIndex",101);return}"active"===this.activeWidget.state&&(this.activeWidget.setState("opened"),!1===this.activeWidget.inPanel&&v.setStyle(a.domNode,"zIndex","zIndex"in a.position?a.position.zIndex:"auto"),this.activeWidget.onDeActive())}this.activeWidget=
a;"opened"===this.activeWidget.state&&(this.activeWidget.setState("active"),!1===this.activeWidget.inPanel&&this.activeWidget.moveTopOnActive&&v.setStyle(this.activeWidget.domNode,"zIndex",101),this.activeWidget.onActive(),m.publish("widgetActived",a))},_onClickWidget:function(b,c){var e=a(".jimu-widget",b.domNode);if(0<e.length)for(var f=0;f<e.length;f++)if(c.target===e[f]||v.isDescendant(c.target,e[f]))return;this._activeWidget(b)},_onMoveStart:function(a){t.forEach(this.loaded,function(b){b.domNode===
a.node&&this._activeWidget(b)},this)},_onAppConfigLoaded:function(a){this.appConfig=a=g.clone(a);C.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onSceneViewLoaded:function(a){this.sceneView=a},_onSceneViewChanged:function(a){this.sceneView=a},_onAppConfigChanged:function(a,b,c,e){var f=g.clone(a);this.appConfig=f;t.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(f,b,c,e),"widgetChange"===b&&this._onConfigChanged(c.id,c.config,e))},
this)},_onConfigChanged:function(a,b){if(a=this.getWidgetById(a))a.onConfigChanged(b),g.mixin(a.config,b)},_onActionTriggered:function(a){if("map"!==a.elementId&&"app"!==a.elementId){var b=this.getWidgetById(a.elementId);if(b)b.onAction(a.action,a.data);else this.missedActions.push({id:a.elementId,action:{name:a.action,data:a.data}});t.forEach(this.getControllerWidgets(),function(b){if(b.widgetIsControlled(a.elementId))b.onAction(a.action,{widgetId:a.elementId,data:a.data})},this)}},_resetFirstFocusNode:function(a){if(window.isMoveFocusWhenInit){var b=
this.getWidgetsByName("Splash")[0];if(b&&"none"!==v.getStyle(b.domNode,"display"))window.isMoveFocusWhenInit=!1,a&&"Splash"===a.name||b.domNode.focus();else if(window.currentMsgPopup&&window.currentMsgPopup.firstFocusNode)window.isMoveFocusWhenInit=!1,window.currentMsgPopup.focusedNodeBeforeOpen=q.trapToNextFocusContainer(this.map.container,!0),window.currentMsgPopup.firstFocusNode.focus();else if(window.isMoveFocusWhenInit)window.isMoveFocusWhenInit=!1,q.trapToNextFocusContainer(this.map.container,
!0);else return!1;return!0}},_postWidgetStartup:function(a){a.started=!0;q.setVerticalCenter(a.domNode);e.after(a,"resize",g.hitch(this,q.setVerticalCenter,a.domNode));q.initTabIndexAndOrder(a);q.initWidgetCancelEvent(a);var b=a.position||a.panel&&a.panel.position;b&&"browser"===b.relativeTo&&k(a.domNode,"focus",g.hitch(this,function(){this._resetFirstFocusNode()}));this.openWidget(a);if(b=C.getPortalCredential(this.appConfig.portalUrl))a.onSignIn(b);else a.onSignOut();this._triggerMissedAction(a);
a.inPanel||q.addTooltipByDomNode(f,a.domNode,a.label)},_triggerMissedAction:function(a){this.missedActions.forEach(function(b){if(b.id===a.id)a.onAction(b.action.name,b.action.data)})},_remove:function(a){return t.some(this.loaded,function(b,c){if(b.id===a)return this.loaded.splice(c,1),!0},this)},_tryLoadResource:function(a,b){var c,e=new n;if("config"===b)c=a.amdFolder+"config.json",a.configFile=c,c="hasConfig";else if("style"===b)c=a.amdFolder+"css/style.css",a.styleFile=c,c="hasStyle";else if("i18n"===
b)c=a.amdFolder+"nls/strings.js",a.i18nFile=a.isRemote?c:a.amdFolder+"nls/strings",c="hasLocale";else if("template"===b)c=a.amdFolder+"Widget.html",a.templateFile=c,c="hasUIFile";else if("settingTemplate"===b)c=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=c,c="hasSettingUIFile";else if("settingI18n"===b)c=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.isRemote?c:a.amdFolder+"setting/nls/strings",c="hasSettingLocale";else if("settingStyle"===b)c=a.amdFolder+"setting/css/style.css",
a.settingStyleFile=c,c="hasSettingStyle";else return e;a[c]?function(){var c;if("config"===b)c=this.loadWidgetConfig(a);else if("style"===b)c=this.loadWidgetStyle(a);else if("i18n"===b)c=this.loadWidgetI18n(a);else if("template"===b)c=this.loadWidgetTemplate(a);else if("settingTemplate"===b)c=this.loadWidgetSettingTemplate(a);else if("settingStyle"===b)c=this.loadWidgetSettingStyle(a);else if("settingI18n"===b)c=this.loadWidgetSettingI18n(a);else return e;c.then(function(a){e.resolve(a)},function(c){console.error("Load widget resource error. resource:",
b);console.error(c);new z({message:window.jimuNls.widgetManager.loadWidgetResourceError+": "+a.uri});e.reject(c)})}.apply(this):e.resolve(null);return e},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);this.emit("widget-destroyed",a.id);m.publish("widgetDestroyed",a.id);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===
typeof a&&(a=this.getWidgetById(a),!a))return;this.activeWidget&&this.activeWidget.id===a.id&&(this.activeWidget=null);this._remove(a.id);0===this.getWidgetsByName(a.name).length&&this.removeWidgetStyle(a)},_getActiveEventName:function(){var a="PointerEvent"in window?"pointer":"MSPointerEvent"in window?"MSPointer":!1,b=a&&"MS"===a.slice(0,2);return a?a+(b?"Down":"down"):"mousedown"}});G.getInstance=function(a){null===B&&(B=new G(a),window._widgetManager=B);return B};return G})},"jimu/AppStateManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "),
function(p,g,t,v,n,m,u,k,f){var e=null,b=p(null,{rawAppConfig:null,mapMd5:null,appStateKey:null,setRawAppConfig:function(a){this.rawAppConfig=a},_getAppStateMd5:function(){if("string"!==typeof this.mapMd5){var a=v.stringify(this.rawAppConfig.map);this.mapMd5=k(a)}return this.mapMd5},_getAppStateKey:function(){return this.appStateKey?this.appStateKey:this.appStateKey="wab_appstate_"+this.urlParams.id||this.urlParams.appid||window.path},getWabAppState:function(){var a=new t,b={};if(f.isInConfigOrPreviewWindow()||
!this.rawAppConfig||!this.rawAppConfig.map)return a.resolve(b),a;var e=this._getAppStateKey(),g=u.get(e);g&&g.appStateMd5===this._getAppStateMd5()?(e=g.map&&g.map.extent,g=g.map&&g.map.layers,e&&(b.extent=new n(e.xmin,e.ymin,e.xmax,e.ymax,new m(e.spatialReference))),g&&(b.layers=g)):u.remove(e);a.resolve(b);return a},saveWabAppState:function(a,b){if(a&&!f.isInConfigOrPreviewWindow()){var c=this._getAppStateKey(),e={extent:{xmin:a.extent.xmin,xmax:a.extent.xmax,ymin:a.extent.ymin,ymax:a.extent.ymax,
spatialReference:{wkid:a.extent.spatialReference.wkid,wkt:a.extent.spatialReference.wkt}},layers:{}};b&&b.traversal&&b.traversal(g.hitch(this,function(a){e.layers[a.id]={visible:a.isVisible()}}));u.set(c,{map:e,appStateMd5:this._getAppStateMd5()})}}});b.getInstance=function(a){null===e&&(e=new b);e.urlParams=a;return e};return b})},"libs/storejs/store":function(){(function(p){var g={},t=p.document,v;g.disabled=!1;g.set=function(e,b){};g.get=function(e){};g.remove=function(e){};g.clear=function(){};
g.transact=function(e,b,a){var c=g.get(e);null==a&&(a=b,b=null);"undefined"==typeof c&&(c=b||{});a(c);g.set(e,c)};g.getAll=function(){};g.forEach=function(){};g.serialize=function(e){return JSON.stringify(e)};g.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(b){return e||void 0}};var n;try{n="localStorage"in p&&p.localStorage}catch(e){n=!1}if(n)v=p.localStorage,g.set=function(e,b){if(void 0===b)return g.remove(e);v.setItem(e,g.serialize(b));return b},g.get=function(e){return g.deserialize(v.getItem(e))},
g.remove=function(e){v.removeItem(e)},g.clear=function(){v.clear()},g.getAll=function(){var e={};g.forEach(function(b,a){e[b]=a});return e},g.forEach=function(e){for(var b=0;b<v.length;b++){var a=v.key(b);e(a,g.get(a))}};else if(t.documentElement.addBehavior){var m=function(e){return e.replace(/^d/,"___$\x26").replace(f,"___")};n=function(e){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(v);u.appendChild(v);v.addBehavior("#default#userData");v.load("localStorage");b=e.apply(g,
b);u.removeChild(v);return b}};var u,k;try{k=new ActiveXObject("htmlfile"),k.open(),k.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'),k.close(),u=k.w.frames[0].document,v=u.createElement("div")}catch(e){v=t.createElement("div"),u=t.body}var f=/[!"#$%&'()*+,/\\:;<=>?@[\]^`{|}~]/g;g.set=n(function(e,b,a){b=m(b);if(void 0===a)return g.remove(b);e.setAttribute(b,g.serialize(a));e.save("localStorage");return a});g.get=n(function(e,b){b=m(b);
return g.deserialize(e.getAttribute(b))});g.remove=n(function(e,b){b=m(b);e.removeAttribute(b);e.save("localStorage")});g.clear=n(function(e){var b=e.XMLDocument.documentElement.attributes;e.load("localStorage");for(var a=0,c;c=b[a];a++)e.removeAttribute(c.name);e.save("localStorage")});g.getAll=function(e){var b={};g.forEach(function(a,c){b[a]=c});return b};g.forEach=n(function(e,b){for(var a=e.XMLDocument.documentElement.attributes,c=0,f;f=a[c];++c)b(f.name,g.deserialize(e.getAttribute(f.name)))})}try{g.set("__storejs__",
"__storejs__"),"__storejs__"!=g.get("__storejs__")&&(g.disabled=!0),g.remove("__storejs__")}catch(e){g.disabled=!0}g.enabled=!g.disabled;"undefined"!=typeof module&&module.exports&&this.module!==module?module.exports=g:"function"===typeof define&&define.amd?define(g):p.store=g})(Function("return this")())},"libs/md5/md5":function(){(function(p){function g(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function t(a,b,c,e,f,k){a=g(g(b,a),g(e,k));return g(a<<f|a>>>32-f,c)}function v(a,
b,c,e,f,g,k){return t(b&c|~b&e,a,b,f,g,k)}function n(a,b,c,e,f,g,k){return t(b&e|c&~e,a,b,f,g,k)}function m(a,b,c,e,f,g,k){return t(c^(b|~e),a,b,f,g,k)}function u(a,b){a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;var c,e,f,k,p=1732584193,w=-271733879,x=-1732584194,u=271733878;for(b=0;b<a.length;b+=16)c=p,e=w,f=x,k=u,p=v(p,w,x,u,a[b],7,-680876936),u=v(u,p,w,x,a[b+1],12,-389564586),x=v(x,u,p,w,a[b+2],17,606105819),w=v(w,x,u,p,a[b+3],22,-1044525330),p=v(p,w,x,u,a[b+4],7,-176418897),u=v(u,p,w,x,a[b+5],12,
1200080426),x=v(x,u,p,w,a[b+6],17,-1473231341),w=v(w,x,u,p,a[b+7],22,-45705983),p=v(p,w,x,u,a[b+8],7,1770035416),u=v(u,p,w,x,a[b+9],12,-1958414417),x=v(x,u,p,w,a[b+10],17,-42063),w=v(w,x,u,p,a[b+11],22,-1990404162),p=v(p,w,x,u,a[b+12],7,1804603682),u=v(u,p,w,x,a[b+13],12,-40341101),x=v(x,u,p,w,a[b+14],17,-1502002290),w=v(w,x,u,p,a[b+15],22,1236535329),p=n(p,w,x,u,a[b+1],5,-165796510),u=n(u,p,w,x,a[b+6],9,-1069501632),x=n(x,u,p,w,a[b+11],14,643717713),w=n(w,x,u,p,a[b],20,-373897302),p=n(p,w,x,u,a[b+
5],5,-701558691),u=n(u,p,w,x,a[b+10],9,38016083),x=n(x,u,p,w,a[b+15],14,-660478335),w=n(w,x,u,p,a[b+4],20,-405537848),p=n(p,w,x,u,a[b+9],5,568446438),u=n(u,p,w,x,a[b+14],9,-1019803690),x=n(x,u,p,w,a[b+3],14,-187363961),w=n(w,x,u,p,a[b+8],20,1163531501),p=n(p,w,x,u,a[b+13],5,-1444681467),u=n(u,p,w,x,a[b+2],9,-51403784),x=n(x,u,p,w,a[b+7],14,1735328473),w=n(w,x,u,p,a[b+12],20,-1926607734),p=t(w^x^u,p,w,a[b+5],4,-378558),u=t(p^w^x,u,p,a[b+8],11,-2022574463),x=t(u^p^w,x,u,a[b+11],16,1839030562),w=t(x^
u^p,w,x,a[b+14],23,-35309556),p=t(w^x^u,p,w,a[b+1],4,-1530992060),u=t(p^w^x,u,p,a[b+4],11,1272893353),x=t(u^p^w,x,u,a[b+7],16,-155497632),w=t(x^u^p,w,x,a[b+10],23,-1094730640),p=t(w^x^u,p,w,a[b+13],4,681279174),u=t(p^w^x,u,p,a[b],11,-358537222),x=t(u^p^w,x,u,a[b+3],16,-722521979),w=t(x^u^p,w,x,a[b+6],23,76029189),p=t(w^x^u,p,w,a[b+9],4,-640364487),u=t(p^w^x,u,p,a[b+12],11,-421815835),x=t(u^p^w,x,u,a[b+15],16,530742520),w=t(x^u^p,w,x,a[b+2],23,-995338651),p=m(p,w,x,u,a[b],6,-198630844),u=m(u,p,w,x,
a[b+7],10,1126891415),x=m(x,u,p,w,a[b+14],15,-1416354905),w=m(w,x,u,p,a[b+5],21,-57434055),p=m(p,w,x,u,a[b+12],6,1700485571),u=m(u,p,w,x,a[b+3],10,-1894986606),x=m(x,u,p,w,a[b+10],15,-1051523),w=m(w,x,u,p,a[b+1],21,-2054922799),p=m(p,w,x,u,a[b+8],6,1873313359),u=m(u,p,w,x,a[b+15],10,-30611744),x=m(x,u,p,w,a[b+6],15,-1560198380),w=m(w,x,u,p,a[b+13],21,1309151649),p=m(p,w,x,u,a[b+4],6,-145523070),u=m(u,p,w,x,a[b+11],10,-1120210379),x=m(x,u,p,w,a[b+2],15,718787259),w=m(w,x,u,p,a[b+9],21,-343485551),
p=g(p,c),w=g(w,e),x=g(x,f),u=g(u,k);return[p,w,x,u]}function k(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function f(a){var b,c=[];c[(a.length>>2)-1]=void 0;for(b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(a.charCodeAt(b/8)&255)<<b%32;return c}function e(a){return k(u(f(a),8*a.length))}function b(a,b){var c=f(a),e=[],g=[];e[15]=g[15]=void 0;16<c.length&&(c=u(c,8*a.length));for(a=0;16>a;a+=1)e[a]=c[a]^909522486,g[a]=c[a]^1549556828;
b=u(e.concat(f(b)),512+8*b.length);return k(u(g.concat(b),640))}function a(a){var b="",c,e;for(e=0;e<a.length;e+=1)c=a.charCodeAt(e),b+="0123456789abcdef".charAt(c>>>4&15)+"0123456789abcdef".charAt(c&15);return b}function c(c,f,g){f?g?c=b(unescape(encodeURIComponent(f)),unescape(encodeURIComponent(c))):(c=b(unescape(encodeURIComponent(f)),unescape(encodeURIComponent(c))),c=a(c)):c=g?e(unescape(encodeURIComponent(c))):a(e(unescape(encodeURIComponent(c))));return c}"function"===typeof define&&define.amd?
define(function(){return c}):p.md5=c})(this)},"builder/portalUtils":function(){define(["jimu/portalUtils"],function(p){return p})},"builder/plugins/app-actions/to-template-config/_build-generate_module":function(){define(["builder/plugins/app-actions/to-template-config/Plugin","dojo/text!builder/plugins/app-actions/to-template-config/css/style.css","dojo/i18n!builder/plugins/app-actions/to-template-config/nls/strings"],function(){})},"builder/plugins/app-actions/to-template-config/Plugin":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/topic","dojo/on","builder/BasePlugin"],function(p,g,t,v,n){return p([n],{baseClass:"plugin-app-actions-to-template-config",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"footer-button" title\x3d"${nls.label}" data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\x3c/div\x3e',postCreate:function(){this.inherited(arguments);this.visible=!1;this.own(v(this.domNode,"click",g.hitch(this,this._onClick)));this._bindEvent()},_bindEvent:function(){this.own(t.subscribe("app/appConfigLoaded",
g.hitch(this,this._setAppConfig)));this.own(t.subscribe("app/appConfigChanged",g.hitch(this,this._setAppConfig)))},_onClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigTemplate()},_setAppConfig:function(g){this.appConfig=g;this.visible=!g.templateConfig||g.isTemplateApp||g._appData?!1:!0}})})},"builder/plugins/app-config/_build-generate_module":function(){define(["builder/plugins/app-config/Plugin","dojo/text!builder/plugins/app-config/Plugin.html","dojo/text!builder/plugins/app-config/css/style.css"],
function(){})},"builder/plugins/app-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/promise/all dojo/query builder/utils jimu/utils jimu/WidgetManager jimu/dijit/ViewStack jimu/dijit/LoadingShelter jimu/dijit/AGOLLoading jimu/ConfigLoader jimu/LayerInfos/LayerInfos esri/tasks/GeometryService esri/config builder/BasePlugin".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){return p([E],{baseClass:"plugin-config-app",
_PreviewMoreIframeSrc:"",_isPortrait:!0,_deviceInfo:null,appId:null,postCreate:function(){this.inherited(arguments);this.atLoading=new x({loadingText:window.jimuNls.loadingShelter.loading+"..."});this.atLoading.placeAt(this.domNode);this.atLoading.show();this.optsLoading=new c({loadingText:"",hidden:!0,showLoading:!1});this.optsLoading.placeAt(this.leftPaneNode);this.republishEvents=[];this.pluginsLoadDefs=[];this._createAppTemplateViewStack();this._createOptsViewStack();this._createPreviewViewStack();
this._bindEvent();this.saveTemplatePluginBox=this.saveAppPluginBox=null},startup:function(){this.pluginsLoadDefs.push(this._loadConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadMorePreviewOptsPlugin());this.pluginsLoadDefs.push(this._loadTemplateConfigOptsPlugin());this.pluginsLoadDefs.push(this._loadConfigTemplatePlugin());this.pluginsLoadDefs.push(this._createMainAppActions());this.pluginsLoadDefs.push(this._createPopupAppActions());this.widgetManager=b.getInstance();this._defineSetConfigViewerTopicFunction();
this._defineSetPreviewViewerTopicFunction();this._updateAppId()},addRepublishEvent:function(a){a=a.replace(/\s/g,"");-1<this.republishEvents.indexOf(a)||(this.republishEvents.push(a),this.own(m.subscribe(a,g.hitch(this,function(b){window.verboseLog&&("actionTriggered"!==a||"actionTriggered"===a&&"editLayout"===b.action)&&console.log("Builer event:","builder/"+a,b);this.configViewerTopic.publish("builder/"+a,b)}))))},showLoadingCover:function(){this.optsLoading.show()},hideLoadingCover:function(){this.optsLoading.hide()},
switchToPreviewConfig:function(){this.optsViewStack.switchView(this.configOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);this.pluginManager.getPluginByName("app-config-template-configpart").visible=!1},switchToTemplateConfigPart:function(){this.optsViewStack.switchView(this.templateOptsPaneNode);this.previewViewStack.switchView(this.previewConfig);var a=this.pluginManager.getPluginByName("app-config-template-configpart");a.visible=!0;a.refresh()},switchToPreviewMore:function(){this.optsViewStack.switchView(this.morePreviewOptsPaneNode);
this.previewViewStack.switchView(this.previewMore);this._showPreviewMore()},switchToConfigApp:function(a){v.setStyle(this.configAppNode,"visibility","visible");a=a||this.appConfig;this.atViewStack.switchView(this.configAppNode);a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData?this.switchToTemplateConfigPart():(a=this.pluginManager.getPluginByName("app-actions.preview-app"))&&"config"!==a.mode?this.switchToPreviewMore():this.switchToPreviewConfig();(a=this.pluginManager.getPluginByName("app-actions.save-app"))&&
this.saveAppPluginBox&&v.place(a.domNode,this.saveAppPluginBox);this.pluginManager.getPluginByName("app-config-templateconfig").visible=!1},switchToConfigTemplate:function(){v.setStyle(this.configAppNode,"visibility","hidden");this.atViewStack.switchView(this.configTemplateNode);this.switchToPreviewConfig();var a=this.pluginManager.getPluginByName("app-actions.save-app");a&&this.saveTemplatePluginBox&&v.place(a.domNode,this.saveTemplatePluginBox);a=this.pluginManager.getPluginByName("app-config-templateconfig");
a.visible=!0;a.refresh()},_bindEvent:function(){this.own(m.subscribe("app/preloadWidgetsLoaded",g.hitch(this,this._onPreloadWidgetsLoaded)));this.own(m.subscribe("app/mapCreatedFailed",g.hitch(this,this._onMapCreatedFailed)));this.own(n(this.btnPortrait,"click",g.hitch(this,function(){this._resizePreviewMore(!0)})));this.own(n(this.btnLandscape,"click",g.hitch(this,function(){this._resizePreviewMore(!1)})));this.own(n(document.body,"click",g.hitch(this,function(){v.setStyle(this.popupActionsMenu,
"display","none")})));this.own(m.subscribe("iframeClick",g.hitch(this,function(){v.setStyle(this.popupActionsMenu,"display","none")})));this._bindFrameEvent()},_bindFrameEvent:function(){this.own(n(this.previewConfigFrameNode,"load",g.hitch(this,function(){window.configWindow=this.previewConfigFrameNode.contentWindow;this.own(n(this.previewConfigFrameNode.contentWindow.document.body,"click",g.hitch(this,function(a){m.publish("iframeClick",a)})))})));this.own(n(this.previewMoreFrameNode,"load",g.hitch(this,
function(){window.previewWindow=this.previewMoreFrameNode.contentWindow;this.own(n(this.previewMoreFrameNode.contentWindow.document.body,"click",g.hitch(this,function(a){m.publish("iframeClick",a)})))})))},_createAppTemplateViewStack:function(){this.atViewStack=new a({viewType:"dom",views:[this.configAppNode,this.configTemplateNode]},this.atViewStackNode)},_createOptsViewStack:function(){this.optsViewStack=new a({viewType:"dom",views:[this.configOptsPaneNode,this.morePreviewOptsPaneNode,this.templateOptsPaneNode]},
this.optsViewStackNode)},_createPreviewViewStack:function(){this.previewViewStack=new a({viewType:"dom",views:[this.previewConfig,this.previewMore]},this.rightPreviewSection)},_defineSetConfigViewerTopicFunction:function(){window.setConfigViewerTopic=g.hitch(this,function(a){this.configViewerTopic=a;this.own(this.configViewerTopic.subscribe("appConfigLoaded",g.hitch(this,this.onAppConfigLoaded)));this.own(this.configViewerTopic.subscribe("appConfigChanged",g.hitch(this,this.onAppConfigChanged)));
this.own(this.configViewerTopic.subscribe("mapLoaded",g.hitch(this,this.onMapLoaded)));this.own(this.configViewerTopic.subscribe("mapChanged",g.hitch(this,this.onMapChanged)));this.own(this.configViewerTopic.subscribe("sceneViewLoaded",g.hitch(this.onSceneViewLoaded)));this.own(this.configViewerTopic.subscribe("sceneViewChanged",g.hitch(this.onSceneViewChanged)));this.own(this.configViewerTopic.subscribe("preloadWidgetsLoaded",g.hitch(this,this.onPreloadWidgetsLoaded)));this.own(this.configViewerTopic.subscribe("mapCreatedFailed",
g.hitch(this,this.onMapCreatedFailed)));this.own(this.configViewerTopic.subscribe("layoutDefinitionChanged",g.hitch(this,this.onLayoutDefinitionChanged)));this.own(this.configViewerTopic.subscribe("editLayoutCancelled",g.hitch(this,this.onEditLayoutCancelled)));this.own(this.configViewerTopic.subscribe("dataSourceDataUpdated",g.hitch(this,this.onDataSourceDataUpdated)));this.own(this.configViewerTopic.subscribe("editLayout",g.hitch(this,this.onEditLayout)));this._onConfigViewerLoaded()})},_defineSetPreviewViewerTopicFunction:function(){window.setPreviewViewerTopic=
g.hitch(this,function(a){this.previewViewerTopic=a;a=g.clone(this.appConfig);a.mode="preview";this.previewViewerTopic.publish("builder/setAppConfig",a);this.own(this.previewViewerTopic.subscribe("mapLoaded",g.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()})));this.own(this.previewViewerTopic.subscribe("sceneViewLoaded",g.hitch(this,function(){this._syncPreviewViewpointWithConfigViewpoint()})));this._onPreviewViewerLoaded()})},_loadConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("config-part",
this.options.appInfo.appType),a=this.pluginsMeta[a[0].pluginName];a.options=this.options;return this.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){v.place(a.domNode,this.configOptsPaneNode);a.startup();return a}))},_loadMorePreviewOptsPlugin:function(){var a=this.filterExtensionsByAppType("morepreview-selction-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(g.hitch(this,function(a){v.place(a.domNode,this.morePreviewOptsPaneNode);
a.startup();return a}))},_updateAppId:function(){window.jimuConfig.widgetsPackage={name:"widgets",location:window.appInfo.appPath+"widgets"};window.jimuConfig.themesPackage={name:"themes",location:window.appInfo.appPath+"themes"};window.jimuConfig.configsPackage={name:"configs",location:window.appInfo.appPath+"configs"};var a=e.urlToObject(window.location.href).query||{},b=window.appInfo.appPath+"index.html";delete a.id;window.isXT||a.appid||(b=b+"?id\x3d"+window.appInfo.id);a.mode="preview";this._PreviewMoreIframeSrc=
encodeURI(f.appendParamsToAppPath(b,a));a.mode="config";v.attr(this.previewConfigFrameNode,"src",encodeURI(f.appendParamsToAppPath(b,a)))},_onConfigViewerLoaded:function(){u(this.pluginsLoadDefs).then(g.hitch(this,function(){window.stemappInfo.appVersionManager?require([window.appInfo.appPath+window.stemappInfo.appVersionManager],g.hitch(this,function(a){this._loadAppConfig(a)})):this._loadAppConfig()}))},_loadAppConfig:function(a){var b=e.urlToObject(window.location.href).query||{};window.isXT?(delete b.id,
b.config=window.appInfo.appPath+"config.json"):(b.appid&&(b.config=window.path+"stemapp/config.json"),"stemapp"===b.id&&(b.config=window.path+"stemapp/config.json",delete b.id));b.mode="config";w.getInstance(b,{versionManager:a?new a:null}).loadConfig().then(g.hitch(this,function(a){this.atLoading.hide();this.showLoadingCover();a.templateConfig&&a.isTemplateApp||a.templateConfig&&a._appData||!a.templateConfig?(this.switchToConfigApp(a),a.templateConfig?u(this._loadWidgetConfigsInTemplateConfig(a)).then(g.hitch(this,
function(){this.configViewerTopic.publish("builder/setAppConfig",a)})):this.configViewerTopic.publish("builder/setAppConfig",a)):(this.switchToConfigTemplate(),this.configViewerTopic.publish("builder/setAppConfig",a))}))},_loadWidgetConfigsInTemplateConfig:function(a){var b=e.template.getConfigedWidgetsByTemplateConfig(a.templateConfig),c=[];t.forEach(b,function(b){b=a.getConfigElementById(b);c.push(this.widgetManager.tryLoadWidgetConfig(b))},this);return c},_onPreviewViewerLoaded:function(){},previewOnDevice:function(a,
b){this._deviceInfo=a;v.setStyle(this.previewMoreDes,"display","block");this.previewMoreDes.innerHTML=b?a.width+" x "+a.height:a.title+" "+a.width+" x "+a.height;this._resizePreviewMore(this._isPortrait)},_createMainAppActions:function(){var a=this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=360/a.length;a.sort(function(a,b){return a.parameters.index-b.parameters.index});t.forEach(a,function(a,c){this._createMainAppActionNode(a,c,b)},this);return u([])},_createMainAppActionNode:function(a,
b,c){0<b&&v.create("div",{"class":"seprate jimu-float-leading"},this.mainActionBoxNode);var e=v.create("div",{"class":"footer-button-box jimu-float-leading",pname:a.pluginName,"data-sepIndex":b-1},this.mainActionBoxNode);v.setStyle(e,"width",c+"px");b=this.pluginsMeta[a.pluginName];b.options=this.options.appInfo;return this.pluginManager.loadPlugin(b).then(g.hitch(this,function(b){"app-actions.save-app"===a.pluginName&&(this.saveAppPluginBox=e);v.place(b.domNode,e);b.startup();return b}))},_refreshAppActions:function(){var a=
this.filterExtensionsByAppType("main-app-actions",window.appInfo.appType),b=0;t.forEach(a,function(a){var c=this.pluginManager.getPluginByName(a.pluginName);a=k('div[pname\x3d"'+a.pluginName+'"]',this.mainActionBoxNode)[0];var e,f=+a.getAttribute("data-sepIndex");0<=f&&(e=k("div.seprate",this.mainActionBoxNode)[f]);!1===c.visible?(v.setStyle(a,"display","none"),e&&v.setStyle(e,"display","none")):(v.setStyle(a,"display",""),e&&v.setStyle(e,"display",""),b++)},this);var c=360/b,a=k(".footer-button-box",
this.mainActionBoxNode);t.forEach(a,function(a){v.setStyle(a,"width",c+"px")})},_createPopupAppActions:function(){var a=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType);a.sort(function(a,b){return a.parameters.index-b.parameters.index});if(0===a.length)v.setStyle(this.btnArrow,"display","none");else{v.setStyle(this.popupActionsMenu,"top",-30*a.length+"px");var b=[];t.forEach(a,function(a){b.push(this._createPopupAppActionNode(a))},this);return u(b)}},_createPopupAppActionNode:function(a){var b=
a.parameters,c=v.create("div",{id:a.pluginName},this.popupActionsMenu);return this.pluginManager.loadPlugin(this.pluginsMeta[a.pluginName]).then(g.hitch(this,function(a){c.innerHTML=a.label;this.own(n(c,"click",g.hitch(a,a[b.onClickAction])));return a}))},_onBtnArrowClick:function(a){if("none"===v.getStyle(this.popupActionsMenu,"display")){v.setStyle(this.popupActionsMenu,"display","block");var b=this.filterExtensionsByAppType("popup-app-actions",window.appInfo.appType),c=0;t.forEach(b,function(a){var b=
this.pluginManager.getPluginByName(a.pluginName);a=k('div[id\x3d"'+a.pluginName+'"]',this.popupActionsMenu)[0];a.innerHTML=b.label;!1===b.visible?v.setStyle(a,"display","none"):(v.setStyle(a,"display",""),c++);b.disabled?v.addClass(a,"disable"):a&&v.removeClass(a,"disable")},this);v.setStyle(this.popupActionsMenu,"top",-30*c+"px")}else v.setStyle(this.popupActionsMenu,"display","none");a.stopPropagation()},_getGeomtryServiceByAppConfig:function(a){return new C(a.geometryService)},onAppConfigLoaded:function(a){a=
this._processAppConfig(a);m.publish("app/appConfigLoaded",a);this._refreshAppActions()},onMapLoaded:function(a,b){q.setInstance(a,b);m.publish("app/mapLoaded",a)},onMapChanged:function(a,b){q.setInstance(a,b);m.publish("app/mapChanged",a)},onSceneViewLoaded:function(a){m.publish("app/sceneViewLoaded",a)},onSceneViewChanged:function(a){m.publish("app/sceneViewChanged",a)},onAppConfigChanged:function(a,b,c){a=this._processAppConfig(a);m.publish("app/appConfigChanged",a,b,c);this._refreshAppActions()},
onPreloadWidgetsLoaded:function(){m.publish("app/preloadWidgetsLoaded")},onMapCreatedFailed:function(){m.publish("app/mapCreatedFailed")},onDataSourceDataUpdated:function(a,b){m.publish("app/dataSourceDataUpdated",a,b)},onLayoutDefinitionChanged:function(a){this.hideLoadingCover();m.publish("layoutDefinitionChanged",a)},onEditLayoutCancelled:function(){this.hideLoadingCover()},onEditLayout:function(){m.publish("app/editLayout")},_processAppConfig:function(a){a=e.reCreateObject(a);z.defaults.geometryService=
this._getGeomtryServiceByAppConfig(a);this.appConfig=a;return window.appConfig=a},_showPreviewMore:function(){this.previewViewStack.switchView(this.previewMore);if(!this.previewMoreFrameNode.src&&this._PreviewMoreIframeSrc)this._initPreviewMoreViewerPosition(),v.attr(this.previewMoreFrameNode,"src",this._PreviewMoreIframeSrc);else{var a=g.clone(this.appConfig);a.mode="preview";this._syncPreviewMapExtentWithConfigMapExtent();this.previewViewerTopic.publish("builder/setAppConfig",a)}},_syncPreviewMapExtentWithConfigMapExtent:function(){var a=
window.configWindow&&window.configWindow._viewerMap,b=window.previewWindow&&window.previewWindow._viewerMap;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncExtent",a)},_syncPreviewViewpointWithConfigViewpoint:function(){var a=window.configWindow&&window.configWindow._sceneView,b=window.previewWindow&&window.previewWindow._sceneView;a&&b&&this.previewViewerTopic&&this.previewViewerTopic.publish("builder/syncViewpoint",a.viewpoint)},_initPreviewMoreViewerPosition:function(){var a=
v.getMarginBox(this.previewMore);v.setStyle(this.previewMoreContainer,{width:a.w-220+"px",height:a.h-130+"px"});v.setStyle(this.previewMoreIframeSection,"marginTop","50px")},_setPreviewMoreViewerPosition:function(){var a=v.getMarginBox(this.previewMore).h,b=v.getMarginBox(this.previewMoreContainer),c=v.getStyle(this.previewMoreContainer,"paddingTop"),e=v.getStyle(this.previewMoreContainer,"paddingBottom"),a=(a-(b.h+c+e))/2;0>a&&(a=0);v.setStyle(this.previewMoreIframeSection,"marginTop",a+"px")},_resizePreviewMore:function(a){a?
this._showPortrait():this._showLandscape();setTimeout(g.hitch(this,function(){this._syncPreviewMapExtentWithConfigMapExtent()}),500)},_showPortrait:function(){this._deviceInfo&&(this._isPortrait=!0,v.setStyle(this.previewMoreContainer,{width:this._deviceInfo.width+44+"px",height:this._deviceInfo.height+44+"px"}),v.addClass(this.btnPortrait,"selected"),v.removeClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_showLandscape:function(){this._deviceInfo&&(this._isPortrait=!1,
v.setStyle(this.previewMoreContainer,{width:this._deviceInfo.height+44+"px",height:this._deviceInfo.width+44+"px"}),v.removeClass(this.btnPortrait,"selected"),v.addClass(this.btnLandscape,"selected"),this._setPreviewMoreViewerPosition())},_onPreloadWidgetsLoaded:function(){this.hideLoadingCover()},_onMapCreatedFailed:function(){this.hideLoadingCover()},_loadTemplateConfigOptsPlugin:function(){var a=this.filterExtensionsByAppType("template-config-part",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(g.hitch(this,
function(a){v.place(a.domNode,this.templateOptsPaneNode);a.startup();return a}))},_loadConfigTemplatePlugin:function(){var a=this.filterExtensionsByAppType("config-template",this.options.appInfo.appType);if(0!==a.length)return this.pluginManager.loadPlugin(this.pluginsMeta[a[0].pluginName]).then(g.hitch(this,function(a){v.place(a.domNode,this.configTemplateNode);a.startup();this.saveTemplatePluginBox=a.savePluginNode;return a}))}})})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(p,g,t,v,n){return p(n,{baseClass:"jimu-viewstack",declaredClass:"jimu.dijit.ViewStack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);v.forEach(this.views,g.hitch(this,function(g){1===g.nodeType?(t.place(g,this.domNode),t.addClass(g,"view"),t.setStyle(g,"display","none")):g.domNode&&(t.place(g.domNode,this.domNode),t.addClass(g.domNode,"view"),t.setStyle(g.domNode,"display",
"none"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var g="",n=this.getSelectedView();n&&(g=n.label);return g},getViewByLabel:function(g){for(var m=0;m<this.views.length;m++)if(g===this.views[m].label)return this.views[m];return null},addView:function(g){this.views.push(g);1===g.nodeType?(t.place(g,this.domNode),t.addClass(g,"view")):g.domNode&&(t.place(g.domNode,this.domNode),
t.addClass(g.domNode,"view"))},removeView:function(g){var m=this.views.length;this.views=v.filter(this.views,function(k){return g!==k});m!==this.views.length&&(1===g.nodeType?t.destroy(g):g.domNode&&g.destroyRecursive())},switchView:function(m){var n,k;n="number"===typeof m?this.views[m]:"string"===typeof m?this.getViewByLabel(m):m;this.views.forEach(g.hitch(this,function(f){if(f)if(1===f.nodeType?k=f:f.domNode&&(k=f.domNode),f===n){if(t.setStyle(k,"display","block"),f.domNode)if(!f._started)f.startup(),
f._started=!0;else if("function"===typeof f.onShown)f.onShown()}else if(t.setStyle(k,"display","none"),f.domNode&&"function"===typeof f.onHidden)f.onHidden()}));this._currentView=n;this.onViewSwitch(n)},onViewSwitch:function(){}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(p,g,t,v,n){return p([g,t],{baseClass:"jimu-loading-shelter jimu-agol-loading",declaredClass:"jimu.dijit.LoadingShelter",
templateString:v,loadingText:null,hidden:!1,showLoading:!0,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&n.setStyle(this.domNode,"display","none");n.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||n.setStyle(this.loadingNode,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(g){this.domNode&&this.hidden&&("string"===typeof g&&(this.textNode.innerHTML=
g),n.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(n.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/dijit/AGOLLoading":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/AGOLLoading.html","dojo/_base/html"],function(p,g,t,v,n){return p([g,t],{baseClass:"jimu-agol-loading",declaredClass:"jimu.dijit.AGOLLoading",templateString:v,loadingText:null,hidden:!1,showLoading:!0,
postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&n.setStyle(this.domNode,"display","none");n.setStyle(this.domNode,{width:"100%",height:"100%"});this.showLoading||n.setStyle(this.imgDiv,"display","none");"string"===typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(g){this.domNode&&this.hidden&&("string"===typeof g&&(this.textNode.innerHTML=g),n.setStyle(this.domNode,"display","block"),
this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(n.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"builder/plugins/app-config-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-configpart/Plugin","dojo/text!builder/plugins/app-config-configpart/Plugin.html","dojo/text!builder/plugins/app-config-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-configpart/nls/strings"],function(){})},"builder/plugins/app-config-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/topic dojo/on ./TabContainer2 builder/BasePlugin".split(" "),
function(p,g,t,v,n,m,u,k){return p([k],{baseClass:"plugin-appconfig-configpart",postCreate:function(){this.inherited(arguments);this.plugins=[];this.republishEvents=[]},startup:function(){this._createConfigTab();this._addRepublishEvents()},_addRepublishEvents:function(){var f=this.pluginManager.getPluginByName("app-config");t.forEach(this.republishEvents,function(e){f.addRepublishEvent(e)},this)},_createConfigTab:function(){var f=this.filterExtensionsByAppType("config-sections",window.appInfo.appType);
t.some(f,g.hitch(this,function(b){return"map-config"===b.pluginName?(b.parameters.label="HTML3D"===window.appInfo.appType?window.jimuNls.common.scene:window.jimuNls.common.map,!0):!1}));var e=[];t.forEach(f,function(b){e.push(this.pluginManager.loadPlugin(this.pluginsMeta[b.pluginName]));b=b.parameters.republishEvents.split(",");this.republishEvents=this.republishEvents.concat(b)},this);v(e).then(g.hitch(this,function(b){var a=[];t.forEach(b,function(b,e){e=f[e];this.plugins.push(b);a.push({title:e.parameters.label,
icon:e.parameters.icon,selectedIcon:e.parameters.selectedIcon,content:b,index:e.parameters.index,pluginName:e.pluginName})},this);a.sort(function(a,b){return a.index-b.index});this.tab=new u({tabs:a,selected:a[0].title},this.tabsNode);this.tab.startup();this.own(m(this.tab,"tabChanged",g.hitch(this,function(a,b){"attribute-config"!==b&&n.publish("actionTriggered",{action:"showApp"})})))}))},_onMapChanged:function(f){this.map=f}})})},"builder/plugins/app-config-configpart/TabContainer2":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./TabContainer2.html jimu/dijit/ViewStack".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return p([k,f,m],{templateString:e,_controlNodes:null,selected:"",tabs:null,"class":"jimu-tab2",postCreate:function(){this.inherited(arguments);this._controlNodes=[];this.viewStack=new b(null,this.containerNode);t.forEach(this.tabs,function(a){this._createTab(a)},this)},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},_createTab:function(a){var b=v.toDom('\x3ctd\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3cdiv class\x3d"tab-item-icon"\x3e\x3c/div\x3e\x3cdiv class\x3d"tab-item-title"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e');
v.place(b,this.tabTr);var e=u(".tab-item-div",b)[0],f=u(".tab-item-icon",b)[0];u(".tab-item-title",b)[0].innerHTML=a.title||"";v.setAttr(e,"title",a.title||"");v.setStyle(f,"backgroundImage","url("+a.icon+")");this.viewStack.viewType=a.content.domNode?"dijit":"dom";e.tabConfig=a;e.iconNode=f;a.content.label=a.title;this.viewStack.addView(a.content);this.own(n(e,"click",g.hitch(this,this.onSelect,a.title)));this._controlNodes.push(e)},onSelect:function(a){this.selectTab(a)},selectTab:function(a){var b;
t.forEach(this._controlNodes,g.hitch(this,function(c){var e="";c.tabConfig.title===a?(v.addClass(c,"selected-tab-item-div"),e=c.tabConfig.selectedIcon,b=c.tabConfig.pluginName):(v.removeClass(c,"selected-tab-item-div"),e=c.tabConfig.icon);v.setStyle(c.iconNode,"backgroundImage","url("+e+")")}));this.viewStack.switchView(a);this.emit("tabChanged",a,b)}})})},"builder/plugins/app-config-morepreview-selectionpart/_build-generate_module":function(){define(["builder/plugins/app-config-morepreview-selectionpart/Plugin",
"dojo/text!builder/plugins/app-config-morepreview-selectionpart/Plugin.html","dojo/text!builder/plugins/app-config-morepreview-selectionpart/css/style.css","dojo/i18n!builder/plugins/app-config-morepreview-selectionpart/nls/strings"],function(){})},"builder/plugins/app-config-morepreview-selectionpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/query builder/BasePlugin dijit/_WidgetsInTemplateMixin jimu/portalUrlUtils jimu/dijit/QRCode dijit/form/NumberTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return p([m,u],{baseClass:"plugin-appconfig-morepreview-selectionpart",postCreate:function(){this.inherited(arguments);this.customWidth=new e({"class":"jimu-float-leading",style:"width:100%;",value:"1024",required:"true"});this.customWidth.placeAt(this.customWidthNode);this.customHeight=new e({"class":"jimu-float-leading",style:"width:100%;",value:"768",required:"true"});this.customHeight.placeAt(this.customHeightNode);this._bindEvents();this._appConfigPlugin=this.pluginManager.getPluginByName("app-config")},
startup:function(){this.inherited(arguments);this._initPreviewItems();this._initQRCode()},_bindEvents:function(){this.own(v(this.customWidth,"blur",g.hitch(this,this._onCustomSizeChanged)));this.own(v(this.customHeight,"blur",g.hitch(this,this._onCustomSizeChanged)))},_initPreviewItems:function(){t.empty(this.previewTbody);var b=[];b.push({"class":"iPhoneX",title:"iPhone X",width:375,height:812});b.push({"class":"iPhone6-plus",title:"iPhone 8 Plus / iPhone 7 Plus / 6s Plus / 6 Plus",width:414,height:736});
b.push({"class":"iPhone6",title:"iPhone 8 / iPhone 7 / 6s / 6",width:375,height:667});b.push({"class":"iPhone5",title:"iPhone SE / 5 / 5C / 5S",width:320,height:568});b.push({"class":"iPhone4",title:"iPhone 4s / 4",width:320,height:480});b.push({"class":"xiaomi-3",title:"LG G5 / G4 / G3",width:360,height:640});b.push({"class":"xiaomi-3",title:"Huawei Mate 9",width:360,height:640});b.push({"class":"xiaomi-3",title:"Lenovo Z2 Pro",width:360,height:640});b.push({"class":"xiaomi-3",title:"Xiaomi Mi 5",
width:360,height:640});b.push({"class":"htc-one",title:"HTC 10",width:360,height:640});b.push({"class":"Samsung-s8",title:"Samsung Galaxy S8 / Samsung Galaxy S8 Plus",width:360,height:740});b.push({"class":"Samsung-Galaxy-S4",title:"Samsung Galaxy S7, S7 edge",width:360,height:640});b.push({"class":"Samsung-Note-3",title:"Samsung Galaxy Note 4",width:360,height:640});b.push({"class":"new-iPad",title:"Google Nexus 10",width:800,height:1280});b.push({"class":"Nexus-5",title:"Google Nexus 6",width:412,
height:732});b.push({"class":"Nexus-4",title:"Google Nexus 5",width:360,height:640});b.push({"class":"iPad-Air",title:"iPad Pro",width:1024,height:1366});b.push({"class":"iPad-Air",title:"iPad 3 / 4 / Air / Air2",width:768,height:1024});b.push({"class":"iPad-mini",title:"iPad mini 2 / 3",width:768,height:1024});b.push({"class":"new-iPad",title:"Surface Pro 3",width:1024,height:1440});b.push({"class":"new-iPad",title:"Surface Pro / Pro 2",width:720,height:1280});var a=Math.ceil(b.length/4),c;for(c=
0;c<a;c++){var e=t.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");t.place(e,this.previewTbody)}a=n("td",this.previewTbody);for(c=0;c<b.length;c++){var e=a[c],f=this._createPreviewItem(b[c]);t.place(f,e)}},_createPreviewItem:function(b){var a=t.toDom('\x3cdiv class\x3d"preview-item"\x3e\x3cdiv class\x3d"preview-item-bg"\x3e\x3cdiv class\x3d"preview-item-thumbnail"\x3e\x3c/div\x3e\x3cdiv class\x3d"preview-selected-icon"\x3e\x3c/div\x3e\x3c/div\x3e\x3cspan class\x3d"preview-item-title"\x3e\x3c/span\x3e\x3c/div\x3e');
a.args=b;var c=n(".preview-item-bg",a)[0],e=n(".preview-item-thumbnail",a)[0],f=n(".preview-item-title",a)[0];this.own(v(c,"click",g.hitch(this,this._onPreviewItemBgClick)));b["class"]&&t.addClass(e,b["class"]);f.innerHTML=b.title||"";return a},_onPreviewItemBgClick:function(b){b=b.target||b.srcElement;t.hasClass(b,"preview-item-thumbnail")&&(b=b.parentNode,n(".preview-item-bg",this.previewTbody).removeClass("selected"),t.addClass(b,"selected"),b=b.parentNode.args,this.customWidth.setValue(b.width),
this.customHeight.setValue(b.height),this._appConfigPlugin.previewOnDevice(b,!1))},_onCustomSizeChanged:function(){var b=function(a){var b=!1;isNaN(a)||isNaN(parseFloat(a))||0<parseInt(a,10)&&(b=!0);return b},a=this.customWidth.getValue(),c=this.customHeight.getValue();b(a)&&b(c)&&(n(".preview-item-bg",this.previewTbody).removeClass("selected"),a=parseInt(a,10),c=parseInt(c,10),this._appConfigPlugin.previewOnDevice({width:a,height:c},!0))},_initQRCode:function(){var b="";window.isXT?b=window.location.protocol+
"//"+window.location.host+path+"apps/"+window.appInfo.id:(b=k.getStandardPortalUrl(window.portalUrl),b=k.setProtocol(b,window.location.protocol),b=window.queryObject.appid?b+"/apps/webappviewer/index.html?appid\x3d"+window.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+window.appInfo.id);new f({text:b,width:75,height:75},this.qrcodeImage);t.setAttr(this.qrcodeDescription,"innerHTML",this.nls.qrcodeDesc);setTimeout(function(){n(".qrcode-image table").style("margin","0px")},100)}})})},"jimu/dijit/QRCode":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","libs/qrcode"],function(p,g){return p([g],{baseClass:"jimu-qrcode",declaredClass:"jimu.dijit.QRCode",postCreate:function(){new QRCode(this.domNode,{text:this.text,width:this.width||128,height:this.height||128,colorDark:this.colorDark||" #000000",colorLight:this.colorLight||"#ffffff",correctLevel:this.correctLevel||QRCode.CorrectLevel.L})}})})},"libs/qrcode":function(){define(["dojo","dijit","dojox"],function(p,g,t){var v;(function(){function g(a){this.mode=b.MODE_8BIT_BYTE;this.data=
a;this.parsedData=[];a=0;for(var c=this.data.length;a<c;a++){var e=[],f=this.data.charCodeAt(a);65536<f?(e[0]=240|(f&1835008)>>>18,e[1]=128|(f&258048)>>>12,e[2]=128|(f&4032)>>>6,e[3]=128|f&63):2048<f?(e[0]=224|(f&61440)>>>12,e[1]=128|(f&4032)>>>6,e[2]=128|f&63):128<f?(e[0]=192|(f&1984)>>>6,e[1]=128|f&63):e[0]=f;this.parsedData.push(e)}this.parsedData=Array.prototype.concat.apply([],this.parsedData);this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),
this.parsedData.unshift(239))}function m(a,b){this.typeNumber=a;this.errorCorrectLevel=b;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}function p(a,b){if(void 0==a.length)throw Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=Array(a.length-c+b);for(b=0;b<a.length-c;b++)this.num[b]=a[b+c]}function k(a,b){this.totalCount=a;this.dataCount=b}function f(){this.buffer=[];this.length=0}function e(){var a=!1,b=navigator.userAgent;/android/i.test(b)&&(a=!0,(aMat=
b.toString().match(/android ([0-9]\.[0-9])/i))&&aMat[1]&&(a=parseFloat(aMat[1])));return a}g.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}};m.prototype={addData:function(a){a=new g(a);this.dataList.push(a);this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},
make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17;this.modules=Array(this.moduleCount);for(var c=0;c<this.moduleCount;c++){this.modules[c]=Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[c][e]=null}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(a,
b);7<=this.typeNumber&&this.setupTypeNumber(a);null==this.dataCache&&(this.dataCache=m.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var e=-1;7>=e;e++)-1>=b+e||this.moduleCount<=b+e||(this.modules[a+c][b+e]=0<=c&&6>=c&&(0==e||6==e)||0<=e&&6>=e&&(0==c||6==c)||2<=c&&4>=c&&2<=e&&4>=e?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,e=0;8>e;e++){this.makeImpl(!0,
e);var f=c.getLostPoint(this);if(0==e||a>f)a=f,b=e}return b},createMovieClip:function(a,b,c){a=a.createEmptyMovieClip(b,c);this.make();for(b=0;b<this.modules.length;b++){c=1*b;for(var e=0;e<this.modules[b].length;e++){var f=1*e;this.modules[b][e]&&(a.beginFill(0,100),a.moveTo(f,c),a.lineTo(f+1,c),a.lineTo(f+1,c+1),a.lineTo(f,c+1),a.endFill())}}return a},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(a=8;a<this.moduleCount-
8;a++)null==this.modules[6][a]&&(this.modules[6][a]=0==a%2)},setupPositionAdjustPattern:function(){for(var a=c.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var e=0;e<a.length;e++){var f=a[b],g=a[e];if(null==this.modules[f][g])for(var k=-2;2>=k;k++)for(var m=-2;2>=m;m++)this.modules[f+k][g+m]=-2==k||2==k||-2==m||2==m||0==k&&0==m?!0:!1}},setupTypeNumber:function(a){for(var b=c.getBCHTypeNumber(this.typeNumber),e=0;18>e;e++){var f=!a&&1==(b>>e&1);this.modules[Math.floor(e/3)][e%3+this.moduleCount-
8-3]=f}for(e=0;18>e;e++)f=!a&&1==(b>>e&1),this.modules[e%3+this.moduleCount-8-3][Math.floor(e/3)]=f},setupTypeInfo:function(a,b){b=c.getBCHTypeInfo(this.errorCorrectLevel<<3|b);for(var e=0;15>e;e++){var f=!a&&1==(b>>e&1);6>e?this.modules[e][8]=f:8>e?this.modules[e+1][8]=f:this.modules[this.moduleCount-15+e][8]=f}for(e=0;15>e;e++)f=!a&&1==(b>>e&1),8>e?this.modules[8][this.moduleCount-e-1]=f:9>e?this.modules[8][15-e-1+1]=f:this.modules[8][15-e-1]=f;this.modules[this.moduleCount-8][8]=!a},mapData:function(a,
b){for(var e=-1,f=this.moduleCount-1,g=7,k=0,m=this.moduleCount-1;0<m;m-=2)for(6==m&&m--;;){for(var n=0;2>n;n++)if(null==this.modules[f][m-n]){var p=!1;k<a.length&&(p=1==(a[k]>>>g&1));c.getMask(b,f,m-n)&&(p=!p);this.modules[f][m-n]=p;g--; -1==g&&(k++,g=7)}f+=e;if(0>f||this.moduleCount<=f){f-=e;e=-e;break}}}};m.PAD0=236;m.PAD1=17;m.createData=function(a,b,e){b=k.getRSBlocks(a,b);for(var g=new f,n=0;n<e.length;n++){var p=e[n];g.put(p.mode,4);g.put(p.getLength(),c.getLengthInBits(p.mode,a));p.write(g)}for(n=
a=0;n<b.length;n++)a+=b[n].dataCount;if(g.getLengthInBits()>8*a)throw Error("code length overflow. ("+g.getLengthInBits()+"\x3e"+8*a+")");for(g.getLengthInBits()+4<=8*a&&g.put(0,4);0!=g.getLengthInBits()%8;)g.putBit(!1);for(;!(g.getLengthInBits()>=8*a);){g.put(m.PAD0,8);if(g.getLengthInBits()>=8*a)break;g.put(m.PAD1,8)}return m.createBytes(g,b)};m.createBytes=function(a,b){for(var e=0,f=0,g=0,k=Array(b.length),m=Array(b.length),n=0;n<b.length;n++){var q=b[n].dataCount,w=b[n].totalCount-q,f=Math.max(f,
q),g=Math.max(g,w);k[n]=Array(q);for(var x=0;x<k[n].length;x++)k[n][x]=255&a.buffer[x+e];e+=q;x=c.getErrorCorrectPolynomial(w);q=(new p(k[n],x.getLength()-1)).mod(x);m[n]=Array(x.getLength()-1);for(x=0;x<m[n].length;x++)w=x+q.getLength()-m[n].length,m[n][x]=0<=w?q.get(w):0}for(x=n=0;x<b.length;x++)n+=b[x].totalCount;a=Array(n);for(x=e=0;x<f;x++)for(n=0;n<b.length;n++)x<k[n].length&&(a[e++]=k[n][x]);for(x=0;x<g;x++)for(n=0;n<b.length;n++)x<m[n].length&&(a[e++]=m[n][x]);return a};for(var b={MODE_NUMBER:1,
MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},a={L:1,M:0,Q:3,H:2},c={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,
86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;0<=c.getBCHDigit(b)-c.getBCHDigit(c.G15);)b^=c.G15<<c.getBCHDigit(b)-c.getBCHDigit(c.G15);return(a<<10|b)^c.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;0<=c.getBCHDigit(b)-c.getBCHDigit(c.G18);)b^=c.G18<<c.getBCHDigit(b)-
c.getBCHDigit(c.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return c.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case 0:return 0==(b+c)%2;case 1:return 0==b%2;case 2:return 0==c%3;case 3:return 0==(b+c)%3;case 4:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case 5:return 0==b*c%2+b*c%3;case 6:return 0==(b*c%2+b*c%3)%2;case 7:return 0==(b*c%3+(b+c)%2)%2;default:throw Error("bad maskPattern:"+a);}},getErrorCorrectPolynomial:function(a){for(var b=
new p([1],0),c=0;c<a;c++)b=b.multiply(new p([1,x.gexp(c)],0));return b},getLengthInBits:function(a,c){if(1<=c&&10>c)switch(a){case b.MODE_NUMBER:return 10;case b.MODE_ALPHA_NUM:return 9;case b.MODE_8BIT_BYTE:return 8;case b.MODE_KANJI:return 8;default:throw Error("mode:"+a);}else if(27>c)switch(a){case b.MODE_NUMBER:return 12;case b.MODE_ALPHA_NUM:return 11;case b.MODE_8BIT_BYTE:return 16;case b.MODE_KANJI:return 10;default:throw Error("mode:"+a);}else if(41>c)switch(a){case b.MODE_NUMBER:return 14;
case b.MODE_ALPHA_NUM:return 13;case b.MODE_8BIT_BYTE:return 16;case b.MODE_KANJI:return 12;default:throw Error("mode:"+a);}else throw Error("type:"+c);},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,e=0;e<b;e++)for(var f=0;f<b;f++){for(var g=0,k=a.isDark(e,f),m=-1;1>=m;m++)if(!(0>e+m||b<=e+m))for(var n=-1;1>=n;n++)0>f+n||b<=f+n||0==m&&0==n||k!=a.isDark(e+m,f+n)||g++;5<g&&(c+=3+g-5)}for(e=0;e<b-1;e++)for(f=0;f<b-1;f++)if(g=0,a.isDark(e,f)&&g++,a.isDark(e+1,f)&&g++,a.isDark(e,f+1)&&g++,
a.isDark(e+1,f+1)&&g++,0==g||4==g)c+=3;for(e=0;e<b;e++)for(f=0;f<b-6;f++)a.isDark(e,f)&&!a.isDark(e,f+1)&&a.isDark(e,f+2)&&a.isDark(e,f+3)&&a.isDark(e,f+4)&&!a.isDark(e,f+5)&&a.isDark(e,f+6)&&(c+=40);for(f=0;f<b;f++)for(e=0;e<b-6;e++)a.isDark(e,f)&&!a.isDark(e+1,f)&&a.isDark(e+2,f)&&a.isDark(e+3,f)&&a.isDark(e+4,f)&&!a.isDark(e+5,f)&&a.isDark(e+6,f)&&(c+=40);for(f=g=0;f<b;f++)for(e=0;e<b;e++)a.isDark(e,f)&&g++;return c+Math.abs(100*g/b/b-50)/5*10}},x={glog:function(a){if(1>a)throw Error("glog("+a+
")");return x.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;256<=a;)a-=255;return x.EXP_TABLE[a]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},w=0;8>w;w++)x.EXP_TABLE[w]=1<<w;for(w=8;256>w;w++)x.EXP_TABLE[w]=x.EXP_TABLE[w-4]^x.EXP_TABLE[w-5]^x.EXP_TABLE[w-6]^x.EXP_TABLE[w-8];for(w=0;255>w;w++)x.LOG_TABLE[x.EXP_TABLE[w]]=w;p.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var e=
0;e<a.getLength();e++)b[c+e]^=x.gexp(x.glog(this.get(c))+x.glog(a.get(e)));return new p(b,0)},mod:function(a){if(0>this.getLength()-a.getLength())return this;for(var b=x.glog(this.get(0))-x.glog(a.get(0)),c=Array(this.getLength()),e=0;e<this.getLength();e++)c[e]=this.get(e);for(e=0;e<a.getLength();e++)c[e]^=x.gexp(x.glog(a.get(e))+b);return(new p(c,0)).mod(a)}};k.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],
[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,
46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,
70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,
46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],
[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,
46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];k.getRSBlocks=function(a,b){var c=k.getRsBlockTable(a,b);if(void 0==c)throw Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);a=c.length/3;b=[];for(var e=0;e<a;e++)for(var f=c[3*e+0],g=c[3*e+1],m=c[3*e+2],n=0;n<f;n++)b.push(new k(g,m));return b};k.getRsBlockTable=function(b,
c){switch(c){case a.L:return k.RS_BLOCK_TABLE[4*(b-1)+0];case a.M:return k.RS_BLOCK_TABLE[4*(b-1)+1];case a.Q:return k.RS_BLOCK_TABLE[4*(b-1)+2];case a.H:return k.RS_BLOCK_TABLE[4*(b-1)+3]}};f.prototype={get:function(a){return 1==(this.buffer[Math.floor(a/8)]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0);a&&(this.buffer[b]|=
128>>>this.length%8);this.length++}};var q=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,
805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],w=function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){function b(a,b){a=document.createElementNS("http://www.w3.org/2000/svg",a);for(var c in b)b.hasOwnProperty(c)&&a.setAttribute(c,
b[c]);return a}var c=this._htOption,e=this._el,f=a.getModuleCount();this.clear();var g=b("svg",{viewBox:"0 0 "+String(f)+" "+String(f),width:"100%",height:"100%",fill:c.colorLight});g.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");e.appendChild(g);g.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(c=0;c<f;c++)for(e=0;e<f;e++)if(a.isDark(c,e)){var k=b("use",{x:String(c),y:String(e)});k.setAttributeNS("http://www.w3.org/1999/xlink",
"href","#template");g.appendChild(k)}};a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)};return a}(),t="svg"===document.documentElement.tagName.toLowerCase()?w:"undefined"==typeof CanvasRenderingContext2D?function(){var a=function(a,b){this._el=a;this._htOption=b};a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,e=a.getModuleCount(),f=Math.floor(b.width/e),g=Math.floor(b.height/e),k=['\x3ctable style\x3d"border:0;border-collapse:collapse;"\x3e'],
m=0;m<e;m++){k.push("\x3ctr\x3e");for(var n=0;n<e;n++)k.push('\x3ctd style\x3d"border:0;border-collapse:collapse;padding:0;margin:0;width:'+f+"px;height:"+g+"px;background-color:"+(a.isDark(m,n)?b.colorDark:b.colorLight)+';"\x3e\x3c/td\x3e');k.push("\x3c/tr\x3e")}k.push("\x3c/table\x3e");c.innerHTML=k.join("");a=c.childNodes[0];c=(b.width-a.offsetWidth)/2;b=(b.height-a.offsetHeight)/2;0<c&&0<b&&(a.style.margin=b+"px "+c+"px")};a.prototype.clear=function(){this._el.innerHTML=""};return a}():function(){function a(){this._elImage.src=
this._elCanvas.toDataURL("image/png");this._elImage.style.display="block";this._elCanvas.style.display="none"}function b(a,b){var c=this;c._fFail=b;c._fSuccess=a;null===c._bSupportDataURI?(a=document.createElement("img"),b=function(){c._bSupportDataURI=!1;c._fFail&&_fFail.call(c)},a.onabort=b,a.onerror=b,a.onload=function(){c._bSupportDataURI=!0;c._fSuccess&&c._fSuccess.call(c)},a.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg\x3d\x3d"):
!0===c._bSupportDataURI&&c._fSuccess?c._fSuccess.call(c):!1===c._bSupportDataURI&&c._fFail&&c._fFail.call(c)}if(this._android&&2.1>=this._android){var c=1/window.devicePixelRatio,f=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,g,k,m,n,p,q){if("nodeName"in a&&/img/i.test(a.nodeName))for(var w=arguments.length-1;1<=w;w--)arguments[w]*=c;else"undefined"==typeof p&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);f.apply(this,
arguments)}}var g=function(a,b){this._bIsPainted=!1;this._android=e();this._htOption=b;this._elCanvas=document.createElement("canvas");this._elCanvas.width=b.width;this._elCanvas.height=b.height;a.appendChild(this._elCanvas);this._el=a;this._oContext=this._elCanvas.getContext("2d");this._bIsPainted=!1;this._elImage=document.createElement("img");this._elImage.alt="Scan me!";this._elImage.style.display="none";this._el.appendChild(this._elImage);this._bSupportDataURI=null};g.prototype.draw=function(a){var b=
this._elImage,c=this._oContext,e=this._htOption,f=a.getModuleCount(),g=e.width/f,k=e.height/f,m=Math.round(g),n=Math.round(k);b.style.display="none";this.clear();for(b=0;b<f;b++)for(var p=0;p<f;p++){var q=a.isDark(b,p),w=p*g,x=b*k;c.strokeStyle=q?e.colorDark:e.colorLight;c.lineWidth=1;c.fillStyle=q?e.colorDark:e.colorLight;c.fillRect(w,x,g,k);c.strokeRect(Math.floor(w)+.5,Math.floor(x)+.5,m,n);c.strokeRect(Math.ceil(w)-.5,Math.ceil(x)-.5,m,n)}this._bIsPainted=!0};g.prototype.makeImage=function(){this._bIsPainted&&
b.call(this,a)};g.prototype.isPainted=function(){return this._bIsPainted};g.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height);this._bIsPainted=!1};g.prototype.round=function(a){return a?Math.floor(1E3*a)/1E3:a};return g}();v=function(b,c){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:a.H};"string"===typeof c&&(c={text:c});if(c)for(var f in c)this._htOption[f]=c[f];"string"==typeof b&&(b=document.getElementById(b));
this._android=e();this._el=b;this._oQRCode=null;this._oDrawing=new t(this._el,this._htOption);this._htOption.text&&this.makeCode(this._htOption.text)};v.prototype.makeCode=function(b){var c=this._htOption.correctLevel,e=1,f;f=encodeURI(b).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");f=f.length+(f.length!=b?3:0);for(var g=0,k=q.length;g<=k;g++){var n=0;switch(c){case a.L:n=q[g][0];break;case a.M:n=q[g][1];break;case a.Q:n=q[g][2];break;case a.H:n=q[g][3]}if(f<=n)break;else e++}if(e>q.length)throw Error("Too long data");
this._oQRCode=new m(e,this._htOption.correctLevel);this._oQRCode.addData(b);this._oQRCode.make();this._el.title=b;this._oDrawing.draw(this._oQRCode);this.makeImage()};v.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||3<=this._android)&&this._oDrawing.makeImage()};v.prototype.clear=function(){this._oDrawing.clear()};v.CorrectLevel=a;window.QRCode=v})()})},"dojox/main":function(){define(["dojo/_base/kernel"],function(p){return p.dojox})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),
function(p,g,t,v,n,m){var u=function(f){f=f||{};var e=t.getLocalization("dojo.cldr","number",t.normalizeLocale(f.locale)),b=f.pattern?f.pattern:e[(f.type||"decimal")+"Format"];f="number"==typeof f.places?f.places:"string"===typeof f.places&&0<f.places.length?f.places.replace(/.*,/,""):-1!=b.indexOf(".")?b.split(".")[1].replace(/[^#0]/g,"").length:0;return{sep:e.decimal,places:f}},k=p("dijit.form.NumberTextBoxMixin",null,{pattern:function(f){return"("+(this.focused&&this.editOptions?this._regExpGenerator(g.delegate(f,
this.editOptions))+"|":"")+this._regExpGenerator(f)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:n.format,_regExpGenerator:n.regexp,_decimalInfo:u(),postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},_setConstraintsAttr:function(f){var e="number"==typeof f.places?f.places:0;e&&e++;"number"!=typeof f.max&&(f.max=9*Math.pow(10,15-e));"number"!=typeof f.min&&(f.min=-9*Math.pow(10,15-e));this.inherited(arguments,[f]);this.focusNode&&this.focusNode.value&&
!isNaN(this.value)&&this.set("value",this.value);this._decimalInfo=u(f)},_onFocus:function(f){if(!this.disabled&&!this.readOnly){var e=this.get("value");"number"!=typeof e||isNaN(e)||(e=this.format(e,this.constraints),void 0!==e&&(this.textbox.value=e,"mouse"!==f&&this.textbox.select()));this.inherited(arguments)}},format:function(f,e){var b=String(f);if("number"!=typeof f)return b;if(isNaN(f))return"";if(!("rangeCheck"in this&&this.rangeCheck(f,e))&&!1!==e.exponent&&/\de[-+]?\d/i.test(b))return b;
this.editOptions&&this.focused&&(e=g.mixin({},e,this.editOptions));return this._formatter(f,e)},_parser:n.parse,parse:function(f,e){var b=g.mixin({},e,this.editOptions&&this.focused?this.editOptions:{});if(this.focused&&null!=b.places){var a=b.places,a="number"===typeof a?a:Number(a.split(",").pop());b.places="0,"+a}b=this._parser(f,b);this.editOptions&&this.focused&&isNaN(b)&&(b=this._parser(f,e));return b},_getDisplayedValueAttr:function(){var f=this.inherited(arguments);return isNaN(f)?this.textbox.value:
f},filter:function(f){if(null==f||"string"==typeof f&&""==f)return NaN;"number"!=typeof f||isNaN(f)||0==f||(f=n.round(f,this._decimalInfo.places));return this.inherited(arguments,[f])},serialize:function(f,e){return"number"!=typeof f||isNaN(f)?"":this.inherited(arguments)},_setBlurValue:function(){var f=g.hitch(g.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(f,!0)},_setValueAttr:function(f,e,b){if(void 0!==f&&void 0===b)if(b=String(f),"number"==typeof f)if(isNaN(f))b="";else{if("rangeCheck"in
this&&this.rangeCheck(f,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(b))b=void 0}else f?f=void 0:(b="",f=NaN);this.inherited(arguments,[f,e,b])},_getValueAttr:function(){var f=this.inherited(arguments);if(isNaN(f)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&(new RegExp("^"+n._realNumberRegexp(g.delegate(this.constraints))+"$")).test(this.textbox.value))return f=Number(this.textbox.value),isNaN(f)?void 0:f}else return f},
isValid:function(f){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var e=this.get("value");return!isNaN(e)&&this.rangeCheck(e,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var f="number"==typeof this.constraints.min,e="number"==typeof this.constraints.max,b=this.get("value");if(isNaN(b)||!f&&!e)return this.inherited(arguments);var a=b|0,c=0>b,g=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),
k=(this.maxLength||20)-this.textbox.value.length,m=g?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",a=g?a+"."+m:a+"",k=v.rep("9",k),g=b;c?g=Number(a+k):b=Number(a+k);return!(f&&b<this.constraints.min||e&&g>this.constraints.max)}});p=p("dijit.form.NumberTextBox",[m,k],{baseClass:"dijitTextBox dijitNumberTextBox"});p.Mixin=k;return p})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(p,
g,t){return p("dijit.form.RangeBoundTextBox",t,{rangeMessage:"",rangeCheck:function(g,n){return("min"in n?0<=this.compare(g,n.min):!0)&&("max"in n?0>=this.compare(g,n.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var g=this.get("value");if(null==g)return!1;var n=!1;"min"in this.constraints&&(n=this.constraints.min,n=0>this.compare(g,"number"==typeof n&&0<=n&&0!=g?0:n));!n&&"max"in this.constraints&&(n=this.constraints.max,
n=0<this.compare(g,"number"!=typeof n||0<n?n:0));return n},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(g){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(g))},getErrorMessage:function(g){var n=this.get("value");return null==n||""===n||"number"==typeof n&&isNaN(n)||this.isInRange(g)?this.inherited(arguments):this.rangeMessage},postMixInProperties:function(){this.inherited(arguments);
this.rangeMessage||(this.messages=g.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(p,g,t,v){return p("dijit.form.MappedTextBox",v,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(g){return g.toString?g.toString():""},toString:function(){var g=
this.filter(this.get("value"));return null!=g?"string"==typeof g?g:this.serialize(g,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=t.place("\x3cinput type\x3d'hidden'"+(this.name&&!g("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"builder/plugins/app-config-template-configpart/_build-generate_module":function(){define(["builder/plugins/app-config-template-configpart/Plugin",
"dojo/text!builder/plugins/app-config-template-configpart/Plugin.html","dojo/text!builder/plugins/app-config-template-configpart/css/style.css","dojo/i18n!builder/plugins/app-config-template-configpart/nls/strings"],function(){})},"builder/plugins/app-config-template-configpart/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/html dojo/promise/all dojo/_base/array dojo/topic builder/BasePlugin jimu/utils builder/dijit/TemplateAttributes".split(" "),function(p,
g,t,v,n,m,u,k,f,e){return p([k],{baseClass:"plugin-appconfig-template-configpart",_appConfig:null,_appConfigLoadDef:null,postCreate:function(){this.inherited(arguments);this._appConfigLoadDef=new t;this._updateDom();this._bindEvent()},startup:function(){this.inherited(arguments);this.isAdvance=!1;n({appConfig:this._appConfigLoadDef}).then(g.hitch(this,function(){this._init()}))},_updateDom:function(){"HTML3D"===window.appInfo.appType&&(v.setAttr(this.mapTitle,"innerHTML",this.nls.scene),v.setAttr(this.selectMapBtn,
"innerHTML",this.nls.chooseWebScene))},_init:function(){if(this.visible&&this._appConfig){var b=this._getCleanTemplateConfigByAppConfig(this._appConfig.templateConfig);this.agoltempAttrs&&this.agoltempAttrs.destroy();this.agoltempAttrs=(new e({templateConfig:b})).placeAt(this.configPart);this.agoltempAttrs.on("fieldChanged",g.hitch(this,this._onAGOLTemplateAttributeChanged))}},_getCleanTemplateConfigByAppConfig:function(b){var a={configurationSettings:[],values:{}};if(b)return m.forEach(b.configurationSettings,
function(b){var c={category:b.category,fields:[]};m.forEach(b.fields,function(b){if(b.fieldName){var e=f.template.getConfigValueWithId(this._appConfig,b.fieldName);void 0!==e&&(c.fields.push(b),a.values[b.fieldName]=e)}},this);0<c.fields.length&&a.configurationSettings.push(c)},this),a},_getTemplateAppConfigByTemplateConfig:function(b,a){var c=this._getDefaultTemplateAppConfig();if(a)return m.forEach(a.configurationSettings,function(a){m.forEach(a.fields,function(a){if(a.fieldName){var e=f.template.getConfigValueWithId(b,
a.fieldName);void 0!==e&&(c.values[a.fieldName]=e)}},this)},this),c},_getChangedTemplateAppConfigFromTemplateAttirbuts:function(b){var a=this._getDefaultTemplateAppConfig(),c=this.agoltempAttrs.getElementDijits(),e;for(e in c)if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var g=f.template.getConfigValueWithId(b,e);void 0!==g&&g!==c[e].getDijitValue()&&(a.values[e]=g)}return a},_getDefaultTemplateConfig:function(){return{configurationSettings:[{category:"",fields:[]}],values:{}}},_getDefaultTemplateAppConfig:function(){return{source:null,
folderId:null,values:{}}},_onAGOLTemplateAttributeChanged:function(b){f.template.setConfigValueWithId(this._appConfig,b.fieldName,b.value);"Attribute"===b.categoryName?u.publish("appAttributeChanged",{title:this._appConfig.title,subtitle:this._appConfig.subtitle,links:this._appConfig.links,logo:this._appConfig.logo}):(b=f.template.getKeyInfo(b.fieldName),"widget"===b.type?(b=this._appConfig.getConfigElementById(b.id),u.publish("widgetChanged",b)):"group"===b.type?(b=this._appConfig.getConfigElementById(b.id),
u.publish("groupChanged",b)):console.errror("errror"))},_bindEvent:function(){this.own(u.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)));this.own(u.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.own(u.subscribe("new-webmap-item-selected",g.hitch(this,this._onWebmapItemSelected)));this.own(u.subscribe("app/mapLoaded",g.hitch(this,this._onMapLoaded)))},_onAppConfigLoaded:function(b){this._appConfig=g.clone(b);this._appConfigLoadDef.resolve(this._appConfig)},
_onAppConfigChanged:function(b){this._appConfig=g.clone(b)},_onSelectMapClick:function(){var b=this.pluginManager.getPluginByName("map-config");b&&b.showMapSelector()},_onWebmapItemSelected:function(b){v.setAttr(this.mapName,"innerHTML",b.title);v.setAttr(this.mapName,"title",b.title)},_onMapLoaded:function(b){v.setAttr(this.mapName,"innerHTML",b.itemInfo.item.title);v.setAttr(this.mapName,"title",b.itemInfo.item.title)},refresh:function(){this._init()}})})},"builder/dijit/TemplateAttributes":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/html dojo/on dojo/promise/all dojo/Evented jimu/utils dijit/_WidgetBase dijit/_TemplatedMixin dijit/form/_FormMixin dijit/Tooltip dijit/form/CheckBox dijit/form/NumberTextBox dijit/form/Select dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/Editor esri/dijit/ColorPicker dijit/_editor/plugins/TextColor dijit/_editor/plugins/LinkDialog".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B){var G=p([e,b,a,k],{templateString:'\x3cdiv dojoAttachPoint\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"agoltemplate-attributes",item:null,itemTitle:null,defaultMaxSelectHeight:"150px",defaultTextAreaSize:5,_appConfig:null,_templateConfig:null,_templateAppConfig:null,_elementDijits:null,constructor:function(a){this.nls=g.mixin(this.nls,builderNls);this._init(a.templateConfig,a.templateAppConfig)},destroy:function(){t.forEach(this.tooltips,function(a){a.destroy()});
this.inherited(arguments)},startup:function(){this.buildConfigurationPanel();this.inherited(arguments)},update:function(a){for(var b in a.values)a.values.hasOwnProperty(b)&&"function"!==typeof a.values[b]&&this._elementDijits[b].setDijitValue(a.values[b])},getElementDijits:function(){return this._elementDijits},getTemplateAppConfig:function(){var a=this._getValuesObjOfElementDijits();g.mixin(this._templateAppConfig.values,a);return this._templateAppConfig},onFieldChange:function(a,b,c){this.emit("fieldChanged",
{categoryName:a,fieldName:b,value:c})},_init:function(a,b){this._templateConfig=a||{configurationSettings:{},values:{}};this._templateAppConfig=b||{source:null,folderId:null,values:{webmap:null}};g.mixin(this._templateConfig.values,this._templateAppConfig.values);this._elementDijits={};this._templateConfig.configurationSettings&&this._templateAppConfig.values||console.error("AGOLTemplate config page: please provide correct parameters in the constructor");this.tooltips=[];this.originalItem={id:this._templateConfig.values.webmap||
this._templateConfig.values.group,type:this._templateConfig.values.webmap?"webmap":"group"}},_getWebmapOrGroupItem:function(a,b){var c=new v;try{"webmap"===b?this.portal.queryItems({q:"id:"+a}).then(g.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()})):this.portal.queryGroups({q:"id:"+a}).then(g.hitch(this,function(a){0<a.results.length&&(this.item=a=a.results[0],this.itemTitle=a.title);c.resolve()}))}catch(K){c.resolve()}return c.promise},buildConfigurationPanel:function(){var a=
[];t.forEach(this._templateConfig.configurationSettings,g.hitch(this,function(b){var e=b.category,f=b.fields,k=n.create("fieldset",{},this.containerNode);n.create("legend",g.mixin(b.params||{},{innerHTML:e}),k);t.forEach(f,g.hitch(this,function(b){a.push(this._createField(b,e).then(g.hitch(this,function(a){t.forEach(a.nodes,function(a){n.place(a.domNode||a,k)});n.create("br",{},k);"paragraph"!==a.type&&null!==a.fieldDijit&&b.tooltip&&b.tooltip.length&&this.tooltips.push(new c({connectId:[a.fieldDijit.id],
label:b.tooltip}))})))}))}));u(a).then(g.hitch(this,function(){}))},_createField:function(a,b){var c=new v,e=null,g=a.type&&a.type.toLowerCase()||"string",k=[],m=n.create("layerandfieldselector"===g?"p":"label",{innerHTML:f.stripHTML(a.label)||"",id:g+"_"+a.fieldName,"class":g},null);k.push(m);"boolean"===g?(k.splice(0,0,e=this._createBooleanField(a,b)),n.addClass(m,"checkout-box-label")):"number"===g?k.push(e=this._createNumberField(a,b)):"paragraph"===g?k.splice(0,1,e=this._createParagraph(a)):
a.options?k.push(e=this._createOptionsField(a,b)):"color"===g?k.push(e=this._createColor(a,b)):k.push(e=this._createStringField(a,b));n.setAttr(m,"for",e.id);c.resolve({nodes:k,fieldDijit:e,type:g});return c.promise},_createBooleanField:function(a,b){var c=g.mixin({value:!0,name:a.fieldName},a),e=this._templateConfig.values;c.checked=e&&void 0!==e[a.fieldName]?e[a.fieldName]:!0;c=new x(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createNumberField:function(a,b){var c=g.mixin({name:a.fieldName,
"class":"field-input"},a),e=this._templateConfig.values;c.value=e&&void 0!==e[a.fieldName]?e[a.fieldName]:a.min||NaN;c=new w(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createParagraph:function(a){var b=g.mixin({name:a.fieldName||""},a);b.innerHTML=a.value||"";return n.create("p",b)},_createOptionsField:function(a,b){var c={maxHeight:this.defaultMaxSelectHeight,name:a.fieldName,"class":"field-input"},c=g.mixin(c,a),e=-1,f=t.some(c.options,g.hitch(this,function(b,c){e=c;return b.value===
this._templateConfig.values[a.fieldName]?c:!1}));c.options[f?e:0].selected=!0;c=new q(c);this._afterCreateNormalField(c,b,a.fieldName);return c},_createStringField:function(a,b){var c=null,c={regExp:".*",constraints:{},trim:!0,name:a.fieldName,value:(this._templateConfig.values[a.fieldName]||"").toString(),"class":" "},c=g.mixin(c,a);a.stringFieldOption&&a.stringFieldOption===G.STRING_FIELD_OPTION_TEXTAREA?(c["class"]+=" field-input text-area-field",c.rows=a.rows||this.defaultTextAreaSize,c.columns=
a.columns||this.defaultTextAreaSize,c=new z(c)):a.stringFieldOption&&a.stringFieldOption===G.STRING_FIELD_OPTION_RICHTEXT?(c["class"]+=" rich-text-field",c.plugins="bold italic underline foreColor hiliteColor removeFormat | justifyLeft indent outdent | insertOrderedList insertUnorderedList |".split(" "),c.extraPlugins=["createLink","unlink","insertImage"],c=new E(c)):(c["class"]+=" field-input",c=new C(c));this._afterCreateNormalField(c,b,a.fieldName);return c},_createColor:function(a,b){var c=new B({name:a.fieldName,
required:!0,showTransparencySlider:!1,showRecentColors:!1,"class":"color-picker-field"});this._templateConfig.values[a.fieldName]&&c.set("color",this._templateConfig.values[a.fieldName]);c.setDijitValue=g.hitch(c,function(a){this.set("color",a,!1)});c.getDijitValue=g.hitch(c,function(){this.get("color")});this._elementDijits[a.fieldName]=c;c.on("color-change",g.hitch(this,function(c){if(c&&c.color)this.onFieldChange(b,a.fieldName,c.color.toHex())}));return c},_afterCreateNormalField:function(a,b,
c){a.setDijitValue=g.hitch(a,function(a){this.set("value",a,!1)});a.getDijitValue=g.hitch(a,function(){return this.get("value")});this._elementDijits[c]=a;this.own(m(a,"change",g.hitch(this,this.onFieldChange,b,c)))},_getValuesObjOfElementDijits:function(){var a={},b=this.getElementDijits(),c;for(c in b)b.hasOwnProperty(c)&&"function"!==typeof b[c]&&(a[c]=b[c].getDijitValue());return a}});g.mixin(G,{STRING_FIELD_OPTION_TEXTBOX:"textbox",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_RICHTEXT:"richtext"});
return G})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),function(p,g,t,v,n,m,u,k,f){v("dijit-legacy-requires")&&m(0,function(){p(["dijit/form/RadioButton"])});return g("dijit.form.CheckBox",[u,k],{templateString:f,baseClass:"dijitCheckBox",_setValueAttr:function(e,b){"string"==typeof e&&(this.inherited(arguments),e=!0);
this._created&&this.set("checked",e,b)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},_fillContent:function(){},_onFocus:function(){this.id&&n("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&n("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},
"dijit/form/ToggleButton":function(){define(["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(p,g,t,v){return p("dijit.form.ToggleButton",[t,v],{baseClass:"dijitToggleButton",setChecked:function(n){g.deprecated("setChecked("+n+") is deprecated. Use set('checked',"+n+") instead.","","2.0");this.set("checked",n)}})})},"dijit/form/_ToggleButtonMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,g){return p("dijit.form._ToggleButtonMixin",null,
{checked:!1,_aria_attr:"aria-pressed",_onClick:function(g){var p=this.checked;this._set("checked",!p);var n=this.inherited(arguments);this.set("checked",n?this.checked:p);return n},_setCheckedAttr:function(p,v){this._set("checked",p);var n=this.focusNode||this.domNode;this._created&&g.get(n,"checked")!=!!p&&g.set(n,"checked",!!p);n.setAttribute(this._aria_attr,String(p));this._handleOnChange(p,v)},postCreate:function(){this.inherited(arguments);var g=this.focusNode||this.domNode;this.checked&&g.setAttribute("checked",
"checked");void 0===this._resetValue&&(this._lastValueReported=this._resetValue=this.checked)},reset:function(){this._hasBeenBlurred=!1;this.set("checked",this.params.checked||!1)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,g){return p("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(p){this._set("readOnly",p);g.set(this.focusNode,"readOnly",p)},_setLabelAttr:void 0,
_getSubmitValue:function(g){return null==g||""===g?"on":g},_setValueAttr:function(p){p=this._getSubmitValue(p);this._set("value",p);g.set(this.focusNode,"value",p)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));g.set(this.focusNode,"value",this.value)},_onClick:function(g){return this.readOnly?(g.stopPropagation(),g.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){function B(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(k.hitch(this,a,b))}}var G=g("dijit.form._SelectMenu",c,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(f(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;
k.isArray(b)&&(b=b[b.length-1]);b&&p.forEach(this.parentWidget._getChildren(),function(c){c.option&&b===c.option.value&&(a=!0,this.focusChild(c,!1))},this);a||this.inherited(arguments)}});n=g("dijit.form.Select"+(e("dojo-bidi")?"_NoBidi":""),[b,a,C],{baseClass:"dijitSelect dijitValidationTextBox",templateString:E,_buttonInputDisabled:e("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new G({id:this.id+"_menu",parentWidget:this});v.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(a){if(a.value||a.label){var b=k.hitch(this,"_setValueAttr",a);a=new x({option:a,label:("text"===this.labelType?(a.label||"").toString().replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a.label)||this.emptyLabel,
onClick:b,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:a.disabled||!1});a.focusNode.setAttribute("role","option");return a}return new w({ownerDocument:this.ownerDocument})},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return this.dropDown?this.dropDown.getChildren():[]},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(F){}},focusChild:function(a){a&&this.set("value",
a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=z.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,c,e){a&&this.focusChild(a)},_loadChildren:function(a){if(!0===a)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{p.forEach(this._getChildren(),function(a){a.destroyRecursive()});
var b=new x({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);t.set(this.valueNode,"value",this.get("value"));this._refreshState()},_setNameAttr:"valueNode",
_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?q.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):q.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);q.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=m.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(f(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[u.LEFT_ARROW];delete a[u.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
v.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);q.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){q.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
e("dojo-bidi")&&(n=g("dijit.form.Select",n,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));n._Menu=G;n.prototype._onContainerKeydown=B("_onContainerKeydown");n.prototype._onContainerKeypress=B("_onContainerKeypress");return n})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){return n("dijit.form._FormSelectWidget",c,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(f.isArrayLike(a))return p.map(a,"return this.getOptions(item);",this);f.isString(a)&&(a={value:a});f.isObject(a)&&(p.some(b,function(b,c){for(var e in a)if(!(e in b)||b[e]!=a[e])return!1;a=c;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){p.forEach(f.isArrayLike(a)?a:[a],function(a){a&&f.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(f.isArrayLike(a)?
a:[a]);p.forEach(a,function(a){a&&(this.options=p.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){p.forEach(f.isArrayLike(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){k.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(c,e,k){var m=this.store;k=k||{};if(m!==c){for(var n;n=this._notifyConnections.pop();)n.remove();c.get||(f.mixin(c,{_oldAPI:!0,get:function(a){var b=new g;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(b,c){var e=new g(function(){k.abort&&k.abort()});e.total=new g;var k=this.fetch(f.mixin({query:b,onBegin:function(a){e.total.resolve(a)},
onComplete:function(a){e.resolve(a)},onError:function(a){e.reject(a)}},c));return new a(e)}}),c.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[t.after(c,"onNew",f.hitch(this,"_onNewItem"),!0),t.after(c,"onDelete",f.hitch(this,"_onDeleteItem"),!0),t.after(c,"onSet",f.hitch(this,"_onSetItem"),!0)]));this._set("store",c)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);k.query&&this._set("query",k.query);k.queryOptions&&this._set("queryOptions",k.queryOptions);c&&c.query&&(this._loadingStore=!0,this.onLoadDeferred=new g,this._queryRes=c.query(this.query,this.queryOptions),b(this._queryRes,f.hitch(this,function(a){if(this.sortByLabel&&!k.sort&&a.length)if(c.getValue)a.sort(v.createSortFunction([{attribute:c.getLabelAttributes(a[0])[0]}],c));else{var b=this.labelAttr;a.sort(function(a,c){return a[b]>c[b]?1:c[b]>
a[b]?-1:0})}k.onFetch&&(a=k.onFetch.call(this,a,k));p.forEach(a,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(f.hitch(this,function(a,b,c){b==c?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=c&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:e);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(a):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),f.hitch(this,function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)})));return m},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=f.isArrayLike(a)?p.map(a,function(a){return f.isObject(a)?a:{value:a}}):f.isObject(a)?[a]:[{value:a}];a=p.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];this.multiple||a[0]&&a[0].value||!c.length||(a[0]=
c[0]);p.forEach(c,function(b){b.selected=p.some(a,function(a){return a.value===b.value})});c=p.map(a,function(a){return a.value});if("undefined"!=typeof c&&"undefined"!=typeof c[0]){var e=p.map(a,function(a){return a.label});this._setDisplay(this.multiple?e:e[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=p.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?
a:a[0]},_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(p.forEach(this._getChildren(),function(a){a.destroyRecursive()}),p.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;p.forEach(this._getChildren(),function(c){var e=p.some(a,function(a){return c.option&&
a===c.option.value});e&&!b.multiple&&(b.focusedChild=c);u.toggle(c.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),e);c.domNode.setAttribute("aria-selected",e?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=p.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?p.map(p.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){b&&b.parent||this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);m.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?e("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+k._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);t.after(this,"onChange",f.hitch(this,"_updateSelection"));var a=this.store;a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"])&&(this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions}));this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dijit/_HasDropDown":function(){define("dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on dojo/touch ./registry ./focus ./popup ./_FocusMixin".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){return p("dijit._HasDropDown",q,{_buttonNode:null,_arrowWrapperNode:null,
_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:!0,forceWidth:!1,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:!0,_onDropDownMouseDown:function(c){this.disabled||this.readOnly||("MSPointerDown"!=c.type&&c.preventDefault(),this.own(b.once(this.ownerDocument,a.release,e.hitch(this,"_onDropDownMouseUp"))),this.toggleDropDown())},_onDropDownMouseUp:function(a){var b=this.dropDown,e=!1;if(a&&this._opened){var f=m.position(this._buttonNode,!0);if(!(a.pageX>=f.x&&a.pageX<=
f.x+f.w&&a.pageY>=f.y&&a.pageY<=f.y+f.h)){for(f=a.target;f&&!e;)n.contains(f,"dijitPopup")?e=!0:f=f.parentNode;if(e){f=a.target;if(b.onItemClick){for(var g;f&&!(g=c.byNode(f));)f=f.parentNode;if(g&&g.onClick&&g.getParent)g.getParent().onItemClick(g,a)}return}}}this._opened?b.focus&&(!1!==b.autoFocus||"mouseup"==a.type&&!this.hovering)&&(this._focusDropDownTimer=this.defer(function(){b.focus();delete this._focusDropDownTimer})):this.focus&&this.defer("focus")},_onDropDownClick:function(a){this._stopClickEvents&&
(a.stopPropagation(),a.preventDefault())},buildRendering:function(){this.inherited(arguments);this._buttonNode=this._buttonNode||this.focusNode||this.domNode;this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;var a={after:this.isLeftToRight()?"Right":"Left",before:this.isLeftToRight()?"Left":"Right",above:"Up",below:"Down",left:"Left",right:"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";n.add(this._arrowWrapperNode||this._buttonNode,"dijit"+a+"ArrowButton")},
postCreate:function(){this.inherited(arguments);var c=this.focusNode||this.domNode;this.own(b(this._buttonNode,a.press,e.hitch(this,"_onDropDownMouseDown")),b(this._buttonNode,"click",e.hitch(this,"_onDropDownClick")),b(c,"keydown",e.hitch(this,"_onKey")),b(c,"keyup",e.hitch(this,"_onKeyUp")))},destroy:function(){this._opened&&this.closeDropDown(!0);this.dropDown&&(this.dropDown._destroyed||this.dropDown.destroyRecursive(),delete this.dropDown);this.inherited(arguments)},_onKey:function(a){if(!this.disabled&&
!this.readOnly){var b=this.dropDown,c=a.target;b&&this._opened&&b.handleKey&&!1===b.handleKey(a)?(a.stopPropagation(),a.preventDefault()):b&&this._opened&&a.keyCode==f.ESCAPE?(this.closeDropDown(),a.stopPropagation(),a.preventDefault()):!this._opened&&(a.keyCode==f.DOWN_ARROW||(a.keyCode==f.ENTER||a.keyCode==f.SPACE&&(!this._searchTimer||a.ctrlKey||a.altKey||a.metaKey))&&("input"!==(c.tagName||"").toLowerCase()||c.type&&"text"!==c.type.toLowerCase()))&&(this._toggleOnKeyUp=!0,a.stopPropagation(),
a.preventDefault())}},_onKeyUp:function(){if(this._toggleOnKeyUp){delete this._toggleOnKeyUp;this.toggleDropDown();var a=this.dropDown;a&&a.focus&&this.defer(e.hitch(a,"focus"),1)}},_onBlur:function(){this.closeDropDown(!1);this.inherited(arguments)},isLoaded:function(){return!0},loadDropDown:function(a){a()},loadAndOpenDropDown:function(){var a=new g,b=e.hitch(this,function(){this.openDropDown();a.resolve(this.dropDown)});this.isLoaded()?b():this.loadDropDown(b);return a},toggleDropDown:function(){this.disabled||
this.readOnly||(this._opened?this.closeDropDown(!0):this.loadAndOpenDropDown())},openDropDown:function(){var a=this.dropDown,b=a.domNode,c=this._aroundNode||this.domNode,f=this,g=w.open({parent:this,popup:a,around:c,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){f.closeDropDown(!0)},onCancel:function(){f.closeDropDown(!0)},onClose:function(){v.set(f._popupStateNode,"popupActive",!1);n.remove(f._popupStateNode,"dijitHasDropDownOpen");f._set("_opened",!1)}});if(this.forceWidth||
this.autoWidth&&c.offsetWidth>a._popupWrapper.offsetWidth){var c=c.offsetWidth-a._popupWrapper.offsetWidth,k={w:a.domNode.offsetWidth+c};this._origStyle=b.style.cssText;e.isFunction(a.resize)?a.resize(k):m.setMarginBox(b,k);"R"==g.corner[1]&&(a._popupWrapper.style.left=a._popupWrapper.style.left.replace("px","")-c+"px")}v.set(this._popupStateNode,"popupActive","true");n.add(this._popupStateNode,"dijitHasDropDownOpen");this._set("_opened",!0);this._popupStateNode.setAttribute("aria-expanded","true");
this._popupStateNode.setAttribute("aria-owns",a.id);"presentation"===b.getAttribute("role")||b.getAttribute("aria-labelledby")||b.setAttribute("aria-labelledby",this.id);return g},closeDropDown:function(a){this._focusDropDownTimer&&(this._focusDropDownTimer.remove(),delete this._focusDropDownTimer);this._opened&&(this._popupStateNode.setAttribute("aria-expanded","false"),a&&this.focus&&this.focus(),w.close(this.dropDown),this._opened=!1);this._origStyle&&(this.dropDown.domNode.style.cssText=this._origStyle,
delete this._origStyle)}})})},"dijit/popup":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/keys dojo/_base/lang dojo/on ./place ./BackgroundIframe ./Viewport ./main dojo/touch".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){function C(){this._popupWrapper&&(m.destroy(this._popupWrapper),delete this._popupWrapper)}t=t(null,{_stack:[],_beginZIndex:1E3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var a=
this._firstAroundPosition,c=u.position(this._firstAroundNode,!0),e=c.x-a.x,a=c.y-a.y;if(e||a)for(this._firstAroundPosition=c,c=0;c<this._stack.length;c++){var f=this._stack[c].wrapper.style;f.top=parseFloat(f.top)+a+"px";"auto"==f.right?f.left=parseFloat(f.left)+e+"px":f.right=parseFloat(f.right)-e+"px"}this._aroundMoveListener=setTimeout(b.hitch(this,"_repositionAll"),e||a?10:50)}},_createWrapper:function(b){var c=b._popupWrapper,e=b.domNode;c||(c=m.create("div",{"class":"dijitPopup",style:{display:"none"},
role:"region","aria-label":b["aria-label"]||b.label||b.name||b.id},b.ownerDocumentBody),c.appendChild(e),e=e.style,e.display="",e.visibility="",e.position="",e.top="0px",b._popupWrapper=c,g.after(b,"destroy",C,!0),"ontouchend"in document&&a(c,"touchend",function(a){/^(input|button|textarea)$/i.test(a.target.tagName)||a.preventDefault()}),c.dojoClick=!0);return c},moveOffScreen:function(a){var b=this._createWrapper(a);a=u.isBodyLtr(a.ownerDocument);var c={visibility:"hidden",top:"-9999px",display:""};
c[a?"left":"right"]="-9999px";c[a?"right":"left"]="auto";k.set(b,c);return b},hide:function(a){var b=this._createWrapper(a);k.set(b,{display:"none",height:"auto",overflowY:"visible",border:""});a=a.domNode;"_originalStyle"in a&&(a.style.cssText=a._originalStyle)},getTopPopup:function(){for(var a=this._stack,b=a.length-1;0<b&&a[b].parent===a[b-1].widget;b--);return a[b]},open:function(g){for(var m=this._stack,p=g.popup,q=p.domNode,t=g.orient||["below","below-alt","above","above-alt"],z=g.parent?g.parent.isLeftToRight():
u.isBodyLtr(p.ownerDocument),C=g.around,K=g.around&&g.around.id?g.around.id+"_dropdown":"popup_"+this._idGen++;m.length&&(!g.parent||!v.isDescendant(g.parent.domNode,m[m.length-1].widget.domNode));)this.close(m[m.length-1].widget);var J=this.moveOffScreen(p);p.startup&&!p._started&&p.startup();var L,M=u.position(q);if("maxHeight"in g&&-1!=g.maxHeight)L=g.maxHeight||Infinity;else{L=w.getEffectiveBox(this.ownerDocument);var Q=C?u.position(C,!1):{y:g.y-(g.padding||0),h:2*(g.padding||0)};L=Math.floor(Math.max(Q.y,
L.h-(Q.y+Q.h)))}M.h>L&&(M=k.getComputedStyle(q),k.set(J,{overflowY:"scroll",height:L+"px",border:M.borderLeftWidth+" "+M.borderLeftStyle+" "+M.borderLeftColor}),q._originalStyle=q.style.cssText,q.style.border="none");n.set(J,{id:K,style:{zIndex:this._beginZIndex+m.length},"class":"dijitPopup "+(p.baseClass||p["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:g.parent?g.parent.id:""});0==m.length&&C&&(this._firstAroundNode=C,this._firstAroundPosition=u.position(C,!0),this._aroundMoveListener=setTimeout(b.hitch(this,
"_repositionAll"),50));f("config-bgIframe")&&!p.bgIframe&&(p.bgIframe=new x(J));K=p.orient?b.hitch(p,"orient"):null;t=C?c.around(J,C,t,z,K):c.at(J,g,"R"==t?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],g.padding,K);J.style.visibility="visible";q.style.visibility="visible";q=[];q.push(a(J,"keydown",b.hitch(this,function(a){if(a.keyCode==e.ESCAPE&&g.onCancel)a.stopPropagation(),a.preventDefault(),g.onCancel();else if(a.keyCode==e.TAB&&(a.stopPropagation(),a.preventDefault(),(a=this.getTopPopup())&&a.onCancel))a.onCancel()})));
p.onCancel&&g.onCancel&&q.push(p.on("cancel",g.onCancel));q.push(p.on(p.onExecute?"execute":"change",b.hitch(this,function(){var a=this.getTopPopup();if(a&&a.onExecute)a.onExecute()})));m.push({widget:p,wrapper:J,parent:g.parent,onExecute:g.onExecute,onCancel:g.onCancel,onClose:g.onClose,handlers:q});if(p.onOpen)p.onOpen(t);return t},close:function(a){for(var b=this._stack;a&&p.some(b,function(b){return b.widget==a})||!a&&b.length;){var c=b.pop(),e=c.widget,f=c.onClose;e.bgIframe&&(e.bgIframe.destroy(),
delete e.bgIframe);if(e.onClose)e.onClose();for(var g;g=c.handlers.pop();)g.remove();e&&e.domNode&&this.hide(e);f&&f()}0==b.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return q.popup=new t})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(p,g,t,v){return p("dijit.DropDownMenu",v,{templateString:t,baseClass:"dijitMenu",
_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(g){this._moveToPopup(g);g.stopPropagation();g.preventDefault()},_onLeftArrow:function(g){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else g.stopPropagation(),g.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return g("dijit._MenuBase",[a,w,x,c],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){n.toggle(this.domNode,"dijitMenuActive",a);n.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(a){var c=b.byNode(a);return a.parentNode==this.containerNode&&c&&c.focus},postCreate:function(){var a=this,c="string"==typeof this.childSelector?this.childSelector:m.hitch(this,"childSelector");this.own(k(this.containerNode,k.selector(c,u.enter),function(){a.onItemHover(b.byNode(this))}),k(this.containerNode,k.selector(c,u.leave),function(){a.onItemUnhover(b.byNode(this))}),k(this.containerNode,k.selector(c,e),function(c){a.onItemClick(b.byNode(this),c);c.stopPropagation()}),
k(this.containerNode,k.selector(c,"focusin"),function(){a._onItemFocus(b.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(a,b,c,e){this.inherited(arguments);if(a&&(-1==e||a.popup&&1==e))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),!a.popup||a.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;a.popup?(this.set("selected",a),this.set("activated",!0),b=/^key/.test(b._origType||
b.type)||0==b.clientX&&0==b.clientY,this._openItemPopup(a,b)):(this.onExecute(),a._onClick?a._onClick(b):a.onClick(b))},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var c=a.popup;c.parentMenu=this;this.own(this._mouseoverHandle=k.once(c.domNode,"mouseover",m.hitch(this,"_onPopupHover")));var e=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&
e.focusChild(a);e._cleanUp()},onExecute:m.hitch(this,"_cleanUp",!0),onClose:function(){e._mouseoverHandle&&(e._mouseoverHandle.remove(),delete e._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(v.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return g("dijit._KeyNavContainer",[f,e,k],{connectKeyNavHandlers:function(b,a){var c=this._keyNavCodes={},e=m.hitch(this,"focusPrev"),f=m.hitch(this,"focusNext");p.forEach(b,function(a){c[a]=e});p.forEach(a,function(a){c[a]=f});c[n.HOME]=m.hitch(this,"focusFirstChild");c[n.END]=m.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){v.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);p.forEach(this.getChildren(),
m.hitch(this,"_startupChild"))},addChild:function(b,a){this.inherited(arguments);this._startupChild(b)},_startupChild:function(b){b.set("tabIndex","-1")},_getFirst:function(){var b=this.getChildren();return b.length?b[0]:null},_getLast:function(){var b=this.getChildren();return b.length?b[b.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(b){return(b=
u.byNode(b))&&b.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(p,g,t,v,n,m,u,k){return g("dijit._KeyNavMixin",k,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);t.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var f=this._keyNavCodes={};f[v.HOME]=n.hitch(this,"focusFirstChild");f[v.END]=n.hitch(this,
"focusLastChild");f[this.isLeftToRight()?v.LEFT_ARROW:v.RIGHT_ARROW]=n.hitch(this,"_onLeftArrow");f[this.isLeftToRight()?v.RIGHT_ARROW:v.LEFT_ARROW]=n.hitch(this,"_onRightArrow");f[v.UP_ARROW]=n.hitch(this,"_onUpArrow");f[v.DOWN_ARROW]=n.hitch(this,"_onDownArrow")}var e=this,f="string"==typeof this.childSelector?this.childSelector:n.hitch(this,"childSelector");this.own(m(this.domNode,"keypress",n.hitch(this,"_onContainerKeypress")),m(this.domNode,"keydown",n.hitch(this,"_onContainerKeydown")),m(this.domNode,
"focus",n.hitch(this,"_onContainerFocus")),m(this.containerNode,m.selector(f,"focusin"),function(b){e._onChildFocus(u.getEnclosingWidget(this),b)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(f,e){f&&(this.focusedChild&&f!==this.focusedChild&&this._onChildBlur(this.focusedChild),f.set("tabIndex",this.tabIndex),f.focus(e?"end":"start"))},_onContainerFocus:function(f){f.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){t.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(f){t.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(f){f&&f!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),f.set("tabIndex",this.tabIndex),this.lastFocused=f,this._set("focusedChild",f))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(f,e,b,a){f&&this.focusChild(f)},_keyboardSearchCompare:function(f,e){var b=f.domNode;f=(f.label||(b.focusNode?
b.focusNode.label:"")||b.innerText||b.textContent||"").replace(/^\s+/,"").substr(0,e.length).toLowerCase();return e.length&&f==e?-1:0},_isFormElement:function(f){return"INPUT"===f.tagName||"TEXTAREA"===f.tagName||"SELECT"===f.tagName||"BUTTON"===f.tagName},_onContainerKeydown:function(f){if(!this._isFormElement(document.activeElement)){var e=this._keyNavCodes[f.keyCode];e?(e(f,this.focusedChild),f.stopPropagation(),f.preventDefault(),this._searchString=""):f.keyCode!=v.SPACE||!this._searchTimer||
f.ctrlKey||f.altKey||f.metaKey||(f.stopImmediatePropagation(),f.preventDefault(),this._keyboardSearch(f," "))}},_onContainerKeypress:function(f){this._isFormElement(document.activeElement)||f.charCode<=v.SPACE||f.ctrlKey||f.altKey||f.metaKey||(f.preventDefault(),f.stopPropagation(),this._keyboardSearch(f,String.fromCharCode(f.charCode).toLowerCase()))},_keyboardSearch:function(f,e){var b=null,a,c=0;n.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=e;var f=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;a=this._searchString.substr(0,f);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var g=this.focusedChild||null;if(1==f||!g)if(g=this._getNextFocusableChild(g,1),!g)return;f=g;do{var k=this._keyboardSearchCompare(g,a);k&&0==c++&&(b=g);if(-1==k){c=-1;break}g=this._getNextFocusableChild(g,1)}while(g&&g!=f)})();this.onKeyboardSearch(b,f,a,c)},_onChildBlur:function(){},_getNextFocusableChild:function(f,e){var b=
f;do{if(f)f=this._getNext(f,e);else if(f=this[0<e?"_getFirst":"_getLast"](),!f)break;if(null!=f&&f!=b&&f.isFocusable())return f}while(f!=b);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(f,e){if(f)for(f=f.domNode;f;)if((f=f[0>e?"previousSibling":"nextSibling"])&&"getAttribute"in f){var b=u.byNode(f);if(b)return b}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){u=p("dijit.MenuItem"+(m("dojo-bidi")?"_NoBidi":""),[k,f,e,b],{templateString:a,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(a){this._set("label",a);var b="",c;c=a.search(/{\S}/);if(0<=c){var b=a.charAt(c+1),e=a.substr(0,c);a=a.substr(c+3);c=e+b+a;a=e+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+b+"\x3c/span\x3e"+a}else c=a;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=a;this._set("shortcutKey",b)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(a){!a||"label"in this.params||this._set("label",a.innerHTML)},buildRendering:function(){this.inherited(arguments);t.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&t.set(this.accelKeyNode,"id",this.id+"_accel");g.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==m("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(c){}},_setSelected:function(a){v.toggle(this.domNode,
"dijitMenuItemSelected",a)},setLabel:function(a){n.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",a)},setDisabled:function(a){n.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",a)},_setDisabledAttr:function(a){this.focusNode.setAttribute("aria-disabled",a?"true":"false");this._set("disabled",a)},_setAccelKeyAttr:function(a){this.accelKeyNode&&(this.accelKeyNode.style.display=
a?"":"none",this.accelKeyNode.innerHTML=a,t.set(this.containerNode,"colSpan",a?"1":"2"));this._set("accelKey",a)}});m("dojo-bidi")&&(u=p("dijit.MenuItem",u,{_setLabelAttr:function(a){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return u})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(p,g){return p("dijit._Contained",null,{_getSibling:function(g){var p=this.getParent();return p&&p._getSiblingOfChild&&p._getSiblingOfChild(this,
"previous"==g?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var g=this.getParent();return g&&g.getIndexOfChild?g.getIndexOfChild(this):-1}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(p,g,t,v,n,m){return p("dijit.MenuSeparator",[t,v,n],{templateString:m,
buildRendering:function(){this.inherited(arguments);g.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(p,g,t,v){return p("dijit.form.SimpleTextarea",v,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",
postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);t("ie")&&this.cols&&g.add(this.textbox,"dijitTextAreaCols")},filter:function(g){g&&(g=g.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(g){if(this.maxLength){var m=parseInt(this.maxLength),n=this.textbox.value.replace(/\r/g,""),m=n.length-m;if(0<m){var k=this.textbox;if(k.selectionStart){var f=k.selectionStart,
e=0;t("opera")&&(e=(this.textbox.value.substring(0,f).match(/\r/g)||[]).length);this.textbox.value=n.substring(0,f-m-e)+n.substring(f-e);k.setSelectionRange(f-m,f-m)}else this.ownerDocument.selection&&(k.focus(),n=this.ownerDocument.selection.createRange(),n.moveStart("character",-m),n.text="",n.select())}}this.inherited(arguments)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K){function J(a){return new B({command:a.name})}function L(a){return new B({buttonClass:E,command:a.name})}t=t("dijit.Editor",I,{plugins:null,extraPlugins:null,constructor:function(){b.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",G]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(a("ie")||a("trident")||a("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new v;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);b.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=n.getLocalization("dijit._editor",
"commands",this.lang);a("webkit")&&f.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new q({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));g.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);u.add(this.iframe.parentNode,"dijitEditorIFrameContainer");u.add(this.iframe,"dijitEditorIFrame");m.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){g.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,c){var e=b.isString(a)?{name:a}:b.isFunction(a)?{ctor:a}:a;if(!e.setEditor){var f={args:e,plugin:null,editor:this};e.name&&(B.registry[e.name]?f.plugin=B.registry[e.name](e):x.publish(K._scopeName+".Editor.getPlugin",f));if(!f.plugin)try{var g=
e.ctor||b.getObject(e.name)||p(e.name);g&&(f.plugin=new g(e))}catch(W){throw Error(this.id+": cannot find plugin ["+e.name+"]");}if(!f.plugin)throw Error(this.id+": cannot find plugin ["+e.name+"]");a=f.plugin}1<arguments.length?this._plugins[c]=a:this._plugins.push(a);a.setEditor(this);b.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&z.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+k.getPadBorderExtents(this.iframe.parentNode).h+
k.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,c=this.document.body,e=c.clientWidth,f=c.clientHeight,g=c.clientLeft,k=c.offsetWidth,m=c.offsetHeight,n=c.offsetLeft;/^rtl$/i.test(c.dir||"")?e<k&&a.x>e&&a.x<k&&(b=!0):a.x<g&&a.x>n&&(b=!0);b||f<m&&a.y>f&&a.y<m&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(b){var e;try{if(e=this.document.execCommand(b,!1,null),a("webkit")&&!e)throw{};}catch(S){e=c.substitute,alert(e(this.commands.systemShortcut,
[this.commands[b],e(this.commands[a("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[b]])])),e=!1}return e},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(c){var e=c.mark,f=c.mark;c=c.isCollapsed;var k,m,n;f&&(9>a("ie")||9===a("ie")&&a("quirks")?b.isArray(f)?(e=[],g.forEach(f,function(a){e.push(D.getNode(a,this.editNode))},this),this.selection.moveToBookmark({mark:e,
isCollapsed:c})):f.startContainer&&f.endContainer&&(n=D.getSelection(this.window))&&n.removeAllRanges&&(n.removeAllRanges(),c=D.create(this.window),k=D.getNode(f.startContainer,this.editNode),m=D.getNode(f.endContainer,this.editNode),k&&m&&(c.setStart(k,f.startOffset),c.setEnd(m,f.endOffset),n.addRange(c))):(n=D.getSelection(this.window))&&n.removeAllRanges&&(n.removeAllRanges(),c=D.create(this.window),k=D.getNode(f.startContainer,this.editNode),m=D.getNode(f.endContainer,this.editNode),k&&m&&(c.setStart(k,
f.startOffset),c.setEnd(m,f.endOffset),n.addRange(c))))},_changeToStep:function(a,b){this.setValue(b.text);(a=b.bookmark)&&this._moveToBookmark(a)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var c=this.selection.getBookmark(),e=[];if(c&&c.mark){var f=
c.mark;if(9>a("ie")||9===a("ie")&&a("quirks")){var k=D.getSelection(this.window);if(b.isArray(f))g.forEach(c.mark,function(a){e.push(D.getIndex(a,this.editNode).o)},this),c.mark=e;else if(k){var m;k.rangeCount&&(m=k.getRangeAt(0));c.mark=m?m.cloneRange():this.selection.getBookmark()}}try{c.mark&&c.mark.startContainer&&(e=D.getIndex(c.mark.startContainer,this.editNode).o,c.mark={startContainer:e,startOffset:c.mark.startOffset,endContainer:c.mark.endContainer===c.mark.startContainer?e:D.getIndex(c.mark.endContainer,
this.editNode).o,endOffset:c.mark.endOffset})}catch(W){c.mark=null}}return c},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:F.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=F.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(b){a("ie")||this.iframe||b.keyCode!=e.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var c=b.keyCode;if(b.ctrlKey&&
!b.shiftKey&&!b.altKey){if(90==c||122==c){b.stopPropagation();b.preventDefault();this.undo();return}if(89==c||121==c){b.stopPropagation();b.preventDefault();this.redo();return}}this.inherited(arguments);switch(c){case e.ENTER:case e.BACKSPACE:case e.DELETE:this.beginEditing();break;case 88:case 86:if(b.ctrlKey&&!b.altKey&&!b.metaKey){this.endEditing();88==b.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!b.ctrlKey&&!b.altKey&&!b.metaKey&&(b.keyCode<
e.F1||b.keyCode>e.F15)){this.beginEditing();break}case e.ALT:this.endEditing();break;case e.UP_ARROW:case e.DOWN_ARROW:case e.LEFT_ARROW:case e.RIGHT_ARROW:case e.HOME:case e.END:case e.PAGE_UP:case e.PAGE_DOWN:this.endEditing(!0);case e.CTRL:case e.SHIFT:case e.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(M){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(a){this.setValueDeferred.then(b.hitch(this,function(){!this.disabled&&a||!this._buttonEnabledPlugins&&a?
g.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!a&&g.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(f.set(this.document.body,"color",f.get(this.iframe,"color")),f.set(this.document.body,"background-color",f.get(this.iframe,"background-color")))}catch(M){}}});b.mixin(B.registry,{undo:J,redo:J,cut:J,copy:J,paste:J,insertOrderedList:J,insertUnorderedList:J,
indent:J,outdent:J,justifyCenter:J,justifyFull:J,justifyLeft:J,justifyRight:J,"delete":J,selectAll:J,removeFormat:J,unlink:J,insertHorizontalRule:J,bold:L,italic:L,underline:L,strikethrough:L,subscript:L,superscript:L,"|":function(){return new B({setEditor:function(a){this.editor=a;this.button=new C({ownerDocument:a.ownerDocument})}})}});return t})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(p,g,t,v,n,m,u,k){t("dijit-legacy-requires")&&n(0,function(){p(["dijit/ToolbarSeparator"])});return g("dijit.Toolbar",[m,k,u],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(p,g,t,v){return p("dijit.ToolbarSeparator",[t,v],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);g.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(p,g,t,
v,n,m,u,k,f){return m("dijit.layout._LayoutWidget",[g,t,v],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);u.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var e=this.getParent&&this.getParent();e&&e.isLayoutContainer||(this.resize(),this.own(n.on("resize",p.hitch(this,"resize"))))}},resize:function(e,b){var a=this.domNode;e&&k.setMarginBox(a,e);b=b||{};p.mixin(b,e||{});
"h"in b&&"w"in b||(b=p.mixin(k.getMarginBox(a),b));e=f.getComputedStyle(a);var c=k.getMarginExtents(a,e),g=k.getBorderExtents(a,e);b=this._borderBox={w:b.w-(c.w+g.w),h:b.h-(c.h+g.h)};c=k.getPadExtents(a,e);this._contentBox={l:f.toPixelValue(a,e.paddingLeft),t:f.toPixelValue(a,e.paddingTop),w:b.w-c.w,h:b.h-c.h};this.layout()},layout:function(){},_setupChild:function(e){u.add(e.domNode,this.baseClass+"-child "+(e.baseClass?this.baseClass+"-"+e.baseClass:""))},addChild:function(e,b){this.inherited(arguments);
this._started&&this._setupChild(e)},removeChild:function(e){u.remove(e.domNode,this.baseClass+"-child"+(e.baseClass?" "+this.baseClass+"-"+e.baseClass:""));this.inherited(arguments)}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(p,g,t,v,n){g=g("dijit._editor._Plugin",v,{constructor:function(g){this.params=g||{};t.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",
button:null,command:"",useDefaultCommand:!0,buttonClass:n,disabled:!1,getLabel:function(g){return this.editor.commands[g]},_initButton:function(){if(this.command.length){var g=this.getLabel(this.command),n=this.editor,k=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(g=t.mixin({label:g,ownerDocument:n.ownerDocument,dir:n.dir,lang:n.lang,showLabel:!1,iconClass:k,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete g.name,
this.button=new this.buttonClass(g))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(g,n,k){this.own(p.connect(g,n,this,k))},updateState:function(){var g=this.editor,n=this.command,k,f;if(g&&g.isLoaded&&n.length){var e=this.get("disabled");if(this.button)try{var b=g._implCommand(n);f=!e&&(this[b]?this[b](n):g.queryCommandEnabled(n));this.enabled!==f&&
(this.enabled=f,this.button.set("disabled",!f));f&&"boolean"==typeof this.button.checked&&(k=g.queryCommandState(n),this.checked!==k&&(this.checked=k,this.button.set("checked",g.queryCommandState(n))))}catch(a){console.log(a)}}},setEditor:function(g){this.editor=g;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",t.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display=
"none");this.own(this.editor.on("NormalizedDisplayChanged",t.hitch(this,"updateState")))},setToolbar:function(g){this.button&&g.addChild(this.button)},set:function(g,n){if("object"===typeof g){for(var k in g)this.set(k,g[k]);return this}k=this._getAttrNames(g);if(this[k.s])var f=this[k.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(g,n);return f||this},get:function(g){var m=this._getAttrNames(g);return this[m.g]?this[m.g]():this[g]},_setDisabledAttr:function(g){this._set("disabled",
g);this.updateState()},_getAttrNames:function(g){var m=this._attrPairNames;if(m[g])return m[g];var k=g.charAt(0).toUpperCase()+g.substr(1);return m[g]={s:"_set"+k+"Attr",g:"_get"+k+"Attr"}},_set:function(g,n){this[g]=n}});g.registry={};return g})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p("dijit._editor.plugins.EnterKeyHandling",
f,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),v.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(v.hitch(this,function(b){this.own(n(a.document,"keydown",v.hitch(this,function(a){if(a.keyCode==t.ENTER){var b=v.mixin({},a);b.shiftKey=!0;this.handleEnterKey(b)||(a.stopPropagation(),a.preventDefault())}})));9<=m("ie")&&
10>=m("ie")&&this.own(n(a.document,"paste",v.hitch(this,function(a){setTimeout(v.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return b}));else if(this.blockNodeForEnter){var b=v.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,b);a.addKeyHandler(13,0,1,b);this.own(this.editor.on("KeyPressed",v.hitch(this,"onKeyPressed")))}},onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=
this.editor.selection.getAncestorElement("LI");if(a){m("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var c=a.firstChild;!c||1!=c.nodeType||"UL"!=c.nodeName&&"OL"!=c.nodeName||(a.insertBefore(c.ownerDocument.createTextNode("\u00a0"),c),c=b.create(this.editor.window),c.setStart(a.firstChild,0),a=b.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(c))}else e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?
(a.innerHTML=this.bogusHtmlContent,9>=m("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var c,f,n,p,u=this.editor.document,
t,v,B;if(a.shiftKey){a=this.editor.selection.getParentElement();if(p=b.getAncestor(a,this.blockNodes)){if("LI"==p.tagName)return!0;a=b.getSelection(this.editor.window);c=a.getRangeAt(0);c.collapsed||(c.deleteContents(),a=b.getSelection(this.editor.window),c=a.getRangeAt(0));if(b.atBeginningOfContainer(p,c.startContainer,c.startOffset))t=u.createElement("br"),c=b.create(this.editor.window),p.insertBefore(t,p.firstChild),c.setStartAfter(t),a.removeAllRanges(),a.addRange(c);else if(b.atEndOfContainer(p,
c.startContainer,c.startOffset))c=b.create(this.editor.window),t=u.createElement("br"),p.appendChild(t),p.appendChild(u.createTextNode("\u00a0")),c.setStart(p.lastChild,0),a.removeAllRanges(),a.addRange(c);else return(v=c.startContainer)&&3==v.nodeType?(B=v.nodeValue,f=u.createTextNode(B.substring(0,c.startOffset)),n=u.createTextNode(B.substring(c.startOffset)),p=u.createElement("br"),""==n.nodeValue&&m("webkit")&&(n=u.createTextNode("\u00a0")),g.place(f,v,"after"),g.place(p,f,"after"),g.place(n,
p,"after"),g.destroy(v),c=b.create(this.editor.window),c.setStart(n,0),a.removeAllRanges(),a.addRange(c),!1):!0}else a=b.getSelection(this.editor.window),a.rangeCount?(c=a.getRangeAt(0))&&c.startContainer&&(c.collapsed||(c.deleteContents(),a=b.getSelection(this.editor.window),c=a.getRangeAt(0)),(v=c.startContainer)&&3==v.nodeType?(p=c.startOffset,v.length<p&&(n=this._adjustNodeAndOffset(v,p),v=n.node,p=n.offset),B=v.nodeValue,f=u.createTextNode(B.substring(0,p)),n=u.createTextNode(B.substring(p)),
p=u.createElement("br"),n.length||(n=u.createTextNode("\u00a0")),f.length?g.place(f,v,"after"):f=v,g.place(p,f,"after"),g.place(n,p,"after"),g.destroy(v)):(0<=c.startOffset&&(t=v.childNodes[c.startOffset]),p=u.createElement("br"),n=u.createTextNode("\u00a0"),t?(g.place(p,t,"before"),g.place(n,p,"after")):(v.appendChild(p),v.appendChild(n))),c=b.create(this.editor.window),c.setStart(n,0),c.setEnd(n,n.length),a.removeAllRanges(),a.addRange(c),this.editor.selection.collapse(!0)):e.prototype.execCommand.call(this.editor,
"inserthtml","\x3cbr\x3e");return!1}var G=!0;a=b.getSelection(this.editor.window);c=a.getRangeAt(0);c.collapsed||(c.deleteContents(),a=b.getSelection(this.editor.window),c=a.getRangeAt(0));t=b.getBlockAncestor(c.endContainer,null,this.editor.editNode);var F=t.blockNode;if(this._checkListLater=F&&("LI"==F.nodeName||"LI"==F.parentNode.nodeName))return m("mozilla")&&(this._pressedEnterInBlock=F),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(F.innerHTML)&&
(F.innerHTML="",m("webkit")&&(c=b.create(this.editor.window),c.setStart(F,0),a.removeAllRanges(),a.addRange(c)),this._checkListLater=!1),!0;if(!t.blockNode||t.blockNode===this.editor.editNode){try{e.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(D){}t={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};if(t.blockNode){if(t.blockNode!=this.editor.editNode&&!(t.blockNode.textContent||t.blockNode.innerHTML).replace(/^\s+|\s+$/g,
"").length)return this.removeTrailingBr(t.blockNode),!1}else t.blockNode=this.editor.editNode;a=b.getSelection(this.editor.window);c=a.getRangeAt(0)}F=u.createElement(this.blockNodeForEnter);F.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(t.blockNode);n=c.endOffset;G=c.endContainer;G.length<n&&(n=this._adjustNodeAndOffset(G,n),G=n.node,n=n.offset);if(b.atEndOfContainer(t.blockNode,G,n))t.blockNode===t.blockContainer?t.blockNode.appendChild(F):g.place(F,t.blockNode,"after"),G=!1,c=b.create(this.editor.window),
c.setStart(F,0),a.removeAllRanges(),a.addRange(c),this.editor.height&&k.scrollIntoView(F);else if(b.atBeginningOfContainer(t.blockNode,c.startContainer,c.startOffset))g.place(F,t.blockNode,t.blockNode===t.blockContainer?"first":"before"),F.nextSibling&&this.editor.height&&(c=b.create(this.editor.window),c.setStart(F.nextSibling,0),a.removeAllRanges(),a.addRange(c),k.scrollIntoView(F.nextSibling)),G=!1;else{t.blockNode===t.blockContainer?t.blockNode.appendChild(F):g.place(F,t.blockNode,"after");G=
!1;t.blockNode.style&&F.style&&t.blockNode.style.cssText&&(F.style.cssText=t.blockNode.style.cssText);if((v=c.startContainer)&&3==v.nodeType){n=c.endOffset;v.length<n&&(n=this._adjustNodeAndOffset(v,n),v=n.node,n=n.offset);B=v.nodeValue;f=u.createTextNode(B.substring(0,n));n=u.createTextNode(B.substring(n,B.length));g.place(f,v,"before");g.place(n,v,"after");g.destroy(v);for(c=f.parentNode;c!==t.blockNode;){B=u.createElement(c.tagName);c.style&&B.style&&c.style.cssText&&(B.style.cssText=c.style.cssText);
"FONT"===c.tagName&&(c.color&&(B.color=c.color),c.face&&(B.face=c.face),c.size&&(B.size=c.size));for(;n;)v=n.nextSibling,B.appendChild(n),n=v;g.place(B,c,"after");f=c;n=B;c=c.parentNode}if(1==n.nodeType||3==n.nodeType&&n.nodeValue)F.innerHTML="";for(f=n;n;)v=n.nextSibling,F.appendChild(n),n=v}c=b.create(this.editor.window);u=f;if("BR"!==this.blockNodeForEnter){for(;u;)p=u,u=v=u.firstChild;p&&p.parentNode?(F=p.parentNode,c.setStart(F,0),a.removeAllRanges(),a.addRange(c),this.editor.height&&k.scrollIntoView(F),
m("mozilla")&&(this._pressedEnterInBlock=t.blockNode)):G=!0}else c.setStart(F,0),a.removeAllRanges(),a.addRange(c),this.editor.height&&k.scrollIntoView(F),m("mozilla")&&(this._pressedEnterInBlock=t.blockNode)}return G},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&
(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&g.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q){var S=t("dijit._editor.RichText",[D,I],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&c.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new v},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[c.trim,c.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);C("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));C("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(C("ie")||C("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[c.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[c.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);E.publish(Q._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=c.hitch(this,function(a,b){return function(){return!this.execCommand(a,b)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};C("ie")||(b.Z=a("redo"));for(var e in b)this.addKeyHandler(e,!0,!1,b[e])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(S._editorCommandsLocalized)this._local2NativeFormatNames=S._local2NativeFormatNames,this._native2LocalFormatNames=S._native2LocalFormatNames;else{S._editorCommandsLocalized=!0;S._local2NativeFormatNames={};
S._native2LocalFormatNames={};this._local2NativeFormatNames=S._local2NativeFormatNames;this._native2LocalFormatNames=S._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",e,f=0;e=a[f++];)b="l"!==e.charAt(1)?b+("\x3c"+e+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+e+"\x3e\x3cbr/\x3e"):b+("\x3c"+e+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+e+"\x3e\x3cbr/\x3e");var g=k.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(g);
a=c.hitch(this,function(){for(var a=g.firstChild;a;)try{this.selection.selectElement(a.firstChild);var b=a.tagName.toLowerCase();this._local2NativeFormatNames[b]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[b]]=b;a=a.nextSibling.nextSibling}catch(aa){}k.destroy(g)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new v;this.isClosed||this.close();E.publish(Q._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var b=this.domNode,f;if(c.isString(this.value))f=this.value,b.innerHTML="";else if(b.nodeName&&"textarea"==b.nodeName.toLowerCase()){var p=this.textarea=b;this.name=p.name;f=p.value;b=this.domNode=this.ownerDocument.createElement("div");b.setAttribute("widgetId",this.id);p.removeAttribute("widgetId");b.cssText=p.cssText;b.className+=" "+p.className;k.place(b,p,"before");var q=c.hitch(this,function(){e.set(p,{display:"block",position:"absolute",
top:"-1000px"});if(C("ie")){var a=p.style;this.__overflow=a.overflow;a.overflow="hidden"}});C("ie")?this.defer(q,10):q();if(p.form){var w=p.value;this.reset=function(){this.getValue()!==w&&this.replaceValue(w)};x(p.form,"submit",c.hitch(this,function(){m.set(p,"disabled",this.disabled);p.value=this.getValue()}))}}else f=L.getChildrenHtml(b),b.innerHTML="";this.value=f;b.nodeName&&"LI"===b.nodeName&&(b.innerHTML=" \x3cbr\x3e");this.header=b.ownerDocument.createElement("div");b.appendChild(this.header);
this.editingArea=b.ownerDocument.createElement("div");b.appendChild(this.editingArea);this.footer=b.ownerDocument.createElement("div");b.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!g.useXDomain||g.allowXdRichTextSave)){if((f=n.byId(Q._scopeName+"._editor.RichText.value"))&&""!==f.value)for(var q=f.value.split(this._SEPARATOR),t=0,z;z=q[t++];)if(z=z.split(this._NAME_CONTENT_SEP),z[0]===this.name){this.value=z[1];q=q.splice(t,1);f.value=q.join(this._SEPARATOR);
break}S._globalSaveHandler||(S._globalSaveHandler={},B.addOnUnload(function(){for(var a in S._globalSaveHandler){var b=S._globalSaveHandler[a];c.isFunction(b)&&b()}}));S._globalSaveHandler[this.id]=c.hitch(this,"_saveContent")}this.isClosed=!1;f=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");f.id=this.id+"_iframe";f.style.border="none";f.style.width="100%";this._layoutMode?f.style.height="100%":7<=C("ie")?(this.height&&(f.style.height=this.height),this.minHeight&&(f.style.minHeight=
this.minHeight)):f.style.height=this.height?this.height:this.minHeight;f.frameBorder=0;f._loadFunc=c.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new K.SelectionManager(a);C("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});q=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");q=11>C("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+q+"');document.close()":"javascript: '"+
q+"'";this.editingArea.appendChild(f);f.src=q;"LI"===b.nodeName&&(b.lastChild.style.marginTop="-1.2em");u.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=e.getComputedStyle(this.domNode),f;if(this["aria-label"])f=this["aria-label"];else{var g=w('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||n.byId(this["aria-labelledby"],this.ownerDocument);g&&(f=g.textContent||g.innerHTML||"")}var g="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(f?" aria-label\x3d'"+z.escape(f)+"'":"")+"\x3e\x3c/div\x3e",k=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),m=a.lineHeight,m=0<=m.indexOf("px")?parseFloat(m)/parseFloat(a.fontSize):0<=m.indexOf("em")?parseFloat(m):"normal",p="",q=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var b=a.split(":")[0];if(b){var b=c.trim(b),b=b.toLowerCase(),d,f="";for(d=0;d<b.length;d++){var g=b.charAt(d);switch(g){case "-":d++,g=b.charAt(d).toUpperCase();default:f+=
g}}e.set(q.domNode,f,"")}p+=a+";"});this.iframe.setAttribute("title",f);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||b.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",f?"\x3ctitle\x3e"+z.escape(f)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",k,";\n",this.height||C("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",m,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",C("ie")||C("trident")||C("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",f?" aria-label\x3d'"+z.escape(f)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+p+"'\x3e",g,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",c=0,e,f=F.get(this.ownerDocument);e=a[c++];)e=(new G(f.location,e)).toString(),this.editingAreaStyleSheets.push(e),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+e+'"/\x3e';return b},addStyleSheet:function(a){var b=a.toString(),e=F.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new G(e.location,b)).toString();-1<p.indexOf(this.editingAreaStyleSheets,b)||(this.editingAreaStyleSheets.push(b),
this.onLoadDeferred.then(c.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(b);else{var a=this.document.getElementsByTagName("head")[0],c=this.document.createElement("link");c.rel="stylesheet";c.type="text/css";c.href=b;a.appendChild(c)}})))},removeStyleSheet:function(a){var b=a.toString(),c=F.get(this.ownerDocument);if("."===b.charAt(0)||"/"!==b.charAt(0)&&!a.host)b=(new G(c.location,b)).toString();a=p.indexOf(this.editingAreaStyleSheets,b);-1!==a&&(delete this.editingAreaStyleSheets[a],
w('link[href\x3d"'+b+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var b=C("ie")&&(this.isLoaded||!this.focusOnLoad);b&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;b&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(C("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var c in a)if(a.hasOwnProperty(c))try{this.document.execCommand(c,
!1,a[c])}catch(U){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=M.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var b=this;this.beforeIframeNode=k.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=k.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){b.editNode.focus()};this.focusNode=
this.editNode;var e=this.events.concat(this.captureEvents),f=this.iframe?this.document:this.editNode;this.own.apply(this,p.map(e,function(a){var b=a.toLowerCase().replace(/^on/,"");return x(f,b,c.hitch(this,a))},this));this.own(x(f,"mouseup",c.hitch(this,"onClick")));C("ie")&&(this.own(x(this.document,"mousedown",c.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);C("webkit")&&(this._webkitListener=this.own(x(this.document,"mouseup",c.hitch(this,"onDisplayChanged")))[0],this.own(x(this.document,
"mousedown",c.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(C("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(V){}this.isLoaded=!0;this.set("disabled",this.disabled);e=c.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&q(c.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(e):e()},onKeyDown:function(b){if(b.keyCode===a.SHIFT||b.keyCode===a.ALT||b.keyCode===a.META||b.keyCode===a.CTRL)return!0;b.keyCode===a.TAB&&this.isTabIndent&&(b.stopPropagation(),b.preventDefault(),this.queryCommandEnabled(b.shiftKey?"outdent":"indent")&&this.execCommand(b.shiftKey?"outdent":"indent"));if(b.keyCode==a.TAB&&!this.isTabIndent&&!b.ctrlKey&&!b.altKey)return b.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>C("ie")&&b.keyCode===a.BACKSPACE&&"Control"===this.document.selection.type&&(b.stopPropagation(),b.preventDefault(),this.execCommand("delete"));C("ff")&&(b.keyCode===a.PAGE_UP||b.keyCode===a.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&b.preventDefault();var c=this._keyHandlers[b.keyCode],e=arguments;c&&!b.altKey&&p.some(c,function(a){if(!(a.shift^b.shiftKey||a.ctrl^(b.ctrlKey||b.metaKey)))return a.handler.apply(this,e)||b.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){b.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?m.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(c.hitch(this,function(){m.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,e,f){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));c.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:e||!1,ctrl:b||!1,handler:f})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(C("ie")||C("trident"))&&this.defer(function(){M.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var b=this.getValue(!0);if(b!==this.value)this.onChange(b);
this._set("value",b)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!C("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>C("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){a=a.toLowerCase();"formatblock"===a?C("safari")&&void 0===b&&(a="heading"):"hilitecolor"!==a||C("mozilla")||(a="backcolor");return a},_implCommand:function(a){return"_"+this._normalizeCommand(a)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(a){var b=this._qcaCache[a];return void 0!==b?b:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return C("ie")||C("trident")||C("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!C("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(C("ie")||C("trident"))&&(b="\x3c"+b+"\x3e")}var e="_"+a+"Impl";if(this[e])c=this[e](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var b=this._implCommand(a);return this[b]?this[b](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(O){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(C("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(C("mozilla")&&"hilitecolor"===a){var b;try{b=this.document.queryCommandValue("styleWithCSS")}catch(W){b=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,b)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(C("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,c=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(c)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(C("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var b=this.isClosed?this.domNode:this.editNode;b.innerHTML=a;this._preDomFilterContent(b)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(c.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!C("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var b=
a;p.forEach(this.contentPreFilters,function(a){a&&(b=a(b))});return b},_preDomFilterContent:function(a){a=a||this.editNode;p.forEach(this.contentDomPreFilters,function(b){b&&c.isFunction(b)&&b(a)},this)},_postFilterContent:function(a,b){var e;c.isString(a)?e=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=c.clone(a)),p.forEach(this.contentDomPostFilters,function(b){a=b(a)})),e=L.getChildrenHtml(a));c.trim(e.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(e="");p.forEach(this.contentPostFilters,
function(a){e=a(e)});return e},_saveContent:function(){var a=n.byId(Q._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){b.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return L.getNodeHtml(a)},getNodeChildrenHtml:function(a){b.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return L.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);C("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";C("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;k.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;u.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);S._globalSaveHandler&&delete S._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(C("ie")||C("trident")||C("edge"))return this.focused&&!this.disabled;var b=9>C("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(W){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=C("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=C("mozilla")||C("webkit")||C("ie")||C("trident")||C("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=C("mozilla")||C("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;C("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;C("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return C("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return C("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(C("mozilla")||C("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(C("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){C("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",
!1,a));return b},_forecolorImpl:function(a){C("ie")&&(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>C("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var e=c.item(0);c.length;)c.remove(c.item(0));e.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>C("trident")){var f=J.getSelection(this.window);
if(f&&f.rangeCount&&f.getRangeAt){c=f.getRangeAt(0);c.deleteContents();var g=k.create("div");g.innerHTML=a;for(var m,e=this.document.createDocumentFragment();a=g.firstChild;)m=e.appendChild(a);c.insertNode(e);m&&(c=c.cloneRange(),c.setStartAfter(m),c.collapse(!1),f.removeAllRanges(),f.addRange(c))}}else C("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");
b||(b=this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(C("ie")||C("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(C("ie")||C("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(C("ie")||C("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(C("ie")||C("trident")||C("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(C("ie")||C("trident")||C("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var e=f.position(a.childNodes[c]),
b=b+e.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&b.setStart(a.nextSibling,0)}return b},_adaptIESelection:function(){var a=J.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),c=b.startContainer,
e=b.startOffset;3===c.nodeType&&e>=c.length&&c.nextSibling;)e-=c.length,c=c.nextSibling;for(var f=null;this._isNodeEmpty(c,e)&&c!==f;)f=c,b=this._removeStartingRangeFromRange(c,b),c=b.startContainer,e=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=J.getSelection(this.window),c=this.document,e,f,g,m,n,l,d;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);g=b.getRangeAt(0);m=g.startContainer;3===m.nodeType&&(f=g.endOffset,m.length<
f&&(f=this._adjustNodeAndOffset(e,f),m=f.node,f=f.offset));for(;m&&m!==this.editNode;){e=m.tagName?m.tagName.toLowerCase():"";if(-1<p.indexOf(a,e)){d=m;break}m=m.parentNode}if(d&&(e=g.startContainer,a=c.createElement(d.tagName),k.place(a,d,"after"),e&&3===e.nodeType)){f=g.endOffset;e.length<f&&(f=this._adjustNodeAndOffset(e,f),e=f.node,f=f.offset);m=e.nodeValue;g=c.createTextNode(m.substring(0,f));var h=m.substring(f,m.length);h&&(n=c.createTextNode(h));k.place(g,e,"before");n&&(l=c.createElement("span"),
l.className="ieFormatBreakerSpan",k.place(l,e,"after"),k.place(n,l,"after"),n=l);k.destroy(e);f=g.parentNode;for(e=[];f!==d;){m=f.tagName;g={tagName:m};e.push(g);m=c.createElement(m);f.style&&m.style&&f.style.cssText&&(m.style.cssText=f.style.cssText,g.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(m.color=f.color,g.color=f.color),f.face&&(m.face=f.face,g.face=f.face),f.size&&(m.size=f.size,g.size=f.size));f.className&&(m.className=f.className,g.className=f.className);if(n)for(;n;)g=n.nextSibling,
m.appendChild(n),n=g;m.tagName==f.tagName?(l=c.createElement("span"),l.className="ieFormatBreakerSpan",k.place(l,f,"after"),k.place(m,l,"after")):k.place(m,f,"after");g=f;n=m;f=f.parentNode}if(n){if(1===n.nodeType||3===n.nodeType&&n.nodeValue)a.innerHTML="";for(;n;)g=n.nextSibling,a.appendChild(n),n=g}if(e.length){g=e.pop();n=c.createElement(g.tagName);g.cssText&&n.style&&(n.style.cssText=g.cssText);g.className&&(n.className=g.className);"FONT"===g.tagName&&(g.color&&(n.color=g.color),g.face&&(n.face=
g.face),g.size&&(n.size=g.size));for(k.place(n,a,"before");e.length;)g=e.pop(),d=c.createElement(g.tagName),g.cssText&&d.style&&(d.style.cssText=g.cssText),g.className&&(d.className=g.className),"FONT"===g.tagName&&(g.color&&(d.color=g.color),g.face&&(d.face=g.face),g.size&&(d.size=g.size)),n.appendChild(d),n=d;d=c.createTextNode(".");l.appendChild(d);n.appendChild(d)}else l=c.createElement("span"),l.className="ieFormatBreakerSpan",d=c.createTextNode("."),l.appendChild(d),k.place(l,a,"before");n=
J.create(this.window);n.setStart(d,0);n.setEnd(d,d.length);b.removeAllRanges();b.addRange(n);this.selection.collapse(!1);d.parentNode.innerHTML="";a.firstChild||k.destroy(a);return!0}return!1}g=b.getRangeAt(0);if((e=g.startContainer)&&3===e.nodeType)return f=g.startOffset,e.length<f&&(f=this._adjustNodeAndOffset(e,f),e=f.node,f=f.offset),m=e.nodeValue,g=c.createTextNode(m.substring(0,f)),h=m.substring(f),""!==h&&(n=c.createTextNode(m.substring(f))),l=c.createElement("span"),d=c.createTextNode("."),
l.appendChild(d),g.length?k.place(g,e,"after"):g=e,k.place(l,g,"after"),n&&k.place(n,l,"after"),k.destroy(e),n=J.create(this.window),n.setStart(d,0),n.setEnd(d,d.length),b.removeAllRanges(),b.addRange(n),c.execCommand(a),k.place(l.firstChild,l,"before"),k.destroy(l),n.setStart(d,0),n.setEnd(d,d.length),b.removeAllRanges(),b.addRange(n),this.selection.collapse(!1),d.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=J.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),e=c.startContainer;if(e&&3==e.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=k.create("li",null,a),k.place(a,e,"before"),c.appendChild(e),k.create("br",null,a,"after"),a=J.create(this.window),a.setStart(e,0),a.setEnd(e,e.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var c=J.getSelection(this.window),f=this.document,
g,m,n,p,l;b=b||null;if(a&&c&&c.isCollapsed&&c.rangeCount&&(m=c.getRangeAt(0),(g=m.startContainer)&&3===g.nodeType)){l=m.startOffset;g.length<l&&(m=this._adjustNodeAndOffset(g,l),g=m.node,l=m.offset);n=g.nodeValue;m=f.createTextNode(n.substring(0,l));""!==n.substring(l)&&(p=f.createTextNode(n.substring(l)));n=f.createElement("span");l=f.createTextNode(".");n.appendChild(l);f=f.createElement("span");n.appendChild(f);m.length?k.place(m,g,"after"):m=g;k.place(n,m,"after");p&&k.place(p,n,"after");k.destroy(g);
g=J.create(this.window);g.setStart(l,0);g.setEnd(l,l.length);c.removeAllRanges();c.addRange(g);if(C("webkit")){c="color";if("hilitecolor"===a||"backcolor"===a)c="backgroundColor";e.set(n,c,b);this.selection.remove();k.destroy(f);n.innerHTML="\x26#160;";this.selection.selectElement(n);this.focus()}else this.execCommand(a,b),k.place(n.firstChild,n,"before"),k.destroy(n),g.setStart(l,0),g.setEnd(l,l.length),c.removeAllRanges(),c.addRange(g),this.selection.collapse(!1),l.parentNode.removeChild(l);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return w(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)k.place(a.firstChild,a,"before");
k.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)k.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(c.hitch(this,function(){this.editNode.dir=a}))}});return S})},"dijit/selection":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/sniff dojo/_base/window dijit/focus".split(" "),
function(p,g,t,v,n,m){var u=function(f){var e=f.document;this.getType=function(){if(e.getSelection){var b="text",a;try{a=f.getSelection()}catch(c){}a&&1==a.rangeCount&&(a=a.getRangeAt(0),a.startContainer==a.endContainer&&1==a.endOffset-a.startOffset&&3!=a.startContainer.nodeType&&(b="control"));return b}return e.selection.type.toLowerCase()};this.getSelectedText=function(){if(e.getSelection){var b=f.getSelection();return b?b.toString():""}return"control"==this.getType()?null:e.selection.createRange().text};
this.getSelectedHtml=function(){if(e.getSelection){var b=f.getSelection();if(b&&b.rangeCount){var a,c="";for(a=0;a<b.rangeCount;a++){var g=b.getRangeAt(a).cloneContents(),k=e.createElement("div");k.appendChild(g);c+=k.innerHTML}return c}return null}return"control"==this.getType()?null:e.selection.createRange().htmlText};this.getSelectedElement=function(){if("control"==this.getType()){if(e.getSelection){var b=f.getSelection();return b.anchorNode.childNodes[b.anchorOffset]}if((b=e.selection.createRange())&&
b.item)return e.selection.createRange().item(0)}return null};this.getParentElement=function(){if("control"==this.getType()){var b=this.getSelectedElement();if(b)return b.parentNode}else if(e.getSelection){if(b=e.getSelection()){for(b=b.anchorNode;b&&1!=b.nodeType;)b=b.parentNode;return b}}else return b=e.selection.createRange(),b.collapse(!0),b.parentElement();return null};this.hasAncestorElement=function(b){return null!=this.getAncestorElement.apply(this,arguments)};this.getAncestorElement=function(b){var a=
this.getSelectedElement()||this.getParentElement();return this.getParentOfType(a,arguments)};this.isTag=function(b,a){if(b&&b.tagName){b=b.tagName.toLowerCase();for(var c=0;c<a.length;c++){var e=String(a[c]).toLowerCase();if(b==e)return e}}return""};this.getParentOfType=function(b,a){for(;b;){if(this.isTag(b,a).length)return b;b=b.parentNode}return null};this.collapse=function(b){if(e.getSelection){var a=f.getSelection();a.removeAllRanges?b?a.collapseToStart():a.collapseToEnd():a.collapse(b)}else a=
e.selection.createRange(),a.collapse(b),a.select()};this.remove=function(){var b=e.selection;e.getSelection?(b=f.getSelection(),b.deleteFromDocument()):"none"!=b.type.toLowerCase()&&b.clear();return b};this.selectElementChildren=function(b,a){var c;b=g.byId(b);if(e.getSelection)a=f.getSelection(),v("opera")?(c=a.rangeCount?a.getRangeAt(0):e.createRange(),c.setStart(b,0),c.setEnd(b,3==b.nodeType?b.length:b.childNodes.length),a.addRange(c)):a.selectAllChildren(b);else if(c=b.ownerDocument.body.createTextRange(),
c.moveToElementText(b),!a)try{c.select()}catch(x){}};this.selectElement=function(b,a){var c;b=g.byId(b);if(e.getSelection)a=e.getSelection(),c=e.createRange(),a.removeAllRanges&&(v("opera")&&a.getRangeAt(0)&&(c=a.getRangeAt(0)),c.selectNode(b),a.removeAllRanges(),a.addRange(c));else try{var f=b.tagName?b.tagName.toLowerCase():"";c="img"===f||"table"===f?n.body(e).createControlRange():n.body(e).createRange();c.addElement(b);a||c.select()}catch(w){this.selectElementChildren(b,a)}};this.inSelection=
function(b){if(b){var a,c;if(e.getSelection){var g=f.getSelection();g&&0<g.rangeCount&&(c=g.getRangeAt(0));if(c&&c.compareBoundaryPoints&&e.createRange)try{if(a=e.createRange(),a.setStart(b,0),1===c.compareBoundaryPoints(c.START_TO_END,a))return!0}catch(w){}}else{c=e.selection.createRange();try{a=b.ownerDocument.body.createTextRange(),a.moveToElementText(b)}catch(w){}if(c&&a&&1===c.compareEndPoints("EndToStart",a))return!0}}return!1};this.getBookmark=function(){var b,a,c=e.selection,g=m.curNode;if(e.getSelection){if(c=
f.getSelection())if(c.isCollapsed){if(b=g?g.tagName:"")if(b=b.toLowerCase(),"textarea"==b||"input"==b&&(!g.type||"text"==g.type.toLowerCase()))return c={start:g.selectionStart,end:g.selectionEnd,node:g,pRange:!0},{isCollapsed:c.end<=c.start,mark:c};b={isCollapsed:!0};c.rangeCount&&(b.mark=c.getRangeAt(0).cloneRange())}else a=c.getRangeAt(0),b={isCollapsed:!1,mark:a.cloneRange()}}else if(c){b=g?g.tagName:"";b=b.toLowerCase();if(g&&b&&("button"==b||"textarea"==b||"input"==b)){if(c.type&&"none"==c.type.toLowerCase())return{isCollapsed:!0,
mark:null};a=c.createRange();return{isCollapsed:a.text&&a.text.length?!1:!0,mark:{range:a,pRange:!0}}}b={};try{a=c.createRange(),b.isCollapsed=!("Text"==c.type?a.htmlText.length:a.length)}catch(w){return b.isCollapsed=!0,b}if("CONTROL"==c.type.toUpperCase())if(a.length)for(b.mark=[],c=0,g=a.length;c<g;)b.mark.push(a.item(c++));else b.isCollapsed=!0,b.mark=null;else b.mark=a.getBookmark()}else console.warn("No idea how to store the current selection for this browser!");return b};this.moveToBookmark=
function(b){if(b=b.mark)if(e.getSelection){var a=f.getSelection();a&&a.removeAllRanges?b.pRange?(a=b.node,a.selectionStart=b.start,a.selectionEnd=b.end):(a.removeAllRanges(),a.addRange(b)):console.warn("No idea how to restore selection for this browser!")}else if(e.selection&&b){var c;b.pRange?c=b.range:t.isArray(b)?(c=e.body.createControlRange(),p.forEach(b,function(a){c.addElement(a)})):(c=e.body.createTextRange(),c.moveToBookmark(b));c.select()}};this.isCollapsed=function(){return this.getBookmark().isCollapsed}},
k=new u(window);k.SelectionManager=u;return k})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang"],function(p,g,t){var v={getIndex:function(g,k){for(var f=[],e=[],b=g,a,c;g!=k;){var m=0;for(a=g.parentNode;c=a.childNodes[m++];)if(c===g){--m;break}f.unshift(m);e.unshift(m-a.childNodes.length);g=a}if(0<f.length&&3==b.nodeType){for(c=b.previousSibling;c&&3==c.nodeType;)f[f.length-1]--,c=c.previousSibling;for(c=b.nextSibling;c&&3==c.nodeType;)e[e.length-
1]++,c=c.nextSibling}return{o:f,r:e}},getNode:function(g,k){if(!t.isArray(g)||0==g.length)return k;var f=k;p.every(g,function(e){if(0<=e&&e<f.childNodes.length)f=f.childNodes[e];else return f=null,!1;return!0});return f},getCommonAncestor:function(g,k,f){f=f||g.ownerDocument.body;var e=function(a){for(var b=[];a;)if(b.unshift(a),a!==f)a=a.parentNode;else break;return b};g=e(g);k=e(k);for(var e=Math.min(g.length,k.length),b=g[0],a=1;a<e;a++)if(g[a]===k[a])b=g[a];else break;return b},getAncestor:function(g,
k,f){for(f=f||g.ownerDocument.body;g&&g!==f;){var e=g.nodeName.toUpperCase();if(k.test(e))return g;g=g.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(g,k,f){f=f||g.ownerDocument.body;k=k||v.BlockTagNames;for(var e=null,b;g&&g!==f;){var a=g.nodeName.toUpperCase();!e&&k.test(a)&&(e=g);!b&&/^(?:BODY|TD|TH|CAPTION)$/.test(a)&&(b=g);g=g.parentNode}return{blockNode:e,blockContainer:b||g.ownerDocument.body}},atBeginningOfContainer:function(g,
k,f){var e=!1,b=0==f;b||3!=k.nodeType||/^[\s\xA0]+$/.test(k.nodeValue.substr(0,f))&&(b=!0);if(b)for(e=!0;k&&k!==g;){if(k.previousSibling){e=!1;break}k=k.parentNode}return e},atEndOfContainer:function(g,k,f){var e=!1,b=f==(k.length||k.childNodes.length);b||3!=k.nodeType||/^[\s\xA0]+$/.test(k.nodeValue.substr(f))&&(b=!0);if(b)for(e=!0;k&&k!==g;){if(k.nextSibling){e=!1;break}k=k.parentNode}return e},adjacentNoneTextNode:function(g,k){var f=g;g=0-g.length||0;for(k=k?"nextSibling":"previousSibling";f&&
3==f.nodeType;)g+=f.length,f=f[k];return[f,g]},create:function(g){g=g||window;return g.getSelection?g.document.createRange():new m},getSelection:function(g,k){if(g.getSelection)return g.getSelection();g=new n.selection(g);k||g._getCurrentSelection();return g}};if(!window.getSelection)var n=v.ie={cachedSelection:{},selection:function(g){this._ranges=[];this.addRange=function(g,f){this._ranges.push(g);f||g._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];
this.rangeCount=0};this.getRangeAt=function(g){return this._ranges[g]};this._getCurrentSelection=function(){this.removeAllRanges();var k;k=g.document.selection.createRange();k="CONTROL"==g.document.selection.type.toUpperCase()?new m(n.decomposeControlRange(k)):new m(n.decomposeTextRange(k));this.addRange(k,!0),this.isCollapsed=k.collapsed}},decomposeControlRange:function(g){var k=g.item(0),f=g.item(g.length-1);g=k.parentNode;var e=f.parentNode,k=v.getIndex(k,g).o[0],f=v.getIndex(f,e).o[0]+1;return[g,
k,e,f]},getEndPoint:function(g,k){var f=g.duplicate();f.collapse(!k);var e="EndTo"+(k?"End":"Start"),b=f.parentElement(),a,c,m;0<b.childNodes.length?p.every(b.childNodes,function(k,n){var p;if(3!=k.nodeType)if(f.moveToElementText(k),0<f.compareEndPoints(e,g))if(m&&3==m.nodeType)a=m,p=!0;else return a=b,c=n,!1;else{if(n==b.childNodes.length-1)return a=b,c=b.childNodes.length,!1}else n==b.childNodes.length-1&&(a=k,p=!0);if(p&&a)return a=(k=v.adjacentNoneTextNode(a)[0])?k.nextSibling:b.firstChild,n=
v.adjacentNoneTextNode(a),k=n[0],n=n[1],k?(f.moveToElementText(k),f.collapse(!1)):f.moveToElementText(b),f.setEndPoint(e,g),c=f.text.length-n,!1;m=k;return!0}):(a=b,c=0);k||1!=a.nodeType||c!=a.childNodes.length||(k=a.nextSibling)&&3==k.nodeType&&(a=k,c=0);return[a,c]},setEndPoint:function(g,k,f){g=g.duplicate();var e;if(3!=k.nodeType)if(0<f){if(e=k.childNodes[f-1])if(3==e.nodeType)k=e,f=e.length;else if(e.nextSibling&&3==e.nextSibling.nodeType)k=e.nextSibling,f=0;else{g.moveToElementText(e.nextSibling?
e:k);var b=e.parentNode;e=b.insertBefore(e.ownerDocument.createTextNode(" "),e.nextSibling);g.collapse(!1);b.removeChild(e)}}else g.moveToElementText(k),g.collapse(!0);3==k.nodeType&&(e=v.adjacentNoneTextNode(k),b=e[0],e=e[1],b?(g.moveToElementText(b),g.collapse(!1),"inherit"!=b.contentEditable&&e++):(g.moveToElementText(k.parentNode),g.collapse(!0),g.move("character",1),g.move("character",-1)),f+=e,0<f&&g.move("character",f)!=f&&console.error("Error when moving!"));return g},decomposeTextRange:function(g){var k=
n.getEndPoint(g),f=k[0],e=k[1],b=k[0],k=k[1];g.htmlText.length&&(g.htmlText==g.text?k=e+g.text.length:(k=n.getEndPoint(g,!0),b=k[0],k=k[1]));return[f,e,b,k]},setRange:function(g,k,f,e,b,a){k=n.setEndPoint(g,k,f);g.setEndPoint("StartToStart",k);if(!a)var c=n.setEndPoint(g,e,b);g.setEndPoint("EndToEnd",c||k);return g}},m=v.W3CRange=g(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=
null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?v.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(g,k){k=parseInt(k);if(this.startContainer!==g||this.startOffset!=k)delete this._cachedBookmark,this.startContainer=g,this.startOffset=
k,this.endContainer?this._updateInternal():this.setEnd(g,k)},setEnd:function(g,k){k=parseInt(k);if(this.endContainer!==g||this.endOffset!=k)delete this._cachedBookmark,this.endContainer=g,this.endOffset=k,this.startContainer?this._updateInternal():this.setStart(g,k)},setStartAfter:function(g,k){this._setPoint("setStart",g,k,1)},setStartBefore:function(g,k){this._setPoint("setStart",g,k,0)},setEndAfter:function(g,k){this._setPoint("setEnd",g,k,1)},setEndBefore:function(g,k){this._setPoint("setEnd",
g,k,0)},_setPoint:function(g,k,f,e){f=v.getIndex(k,k.parentNode).o;this[g](k.parentNode,f.pop()+e)},_getIERange:function(){var g=(this._body||this.endContainer.ownerDocument.body).createTextRange();n.setRange(g,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return g},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var g=this.startContainer,k=this._getIERange();3!==
g.nodeType||this.startOffset||this.setStartBefore(g);k.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var g=new m([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);g._body=this._body;return g},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});t.setObject("dijit.range",v);return v})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(p,g,t){var v={};g.setObject("dijit._editor.html",v);var n=v.escapeXml=function(g,n){g=g.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");n||(g=g.replace(/'/gm,"\x26#39;"));return g};v.getNodeHtml=function(g){var m=[];v.getNodeHtmlHelper(g,m);return m.join("")};v.getNodeHtmlHelper=function(g,u){switch(g.nodeType){case 1:var k=g.nodeName.toLowerCase();if(!k||"/"==k.charAt(0))return"";u.push("\x3c",k);var f=
[],e={},b;if(t("dom-attributes-explicit")||t("dom-attributes-specified-flag"))for(var a=0;b=g.attributes[a++];){var c=b.name;"_dj"===c.substr(0,3)||t("dom-attributes-specified-flag")&&!b.specified||c in e||(b=b.value,("src"==c||"href"==c)&&g.getAttribute("_djrealurl")&&(b=g.getAttribute("_djrealurl")),8===t("ie")&&"style"===c&&(b=b.replace("HEIGHT:","height:").replace("WIDTH:","width:")),f.push([c,b]),e[c]=b)}else{var m=(/^input$|^img$/i.test(g.nodeName)?g:g.cloneNode(!1)).outerHTML,e=m.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
m=m.substr(0,m.indexOf("\x3e"));p.forEach(e,function(a){if(a){var b=a.indexOf("\x3d");if(0<b&&(a=a.substring(0,b),"_dj"!=a.substr(0,3)))if("src"!=a&&"href"!=a||!g.getAttribute("_djrealurl")){var c;switch(a){case "style":c=g.style.cssText.toLowerCase();break;case "class":c=g.className;break;case "width":if("img"===k){(b=/width=(\S+)/i.exec(m))&&(c=b[1]);break}case "height":if("img"===k){(b=/height=(\S+)/i.exec(m))&&(c=b[1]);break}default:c=g.getAttribute(a)}null!=c&&f.push([a,c.toString()])}else f.push([a,
g.getAttribute("_djrealurl")])}},this)}f.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(e=0;b=f[e++];)u.push(" ",b[0],'\x3d"',"string"===typeof b[1]?n(b[1],!0):b[1],'"');switch(k){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":u.push(" /\x3e");break;case "script":u.push("\x3e",g.innerHTML,"\x3c/",k,"\x3e");break;default:u.push("\x3e"),g.hasChildNodes()&&v.getChildrenHtmlHelper(g,u),u.push("\x3c/",k,"\x3e")}break;case 4:case 3:u.push(n(g.nodeValue,
!0));break;case 8:u.push("\x3c!--",n(g.nodeValue,!0),"--\x3e");break;default:u.push("\x3c!-- Element not recognized - Type: ",g.nodeType," Name: ",g.nodeName,"--\x3e")}};v.getChildrenHtml=function(g){var m=[];v.getChildrenHtmlHelper(g,m);return m.join("")};v.getChildrenHtmlHelper=function(g,n){if(g)for(var k=g.childNodes||g,f=!t("ie")||k!==g,e,b=0;e=k[b++];)f&&e.parentNode!=g||v.getNodeHtmlHelper(e,n)};return v})},"esri/dijit/ColorPicker":function(){define("../Color ../kernel ./_EventedWidget ./_Tooltip ./ColorPicker/colorUtil ./ColorPicker/HexPalette dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/a11yclick dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/keys dojo/on dojo/query dojo/sniff dojo/dom-style dojo/i18n!../nls/jsapi dojo/text!./ColorPicker/templates/ColorPicker.html ./HorizontalSlider dijit/form/RadioButton dijit/form/TextBox dijit/form/ToggleButton dojo/NodeList-dom".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){g=b([t,u,k,v],{baseClass:"esriColorPicker",css:{container:"esriContainer",collapsed:"esriCollapsed",collapsible:"esriCollapsible",collapseIcon:"esriCollapseIcon",colorControls:"esriColorControls",header:"esriHeader",footer:"esriFooter",middle:"esriMiddle",swatch:"esriSwatch",swatchRow:"esriSwatchRow",swatchEmpty:"esriSwatchEmpty",swatchPreview:"esriSwatchPreview",swatchTransparencyBackground:"esriSwatchTransparencyBackground",focusedSwatch:"esriSwatch--focused",
palette:"esriPalette",paletteOptions:"esriPaletteOptions",paletteToggle:"esriPaletteToggle",label:"esriLabel",hexInput:"esriHexInput",recent:"esriRecent",suggested:"esriSuggested",selected:"esriSelected",disabled:"esriDisabled",section:"esriSection",displayNone:"esriDisplayNone",transparencySlider:"esriTransparencySlider",alt:"esriAlt",downArrowIcon:"esri-icon-down"},declaredClass:"esri.dijit.ColorPicker",labels:B.widgets.colorPicker,templateString:G,constructor:function(a,b){a=a||{};this._colorInstance=
new p;this._brightsPalette=new m({colors:a.palette});this._pastelsPalette=new m({colors:this._toPastels(this._brightsPalette.get("colors"))});this._activePalette=this._brightsPalette;this._swatchCreator=a.swatchCreator||this._createSwatch;this._swatches={};this._recentSwatches={};this._suggestedSwatches={}},buildRendering:function(){this.inherited(arguments);this._createPalettes();this._noColorSwatchNode=x.create("div",{"aria-label":this.labels.noColorTooltip,className:this.css.swatch+" "+this.css.swatchEmpty,
tabIndex:0,role:"button"},this.dap_hexInput.domNode,"after")},postCreate:function(){this.inherited(arguments);this._addListeners();this._selectColor();this.dap_hexInput.intermediateChanges=!0;this.dap_transparencySlider.intermediateChanges=!0;this.createTooltips([{node:this.dap_paletteContainer,label:this.labels.paletteTooltip},{node:this.dap_hexInput,label:this.labels.hexInputTooltip},{node:this._noColorSwatchNode,label:this.labels.noColorTooltip},{node:this.dap_paletteToggle,label:this.labels.moreColorsTooltip}])},
_activePalette:null,_autoCollapseHandle:null,_brightsPalette:null,_colorInstance:null,_noColorSwatchNode:null,_pastelsPalette:null,_previousColor:null,_swatchCreator:null,_swatches:null,_swatchNavigationIndex:null,_transparencyLabels:function(){return"["+[0,50,100].map(function(b){return a.replace(B.widgets.colorPicker.percent,{percent:b})}).map(function(a){return"'"+a+"'"})+"]"}(),collapsed:!1,_setCollapsedAttr:function(a){this.collapsible&&(c.toggle(this.domNode,this.css.collapsed,a),this._set("collapsed",
a),a?this.domNode.setAttribute("aria-expanded","true"):(this.domNode.setAttribute("aria-expanded","false"),this.dap_paletteContainer.focus()))},collapsible:!1,_setCollapsibleAttr:function(a){c.toggle(this.domNode,this.css.collapsible,a);this.dap_header.tabIndex=a?0:-1;if(a){this.domNode.setAttribute("role","button");this.domNode.setAttribute("aria-haspopup","menu");this.domNode.setAttribute("aria-controls",this.dap_colorControls.id);this.domNode.setAttribute("aria-expanded",(!this.collapsed).toString());
if(!this._autoCollapseHandle){q(this.domNode,"keydown",function(a){var b=!this.collapsed&&a.keyCode!=w.ESCAPE;this.collapsed&&a.keyCode!=w.ENTER&&a.keyCode!=w.SPACE||b||(a.preventDefault(),a.keyCode===w.ESCAPE?(this.dap_header.focus(),this.set("collapsed",!0)):(this.set("collapsed",!1),this.dap_paletteContainer.focus()))}.bind(this));var b=q.pausable(this.ownerDocument,"click",function(a){a=this.domNode.contains(a.target);this.collapsed||a||this.set("collapsed",!0)}.bind(this));this._autoCollapseHandle=
b;this.own(b)}this._autoCollapseHandle.resume()}else this.domNode.removeAttribute("role"),this.domNode.removeAttribute("aria-haspopup"),this.domNode.removeAttribute("aria-controls"),this.domNode.removeAttribute("aria-expanded"),this._autoCollapseHandle&&this._autoCollapseHandle.pause();this._set("collapsible",a)},color:null,_getColorAttr:function(){return"no-color"===this.color?"no-color":new p(this.color)},_setColorAttr:function(a,b){a=a||"no-color";b=b||void 0===b;if(!this.required){if("no-color"===
a){this._set("color","no-color");this._previousColor="no-color";this._disableTransparencySlider();this._clearSelection();this._silentlyUpdateHexInput("no-color");this._updatePreviewSwatch(a);c.add(this._noColorSwatchNode,this.css.selected);b&&this.emit("color-change",{color:"no-color"});return}this._enableTransparencySlider();c.remove(this._noColorSwatchNode,this.css.selected)}a=n.normalizeColor(a);var e=this._previousColor,f=this._colorInstance,g=this.css.selected;if(e){if(n.equal(e,a))return;if(e=
this._findSwatch({colors:this._activePalette.get("colors"),color:e,swatches:this._swatches}))c.remove(e,g),E.set(e,"borderColor","")}f.setColor(a);g=f.toHex();this._set("color",new p(f));this._previousColor=a;this._silentlyUpdateIntermediateChangingValueWidget(this.dap_transparencySlider,100*(1-f.a));this._updatePreviewSwatch(f);this._checkSelection();this._silentlyUpdateHexInput(f);this.trackColors&&this._addRecentColor(g);b&&this.emit("color-change",{color:new p(f)})},colorsPerRow:13,_setColorsPerRow:function(a){this._set("colorsPerRow",
0<a?a:13)},_setPaletteAttr:function(a){var b=this._activePalette===this._brightsPalette;this._brightsPalette.set("colors",a);this._pastelsPalette.set("colors",this._toPastels(this._brightsPalette.get("colors")));this._activePalette=b?this._brightsPalette:this._pastelsPalette;this._createPalettes();this._togglePalette(!b)},recentColors:[],_getRecentColorsAttr:function(){return e.map(this.recentColors,function(a){return n.normalizeColor(a)})},_setRecentColorsAttr:function(a){this.recentColors=a||[];
this.recentColors=e.map(this.recentColors,function(a){return n.normalizeColor(a).toHex()});0===this.recentColors.length?this._clearRecentSwatches():this._renderRecentSwatches()},required:!1,_setRequiredAttr:function(a){c.toggle(this._noColorSwatchNode,this.css.displayNone,a);this._set("required",a)},_showRecentColors:!0,_setShowRecentColorsAttr:function(a){c.toggle(this.dap_recentColorSection,this.css.displayNone,!a);this._set("showRecentColors",a)},_showSuggestedColors:!1,_setShowSuggestedColorsAttr:function(a){c.toggle(this.dap_suggestedColorSection,
this.css.displayNone,!a);this._set("showSuggestedColors",a)},_showTransparencySlider:!0,_setShowTransparencySliderAttr:function(a){c.toggle(this.dap_transparencySection,this.css.displayNone,!a);this._set("showTransparencySlider",a)},suggestedColors:null,_getSuggestedColorsAttr:function(){return e.map(this.suggestedColors,function(a){return n.normalizeColor(a)})},_setSuggestedColorsAttr:function(a){this._clearSuggestedSwatches();this.suggestedColors=a||[];this.suggestedColors=e.map(this.suggestedColors,
function(a){return n.normalizeColor(a).toHex()});0<this.suggestedColors.length&&this._renderSuggestedSwatches()},trackColors:!0,addRecentColor:function(a){a&&"no-color"!==a&&this._addRecentColor(n.normalizeColor(a).toHex())},loadRecentColors:function(a){this.set("recentColors",JSON.parse(localStorage.getItem(a)))},saveRecentColors:function(a){localStorage.setItem(a,JSON.stringify(this.get("recentColors")))},_toPastels:function(a){var b=this._colorInstance,c=new p([238,238,238]);return e.map(a,function(a){return p.blendColors(b.setColor(a),
c,.2)},this)},_createSwatch:function(a){var b=a.className,c=a.hexColor||"transparent";a=a.paletteNode;var e=this.id+"_"+b.replace(" ","-")+"_"+c.replace("#","");return x.create("span",{id:e,"aria-label":c,role:"gridcell",className:b,style:{background:c}},a)},_createSwatches:function(a,b){var c=this.css.swatch,f=this.css.swatchRow,g=this.colorsPerRow;b=b.get("colors");var k,m;e.forEach(b,function(b,e){0===e%g&&(k=x.create("div",{className:f,role:"row"},a));m=this._swatchCreator({className:c,hexColor:b,
paletteNode:k});this._swatches[b]=m},this)},_selectColor:function(){var a=this.color||this._activePalette.get("colors")[0];this.set("color",a)},_setColorWithCurrentAlpha:function(a){"no-color"!==a&&"no-color"!==this.color&&(a=n.normalizeColor(a),a.a=this.color.a);this.set("color",a)},_updatePreviewSwatch:function(a){var b=this.css.swatchEmpty,e=this.dap_previewSwatch,f,g;"no-color"===a?(c.add(e,b),E.set(e,{backgroundColor:"",borderColor:""})):(f=n.getContrastingColor(a),g=8!==z("ie"),c.remove(e,b),
b=a.toCss(g),f=f.toCss(g),f={backgroundColor:b,borderColor:f},g||(f.opacity=a.a),E.set(e,f))},_showBrights:function(){c.remove(this.dap_paletteContainer,this.css.alt);this._activePalette=this._brightsPalette},_showPastels:function(){c.add(this.dap_paletteContainer,this.css.alt);this._activePalette=this._pastelsPalette},_setColorFromSwatch:function(a){a=E.get(a,"backgroundColor");this._setColorWithCurrentAlpha(a)},_checkSelection:function(){var a=this.get("color");this._activePalette.contains(a)?this._highlightColor(a):
this._clearSelection()},_landSwatch:function(a){var b=a.index,e=a.colors,f=a.swatches;a=a.paletteNode;var g=e[b],e=g&&this._findSwatch({colors:e,color:g,swatches:f}),f=this.css.focusedSwatch;C("."+f,a).removeClass(f).style("borderColor","");a.removeAttribute("aria-activedescendant");this._swatchNavigationIndex=b;e&&null!=b&&(c.add(e,f),b=n.getContrastingColor(n.normalizeColor(g)),E.set(e,"borderColor",b.toHex()),a.setAttribute("aria-activedescendant",e.id))},_navigateSwatches:function(a,b){var c=
a.keyCode,e=b.color,f=b.colors,g=b.swatches;b=b.paletteNode;e="no-color"===e?-1:f.indexOf(e.toHex());e=null!=this._swatchNavigationIndex?this._swatchNavigationIndex:-1<e?e:0;if(c===w.ENTER)this._landSwatch({paletteNode:b,colors:f,index:null,swatches:g}),this.set("color",f[e]);else{var k=this.colorsPerRow;c===w.LEFT_ARROW&&e--;c===w.RIGHT_ARROW&&e++;c===w.DOWN_ARROW&&(e+=k,e>f.length&&(e%=k),a.preventDefault());c===w.UP_ARROW&&(e-=Math.min(k,f.length),0>e&&(e=f.length+e),a.preventDefault());-1===e?
e=f.length-1:e===f.length&&(e=0);this._landSwatch({paletteNode:b,colors:f,index:e,swatches:g})}},_addListeners:function(){var b="."+this.css.swatch,c=this.dap_paletteContainer;this.own(q(c,q.selector(b,f),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})),q(c,"blur",a.hitch(this,function(){this._landSwatch({paletteNode:c,colors:this._activePalette.get("colors"),index:null})})),q(c,"keydown",a.hitch(this,function(a){this._navigateSwatches(a,{color:this.get("color"),colors:this._activePalette.get("colors"),
paletteNode:c,swatches:this._swatches})})));var e=this.dap_recentColorPaletteContainer;this.own(q(e,q.selector(b,f),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})),q(e,"keydown",a.hitch(this,function(a){this._navigateSwatches(a,{color:"no-color",colors:this.recentColors,paletteNode:e,swatches:this._recentSwatches})})),q(e,"blur",a.hitch(this,function(){this._landSwatch({paletteNode:e,colors:this.recentColors,index:null})})));var g=this.dap_suggestedColorPaletteContainer;this.own(q(g,
q.selector(b,f),a.hitch(this,function(a){this._setColorFromSwatch(a.target)})),q(g,"keydown",a.hitch(this,function(a){this._navigateSwatches(a,{color:"no-color",colors:this.suggestedColors,paletteNode:g,swatches:this._suggestedSwatches})})),q(g,"blur",a.hitch(this,function(){this._landSwatch({paletteNode:g,colors:this.suggestedColors,index:null})})));this.own(q(this._noColorSwatchNode,f,a.hitch(this,function(a){this.set("color","no-color")})));var k=this.dap_hexInput;k.on("blur",a.hitch(this,function(){var a=
n.normalizeHex(k.get("value"));n.isShorthandHex(a)?this._setColorWithCurrentAlpha(a):this._silentlyUpdateHexInput(this.color)}));k.on("change",a.hitch(this,function(){var a=n.normalizeHex(k.get("value"));n.isLonghandHex(a)&&("no-color"!==this.color&&this.color.toHex()===a||this._setColorWithCurrentAlpha(a))}));this.dap_transparencySlider.on("change",a.hitch(this,function(a){var b=this.get("color");"no-color"!==b&&(b=n.normalizeColor(this._colorInstance.setColor(b)),b.a=1-a/100,this._updatePreviewSwatch(b),
this._silentlyUpdateHexInput(b),this.set("color",b))}));this.dap_paletteToggle.on("change",a.hitch(this,this._togglePalette));this.own(q(this.dap_header,"click",function(){this.collapsible&&this.set("collapsed",!this.collapsed)}.bind(this)))},_togglePalette:function(a){this.dap_paletteToggle.set("checked",a,!1);a?this._showPastels():this._showBrights();this._checkSelection()},_createPalettes:function(){this._swatches={};x.empty(this.dap_primaryPalette);x.empty(this.dap_secondaryPalette);this._createSwatches(this.dap_primaryPalette,
this._brightsPalette);this._createSwatches(this.dap_secondaryPalette,this._pastelsPalette)},_silentlyUpdateHexInput:function(a){a="no-color"===a?"":a.toHex();this._silentlyUpdateIntermediateChangingValueWidget(this.dap_hexInput,a)},_silentlyUpdateIntermediateChangingValueWidget:function(a,b){a.intermediateChanges=!1;a.set("value",b,!1);a.intermediateChanges=!0},_addRecentColor:function(a){if(a){var b=this.recentColors,c=e.indexOf(b,a);-1<c&&b.splice(c,1);b.unshift(a);b.length>this.colorsPerRow&&b.pop();
this._renderRecentSwatches()}},_renderRecentSwatches:function(){if(this.recentColors){var a=this.css.recent,b=this.css.swatch,c=C("."+a+"."+b,this.dap_recentColorPalette);this._recentSwatches={};e.forEach(this.recentColors,function(e,f){f<this.colorsPerRow&&(f+1>c.length&&c.push(this._swatchCreator({hexColor:e,className:b+" "+a,paletteNode:this.dap_recentColorPalette})),f=c[f],this._recentSwatches[e]=f,E.set(f,"backgroundColor",e))},this)}},_renderSuggestedSwatches:function(){if(this.suggestedColors){var a=
this.css.suggested,b=this.css.swatch,c=C("."+a+"."+b,this.dap_suggestedColorPalette);this._suggestedSwatches={};e.forEach(this.suggestedColors,function(e,f){f<this.colorsPerRow&&(f+1>c.length&&c.push(this._swatchCreator({hexColor:e,className:b+" "+a,paletteNode:this.dap_suggestedColorPalette})),f=c[f],this._suggestedSwatches[e]=f,E.set(f,"backgroundColor",e))},this)}},_clearRecentSwatches:function(){x.empty(this.dap_recentColorPalette)},_clearSuggestedSwatches:function(){x.empty(this.dap_suggestedColorPalette)},
_clearSelection:function(){var a=this.css.selected;C("."+a,this.dap_paletteContainer).removeClass(a).removeAttr("aria-selected")},_highlightColor:function(a){var b=this.css.selected,e=this._findSwatch({colors:this._activePalette.get("colors"),color:a,swatches:this._swatches});e&&(a=n.normalizeColor(a),a=n.getContrastingColor(a),c.add(e,b),E.set(e,"borderColor",a.toHex()),e.setAttribute("aria-selected",!0))},_findSwatch:function(a){var b=a.colors,c=this._colorInstance.setColor(a.color).toHex(),f;-1<
e.indexOf(b,c)&&(f=a.swatches[c]);return f},_enableTransparencySlider:function(){c.remove(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!1)},_disableTransparencySlider:function(){c.add(this.dap_transparencyLabel,this.css.disabled);this.dap_transparencySlider.set("disabled",!0)}});g.NO_COLOR="no-color";return g})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(p,g,t,v,
n){return t(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||g.forEach(this._tooltips,function(g){g.startup()})},destroy:function(){this.inherited(arguments);g.forEach(this._tooltips,function(g){g.destroy()});this._tooltips=null},createTooltips:function(m){g.forEach(m,function(g){this.createTooltip(g.node,g.label)},this)},createTooltip:function(g,n){if(g=this._getConnectId(g))n="object"===
typeof n?v.mixin({},n,{connectId:g}):{connectId:g,label:n},n=new p(n),this._started&&n.startup(),this._tooltips.push(n)},_getConnectId:function(m){var n,k;if(m){if(v.isArray(m)){if(n=[],g.forEach(m,function(f){(k=this._getNode(f))&&n.push(k)}),0===n.length)return}else if(n=this._getNode(m),!n)return;return n}},_getNode:function(g){return n.byId(g.domNode||g)},findTooltip:function(m){var n=this._getNode(m),k,f,e;if(m){m=this._tooltips;k=m.length;for(var b=0;b<k;b++)if(f=m[b],e=v.isArray(f.connectId)?
-1<g.indexOf(f.connectId,n):f.connectId===n)return f}}})})},"esri/dijit/ColorPicker/colorUtil":function(){define(["dojo/_base/lang","../../Color"],function(p,g){var t={equal:function(g,n){return g&&n&&g.r===n.r&&g.g===n.g&&g.b===n.b&&g.a===n.a},normalizeHex:function(g){return"#"+p.trim(g).replace(/#/g,"").substr(0,6)},normalizeColor:function(p){return new g(p)},isValidHex:function(g){return t.isShorthandHex(g)||t.isLonghandHex(g)},_shortHandHex:/^#[0-9A-F]{3}$/i,isShorthandHex:function(g){return g&&
4===g.length&&t._shortHandHex.test(g)},_longhandHex:/^#[0-9A-F]{6}$/i,isLonghandHex:function(g){return g&&7===g.length&&t._longhandHex.test(g)},getContrastingColor:function(g){return t.isBright(g)?this.darker(g):this.brighter(g,3)},isBright:function(g){return 127<=.299*g.r+.587*g.g+.114*g.b},darker:function(p,n){n=Math.pow(.7,n?n:1);return new g([Math.round(p.r*n),Math.round(p.g*n),Math.round(p.b*n),p.a])},brighter:function(p,n){n=Math.pow(.7,n?n:1);var m=p.r,u=p.g,k=p.b;30>m&&(m=30);30>u&&(u=30);
30>k&&(k=30);return new g([Math.min(255,Math.round(m/n)),Math.min(255,Math.round(u/n)),Math.min(255,Math.round(k/n)),p.a])}};return t})},"esri/dijit/ColorPicker/HexPalette":function(){define(["dojo/_base/array","dojo/_base/Color","dojo/_base/declare","dojo/Stateful"],function(p,g,t,v){var n="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004c".split(" ");
g=t([v],{constructor:function(g){g=g||{};this.set("colors",g.colors)},_colorInstance:new g,_colors:null,_colorsGetter:function(){return this._colors},_colorsSetter:function(g){g=g?g:n;this._colors=this._normalizeColors(g)},_normalizeColors:function(g){var m=this._colorInstance;return p.map(g,function(g){return m.setColor(g).toHex()},this)},contains:function(g){var m=this._colorInstance;m.setColor(g);return-1<p.indexOf(this._colors,m.toHex())}});g.DEFAULT_COLORS=n;return g})},"esri/dijit/HorizontalSlider":function(){define("dijit/form/HorizontalRuleLabels dijit/form/HorizontalSlider dojo/_base/declare dojo/_base/lang dojo/has ../kernel".split(" "),
function(p,g,t,v,n,m){return t("esri.dijit.HorizontalSlider",g,{baseClass:"esriHorizontalSlider",showButtons:!1,labels:null,constructor:function(g){g=g||{};g.labels&&(this.labels=g.labels)},buildRendering:function(){this.inherited(arguments);this.labels&&(new p({labels:this.labels})).placeAt(this.bottomDecoration)}})})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(p,g,t,v,n,m){p=p("dijit.form.HorizontalRuleLabels",
m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(g){return g},_genHTML:function(g,k){k=
this.labels[k];return this._positionPrefix+this._calcPosition(g)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(k)+this._labelPrefix+k+this._suffix},_genDirectionHTML:function(g){return""},getLabels:function(){var g=this.labels;!g.length&&this.srcNodeRef&&(g=v("\x3e li",this.srcNodeRef).map(function(b){return String(b.innerHTML)}));if(!g.length&&1<this.count)for(var g=[],k=this.minimum,f=(this.maximum-k)/(this.count-1),e=0;e<this.count;e++)g.push(e<this.numericMargin||e>=this.count-this.numericMargin?
"":t.format(k,this.constraints)),k+=f;return g},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();this.count=this.labels.length}});g("dojo-bidi")&&p.extend({_setTextDirAttr:function(g){this.textDir!=g&&(this._set("textDir",g),v(".dijitRuleLabelContainer",this.domNode).forEach(n.hitch(this,function(g){g.style.direction=this.getTextDir(g.innerText||g.textContent||"")})))},_genDirectionHTML:function(g){return this.textDir?"direction:"+this.getTextDir(g)+";":""}});
return p})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(p,g,t){return p("dijit.form.HorizontalRule",[g,t],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(g){return this._positionPrefix+g+this._positionSuffix+
this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var g;if(1==this.count)g=this._genHTML(50,0);else{var n,m=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){g=this._genHTML(0,0);for(n=1;n<this.count-1;n++)g+=this._genHTML(m*n,n);g+=this._genHTML(100,this.count-1)}else{g=this._genHTML(100,0);for(n=1;n<this.count-1;n++)g+=this._genHTML(100-m*n,n);g+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=g}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){var F=g("dijit.form._SliderMover",b,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=n.position(b.sliderBarContainer,!0),b._setPixelValue_=k.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(a){b.prototype.destroy.apply(this,arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,
!0)}});t=g("dijit.form.HorizontalSlider",[E,B],{templateString:G,value:0,showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:w.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",
_onKeyUp:function(a){this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey||this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey||a.metaKey)){switch(a.keyCode){case u.HOME:this._setValueAttr(this.minimum,!1);break;case u.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?u.RIGHT_ARROW:u.LEFT_ARROW:case !1===this._descending?u.DOWN_ARROW:u.UP_ARROW:case !1===this._descending?u.PAGE_DOWN:u.PAGE_UP:this.increment(a);
break;case this._descending||this.isLeftToRight()?u.LEFT_ARROW:u.RIGHT_ARROW:case !1===this._descending?u.UP_ARROW:u.DOWN_ARROW:case !1===this._descending?u.PAGE_UP:u.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){this.disabled||this.readOnly||(f("ie")||q.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&
this.clickSelect){q.focus(this.sliderHandle);a.stopPropagation();a.preventDefault();var b=n.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var e=this.discreteValues;if(1>=e||Infinity==e)e=b;e--;this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*Math.round(a/
(b/e))/e+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,e=!1===this._descending?this.remainingBar:this.progressBar,f=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&
e.style[this._progressPixelSize]){var g=this,k={},m=parseFloat(e.style[this._progressPixelSize]),n=this.slideDuration*(c-m/100);0!=n&&(0>n&&(n=0-n),k[this._progressPixelSize]={start:m,end:100*c,units:"%"},this._inProgressAnim=v.animateProperty({node:e,duration:n,onAnimate:function(a){f.style[g._progressPixelSize]=100-parseFloat(a[g._progressPixelSize])+"%"},onEnd:function(){delete g._inProgressAnim},properties:k}),this._inProgressAnim.play())}else e.style[this._progressPixelSize]=100*c+"%",f.style[this._progressPixelSize]=
100*(1-c)+"%"},_bumpValue:function(a,b){if(!(this.disabled||this.readOnly||this.maximum<=this.minimum)){var c=m.getComputedStyle(this.sliderBarContainer),e=n.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=e[this._pixelCount];c--;a=Math.round((this.value-this.minimum)*c/(this.maximum-this.minimum))+a;0>a&&(a=0);a>c&&(a=c);a=a*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(a,b)}},_onClkBumper:function(a){this.disabled||this.readOnly||!this.clickSelect||
this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==u.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==u.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){this.focused&&(a.stopPropagation(),a.preventDefault(),this._bumpValue(0>a.wheelDelta?-1:1,!0))},
startup:function(){this._started||(p.forEach(this.getChildren(),function(a){this[a.container]!=this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display=
"");var b=a('label[for\x3d"'+this.id+'"]');b.length&&(b[0].id||(b[0].id=this.id+"_label"),this.focusNode.setAttribute("aria-labelledby",b[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(C.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),C.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(x(this.domNode,
c.wheel,k.hitch(this,"_mouseWheeled")));var a=g(F,{widget:this});this._movable=new e(this.sliderHandle,{mover:a});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});t._Mover=F;return t})},"dijit/typematic":function(){define("dojo/_base/array dojo/_base/connect dojo/_base/lang dojo/on dojo/sniff ./main".split(" "),function(p,g,t,v,n,m){var u=m.typematic={_fireEventAndReload:function(){this._timer=
null;this._callback(++this._count,this._node,this._evt);this._currentTimeout=Math.max(0>this._currentTimeout?this._initialDelay:1<this._subsequentDelay?this._subsequentDelay:Math.round(this._currentTimeout*this._subsequentDelay),this._minDelay);this._timer=setTimeout(t.hitch(this,"_fireEventAndReload"),this._currentTimeout)},trigger:function(g,f,e,b,a,c,m,n){if(a!=this._obj){this.stop();this._initialDelay=m||500;this._subsequentDelay=c||.9;this._minDelay=n||10;this._obj=a;this._node=e;this._count=
this._currentTimeout=-1;this._callback=t.hitch(f,b);this._evt={faux:!0};for(var k in g)"layerX"!=k&&"layerY"!=k&&(f=g[k],"function"!=typeof f&&"undefined"!=typeof f&&(this._evt[k]=f));this._fireEventAndReload()}},stop:function(){this._timer&&(clearTimeout(this._timer),this._timer=null);this._obj&&(this._callback(-1,this._node,this._evt),this._obj=null)},addKeyListener:function(k,f,e,b,a,c,m){var n="keyCode"in f?"keyCode":"charCode"in f?"charCode":"charOrCode",q=[v(k,"keyCode"in f?"keydown":"charCode"in
f?"keypress":g._keypress,t.hitch(this,function(g){g[n]!=f[n]||void 0!==f.ctrlKey&&f.ctrlKey!=g.ctrlKey||void 0!==f.altKey&&f.altKey!=g.altKey||void 0!==f.metaKey&&f.metaKey!=(g.metaKey||!1)||void 0!==f.shiftKey&&f.shiftKey!=g.shiftKey?u._obj==f&&u.stop():(g.stopPropagation(),g.preventDefault(),u.trigger(g,e,k,b,f,a,c,m))})),v(k,"keyup",t.hitch(this,function(){u._obj==f&&u.stop()}))];return{remove:function(){p.forEach(q,function(a){a.remove()})}}},addMouseListener:function(g,f,e,b,a,c){var k=[v(g,
"mousedown",t.hitch(this,function(k){k.preventDefault();u.trigger(k,f,g,e,g,b,a,c)})),v(g,"mouseup",t.hitch(this,function(a){this._obj&&a.preventDefault();u.stop()})),v(g,"mouseout",t.hitch(this,function(a){this._obj&&a.preventDefault();u.stop()})),v(g,"dblclick",t.hitch(this,function(k){k.preventDefault();9>n("ie")&&(u.trigger(k,f,g,e,g,b,a,c),setTimeout(t.hitch(this,u.stop),50))}))];return{remove:function(){p.forEach(k,function(a){a.remove()})}}},addListener:function(g,f,e,b,a,c,m,n){var k=[this.addKeyListener(f,
e,b,a,c,m,n),this.addMouseListener(g,b,a,c,m,n)];return{remove:function(){p.forEach(k,function(a){a.remove()})}}}};return u})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(p,g,t){return p("dijit.form.RadioButton",[g,t],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(p,g,t,v,n,m){return g("dijit.form._RadioButtonMixin",
null,{type:"radio",_getRelatedWidgets:function(){var g=[];n("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(v.hitch(this,function(k){k.name==this.name&&k.form==this.focusNode.form&&(k=m.getEnclosingWidget(k))&&g.push(k)}));return g},_setCheckedAttr:function(g){this.inherited(arguments);this._created&&g&&p.forEach(this._getRelatedWidgets(),v.hitch(this,function(g){g!=this&&g.checked&&g.set("checked",!1)}))},_getSubmitValue:function(g){return null==g?"on":g},_onClick:function(g){if(this.checked||
this.disabled)return g.stopPropagation(),g.preventDefault(),!1;if(this.readOnly)return g.stopPropagation(),g.preventDefault(),p.forEach(this._getRelatedWidgets(),v.hitch(this,function(e){t.set(this.focusNode||this.domNode,"checked",e.checked)})),!1;var k=!1,f;p.some(this._getRelatedWidgets(),function(e){return e.checked?(f=e,!0):!1});this.checked=!0;f&&(f.checked=!1);if(!1===this.onClick(g)||g.defaultPrevented)k=!0;this.checked=!1;f&&(f.checked=!0);k?g.preventDefault():this.set("checked",!0);return!k}})})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(p,g,t,v,n,m){var u=t("dijit._editor.plugins.TextColor",n,{buttonClass:m,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var g=this;this.button.loadDropDown=function(f){function e(b){g.button.dropDown=new b({dir:g.editor.dir,ownerDocument:g.editor.ownerDocument,
value:g.value,onChange:function(a){g.editor.execCommand(g.command,a)},onExecute:function(){g.editor.execCommand(g.command,this.get("value"))}});f()}"string"==typeof g.colorPicker?p([g.colorPicker],e):e(g.colorPicker)}},updateState:function(){var k=this.editor,f=this.command;if(k&&k.isLoaded&&f.length){if(this.button){var e=this.get("disabled");this.button.set("disabled",e);if(e)return;var b;try{b=k.queryCommandValue(f)||""}catch(a){b=""}}""==b&&(b="#000000");"transparent"==b&&(b="#ffffff");"string"==
typeof b?-1<b.indexOf("rgb")&&(b=g.fromRgb(b).toHex()):(b=((b&255)<<16|b&65280|(b&16711680)>>>16).toString(16),b="#000000".slice(0,7-b.length)+b);this.value=b;(k=this.button.dropDown)&&k.get&&b!==k.get("value")&&k.set("value",b,!1)}}});n.registry.foreColor=function(g){return new u(g)};n.registry.hiliteColor=function(g){return new u(g)};return u})},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(p,g,t,v){var n={};g.setObject("dojo.colors",
n);var m=function(g,f,e){0>e&&++e;1<e&&--e;var b=6*e;return 1>b?g+(f-g)*b:1>2*e?f:2>3*e?g+(f-g)*(2/3-e)*6:g};p.colorFromRgb=t.fromRgb=function(g,f){var e=g.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(e){g=e[2].split(/\s*,\s*/);var b=g.length,e=e[1];if("rgb"==e&&3==b||"rgba"==e&&4==b)return e=g[0],"%"==e.charAt(e.length-1)?(e=v.map(g,function(a){return 2.56*parseFloat(a)}),4==b&&(e[3]=g[3]),t.fromArray(e,f)):t.fromArray(g,f);if("hsl"==e&&3==b||"hsla"==e&&4==b){var e=(parseFloat(g[0])%
360+360)%360/360,a=parseFloat(g[1])/100,c=parseFloat(g[2])/100,a=.5>=c?c*(a+1):c+a-c*a,c=2*c-a,e=[256*m(c,a,e+1/3),256*m(c,a,e),256*m(c,a,e-1/3),1];4==b&&(e[3]=g[3]);return t.fromArray(e,f)}}return null};var u=function(g,f,e){g=Number(g);return isNaN(g)?e:g<f?f:g>e?e:g};t.prototype.sanitize=function(){this.r=Math.round(u(this.r,0,255));this.g=Math.round(u(this.g,0,255));this.b=Math.round(u(this.b,0,255));this.a=u(this.a,0,1);return this};n.makeGrey=t.makeGrey=function(g,f){return t.fromArray([g,g,
g,f])};g.mixin(t.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,
169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,
34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,
250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,
104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,
192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,
222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return t})},"dijit/form/DropDownButton":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/query ../registry ../popup ./Button ../_Container ../_HasDropDown dojo/text!./templates/DropDownButton.html ../a11yclick".split(" "),function(p,g,t,v,n,m,u,k,f,e){return p("dijit.form.DropDownButton",[u,k,f],{baseClass:"dijitDropDownButton",templateString:e,_fillContent:function(){var b=this.srcNodeRef,a=this.containerNode;
if(b&&a)for(;b.hasChildNodes();){var c=b.firstChild;c.hasAttribute&&(c.hasAttribute("data-dojo-type")||c.hasAttribute("dojoType")||c.hasAttribute("data-"+g._scopeName+"-type")||c.hasAttribute(g._scopeName+"Type"))?(this.dropDownContainer=this.ownerDocument.createElement("div"),this.dropDownContainer.appendChild(c)):a.appendChild(c)}},startup:function(){this._started||(!this.dropDown&&this.dropDownContainer&&(this.dropDown=n.byNode(this.dropDownContainer.firstChild),delete this.dropDownContainer),
this.dropDown&&m.hide(this.dropDown),this.inherited(arguments))},isLoaded:function(){var b=this.dropDown;return!!b&&(!b.href||b.isLoaded)},loadDropDown:function(b){var a=this.dropDown,c=a.on("load",t.hitch(this,function(){c.remove();b()}));a.refresh()},isFocusable:function(){return this.inherited(arguments)&&!this._mouseDown}})})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){var c=g("dijit._editor.plugins.LinkDialog",e,{buttonClass:b,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=n.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){p("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),n.hitch(this,function(b,c,e){var g=this;this.tag="insertImage"==this.command?"img":"a";b=n.delegate(b.getLocalization("dijit","common",this.lang),b.getLocalization("dijit._editor",
"LinkDialog",this.lang));var k=this.dropDown=this.button.dropDown=new c({title:b[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:n.hitch(this,"setValue"),onOpen:function(){g._onOpenDialog();c.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(n.hitch(g,"_onCloseDialog"),0)}});b.urlRegExp=this.urlRegExp;b.id=e.getUniqueId(this.editor.id);this._uniqueId=b.id;this._setContent(k.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
f.substitute(this.linkDialogTemplate,b));k.startup();this._urlInput=e.byId(this._uniqueId+"_urlInput");this._textInput=e.byId(this._uniqueId+"_textInput");this._setButton=e.byId(this._uniqueId+"_setButton");this.own(e.byId(this._uniqueId+"_cancelButton").on("click",n.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",n.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",n.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=n.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(m(k.domNode,"keydown",n.hitch(this,n.hitch(this,function(a){!a||a.keyCode!=v.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(k.onExecute(),k.execute(k.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,b=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var c=b,e=!1,f=!1;c&&1<c.length&&(c=n.trim(c),0!==c.indexOf("mailto:")&&(0<c.indexOf("/")?-1===c.indexOf("://")&&"/"!==c.charAt(0)&&c.indexOf("./")&&0!==c.indexOf("../")&&a._hostRxp.test(c)&&(e=!0):a._userAtRxp.test(c)&&(f=!0)));e&&a._urlInput.set("value","http://"+c);f&&a._urlInput.set("value","mailto:"+c);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(n.hitch(this,
function(){this.own(m(this.editor.editNode,"mouseup",n.hitch(this,"_onMouseUp")));this.own(m(this.editor.editNode,"dblclick",n.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},_createlinkEnabledImpl:function(){return!0},setValue:function(b){this._onCloseDialog();
if(9>u("ie")){var c=a.getSelection(this.editor.window).getRangeAt(0).endContainer;3===c.nodeType&&(c=c.parentNode);c&&c.nodeName&&c.nodeName.toLowerCase()!==this.tag&&(c=this.editor.selection.getSelectedElement(this.tag));c&&c.nodeName&&c.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(c),this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",f.substitute(this.htmlTemplate,b));k("a",
this.editor.document).forEach(function(a){a.innerHTML||t.has(a,"name")||a.parentNode.removeChild(a)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(a){var b,c,e;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),e=a.getAttribute("target")||"_self",c=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||"",targetSelect:e||
""}},_onOpenDialog:function(){var b,c;if(u("ie")){if(c=a.getSelection(this.editor.window),c.rangeCount){var e=c.getRangeAt(0);b=e.endContainer;3===b.nodeType&&(b=b.parentNode);b&&b.nodeName&&b.nodeName.toLowerCase()!==this.tag&&(b=this.editor.selection.getSelectedElement(this.tag));if(!b||b.nodeName&&b.nodeName.toLowerCase()!==this.tag)(c=this.editor.selection.getAncestorElement(this.tag))&&c.nodeName&&c.nodeName.toLowerCase()==this.tag?(b=c,this.editor.selection.selectElement(b)):e.startContainer===
e.endContainer&&(c=e.startContainer.firstChild)&&c.nodeName&&c.nodeName.toLowerCase()==this.tag&&(b=c,this.editor.selection.selectElement(b))}}else b=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(b))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&t.get(a,"href"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();
b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}},_onMouseUp:function(){if(u("ff")){var b=this.editor.selection.getAncestorElement(this.tag);if(b){var c=a.getSelection(this.editor.window).getRangeAt(0);if(c.collapsed&&b.childNodes.length){var e=c.cloneRange();e.selectNodeContents(b.childNodes[b.childNodes.length-
1]);e.setStart(b.childNodes[0],0);1!==c.compareBoundaryPoints(e.START_TO_START,e)?c.setStartBefore(b):-1!==c.compareBoundaryPoints(e.END_TO_START,e)&&c.setStartAfter(b)}}}}}),x=g("dijit._editor.plugins.ImgLinkDialog",[c],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,c;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),c=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):c=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:c||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(n.hitch(this,
function(){this.own(m(this.editor.editNode,"mousedown",n.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&t.get(a,
"src"))){var b=this.editor;this.editor.selection.selectElement(a);b.onDisplayChanged();b._updateTimer&&(b._updateTimer.remove(),delete b._updateTimer);b.onNormalizedDisplayChanged();var c=this.button;setTimeout(function(){c.set("disabled",!1);c.loadAndOpenDropDown().then(function(){c.dropDown.focus&&c.dropDown.focus()})},10)}}});e.registry.createLink=function(){return new c({command:"createLink"})};e.registry.insertImage=function(){return new x({command:"insertImage"})};c.ImgLinkDialog=x;return c})},
"builder/plugins/app-config-templateconfig/_build-generate_module":function(){define(["builder/plugins/app-config-templateconfig/Plugin","dojo/text!builder/plugins/app-config-templateconfig/Plugin.html","dojo/text!builder/plugins/app-config-templateconfig/css/style.css","dojo/i18n!builder/plugins/app-config-templateconfig/nls/strings"],function(){})},"builder/plugins/app-config-templateconfig/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,g,t,v,n,m,u,k){return p([n],{baseClass:"plugin-config-template",postCreate:function(){this.inherited(arguments);this.own(v.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)));this.own(v.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.pluginManager.getPluginByName("app-config").addRepublishEvent("templateConfigChanged")},_init:function(){this.visible&&this.appConfig&&u.loadAllWidgetConfigs(g.clone(this.appConfig)).then(g.hitch(this,function(f){this._initConfigPanel(f);
this._initPriviewPanel(this.configTemplate.getTemplateConfig())}))},_initConfigPanel:function(f){this.configTemplate&&this.configTemplate.destroy();this.configTemplate=new m({appConfig:f,appInfo:window.appInfo,templateConfig:f.templateConfig});this.configTemplate.on("hasChanged",g.hitch(this,this._onConfigTempalteChanged));t.place(this.configTemplate.domNode,this.configPanel);this.configTemplate.startup()},_initPriviewPanel:function(f){this.previewTemplate&&this.previewTemplate.destroy();this.previewTemplate=
new k({templateConfig:f});t.place(this.previewTemplate.domNode,this.previewPanel);this.previewTemplate.startup()},_onAppConfigLoaded:function(f){this.appConfig=f;this._init()},_onAppConfigChanged:function(f){this.appConfig=f},_onToAppClick:function(){this.pluginManager.getPluginByName("app-config").switchToConfigApp()},_onConfigTempalteChanged:function(){this._initPriviewPanel(this.configTemplate.getTemplateConfig());v.publish("templateConfigChanged",this.configTemplate.getFullTemplateConfig())},
refresh:function(){this._init()}})})},"builder/dijit/template-config/Template":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Template.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dojo/Evented dijit/form/Select ./ConfigNode ./CategoryManager ./Export builder/serviceUtils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/portalUrlUtils builder/portalUtils jimu/dijit/LoadingShelter ./ExportMessage".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q){return p([v,n,C],{templateString:m,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,constructor:function(){this.loading=new M({hidden:!0})},postMixInProperties:function(){this.nls=window.builderNls;this.imageFolder="builder/css/images/agoltemplate/";this.arrowImgSrc=isRTL?this.imageFolder+"v_left.png":this.imageFolder+"v_right.png"},postCreate:function(){this.inherited(arguments)},startup:function(){this._beforeInitWork();
k.setSelectable(this.contentPart,!1);this.configTree=new E(this.cleanAppConfig,null,"app","",0);this.categoryManager=new B(this.configTree,this.cleanAppConfig,this.templateConfig);this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this._afterInitWork()},_beforeInitWork:function(){this.cleanAppConfig=this.appConfig.getCleanConfig(!0);delete this.cleanAppConfig.visitElement;delete this.cleanAppConfig._buildInfo;delete this.cleanAppConfig.agolTemplateJson},_afterInitWork:function(){this.lastTemplateJson=
this.categoryManager.getTemplateJson()},drawTree:function(a,b){var c;b=this.drawDomNode(a,b);if(0!==a.childs.length)for(c=0;c<a.childs.length;c++)this.drawTree(a.childs[c],b)},drawDomNode:function(a,c){var g,k,m,n,p;p=this.categoryManager.getCategoryByField(a.absolutePath);g=e.create("div",{"class":"tree-node-div",idAttr:a.id},c);a.traversal(f.hitch(this,function(a){if(this.categoryManager.getCategoryByField(a.absolutePath))return!0}))||b.set(g,"display","none");"leaf"!==a.nodeType||p||b.set(g,"color",
"#cccccc");k=e.create("div",{"class":"line-label-div "},g);var q=a.label?a.label:a.keyString;q.indexOf("]")===q.length-1&&(q+="\x26lrm;");q=e.create("div",{"class":"line-label-text ",innerHTML:q,title:q},k);"leaf"!==a.nodeType&&t.addClass(q,"leaf-node");p&&"leaf"===a.nodeType&&(m=e.create("div",{"class":"to-right-div "},g),e.create("img",{"class":"to-right-img",src:this.imageFolder+"add_field.png",alt:"img"},m),this.own(u(m,"click",f.hitch(this,function(c){b.set(m,"display","none");this._onToRightDiv(a,
"add",g);c.stopPropagation();this._checkTemplateStatus()}))),-1!==p.findFieldFromDisplay(a.absolutePath)&&b.set(m,"display","none"));n=12*a.level;"leaf"===a.nodeType?isRTL?b.set(k,"paddingRight",n+17+"px"):b.set(k,"paddingLeft",n+17+"px"):isRTL?b.set(k,"paddingRight",n+"px"):b.set(k,"paddingLeft",n+"px");c=e.create("div",{"class":"tree-node-subdiv"},c);b.set(c,"display","none");"leaf"!==a.nodeType?(b.set(g,"cursor","pointer"),this.own(u(g,"click",f.hitch(this,function(a,c,d){"none"===b.get(c,"display")?
(b.set(c,"display","block"),t.addClass(d,"unfold")):(b.set(c,"display","none"),t.removeClass(d,"unfold"));-1===a.absolutePath.search(/widgets\[[0-9]+\]_config$/)||a.jsonObject||this.addWidgetConfigToConfigTree(a.absolutePath)},a,c,q)))):p&&(b.set(g,"cursor","pointer"),this.own(u(g,"click",f.hitch(this,function(a,b){this._onToRightDiv(a,"notAdd",g);b.stopPropagation()},a))));a.lineDomNode=g;a.subLineDomNode=c;a.showSubDivDomNode=void 0;a.toRightDiv=m;0===a.level&&(t.setStyle(g,"display","none"),t.setStyle(c,
"display","block"));return c},drawCategoryPart:function(){g.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var k,m,n,p,q,w,x;k=e.create("div",{"class":"category-div",categoryDiv:a.name},this.categoryPart);p=e.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},k);q=e.create("div",{"class":"category-fold-div jimu-float-leading"},p);x=e.create("img",{"class":"category-fold-img",src:this.arrowImgSrc,alt:"img"},q);e.create("div",
{"class":"category-title-div jimu-float-leading",innerHTML:a.title},p);m=e.create("div",{"class":"category-oper-div jimu-float-trailing"},p);q=e.create("div",{"class":"category-oper-item-div category-moveup-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},m);w=e.create("div",{"class":"category-oper-item-div category-movedown-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},
m);m=e.create("div",{"class":"category-oper-item-div category-remove-div jimu-float-leading",innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},m);n=e.create("div",{"class":"fields-div",fieldsDiv:a.name},k);this.own(u(q,"click",f.hitch(this,function(b){this.categoryManager.moveup(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(u(w,"click",f.hitch(this,
function(b){this.categoryManager.movedown(a)&&(e.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation();this._checkTemplateStatus()})));this.own(u(m,"click",f.hitch(this,function(c){this.categoryManager.removeCategoryFromDisplay(a);e.destroy(k);g.forEach(a.displayFields,function(a){var d=this.configTree.findNode(a.fieldPath);d&&(d.setTemplateField(a.fieldJson),d.toRightDiv&&b.set(d.toRightDiv,"display","block"))},this);a.displayFields=[];c.stopPropagation();
this._checkTemplateStatus()})));this.own(u(p,"click",f.hitch(this,function(){"block"===b.get(n,"display")?(b.set(n,"display","none"),c.set(x,"src",this.arrowImgSrc)):(b.set(n,"display","block"),c.set(x,"src",this.imageFolder+"v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,k,n);b.set(n,"display","none")},drawFields:function(a,b,c){g.forEach(a.displayFields,function(e){this.drawField(a,b,c,e)},this)},addWidgetConfigToConfigTree:function(a){var b=new q,c=a.search(/widgets\[[0-9]+\]/),
e=a.slice(c,a.length).indexOf("]"),c=a.slice(0,c+e+1);a=c+"_config";var c=this.configTree.findNode(c),g=this.configTree.findNode(a);a=this.appConfig.getConfigElementById(c.jsonObject.id);I.getInstance().tryLoadWidgetConfig(a).then(f.hitch(this,function(a){if(a){var c;g.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(c in a)a.hasOwnProperty(c)&&(c=g.addChild(a[c],c,g.absolutePath,g.level),this.drawTree(c,g.subLineDomNode))}b.resolve()}));return b},drawField:function(a,
k,m,n){var p,q,w,x,v,l,d,h;this.configTree.findNode(n.fieldPath);h=E.getDefaultTemplateField(n.fieldPath,n.fieldJson.type,n.fieldJson.label);for(p in n.fieldJson)n.fieldJson.hasOwnProperty(p)&&(h[p]=n.fieldJson[p]);p=e.create("div",{"class":"field-div",fieldDiv:n.fieldPath},m);this.own(u(p,"click",f.hitch(this,function(a,d){function c(){e=this.configTree.findNode(k);g=t.position(this.treePart).y;h=t.position(e.lineDomNode).y;l=h-g;(0>l||l>b.get(this.categoryPart,"height"))&&e.lineDomNode.scrollIntoView(!1);
this._changeHeighlightFieldDomNode(k);this._changeHeighlightTreeDomNode(e.lineDomNode);this._changeHeighlightCategoryHead(d.name)}var e,g,h,l,k=a.fieldPath;if(e=this.configTree.findNode(k)){for(;e;)b.set(e.subLineDomNode,"display","block"),e=e.parentNode;f.hitch(this,c)()}else this.addWidgetConfigToConfigTree(k).then(f.hitch(this,function(){for(e=this.configTree.findNode(k);e;)b.set(e.subLineDomNode,"display","block"),e=e.parentNode;f.hitch(this,c)()}))},n,a)));a=e.create("div",{"class":"field-head-div"},
p);w=e.create("div",{"class":"field-fold-div"},a);x=e.create("img",{"class":"field-fold-img",src:this.arrowImgSrc,alt:"img"},w);w=f.hitch(this,function(a){var b="",d=a.split("_"),c=f.clone(d);g.forEach(d,function(a,b){var e;e="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(a=0;a<=b;a++)e+=d[a]+"_";e=this.configTree.findNode(e.slice(0,-1));c[b]=e.label}},this);for(a=1;a<c.length;a++)b+=c[a]+"_";return b.slice(0,-1)})(n.fieldPath);e.create("div",{"class":"field-head-title-div",
innerHTML:w,title:w},a);v=e.create("div",{"class":"field-opers-div"},a);w=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);l=e.create("div",{"class":"field-oper-div jimu-float-trailing",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);v=e.create("div",{"class":"field-oper-div jimu-float-trailing",
innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'"+this.imageFolder+"moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},v);var r=e.create("div",{"class":"field-fixed-content-div",style:"display:none;"},p);q=e.create("div",{"class":"field-box-div"},r);e.create("span",{"class":"field-label-span",innerHTML:this.nls.fieldLabel},q);q=e.create("input",{"class":"jimu-input field-label-input",type:"text",value:h.label},q);this.own(u(q,"change",f.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:D.stripHTML(b.value)})},
n.fieldPath,q)));q=e.create("div",{"class":"field-box-div"},r);e.create("span",{"class":"field-type-span",innerHTML:this.nls.fieldType},q);q=(new z({name:"selectFieldType","class":"field-type-select",options:[{label:this.nls.typeSelectString,value:"string"},{label:this.nls.typeSelectBoolean,value:"boolean"},{label:this.nls.typeSelectNumber,value:"number"},{label:this.nls.typeSelectOptions,value:"options"},{label:this.nls.typeSelectColor,value:"color"}],value:h.type})).placeAt(q);d=e.create("div",
{"class":"field-content-div",style:"display:none;"},p);this.drawFieldContent(n.fieldPath,h,d,q.getValue());this.own(u(q,"change",f.hitch(this,function(a,d,c,e){this.drawFieldContent(a,d,c,e);this._onFieldChange(a,{key:"type",value:e});b.set(c,"display","block")},n.fieldPath,h,d)));this.own(u(a,"click",f.hitch(this,function(){"block"===b.get(d,"display")?(b.set(d,"display","none"),b.set(r,"display","none"),c.set(x,"src",this.arrowImgSrc)):(b.set(d,"display","block"),b.set(r,"display","block"),c.set(x,
"src",this.imageFolder+"v.png"))})));this.own(u(w,"click",f.hitch(this,function(a,d,c,g){var h=a.fieldPath,l=this.configTree.findNode(h);l?(l.setTemplateField(a.fieldJson),l.toRightDiv&&b.set(l.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(h).then(f.hitch(this,function(){var b=this.configTree.findNode(h);a.fieldJson&&b.setTemplateField(a.fieldJson)}));l=this.categoryManager.getCategoryByField(h);l.removeFieldFromDisplay(h);e.destroy(d);l.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(l),
e.destroy(c));g.stopPropagation();this._checkTemplateStatus()},n,p,k)));this.own(u(v,"click",f.hitch(this,function(a,b,d){var c=this.categoryManager.getCategoryByField(a);c.moveup(a)&&(e.empty(b),this.drawFields(c,k,b),this._changeHeighlightFieldDomNode(a));d.stopPropagation();this._checkTemplateStatus()},n.fieldPath,m)));this.own(u(l,"click",f.hitch(this,function(a,b,d){var c=this.categoryManager.getCategoryByField(a);c.movedown(a)&&(e.empty(b),this.drawFields(c,k,b),this._changeHeighlightFieldDomNode(a));
d.stopPropagation();this._checkTemplateStatus()},n.fieldPath,m)))},drawFieldContent:function(a,b,c,k){var m,n,p,q;e.empty(c);"color"!==k&&(e.create("span",{"class":"field-tooltip-span",innerHTML:this.nls.tooltip},c),m=e.create("input",{"class":"jimu-input field-tooltip-input",type:"text",value:b.tooltip},c),this.own(u(m,"change",f.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,m))),e.create("br",{},c),"string"===k?(e.create("span",{"class":"field-string-ph-span",
innerHTML:this.nls.placeholder},c),k=e.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:b.placeHolder},c),this.own(u(k,"change",f.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,k))),k=e.create("div",{"class":"field-text-type-div"},c),e.create("span",{"class":"field-text-type-span",innerHTML:this.nls.textBoxType},k),b=(new z({name:"stringOptions","class":"field-string-options",options:[{label:this.nls.textBoxTypeTextbox,value:"textbox"},
{label:this.nls.textBoxTypeTextarea,value:"textarea"},{label:this.nls.textBoxTypeRichtext,value:"richtext"}],value:b.stringFieldOption})).placeAt(k),this.own(u(b,"change",f.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOption",value:b})},a)))):"number"===k?(e.create("span",{"class":"field-num-min-span",innerHTML:this.nls.minvalue},c),n=e.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:b.constraints.min},c),e.create("br",{},c),e.create("span",
{"class":"field-num-max-span",innerHTML:this.nls.maxvalue},c),p=e.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:b.constraints.max},c),e.create("br",{},c),e.create("span",{"class":"field-num-places-span",innerHTML:this.nls.places},c),q=e.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",value:b.constraints.places},c),this.own(u(n,"change",f.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:n.value,
max:p.value,places:q.value}})},a))),this.own(u(p,"change",f.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:n.value,max:p.value,places:q.value}})},a))),this.own(u(q,"change",f.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:n.value,max:p.value,places:q.value}})},a)))):"options"===k&&(k=e.create("div",{"class":"field-options-add-div"},c),m=e.create("div",{"class":"field-options-add-content"},k),e.create("div",{"class":"field-options-add-img-div jimu-float-leading",
innerHTML:"\x3cimg src\x3d'"+this.imageFolder+"add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},m),e.create("div",{"class":"field-options-add-text-div jimu-float-leading",innerHTML:this.nls.addNewOption},m),g.forEach(b.options,function(b){this._onFieldOptionsAdd(a,c,b.label,b.value)},this),this.own(u(k,"click",f.hitch(this,this._onFieldOptionsAdd,a,c,"","")))))},_changeHeighlightFieldDomNode:function(b){w(".field-div",this.categoryPart).removeClass("field-heighlight-div");a.add(w('div[fieldDiv\x3d"'+
b+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(b){this.heighlightTreeDomNode&&a.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");a.add(b,"tree-node-heighlight-div");this.heighlightTreeDomNode=b},_changeHeighlightCategoryHead:function(a){w(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=w("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];t.addClass(a,"category-head-div-selected")},_onToRightDiv:function(a,
c,e){var f,g,k=this.categoryManager.getCategoryByField(a.absolutePath);f=this.categoryManager.findDisplayCategory(k.name);g={fieldPath:a.absolutePath,fieldJson:a.getTemplateField()};if(-1===f){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(k);k.addFieldToDisplay(g);this.drawCategory(k);f=w("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0]}else if(-1===k.findFieldFromDisplay(a.absolutePath)){if("add"!==c)return;k.addFieldToDisplay(g);c=w("div[categoryDiv\x3d'"+k.name+"']",this.categoryPart)[0];
f=w("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0];this.drawField(k,c,f,g)}else f=w("div[fieldsDiv\x3d'"+k.name+"']",this.categoryPart)[0];b.set(f,"display","block");g=w('div[fieldDiv\x3d"'+a.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(k.name);this._changeHeighlightFieldDomNode(a.absolutePath);this._changeHeighlightTreeDomNode(e);a=t.position(this.categoryPart).y;a=t.position(g).y-a;(0>a||a>b.get(this.categoryPart,"height"))&&g.scrollIntoView(!1)},_onFieldChange:function(a,
b){var c=this.configTree.findNode(a);a=this.categoryManager.getCategoryByField(a).getDisplayField(a);a.fieldJson[b.key]=b.value;c.templateField=a.fieldJson;this._checkTemplateStatus()},_onFieldOptionsAdd:function(a,b,c,g){var k=e.create("div",{"class":"field-options-div"},b),m=e.create("div",{"class":"field-box-div"},k);e.create("div",{"class":"field-options-label-div jimu-float-leading",innerHTML:this.nls.labelStr},m);m=e.create("input",{"class":"jimu-input field-options-label-input jimu-float-leading",
type:"text",value:c},m);this.own(u(m,"change",f.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)));m=e.create("div",{"class":"field-box-div"},k);e.create("div",{"class":"field-options-value-div jimu-float-leading",innerHTML:this.nls.value},m);g=e.create("input",{"class":"jimu-input field-options-value-input jimu-float-leading",type:"text",value:g},m);this.own(u(g,"change",f.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},
a)));g=e.create("div",{"class":"jimu-icon jimu-icon-delete field-options-remove-div jimu-float-leading"},m);this.own(u(g,"click",f.hitch(this,function(a){e.destroy(k);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(b)})},a)))},_getFieldOptions:function(a){var b=[];w(".field-options-div",a).forEach(f.hitch(this,function(a){b.push({label:w(".field-options-label-input",a).attr("value")[0],value:w(".field-options-value-input",a).attr("value")[0]})}));return b},_onReviewJsonDivClick:function(){var a=
this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);c.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead2);b.set(this.showJsonDiv,"display","block");b.set(this.reviewJsonDiv,"display","none");b.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){c.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);b.set(this.reviewJsonDiv,"display","block");b.set(this.reviewJsonBackDiv,"display","none");b.set(this.showJsonDiv,"display","none")},
_saveAgolTemplate:function(a){var b=new q,c=x.stringify(this.categoryManager.getTemplateJson("fullJson")),e={itemId:a?a:this.appInfo.agolTemplateInfo?this.appInfo.agolTemplateInfo.itemId:null,json:c};F.saveAgolTemplate(this.appInfo,e).then(f.hitch(this,function(){this.appInfo.agolTemplateInfo=e;this.lastTemplateJson=this.categoryManager.getTemplateJson();b.resolve()}),function(a){new K({message:a});b.reject()});return b},_onDownloadNodeClick:function(){},_updateAgolTemplate:function(){var a=new q,
b=this.hasChanged(),c=x.stringify(this.categoryManager.getTemplateJson());this.loading.show(this.nls.updating);b?this._saveAgolTemplate().then(f.hitch(this,function(){this._checkTemplateStatus();a.resolve()})):a.resolve();a.then(f.hitch(this,function(){L.getPortal(window.portalUrl).getUser().then(f.hitch(this,function(a){a.updateItem(this.appInfo.agolTemplateInfo.itemId,{text:c}).then(f.hitch(this,function(){this.loading.hide();Q._exportedMessage({itemId:this.appInfo.agolTemplateInfo.itemId,message:this.nls.exportSuccessfulUpdate},
this.nls.exportMessageTitleUpdate,this.nls)}),f.hitch(this,function(a){this.loading.hide();console.error(a.message||a);Q._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed7},this.nls.exportMessageTitleUpdate,this.nls)}))}),f.hitch(this,function(a){this.loading.hide();console.error(a.message||a);Q._exportedMessage({itemId:null,message:this.nls.exportTemplateFailed6},this.nls.exportMessageTitleUpdate,this.nls)}))}))},_exportTemplate:function(a){var b="",c=x.stringify(this.categoryManager.getTemplateJson()),
e=x.stringify(this.categoryManager.getTemplateJson("fullJson"));window.isXT?b=J.getProtocol(window.portalUrl)+"://"+window.location.host+path+"apps/"+this.appInfo.id:(b=J.getStandardPortalUrl(window.portalUrl),b="HTML3D"===window.appInfo.appType?b+"/apps/webappviewer3d/index.html?id\x3d"+this.appInfo.id:b+"/apps/webappviewer/index.html?id\x3d"+this.appInfo.id);(new G({_templateUrl:b,_temlateJson:c,_fullTemplateJson:e,nls:this.nls,_afterAddItemOfExportCallback:f.hitch(this,this._afterAddItemOfExportCallback),
appInfo:this.appInfo,appConfig:this.cleanAppConfig,isExportWABTemplate:a})).startup()},_afterAddItemOfExportCallback:function(a){this._saveAgolTemplate(a).then(f.hitch(this,function(){this._checkTemplateStatus();this.emit("exported",!0,a)}))},_checkTemplateStatus:function(){var a=this.hasChanged();this.emit("hasChanged",a)},exportOrUpdateAGOLTemplate:function(){this.appInfo.agolTemplateInfo&&this.appInfo.agolTemplateInfo.itemId?this._updateAgolTemplate():this._exportTemplate(!1)},exportWABTemplate:function(){this._exportTemplate(!0)},
saveAgolTemplate:function(){return this._saveAgolTemplate()},hasChanged:function(){return!D.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson())},getTemplateConfig:function(){return this.categoryManager.getTemplateJson()},getFullTemplateConfig:function(){return this.categoryManager.getTemplateJson("fullJson")}})})},"builder/dijit/template-config/ConfigNode":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(p,g,t){var v={},n=p([],{id:null,parentNode:null,
keyString:null,absolutePath:null,childs:null,nodeType:null,templateField:null,jsonObject:null,level:null,label:null,isVisible:!1,constructor:function(m,n,k,f,e){var b;this.parentNode=n;this.keyString=k;this.childs=[];this.absolutePath=""===f?k:f+"_"+k;this.jsonObject=m;this.level=e;this.initId();this.initLabel();this.initTemplateField(m);if("object"!==typeof m||null===m)this.nodeType="leaf";else if(g.isArrayLike(m))for(this.nodeType="array",n=0;n<m.length;n++)this.addChild(m[n],this.keyString+"["+
n+"]",f,e);else for(b in this.nodeType="normal",m)m.hasOwnProperty(b)&&"function"!==typeof m[b]&&this.addChild(m[b],b,this.absolutePath,e)},initId:function(){var m,n;m=this.absolutePath.search(/_widgets\[[0-9]+\]/);n=this.absolutePath.search(/_groups\[[0-9]+\]/);-1!==m||-1!==n?-1!==this.absolutePath.search(/_widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/_groups\[[0-9]+\]$/)?this.id=this.parentNode.id+"["+this.jsonObject.id+"]":g.isArrayLike(this.parentNode.jsonObject)?this.id=this.parentNode.parentNode.id+
"_"+this.keyString:this.id=this.parentNode.id+"_"+this.keyString:this.id=this.absolutePath},initLabel:function(){this.label=this.keyString;if(-1!==this.absolutePath.search(/widgets\[[0-9]+\]$/)||-1!==this.absolutePath.search(/groups\[[0-9]+\]$/))this.label=this.jsonObject.label},initTemplateField:function(g){this.templateField=n.getDefaultTemplateField(this.absolutePath,typeof g,this.label);n.setDefaultValue(this.absolutePath,g,this.id)},getTemplateFieldDefaultValue:function(){return this.templateField.defaultValue},
getTemplateField:function(g){g=g?g:this.templateField;var m={type:g.type,fieldName:this.id,label:g.label,tooltip:g.tooltip};"leaf"!==this.nodeType&&(m.fieldName+="--");switch(m.type){case "string":m.stringFieldOption=g.stringFieldOption;m.placeHolder=g.placeHolder;break;case "number":m.constraints=g.constraints||{min:0,max:100,places:0};break;case "options":m.options=g.options||[{label:"label1",value:"value1"}]}return m},setTemplateField:function(g){this.templateField.type=g.type;this.templateField.label=
g.label;this.templateField.tooltip=g.tooltip;"leaf"!==this.nodeType&&(this.templateField.fieldName=this.templateField.fieldName.slice(0,this.templateField.fieldName.length-2));switch(this.templateField.type){case "string":this.templateField.stringFieldOption=g.stringFieldOption;this.templateField.placeHolder=g.placeHolder;break;case "number":this.templateField.constraints=g.constraints;break;case "options":this.templateField.options=g.options}return g},addChild:function(g,p,k,f){g=new n(g,this,p,
k,f+1);this.childs.push(g);return g},isLeaf:function(){var g=!1;this.childs&&0<this.childs.length&&(g=!0);return g},findNode:function(g){var m=[],k,f,e;g.split("_").forEach(function(b){var a=b.search(/\[[0-9]+\]/);-1!==a&&m.push(b.slice(0,a));m.push(b)});f=this;if(f.keyString!==m[0])return null;for(g=1;g<m.length;g++){e=f.childs.length;for(k=0;k<e;k++)if(f.childs[k].keyString===m[g]){f=f.childs[k];break}if(k===e)return null}return f},setVisible:function(){for(var g=this;g;)g.isVisible=!0,g=g.parentNode},
findNodeById:function(g){var m=null;this.traversal(function(k){if(k.id===g)return m=k,!0});return m},traversal:function(g){if(g(this))return!0;for(var m=0;m<this.childs.length;m++)if(this.childs[m].traversal(g))return!0},deserialize:function(g){g&&t.forEach(g.configurationSettings,function(g){t.forEach(g.fields,function(g){this.findNode(g.fieldName).setTemplateField(g)},this)},this)}});n.getDefaultValue=function(g){return v[g]};n.setDefaultValue=function(g,n,k){var f=null,f=n;"app_portalUrl"===g||
"app_map_itemId"===g?f=null:"app_title"===g?f="":"app_subtitle"===g?f="":"object"===typeof n&&(f=!1);v[k]=f};n.defaultValueExisted=function(g){return void 0===v[g]?!1:!0};n.getDefaultTemplateField=function(g,n,k){g="string";switch(n){case "number":g="number";break;case "boolean":g="boolean";break;case "object":g="boolean",k="disable"}return{type:g,label:k,tooltip:"",stringFieldOption:"textbox",placeHolder:k,constraints:{min:0,max:100,places:0},options:[{label:"label1",value:"value1"}]}};return n})},
"builder/dijit/template-config/CategoryManager":function(){define(["dojo/_base/declare","dojo/_base/array","./ConfigNode","./Category"],function(p,g,t,v){return p([],{categorys:null,displayCategorys:null,constructor:function(g,m,p){this.configTree=g;this.categorys=[];this.displayCategorys=[];this.initCategorys(m,g);this.deserialize(p,g)},initCategorys:function(n,m){var p=new v(m,"Attribute","Attribute",["app_title","app_subtitle","app_logo","app_links"],[],["app_title","app_subtitle"]);this.categorys.push(p);
g.forEach(n.widgetOnScreen.widgets,function(g,f){var e="ScreenWidget_"+g.id;f="app_widgetOnScreen_widgets["+f+"]";f=[f+"_label",f+"_visible",f+"_config",f+"_openAtStart"];var b=[];g.uri&&this.categorys.push(new v(m,e,g.label+" widget",f,b))},this);g.forEach(n.widgetOnScreen.groups,function(k,f){var e="ScreenWidgetGroup_"+k.id,b="app_widgetOnScreen_groups["+f+"]",a=[b+"_label",b+"_visible",b+"_openAtStart"];g.forEach(k.widgets,function(c,e){a.push(b+"_widgets["+e+"]_label");a.push(b+"_widgets["+e+
"]_visible");a.push(b+"_widgets["+e+"]_openAtStart");a.push(b+"_widgets["+e+"]_config")});this.categorys.push(new v(m,e,k.label,a,[]))},this);g.forEach(n.widgetPool.widgets,function(g,f){var e="widgetPoolWidget_"+g.id;f="app_widgetPool_widgets["+f+"]";f=[f+"_label",f+"_visible",f+"_config",f+"_openAtStart"];var b=[];g.uri&&this.categorys.push(new v(m,e,g.label+" widget",f,b))},this);g.forEach(n.widgetPool.groups,function(k,f){var e="widgetPoolGroup_"+k.id,b="app_widgetPool_groups["+f+"]",a=[b+"_label",
b+"_visible",b+"_openAtStart"];g.forEach(k.widgets,function(c,e){a.push(b+"_widgets["+e+"]_label");a.push(b+"_widgets["+e+"]_visible");a.push(b+"_widgets["+e+"]_openAtStart");a.push(b+"_widgets["+e+"]_config")});this.categorys.push(new v(m,e,k.label,a,[]))},this);this.displayCategorys.push(p)},getCategoryByName:function(g){return this.categorys[this.findCategory(g)]},getCategoryByField:function(g){var m;for(m=0;m<this.categorys.length;m++)if(this.categorys[m].hasField(g))return this.categorys[m];
return null},findCategory:function(g){return this._find(g,this.categorys)},findDisplayCategory:function(g){return this._find(g,this.displayCategorys)},_find:function(g,m){var n;for(n=0;n<m.length&&m[n].name!==g;n++);return n===m.length?-1:n},addCategoryToDisplay:function(g){-1===this.findDisplayCategory(g.name)&&this.displayCategorys.push(g)},removeCategoryFromDisplay:function(g){g=this.findDisplayCategory(g.name);0<=g&&this.displayCategorys.splice(g,1)},moveup:function(g){var m;g=this.findDisplayCategory(g.name);
return 0<g?(m=this.displayCategorys[g],this.displayCategorys[g]=this.displayCategorys[g-1],this.displayCategorys[g-1]=m,!0):!1},movedown:function(g){var m;g=this.findDisplayCategory(g.name);return 0<=g&&g<this.displayCategorys.length-1?(m=this.displayCategorys[g],this.displayCategorys[g]=this.displayCategorys[g+1],this.displayCategorys[g+1]=m,!0):!1},getTemplateJson:function(n){var m={configurationSettings:[],values:{}};g.forEach(this.displayCategorys,function(p,k){var f={category:p.title,fields:[]};
"fullJson"===n&&(f.categoryName=p.name);g.forEach(p.displayFields,function(e,b){var a=this.configTree.findNode(e.fieldPath).getTemplateField(e.fieldJson);f.fields[b]=a;m.values[a.fieldName]=t.getDefaultValue(e.fieldJson.fieldName)},this);m.configurationSettings[k]=f},this);return m},deserialize:function(n,m){if(n){g.forEach(this.displayCategorys,function(g){g.displayFields=[]});this.displayCategorys=[];g.forEach(n.configurationSettings,function(g){var f=this.getCategoryByName(g.categoryName),e=0;
f&&(e=f.deserialize(g.fields,m),0<e&&this.displayCategorys.push(f))},this);var p;n=n.values;for(p in n)n.hasOwnProperty(p)&&"function"!==typeof n[p]&&!t.defaultValueExisted(p)&&t.setDefaultValue(null,n[p],p)}}})})},"builder/dijit/template-config/Category":function(){define(["dojo/_base/declare","dojo/_base/array"],function(p,g){return p([],{name:null,title:null,includeFields:null,excludeFields:null,displayFields:null,constructor:function(p,v,n,m,u,k){this.name=v;this.title=n;this.includeFields=m;
this.excludeFields=u;this.displayFields=[];g.forEach(k,function(f){var e=p.findNode(f);e&&this.displayFields.push({fieldPath:f,fieldJson:e.getTemplateField()})},this)},hasField:function(g){var p=!1,n;for(n=0;n<this.includeFields.length;n++)if(0===g.indexOf(this.includeFields[n])){p=!0;break}for(n=0;n<this.excludeFields.length;n++)if(0===g.indexOf(this.excludeFields[n])){p=!1;break}return p},getDisplayField:function(g){g=this.findFieldFromDisplay(g);return-1!==g?this.displayFields[g]:null},findFieldFromDisplay:function(g){var p;
for(p=0;p<this.displayFields.length;p++)if(this.displayFields[p].fieldPath===g)return p;return-1},addFieldToDisplay:function(g){var p;p=this.findFieldFromDisplay(g.fieldPath);-1===p?this.displayFields.push({fieldPath:g.fieldPath,fieldJson:g.fieldJson}):this.displayFields[p].fieldJson=g.fieldJson},removeFieldFromDisplay:function(g){var p;p=this.findFieldFromDisplay(g);0<=p&&this.displayFields.splice(p,1);return g},moveup:function(g){var p;g=this.findFieldFromDisplay(g);return 0<g?(p=this.displayFields[g],
this.displayFields[g]=this.displayFields[g-1],this.displayFields[g-1]=p,!0):!1},movedown:function(g){var p;g=this.findFieldFromDisplay(g);return 0<=g&&g<this.displayFields.length-1?(p=this.displayFields[g],this.displayFields[g]=this.displayFields[g+1],this.displayFields[g+1]=p,!0):!1},displayIsEmpty:function(){return 0===this.displayFields.length},deserialize:function(p,v){this.displayFields=[];g.forEach(p,function(g){var m;m=g.fieldName.replace(/\//g,"_");(m=v.findNodeById(m))&&this.displayFields.push({fieldPath:m.absolutePath,
fieldJson:g})},this);return this.displayFields.length}})})},"builder/dijit/template-config/Export":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/dijit dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/Export.html dojo/Deferred dojo/promise/all dojo/dom-style dojo/dom-attr dojo/json jimu/utils jimu/dijit/Message jimu/dijit/LoadingShelter builder/portalUtils ./ExportMessage jimu/dijit/Popup builder/dijit/ItemInfo builder/serviceUtils builder/PluginManager".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){return p([n,m],{templateString:u,baseClass:"export-agoltemplate",_templateUrl:null,_temlateJson:null,_fullTemplateJson:null,pluginManager:null,_afterAddItemOfExportCallback:null,isExportWABTemplate:null,appInfo:null,constructor:function(){this.pluginManager=G.getInstance()},startup:function(){this.isExportWABTemplate?this.popupWABTemplateDlg():this.popupAGOLTemplateDlg()},popupAGOLTemplateDlg:function(a){this.isExportWABTemplate=!1;this._initToAGOLTemplateDlgPage();
this.popup=new z({content:this,container:"main-page",titleLabel:this.nls.title2,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:g.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,this._onCancelClick)}]});this.loading=new w({hidden:!0});this.loading.placeAt(this.popup.domNode)},popupWABTemplateDlg:function(){this.isExportWABTemplate=!0;this._initToWABTemplateDlgPage();this.popup=new z({content:this,container:"main-page",titleLabel:this.nls.exportPopupTitleForWab,
width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:g.hitch(this,this._onNextClick)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,this._onCancelClick)}]});this.loading=new w({hidden:!0});this.loading.placeAt(this.popup.domNode)},_initToAGOLTemplateDlgPage:function(){window.isXT&&(b.set(this.explain1,"innerHTML",this.nls.explain1),e.set(this.explain1,"display","block"));this.itemInfoDijit=new E({itemInfo:this.getDefaultAppInfo()});this.itemInfoDijit.placeAt(this.itemInfoBox)},
_initToWABTemplateDlgPage:function(){var a=this.getDefaultAppInfo();window.isXT&&(b.set(this.templateTitle,"innerHTML",this.nls.templateTitleForWAB),a.tags=void 0,a.folderId=void 0,a.sharing=void 0,a.thumbnail="/webappbuilder/builder/images/templatethumbnail.jpg");this.itemInfoDijit=new E({itemInfo:a});this.itemInfoDijit.placeAt(this.itemInfoBox)},getDefaultAppInfo:function(){return{name:"",description:this.nls.templateDefaultSnippet,tags:["template"],folderId:"",sharing:void 0,thumbnail:void 0}},
_onNextClick:function(){this.isExportWABTemplate?this._exportWABTemplate():this._exportAGOLTemplate()},_onCancelClick:function(){this.close()},close:function(){this.popup.close()},_exportAGOLTemplate:function(){var a=this.itemInfoDijit.getProperties();a.name&&a.tags?(this.loading.show(),this.exportAGOLTemplate(a,this._templateUrl,this._fullTemplateJson,this._afterAddItemOfExportCallback).then(g.hitch(this,function(a){this.close();this.loading.hide();C._exportedMessage(a,this.nls.exportMessageTitle,
this.nls)}),g.hitch(this,function(a){this.close();this.loading.hide();C._exportedMessage(a,this.nls.exportMessageTitle,this.nls)}))):new x({message:this.nls.noTitleMessage})},_exportWABTemplate:function(){var b=this.itemInfoDijit.getProperties();if(b.name){this.loading.show();var c=this.pluginManager.getPluginByName("app-list");this.exportWABTemplate(b,a.parse(this._fullTemplateJson),this._afterAddItemOfExportCallback).then(g.hitch(this,function(){this.close();this.loading.hide();c&&(c._onSwitchToTemplateContent(),
c.refreshTemplatePage());new z({content:this.nls.exportSuccessfulForWab,titleLabel:this.nls.exportPopupTitleForWab,width:"600",autoHeight:!0,buttons:[{label:this.nls.ok}]})}),g.hitch(this,function(){this.close();this.loading.hide()}))}else new x({message:this.nls.noTitleMessage})},exportAGOLTemplate:function(a,b,c,e){var m=new k,n=new k,p=new k,w=new k,x=q.getPortal(window.portalUrl),u=window.appConfig.map.itemId;x.getUser().then(g.hitch(this,function(b){var c={q:"owner:"+b.username+" title:"+a.name+
' type:"Web Mapping Application"'},e=builderNls.titleExist.replace("${TITLE}",a.name);x.queryItems(c).then(g.hitch(this,function(a){0<a.total?(n.reject(),m.reject({itemId:null,message:e})):n.resolve(b)}),g.hitch(this,function(a){n.reject(a);console.error(a.message||a);m.reject({itemId:null,message:this.nls.exportTemplateFailed5})}))}),g.hitch(this,function(a){n.reject(a);console.error(a.message||a);m.reject({itemId:null,message:this.nls.exportTemplateFailed5})}));n.then(g.hitch(this,function(f){var k=
{title:a.name,snippet:a.description,tags:a.tags,url:b,type:"Web Mapping Application",typeKeywords:"Configurable, JavaScript, selfConfigured",text:c},n="";"HTML"===window.appInfo.appType?n="WAB2D":"HTML3D"===window.appInfo.appType&&(n="WAB3D, 3Dscene");k.typeKeywords=(window.isXT?"Configurable, JavaScript, WABTemplate, WABTemplateFromXT, ":"Configurable, JavaScript, selfConfigured, WABTemplate, WABTemplateFromAGOL, ")+n;a.folderId===f.username&&(a.folderId="");f.addItem(k,a.folderId).then(g.hitch(this,
function(a){a.success?(p.resolve(a),e(a.id),B.updateAppItemThumbnail(a.id,u)):(console.error(a.message||""),p.reject(this.nls.exportTemplateFailed1))}),g.hitch(this,function(a){p.reject(a);console.error(a.message||a);m.reject({itemId:null,message:this.nls.exportTemplateFailed1})}))}));q.getTemplatesGroup(window.portalUrl).then(g.hitch(this,function(a){w.resolve(a)}),g.hitch(this,function(a){w.reject(a);console.error(a.message||a);m.reject({itemId:null,message:this.nls.exportTemplateFailed2})}));f({user:n,
itemRes:p,templateGroup:w}).then(g.hitch(this,function(b){b.user.shareItem({groups:b.templateGroup.id},b.itemRes.id,a.folderId).then(g.hitch(this,function(a){-1===a.notSharedWith.indexOf(b.templateGroup.id)?m.resolve({itemId:b.itemRes.id,message:this.nls.exportSuccessful}):m.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed3,type:"no_permission_to_share"})}),g.hitch(this,function(a){console.error(a.message||a);m.reject({itemId:b.itemRes.id,message:this.nls.exportTemplateFailed4})}))}));
return m},exportWABTemplate:function(a,b,c){var e=new k;a={name:a.name,description:a.description,fromAppId:this.appInfo.id,saveAsTemplate:!0,thumbnail:a.thumbnail};var f=g.clone(window.appConfig);f.templateConfig=b;delete f.isTemplateApp;B.saveAs(a,f.getCleanConfig()).then(g.hitch(this,function(a){a.success?(e.resolve(),c()):(console.error("exportWABTemplate failed: duplicateApp response's success is false"),new x({message:"Exported as web app template failed."}),e.reject())}),g.hitch(this,function(a){console.error("exportWABTemplate failed: duplicateApp error: "+
a);new x({message:"Exported as web app template failed"});e.reject()}));return e}})})},"dijit/dijit":function(){define("./main ./_base dojo/parser ./_Widget ./_TemplatedMixin ./_Container ./layout/_LayoutWidget ./form/_FormWidget ./form/_FormValueWidget".split(" "),function(p){return p})},"dijit/_base":function(){define("./main ./a11y ./WidgetSet ./_base/focus ./_base/manager ./_base/place ./_base/popup ./_base/scroll ./_base/sniff ./_base/typematic ./_base/wai ./_base/window".split(" "),function(p){return p._base})},
"dijit/WidgetSet":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","./registry"],function(p,g,t,v){var n=g("dijit.WidgetSet",null,{constructor:function(){this._hash={};this.length=0},add:function(g){if(this._hash[g.id])throw Error("Tried to register widget with id\x3d\x3d"+g.id+" but that id is already registered");this._hash[g.id]=g;this.length++},remove:function(g){this._hash[g]&&(delete this._hash[g],this.length--)},forEach:function(g,n){n=n||t.global;var k=0,f;for(f in this._hash)g.call(n,
this._hash[f],k++,this._hash);return this},filter:function(g,p){p=p||t.global;var k=new n,f=0,e;for(e in this._hash){var b=this._hash[e];g.call(p,b,f++,this._hash)&&k.add(b)}return k},byId:function(g){return this._hash[g]},byClass:function(g){var m=new n,k,f;for(k in this._hash)f=this._hash[k],f.declaredClass==g&&m.add(f);return m},toArray:function(){var g=[],n;for(n in this._hash)g.push(this._hash[n]);return g},map:function(g,n){return p.map(this.toArray(),g,n)},every:function(g,n){n=n||t.global;
var k=0,f;for(f in this._hash)if(!g.call(n,this._hash[f],k++,this._hash))return!1;return!0},some:function(g,n){n=n||t.global;var k=0,f;for(f in this._hash)if(g.call(n,this._hash[f],k++,this._hash))return!0;return!1}});p.forEach("forEach filter byClass map every some".split(" "),function(g){v[g]=n.prototype[g]});return n})},"dijit/_base/focus":function(){define("dojo/_base/array dojo/dom dojo/_base/lang dojo/topic dojo/_base/window ../focus ../selection ../main".split(" "),function(p,g,t,v,n,m,u,k){m.focus=
function(f){if(f){var e="node"in f?f.node:f,b=f.bookmark;f=f.openedForWindow;var a=b?b.isCollapsed:!1;if(e){var c="iframe"==e.tagName.toLowerCase()?e.contentWindow:e;if(c&&c.focus)try{c.focus()}catch(x){}m._onFocusNode(e)}if(b&&n.withGlobal(f||n.global,k.isCollapsed)&&!a){f&&f.focus();try{n.withGlobal(f||n.global,k.moveToBookmark,null,[b])}catch(x){}}}};m.watch("curNode",function(f,e,b){k._curFocus=b;k._prevFocus=e;b&&v.publish("focusNode",b)});m.watch("activeStack",function(f,e,b){k._activeStack=
b});m.on("widget-blur",function(f,e){v.publish("widgetBlur",f,e)});m.on("widget-focus",function(f,e){v.publish("widgetFocus",f,e)});t.mixin(k,{_curFocus:null,_prevFocus:null,isCollapsed:function(){return k.getBookmark().isCollapsed},getBookmark:function(){return(n.global==window?u:new u.SelectionManager(n.global)).getBookmark()},moveToBookmark:function(f){return(n.global==window?u:new u.SelectionManager(n.global)).moveToBookmark(f)},getFocus:function(f,e){f=!m.curNode||f&&g.isDescendant(m.curNode,
f.domNode)?k._prevFocus:m.curNode;return{node:f,bookmark:f&&f==m.curNode&&n.withGlobal(e||n.global,k.getBookmark),openedForWindow:e}},_activeStack:[],registerIframe:function(f){return m.registerIframe(f)},unregisterIframe:function(f){f&&f.remove()},registerWin:function(f,e){return m.registerWin(f,e)},unregisterWin:function(f){f&&f.remove()}});return k})},"dijit/_base/place":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/window","../place","../main"],function(p,g,t,v,n){var m={getViewport:function(){return t.getBox()}};
m.placeOnScreen=v.at;m.placeOnScreenAroundElement=function(m,k,f,e){var b;if(g.isArray(f))b=f;else{b=[];for(var a in f)b.push({aroundCorner:a,corner:f[a]})}return v.around(m,k,b,!0,e)};m.placeOnScreenAroundNode=m.placeOnScreenAroundElement;m.placeOnScreenAroundRectangle=m.placeOnScreenAroundElement;m.getPopupAroundAlignment=function(g,k){var f={};p.forEach(g,function(e){var b=k;switch(e){case "after":f[k?"BR":"BL"]=k?"BL":"BR";break;case "before":f[k?"BL":"BR"]=k?"BR":"BL";break;case "below-alt":b=
!b;case "below":f[b?"BL":"BR"]=b?"TL":"TR";f[b?"BR":"BL"]=b?"TR":"TL";break;case "above-alt":b=!b;default:f[b?"TL":"TR"]=b?"BL":"BR",f[b?"TR":"TL"]=b?"BR":"BL"}});return f};g.mixin(n,m);return n})},"dijit/_base/popup":function(){define(["dojo/dom-class","dojo/_base/window","../popup","../BackgroundIframe"],function(p,g,t){var v=t._createWrapper;t._createWrapper=function(m){m.declaredClass||(m={_popupWrapper:m.parentNode&&p.contains(m.parentNode,"dijitPopup")?m.parentNode:null,domNode:m,destroy:function(){},
ownerDocument:m.ownerDocument,ownerDocumentBody:g.body(m.ownerDocument)});return v.call(this,m)};var n=t.open;t.open=function(g){if(g.orient&&"string"!=typeof g.orient&&!("length"in g.orient)){var m=[],k;for(k in g.orient)m.push({aroundCorner:k,corner:g.orient[k]});g.orient=m}return n.call(this,g)};return t})},"dijit/_base/scroll":function(){define(["dojo/window","../main"],function(p,g){g.scrollIntoView=function(g,v){p.scrollIntoView(g,v)}})},"dijit/_base/sniff":function(){define(["dojo/uacss"],
function(){})},"dijit/_base/typematic":function(){define(["../typematic"],function(){})},"dijit/_base/wai":function(){define(["dojo/dom-attr","dojo/_base/lang","../main","../hccss"],function(p,g,t){g.mixin(t,{hasWaiRole:function(g,n){g=this.getWaiRole(g);return n?-1<g.indexOf(n):0<g.length},getWaiRole:function(t){return g.trim((p.get(t,"role")||"").replace("wairole:",""))},setWaiRole:function(g,n){p.set(g,"role",n)},removeWaiRole:function(t,n){var m=p.get(t,"role");m&&(n?(n=g.trim((" "+m+" ").replace(" "+
n+" "," ")),p.set(t,"role",n)):t.removeAttribute("role"))},hasWaiState:function(g,n){return g.hasAttribute?g.hasAttribute("aria-"+n):!!g.getAttribute("aria-"+n)},getWaiState:function(g,n){return g.getAttribute("aria-"+n)||""},setWaiState:function(g,n,m){g.setAttribute("aria-"+n,m)},removeWaiState:function(g,n){g.removeAttribute("aria-"+n)}});return t})},"dijit/_base/window":function(){define(["dojo/window","../main"],function(p,g){g.getDocumentWindow=function(g){return p.get(g)}})},"builder/dijit/template-config/ExportMessage":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/ExportMessage.html jimu/portalUrlUtils jimu/dijit/Popup".split(" "),
function(p,g,t,v,n,m,u){var k=p([t,v],{baseClass:"agol-template-export-message",templateString:n,constructor:function(){},postCreate:function(){this.inherited(arguments);"no_permission_to_share"===this.exportedInfo.type?(g.setAttr(this.word1,"innerHTML",this.nls.exportTemplateFailed31),this.exportedInfo.itemUrl&&(g.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl21),g.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl)),g.setAttr(this.word2,"innerHTML",this.nls.exportTemplateFailed32)):
(this.exportedInfo.message&&g.setAttr(this.resMessage,"innerHTML",this.exportedInfo.message),this.exportedInfo.itemUrl&&(g.setAttr(this.word1,"innerHTML",this.nls.descriptionTemplateUrl1),g.setAttr(this.itemLink,"innerHTML",this.nls.descriptionTemplateUrl2),g.setAttr(this.itemLink,"href",this.exportedInfo.itemUrl),g.setAttr(this.word2,"innerHTML",this.nls.descriptionTemplateUrl3)))}});k._exportedMessage=function(f,e,b){f.itemId&&(f.itemUrl=m.getItemDetailsPageUrl(window.portalUrl,f.itemId));f=new k({exportedInfo:f,
nls:b});new u({content:f,titleLabel:e,width:"600",autoHeight:!0,buttons:[{label:b.ok}]})};return k})},"builder/dijit/ItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/ItemInfo.html dojo/dom-style dojo/_base/lang dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){return p([n,m,u],{templateString:f,baseClass:"dijit-item-info",postMixInProperties:function(){this.inherited(arguments);this.nls=b.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.tags.nls=this.nls;this._init(this.itemInfo)},_init:function(f){this.appName.focus();void 0===f.tags&&e.set(this.tagsTr,"display","none");void 0===f.folderId&&e.set(this.folderTr,"display","none");void 0===f.sharing&&e.set(this.sharingTr,"display",
"none");void 0===f.thumbnail&&e.set(this.thumbnailTr,"display","none");void 0!==f.tags||void 0!==f.folder?c.getPortal(x.getStandardPortalUrl(window.portalUrl)).getUser().then(b.hitch(this,function(c){var e=[];this.user=c;if(void 0!==f.folderId)e.push(this._initFolder(c));else{var g=new v;g.resolve();e.push(g)}void 0!==f.tags?e.push(k.byId("publish-webmap-tags").loadTags(c)):(c=new v,c.resolve(),e.push(c));a(e).then(b.hitch(this,function(){this.setProperties(f)}),b.hitch(this,function(a){this.setProperties(f);
console.error(a.message||a)}))}),b.hitch(this,function(a){this.setProperties(f);console.error(a.message||a)})):(void 0!==f.thumbnail&&(this.imageChooser=new z({cropImage:!0,showSelfImg:!0,format:[z.GIF,z.JPEG,z.PNG],goldenWidth:300,goldenHeight:200}),t.place(this.imageChooser.domNode,this.imageChooserBase)),this.setProperties(f))},_initFolder:function(a){var c=new v;a.getContent().then(b.hitch(this,function(e){var f=[{label:a.username,value:""}],f=f.concat(g.map(e.folders,b.hitch(this,function(a){return{label:a.title,
value:a.id}})));k.byId("publish-webmap-folder").set("options",f);k.byId("publish-webmap-folder").set("value","");c.resolve()}),function(a){console.error("get userContent error!",a.message);c.reject()});return c},setProperties:function(a){k.byId("publish-webmap-name").set("value",a.name);k.byId("publish-webmap-tags").set("tags",a.tags||[]);k.byId("publish-webmap-summary").set("value",a.description);k.byId("publish-webmap-folder").set("value",a.folderId);k.byId("publish-webmap-sharing").set("checked",
a.sharing);this.imageChooser&&this.imageChooser.setDefaultSelfSrc(a.thumbnail)},getProperties:function(){return{name:w.stripHTML(k.byId("publish-webmap-name").get("value")),tags:k.byId("publish-webmap-tags").get("tags"),description:w.stripHTML(k.byId("publish-webmap-summary").get("value")),folderId:k.byId("publish-webmap-folder").get("value"),sharing:k.byId("publish-webmap-sharing").get("checked"),thumbnail:this.imageChooser&&this.imageChooser.imageData}}})})},"builder/dijit/Tags":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/dom-construct dojo/store/Memory dojo/Deferred dojo/sniff dijit/_TemplatedMixin dijit/_WidgetBase dijit/form/TextBox ./AutoComplete dojo/text!./templates/Tags.html dojo/domReady!".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return t([f,k],{templateString:a,baseClass:"esriAGOTags",_minWidth:"100%",_maxWidth:"100%",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._isIE8=u("ie")},startup:function(){this.inherited(arguments)},loadTags:function(a){var b=new m;this._isIE8?(this._textTags||(this.tagsId="userTags-"+(new Date).getTime(),v.create("div",{id:this.tagsId},this.domNode),this._textTags=new e({placeHolder:this.nls.addTags,
trim:!0,style:{minWidth:this._minWidth,maxWidth:this._maxWidth}},this.tagsId)),b.resolve()):a?a.getTags().then(g.hitch(this,function(a){this._handleTags(a);b.resolve()}),g.hitch(this,function(a){console.error("get user tags error: "+a);this._handleTags({tags:[]});b.resolve()})):(this._handleTags({tags:[]}),b.resolve());return b},_handleTags:function(a){if(a){this._autoComplete&&this._autoComplete.clearTags();var c=[];a.tags&&p.forEach(a.tags,g.hitch(this,function(a){c.push(a)}));this._tagStore?(this._tagStore.query({}).forEach(g.hitch(this,
function(a){this._tagStore.remove(a.tag)})),p.forEach(c,g.hitch(this,function(a){this._tagStore.add(a)}))):this._tagStore=new n({idProperty:"tag",data:c});this._autoComplete||(a=(new Date).getTime(),this.tagsId="userTags-"+a,this.gridId="grid-"+a,this.filterId="filter-"+a,v.create("div",{id:this.tagsId,className:"grid_1"},this.domNode),this._autoComplete=new b({placeholder:this.nls.addTags,noDataMsg:this.nls.noTagsFound,idProperty:"tag",gridId:this.gridId,filterId:this.filterId,minWidth:this._minWidth,
maxWidth:this._maxWidth,matchParam:"first",store:this._tagStore,style:{width:this._minWidth}},this.tagsId))}},_getUniqueTags:function(a){return p.filter(a,g.hitch(this,function(b,c){return p.indexOf(a,b)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},_setTagsAttr:function(a){!a||a instanceof Array||(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):this._autoComplete&&(this._autoComplete.clearTags(),
this._autoComplete.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this._autoComplete&&this._autoComplete.values?this._autoComplete.values.join(","):""},_setMinWidthAttr:function(a){this._minWidth=a},_setMaxWidthAttr:function(a){this._maxWidth=a}})})},"builder/dijit/AutoComplete":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/_base/window dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/html dojo/json dojo/keys dojo/on dojo/query dojo/request dojo/string dijit/focus dijit/form/TextBox dijit/registry dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard dojo/NodeList-traverse dojo/NodeList-manipulate".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K){return g([F,B,G],{_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",
SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",constructor:function(a,b){this._attachmentNode=b;this._idProperty=a.idProperty;this._gridId=a.gridId;this._filterId=a.filterId;this._store=a.store;this._placeHolder=a.placeholder;this._noDataMsg=a.noDataMsg;this._maxWidth=a.maxWidth;this._minWidth=a.minWidth;this._matchParam=a.matchParam;this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},buildRendering:function(){this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=t.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>b.length)return!0;if(!a.tag)return!1;
a=(a.tag+"").toLowerCase().match(new RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),b=t.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:a.tag?~(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1:!1}),c=[{field:this._idProperty}],e=[{attribute:this._idProperty,ascending:!0}];this._grid=new (g([D,I,K]))({store:this._store,showHeader:!1,noDataMessage:this._noDataMsg,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,
columns:c,sort:e,renderRow:this._renderItem},this._gridId);u.add(this._gridId,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:b},postCreate:function(){var a;this._inputTextBox.watch("value",t.hitch(this,function(b,c,e){a&&(clearTimeout(a),a=null);this._grid.refresh()}));this._grid.on(".dgrid-row:click",t.hitch(this,function(a){var b="";this._shiftKeyPressed||this._metaKeyPressed?a.shiftKey||a.metaKey||a.ctrlKey||(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),
this._resetInputTextBox()):(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())}));this._grid.on("dgrid-deselect",t.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this._grid.on("dgrid-select",t.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._selRows.push(b)}));this.connect(this.domNode,"keydown","_keydownHandler");window.onkeydown=t.hitch(this,function(a){if(a.shiftKey||
a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.connect(document,"onkeydown",t.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0}))},_keydownHandler:function(b){var c;void 0!==C.curNode.value&&(c=C.curNode.value.length);var e=x(this._CHOICE_FOCUS,n.byId(this.id)),g=x(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,n.byId(this.id)).last();switch(b.keyCode){case a.RIGHT_ARROW:this._navigate(e,c,g,"right");this._hideGrid();break;case a.LEFT_ARROW:this._navigate(e,
c,g,"left");this._hideGrid();break;case a.DOWN_ARROW:b.preventDefault();this._unhighlightTag(e);"none"===f.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,0)),this._gridHasFocus=!0);break;case a.UP_ARROW:break;case a.BACKSPACE:var m;if(0===c&&0===x(this._CHOICE_FOCUS_ALL).length&&void 0!==x(this._CHOICE_ALL_SELECTOR)[x(this._CHOICE_ALL_SELECTOR).length-1]&&(m=x(this._CHOICE_ALL_SELECTOR)[x(this._CHOICE_ALL_SELECTOR).length-1].title,
0<x("li",this._attachmentNode).length&&(k.destroy(g[0]),void 0!==m)))try{this._store.add({tag:m})}catch(O){}if(0<x(this._CHOICE_FOCUS_ALL).length&&(m=x(this._CHOICE_FOCUS_ALL).text(),k.destroy(e[0]),void 0!==m))try{this._store.add({tag:m})}catch(O){}this._grid.refresh();0===c&&this._hideGrid();this._removeTag(m);break;case a.CTRL:this._metaKeyPressed=!0;break;case a.META:this._metaKeyPressed=!0;break;case a.SHIFT:this._shiftKeyPressed=!0;break;case a.ENTER:if(0<c){c=C.curNode.value;c=c.split(",");
var w=[];p.forEach(c,function(a,b){-1===p.indexOf(w,a)&&w.push(q.trim(a))});p.forEach(w,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}))}else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();b.preventDefault();C.focus(n.byId(this._filterId));break;case a.TAB:if(C.curNode.id!==this._filterId||0!==c){if(0<c)c=C.curNode.value,
c=c.split(","),w=[],p.forEach(c,function(a,b){-1===p.indexOf(w,a)&&w.push(q.trim(a))}),p.forEach(w,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(c=0;c<this._selRows.length;c++)this._createTags(this._selRows[c]),this._store.remove(this._selRows[c]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();b.preventDefault();C.focus(n.byId(this._filterId))}break;case a.ESCAPE:this._hideGrid();break;default:-1<c&&("none"===f.get(n.byId(this._gridId),
"display")&&this._showGrid(),this._unhighlightTag(e)),this._metaKeyPressed=!1}},_blurHandler:function(a,b,c){if(!this.focused){if(0<this._inputTextBox.value.length){var e=[];a=this._inputTextBox.value.split(",");p.forEach(a,function(a,b){-1===p.indexOf(e,a)&&e.push(q.trim(a))});p.forEach(e,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}},_resetInputTextBox:function(){E.byId(this._filterId).set("value","")},
_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,e){0<a.length&&1>b?("right"===e?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=p.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==p.indexOf(this.values,
a)&&this.values.splice(p.indexOf(this.values,a),1)},_hideGrid:function(){n.byId(this._gridId)&&f.set(n.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){f.set(n.byId(this._gridId),"display","block");var a=f.get(n.byId(this._attachmentNode),"width");f.set(n.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return x(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||x(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(a){x(this._CHOICE_FOCUS,
n.byId(this.id)).removeClass("select2-search-choice-focus");var b=k.create("li",null,this._autocompleteList);u.add(b,this._CSS_STYLES.CHOICE);b=k.create("div",{title:a},b);e.set(b,this.htmlEncode(a));b=k.create("a",{href:"#"},b);u.add(b,this._CSS_STYLES.CLOSE_ICON);c(b,"click",t.hitch(this,function(a){var b=a.target.parentElement.innerText||a.target.parentElement.textContent;try{this._store.add({tag:b})}catch(S){}this._grid.refresh();this._removeTag(b);k.destroy(a.target.parentNode.parentNode);a.preventDefault()}));
b=E.byId(this._filterId);k.place(b.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(a)},_renderItem:function(a){return k.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this.domNode=k.create("div",null,this._attachmentNode);u.add(this.domNode,this._CSS_STYLES.MULTI);f.set(this.domNode,"maxWidth",this._maxWidth);f.set(this.domNode,"minWidth",this._minWidth)},_createTagList:function(){this._autocompleteList=k.create("ul",null,this.domNode);u.add(this._autocompleteList,
this._CSS_STYLES.CHOICES)},_createInput:function(){var a=k.create("li",null,this._autocompleteList,"last");u.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new z({id:this._filterId,placeHolder:this._placeHolder,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);u.add(this._inputTextBox,"inputTextBox");f.set(this._inputTextBox,"width",this._minWidth);C.watch("curNode",t.hitch(this,this._blurHandler))},_createDropDownList:function(){var a=k.create("div",{id:this._gridId},this.domNode);
u.add(a,"dropDownList");f.set(a,"width",this._minWidth)},prepopulate:function(a){p.forEach(a,t.hitch(this,function(a,b){this._createTags(a);this._store.remove(a)}))},clearTags:function(){var a=x(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,n.byId(this.id));0<a.length&&(p.forEach(a,t.hitch(this,function(a,b){try{this._store.add({tag:x(this._CHOICE_ALL_SELECTOR,n.byId(this.id))[0].title})}catch(Q){}k.destroy(a)})),this.values=[])},addStyledTags:function(a,b){u.add(n.byId(b),this._CSS_STYLES.MULTI);
var c=k.create("ul",null,n.byId(b));u.add(c,this._CSS_STYLES.CHOICES);f.set(c,"border","none");p.forEach(a,function(a,b){b=k.create("li",null,c);f.set(b,"padding","3px 5px 3px 5px");u.add(b,"select2-search-resultSet");b=k.create("div",{title:a},b);e.set(b,a)})},htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(p,
g,t){return p("dgrid.OnDemandGrid",[g,t],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(p,g,t,v,n,m,u){function k(b,a){a&&a.nodeType&&b.appendChild(a)}function f(b,a,c,e){if(this.formatter){e=this.formatter;var f=this.grid.formatterScope;c.innerHTML="string"===typeof e&&f?f[e](a,b):this.formatter(a,b)}else null!=a&&c.appendChild(document.createTextNode(a))}var e=8>v("ie")&&!v("quirks");
g=g("dgrid.Grid",m,{columns:null,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(b){return"object"!=typeof b?this.columns[b]:this.cell(b).column},listType:"grid",cell:function(b,a){if(b.column&&b.element)return b;b.target&&b.target.nodeType&&(b=b.target);var c;if(b.nodeType){do{if(this._rowIdToObject[b.id])break;var e=b.columnId;if(e){a=e;c=b;break}b=b.parentNode}while(b&&b!=this.domNode)}if(!c&&"undefined"!=typeof a){var f=this.row(b);if(e=f&&f.element)for(var e=e.getElementsByTagName("td"),
g=0;g<e.length;g++)if(e[g].columnId==a){c=e[g];break}}if(null!=b)return{row:f||this.row(b),column:a&&this.column(a),element:c}},createRowCells:function(b,a,c,f){var g=n("table.dgrid-row-table[role\x3dpresentation]"),k=9>v("ie")||v("quirks")?n(g,"tbody"):g,m,p,x,t,G,F,D,I,K,J;c=c||this.subRows;p=0;for(x=c.length;p<x;p++)for(F=c[p],m=n(k,"tr"),F.className&&n(m,"."+F.className),t=0,G=F.length;t<G;t++){D=F[t];I=D.id;K=D.field?".field-"+u.escapeCssIdentifier(D.field,"-"):"";(J="function"===typeof D.className?
D.className(f):D.className)&&(K+="."+J);K=n(b+(".dgrid-cell.dgrid-cell-padding"+(I?".dgrid-column-"+u.escapeCssIdentifier(I,"-"):"")+K.replace(/ +/g,"."))+"[role\x3d"+("th"===b?"columnheader":"gridcell")+"]");K.columnId=I;e?(I=n(K,"!dgrid-cell-padding div.dgrid-cell-padding"),K.contents=I):I=K;if(J=D.colSpan)K.colSpan=J;if(J=D.rowSpan)K.rowSpan=J;a(I,D);m.appendChild(K)}return g},left:function(b,a){b.element||(b=this.cell(b));return this.cell(this._move(b,-(a||1),"dgrid-cell"))},right:function(b,
a){b.element||(b=this.cell(b));return this.cell(this._move(b,a||1,"dgrid-cell"))},renderRow:function(b,a){var c=this.createRowCells("td",function(c,e){var g=b;e.get?g=e.get(b):"field"in e&&"_item"!=e.field&&(g=g[e.field]);e.renderCell?k(c,e.renderCell(b,g,c,a)):f.call(e,b,g,c,a)},a&&a.subRows,b);return n("div[role\x3drow]\x3e",c)},renderHeader:function(){var b=this,a=this.headerNode,c=a.childNodes.length;for(a.setAttribute("role","row");c--;)n(a.childNodes[c],"!");c=this.createRowCells("th",function(a,
b){var c=b.headerNode=a;e&&(a=a.parentNode);var f=b.field;f&&(a.field=f);b.renderHeaderCell?k(c,b.renderHeaderCell(c)):("label"in b||b.field)&&c.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&f&&"_item"!=f&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[c.id=this.id+"-header"]=this.columns;a.appendChild(c);this._sortListener&&this._sortListener.remove();this._sortListener=t(c,"click,keydown",function(c){if("click"==
c.type||32==c.keyCode||!v("opera")&&13==c.keyCode){var e=c.target,f,g,k;do if(e.sortable){k=[{attribute:f=e.field||e.columnId,descending:(g=b._sort[0])&&g.attribute==f&&!g.descending}];f={bubbles:!0,cancelable:!0,grid:b,parentType:c.type,sort:k};t.emit(c.target,"dgrid-sort",f)&&(b._sortNode=e,b.set("sort",k));break}while((e=e.parentNode)&&e!=a)}})},resize:function(){var b=this.headerNode.firstChild,a=this.contentNode,c;this.inherited(arguments);if(!v("ie")||7<v("ie")&&!v("quirks"))a.style.width="",
a&&b&&(c=b.offsetWidth)!=a.offsetWidth&&(a.style.width=c+"px")},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(b,a){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(b){var a=this.columns,c;for(c in a){var e=a[c];if(e.field==b)return e.headerNode}},updateSortArrow:function(b,a){this._lastSortedArrow&&(n(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),n(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);a&&(this._sort=b);if(b[0]){a=b[0].attribute;b=b[0].descending;a=this._sortNode||this._findSortArrowParent(a);var c;delete this._sortNode;a&&(a=a.contents||a,c=this._lastSortedArrow=n("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),c.innerHTML="\x26nbsp;",a.insertBefore(c,a.firstChild),n(a,b?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,a){return this.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,
"-"),a)},_configColumns:function(b,a){var c=[],e=a instanceof Array;u.each(a,function(f,g){"string"==typeof f&&(a[g]=f={label:f});e||f.field||(f.field=g);g=f.id=f.id||(isNaN(g)?g:b+g);this._configColumn&&(this._configColumn(f,g,a,b),g=f.id);e&&(this.columns[g]=f);f.grid=this;"function"===typeof f.init&&f.init();c.push(f)},this);return e?a:c},_destroyColumns:function(){var b=this.subRows,a=b&&b.length,c,e,f,g;this.cleanup();for(c=0;c<a;c++)for(e=0,g=b[c].length;e<g;e++)f=b[c][e],"function"===typeof f.destroy&&
f.destroy()},configStructure:function(){var b=this.subRows,a=this._columns=this.columns;this.columns=!a||a instanceof Array?{}:a;if(b)for(a=0;a<b.length;a++)b[a]=this._configColumns(a+"-",b[a]);else this.subRows=[this._configColumns("",a)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(b){this._destroyColumns();this.subRows=null;this.columns=b;this._updateColumns()},_setSubRows:function(b){this._destroyColumns();this.subRows=b;this._updateColumns()},setColumns:function(b){p.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",b)},setSubRows:function(b){p.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",b)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});g.appendIfNode=k;g.defaultRenderCell=f;return g})},"put-selector/put":function(){(function(p){var g,
t=/[-+,> ]/;p([],g=function(p,n){function m(b){function a(){v&&q&&v!=q&&(q==b&&(c||(c=t.test(G)&&p.createDocumentFragment()))?c:q).insertBefore(v,n||null)}for(var c,g,n,q,v,z=arguments,E=z[0],B=0;B<z.length;B++){var G=z[B];if("object"==typeof G){g=!1;if(G instanceof Array){v=p.createDocumentFragment();for(var F=0;F<G.length;F++)v.appendChild(m(G[F]));G=v}if(G.nodeType)v=G,a(),q=G,n=0;else for(F in G)v[F]=G[F]}else if(g)g=!1,v.appendChild(p.createTextNode(G));else{1>B&&(b=null);g=!0;if(E=G.replace(u,
function(c,g,w,x,u,t){g&&(a(),"-"==g||"+"==g?(q=(n=v||q).parentNode,v=null,"+"==g&&(n=n.nextSibling)):("\x3c"==g?q=v=(v||q).parentNode:(","==g?q=b:v&&(q=v),v=null),n=0),v&&(q=v));if((c=!w&&x)||!v&&(w||u))"$"==c?(c=z[++B],q.appendChild(p.createTextNode(c))):(c=c||m.defaultTag,(g=e&&z[B+1]&&z[B+1].name)&&(c="\x3c"+c+' name\x3d"'+g+'"\x3e'),v=f&&~(k=c.indexOf("|"))?p.createElementNS(f[c.slice(0,k)],c.slice(k+1)):p.createElement(c));if(w)if("$"==x&&(x=z[++B]),"#"==w)v.id=x;else if(g=(c=v.className)&&
(" "+c+" ").replace(" "+x+" "," "),"."==w)v.className=c?(g+x).substring(1):x;else if("!"==G){var C;e?m("div",v,"\x3c").innerHTML="":(C=v.parentNode)&&C.removeChild(v)}else g=g.substring(1,g.length-1),g!=c&&(v.className=g);u&&("$"==t&&(t=z[++B]),"style"==u?v.style.cssText=t:(w="!"==u.charAt(0)?(u=u.substring(1))&&"removeAttribute":"setAttribute",t=""===t?u:t,f&&~(k=u.indexOf("|"))?v[w+"NS"](f[u.slice(0,k)],u.slice(k+1),t):v[w](u,t)));return""}))throw new SyntaxError("Unexpected char "+E+" in "+G);
a();q=E=v||q}}b&&c&&b.appendChild(c);return E}t=n||t;var u=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,k,f=!1;p=p||document;var e="object"==typeof p.createElement;m.addNamespace=function(b,a){p.createElementNS?(f||(f={}))[b]=a:p.namespaces.add(b,a)};m.defaultTag="div";m.forDocument=g;return m})})(function(p,g,t){t=t||g;"function"===typeof define?define([],function(){return t()}):"undefined"==typeof window?require("./node-html")(module,t):put=
t()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a,b){f(document.body,a,".dgrid-scrollbar-measure");b=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return b}function b(a){var b=a?"."+a.replace(z,"."):"";this._class&&(b="!"+this._class.replace(z,"!")+b);
f(this.domNode,b);this._class=a}function a(){return this._class}function c(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function x(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}k("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var w,q;n.add("dom-scrollbar-width",function(a,b,c){return e(c,"Width")});n.add("dom-scrollbar-height",function(a,b,c){return e(c,"Height")});n.add("dom-rtl-scrollbar-left",
function(a,b,c){a=f("div");f(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");f(c,a);b=!!n("ie")||!!n("trident")||a.offsetLeft>=n("dom-scrollbar-width");c.className="";document.body.removeChild(c);f(a,"!");c.removeAttribute("dir");return b});var C=0,z=/ +/g,E=7>n("ie")&&!n("quirks")?function(){var a,b,c;this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a)&&(this.resize(),this._prevWinDims=[b,a])}:function(){this._started&&this.resize()};
return g("dgrid.List",n("touch")?u:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,shouldObserveStore:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,c){c=
this.domNode=c||f("div");var e;a?(this.params=a,g.safeMixin(this,a),e=a["class"]||a.className||c.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=c.id=c.id||this.id||"dgrid_"+C++;null===this.useTouchScroll&&(this.useTouchScroll=!n("dom-scrollbar-width"));this.buildRendering();e&&b.call(this,e);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&
this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,e,g,k,p;p=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";f(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));e=this.headerNode=f(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(n("quirks")||8>n("ie"))&&f(a,"div.dgrid-spacer");g=this.bodyNode=f(a,"div.dgrid-scroller");
n("ff")&&(g.tabIndex=-1);this.headerScrollNode=f(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));k=this.footerNode=f("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));f(a,k);p&&(a.className+=" dgrid-rtl"+(n("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));v(g,"scroll",function(b){c.showHeader&&(e.scrollLeft=b.scrollLeft||g.scrollLeft);b.stopPropagation();v.emit(a,"scroll",{scrollTarget:g})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=f(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=v(window,"resize",m.throttleDelayed(E,this)))},postCreate:n("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,e=b.offsetHeight,
f=this.showFooter?c.offsetHeight:0,g=n("quirks")||7>n("ie");this.headerScrollNode.style.height=a.style.marginTop=e+"px";a.style.marginBottom=f+"px";g&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-e-f,0)+"px",f&&(c.style.bottom="1px",setTimeout(function(){c.style.bottom=""},0)));w||(w=n("dom-scrollbar-width"),q=n("dom-scrollbar-height"),n("ie")&&(w++,q++),m.addCssRule(".dgrid-scrollbar-width","width: "+w+"px"),m.addCssRule(".dgrid-scrollbar-height","height: "+q+"px"),17==w||
g||(m.addCssRule(".dgrid-header-row","right: "+w+"px"),m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+w+"px")));g&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){a=m.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(a);return a},on:function(a,b){a=v(this.domNode,a,b);n("dom-addeventlistener")||this._listeners.push(a);return a},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();f(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,e,g){if(b){var k=this.insertRow(a,b,c,e,g);f(k,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){f(k,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return k}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&f(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,b,c){function e(){var b=arguments;if(-1<x)for(var d=0;d<b.length;d++){var e=b[d],g=q[e?0:q.length-1];if(g=g&&f(g)){var k=g[e?"previousSibling":"nextSibling"];k&&(k=m.row(k));k&&k.element!=g&&(e=e?"unshift":"push",a[e](k.data),q[e](k.element),c.count++)}}}function f(a){return!t.isDescendant(a,m.domNode)&&document.getElementById(a.id)?m.row(a.id.slice(m.id.length+5)).element:a}function g(a){z=m.insertRow(a,v,null,n++,c);z.observerIndex=
x;return z}function k(a){B=a.slice(0);(w=b?b.parentNode:m.contentNode)&&w.parentNode&&(w!==m.contentNode||a.length)?(w.insertBefore(v,b||null),(z=a[a.length-1])&&m.adjustRowIndices(z)):p[x]&&m.cleanEmptyObservers&&"undefined"!==typeof x&&(p[x].cancel(),p[x]=0,m._numObservers--);q=a;u&&(u.rows=q)}c=c||{};var m=this,n=c.start||0,p=this.observers,q,w,x;b||(this._lastCollection=a);if(a.observe&&this.shouldObserveStore){m._numObservers++;var u=a.observe(function(g,d,h){var l,k,n;-1<d&&q[d]&&(l=q.splice(d,
1)[0],l.parentNode==w&&((k=l.nextSibling)&&d!=h&&k.rowIndex--,m.removeRow(l)),c.count--,m._processScroll&&m._processScroll());if(-1<h){if(q.length)if(0===h)n=(n=q[h])&&f(n);else{if(n=q[h-1])n=f(n),n=(n.connected||n).nextSibling}else n=m._getFirstRowSibling&&m._getFirstRowSibling(w);l&&n&&l.id===n.id&&(n=(n.connected||n).nextSibling);n&&!n.parentNode&&(n=document.getElementById(n.id));l=b&&b.parentNode||n&&n.parentNode||m.contentNode;if(l=m.newRow(g,l,n,c.start+h,c))if(l.observerIndex=x,q.splice(h,
0,l),!k||h<d)k=(k=l.previousSibling)&&k.rowIndex+1!=l.rowIndex&&0!=l.rowIndex?k:l;c.count++}0===d?e(1,1):d===a.length-(-1===h?0:1)&&e(0,0);d!=h&&k&&m.adjustRowIndices(k);m._onNotification(q,g,d,h)},!0);x=p.push(u)-1}var v=document.createDocumentFragment(),z,B;if(a.map){if(q=a.map(g,console.error),q.then)return a.then(function(b){a=b;return q.then(function(a){k(a);e(1,1,0,0);return B})})}else{q=[];for(var C=0,E=a.length;C<E;C++)q[C]=g(a[C])}k(q);e(1,1,0,0);return B},_onNotification:function(a,b,c,
e){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,e,f){var g=f.parentId,g=this.id+"-row-"+(g?g+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),k=document.getElementById(g),m=k&&k.previousSibling;k&&(k===c&&(c=(c.connected||c).nextSibling),this.removeRow(k));k=this.renderRow(a,f);k.className=(k.className||"")+" dgrid-row "+(1==e%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[k.id=g]=a;b.insertBefore(k,
c||null);m&&this.adjustRowIndices(m);k.rowIndex=e;return k},renderRow:function(a,b){return f("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||f(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):
(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,e){var f,g;g=f=a.element;b=b||1;do if(a=f[0>b?"previousSibling":"nextSibling"]){do if((f=a)&&-1<(f.className+" ").indexOf(c+" ")){g=f;b+=0>b?1:-1;break}while(a=(!e||!f.hidden)&&f[0>b?"lastChild":"firstChild"])}else if(f=f.parentNode,!f||f===this.bodyNode||f===this.headerNode)break;while(b);return g},up:function(a,b,c){a.element||
(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:n("touch")?function(a){return this.useTouchScroll?this.inherited(arguments):x.call(this,a)}:x,getScrollPosition:n("touch")?function(){return this.useTouchScroll?this.inherited(arguments):c.call(this)}:c,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,
1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:a,_setClass:b,_getClassName:a,_setClassName:b,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,
e){c=c[a];e=e[a];void 0===c&&(c="");void 0===e&&(e="");return c==e?0:c>e==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){p.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;f(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){p.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;f(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(p,g){p.add("dom-contains",function(f,e,b){return!!b.contains});var t=[],v,n,m,u=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,k={defaultDelay:15,throttle:function(f,e,b){var a=!1;b=b||k.defaultDelay;return function(){a||(a=!0,f.apply(e,arguments),
setTimeout(function(){a=!1},b))}},throttleDelayed:function(f,e,b){var a=!1;b=b||k.defaultDelay;return function(){if(!a){a=!0;var c=arguments;setTimeout(function(){a=!1;f.apply(e,c)},b)}}},debounce:function(f,e,b){var a;b=b||k.defaultDelay;return function(){a&&(clearTimeout(a),a=null);var c=arguments;a=setTimeout(function(){f.apply(e,c)},b)}},each:function(f,e,b){var a,c;if(f)if("number"===typeof f.length)for(a=0,c=f.length;a<c;a++)e.call(b,f[a],a,f);else for(a in f)e.call(b,f[a],a,f)},contains:function(f,
e){return p("dom-contains")?f.contains(e):f.compareDocumentPosition(e)&8},addCssRule:function(f,e){v||(v=g(document.getElementsByTagName("head")[0],"style"),v=v.sheet||v.styleSheet,n=v.deleteRule?"deleteRule":"removeRule",m=v.cssRules?"cssRules":"rules");var b=t.length;t[b]=(v.cssRules||v.rules).length;v.addRule?v.addRule(f,e):v.insertRule(f+"{"+e+"}",t[b]);return{get:function(a){return v[m][t[b]].style[a]},set:function(a,c){"undefined"!==typeof t[b]&&(v[m][t[b]].style[a]=c)},remove:function(){var a=
t[b],c,e;if(void 0!==a)for(v[n](a),t[b]=void 0,c=b+1,e=t.length;c<e;c++)t[c]>a&&t[c]--}}},escapeCssIdentifier:function(f,e){return"string"===typeof f?f.replace(u,e||"\\$1"):f}};return k})},"xstyle/has-class":function(){define(["dojo/has"],function(p){var g={};return function(){for(var t,v=arguments,n=0;n<v.length;n++)if(t=v[n],!g[t]){g[t]=!0;var m=t.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),u=p(m[2]),k=-m[4];(0<k?k<=u&&(-m[5]||k)>=u:!!u)==!m[1]&&(document.documentElement.className+=" has-"+t)}}})},
"xstyle/css":function(){define(["require"],function(p){function g(g,p,n){var m=document.documentElement;g=m.insertBefore(document.createElement(g),m.firstChild);g.id=p;p=(g.currentStyle||getComputedStyle(g,null)||{})[n];m.removeChild(g);return p}return{load:function(t,v,n,m){function u(b){var a=g("x-parse",null,"content"),c=b&&(b.sheet||b.styleSheet);a&&"none"!=a&&"normal"!=a?v([eval(a)],function(a){b?a.process(b,n):(a.processAll(),n(c))}):n(c)}var k=v.toUrl(t),f;k.match(/!$/)&&(f={wait:!1},k=k.slice(0,
-1));var e=v.cache&&v.cache["url:"+k];if(null!=e)e.xCss&&(e=e.cssText),"string"==typeof e?p(["./core/load-css"],function(b){u(b.insertCss(e))}):u();else{if("none"==g("div",t.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return u();p(["./core/load-css"],function(b){b(k,u,f)})}}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(p,g,t,v,n,m,u,k,f){return t("dgrid.OnDemandList",
[p,g],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:k.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var e=this;u(this.bodyNode,"scroll",k[this.pagingMethod](function(b){e._processScroll(b)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(e,b){function a(a){f(B,
"!");if(a)throw c._refreshDeferred&&(c._refreshDeferred.reject(a),delete c._refreshDeferred),a;}var c=this,g=b&&b.container||this.contentNode,k={query:e,count:0,options:b},m,p=this.preload,u,t={node:f(g,"div.dgrid-preload",{rowIndex:0}),count:0,query:e,next:k,options:b};t.node.style.height="0";k.node=m=f(g,"div.dgrid-preload");k.previous=t;m.rowIndex=this.minRowsPerPage;p?((k.next=p.next)&&m.offsetTop>=p.node.offsetTop?k.previous=p:(k.next=p,k.previous=p.previous),k.previous.next=k,k.next.previous=
k):this.preload=k;var B=f(m,"-div.dgrid-loading");f(B,"div.dgrid-below").innerHTML=this.loadingMessage;b=v.mixin(this.get("queryOptions"),b,{start:0,count:this.minRowsPerPage},"level"in e?{queryLevel:e.level}:null);this._trackError(function(){return u=e(b)});if("undefined"===typeof u)a();else return n.when(c.renderArray(u,m,b),function(e){return n.when("undefined"===typeof u.total?u.length:u.total,function(a){var g=e.length,n=m.parentNode,p=c.noDataNode;f(B,"!");"queryLevel"in b||(c._total=a);0===
a&&n&&(p&&(f(p,"!"),delete c.noDataNode),c.noDataNode=p=f("div.dgrid-no-data"),n.insertBefore(p,c._getFirstRowSibling(n)),p.innerHTML=c.noDataMessage);for(p=n=0;p<g;p++)n+=c._calcRowHeight(e[p]);g&&n&&(c.rowHeight=n/g);n=c.rowHeight*c.bufferRows;n>c.farOffRemoval&&(c.farOffRemoval=n);a-=g;k.count=a;m.rowIndex=g;a?m.style.height=Math.min(a*c.rowHeight,c.maxEmptySpace)+"px":(m.style.display="none",b.count++);c._previousScrollPosition&&(c.scrollTo(c._previousScrollPosition),delete c._previousScrollPosition);
c._processScroll();c._refreshDeferred&&(c._refreshDeferred.resolve(u),delete c._refreshDeferred);return e},a)},a),u},refresh:function(e){var b=this,a=e&&e.keepScrollPosition,c;"undefined"===typeof a&&(a=this.keepScrollPosition);a&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return a=this._refreshDeferred=new n,c=b.renderQuery(function(a){return b.store.query(b.query,a)}),"undefined"===typeof c&&a.reject(),a.then(function(a){b._refreshTimeout=setTimeout(function(){u.emit(b.domNode,
"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b,results:a});b._refreshTimeout=null},0);delete b._refreshDeferred;return a},function(a){delete b._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(e){return e.lastChild},_calcRowHeight:function(e){var b=e.nextSibling;return b&&!/\bdgrid-preload\b/.test(b.className)?b.offsetTop-e.offsetTop:e.offsetHeight},lastScrollTop:0,_processScroll:function(e){function b(b,c,e,k){var l=
g.farOffRemoval,d=b.node;if(c>2*l){for(var h,m=d[e],n=0,p=0,q=[];h=m;){var w=g._calcRowHeight(h);if(n+w+l>c||0>m.className.indexOf("dgrid-row")&&0>m.className.indexOf("dgrid-loading"))break;m=h[e];n+=w;p+=h.count||1;g.removeRow(h,!0);q.push(h)}b.count+=p;k?(d.rowIndex-=p,a(b)):d.style.height=d.offsetHeight+n+"px";var u=f("div",q);setTimeout(function(){f(u,"!")},1)}}function a(a,b){a.node.style.height=Math.min(a.count*g.rowHeight,b?Infinity:g.maxEmptySpace)+"px"}function c(a,b){do a=b?a.next:a.previous;
while(a&&!a.node.offsetWidth);return a}var g=this,k=g.bodyNode;e=e&&e.scrollTop||this.getScrollPosition().y;var k=k.offsetHeight+e,m,p,u=g.preload,t=g.lastScrollTop,B=g.bufferRows*g.rowHeight,G=B-g.rowHeight,F,D,I,K=!0;for(g.lastScrollTop=e;u&&!u.node.offsetWidth;)u=u.previous;for(;u&&u!=m;){m=g.preload;g.preload=u;p=u.node;var J=p.offsetTop;if(k+1+G<J)u=c(u,K=!1);else if(e-1-G>J+p.offsetHeight)u=c(u,K=!0);else{var L=((p.rowIndex?e-B:k)-J)/g.rowHeight,J=(k-e+2*B)/g.rowHeight,J=J+Math.min(Math.abs(Math.max(Math.min((e-
t)*g.rowHeight,g.maxRowsPerPage/2),g.maxRowsPerPage/-2)),10);0==p.rowIndex&&(L-=J);L=Math.max(L,0);10>L&&0<L&&J+L<g.maxRowsPerPage&&(J+=Math.max(0,L),L=0);J=Math.min(Math.max(J,g.minRowsPerPage),g.maxRowsPerPage,u.count);if(0==J)u=c(u,K);else{var J=Math.ceil(J),L=Math.min(Math.floor(L),u.count-J),M=v.mixin(g.get("queryOptions"),u.options);u.count-=J;var Q=p,S,T=g.queryRowsOverlap,O=(0<p.rowIndex||p.offsetTop>e)&&u;if(O){var W=u.previous;W&&(b(W,e-(W.node.offsetTop+W.node.offsetHeight),"nextSibling"),
0<L&&W.node==p.previousSibling?(L=Math.min(u.count,L),u.previous.count+=L,a(u.previous,!0),p.rowIndex+=L,T=0):J+=L,u.count-=L);M.start=p.rowIndex-T;M.count=Math.min(J+T,g.maxRowsPerPage);p.rowIndex=M.start+M.count}else u.next&&(b(u.next,u.next.node.offsetTop-k,"previousSibling",!0),Q=p.nextSibling,Q==u.next.node?(u.next.count+=u.count-L,u.next.node.rowIndex=L+J,a(u.next),u.count=L,T=0):S=!0),M.start=u.count,M.count=Math.min(J+T,g.maxRowsPerPage);S&&Q&&Q.offsetWidth&&(S=Q.offsetTop);a(u);"level"in
u.query&&(M.queryLevel=u.query.level);if("queryLevel"in M||!(M.start>g._total||0>M.count)){p=f(Q,"-div.dgrid-loading[style\x3dheight:"+J*g.rowHeight+"px]");f(p,"div.dgrid-"+(O?"below":"above")).innerHTML=g.loadingMessage;p.count=J;var U=u.query(M);if(void 0===g._trackError(function(){return U})){f(p,"!");return}(function(b,c,e,k){I=n.when(g.renderArray(k,b,M),function(l){D=k;Q=b.nextSibling;f(b,"!");if(e&&Q&&Q.offsetWidth){var d=g.getScrollPosition();g.scrollTo({x:d.x,y:d.y+Q.offsetTop-e,preserveMomentum:!0})}n.when(k.total||
k.length,function(b){"queryLevel"in M||(g._total=b);c&&(c.count=b-c.node.rowIndex,0===c.count&&M.count++,a(c))});g._processScroll();return l},function(a){f(b,"!");throw a;})}).call(this,p,O,S,U);u=u.previous}}}}I&&(F=this._refreshDeferred)&&(delete this._refreshDeferred,n.when(I,function(){F.resolve(D)}))},removeRow:function(e,b){if(e){var a=e.previousSibling,c=e.nextSibling,f;if(f=a)f=a.observerIndex,f=null!=f?f:a.previousObserverIndex;a=f;if(f=c)f=c.observerIndex,f=null!=f?f:c.nextObserverIndex;
c=e.observerIndex;e.observerIndex=void 0;b&&(e.nextObserverIndex=f,e.previousObserverIndex=a);if(this.cleanEmptyObservers&&-1<c&&c!==a&&c!==f&&(a=this.observers,f=a[c])){if(!b)for(var g=f.rows,k=0;k<g.length;k++)if(g[k]!=e&&m.isDescendant(g[k],this.domNode))return this.inherited(arguments);f.cancel();this._numObservers--;a[c]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(p,g,t,v,n,m,u){function k(e){return e}function f(e){if("object"!==typeof e)e=Error(e);else if("cancel"===e.dojoType)return;e.grid=this;n.emit(this.domNode,"dgrid-error",{grid:this,error:e,cancelable:!0,bubbles:!0})&&console.error(e)}return g("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",
t.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(e){e.set&&(this._columnsWithSet[e.field]=e);this.inherited(arguments)},_updateNotifyHandle:function(e){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);e&&"function"===typeof e.notify&&this.shouldObserveStore&&
(this._notifyHandle=m.after(e,"notify",t.hitch(this,"_onNotify"),!0),(e=this.get("sort"))&&e.length||console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(e,b,a){this._updateNotifyHandle(e);this.store=e;this.dirty={};this.set("query",b,a)},_setQuery:function(e,b){var a=b&&b.sort;this.query=void 0!==e?e:this.query;this.queryOptions=b||this.queryOptions;
this._started&&(a?this.set("sort",a):this.refresh())},setStore:function(e,b,a){p.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",e,b,a)},setQuery:function(e,b){p.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",e,b)},_getQueryOptions:function(){var e=t.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)e.sort=this._sort;return e},_getQuery:function(){var e=this.query;return"object"==typeof e&&
null!=e?t.delegate(e,{}):e},_setSort:function(e,b){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(e,b){this.inherited(arguments);e&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},refresh:function(){var e=this.inherited(arguments);this.store||(this.noDataNode=u(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return e},renderArray:function(){var e=this,b=this.inherited(arguments);this.store||v.when(b,function(a){a.length&&
e.noDataNode&&u(e.noDataNode,"!")});return b},insertRow:function(e,b,a,c,f){var g=this.store,k=this.dirty,g=g&&g.getIdentity(e),m;g in k&&!(g in this._updating)&&(m=k[g]);m&&(e=t.delegate(e,m));return this.inherited(arguments)},updateDirty:function(e,b,a){var c=this.dirty,f=c[e];f||(f=c[e]={});f[b]=a},setDirty:function(e,b,a){p.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(e,b,a)},save:function(){function e(e,f){return function(g){var k=b._columnsWithSet,m=b._updating,
n,p;if("function"===typeof g.set)g.set(f);else for(n in f)g[n]=f[n];for(n in k)p=k[n].set(g),void 0!==p&&(g[n]=p);m[e]=!0;return v.when(a.put(g),function(){delete c[e];delete m[e]})}}var b=this,a=this.store,c=this.dirty,f=new v,g=f.promise,k=function(c){var e;return b.getBeforePut||!(e=b.row(c).data)?function(){return a.get(c)}:function(){return e}},m;for(m in c)var n=e(m,c[m]),g=g.then(k(m)).then(n);f.resolve();return g},revert:function(){this.dirty={};this.refresh()},_trackError:function(e){var b;
"string"==typeof e&&(e=t.hitch(this,e));try{b=e()}catch(a){f.call(this,a)}return v.when(b,k,t.hitch(this,f))},newRow:function(){var e=this.inherited(arguments);this.noDataNode&&(u(this.noDataNode,"!"),delete this.noDataNode);return e},removeRow:function(e,b){var a={element:e};!b&&this.noDataMessage&&this.up(a).element===e&&this.down(a).element===e&&(this.noDataNode=u(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(p,g,t,v,n,m,u,k,f){function e(a,b){b=a.unselectable=b?"on":"";a=a.getElementsByTagName("*");for(var c=a.length;--c;)"INPUT"!==a[c].tagName&&"TEXTAREA"!==a[c].tagName&&(a[c].unselectable=b)}function b(a,b){var f=a.bodyNode,g=b?"text":21>n("ff")?"-moz-none":"none";c&&"msUserSelect"!==c?f.style[c]=g:n("dom-selectstart")?b||a._selectstartHandle?b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=v(f,"selectstart",function(a){var b=a.target&&
a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):(e(f,!b),b||a._unselectableHandle)?b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=m.after(a,"renderRow",function(a){e(a,!0);return a})}n.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});n.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});n.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var e="userSelect";do if("undefined"!==typeof a[e])return e;while(c--&&(e=b[c]+"UserSelect"));return!1});n.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=n("mac")?"metaKey":"ctrlKey",c=n("css-user-select"),x=(u=n("pointer"))&&"MS"===u.slice(0,2),w=u?u+(x?"Down":"down"):"mousedown",q=u?u+(x?"Up":"up"):"mouseup";"WebkitUserSelect"===c&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(c=!1);return g("dgrid.Selection",
null,{selectionDelegate:".dgrid-row",selectionEvents:w+","+q+",dgrid-cellfocusin",selectionTouchEvents:n("touch")?k.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);
this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){p.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");
this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?b(this,a):b(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==q||b==this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===w&&this.isSelected(b))this._waitForMouseUp=
b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(b,c){b=b.keyCode?b.ctrlKey:b[a];this._lastSelected===c?this.select(c,null,!b||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(b,c){var e=this._lastSelected,f=b.keyCode?b.ctrlKey:b[a],g;b.shiftKey||(g=f?null:!0,e=null);this.select(c,e,g);e||(this._lastSelected=c)},_extendedSelectionHandler:function(b,c){(2===b.button?this.isSelected(c):
b.keyCode?b.ctrlKey:b[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(b,c)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var b=this,c=this.contentNode,e=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};n("touch")&&!n("pointer")&&this.selectionTouchEvents?(v(c,k.selector(e,this.selectionTouchEvents),function(a){b._handleSelect(a,this);b._ignoreMouseSelect=this}),v(c,v.selector(e,this.selectionEvents),function(a){b._ignoreMouseSelect!==
this?b._handleSelect(a,this):a.type===q&&(b._ignoreMouseSelect=null)})):v(c,v.selector(e,this.selectionEvents),function(a){b._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){b._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[a]&&65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className)&&(c.preventDefault(),b[b.allSelected?"clearSelection":"selectAll"]())});this._setStore&&m.after(this,"_setStore",function(){b._updateDeselectionAspect()});
this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(a,c,e){a=c||a&&a[b.idProperty||"id"];if(null!=a&&(c=(a=b.row(a))&&b.selection[a.id]))b[e](a,null,c)}var b=this,c=this.store,e,f;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(e=m.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),f=m.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){e.remove();f.remove()}):(e=m.before(this,"removeRow",function(a,b){b||
(a=this.row(a))&&a.id in this.selection&&this.deselect(a)}),this._removeDeselectSignals=function(){e.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,e;e={bubbles:!0,grid:this};c&&(e.parentType=c.type);e[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];v.emit(this.contentNode,"dgrid-"+a,e)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},
_select:function(a,b,c){var e,g,k;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(e=this.selection,g=!!e[a.id],null===c&&(c=!g),k=a.element,c||this.allSelected?e[a.id]=c:delete this.selection[a.id],k&&(c?f(k,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):f(k,"!dgrid-selected!ui-state-active")),c!==g&&k&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element)for(e=this._determineSelectionDirection(k,
b),e||(b=document.getElementById(b.id),e=this._determineSelectionDirection(k,b));a.element!=b&&(a=this[e](a));)this._select(a,null,c)}else this._lastSelected=k,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:n("dom-comparedocumentposition")?function(a,
b){a=b.compareDocumentPosition(a);return a&1?!1:2===a?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=
this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);t.when(b,function(b){var c=a.selection,
e,f,g;for(e=0;e<b.length;e++)f=a.row(b[e]),(g=f.id in c?c[f.id]:a.allSelected)&&a._select(f,null,g);a._fireSelectionEvents()});return b}})})},"dgrid/Keyboard":function(){define("dojo/_base/declare dojo/aspect dojo/on dojo/_base/lang dojo/has put-selector/put ./util/misc dojo/_base/Deferred dojo/_base/sniff".split(" "),function(p,g,t,v,n,m,u,k){function f(a){a.preventDefault()}var e={checkbox:1,radio:1,button:1},b=/\bdgrid-cell\b/,a=/\bdgrid-row\b/,c=p("dgrid.Keyboard",null,{pageSkip:10,tabIndex:0,
keyMap:null,headerKeyMap:null,postMixInProperties:function(){this.inherited(arguments);this.keyMap||(this.keyMap=v.mixin({},c.defaultKeyMap));this.headerKeyMap||(this.headerKeyMap=v.mixin({},c.defaultHeaderKeyMap))},postCreate:function(){function c(a){var b=a.target;return b.type&&(!e[b.type]||32==a.keyCode)}function f(e){function f(){m._focusedHeaderNode&&(m._focusedHeaderNode.tabIndex=-1);if(m.showHeader){if(n)for(var a=0,b,c=m.headerNode.getElementsByTagName("th");b=c[a];++a){if(p.test(b.className)){m._focusedHeaderNode=
w=b;break}}else m._focusedHeaderNode=w=m.headerNode;w&&(w.tabIndex=m.tabIndex)}}var n=m.cellNavigation,p=n?b:a,q=e===m.headerNode,w=e;q?(f(),g.after(m,"renderHeader",f,!0)):g.after(m,"renderArray",function(a){return k.when(a,function(a){var b=m._focusedNode||w;if(p.test(b.className)&&u.contains(e,b))return a;for(var c=0,f=e.getElementsByTagName("*"),g;g=f[c];++c)if(p.test(g.className)){b=m._focusedNode=g;break}b.tabIndex=m.tabIndex;return a})});m._listeners.push(t(e,"mousedown",function(a){c(a)||
m._focusOnNode(a.target,q,a)}));m._listeners.push(t(e,"keydown",function(a){if(!a.metaKey&&!a.altKey){var b=m[q?"headerKeyMap":"keyMap"][a.keyCode];b&&!c(a)&&b.call(m,a)}}))}this.inherited(arguments);var m=this;this.tabableHeader&&(f(this.headerNode),t(this.headerNode,"dgrid-cellfocusin",function(){m.scrollTo({x:this.scrollLeft})}));f(this.contentNode);this._debouncedEnsureRowScroll=u.debounce(this._ensureRowScroll,this)},removeRow:function(a){if(!this._focusedNode)return this.inherited(arguments);
var b=this,c=document.activeElement===this._focusedNode,e=this[this.cellNavigation?"cell":"row"](this._focusedNode),f=e.row||e,g;a=a.element||a;a===f.element&&((g=this.down(f,!0))&&g.element!==a||(g=this.up(f,!0)),this._removedFocus={active:c,rowId:f.id,columnId:e.column&&e.column.id,siblingId:g&&g.element!==a?g.id:void 0},setTimeout(function(){b._removedFocus&&b._restoreFocus(f.id)},0),this._focusedNode=null);this.inherited(arguments)},insertRow:function(a){var b=this.inherited(arguments);this._removedFocus&&
!this._removedFocus.wait&&this._restoreFocus(b);return b},_restoreFocus:function(a){var b=this._removedFocus,c;if((a=(a=a&&this.row(a))&&a.element&&a.id===b.rowId?a:"undefined"!==typeof b.siblingId&&this.row(b.siblingId))&&a.element){if(!a.element.parentNode.parentNode){b.wait=!0;return}"undefined"!==typeof b.columnId&&(c=this.cell(a,b.columnId))&&c.element&&(a=c);b.active&&0!==a.element.offsetHeight?this._focusOnNode(a,!1,null):(m(a.element,".dgrid-focus"),a.element.tabIndex=this.tabIndex,this._focusedNode=
a.element)}delete this._removedFocus},addKeyHandler:function(a,b,c){return g.after(this[c?"headerKeyMap":"keyMap"],a,b,!0)},_ensureRowScroll:function(a){var b=this.getScrollPosition().y;b>a.offsetTop?this.scrollTo({y:a.offsetTop}):b+this.contentNode.offsetHeight<a.offsetTop+a.offsetHeight&&this.scrollTo({y:a.offsetTop-this.contentNode.offsetHeight+a.offsetHeight})},_focusOnNode:function(c,e,f){var g="_focused"+(e?"Header":"")+"Node",k=this[g],p=this.cellNavigation?"cell":"row",q=this[p](c),w,u,x,
z,B;if(c=q&&q.element){if(this.cellNavigation)for(w=c.getElementsByTagName("input"),B=0,x=w.length;B<x;B++)if(u=w[B],(-1!=u.tabIndex||"_dgridLastValue"in u)&&!u.disabled){8>n("ie")&&(u.style.position="relative");u.focus();8>n("ie")&&(u.style.position="");z=!0;break}null!==f&&(f=v.mixin({grid:this},f),f.type&&(f.parentType=f.type),f.bubbles||(f.bubbles=!0));k&&(m(k,"!dgrid-focus[!tabIndex]"),8>n("ie")&&(k.style.position=""),f&&(f[p]=this[p](k),t.emit(k,"dgrid-cellfocusout",f)));k=this[g]=c;f&&(f[p]=
q);g=this.cellNavigation?b:a;!z&&g.test(c.className)&&(8>n("ie")&&(c.style.position="relative"),c.tabIndex=this.tabIndex,c.focus());m(c,".dgrid-focus");f&&t.emit(k,"dgrid-cellfocusin",f);this.cellNavigation&&(this.columnSets||1<this.subRows.length)&&!e&&this._debouncedEnsureRowScroll(q.row.element)}},focusHeader:function(a){this._focusOnNode(a||this._focusedHeaderNode,!0)},focus:function(a){(a=a||this._focusedNode)?this._focusOnNode(a,!1):this.contentNode.focus()}}),x=c.moveFocusVertical=function(a,
b){var c=this.cellNavigation,e=this[c?"cell":"row"](a),e=c&&e.column.id;b=this.down(this._focusedNode,b,!0);c&&(b=this.cell(b,e));this._focusOnNode(b,!1,a);a.preventDefault()};p=c.moveFocusUp=function(a){x.call(this,a,-1)};var w=c.moveFocusDown=function(a){x.call(this,a,1)},q=c.moveFocusPageUp=function(a){x.call(this,a,-this.pageSkip)},C=c.moveFocusPageDown=function(a){x.call(this,a,this.pageSkip)},z=c.moveFocusHorizontal=function(a,b){if(this.cellNavigation){var c=!this.row(a);this._focusOnNode(this.right(this["_focused"+
(c?"Header":"")+"Node"],b),c,a);a.preventDefault()}},E=c.moveFocusLeft=function(a){z.call(this,a,-1)},B=c.moveFocusRight=function(a){z.call(this,a,1)},G=c.moveHeaderFocusEnd=function(a,b){var c;this.cellNavigation&&(c=this.headerNode.getElementsByTagName("th"),this._focusOnNode(c[b?0:c.length-1],!0,a));a.preventDefault()},F=c.moveHeaderFocusHome=function(a){G.call(this,a,!0)},D=c.moveFocusEnd=function(a,b){var c=this,e=this.cellNavigation,f=this.contentNode,m=f.scrollTop+(b?0:f.scrollHeight),f=f[b?
"firstChild":"lastChild"],p=-1<f.className.indexOf("dgrid-preload"),q=p?f[(b?"next":"previous")+"Sibling"]:f,w=q.offsetTop+(b?0:q.offsetHeight),u;if(p){for(;q&&0>q.className.indexOf("dgrid-row");)q=q[(b?"next":"previous")+"Sibling"];if(!q)return}!p||1>f.offsetHeight?(e&&(q=this.cell(q,this.cell(a).column.id)),this._focusOnNode(q,!1,a)):(n("dom-addeventlistener")||(a=v.mixin({},a)),u=g.after(this,"renderArray",function(f){u.remove();return k.when(f,function(f){f=f[b?0:f.length-1];e&&(f=c.cell(f,c.cell(a).column.id));
c._focusOnNode(f,!1,a)})}));m===w&&a.preventDefault()},I=c.moveFocusHome=function(a){D.call(this,a,!0)};c.defaultKeyMap={32:f,33:q,34:C,35:D,36:I,37:E,38:p,39:B,40:w};c.defaultHeaderKeyMap={32:f,35:G,36:F,37:E,39:B};return c})},"jimu/dijit/ImageChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){var q=0;p=g([t,v,p],{templateString:k,declaredClass:"jimu.dijit.ImageChooser",cropImage:!0,displayImg:null,stretchImg:!0,defaultSelfSrc:null,showSelfImg:!1,label:null,showTip:!0,goldenWidth:400,goldenHeight:400,maxSize:1024,format:null,customZIndex:null,imageData:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser;this.nls.common=window.jimuNls.common;this.nls.readError=this.nls.readError||"Failed to read the file."},
postCreate:function(){this._initial();b.file.supportHTML5()||f("safari")||!b.file.isEnabledFlash()||b.file.loadFileAPI().then(n.hitch(this,function(){m.setStyle(this.mask,"zIndex",1)}))},setImageSize:function(a){this.goldenWidth=a.width;this.goldenHeight=a.height},disableChooseImage:function(){m.setStyle(this.fileForm,"display","none");this.label&&"string"===typeof this.label&&m.addClass(this.displayText,"disable-label");m.removeAttr(this.domNode,"title")},enableChooseImage:function(){m.setStyle(this.fileForm,
"display","block");this.label&&"string"===typeof this.label&&m.removeClass(this.displayText,"disable-label");this._addTip()},setDefaultSelfSrc:function(a){this.defaultSelfSrc=a;this.imageData=this.selfImg.src=a},getImageData:function(){return this.imageData},_initial:function(){this._initFileForm();this._processProperties();this._addTip()},_processProperties:function(){this.fileProperty={};this.label&&"string"===typeof this.label&&(this.displayText.innerHTML=this.label,m.setStyle(this.hintText,"display",
"block"));this.showSelfImg&&m.setStyle(this.hintImage,"display","block");!1===this.stretchImg?m.addClass(this.selfImg,"no-stretch-img"):m.removeClass(this.selfImg,"no-stretch-img");this.defaultSelfSrc&&(this.imageData=this.selfImg.src=this.defaultSelfSrc);if(this.format){var a="image/*";"string"===typeof this.format&&/^image\/./.test(this.format)?a=this.format:"[object Array]"===Object.prototype.toString.call(this.format)&&0<this.format.length&&(a=this.format.join(","));m.setAttr(this.fileInput,"accept",
a)}b.file.supportHTML5()||f("safari")||!b.file.isEnabledFlash()||m.setStyle(this.fileInput,{width:"100%",height:"100%",position:"absolute",left:0,top:0,opacity:0,zIndex:9})},_newMessage:function(a){this.msgPopupOpen=!0;this.msgPopup=new x({customZIndex:this.customZIndex,message:a})},_porcessMaskClick:function(){m.setAttr(this.fileInput,"id","imageChooser_"+q);m.setAttr(this.mask,"for","imageChooser_"+q);q++;u.once(this.mask,"click",n.hitch(this,function(a){a.stopPropagation();if(f("safari")&&7>f("safari"))this._newMessage(this.nls.unsupportReaderAPI),
a.preventDefault();else{if(!b.file.supportHTML5()){if(!b.file.isEnabledFlash()){var c=m.create("a",{href:"http://helpx.adobe.com/flash-player.html",innerHTML:this.nls.enableFlash,target:"_blank"});this._newMessage(c);a.preventDefault();return}if(!b.file.supportFileAPI()){this._newMessage(this.nls.unsupportReaderAPI);a.preventDefault();return}}m.setStyle(this.fileInput,"display","none");setTimeout(n.hitch(this,function(){m.setStyle(this.fileInput,"display","block")}),200)}}))},_addTip:function(){if(this.showTip){var a=
e.substitute({width:this.goldenWidth||40,height:this.goldenHeight||40},this.nls.toolTip);m.setAttr(this.domNode,"title",a)}else m.setAttr(this.domNode,"title","")},_onFileInputChange:function(a){var c=a.target.files&&a.target.files[0]||a.files&&a.files[0];if(this.format&&-1===this.format.indexOf(c.type))this._newMessage(this.nls.invalidType),this._initFileForm();else{var e=1024*this.maxSize;b.file.readFile(a,"image/*",e,n.hitch(this,function(a,b,f){a?(b=this.nls[a.errCode],"exceed"===a.errCode&&(b=
b.replace("1024",e/1024)),this._newMessage(b)):(this.fileProperty.fileName=b,this.cropImage&&"image/gif"!==c.type?this._cropImageByUser(f,c.type):this._readFileData(f));this._initFileForm()}))}},_initFileForm:function(){this.mask&&m.destroy(this.mask);this.fileInput&&m.destroy(this.fileInput);this.fileForm&&m.destroy(this.fileForm);this.fileForm=m.create("form",{"data-dojo-attach-point":"fileForm"},this.domNode);this.mask=m.create("label",{"data-dojo-attach-point":"mask"},this.fileForm);this.fileInput=
m.create("input",{type:"file","data-dojo-attach-point":"fileInput"},this.fileForm);this._porcessMaskClick();u.once(this.fileInput,"change",n.hitch(this,this._onFileInputChange))},_readFileData:function(a){this.onImageChange(a,this.fileProperty);this.displayImg&&m.setAttr(this.displayImg,"src",a);this.showSelfImg&&(this.selfImg?m.setAttr(this.selfImg,"src",a):this.selfImg.src=a,(a=m.getMarginBox(this.hintImage))&&a.w&&a.h&&(m.style(this.selfImg,"maxWidth",a.w+"px"),m.style(this.selfImg,"maxHeight",
a.h+"px")))},_cropImageByUser:function(b,e){var f=new a({imageSrc:b,type:e,nls:n.clone(this.nls),goldenWidth:this.goldenWidth,goldenHeight:this.goldenHeight}),g=new w({hidden:!0});this.cropPopupOpen=!0;this.cropPopup=new c({titleLabel:this.nls.cropImage,content:f,customZIndex:this.customZIndex,width:500,height:480,buttons:[{label:this.nls.common.ok,onClick:n.hitch(this,function(){g.show();var a=f.getData();a&&this._readFileData(a);this.cropPopup.close();f.destroy();g.hide()})}]});g.placeAt(this.cropPopup.domNode);
f.startup();m.addClass(this.cropPopup.domNode,"image-chooser-crop-popup")},onImageChange:function(a){this.imageData=a;this.emit("imageChange",this.imageData,this.fileProperty);this.emit("change",this.imageData,this.fileProperty)}});p.GIF="image/gif";p.JPEG="image/jpeg";p.PNG="image/png";return p})},"jimu/dijit/_CropImage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message dojo/NodeList-dom".split(" "),
function(p,g,t,v,n,m,u,k){var f=window.Cropper;return p([n,m],{templateString:u,imageSrc:null,type:null,goldenWidth:4,goldenHeight:3,_haveShowReadErrMsg:!1,postCreate:function(){this.type||(this.type="image/jpeg");this.setImageSrc(this.imageSrc);this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";this._checkImgError();this.own(v(this.baseImage,"load",t.hitch(this,function(){g.setStyle(this.loadingImg,"display","none");this._initCropper()})))},_initCropper:function(){this.cropper&&this.cropper.destroy&&
this.cropper.destroy();this.cropper=new f(this.baseImage,{aspectRatio:this.goldenWidth/this.goldenHeight,preview:".img-preview"})},setImageSrc:function(e){g.setAttr(this.baseImage,"src",e)},getData:function(){try{var e=this.cropper.getCroppedCanvas();this.cropper.getCroppedCanvas();return e.toDataURL(this.type||"image/jpeg")}catch(b){return this._readError(),null}},destroy:function(){this.cropper&&this.cropper.destroy&&this.cropper.destroy();this.inherited(arguments)},_checkImgError:function(){setTimeout(t.hitch(this,
function(){"none"!==g.getStyle(this.loadingImg,"display")&&this._readError()}),5E3)},_readError:function(){this._haveShowReadErrMsg||(new k({message:this.nls.readError}),this._haveShowReadErrMsg=!0)}})})},"builder/dijit/template-config/utils":function(){define("dojo/_base/lang dojo/Deferred jimu/utils jimu/dijit/Message jimu/WidgetManager dojo/promise/all dojo/json builder/serviceUtils".split(" "),function(p,g,t,v,n,m,u,k){return{loadAllWidgetConfigs:function(f){var e=new g,b=[];f.visitElement(function(a){if(a.uri){var c=
n.getInstance().tryLoadWidgetConfig(a).then(function(b){b&&(a.config=b,f._originConfig&&(t.getConfigElementById(f._originConfig,a.id).config=b))});b.push(c)}});m(b).then(function(){e.resolve(f)},function(a){e.reject(a)});return e},saveAgolTemplate:function(f,e,b){var a=new g,c={itemId:b?b:this.app.agolTemplateInfo?this.app.agolTemplateInfo.itemId:null,json:e};k.saveAgolTemplate(this.app,c).then(p.hitch(this,function(){this.app.agolTemplateInfo=c;this.lastTemplateJson=this.categoryManager.getTemplateJson();
a.resolve()}),function(b){new v({message:b});a.reject()});return a}}})},"builder/plugins/app-list/_build-generate_module":function(){define(["builder/plugins/app-list/Plugin","dojo/text!builder/plugins/app-list/Plugin.html","dojo/text!builder/plugins/app-list/css/style.css","dojo/i18n!builder/plugins/app-list/nls/strings"],function(){})},"builder/plugins/app-list/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/on dojo/_base/lang dojo/query dojo/topic ./Import ./AppCatalogPage ./CardPageWithBigThumbnail ./CardPageWithSmallThumbnail builder/serviceUtils builder/portalUtils jimu/dijit/LoadingShelter jimu/utils jimu/Role builder/BasePlugin esri/lang dojox/form/Uploader dojo/NodeList-dom jimu/dijit/DropdownMenu".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){var F=p([B,n],{baseClass:"plugin-app-list",templateString:m,label:"applist",apps:null,templates:null,user:null,_userIsAdmin:null,_appPages:null,_tempaltePage:null,_appPageState:null,_tempaltePageState:null,_currentPageState:null,_refreshImageFlag:null,postMixInProperties:function(){this.inherited(arguments);this.nls=k.mixin(this.nls,builderNls)},constructor:function(){this._appPages=[];this._appPageState={name:F.APP_PAGE,shownType:F.APP_TYPE_ALL,
sortBy:F.SORT_BY_MODIFIED_TIME,filterBy:F.FILTER_BY_OWNEDBYME,searchKey:""};this._tempaltePageState={name:F.TEMPLATE_PAGE,shownType:F.APP_TYPE_ALL,sortBy:F.SORT_BY_MODIFIED_TIME,filterBy:F.FILTER_BY_OWNEDBYANYONE,searchKey:""};this._currentPageState=this._appPageState;this._refreshImageFlag=new Date},startup:function(){this.inherited(arguments);this.loading=new C({hidden:!0});this.loading.placeAt(this.domNode);this.importDijit=(new b({appListWidget:this})).placeAt(this.importBtn);var e=new c({appListWidget:this});
this._addAppPage(e,"card-page2",this.nls.gridView);e=new a({appListWidget:this});this._addAppPage(e,"catalog-page",this.nls.listView);this._tempaltePage=new x({appListWidget:this});this._tempaltePage.placeAt(this.templateContent);this._bindEvent();q.getPortal(window.portalUrl).getUser().then(k.hitch(this,function(a){this.user=a;this._userIsAdmin=this._isAdminUser(a);this._userIsAdmin||(g.setStyle(this.sortByAuthorBtn,"display","none"),g.setStyle(this.authorFilterBox,"display","none"));this.refreshAppPage()}),
k.hitch(this,function(a){console.error(a)}))},_addAppPage:function(a,b,c){var e=g.create("div",{"class":"app-page-box"},this.appContent);a.placeAt(e);var m=g.create("div",{"class":"switch-app-page-btn jimu-float-leading "+b,title:c},this.switchAppPapgeBox);this.own(u(m,"click",k.hitch(this,function(){f(".app-page-box",this.contentBox).removeClass("selected");g.addClass(e,"selected");f(".switch-app-page-btn",this.switchAppPapgeBox).removeClass("selected");g.addClass(m,"selected")})));0===this._appPages.length&&
(g.addClass(e,"selected"),g.addClass(m,"selected"));this._appPages.push(a)},refreshAppPage:function(a){var b=new v;a?b.resolve():this.getAppList().then(k.hitch(this,function(a){this._currentPageState.sortBy!==F.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initApps(a);b.resolve()}));b.then(k.hitch(this,function(){var a=this.filter(this.apps);t.forEach(this._appPages,function(b){b.refresh(a)},this)}))},refreshTemplatePage:function(a){var b=new v;a?b.resolve():this.getTemplateList().then(k.hitch(this,
function(a){this._currentPageState.sortBy!==F.SORT_BY_MODIFIED_TIME&&(a=this._sort(a));this.initTemplates(a);b.resolve()}));b.then(k.hitch(this,function(){var a=this.filter(this.templates);this._tempaltePage.refresh(a)}))},refreshCurrentPage:function(a,b){this._currentPageState.name===F.APP_PAGE?this.refreshAppPage(a):this._currentPageState.name===F.TEMPLATE_PAGE&&this.refreshTemplatePage(b)},getRefreshImageFlag:function(){return this._refreshImageFlag.getTime()},resetRefreshImageFlag:function(){this._refreshImageFlag=
new Date},_isAdminUser:function(a){var b=!1;if(a){var c=new E({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&c.setPrivileges(a.privileges);c.isAdmin()&&(b=!0)}return b},initApps:function(a){this.apps=this._filterItemByCondition(a);this.apps=this._mixinExtraProperties(this.apps)},initTemplates:function(a){this.templates=this._filterItemByCondition(a);this.templates=this._mixinExtraProperties(this.templates)},setApps:function(a){this.apps=a},setTemplates:function(a){this.templates=a},_filterItemByCondition:function(a){var b=
[];return b=t.filter(a,function(a){return window.isPortalSupport3D||a.appType!==F.APP_TYPE_3D?!0:!1},this)},_mixinExtraProperties:function(a){t.forEach(a,function(a){a.isTemplate||a.icon||(a.icon=a.themeName?"/webappbuilder/apps/"+a.id+"/themes/"+a.themeName+"/images/icon.png":"/webappbuilder/builder/images/logo.png",a._defaultIconClass="default-icon");a.downloadUrl="/webappbuilder/rest/apps/"+a.id+"/download";var b="stemapp/index.html?id\x3d"+a.id;a.isPredefined&&(b+="\x26ispredefined\x3dtrue");
a.appUrl=b;a.styleColor||(a.styleColor=F.DEFAULT_APP_STYLE_COLOR);a.id===F.ID_OF_BASIC_VIEWER_TEMPLATE?a.description=this.nls.basicViewerTemplateDesc:a.id===F.ID_OF_EDITOR_TEMPLATE?a.description=this.nls.editorTemplateDesc:a.id===F.ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE&&(a.description=this.nls.simpleMapViewerTemplateDesc)},this);return a},getAppList:function(){return w.getAppList()},getTemplateList:function(){return w.getTemplateList().then(function(a){return t.filter(a,function(a){return a.isTemplate})})},
updateApp:function(a){return w.updateApp(a)},_getLocaleDateTime:function(a){return z.localizeDate(new Date(a),{fullYear:!0,selector:"date",formatLength:"medium"})},filter:function(a){a=this._filterByType(a);a=this._filterBySearch(a);return a=this._filterByAuthor(a)},_filterByType:function(a){var b=[];return b=this._currentPageState.shownType===F.APP_TYPE_ALL?a:t.filter(a,function(a){return a.appType===this._currentPageState.shownType},this)},_filterBySearch:function(a){var b=[],c=this._currentPageState.searchKey.toLowerCase();
return c?(t.forEach(a,function(a){0<=(a.name+" "+a.description+""+this._getLocaleDateTime(a.lastUpdated)+" "+a.creator+" "+a.modified).toLowerCase().indexOf(c)&&b.push(a)},this),b):a},_filterByAuthor:function(a){var b=[],c=this._currentPageState.filterBy;"ownedByAnyone"===c?b=a:"ownedByMe"===c?b=a.filter(function(a){return a.creator===this.user.username},this):"notOwnedByMe"===c&&(b=a.filter(function(a){return a.creator!==this.user.username},this));return b},_sort:function(a){var b=this._currentPageState.sortBy;
a.sort(function(a,c){return a[b]&&c[b]?b===F.SORT_BY_MODIFIED_TIME?a[b]>c[b]?-1:1:a[b].localeCompare(c[b],window.dojoConfig.locale):a[b]?-1:1});return a},_resetAppStateUI:function(){f(".filter",this.filterBox).removeClass("selected");var a=f("#"+this._currentPageState.shownType,this.filterBox)[0];a&&g.addClass(a,"selected");f(".sort",this.sortBox).removeClass("selected");(a=f("#"+this._currentPageState.sortBy,this.sortBox)[0])&&g.addClass(a,"selected");this.searchBox.setValue(this._currentPageState.searchKey);
this.authorFilterSelector.setHighlightValue(this._currentPageState.filterBy);g.setAttr(this.authorFilter,"innerHTML",this.authorFilterSelector.getHighlightLabel())},_addEmptyDescription:function(a,b){a=g.create("div",{"class":"empty-description-box "+(b?b:"")},a);var c=this.nls.appCreate;b=G.substitute({action:"\x3cspan\x3e"+c+"\x3c/span\x3e"},this.nls.emptyDescForCreate);c=this.nls.appImport;c=G.substitute({action:"\x3cspan\x3e"+c+"\x3c/span\x3e"},this.nls.emptyDescForImport);g.create("div",{"class":"empty-description",
innerHTML:b+"\x3cbr\x3e"+c},a)},_bindEvent:function(){this.own(e.subscribe("switchToAppListApps",k.hitch(this,this._onSwitchToAppContent)));this.own(e.subscribe("switchToAppListTemplates",k.hitch(this,this._onSwitchToTemplateContent)))},_onSwitchToAppContent:function(){g.removeClass(this.templateContent,"selected");g.addClass(this.appContent,"selected");this._currentPageState=this._appPageState;this._resetAppStateUI();g.removeClass(this.switchAppPapgeBox,"hidden");g.setStyle(this.importDijit.itemImportBtn,
"display","block");g.setStyle(this.createNewBtn,"display","block");this._userIsAdmin||(g.setStyle(this.sortByAuthorBtn,"display","none"),g.setStyle(this.authorFilterBox,"display","none"));var a=g.byId("app_switch_of_header"),b=g.byId("template_switch_of_header");g.removeClass(b,"selected");g.addClass(a,"selected")},_onSwitchToTemplateContent:function(){g.removeClass(this.appContent,"selected");g.addClass(this.templateContent,"selected");this._currentPageState=this._tempaltePageState;this._resetAppStateUI();
g.addClass(this.switchAppPapgeBox,"hidden");g.setStyle(this.importDijit.itemImportBtn,"display","none");g.setStyle(this.createNewBtn,"display","none");g.setStyle(this.sortByAuthorBtn,"display","block");g.setStyle(this.authorFilterBox,"display","block");var a=g.byId("app_switch_of_header"),b=g.byId("template_switch_of_header");g.removeClass(a,"selected");g.addClass(b,"selected");null===this.templates&&this.refreshTemplatePage()},_onSearchBoxChange:function(){this._currentPageState.searchKey=this.searchBox.getValue();
this.refreshCurrentPage(!0,!0)},_onAuthorFilterClick:function(a){this.authorFilterSelector._onIconClick(a,this.authorFilterSelector.domNode)},_authorFilterChanged:function(a){g.setAttr(this.authorFilter,"innerHTML",this.authorFilterSelector.getHighlightLabel());this._currentPageState.filterBy=a;this.refreshCurrentPage(!0,!0)},_filterAllBtnClick:function(){this._filterAppTypeBtnClick(this.filterAllBtn,F.APP_TYPE_ALL)},_filter2dBtnClick:function(){this._filterAppTypeBtnClick(this.filter2dBtn,F.APP_TYPE_2D)},
_filter3dBtnClick:function(){this._filterAppTypeBtnClick(this.filter3dBtn,F.APP_TYPE_3D)},_filterAppTypeBtnClick:function(a,b){this._currentPageState.shownType!==b&&(f(".filter",this.filterBox).removeClass("selected"),g.addClass(a,"selected"),this._currentPageState.shownType=b,this.refreshCurrentPage(!0,!0))},_sortByModifiedTimeBtnClick:function(){this._sortBtnClick(this.sortByModifiedTimeBtn,F.SORT_BY_MODIFIED_TIME)},_sortByNameBtnClick:function(){this._sortBtnClick(this.sortByNameBtn,F.SORT_BY_NAME)},
_sortByAuthorBtnClick:function(){this._sortBtnClick(this.sortByAuthorBtn,F.SORT_BY_AUTHOR)},_sortBtnClick:function(a,b){this._currentPageState.sortBy!==b&&(this._currentPageState.sortBy=b,f(".sort",this.sortBox).removeClass("selected"),g.addClass(a,"selected"),this._currentPageState.name===F.APP_PAGE?this.setApps(this._sort(this.apps)):this._currentPageState.name===F.TEMPLATE_PAGE&&this.setTemplates(this._sort(this.templates)),this.refreshCurrentPage(!0,!0))},_onCreateClick:function(){var a=this.pluginManager.getExtensions("startup.creation-entry")[0],
a=this.pluginsMeta[a.pluginName];this.loading.show("");this.pluginManager.loadPlugin(a).then(k.hitch(this,function(a){a.popupNewCreateDlg();this.loading.hide()}),k.hitch(this,function(){this.loading.hide()}))}});k.mixin(F,{APP_TYPE_ALL:"ALL",APP_TYPE_2D:"HTML",APP_TYPE_3D:"HTML3D",SORT_BY_MODIFIED_TIME:"lastUpdated",SORT_BY_NAME:"name",SORT_BY_AUTHOR:"creator",FILTER_BY_OWNEDBYME:"ownedByMe",FILTER_BY_OWNEDBYANYONE:"ownedByAnyone",FILTER_BY_NOTOWNEDBYME:"notOwnedByMe",APP_PAGE:"appPage",TEMPLATE_PAGE:"templatePage",
DEFAULT_APP_STYLE_COLOR:"#596679",ID_OF_BASIC_VIEWER_TEMPLATE:"HTML_basic_viewer",ID_OF_EDITOR_TEMPLATE:"HTML_editor",ID_OF_SIMPLE_MAP_VIEWER_TEMPLATE:"HTML_simple_map_viewer"});return F})},"builder/plugins/app-list/Import":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Import.html dojo/on dojo/_base/lang dojo/sniff builder/serviceUtils dojo/query jimu/dijit/Message jimu/dijit/ItemSelector jimu/dijit/Popup builder/portalUtils builder/utils esri/lang builder/dijit/FullScreenPopup dojox/form/Uploader dojo/NodeList-dom".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){return p([t,v,n],{baseClass:"import-app",templateString:m,_itemSelector:null,_importPopup:null,nls:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading},startup:function(){this.inherited(arguments);this.own(u(window.document,"click",k.hitch(this,function(a){a.clickFromSelf||setTimeout(k.hitch(this,function(){g.setStyle(this.actionsMenu,"display","none");window.isRTL?g.setStyle(this.actionsMenu,
{left:"auto",right:0}):g.setStyle(this.actionsMenu,{right:"auto",left:0});g.removeClass(this.actionsNode,"actions-drop-down")}),50)})));this._applyZipToFileInput();this.appPortalUrlInputNode&&(this.appPortalUrlInputNode.value=window.portalUrl);this._keepFileChooserOverItem()},_applyZipToFileInput:function(){b('input[type\x3d"file"]',this.appFileInputNode.domNode).forEach(k.hitch(this,function(a){g.setAttr(a,"accept",".zip")}))},_keepFileChooserOverItem:function(){9>=f("ie")&&b("span.dijitUploader input:first-child",
this.domNode).forEach(k.hitch(this,function(a){window.isRTL?g.setStyle(a,{left:"33px",right:"auto"}):g.setStyle(a,"right","33px")}))},_onActionsLabelClick:function(a){var b=g.getMarginBox(window.jimuConfig.layoutId),c=null;"none"===g.getStyle(this.actionsMenu,"display")?(g.setStyle(this.actionsMenu,"display","block"),c=g.position(this.actionsMenu),window.isRTL?0>c.x&&g.setStyle(this.actionsMenu,{right:"auto",left:0}):c.x+c.w>b.w&&g.setStyle(this.actionsMenu,{left:"auto",right:0})):(g.setStyle(this.actionsMenu,
"display","none"),c=g.position(this.actionsMenu),window.isRTL?g.setStyle(this.actionsMenu,{left:"auto",right:0}):g.setStyle(this.actionsMenu,{right:"auto",left:0}));a.clickFromSelf=!0},_onMenuItemClick:function(a){setTimeout(k.hitch(this,function(){g.setStyle(this.actionsMenu,"display","none");g.removeClass(this.actionsNode,"actions-drop-down");a.stopPropagation()}),50)},_onAppFileUploadError:function(b){console.error(b);new a({message:q.localizeErrMessageByCode(b),buttons:[{label:this.nls.ok,onClick:k.hitch(this,
function(){location.reload()})}]});this._keepFileChooserOverItem();this._applyZipToFileInput();this.loading.hide()},_onAppFileUploadComplete:function(a){a.success?(location.reload(),this._refreshAppOrTemplatePage(a.app&&a.app.isTemplate),this._keepFileChooserOverItem(),this._applyZipToFileInput(),this.loading.hide()):this._onAppFileUploadError(a)},_onAppFileChange:function(){var b=this.appFileInputNode.getFileList();b&&0<b.length&&(/.+(\.zip)$/.test(b[0].name)?(this.loading.show(this.nls.uploading),
w.getPortal(window.portalUrl).getUser().then(k.hitch(this,function(a){g.setAttr(this.appFileCreatorInputNode,"value",a.username);g.setAttr(this.fromListNode,"value",this._currentShownList);this.appFileInputNode.submit(this.uploadAppFileFormNode)}),function(b){console.error(b);new a({message:b.message||b});this.loading.hide()})):new a({message:this.nls.fileTypeError}))},_onImportClick:function(){this._itemSelector=new c({portalUrl:window.portalUrl,itemTypes:["Web Mapping Application"],onlyShowOnlineFeaturedItems:!1,
typeKeywords:["Web AppBuilder"],showOnlineItems:!1});this.own(u(this._itemSelector,"item-selected",k.hitch(this,function(){this._importPopup.enableButton(0)})));this.own(u(this._itemSelector,"none-item-selected",k.hitch(this,function(){this._importPopup.disableButton(0)})));var a=b("#main-page")[0];this._importPopup=new z({zIndex:101,titleStr:this.nls.importApp,blurContainer:a.firstElementChild,content:this._itemSelector.domNode,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:k.hitch(this,this._onImportOkClick)},
{label:this.nls.cancel,isHighLight:!1,onClick:k.hitch(this,this._onImportCancelClick)}],contentAutoHeight:!0});this._importPopup.placeAt(a);this._importPopup.show();this._importPopup.disableButton(0);this._itemSelector.startup();this.own(u(this._itemSelector.tab,"tabChanged",k.hitch(this,function(){window.setTimeout(k.hitch(this,function(){this._importPopup.resize()},100))})));this.own(u(this._itemSelector,"update",k.hitch(this,function(){this._importPopup.resize()})))},_onImportOkClick:function(){var a=
this._itemSelector.getSelectedItem(),b=a.id;this.loading.show();w.getPortal(window.portalUrl).getUser().then(k.hitch(this,function(c){a.getItemData().then(k.hitch(this,function(f){this.loading.hide();this._importPopup.close();f=k.clone(f);e.switchImageFormatOfAppConfig({appConfig:f,appId:b},"import").then(k.hitch(this,function(b){this._checkAppVersion(b.appConfig,{creator:c.username,name:a.title,description:a.description||"",appType:a.typeKeywords&&0<=a.typeKeywords.indexOf("WAB3D")?"HTML3D":"HTML",
stemappPath:this.appListWidget.pluginManager.getStemappInfo("HTML").appPath,portalUrl:window.portalUrl,isTemplate:!1,isTemplateApp:!1,isPredefined:!1})}),k.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),k.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))}),k.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppVersion:function(a,b){this.loading.show(this.nls.importing);e.checkAppVersion(a,b).then(k.hitch(this,
function(c){this.loading.hide();c=c.versionInfo;"old"===c.wabVersionStatus?this._doAction("upgrade",a,b):"new"===c.wabVersionStatus?this._showNewer(b.name,c.appVersion):"same"===c.wabVersionStatus&&this._doAction("import",a,b)}),k.hitch(this,function(b){this.loading.hide();this._checkAppInfoError(a.title,b)}))},_checkAppInfoError:function(b,c){new a({message:C.substitute({APP_NAME:b},this.nls.checkVersionError)});console.error(c)},_showUpgrade:function(a,b,c){c="\x3cdiv style\x3d'font-size:14px;overflow:hidden'\x3e"+
C.substitute({OLD_VERSION:c.appVersion,LATEST_VERSION:c.latestVersion},this.nls.upgradeContent)+"\x3cdiv style\x3d'height:24px;'\x3e\x3c/div\x3e"+this.nls.upgradeContentFooter+"\x3c/div\x3e";var e=new x({titleLabel:this.nls.upgradeApp,content:g.toDom(c),width:640,autoHeight:!0,buttons:[{label:this.nls.upgradeBtn,onClick:k.hitch(this,function(){e.close();this._doAction("upgrade",a,b)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:k.hitch(this,function(){e.close()})}]})},_showNewer:function(a,
b){a="\x3cdiv style\x3d'font-size:14px;overflow:hidden'\x3e"+C.substitute({APP_NAME:a,VERSION_NUMBER:b},this.nls.importUpperVertion)+"\x3c/div\x3e";new x({titleLabel:this.nls.importApp,content:g.toDom(a),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})},_doAction:function(a,b,c){"import"===a?this.loading.show(this.nls.importing):"upgrade"===a&&this.loading.show(this.nls.upgrading);e.importPortalApp(b,c).then(k.hitch(this,function(){this._importSuccess(c.appName)}),k.hitch(this,function(a){this.loading.hide();
this._importError(c.appName,a)}))},_importSuccess:function(a){this.appListWidget.getAppList().then(k.hitch(this,function(){this._refreshAppOrTemplatePage(!1);var b="\x3cdiv style\x3d'font-size:14px;overflow:hidden'\x3e"+C.substitute({APP_NAME:a},this.nls.importSuccess)+"\x3c/div\x3e";new x({titleLabel:this.nls.importApp,content:g.toDom(b),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]})}),k.hitch(this,function(a){console.error(a)})).always(k.hitch(this,function(){this.loading.hide()}))},_importError:function(a,
b){a="\x3cdiv style\x3d'font-size:14px;overflow:hidden'\x3e"+C.substitute({APP_NAME:a},this.nls.upgradeFailure)+"\x3c/div\x3e";new x({titleLabel:this.nls.importApp,content:g.toDom(a),width:640,autoHeight:!0,buttons:[{label:this.nls.ok}]});console.error(b)},_onImportCancelClick:function(){this._importPopup.close()},_refreshAppOrTemplatePage:function(a){a?(this.appListWidget._onSwitchToTemplateContent(),this.appListWidget.refreshTemplatePage()):(this.appListWidget._onSwitchToAppContent(),this.appListWidget.refreshAppPage())}})})},
"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K){return p([t,v,n,K,u],{templateString:m,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=B.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";e.forEach(this.itemTypes,k.hitch(this,function(a,b){this._itemTypes+=
'"'+a+'"';b!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";e.forEach(this.typeKeywords,k.hitch(this,function(a,b){this._typeKeywords+='"'+a+'"';b!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();
this.portal=z.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=C.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=C.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var a={title:this.nls.myContent,content:this.mycontentTabNode},c={title:this.nls.myOrganization,content:this.organizationTabNode},
e={title:this.nls.myGroup,content:this.groupTabNode},f={title:this.nls.publicMap,content:this.publicTabNode};q.set(this.mycontentTabNode,"display","none");q.set(this.organizationTabNode,"display","none");q.set(this.groupTabNode,"display","none");q.set(this.publicTabNode,"display","none");var g=[];this.showMyContent&&(g.push(a),q.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(g.push(c),q.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(g.push(e),q.set(this.groupTabNode,
"display","block"));this.showPublic&&(g.push(f),q.set(this.publicTabNode,"display","block"));this.tab=new D({tabs:g},this.tabNode);this.own(w(this.tab,"tabChanged",k.hitch(this,function(a){b.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){b.setStyle(this.signinSection,"display","none");var a=x(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);E.userHaveSignInPortal(this._getPortalUrl())?a.style("display","block"):(a.style("display","none"),this._isPublicTabShow||b.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var a=this._getPortalUrl(),a=B.getServerByUrl(a);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var c=!1;B.isArcGIScom(a)?(c=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
a,c=this.showOnlineItems?!1:!0);c&&(this.onlinePublicRaido.set("disabled",!0),b.setStyle(this.onlinePublicRaido,"display","none"),b.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(f.locale&&f.locale.slice(0,2)||"en").toLowerCase(),b=e.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
k.hitch(this,function(b){return b!==a})),c="";e.forEach(b,k.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._itemTypeQueryString+" AND access:public "+c+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:b});this._filterPublicPortalQuery=this._getQuery({q:b,basicQ:b});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return k.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return B.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(w(this.publicPortalItemTable,"item-dom-clicked",k.hitch(this,this._onItemDomClicked)));this.own(w(this.publicOnlineItemTable,"item-dom-clicked",k.hitch(this,this._onItemDomClicked)));this.own(w(this.organizationItemTable,"item-dom-clicked",k.hitch(this,this._onItemDomClicked)));this.own(w(this.groupItemTable,"item-dom-clicked",k.hitch(this,this._onItemDomClicked)));
this.own(w(this.mycontentItemTable,"item-dom-clicked",k.hitch(this,this._onItemDomClicked)));this.own(w(this.publicPortalItemTable,"update",k.hitch(this,this._onItemTableUpdate)));this.own(w(this.publicOnlineItemTable,"update",k.hitch(this,this._onItemTableUpdate)));this.own(w(this.organizationItemTable,"update",k.hitch(this,this._onItemTableUpdate)));this.own(w(this.groupItemTable,"update",k.hitch(this,this._onItemTableUpdate)));this.own(w(this.mycontentItemTable,"update",k.hitch(this,this._onItemTableUpdate)));
var a=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(w(this.portalPublicRaido,"click",k.hitch(this,this._onPublicRaidoClicked)));this.own(w(this.onlinePublicRaido,"click",k.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(a){(a=a&&k.trim(a))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(w(this.groupsSelect,"change",k.hitch(this,this._onGroupsSelectChange)));var a=B.getServerByUrl(this._getPortalUrl());B.isArcGIScom(a)&&(a="ArcGIS.com");E.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&k.trim(a)){if(this._allOrganizationQuery){var b=this._allOrganizationQuery.q;b&&(this._filterOrganizationQuery.q=a+" "+b,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&k.trim(a)){if(this._allMyContentQuery){var b=this._allMyContentQuery.q;b&&(this._filterMyContentQuery.q=a+" "+
b,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(a){if(a=a&&k.trim(a)){if(this._allGroupQuery){var b=this._allGroupQuery.q;b&&(this._filterGroupQuery.q=a+" "+b,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var a=this._getPortalUrl();z.getPortal(a).getUser().then(k.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();a=" orgid:"+a.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",b);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",b);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();b.setStyle(this.groupsSection,"display","flex");a=a.getGroups();if(0<a.length){b.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();b.empty(this.groupsSelect);for(var c=0;c<a.length;c++){var e=a[c];b.create("option",
{value:e.id,innerHTML:e.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){b.setStyle(this.groupsSection,"display","none");b.empty(this.groupsSelect);b.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();b.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?b.setStyle(this.groupsSection,
"top","15px"):b.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)b.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{b.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var c=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",c);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(a){var c=b.hasClass(a,"jimu-state-active");x(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");c&&b.addClass(a,"jimu-state-active");(a=this.getSelectedItem())?this.emit("item-selected",a):this.emit("none-item-selected")},getSelectedItem:function(){var a=null,b=x(".item.jimu-state-active",this.domNode);
0<b.length&&(a=k.mixin({},b[0].item));return a}})})},"jimu/dijit/Search":function(){define("dojo/_base/declare dojo/_base/html dojo/string dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,g,t,v,n,m){return p([n,m],{baseClass:"jimu-search",declaredClass:"jimu.dijit.Search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
placeholder:"",onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&g.setAttr(this.inputSearch,"placeholder",this.placeholder)},getValue:function(){return t.trim(this.inputSearch.value)},doSearch:function(){if(this.onSearch)this.onSearch(this.getValue())},_onKeyDown:function(g){this.doChange();(void 0!==g.keyCode?g.keyCode:g.which)===v.ENTER&&this.doSearch();g.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()},
doChange:function(){if(this.onChange)this.onChange(this.getValue())}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p([k,f,m],{templateString:e,baseClass:"jimu-tab3",declaredClass:"jimu.dijit.TabContainer3",_currentIndex:-1,selected:"",tabs:null,
average:!0,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(a){var b=u("td",this.tabTr);t.forEach(b,g.hitch(this,function(b,c){v.removeClass(b,"jimu-state-active");b.label===a&&(v.addClass(b,"jimu-state-active"),this._currentIndex=c)}));this.controlNode.removeChild(this.controlTable);v.place(this.controlTable,this.controlNode);this.viewStack.switchView(a);this.emit("tabChanged",
a)},addTab:function(a){if(!this.average){var b=u("td:last-child",this.tabTr);0<b.length&&v.destroy(b[0])}0<t.filter(this.tabs,function(b){return b.title===a.title}).length?console.error("tab title conflict: "+a.title):(this.tabs.push(a),this._createTab(a),this.average||(b=v.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'),v.place(b,this.tabTr)))},removeTab:function(a){var b=-1;if(t.some(this.tabs,function(c,
e){if(c.title===a)return b=e,!0})){var e=this.tabs.splice(b,1)[0],f=u("td",this.tabTr),g;t.some(f,function(b){if(b.label===a)return g=b,!0})&&v.destroy(g);this.viewStack.removeView(e.content)}},showShelter:function(){v.setStyle(this.shelter,"display","block")},hideShelter:function(){v.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new b(null,this.containerNode);
t.forEach(this.tabs,function(a){this._createTab(a)},this);if(this.average)this.controlTable.style.tableLayout="fixed",v.addClass(this.domNode,"average");else{var a=v.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');v.place(a,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(a){var b=v.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');
b.label=a.title||"";b.title=a.title;v.place(b,this.tabTr);var e=u(".tab-item-div",b)[0];e.innerHTML=b.label;e.label=b.label;a.content.label=b.label;this.viewStack.addView(a.content);this.own(n(b,"click",g.hitch(this,this._onSelect,a.title)))},_onSelect:function(a){this.selectTab(a)}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){return p([g,t,v,m],{templateString:n,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&
0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=w.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},show:function(){f.setStyle(this.domNode,"display","block")},hide:function(){f.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=u.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&
(this.allItemsShelter.show(),x.getPortal(this.portalUrl).queryItems(this.query).then(u.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),u.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=u.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&
0<this.filteredQuery.start&&(this.filteredItemShelter.show(),x.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(u.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),u.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?
(f.setStyle(this.filteredItemsTableDiv,"display","block"),f.setStyle(this.searchNoneTipSection,"display","none")):(f.setStyle(this.filteredItemsTableDiv,"display","none"),f.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){f.empty(this.allItemTbody)},clearFilteredItemsSection:function(){f.empty(this.filteredItemsTbody)},showAllItemsSection:function(){f.setStyle(this.allItemsSection,
"display","block");f.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){f.setStyle(this.allItemsSection,"display","none");f.setStyle(this.filteredItemsSection,"display","block");f.setStyle(this.filteredItemsTableDiv,"display","block");f.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&
this.searchFilteredItems()},_isScrollToBottom:function(a){return c.isScrollToBottom(a)},_createItems:function(a,c){a=a.results;var e=k.map(this.types,u.hitch(this,function(a){return a.toLowerCase()}));a=k.filter(a,u.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=k.indexOf(e,a)}));if(0!==a.length){var g,m=b("td.empty",c),n;if(0<m.length){var p=Math.min(a.length,m.length),q=a.splice(0,p);for(n=0;n<p;n++){var w=m[n];g=this._createItem(q[n]);f.place(g,w);f.removeClass(w,"empty")}}if(0!==
a.length){m=Math.ceil(a.length/2);for(n=0;n<m;n++)for(g=f.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),f.place(g,c),p=b("td",g),q=0;q<p.length;q++)w=p[q],(g=a[2*n+q])?(g=this._createItem(g),f.place(g,w)):f.addClass(w,"empty");this.emit("update")}}},_getItemCount:function(a){return b(".item",a).length},_createItem:function(a){var c=f.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;var e=b(".item-thumbnail",c)[0],g=b(".item-name",c)[0],k=b(".item-type-owner",c)[0],m=b(".item-date",c)[0],n=b(".item-details",c)[0],p=b(".none-thumbnail-tip",c)[0];if(!a.thumbnailUrl){var q=this._defaultThumbnail[a.type];q&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+q)}a.thumbnailUrl?f.setStyle(e,"backgroundImage","url("+a.thumbnailUrl+")"):p.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(m=b(".item-info",c)[0],this.onCreateItemContent(a,m)):(g.innerHTML=
a.title,g.title=g.innerHTML,k.innerHTML=a.type+" by "+a.owner,k.title=k.innerHTML,e=new Date,e.setTime(a.modified),m.innerHTML=e.toLocaleString(),m.title=m.innerHTML,n.innerHTML=this.nls.moreDetails,n.href=a.detailsPageUrl||"#");return c},_onItemsTableClicked:function(a){var c=a.target||a.srcElement;a=null;f.hasClass(c,"item-thumbnail")?a=c.parentNode:f.hasClass(c,"none-thumbnail-tip")&&(a=c.parentNode.parentNode);a&&(c=f.hasClass(a,"jimu-state-active"),b(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
c?f.removeClass(a,"jimu-state-active"):f.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,c=b(".item.jimu-state-active",this.domNode);0<c.length&&(a=u.mixin({},c[0].item));return a}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(p,g,t,v){return p(g,{baseClass:"jimu-loading-indicator jimu-agol-loading",declaredClass:"jimu.dijit.LoadingIndicator",hidden:!1,
postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&t.set(this.domNode,{display:"none"});t.set(this.domNode,{width:"100%",height:"100%"});v.place(' \x3cdiv class\x3d"loading-container"\x3e\x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\x3c/div\x3e\x3c/div\x3e',this.domNode)},show:function(){this.domNode&&this.hidden&&(t.set(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(t.set(this.domNode,"display","none"),
this.hidden=!0)}})})},"jimu/dijit/BindLabelPropsMixin":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/query","dojo/_base/array","jimu/utils"],function(p,g,t,v,n){return p("jimu-bind-label-props-mixin",null,{isRenderIdForAttrs:!1,buildRendering:function(){this.inherited(arguments);if(this.isRenderIdForAttrs){var m=t("[data-a11y-label-id],[data-a11y-label-by], [data-label-for], [data-label-id]",this.domNode),p={},k={};v.forEach(m,function(a){var b=g.getAttr(a,"data-a11y-label-id"),
c=g.getAttr(a,"data-a11y-label-by"),e=g.getAttr(a,"data-label-for"),f=g.getAttr(a,"data-label-id");b?p.hasOwnProperty(b)?p[b].labelList.push(a):(p[b]={},p[b].labelList=[a]):c?(p.hasOwnProperty(c)||(p[c]={},p[c].labelList=[]),p[c].labelledBy=a):e?(k.hasOwnProperty(e)||(k[e]={}),k[e].forDom=a):(k.hasOwnProperty(f)||(k[f]={}),k[f].idDom=a)});for(var f in p){var e=[],b="jimuUniqName_"+n.getUUID();v.forEach(p[f].labelList,function(a,c){c=b+"_"+c;g.removeAttr(a,"data-a11y-label-id");g.setAttr(a,"id",c);
e.push(c)});m=p[f].labelledBy;g.removeAttr(m,"data-a11y-label-by");g.setAttr(m,"aria-labelledby",e.join(" "))}for(var a in k){f="jimuUniqName_"+n.getUUID();var m=k[a].forDom,c=k[a].idDom;g.removeAttr(m,"data-label-for");g.removeAttr(c,"data-label-id");g.setAttr(m,"for",f);g.setAttr(c,"id",f)}}}})})},"builder/dijit/FullScreenPopup":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dom-attr dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FullScreenPopup.html dojo/on dojo/throttle".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){return g([k,f,e],{templateString:b,baseClass:"fullscreen-popup-container",isShow:!1,position:{},_zIndexIncrease:0,_btns:[],postCreate:function(){this.inherited(arguments);this._btns=[];this.outerMainPage=this.blurContainer?this.blurContainer:null;this._zIndexIncrease=this.zIndex?this.zIndex:1;m.set(this.domNode,"z-index",this._zIndexIncrease++);m.set(this.background,"display","block");m.set(this.background,"z-index",this._zIndexIncrease++);m.set(this.main,"z-index",
this._zIndexIncrease++);m.set(this.fullscreenPopupBtns,"z-index",this._zIndexIncrease++);if(this.buttons)for(var b=0,e=this.buttons.length;b<e;b++){var f=this.buttons[b],g=t.create("input",{"class":"btn",type:"button",value:f.label},this.fullscreenPopupBtns);f.isHighLight&&v.add(g,"light");f.onClick&&this.own(a(g,"click",f.onClick));this._btns.push(g)}this.contentAutoHeight&&v.add(this.main,"autoHeight");this.own(a(window,"resize",c(p.hitch(this,this.resize)),50));this.own(a(this.fullscreenPopupContent,
"DOMNodeInserted,DOMNodeRemoved",c(p.hitch(this,this.resize)),100))},startup:function(){this.hide();this.refresh()},destroy:function(){this.subDijit&&(this.subDijit.destroy(),this.subDijit=null);this._btns=[];t.destroy(this.domNode);this.inherited(arguments)},refresh:function(){this.fullscreenPopupTitle.innerHTML=this.titleStr;n.place(this.content,this.fullscreenPopupContent);this.resize()},show:function(){t.setStyle(this.domNode,"display","block");this.isShow=!0;this.refresh()},hide:function(){t.setStyle(this.domNode,
"display","none");v.remove(this.outerMainPage,"glass-blur");this.isShow=!1;this.destroy()},enableButton:function(a){a=this._btns[a];u.remove(a,"disabled");t.removeClass(a,"disabled");return a},disableButton:function(a){a=this._btns[a];u.set(a,{disabled:"disabled"});t.addClass(a,"disabled");return a},close:function(){this._onCloseClick()},setTitle:function(a){a&&(this.fullscreenPopupTitle.innerHTML=a)},setSubTitle:function(a){},resize:function(){this.btnsAtuoBottom&&this._setBtnsAutoBottom();this.contentAutoHeight&&
this._setContentAutoHeight()},_onContainerClick:function(a){a.stopPropagation();return!1},_onCloseClick:function(){this.hide()},_ieBlurPolyfill:function(){},_setBtnsAutoBottom:function(){var a=this.head;this._footerMarginTop||(this._footerMarginTop=m.get(this.fullscreenPopupBtns,"margin-top"));this._footerPaddingTopHeight||(this._footerPaddingTopHeight=m.get(this.fullscreenPopupBtnsContainer,"padding-top"));this._footerPaddingBottomHeight||(this._footerPaddingBottomHeight=m.get(this.fullscreenPopupBtnsContainer,
"padding-bottom"));this._footerHeight||(this._footerHeight=m.get(this.fullscreenPopupBtns,"height"));document.body.clientHeight-a.clientHeight-(this._footerMarginTop+this._footerHeight+this._footerPaddingTopHeight+this._footerPaddingBottomHeight)<this.fullscreenPopupContent.scrollHeight?(m.set(this.contentScroller,"height",document.body.clientHeight-a.clientHeight-this._footerMarginTop-this._footerPaddingTopHeight-this._footerPaddingBottomHeight+"px"),m.set(this.fullscreenPopupBtns,"margin-top","0")):
(m.set(this.contentScroller,"height",this.fullscreenPopupContent.scrollHeight+"px"),m.set(this.fullscreenPopupBtns,"margin-top",this._footerMarginTop+"px"))},_setContentAutoHeight:function(){v.add(this.main,"autoHeight");var a=this.head.scrollHeight,b=this.fullscreenPopupBtnsContainer.scrollHeight,c=m.get(this.fullscreenPopupBtns,"margin-top");m.set(this.contentScroller,"height",document.body.clientHeight-a-b-c+"px")}})})},"dojo/throttle":function(){define([],function(){return function(p,g){var t=
!0;return function(){t&&(t=!1,p.apply(this,arguments),setTimeout(function(){t=!0},g))}}})},"dojox/form/Uploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/dom-style dojo/dom-class dojo/dom-geometry dojo/dom-attr dojo/dom-construct dojo/dom-form dijit dijit/form/Button ./uploader/_Base ./uploader/_HTML5 ./uploader/_IFrame ./uploader/_Flash dojo/i18n!./nls/Uploader dojo/text!./resources/Uploader.html".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B){return g("dojox.form.Uploader",[w,x,q,C,z],{uploadOnSelect:!1,tabIndex:0,multiple:!1,label:E.label,url:"",name:"uploadedfile",flashFieldName:"",force:"",uploadType:"",showInput:"",focusedClass:"dijitButtonHover",_nameIndex:0,templateString:B,baseClass:"dijitUploader "+x.prototype.baseClass,postMixInProperties:function(){this._inputs=[];this._cons=[];this.force=this.force.toLowerCase();this.supports("multiple")?this.uploadType="form"===this.force?"form":
"html5":this.uploadType="flash"===this.force?"flash":"iframe";this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);u.set(this.domNode,{overflow:"hidden",position:"relative"});this._buildDisplay();e.set(this.titleNode,"tabIndex",-1)},_buildDisplay:function(){this.showInput&&(this.displayInput=b.create("input",{"class":"dijitUploadDisplayInput",tabIndex:-1,autocomplete:"off",role:"presentation"},this.containerNode,this.showInput),this._attachPoints.push("displayInput"),this.connect(this,
"onChange",function(a){for(var b=0,c,e=[];c=a[b++];)c&&c.name&&e.push(c.name);this.displayInput.value=e.join(", ")}),this.connect(this,"reset",function(){this.displayInput.value=""}))},startup:function(){this._buildInitialized||(this._buildInitialized=!0,this._getButtonStyle(this.domNode),this._setButtonStyle(),this.inherited(arguments))},onChange:function(a){},onBegin:function(a){},onProgress:function(a){},onComplete:function(a){this.reset()},onCancel:function(){},onAbort:function(){},onError:function(a){},
upload:function(a){a=a||{};a.uploadType=this.uploadType;this.inherited(arguments)},submit:function(b){b=b?b.tagName?b:this.getForm():this.getForm();b=a.toObject(b);b.uploadType=this.uploadType;this.upload(b)},reset:function(){delete this._files;this._disconnectButton();v.forEach(this._inputs,b.destroy);this._inputs=[];this._nameIndex=0;this._createInput()},getFileList:function(){var a=[];this.supports("multiple")?v.forEach(this._files,function(b,c){a.push({index:c,name:b.name,size:b.size,type:b.type})},
this):v.forEach(this._inputs,function(b,c){b.value&&a.push({index:c,name:b.value.substring(b.value.lastIndexOf("\\")+1),size:0,type:b.value.substring(b.value.lastIndexOf(".")+1)})},this);return a},_getValueAttr:function(){return this.getFileList()},_setValueAttr:function(a){console.error("Uploader value is read only")},_setDisabledAttr:function(a){this.disabled!=a&&this.inputNode&&(this.inherited(arguments),u.set(this.inputNode,"display",a?"none":""))},_getButtonStyle:function(a){this.btnSize={w:u.get(a,
"width"),h:u.get(a,"height")}},_setButtonStyle:function(){this.inputNodeFontSize=Math.max(2,Math.max(Math.ceil(this.btnSize.w/60),Math.ceil(this.btnSize.h/15)));this._createInput()},_getFileFieldName:function(){return this.supports("multiple")&&this.multiple?this.name+"s[]":this.name+(this.multiple?this._nameIndex:"")},_createInput:function(){this._inputs.length&&(u.set(this.inputNode,{top:"500px"}),this._disconnectButton(),this._nameIndex++);var a=this._getFileFieldName();this.focusNode=this.inputNode=
b.create("input",{type:"file",name:a,"aria-labelledby":this.id+"_label"},this.domNode,"first");this.supports("multiple")&&this.multiple&&e.set(this.inputNode,"multiple",!0);this._inputs.push(this.inputNode);u.set(this.inputNode,{position:"absolute",fontSize:this.inputNodeFontSize+"em",top:"-3px",right:"-3px",opacity:0});this._connectButton()},_connectButton:function(){this._cons.push(n.connect(this.inputNode,"change",this,function(a){this._files=this.inputNode.files;this.onChange(this.getFileList(a));
!this.supports("multiple")&&this.multiple&&this._createInput()}));-1<this.tabIndex&&(this.inputNode.tabIndex=this.tabIndex,this._cons.push(n.connect(this.inputNode,"focus",this,function(){k.add(this.domNode,this.focusedClass)})),this._cons.push(n.connect(this.inputNode,"blur",this,function(){k.remove(this.domNode,this.focusedClass)})))},_disconnectButton:function(){v.forEach(this._cons,n.disconnect);this._cons.splice(0,this._cons.length)}})})},"dojox/form/uploader/_Base":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/has dojo/_base/declare dojo/_base/event dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin".split(" "),
function(p,g,t,v,n,m,u,k,f,e){n.add("FormData",function(){return!!window.FormData});n.add("xhr-sendAsBinary",function(){var b=window.XMLHttpRequest&&new window.XMLHttpRequest;return b&&!!b.sendAsBinary});n.add("file-multiple",function(){return!!{"true":1,"false":1}[v.get(document.createElement("input",{type:"file"}),"multiple")]});return m("dojox.form.uploader._Base",[k,f,e],{getForm:function(){if(!this.form)for(var b=this.domNode;b&&b.tagName&&b!==document.body;){if("form"==b.tagName.toLowerCase()){this.form=
b;break}b=b.parentNode}return this.form},getUrl:function(){this.uploadUrl&&(this.url=this.uploadUrl);if(this.url)return this.url;this.getForm()&&(this.url=this.form.action);return this.url},connectForm:function(){this.url=this.getUrl();!this._fcon&&this.getForm()&&(this._fcon=!0,this.connect(this.form,"onsubmit",function(b){console.log("SUBMIT");u.stop(b);this.submit(this.form)}))},supports:function(b){switch(b){case "multiple":if("flash"==this.force||"iframe"==this.force)break;return n("file-multiple");
case "FormData":return n(b);case "sendAsBinary":return n("xhr-sendAsBinary")}return!1},getMimeType:function(){return"application/octet-stream"},getFileType:function(b){return b.substring(b.lastIndexOf(".")+1).toUpperCase()},convertBytes:function(b){var a=Math.round(b/1024*1E5)/1E5,c=Math.round(b/1048576*1E5)/1E5,e=Math.round(b/1073741824*1E5)/1E5,f=b;1<a&&(f=a.toFixed(1)+" kb");1<c&&(f=c.toFixed(1)+" mb");1<e&&(f=e.toFixed(1)+" gb");return{kb:a,mb:c,gb:e,bytes:b,value:f}}})})},"dojox/form/uploader/_HTML5":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo dojo/request dojo/has".split(" "),
function(p,g,t,v,n,m){return p("dojox.form.uploader._HTML5",[],{errMsg:"Error uploading files. Try checking permissions",uploadType:"html5",postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.connectForm();this.inherited(arguments);this.uploadOnSelect&&this.connect(this,"onChange",function(g){this.upload(g[0])})},_drop:function(g){v.stopEvent(g);this._files=g.dataTransfer.files;this.onChange(this.getFileList())},upload:function(g){this.onBegin(this.getFileList());
this.uploadWithFormData(g)},addDropTarget:function(g,k){k||(this.connect(g,"dragenter",v.stopEvent),this.connect(g,"dragover",v.stopEvent),this.connect(g,"dragleave",v.stopEvent));this.connect(g,"drop","_drop")},uploadWithFormData:function(g){function k(b){a._xhrProgress(b);"load"===b.type&&(a.onComplete(c.response.data),c.response.xhr.removeEventListener("load",k,!1),c.response.xhr.upload.removeEventListener("progress",k,!1),c=null)}if(this.getUrl()){var f=new FormData,e=this._getFileFieldName();
t.forEach(this._files,function(a,b){f.append(e,a)},this);if(g){g.uploadType=this.uploadType;for(var b in g)f.append(b,g[b])}var a=this,c=n(this.getUrl(),{method:"POST",data:f,handleAs:"json",uploadProgress:!0,headers:{Accept:"application/json"}},!0);c.promise.response.otherwise(function(b){console.error(b);console.error(b.response.text);a.onError(b)});m("native-xhr2")?(c.response.xhr.addEventListener("load",k,!1),c.response.xhr.upload.addEventListener("progress",k,!1)):c.promise.then(function(b){a.onComplete(b)})}else console.error("No upload url found.",
this)},_xhrProgress:function(g){if(g.lengthComputable){var k={bytesLoaded:g.loaded,bytesTotal:g.total,type:g.type,timeStamp:g.timeStamp};"load"==g.type?(k.percent="100%",k.decimal=1):(k.decimal=g.loaded/g.total,k.percent=Math.ceil(g.loaded/g.total*100)+"%");this.onProgress(k)}}})})},"dojox/form/uploader/_IFrame":function(){define("dojo/query dojo/dom-construct dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-form dojo/request/iframe".split(" "),function(p,g,t,v,n,m,u){return t("dojox.form.uploader._IFrame",
[],{postMixInProperties:function(){this.inherited(arguments);"iframe"===this.uploadType&&(this.uploadType="iframe",this.upload=this.uploadIFrame)},uploadIFrame:function(k){var f={},e;this.getForm();var b=this.getUrl(),a=this;k=k||{};k.uploadType=this.uploadType;e=g.place('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e\x3c/form\x3e',this.domNode);n.forEach(this._inputs,function(a,b){""!==a.value&&(e.appendChild(a),f[a.name]=a.value)},this);if(k)for(nm in k)void 0===f[nm]&&g.create("input",
{name:nm,value:k[nm],type:"hidden"},e);u.post(b,{form:e,handleAs:"json",content:k}).then(function(b){g.destroy(e);if(b.ERROR||b.error)a.onError(b);else a.onComplete(b)},function(b){console.error("error parsing server result",b);g.destroy(e);a.onError(b)})}})})},"dojox/form/uploader/_Flash":function(){define("dojo/dom-form dojo/dom-style dojo/dom-construct dojo/dom-attr dojo/_base/declare dojo/_base/config dojo/_base/connect dojo/_base/lang dojo/_base/array dojox/embed/Flash".split(" "),function(p,
g,t,v,n,m,u,k,f,e){return n("dojox.form.uploader._Flash",[],{swfPath:m.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),preventCache:!0,skipServerCheck:!0,serverTimeout:2E3,isDebug:!1,devMode:!1,deferredUploading:0,postMixInProperties:function(){"flash"===this.uploadType&&(this._files=[],this._fileMap={},this._createInput=this._createFlashUploader,this.getFileList=this.getFlashFileList,this.reset=this.flashReset,this.upload=this.uploadFlash,this.fieldname="flashUploadFiles");this.inherited(arguments)},
onReady:function(b){},onLoad:function(b){},onFileChange:function(b){},onFileProgress:function(b){},getFlashFileList:function(){return this._files},flashReset:function(){this.flashMovie.reset();this._files=[];this._fileMap={}},uploadFlash:function(b){this.onBegin(this.getFileList());b=b||{};b.returnType="F";b.uploadType=this.uploadType;console.log("flas upload",b);this.flashMovie.doUpload(b)},_change:function(b){this._files=this._files.concat(b);f.forEach(b,function(a){a.bytesLoaded=0;a.bytesTotal=
a.size;this._fileMap[a.name+"_"+a.size]=a},this);this.onChange(this._files);this.onFileChange(b)},_complete:function(b){this._getCustomEvent().type="load";this.onComplete(b)},_progress:function(b){this._fileMap[b.name+"_"+b.bytesTotal].bytesLoaded=b.bytesLoaded;var a=this._getCustomEvent();this.onFileProgress(b);this.onProgress(a)},_error:function(b){this.onError(b)},_onFlashBlur:function(b){},_getCustomEvent:function(){var b={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:(new Date).getTime()},
a;for(a in this._fileMap)b.bytesTotal+=this._fileMap[a].bytesTotal,b.bytesLoaded+=this._fileMap[a].bytesLoaded;b.decimal=b.bytesLoaded/b.bytesTotal;b.percent=Math.ceil(b.bytesLoaded/b.bytesTotal*100)+"%";return b},_connectFlash:function(){this._subs=[];this._cons=[];var b=k.hitch(this,function(a,b){this._subs.push(u.subscribe(this.id+a,this,b))});b("/filesSelected","_change");b("/filesUploaded","_complete");b("/filesProgress","_progress");b("/filesError","_error");b("/filesCanceled","onCancel");b("/stageBlur",
"_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&v.set(this.domNode,"tabIndex",this.tabIndex)},_createFlashUploader:function(){var b=this.btnSize.w,a=this.btnSize.h;if(b){var c=this.getUrl();if(c){if(0>c.toLowerCase().indexOf("http")&&0!=c.indexOf("/")){var f=window.location.href.split("/");f.pop();f=f.join("/")+"/";c=f+c}}else console.warn("Warning: no uploadUrl provided.");this.inputNode=t.create("div",{className:"dojoxFlashNode"},
this.domNode,"first");g.set(this.inputNode,{position:"absolute",top:"-2px",width:b+"px",height:a+"px",opacity:0});b={expressInstall:!0,path:(this.swfPath.uri||this.swfPath)+(this.preventCache?"?cb_"+(new Date).getTime():""),width:b,height:a,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:c,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,
noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new e(b,this.inputNode);this.flashObject.onError=k.hitch(function(a){console.error("Flash Error: "+a)});this.flashObject.onReady=k.hitch(this,function(){this.onReady(this)});this.flashObject.onLoad=k.hitch(this,function(a){this.flashMovie=a;this.flashReady=!0;this.onLoad(this)});this._connectFlash()}else setTimeout(dojo.hitch(this,
function(){this._getButtonStyle(this.domNode);this._createFlashUploader()}),200)}})})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(p,g,t,v,n,m,u,k,f){function e(a){a=p.delegate(x,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),null;"id"in a||(a.id="dojox-embed-flash-"+c++);return a}var b,a,c=0,x={expressInstall:!1,
width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};n("ie")?(b=function(a){a=e(a);if(!a)return null;var b,c=a.path;if(a.vars){var g=[];for(b in a.vars)g.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.FlashVars=g.join("\x26");delete a.vars}c='\x3cobject id\x3d"'+f.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+f.escape(String(a.width))+'" height\x3d"'+f.escape(String(a.height))+
'"'+(a.style?' style\x3d"'+f.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+f.escape(String(c))+'" /\x3e';if(a.params)for(b in a.params)c+='\x3cparam name\x3d"'+f.escape(b)+'" value\x3d"'+f.escape(String(a.params[b]))+'" /\x3e';return{id:a.id,markup:c+"\x3c/object\x3e"}},a=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(z){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),{major:null!=a[0]?parseInt(a[0]):
0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),g.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};v("object").reverse().style("display","none").forEach(function(b){for(var c in b)if("FlashVars"!=c&&"function"==typeof b[c])try{b[c]=a}catch(E){}})})):(b=function(a){a=e(a);if(!a)return null;var b,c=a.path;if(a.vars){var g=[];for(b in a.vars)g.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.flashVars=
g.join("\x26");delete a.vars}c='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+f.escape(String(c))+'" id\x3d"'+f.escape(String(a.id))+'" width\x3d"'+f.escape(String(a.width))+'" height\x3d"'+f.escape(String(a.height))+'"'+(a.style?' style\x3d"'+f.escape(String(a.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(b in a.params)c+=" "+f.escape(b)+'\x3d"'+f.escape(String(a.params[b]))+'"';return{id:a.id,markup:c+" /\x3e"}},
a=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}());var w=function(b,c){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=a.major;this.minimumVersion=b.minimumVersion||9;this.domNode=this.movie=this.id=null;c&&(c=m.byId(c));setTimeout(p.hitch(this,function(){if(b.expressInstall||this.available&&this.available>=this.minimumVersion)if(b&&c)this.init(b,c);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};p.extend(w,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(a,b){this.destroy();b=m.byId(b||this.domNode);if(!b)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var c=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;w.initialized&&(this.id=w.place(a,b),this.domNode=b,setTimeout(p.hitch(this,
function(){this.movie=this.byId(this.id,a.doc);this.onReady(this.movie);this._poller=setInterval(p.hitch(this,function(){try{c=this.movie.PercentLoaded()}catch(E){console.warn("this.movie.PercentLoaded() failed",E,this.movie)}if(100==c)this._onload();else if(0==c&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(q){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=
p.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?u(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});p.mixin(w,{minSupported:8,available:a.major,supported:a.major>=a.required,minimumRequired:a.required,version:a,initialized:!1,onInitialize:function(){w.initialized=!0},__ie_markup__:function(a){return b(a)},proxy:function(a,
b){t.forEach(b instanceof Array?b:[b],function(a){this[a]=p.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+a+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+t.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},a)}});w.place=function(a,c){a=b(a);c=m.byId(c);c||(c=k.doc.createElement("div"),c.id=a.id+"-container",k.body().appendChild(c));return a?(c.innerHTML=a.markup,
a.id):null};w.onInitialize();p.setObject("dojox.embed.Flash",w);return w})},"builder/plugins/app-list/AppCatalogPage":function(){define("dojo/_base/declare dojo/_base/html dojo/dom-style dojo/dom dojo/_base/array dojo/on dojo/_base/lang dojo/query dojo/dom-attr dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppCatalogPage.html ./AppOperMenu".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return p([b,a,c],{baseClass:"app-catalog-page",templateString:x,
_defaultStyleColor:"#31aacd",loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._appOperMenus=[];this._eventHandles=[]},startup:function(){this.inherited(arguments)},refresh:function(a){this.createAppList(a);g.setSelectable(this.appContent,!1)},createAppList:function(a){var b;
this.cleanAppList();g.setStyle(this.listSectionBodyContent,"display","block");if(0<a.length)for(b=0;b<a.length;b++)this.createAppNode(a[b],b);else this.appListWidget._addEmptyDescription(this.listTableBody)},cleanAppList:function(){g.empty(this.listTableBody);n.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];n.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppNode:function(a,b){return this._createItem(a,b)},_createItem:function(a,b){b=g.create("tr",
{"class":"app-catalogs list-table-item"+(b%2?" list-table-item-add ":" "),"data-app-id":a.id,"data-app-name":a.name},this.listTableBody);var c=g.create("td",{"class":"item-td"},b),c=g.create("div",{"class":"catalog"},c),f=g.create("div",{"class":"content-theme jimu-float-leading"},c),k=g.create("div",{"class":"content-theme-icon "+(a._defaultIconClass?a._defaultIconClass:""),title:this.nls.launch},f);a.thumbnail&&t.set(k,"backgroundImage","url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")");g.create("div",{"class":"content-theme-flagImg content-theme-flagImg-"+this._getType(a.appType)},k);var k=g.create("div",{"class":"content-opers jimu-float-trailing"},c),n=g.create("div",{"class":"content-opers-btns"},k),k=g.create("div",{"class":"content-opers-btn content-opers-btns-edit",title:this.nls.configApp},n),p=g.create("div",{"class":"content-opers-btn content-opers-btns-launch",title:this.nls.launch},n),q=g.create("div",{"class":"content-opers-btn content-opers-btns-download",title:this.nls.download},
n),n=g.create("div",{"class":"content-opers-btn content-opers-btns-more","data-appid":a.id},n),x=(new w({app:a,posNode:n,appListWidget:this.appListWidget,nls:this.nls,isTemplate:!1,appContentNode:this.appContent,height:122,offset:{top:42,left:-16,right:-16}})).placeAt(n);this._appOperMenus.push(x);this._eventHandles.push(m(f,"click",u.hitch(this,this._onAppLaunchClick,a)));this._eventHandles.push(m(q,"click",u.hitch(this,this._onAppDownloadClick,a)));this._eventHandles.push(m(k,"click",u.hitch(this,
this._onAppEditClick,a)));this._eventHandles.push(m(p,"click",u.hitch(this,this._onAppLaunchClick,a)));this._eventHandles.push(m(n,"click",u.hitch(this,this._onAppMoreClick,a,x,n)));c=g.create("div",{"class":"catalog-content"},c);f=g.create("div",{"class":"catalog-content-head"},c);g.create("p",{"class":"catalog-content-appname long-text-ellipsis",innerHTML:a.name,title:a.name},f);f=g.create("p",{"class":"catalog-content-appinfo long-text-ellipsis jimu-float-trailing"},f);g.create("span",{"class":"catalog-content-appinfo-time jimu-float-leading",
innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},f);g.create("span",{"class":"catalog-content-appinfo-owner jimu-float-leading",innerHTML:"\x3cp class\x3d'catalog-content-appinfo-owner-name long-text-ellipsis'title\x3d'"+a.creator+"'\x3e"+a.creator+"\x3c/p\x3e"},f);g.create("p",{"class":"catalog-content-dis "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},c);this._eventHandles.push(m(v.byId("content-box"),"click",
u.hitch(this,this.resetStatus)));this._eventHandles.push(m(this.ownerDocument,"click",u.hitch(this,this.resetStatus)));this._eventHandles.push(e.subscribe("menuAll/hide",u.hitch(this,this.resetStatus)));return b},_getType:function(a){var b="";switch(a){case "HTML":b="2D";break;case "HTML3D":b="3D";break;default:console.error("AppCatalogPage Error _getType")}return b},resetStatus:function(a){this._hideAllAppOperMenus(a);this._hideBtnsSelect(a)},_hideAllAppOperMenus:function(a){n.forEach(this._appOperMenus,
function(b){!b.isShow||"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===b.app.id||b.hide()})},_hideBtnsSelect:function(a){for(var b=k(".content-opers-btns-more"),c=0,e=b.length;c<e;c++){var m=b[c];"undefined"!==typeof a&&"undefined"!==typeof a.itemId&&a.itemId===parseInt(f.get(m,"data-appid"),10)||g.removeClass(m,"content-opers-btns-more-selected")}},_onAppDownloadClick:function(a){window.open(a.downloadUrl,"downloadTargetFrame")},_onAppEditClick:function(a){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)},
_onAppLaunchClick:function(a){window.open(a.appUrl,"_blank")},_onAppMoreClick:function(a,b,c,f){f&&(f.itemId=a.id);b.isShow?b.hide():(e.publish("menuAll/hide"),b.set("app",a),b.show(),g.addClass(c,"content-opers-btns-more-selected"))}})})},"builder/plugins/app-list/AppOperMenu":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppOperMenu.html dojo/on dojo/query dojo/keys dojo/_base/lang jimu/dijit/Popup jimu/dijit/Message builder/serviceUtils jimu/dijit/QRCode builder/dijit/FullScreenPopup builder/dijit/EditItemInfo".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return p([t,v],{templateString:n,baseClass:"app-oper-menu white-style",app:void 0,isShow:!1,position:{},itemDefaultColor:"#ffffff",appListWidget:void 0,loadingDiv:null,_loading:null,_downloadUrl:null,constructor:function(){this.height||(this.height=0);this.offset||(this.offset={top:0,left:0,right:0})},postCreate:function(){this.inherited(arguments);this._loading=this.appListWidget.loading;this._initMenu();this.hide();this._downloadUrl="/webappbuilder/rest/apps/"+
this.app.id+"/download";g.setAttr(this.downloadLinkNode,"href",this._downloadUrl);this.own(m(this.downloadLinkNode,"click",f.hitch(this,function(){this.hide()})));this.app.isTemplate&&g.setAttr(this.editAppInfo,"innerHTML",this.nls.editTemplateInfo)},refresh:function(){var a="",b="";if(this.appContentNode){var a=g.position(this.posNode),b=g.position(this.appContentNode),c=g.getStyle(this.appContentNode,"height");a.y+this.height+25>b.y+c?(b=this.offset.top,a="",g.setStyle(this.upTriangle,"display",
"none"),g.setStyle(this.downTriangle,"top",this.height-4+"px"),g.setStyle(this.downTriangle,"display","block")):(a=this.offset.top,b="")}g.setStyle(this.domNode,isRTL?{top:a+"px",bottom:b+"px",left:this.offset.left+"px"}:{top:a+"px",bottom:b+"px",right:this.offset.right+"px"})},_refreshAppOrTempaltePage:function(){this.appListWidget.resetRefreshImageFlag();this.app.isTemplate?this.appListWidget.refreshTemplatePage():this.appListWidget.refreshAppPage()},show:function(){this.refresh();g.setStyle(this.domNode,
"display","block");300<=g.getStyle(this.domNode,"width")?(g.setAttr(this.editAppInfo,"title",this.editAppInfo.innerHTML),g.setAttr(this.duplicate,"title",this.duplicate.innerHTML),g.setAttr(this.remove,"title",this.remove.innerHTML)):(g.removeAttr(this.editAppInfo,"title"),g.removeAttr(this.duplicate,"title"),g.removeAttr(this.remove,"title"));this.isShow=!0},hide:function(){g.setStyle(this.domNode,"display","none");this.isShow=!1},_initMenu:function(){this.isTemplate?(g.addClass(this.editAppInfo,
"border-top-radius"),this._disableItem(this.createAppFromTemplate),this.app.isPredefined&&(this._disableItem(this.duplicate),this._disableItem(this.editAppInfo),this._disableItem(this.remove),this._disableItem(this.download),this._disableItem(this.duplicate))):(g.addClass(this.editAppInfo,"border-top-radius"),this._disableItem(this.createAppFromTemplate),this._disableItem(this.download))},_disableItem:function(a){g.setStyle(a,"display","none")},_onMenuClick:function(a){a.stopPropagation()},_onRemoveClick:function(){var b,
c;this.app.isTemplate?(b=this.nls.confirmDeleteTemplate,c=this.nls.deleteTemplateTitle):(b=this.nls.confirmDeleteApp,c=this.nls.deleteAppTitle);var g=new e({content:b,titleLabel:c,width:"425",autoHeight:!0,"class":"jimu-popup-in-home",buttons:[{label:this.nls.ok,onClick:f.hitch(this,function(){this._loading.show(this.nls.deleting);g.close();a.removeApp(this.app.id).then(f.hitch(this,function(a){a.success?(console.log("Removed app successfully, id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):
console.error(this.nls.deleteFalse);this._loading.hide()}),function(){console.error(this.nls.deleteError);this._loading.hide()})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:f.hitch(this,function(){g.close()})}]})},_onDuplicateClick:function(){this._loading.show(this.nls.duplicating);a.duplicateApp({name:this.app.name,description:this.app.description,fromAppId:this.app.id,appType:this.app.appType,isTemplate:this.app.isTemplate,isPredefined:this.app.isPredefined}).then(f.hitch(this,
function(a){this._loading.hide();a.success?(console.log("Duplicated app successfully, app id\x3d"+this.app.id),this._refreshAppOrTempaltePage()):console.error(this.nls.duplicateFalse)}),function(){console.error(this.nls.duplicateError);this._loading.hide()});this.hide()},_onEditClick:function(){this.itemInfoDijit=new w({itemInfo:this.app,nls:this.nls});var a;a=this.app.isTemplate?this.nls.editTemplateInfo:this.nls.editAppInfo;var b=u("#main-page")[0];this._EditPopup=new x({zIndex:101,titleStr:a,blurContainer:b.firstElementChild,
content:this.itemInfoDijit.domNode,subDijit:this.itemInfoDijit,buttons:[{label:this.nls.ok,isHighLight:!0,onClick:f.hitch(this,this._onEditOKClick)},{label:this.nls.cancel,isHighLight:!1,onClick:f.hitch(this,this._onEditCancelClick)}],btnsAtuoBottom:!0});this._EditPopup.placeAt(b);this._EditPopup.show();this.itemInfoDijit.focusItemByName("appName");this.hide();this.posNode&&g.removeClass(this.posNode,"item-more-selected")},_onEditOKClick:function(){var a=f.clone(this.app),c=this.itemInfoDijit.getProperties();
a.name=c.name;a.description=c.description;!0!==this.app.isTemplate&&c.icon&&(a.icon=c.icon);c.thumbnail&&(a.thumbnail=c.thumbnail);this.appListWidget.updateApp(a).then(f.hitch(this,function(a){!0===a.success?(this._refreshAppOrTempaltePage(),this._EditPopup.close()):(console.error(a.message),new b({message:this.nls.editAppFalse}))}),f.hitch(this,function(a){console.error(a);new b({message:this.nls.editError})}))},_onEditCancelClick:function(){this._EditPopup&&this._EditPopup.close()},_onDownloadClick:function(){},
_onAgolTemplateClick:function(){var a=this.appListWidget.pluginsMeta["popup-actions.popup-agoltemplate"];a&&this.appListWidget.pluginManager.loadPlugin(a).then(f.hitch(this,function(a){a.onClickBeforeConfigPage(this.app)}))},_onCreateAppFromTempalteClick:function(){var a=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0],a=this.appListWidget.pluginsMeta[a.pluginName];this._loading.show("");this.appListWidget.pluginManager.loadPlugin(a).then(f.hitch(this,function(a){a.popupNewCreateDlg("",
this.app,700);this._loading.hide()}),f.hitch(this,function(){this._loading.hide()}))},_onQRCodeClick:function(){new e({content:new c({text:"http://"+window.location.host+path+"apps/"+this.app.id,width:128,height:128}),container:"main-page",titleLabel:"qrcode-nonls",width:300,autoHeight:!0,buttons:[{label:this.nls.cancel,key:k.ESCAPE}]})}})})},"builder/dijit/EditItemInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/dijit dojo/text!./templates/EditItemInfo.html dojo/dom-style dojo/dom-class dojo/_base/lang dojo/on dojo/mouse dojo/query dojo/dom-attr dojo/promise/all builder/portalUtils jimu/portalUrlUtils jimu/utils ./Tags dijit/form/SimpleTextarea jimu/dijit/ImageChooser dojo/has dojo/sniff dijit/form/TextBox dijit/form/Select dijit/form/CheckBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I){return p([n,m,u],{templateString:f,baseClass:"dijit-item-info",_isTemplate:"",postMixInProperties:function(){this.inherited(arguments);this.nls=a.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this._init(this.itemInfo);q.set(this.publishWebmapSummary,"placeholder",this.nls.summaryLabelPlaceHolder)},_init:function(e){var f="";this._isTemplate=!1===e.isTemplate?!1:!0;f="imageChooserTemplate";this.imageChooser=new D({cropImage:!0,
showSelfImg:!0,format:[D.GIF,D.JPEG,D.PNG],goldenWidth:300,goldenHeight:180,maxSize:2048});t.place(this.imageChooser.domNode,this.imageChooserBase);b.add(this.imageChooserContainer,f);b.add(this.imageChooserMasker,f);this.own(c(this.imageChooserContainer,x.enter,a.hitch(this,this._onImageChooserBaseMouseEnter)));this.own(c(this.imageChooserContainer,x.leave,a.hitch(this,this._onImageChooserBaseMouseLeave)));this.own(c(this.imageChooserMasker,"click",a.hitch(this,this._onEmitUploadPic)));this.setProperties(e)},
_onImageChooserBaseMouseEnter:function(a){e.set(this.imageChooserMasker,"display","block");a.stopPropagation();return!1},_onImageChooserBaseMouseLeave:function(a){e.set(this.imageChooserMasker,"display","none");a.stopPropagation();return!1},_onEmitUploadPic:function(){var a=w("form",this.imageChooserBase)[0],a=w("label",a)[0];3<I("ff")||I("chrome")?a.click():c.emit(a,"click",{bubbles:!0,cancelable:!0})},setProperties:function(a){k.byId("publish-webmap-name").set("value",a.name);k.byId("publish-webmap-summary").set("value",
a.description);if(this.imageChooser){var b="",b=a.thumbnail;"undefined"!==typeof b&&this.imageChooser.setDefaultSelfSrc(b)}},getProperties:function(){var a={name:B.stripHTML(k.byId("publish-webmap-name").get("value")),description:B.stripHTML(k.byId("publish-webmap-summary").get("value"))};!0!==this._isTemplate&&(a.icon=this.imageChooser&&this.imageChooser.imageData);a.thumbnail=this.imageChooser&&this.imageChooser.imageData;return a},focusItemByName:function(a){a&&this[a]?this[a].focus():console.log("Error name")}})})},
"builder/plugins/app-list/CardPageWithBigThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithBigThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p([k,f,e],{baseClass:"card-page",templateString:b,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,_appOperMenus:null,
postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);g.setSelectable(this.domNode,!1)},refresh:function(a){this.createItemList(a)},cleanItemList:function(){g.empty(this.cardPageContent);t.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=[];t.forEach(this._eventHandles,
function(a){a.remove()});this._eventHandles=[]},createItemList:function(a){this.cleanItemList();0<a.length?t.forEach(a,function(a){this.createItemCard(a)},this):this.appListWidget._addEmptyDescription(this.cardPageContent,"card-page")},createItemCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,e=g.create("div",{"class":"item-card jimu-float-leading"},this.cardPageContent),f=g.create("a",{"class":"thumbnail-part",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+
")",href:a.appUrl,target:"_blank",title:b},e);g.create("div",{"class":"item-type-div "+("HTML"===a.appType?"item-type-2d":"item-type-3d")},f);f=g.create("div",{"class":"appInfo-part"},e);g.create("div",{"class":"item-name-div",innerHTML:a.name,title:a.name},f);var k=g.create("div",{"class":"item-info-div"},f);g.create("div",{"class":"app-time-div jimu-float-leading",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},k);g.create("div",{"class":"app-creator-div jimu-float-trailing",innerHTML:a.creator},
k);f=g.create("div",{"class":"desc-wrap jimu-clamp-wrap"},f);g.create("div",{"class":"item-des-div clamp "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},f);e=g.create("div",{"class":"item-operation-part"},e);g.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"item-operation launch-operation jimu-float-leading",title:b},e);a.isTemplate||g.create("div",{innerHTML:'\x3ca href\x3d"'+
a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"item-operation download-operation jimu-float-leading",title:this.nls.download},e);var b=g.create("div",{"class":"item-operation edit-operation jimu-float-leading "+(a.isPredefined?"disable":""),title:a.isTemplate?this.nls.configTemplate:this.nls.configApp},e),p=g.create("div",{"class":"item-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},e),z=(new u({app:a,posNode:p,appListWidget:this.appListWidget,
nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.cardPageContent,height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(p);this._appOperMenus.push(z);f=n(p,"click",v.hitch(this,function(b){z.isShow?(z.hide(),g.removeClass(p,"item-more-selected")):(t.forEach(this._appOperMenus,function(a){a.hide();g.removeClass(a.posNode,"item-more-selected")}),z.show(),g.addClass(p,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(f);f=n(b,"click",v.hitch(this,
function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));this._eventHandles.push(f);a.isTemplate&&(b=g.create("div",{"class":"item-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},e),f=n(b,"click",v.hitch(this,function(){z._onCreateAppFromTempalteClick()})),this._eventHandles.push(f));f=n(m.byId("content-box"),"click",v.hitch(this,function(b){b.itemId!==a.id&&(z.hide(),g.removeClass(p,"item-more-selected"))}));this._eventHandles.push(f)}})})},
"builder/plugins/app-list/CardPageWithSmallThumbnail":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/dom ./AppOperMenu dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CardPageWithSmallThumbnail.html dojox/form/Uploader dojo/NodeList-dom".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p([k,f,e],{baseClass:"card-page-with-small-thumbnail",templateString:b,loading:null,folderUrl:null,appListWidget:null,_eventHandles:null,
_appOperMenus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[]},startup:function(){this.inherited(arguments);g.setSelectable(this.domNode,!1)},refresh:function(a){this.createAppList(a)},cleanAppList:function(){g.empty(this.appCardPageContent);t.forEach(this._appOperMenus,function(a){a.destroy()});this._appOperMenus=
[];t.forEach(this._eventHandles,function(a){a.remove()});this._eventHandles=[]},createAppList:function(a){this.cleanAppList();t.forEach(a,function(a){this.createAppCard(a)},this)},createAppCard:function(a){var b=a.isTemplate?this.nls.preview:this.nls.launch,e=g.create("div",{"class":"app-card-box jimu-float-leading"},this.appCardPageContent),e=g.create("div",{"class":"card app-info-card"},e),f=g.create("div",{"class":"app-title-part"},e);g.create("div",{"class":"app-type-div "+("HTML"===a.appType?
"app-type-2d":"app-type-3d")},f);var f=g.create("table",{"class":"app-title-table"},f),f=g.create("tbody",{"class":"app-title-table-body"},f),f=g.create("tr",{"class":"app-title-table-tr"},f),k=g.create("td",{"class":"app-thumbnail-td"},f);g.create("a",{"class":"app-thumbnail",style:"background-image: url("+a.thumbnail+"?date\x3d"+this.appListWidget.getRefreshImageFlag()+")",href:a.appUrl,target:"_blank",title:b},k);f=g.create("td",{"class":"app-title-td"},f);g.create("div",{"class":"app-title-div",
innerHTML:a.name,title:a.name},f);g.create("div",{"class":"app-time-div",innerHTML:this.appListWidget._getLocaleDateTime(a.lastUpdated)},f);g.create("div",{"class":"app-creator-div",innerHTML:a.creator},f);f=g.create("div",{"class":"app-desc-box"},e);f=g.create("div",{"class":"desc-wrap jimu-clamp-wrap"},f);g.create("div",{"class":"app-desc-part clamp "+(a.description?"":"place-holder-class"),innerHTML:a.description?a.description:this.nls.defaultDesc,title:a.description},f);e=g.create("div",{"class":"app-operation-part"},
e);g.create("div",{innerHTML:'\x3ca href\x3d"'+a.appUrl+'" target\x3d"_blank"\x3e\x3c/a\x3e',"class":"app-operation launch-operation jimu-float-leading",title:b},e);a.isTemplate||g.create("div",{innerHTML:'\x3ca href\x3d"'+a.downloadUrl+'" target\x3d"downloadTargetFrame"\x3e\x3c/a\x3e',"class":"app-operation download-operation jimu-float-leading",title:this.nls.download},e);var b=g.create("div",{"class":"app-operation edit-operation jimu-float-leading "+(a.isPredefined?"disable":""),title:a.isTemplate?
this.nls.configTemplate:this.nls.configApp},e),p=g.create("div",{"class":"app-operation more-operation jimu-float-trailing "+(a.isPredefined?"disable":"")},e),z=(new u({app:a,posNode:p,appListWidget:this.appListWidget,nls:this.nls,isTemplate:a.isTemplate,appContentNode:this.appCardPageContent,height:a.isTemplate?a.isPredefined?45:162:122,offset:{top:44,left:-10,right:-10}})).placeAt(p);this._appOperMenus.push(z);f=n(p,"click",v.hitch(this,function(b){z.isShow?(z.hide(),g.removeClass(p,"item-more-selected")):
(t.forEach(this._appOperMenus,function(a){a.isShow&&(a.hide(),g.removeClass(a.posNode,"item-more-selected"))}),z.show(),g.addClass(p,"item-more-selected"));b.itemId=a.id}));this._eventHandles.push(f);f=n(b,"click",v.hitch(this,function(){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(a)}));this._eventHandles.push(f);a.isTemplate&&(b=g.create("div",{"class":"app-operation create-app-from-item-operation jimu-float-leading",title:this.nls.createApp},e),f=n(b,"click",v.hitch(this,
function(){z._onCreateAppFromTempalteClick()})),this._eventHandles.push(f));f=n(m.byId("content-box"),"click",v.hitch(this,function(b){b.itemId!==a.id&&(g.removeClass(z.posNode,"item-more-selected"),z.hide())}));this._eventHandles.push(f)}})})},"jimu/dijit/DropdownMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/query dojo/Evented".split(" "),function(p,g,t,v,n,m,u,k,f){return p([g,t,f],{baseClass:"jimu-dijit-dropdownmenu",
declaredClass:"jimu.dijit.DropdownMenu",templateString:"\x3cdiv\x3e\x3c/div\x3e",itemHeight:24,iconSize:16,offsetY:5,shelter:null,paddingOffsetY:8,dropdownMenuClass:"",dropdownMenuItemClass:"dropdown-menu-item",items:null,highlightValue:"",highlightSelectedItemAfterClick:!0,menuLeadingIcon:!0,maxDisplayItems:10,postCreate:function(){this.inherited(arguments);this.items||(this.items=[]);this.shelter=m.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-shelter"\x3e\x3c/div\x3e');this.itemsContainer=m.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-items-container '+
this.dropdownMenuClass+'"\x3e\x3c/div\x3e');0>=this.maxDisplayItems&&(this.maxDisplayItems=20);this.itemsContainer.style.maxHeight=this.itemHeight*this.maxDisplayItems+2*this.paddingOffsetY+"px";n.forEach(this.items,v.hitch(this,function(e){var b=m.toDom('\x3cdiv class\x3d"'+this.dropdownMenuItemClass+' jimu-ellipsis"\x3e'+e.label+"\x3c/div\x3e");b.itemInfo=e;b.title=e.label;m.place(b,this.itemsContainer)}));this.own(u(this.domNode,"click",v.hitch(this,this._onIconClick)));this.own(u(this.shelter,
"click",v.hitch(this,this._onShelterClick)));this.own(u(this.itemsContainer,"click",v.hitch(this,this._onItemsContainerClick)));this.highlightValue&&this.setHighlightValue(this.highlightValue)},_onIconClick:function(e,b){e.stopPropagation();this.isShowing()?this.hideMenu():(e=m.position(b||e.target||e.srcElement),this.showMenu(e))},_onShelterClick:function(){this.hideMenu()},_onItemsContainerClick:function(e){e.stopPropagation();e=e.target||e.srcElement;m.hasClass(e,this.dropdownMenuItemClass)&&(e=
e.itemInfo.value,this.highlightSelectedItemAfterClick&&this.setHighlightValue(e),this.emit("click-item",e));this.hideMenu()},clearHighlightValue:function(){k("."+this.dropdownMenuItemClass,this.itemsContainer).removeClass("selected")},setHighlightValue:function(e){this.clearHighlightValue();k("."+this.dropdownMenuItemClass,this.itemsContainer).some(v.hitch(this,function(b){return b.itemInfo.value===e?(m.addClass(b,"selected"),!0):!1}))},getHighlightValue:function(){var e=k("."+this.dropdownMenuItemClass+
".selected",this.itemsContainer)[0];return e?e.itemInfo.value:null},getHighlightLabel:function(){var e=this.getHighlightValue(),b="";n.some(this.items,function(a){return a.value===e?(b=a.label,!0):!1},this);return b},isShowing:function(){return m.hasClass(this.domNode,"showing")},showMenu:function(e){this.itemsContainer.style.top=e.y+this.iconSize+this.offsetY+"px";this.menuLeadingIcon===window.isRTL?(this.itemsContainer.style.left=e.x+"px",this.itemsContainer.style.right="auto"):(this.itemsContainer.style.right=
window.innerWidth-(e.x+this.iconSize)+"px",this.itemsContainer.style.left="auto");m.place(this.shelter,document.body);m.place(this.itemsContainer,document.body);m.addClass(this.domNode,"showing")},hideMenu:function(){this.itemsContainer.parentNode&&this.itemsContainer.parentNode.removeChild(this.itemsContainer);this.shelter.parentNode&&this.shelter.parentNode.removeChild(this.shelter);m.removeClass(this.domNode,"showing")},destroy:function(){this.hideMenu();m.destroy(this.itemsContainer);m.destroy(this.shelter);
this.inherited(arguments)}})})},"builder/plugins/attribute-config/_build-generate_module":function(){define(["builder/plugins/attribute-config/Plugin","dojo/text!builder/plugins/attribute-config/Plugin.html","dojo/text!builder/plugins/attribute-config/css/style.css","dojo/i18n!builder/plugins/attribute-config/nls/strings"],function(){})},"builder/plugins/attribute-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/query dojo/sniff dojo/Deferred dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html ./AttrbuteLogoChooser dojo/dom-style dojo/dom-construct dojo/_base/array builder/portalUtils builder/BasePlugin jimu/utils jimu/portalUrlUtils jimu/dijit/CheckBox jimu/dijit/ImageChooser jimu/dijit/Message jimu/dijit/LoadingIndicator esri/arcgis/AppProxyManager esri/arcgis/utils ./AppProxyUtil ./MapProxyItem ./UrlProxyItem builder/dijit/LinkEditor jimu/dijit/Popup dijit/Editor ./dataSource/AdditionalDataSources dojo/NodeList-dom dojo/NodeList-data jimu/dijit/ColorPicker dijit/form/Select dijit/_editor/plugins/FontChoice dijit/_editor/plugins/TextColor dijit/ToolbarSeparator jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O){return p([C,e],{templateString:b,appConfig:null,selectLinkNode:null,selectProxyRuleNode:null,initedLinks:!1,initedProxy:!1,_currentPortalUrl:null,showProxySetting:!1,showAlwaysUseProxy:!1,keepAppState:!0,titleNodeClickHandler:null,subtitleNodeClickHandler:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(n.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)));
this.own(n.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.own(n.subscribe("actionTriggered",g.hitch(this,this._onActionTrigged)));this.own(n.subscribe("app/mapLoaded",g.hitch(this,this._setMap)));this.own(n.subscribe("app/mapChanged",g.hitch(this,this._setMap)));this.useProxySetting=new B({label:this.nls.useProxySetting,checked:!1},this.useProxySetting);this.alwaysUseProxy=new B({label:this.nls.alwaysUseProxyLabel,checked:!1},this.alwaysUseProxy);this._is3D()?(c.set(this.appStateController,
"display","none"),c.set(this.dataSourceSection,"display","none")):(c.set(this.appStateController,"display",""),this.appStateSetting=new B({label:this.nls.keepAppState,checked:!0,onChange:g.hitch(this,this._onAppStateSettingChange)},this.appStateSetting));window.isXT?(c.set(this.loadingPageController,"display",""),this.bgImageCheckBox=new B({label:this.nls.backgroundImage,checked:!0,onChange:g.hitch(this,this._onBackgroundImageStatusChange)},this.bgCheckBoxDiv),this.gifImageCheckBox=new B({label:this.nls.loadingGifImage,
checked:!0,onChange:g.hitch(this,this._onGifImageStatusChange)},this.gifCheckBoxDiv),this._onSelectGifMode()):c.set(this.loadingPageController,"display","none");this.linksEditor=new Q({nls:this.nls,linkList:[],btnLabel:this.nls.addLink,canEdit:!0,canDelete:!0,isRest:!1,afterAdd:g.hitch(this,this._publishLinksChange),afterUpdate:g.hitch(this,this._publishLinksChange),afterDelete:g.hitch(this,this._publishLinksChange)});this.linksEditor.placeAt(this.linksSection);this.bgImageChooser=new G({cropImage:!1,
label:this.nls.selectFile,format:["image/png","image/jpeg"]},this.bgImageChooser);t.addClass(this.bgImageChooser.domNode,"jimu-trailing-margin1 loading-image-chooser");this.bgImageChooser.startup();this.gifImageChooser=new G({cropImage:!1,label:this.nls.selectFile,format:["image/gif"]},this.gifImageChooser);t.addClass(this.gifImageChooser.domNode,"jimu-float-leading jimu-trailing-margin1 loading-image-chooser");this.gifImageChooser.startup();u(".header-section .label",this.domNode).style("display",
"none");this._bindEvents();window.isRTL?(u(".arrow-forward",this.domNode).addClass("icon-arrow-left"),u(".arrow-forward",this.domNode).removeClass("icon-arrow-right"),u(".arrow-back",this.domNode).addClass("icon-arrow-forward")):(u(".arrow-forward",this.domNode).addClass("icon-arrow-right"),u(".arrow-forward",this.domNode).removeClass("icon-arrow-left"),u(".arrow-back",this.domNode).addClass("icon-arrow-back"));this.loading=new D({hidden:!0},this.loadingNode);this.loading.startup()},startup:function(){this.inherited(arguments);
this._keepOrder()},destroy:function(){this.inherited(arguments);this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null);this.titleNodeClickHandler&&(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null)},_setMap:function(a){this.map=a;this.additionalDataSources&&this.additionalDataSources.setMap(this.map)},_bindEvents:function(){this.titleChangeHandle=m(this.titleNode,"change",g.hitch(this,this.onTitleChange));this.subtitleChangeHandle=
m(this.subtitleNode,"change",g.hitch(this,this.onSubtitleChange));this.own(this.titleChangeHandle);this.own(this.subtitleChangeHandle);this.own(m(this.useProxySetting,"click",g.hitch(this,this._onUseProxySettingChange)));this.own(m(this.alwaysUseProxy,"click",g.hitch(this,this._onAlwaysUseProxyChange)));this.own(m(this.proxyUrlNode,"change",g.hitch(this,this._onProxyUrlChange)));this.own(m(this.proxyUrlNode,"blur",g.hitch(this,this._onProxyUrlBlur)));this.own(m(this.appIdNode,"change",g.hitch(this,
this._onAppIdChange)));this.own(m(this.domNode,"click",g.hitch(this,function(){u(".header-button",this.domNode).removeClass("highlight-button");this.selectLinkNode&&(t.removeClass(this.selectLinkNode,"selected-item"),this.selectLinkNode=null);this.selectProxyRuleNode&&(t.removeClass(this.selectProxyRuleNode,"selected-item"),this.selectProxyRuleNode=null)})));window.isXT&&(this.own(m(this.loadingPageController,"click",g.hitch(this,this._switchToLoading))),this.own(m(this.backController,"click",g.hitch(this,
this._switchToApp))),this.own(m(this.bgColorPicker,"change",g.hitch(this,this._onBackgroundColorChange))),this.own(m(this.gifSelect,"change",g.hitch(this,this._onGifSelectChange))),this.own(m(this.bgImageChooser,"change",g.hitch(this,this._onBackgroundImageUpload))),this.own(m(this.gifImageChooser,"change",g.hitch(this,this._onLoadingGifUpload))));this.own(m(this.appProxyController,"click",g.hitch(this,this._switchToAppProxy)));this.own(m(this.backController2,"click",g.hitch(this,this._switchToApp)))},
_createAppProxySection:function(a){this.appProxyManager.loaded?(a&&this._checkMapProxy(),this._checkUrlProxy()):this.own(m.once(this.appProxyManager,"load",g.hitch(this,function(){a&&this._checkMapProxy();this._checkUrlProxy()})))},init:function(a,b){this.appConfig=a||{};this.initHeader(a,b);this.initLinks(a);this._is3D()||this.initAppStateSetting(a);this.initedProxy||(this.initProxy(a),this.initedProxy=!0);this._currentPortalUrl!==a.portalUrl&&(this.initAppId(a),this._currentPortalUrl=a.portalUrl);
window.isXT&&this.initLoadingPage(a);if(this._is3D()||!this._isOnline()||window.isXT)c.set(this.appProxyController,"display","none");else{var e=!b||"appProxyChange"===b||"mapChange"===b,f=window.appInfo.id;this.appProxyManager||this._appProxyManagerIniting?this.appProxyManager&&this._createAppProxySection(e):(this._appProxyManagerIniting=!0,K.getItem(f).then(g.hitch(this,function(a){var b=document.createElement("a");b.href=a.item.url;a=b.pathname.substring(0,b.pathname.lastIndexOf("/"));a="/"===a.charAt(0)?
a:"/"+a;this.appProxyManager=new I({appid:f,referrers:["http://www.arcgis.com"+a,"https://www.arcgis.com"+a]});this._appProxyManagerIniting=!1;this._createAppProxySection(e)})));c.set(this.appProxyController,"display","")}},_isOnline:function(){var a=E.getStandardPortalUrl(window.portalUrl);return E.isOnline(a)},_checkMapProxy:function(){this.appConfig&&this.appConfig.map&&this._refreshMapProxy()},_refreshMapProxy:function(){J.queryForSecureServicesInMap(this.appConfig.map.portalUrl,this.appConfig.map.itemId).then(g.hitch(this,
function(a){"appProxy"in this.appConfig.map&&this.appConfig.map.appProxy.mapItemId===this.appConfig.map.itemId?this._createMapProxyTable(a):this._publishAppProxy(a)}))},_createMapProxyTable:function(a){t.empty(this.mapProxyContent);a&&0!==a.length?(t.setStyle(this.mapSection,"display",""),t.addClass(this.urlSection,"double-margin"),w.forEach(a,g.hitch(this,function(a){a=this._checkMapProxyItem(a);a=new L({appProxyManager:this.appProxyManager,sourceUrl:a.sourceUrl,title:a.title,premium:!0===a.premium,
consumeCredits:!0===a.consumeCredits,useProxy:!0===a.useProxy,proxyUrl:a.proxyUrl||"",proxyId:a.proxyId||"",hitsPerInterval:a.hitsPerInterval,intervalSeconds:a.intervalSeconds,nls:this.nls});this.own(m(a,L.PROCESS_START,g.hitch(this,function(){this.loading.show()})));this.own(m(a,L.PROCESS_END,g.hitch(this,function(){this.loading.hide()})));this.own(m(a,L.PROXY_CREATED,g.hitch(this,function(a){this._publishAppProxy([a])})));this.own(m(a,L.PROXY_DELETED,g.hitch(this,function(a){this._publishAppProxy([a])})));
this.own(m(a,L.PROCESS_ERROR,g.hitch(this,function(a){new F({message:a})})));t.place(a.domNode,this.mapProxyContent)}))):(t.setStyle(this.mapSection,"display","none"),t.removeClass(this.urlSection,"double-margin"))},_checkMapProxyItem:function(a){var b=!1,c=g.clone(a);this.appConfig.map&&this.appConfig.map.appProxy&&w.some(this.appConfig.map.appProxy.proxyItems,function(b){if(b.sourceUrl===a.sourceUrl)return c.useProxy=b.useProxy,c.proxyUrl=b.proxyUrl||"",c.proxyId=b.proxyId||"",c.hitsPerInterval=
b.hitsPerInterval,c.intervalSeconds=b.intervalSeconds,!0});c.useProxy&&(b=this._proxyExists(c),b||(c.useProxy=!1,c.proxyUrl="",c.proxyId="",this._publishAppProxy([{sourceUrl:c.sourceUrl,useProxy:!1}])));return c},_proxyExists:function(a){if(this.appProxyManager){var b=this.appProxyManager.get("proxies");if(J.findProxy(b,a))return!0}return!1},_checkUrlProxy:function(){this.proxyLinkEditor||(this.proxyLinkEditor=new Q({nls:this.nls,linkList:[],btnLabel:this.nls.addUrlProxy,canEdit:!1,canDelete:!0,isRest:!0,
isProxy:!0,beforeAdd:g.hitch(this,this._createUrlAppProxy),afterDelete:g.hitch(this,this._deleteUrlAppProxy)}),this.proxyLinkEditor.placeAt(this.linkEditorNode));if(this.appConfig&&this.appConfig.appProxies){var a=[];w.forEach(this.appConfig.appProxies,function(b){this._proxyExists(b)?a.push({label:b.title,url:b.sourceUrl,hitsPerInterval:b.hitsPerInterval,intervalSeconds:b.intervalSeconds}):this._deleteUrlProxy(b)},this);this.proxyLinkEditor.setItems(a)}},_createUrlAppProxy:function(a){a=new M({appProxyManager:this.appProxyManager,
sourceUrl:a.url,title:a.label,hitsPerInterval:a.hitsPerInterval,intervalSeconds:a.intervalSeconds,nls:this.nls});var b=new f;this.own(m(a,M.PROCESS_START,g.hitch(this,function(){this.loading.show()})));this.own(m(a,M.PROCESS_END,g.hitch(this,function(){this.loading.hide()})));this.own(m(a,M.PROXY_CREATED,g.hitch(this,function(a){this._addUrlProxy(a);b.resolve(a)})));this.own(m(a,M.PROCESS_ERROR,g.hitch(this,function(a){b.resolve(null);new F({message:a})})));a.createProxy();return b},_deleteUrlAppProxy:function(a){var b=
{appProxyManager:this.appProxyManager,sourceUrl:a.url,title:a.label,nls:this.nls};w.some(this.appConfig.appProxies,function(c){if(c.sourceUrl===a.url)return g.mixin(b,{proxyId:c.proxyId,proxyUrl:c.proxyUrl,useProxy:c.useProxy}),!0});(new M(b)).deleteProxy();this._deleteUrlProxy(b)},_publishAppProxy:function(a){n.publish("appProxyForMapChanged",{mapItemId:this.appConfig.map.itemId,proxyItems:a})},_addUrlProxy:function(a){var b=[];this.appConfig.appProxies&&0<this.appConfig.appProxies.length&&(b=g.clone(this.appConfig.appProxies));
b.push(a);setTimeout(function(){n.publish("appProxyForUrlChanged",b)},100)},_deleteUrlProxy:function(a){var b=w.filter(this.appConfig.appProxies,function(b){return b.proxyId!==a.proxyId});setTimeout(function(){n.publish("appProxyForUrlChanged",b)},100)},_onAppConfigLoaded:function(a){this._setAppConfig(a)},_onAppConfigChanged:function(a,b){this._setAppConfig(a,b)},_setAppConfig:function(a,b){this.init(a,b)},_publishLinksChange:function(){n.publish("appAttributeChanged",{links:this.getLinks()})},initHeader:function(b,
c){var e=g.getObject("theme.sharedTheme",!1,b);this.logoChooser||(this.logoChooser=new a({nls:this.nls,isPortalSupport:e.isPortalSupport}),this.logoChooser.placeAt(this.logoNodeDiv),this.logoChooser.startup(),this.own(m(this.logoChooser,"sharedThemeChanged",g.hitch(this,function(a){a=g.mixin(this.appConfig.theme.sharedTheme,a);n.publish("sharedThemeChanged",a)}))),this.own(m(this.logoChooser,"appAttributeChanged",g.hitch(this,function(a){n.publish("appAttributeChanged",a)}))));if("undefined"===typeof c||
"attributeChange"===c||"sharedThemeChange"===c)this.logoChooser.setLogo(b.logo||""),this.logoChooser.setLink(b.logoLink||"");"undefined"!==typeof c&&"sharedThemeChange"!==c||this.logoChooser.setSharedThemeConfig(e);c="";b.title&&(c=z.stripHTML(b.title),u(this.titleNode).data("config",b.title),/<([a-z]+)\s*.*>/ig.test(b.title)&&(this.titleNode.disabled=!0,this.titleNode.title=c,this.titleNodeClickHandler||(this.titleNodeClickHandler=m(this.titleNodeDiv,"click",g.hitch(this,this.onTitleEditorClick)))),
t.setAttr(this.titleNode,"value",c));b.subtitle&&(c=z.stripHTML(b.subtitle),u(this.subtitleNode).data("config",b.subtitle),/<([a-z]+)\s*.*>/ig.test(b.subtitle)&&(this.subtitleNode.disabled=!0,this.subtitleNode.title=c,this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=m(this.subtitleNodeDiv,"click",g.hitch(this,this.onSubtitleEditorClick)))),t.setAttr(this.subtitleNode,"value",c))},onTitleChange:function(a){n.publish("appAttributeChanged",{title:a.target.disabled?u(a.target).data("config")[0]:
a.target.value})},onSubtitleChange:function(a){n.publish("appAttributeChanged",{subtitle:a.target.disabled?u(a.target).data("config")[0]:a.target.value})},onTitleEditorClick:function(a){a.stopPropagation();this._editText(this.titleNode)},onSubtitleEditorClick:function(a){a.stopPropagation();this._editText(this.subtitleNode)},_editText:function(a){this.editor=new T({plugins:["bold","italic","underline",z.getEditorTextColor("attributeConfig",!0)],extraPlugins:["|",{name:"dijit._editor.plugins.FontChoice",
command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize"],style:"font-family:Verdana;"});var b=new S({titleLabel:this.nls.formatStyle,width:window.isRTL?695:680,height:250,content:this.editor.domNode,buttons:[{label:window.jimuNls.common.reset,title:this.nls.restoreStyle,onClick:g.hitch(this,function(){var a=this.editor.get("value"),a=z.stripHTML(a);this.editor.set("value",a)})},{label:window.jimuNls.common.ok,onClick:g.hitch(this,
function(){var c=this.editor.get("value");/"attribute-custom-style"/g.test(c)||(c='\x3cdiv class\x3d"attribute-custom-style"\x3e'+c+"\x3c/div\x3e");u(a).data("config",c);var e=z.stripHTML(c);/<([a-z]+)\s*.*>/ig.test(c)?(a.disabled=!0,a.title=e,a!==this.titleNode||this.titleNodeClickHandler)?a!==this.subtitleNode||this.subtitleNodeClickHandler||(this.subtitleNodeClickHandler=m(this.subtitleNodeDiv,"click",g.hitch(this,this.onSubtitleEditorClick))):this.titleNodeClickHandler=m(this.titleNodeDiv,"click",
g.hitch(this,this.onTitleEditorClick)):""===e&&(a.disabled=!1,a.title="",a===this.titleNode&&this.titleNodeClickHandler?(this.titleNodeClickHandler.remove(),this.titleNodeClickHandler=null):a===this.subtitleNode&&this.subtitleNodeClickHandler&&(this.subtitleNodeClickHandler.remove(),this.subtitleNodeClickHandler=null));a.value=e;if(a===this.titleNode)this.onTitleChange({target:a});else if(a===this.subtitleNode)this.onSubtitleChange({target:a});this.editor.destroy();this.editor=null;b.close()})},{label:window.jimuNls.common.cancel,
classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){this.editor.destroy();this.editor=null;b.close()})}],onClose:g.hitch(this,function(){this.editor&&this.editor.destroy();return!0})});t.addClass(b.domNode,"format-font-style");t.setStyle(this.editor.domNode,{width:"100%",height:"100%"});this.editor.startup();8!==k("ie")&&this.editor.resize({w:"100%",h:"100%"});this.editor.set("value",u(a).data("config")[0])},initLinks:function(a){a.links&&this.linksEditor.setItems(a.links)},initProxy:function(a){if(a=
a.httpProxy)this.useProxySetting.setValue(a.useProxy),this.showProxySetting=!!a.useProxy,this._onUseProxySettingChange(),this.alwaysUseProxy.setValue(a.alwaysUseProxy),this.showAlwaysUseProxy=!!a.alwaysUseProxy,this._onAlwaysUseProxyChange(),a.url&&t.setAttr(this.proxyUrlNode,"value",a.url),a.rules&&(t.empty(this.proxyRulesListNode),w.forEach(a.rules,g.hitch(this,function(a){this.createProxyRuleNode(a)})))},initAppStateSetting:function(a){this.appStateSetting.setValue(!!a.keepAppState)},initAppId:function(a){q.getPortal(a.portalUrl).loadSelfInfo().then(g.hitch(this,
function(b){b.supportsOAuth?(t.setStyle(this.appIdSection,"display","none"),t.setAttr(this.appIdNode,"value",a.appId)):t.setStyle(this.appIdSection,"display","none")}),g.hitch(this,function(a){this.shelter.hide();console.error(a)}))},getLinks:function(){var a=[];w.forEach(this.linksEditor.getItems(),function(b){a.push({label:b.label,url:b.url})});return a},getProxy:function(){var a=[],b=t.getAttr(this.proxyUrlNode,"value");u(".proxy-rule-list .list-item",this.domNode).forEach(g.hitch(this,function(b){var c=
u(".first input",b).attr("value")[0];b=u(".second input",b).attr("value")[0];c&&a.push({urlPrefix:c,proxyUrl:b})}));return{useProxy:this.useProxySetting.getValue(),alwaysUseProxy:this.alwaysUseProxy.getValue(),url:b,rules:a}},_bindNodeEvents:function(a,b,c,e,f,k){this.own(m(a,"click",g.hitch(this,function(b){u(".header-button",this.domNode).addClass("highlight-button");"links"===k?(this.selectLinkNode&&t.removeClass(this.selectLinkNode,"selected-item"),t.addClass(a,"selected-item"),this.selectLinkNode=
a):"proxyRules"===k&&(this.selectProxyRuleNode&&t.removeClass(this.selectProxyRuleNode,"selected-item"),t.addClass(a,"selected-item"),this.selectProxyRuleNode=a);b.stopPropagation()})));this.own(m(b,"dblclick",g.hitch(this,function(){t.setStyle(b,"display","none");t.setStyle(c,"display","block");c.focus();c.select()})));this.own(m(e,"dblclick",g.hitch(this,function(){t.setStyle(e,"display","none");t.setStyle(f,"display","block");f.focus();f.select()})));this.own(m(f,"focus",function(a){a.target.value||
(a.target.value="http://")}));this.own(m(c,"blur",g.hitch(this,function(a){t.setAttr(b,{innerHTML:a.target.value||b.innerHTML,style:{display:"block"}});t.setStyle(c,"display","none");"links"===k?n.publish("appAttributeChanged",{links:this.getLinks()}):"proxyRules"===k&&this._publishProxy()})));this.own(m(f,"blur",g.hitch(this,function(a){t.setAttr(e,{innerHTML:a.target.value||e.innerHTML,style:{display:"block"}});t.setStyle(f,"display","none");"links"===k?(a=this._formatLinkValue(a.target.value),
t.setAttr(e,"innerHTML",a),t.setAttr(f,"value",a),n.publish("appAttributeChanged",{links:this.getLinks()})):"proxyRules"===k&&this._publishProxy()})))},_formatLinkValue:function(a){var b="";return b=/^http(s?):\/\//.test(a)?a:/^\/\//.test(a)?"http:"+a:"http://"+a},_createListItem:function(a,b,c,e,f){var g=t.create("div",{"class":"list-item"}),k=t.create("div",{"class":"first jimu-float-leading"},g);c=t.create("div",{"class":"mask",innerHTML:b||c,title:c},k);var k=t.create("input",{style:{display:"none"}},
k),d=t.create("div",{"class":"second jimu-float-leading"},g);f=t.create("div",{"class":"mask",innerHTML:e||f,title:f},d);d=t.create("input",{style:{display:"none"}},d);t.setAttr(k,"value",b);t.setAttr(d,"value",e);this._bindNodeEvents(g,c,k,f,d,a);b||this.focusNewItem(g,c,k,a);return g},focusNewItem:function(a,b,c,e){"links"===e?(this.selectLinkNode&&t.removeClass(this.selectLinkNode,"selected-item"),t.addClass(a,"selected-item"),this.selectLinkNode=a):"proxyRules"===e&&(this.selectProxyRuleNode&&
t.removeClass(this.selectProxyRuleNode,"selected-item"),t.addClass(a,"selected-item"),this.selectProxyRuleNode=a);t.setStyle(b,"display","none");t.setStyle(c,"display","block");c.value=b.innerHTML;setTimeout(function(){c.focus();c.select()},0)},createProxyRuleNode:function(a){a=this._createListItem("proxyRules",a.urlPrefix,this.nls.prefixPlaceholder,a.proxyUrl,this.nls.proxyUrlPlaceholder);t.place(a,this.proxyRulesListNode)},_keepOrder:function(){var a=t.getMarginBox(this.headerSection),b=t.getMarginBox(this.linksSection),
c=t.getMarginBox(this.appIdSection),e=t.getMarginBox(this.useProxySection),a=a.h+b.h+c.h+e.h,b=t.getMarginBox(this.domNode).h;a>b&&t.setStyle(this.domNode,"paddingRight","10px")},_onEditItemClick:function(a){var b=u(".first .mask",a)[0];a=u(".first input",a)[0];t.setStyle(b,"display","none");t.setStyle(a,"display","block");a.focus();a.select()},onAddProxyRuleClick:function(a){this.createProxyRuleNode({urlPrefix:"",proxyUrl:""});this._keepOrder();a.stopPropagation()},onEditProxyRuleClick:function(){this.selectProxyRuleNode&&
this._onEditItemClick(this.selectProxyRuleNode)},onDeleteProxyRuleClick:function(){this.selectProxyRuleNode&&(t.destroy(this.selectProxyRuleNode),n.publish("appAttributeChanged",{httpProxy:this.getProxy()}))},_onUseProxySettingChange:function(){this.useProxySetting.checked?t.setStyle(this.proxySection,"display","block"):t.setStyle(this.proxySection,"display","none");this.showProxySetting!==this.useProxySetting.checked&&(this._publishProxy(),this.showProxySetting=this.useProxySetting.checked)},_onAlwaysUseProxyChange:function(){this.showAlwaysUseProxy!==
this.alwaysUseProxy.checked&&(this._publishProxy(),this.showAlwaysUseProxy=this.alwaysUseProxy.checked)},_onProxyUrlChange:function(){this._publishProxy()},_onProxyUrlBlur:function(){this.proxyUrlNode.value?t.removeClass(this.proxyUrlNode,"error-status"):t.addClass(this.proxyUrlNode,"error-status")},_onAppIdChange:function(){n.publish("appAttributeChanged",{appId:this.appIdNode.value})},_onAppStateSettingChange:function(){this.keepAppState!==this.appStateSetting.checked&&(this.keepAppState=this.appStateSetting.checked,
n.publish("appAttributeChanged",{keepAppState:this.keepAppState}))},_publishProxy:function(){n.publish("appAttributeChanged",{httpProxy:this.getProxy()})},initLoadingPage:function(a){this.showLoadingGif=this.showBackgroundImage=!0;"object"===typeof a.loadingPage&&(a=a.loadingPage,/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(a.backgroundColor)&&this.bgColorPicker.setColor(new v(a.backgroundColor)),this._initBackgroundImage(a),this._initLoadingGif(a))},_switchToLoading:function(){c.set(this.attributeSection,
"display","none");c.set(this.loadingPageSection,"display","");n.publish("actionTriggered",{action:"showLoading"})},_switchToAppProxy:function(){c.set(this.attributeSection,"display","none");c.set(this.appProxySection,"display","")},_switchToApp:function(){c.set(this.attributeSection,"display","");c.set(this.loadingPageSection,"display","none");c.set(this.appProxySection,"display","none");n.publish("actionTriggered",{action:"showApp"})},_onActionTrigged:function(a){"showApp"===a.action&&(c.set(this.attributeSection,
"display",""),c.set(this.loadingPageSection,"display","none"),c.set(this.appProxySection,"display","none"),this._closeDataSourcesPage())},_initBackgroundImage:function(a){a.backgroundImage?a.backgroundImage.visible?(this.showBackgroundImage=!0,this.bgImageCheckBox.check(),c.set(this.bgUploaderDiv,"display","")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),c.set(this.bgUploaderDiv,"display","none")):(this.showBackgroundImage=!1,this.bgImageCheckBox.uncheck(),c.set(this.bgUploaderDiv,
"display","none"))},_initLoadingGif:function(a){var b=0;a.loadingGif?(a.loadingGif.visible?(this.showLoadingGif=!0,this.gifImageCheckBox.check(),c.set(this.gifModeSection,"display","")):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),c.set(this.gifModeSection,"display","none")),/^data:image\/.*;base64,/.test(a.loadingGif.uri)||/loading\.gif$/.test(a.loadingGif.uri)?(this.uploadMode.checked=!0,this._onUploadGifMode()):(this.selectMode.checked=!0,this._onSelectGifMode(),a=a.loadingGif.uri.match(/images\/(.*)/)[1],
b=a.match(/\d+/),this.gifSelect.set("value",b[0]))):(this.showLoadingGif=!1,this.gifImageCheckBox.uncheck(),c.set(this.gifModeSection,"display","none"))},_getLoadingGifSetting:function(){var a={};this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.loadingGif&&(a=this.appConfig.loadingPage.loadingGif);return a},_getLoadingBackgroundColor:function(){return this.appConfig&&this.appConfig.loadingPage&&this.appConfig.loadingPage.backgroundColor?this.appConfig.loadingPage.backgroundColor:
""},_onBackgroundColorChange:function(a){x.empty(this.bgColorPicker.domNode);x.create("span",{innerHTML:a.toHex(),style:{color:z.invertColor(a.toHex())}},this.bgColorPicker.domNode);a.toHex()!==this._getLoadingBackgroundColor()&&n.publish("loadingPageChanged",{backgroundColor:this.bgColorPicker.getColor().toHex()})},_onBackgroundImageStatusChange:function(a){a!==this.showBackgroundImage&&(this.showBackgroundImage=a,n.publish("loadingPageChanged",{backgroundImage:{visible:this.showBackgroundImage}}))},
_onBackgroundImageUpload:function(a){var b=new Image;b.src=a;this.own(m(b,"load",g.hitch(this,function(){n.publish("loadingPageChanged",{backgroundImage:{uri:a,width:b.width,height:b.height}})})))},_onSelectGifMode:function(){c.set(this.predefinedGif,"display","");c.set(this.customGif,"display","none")},_onUploadGifMode:function(){c.set(this.predefinedGif,"display","none");c.set(this.customGif,"display","")},_onGifImageStatusChange:function(a){a!==this.showLoadingGif&&(this.showLoadingGif=a,n.publish("loadingPageChanged",
{loadingGif:{visible:this.showLoadingGif}}))},_onGifSelectChange:function(a){if("0"!==a){var b=this._getLoadingGifSetting(),c=null;b.uri&&/images\/.*/.test(b.uri)&&(b=b.uri.match(/images\/(.*)/)[1],c=b.match(/\d+/));if(null===c||a!==c[0])b=[{width:58,height:58},{width:58,height:10},{width:32,height:32},{width:34,height:34}][a-1],n.publish("loadingPageChanged",{loadingGif:{uri:window.appInfo.appPath+"configs/loading/images/predefined_loading_"+a+".gif",width:b?b.width:0,height:b?b.height:0}})}},_onLoadingGifUpload:function(a){var b=
new Image;b.src=a;this.own(m(b,"load",g.hitch(this,function(){n.publish("loadingPageChanged",{loadingGif:{uri:a,width:b.width,height:b.height}});this.gifSelect.set("value",0)})))},_is3D:function(){return"HTML3D"===window.appInfo.appType},_openDataSourcesPage:function(){c.set(this.attributeSection,"display","none");c.set(this.datasourcesSection,"display","block");this.additionalDataSources||(this.additionalDataSources=new O({nls:this.nls,map:this.map,appConfig:this.appConfig}),this.additionalDataSources.placeAt(this.additionalDataSourcesDiv))},
_closeDataSourcesPage:function(){this.additionalDataSources&&(this.additionalDataSources.destroy(),this.additionalDataSources=null);c.set(this.attributeSection,"display","block");c.set(this.datasourcesSection,"display","none")}})})},"builder/plugins/attribute-config/AttrbuteLogoChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./AttrbuteLogoChooser.html jimu/dijit/Popup builder/dijit/SharedThemeChooserPopup ./CustomLogoPage dojo/sniff jimu/dijit/ImageChooser".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){return g([t,v,n,p],{baseClass:"logo-container no-logo",declaredClass:"jimu.dijit.AttrbuteLogoChooser",templateString:f,isPortalSupport:!1,_wabDefaultLogo:!0,postCreate:function(){this.inherited(arguments);u.setAttr(this.removeLogoNode,"title",this.nls.removeLogo)},startup:function(){this._createTooltipDialog();this.own(k(this.imageChooser,"imageChange",m.hitch(this,"_onLogoChoosed")));this.own(k(this.maskerNode,"mouseenter",m.hitch(this,function(){this.popup.showPopup()})));
this.own(k(this.maskerNode,"mouseleave",m.hitch(this,function(){this.popup.hidePopup()})))},setLogo:function(a){this._wabDefaultLogo="images/app-logo.png"===a?!0:!1;a?(!a||a.startWith("/")||a.startWith("http")||a.startWith("data")||(a=window.appInfo.appPath+a),this.imageChooser.setDefaultSelfSrc(a),u.addClass(this.logoContainer,"logo"),u.removeClass(this.logoContainer,"no-logo"),u.addClass(this.addLogoNode,"hide"),this._resetLogoBox(50)):(this.imageChooser.setDefaultSelfSrc(a),u.addClass(this.logoContainer,
"no-logo"))},setLink:function(a){this.link=a},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useLogo&&(this._useLogo=a.useLogo,this.popup.setIsPortalSupport(a.isPortalSupport),this._isNoChooseState()||(!0===a.useLogo?this.showSharedThemeLogo(!1):this.setCustomLogo(!1)))},_isNoChooseState:function(){return!1===this._useLogo&&!0===this._wabDefaultLogo?!0:!1},onRemoveLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.imageChooser.imageData&&(this.imageChooser.setDefaultSelfSrc(""),
u.removeClass(this.logoContainer,"logo"),u.removeClass(this.addLogoNode,"hide"),u.addClass(this.logoContainer,"no-logo"),this.setCustomLogo(),this.emit("appAttributeChanged",{logo:""}))},onChangeLogoHandler:function(a){a.stopPropagation();a.preventDefault();this.popup.showTooltipDialog()},setDiskLogo:function(){var a=this.imageChooser.mask;if(c("safari")){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0);a.dispatchEvent(b)}else a.click();this.popup.hideTooltipDialog()},_onLogoChoosed:function(a){this._changeLogo();
this.emit("appAttributeChanged",{logo:a});this.setCustomLogo()},_onLinkChange:function(a){this.emit("appAttributeChanged",{logoLink:a});this.setCustomLogo()},showSharedThemeLogo:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomLogo:function(){this.popup.setChecked(this.popup.ACTION.CUSTOM)},setCustomLogo:function(a){this.emitSharedThemeChangedEvent(!1,a)},emitSharedThemeChangedEvent:function(a,b){!1!==b&&this.emit("sharedThemeChanged",{useLogo:a});
this.popup.hideTooltipDialog()},_changeLogo:function(){u.setStyle(this.imageChooser.selfImg,{width:"auto",height:"auto",marginLeft:"auto",marginRight:"auto",marginTop:"auto",marginBottom:"auto"});u.removeClass(this.logoContainer,"no-logo");u.addClass(this.logoContainer,"logo");u.addClass(this.addLogoNode,"hide");u.removeClass(this.imageChooser.domNode,"hide");setTimeout(m.hitch(this,this._resetLogoBox,4),4)},_resetLogoBox:function(a){if(this.domNode&&this.imageChooser){var b=u.getContentBox(this.imageChooser.selfImg);
0<b.w?(a=u.getContentBox(this.imageChooser.domNode),b=b.w/b.h,1>=b?(u.setStyle(this.imageChooser.selfImg,"height",a.h+"px"),b=(a.w-a.h*b)/2,u.setStyle(this.imageChooser.selfImg,{marginLeft:b+"px",marginRight:b+"px"})):(u.setStyle(this.imageChooser.selfImg,"width",a.w+"px"),b=(a.h-a.w/b)/2,u.setStyle(this.imageChooser.selfImg,{marginTop:b+"px",marginBottom:b+"px"}))):setTimeout(m.hitch(this,this._resetLogoBox,a),a)}},onMouseEnterHandler:function(){10>c("ie")&&(this._hasEntered?u.setStyle(this.removeLogoNode,
{display:"block"}):setTimeout(m.hitch(this,function(){var a=u.position(this.logoContainer);u.place(this.removeLogoNode,this.ownerDocumentBody);u.addClass(this.removeLogoNode,"attribute-config-plugin-logo-options");u.setStyle(this.removeLogoNode,{position:"absolute",display:"block",left:(window.isRTL?a.x+5:a.x+a.w-35)+"px",top:a.y+5+"px"});this._hasEntered=!0})))},onMouseLeaveHandler:function(){10>c("ie")&&(u.setStyle(this.removeLogoNode,{display:"none"}),this._hasEntered=!1)},destroy:function(){this.popup.destroy();
this.inherited(arguments)},_createTooltipDialog:function(){this.popup=new b({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(k(this.popup,"btnClick",m.hitch(this,function(a){a===this.popup.ACTION.SHARED?this.showSharedThemeLogo():a===this.popup.ACTION.CUSTOM&&this.showCustomPopup()})));this.own(k(this.popup,"showPopup",m.hitch(this,function(){this._isNoChooseState()||this.popup.setChecked(this._useLogo?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})))},
showCustomPopup:function(){this.popup.hideTooltipDialog();this.customLogoPage=new a({nls:this.nls,link:this.link,imageChooser:this.imageChooser});this.customPopup=new e({content:this.customLogoPage,titleLabel:this.nls.setLogo,width:669,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){if(this.customLogoPage.isValid()){var a=this.customLogoPage.getLink();this.setLink(a);this._onLinkChange(a);this.customPopup.close()}})},{label:this.nls.cancel,onClick:m.hitch(this,function(){this.customPopup.close()})}]})}})})},
"builder/dijit/SharedThemeChooserPopup":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dijit/TooltipDialog dojo/text!./templates/SharedThemeChooserPopup.html dijit/popup".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return g([t,v,n,p],{declaredClass:"shared-theme-chooser-popup",templateString:e,isPortalSupport:!1,_DISAPPEAR_TIMER:null,_isTooltipDialogOpened:!1,placeAt:null,ACTION:null,postMixInProperties:function(){this.inherited(arguments);
this.nls=m.mixin(this.nls,builderNls);this.ACTION={SHARED:"shared",CUSTOM:"custom"}},postCreate:function(){this.inherited(arguments);this.setIsPortalSupport(this.isPortalSupport);this._createTooltipDialog();this.own(k(this.sharedItem,"click",m.hitch(this,function(a){a.stopPropagation();a.preventDefault();!0===this.isPortalSupport&&this.sharedClickHanlder(a)})));this.own(k(this.customItem,"click",m.hitch(this,function(a){this.customClickHanlder(a)})));this.own(k(document,"click",m.hitch(this,function(a){this.isPartOfPopup(a.srcElement||
a.target)||this._hideTooltipDialog()})));this._hideTooltipDialog()},destroy:function(){b.close(this.tooltipDialog);this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var c=this.tooltipDialog.domNode,c=a===c||u.isDescendant(a,c),e=!1,f=b.getTopPopup();f&&f.wrapper&&(e=f.wrapper,e=a===e||u.isDescendant(a,e));return c||e},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},getTooltipDialog:function(){return this.tooltipDialog&&
this.tooltipDialog.domNode?this.tooltipDialog:null},_showTooltipDialog:function(){!0!==this._isTooltipDialogOpened&&(b.open({parent:this.placeAt||this.getParent(),popup:this.tooltipDialog,around:this.around}),this._isTooltipDialogOpened=!0,this.emit("showPopup"))},_hideTooltipDialog:function(){b.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){this.tooltipDialog=new f({content:this.domNode});u.addClass(this.tooltipDialog.domNode,"shared-theme-chooser-popup-container");
var a=this.getTooltipDialog();this.own(k(a.domNode,"mouseover",m.hitch(this,function(a){this.showPopup(a)})));this.own(k(a.domNode,"mouseleave",m.hitch(this,function(a){this.hidePopup(a)})))},setIsPortalSupport:function(a){this.isPortalSupport=a;!0!==this.isPortalSupport?u.addClass(this.sharedItem,"no-support"):u.removeClass(this.sharedItem,"no-support")},sharedClickHanlder:function(a){this.emit("btnClick",this.ACTION.SHARED,a)},customClickHanlder:function(a){this.emit("btnClick",this.ACTION.CUSTOM,
a)},setChecked:function(a){u.removeClass(this.sharedCheck,"check");u.removeClass(this.customCheck,"check");a===this.ACTION.SHARED&&u.addClass(this.sharedCheck,"check");a===this.ACTION.CUSTOM&&u.addClass(this.customCheck,"check")},showPopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this._clearDisappearTimer();!1===this._isTooltipDialogOpened&&(this.showTooltipDialog(),this._isTooltipDialogOpened=!0)},hidePopup:function(a){a&&(a.stopPropagation(),a.preventDefault());this.hideTooltipDialog();
this._isTooltipDialogOpened=!1},_clearDisappearTimer:function(){this._miniModeTimer&&clearTimeout(this._miniModeTimer)}})})},"dijit/TooltipDialog":function(){define("dojo/_base/declare dojo/dom-class dojo/has dojo/keys dojo/_base/lang dojo/on ./focus ./layout/ContentPane ./_DialogMixin ./form/_FormMixin ./_TemplatedMixin dojo/text!./templates/TooltipDialog.html ./main".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){p=p("dijit.TooltipDialog",[k,b,e,f],{title:"",doLayout:!1,autofocus:!0,baseClass:"dijitTooltipDialog",
_firstFocusItem:null,_lastFocusItem:null,templateString:a,_setTitleAttr:"containerNode",postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"keydown",n.hitch(this,"_onKey")))},orient:function(a,b,c){a={"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight",
"BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft","BR-TL":"dijitTooltipBelow dijitTooltipABLeft","BL-TR":"dijitTooltipBelow dijitTooltipABRight","TL-BR":"dijitTooltipAbove dijitTooltipABRight","TR-BL":"dijitTooltipAbove dijitTooltipABLeft"}[b+"-"+c];g.replace(this.domNode,a,this._currentOrientClass||"");this._currentOrientClass=a},focus:function(){this._getFocusItems();u.focus(this._firstFocusItem)},onOpen:function(a){this.orient(this.domNode,a.aroundCorner,a.corner);var b=a.aroundNodePos;"M"==
a.corner.charAt(0)&&"M"==a.aroundCorner.charAt(0)?(this.connectorNode.style.top=b.y+(b.h-this.connectorNode.offsetHeight>>1)-a.y+"px",this.connectorNode.style.left=""):"M"==a.corner.charAt(1)&&"M"==a.aroundCorner.charAt(1)&&(this.connectorNode.style.left=b.x+(b.w-this.connectorNode.offsetWidth>>1)-a.x+"px");this._onShow()},onClose:function(){this.onHide()},_onKey:function(a){if(a.keyCode==v.ESCAPE)this.defer("onCancel"),a.stopPropagation(),a.preventDefault();else if(a.keyCode==v.TAB){var b=a.target;
this._getFocusItems();this._firstFocusItem==this._lastFocusItem?(a.stopPropagation(),a.preventDefault()):b==this._firstFocusItem&&a.shiftKey?(u.focus(this._lastFocusItem),a.stopPropagation(),a.preventDefault()):b!=this._lastFocusItem||a.shiftKey?a.stopPropagation():(u.focus(this._firstFocusItem),a.stopPropagation(),a.preventDefault())}}});t("dojo-bidi")&&p.extend({_setTitleAttr:function(a){this.containerNode.title=this.textDir&&this.enforceTextDirWithUcc?this.enforceTextDirWithUcc(null,a):a;this._set("title",
a)},_setTextDirAttr:function(a){this._created&&this.textDir==a||(this._set("textDir",a),this.textDir&&this.title&&(this.containerNode.title=this.enforceTextDirWithUcc(null,this.title)))}});return p})},"builder/plugins/attribute-config/CustomLogoPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/sniff builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./CustomLogoPage.html".split(" "),function(p,g,t,v,n,m,u,k){return p([m,u],{templateString:k,baseClass:"custom-logo-page",
nls:null,imageChooser:null,postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,window.jimuNls);this.nls=g.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.noImage.innerHTML=this.nls.symbolChooser.noFileChoosen;var f=this.imageChooser.getImageData();this.setImage(f);this.link&&this.setLink(this.link);this.own(v(this.chooseImageBtn,"click",g.hitch(this,this.chooseImage)));this.own(v(this.imageChooser,"imageChange",g.hitch(this,function(e){this.setImage(e)})))},
setImage:function(f){t.addClass(this.image,"hide");t.addClass(this.noImage,"hide");""===f?t.removeClass(this.noImage,"hide"):(t.removeClass(this.image,"hide"),t.attr(this.image,"src",f))},chooseImage:function(){var f=this.imageChooser.mask;if(n("safari")){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);f.dispatchEvent(e)}else f.click()},setLink:function(f){this.linkText.setValue(f)},getLink:function(){var f=this.linkText.getValue();""!==f&&!1===/^\/\//.test(f)&&!1===/(^(.+):\/\/)/.test(f)&&
(f="http://"+f);return f},isValid:function(){return!1===this.linkText.isValid()?!1:!0}})})},"jimu/dijit/CheckBox":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/Evented ./a11y/CheckBox".split(" "),function(p,g,t,v,n,m,u){p=p([g,m],{baseClass:"jimu-checkbox",declaredClass:"jimu.dijit.CheckBox",checked:!1,disabled:!1,status:!0,label:"",title:"",postCreate:function(){this.checkNode=v.create("div",{"class":"checkbox jimu-float-leading jimu-icon jimu-icon-checkbox"},
this.domNode);this.labelNode=v.create("div",{"class":"label jimu-float-leading",innerHTML:this.label||""},this.domNode);this.checked&&(v.addClass(this.checkNode,"checked"),v.addClass(this.checkNode,"jimu-icon-checked"));this.status=this._getStatusByDisabled(this.disabled);this.status||(v.addClass(this.domNode,"jimu-state-disabled"),v.addClass(this.checkNode,"jimu-state-disabled"));this.a11y_setDisabled(!this.status);this.own(this.watch("disabled",t.hitch(this,function(){this.setStatus(this._getStatusByDisabled(this.disabled))})));
this._udpateLabelClass();this.a11y_init()},setLabel:function(g){this.label=g;this.labelNode.innerHTML=this.label;this.labelNode.title=this.label;this.a11y_updateAriaLabel(g);this._udpateLabelClass()},_udpateLabelClass:function(){this.labelNode&&(this.labelNode.innerHTML?v.removeClass(this.labelNode,"not-visible"):v.addClass(this.labelNode,"not-visible"))},setValue:function(g){this.status&&(!0===g?this.check():this.uncheck())},getValue:function(){return this.checked},setStatus:function(g){g=!!g;var f=
this.status!==g;(this.status=g)?(n.remove(this.domNode,"jimu-state-disabled"),v.removeClass(this.checkNode,"jimu-state-disabled")):(n.add(this.domNode,"jimu-state-disabled"),v.addClass(this.checkNode,"jimu-state-disabled"));this.a11y_setDisabled(!this.status);f&&this.emit("status-change",g)},getStatus:function(){return this.status},check:function(g){if(this.status&&(this.checked=!0,v.addClass(this.checkNode,"checked jimu-icon-checked"),v.removeClass(this.checkNode,"checked jimu-icon-checkbox"),!g))this.onStateChange()},
uncheck:function(g){if(this.status&&(this.checked=!1,v.removeClass(this.checkNode,"checked"),v.removeClass(this.checkNode,"jimu-icon-checked"),v.addClass(this.checkNode,"jimu-icon-checkbox"),!g))this.onStateChange()},onStateChange:function(){if(this.onChange&&t.isFunction(this.onChange))this.onChange(this.checked);this.emit("change",this.checked);this.a11y_changeAriaCheckedAttr()},focus:function(){this.checkNode&&this.checkNode.focus&&this.checkNode.focus()},_getStatusByDisabled:function(g){return!0===
g||"true"===g||"disabled"===g?!1:!0}});p.extend(u);return p})},"jimu/dijit/a11y/CheckBox":function(){define(["dojo/_base/lang","dojo/on","dojo/_base/html","dijit/a11yclick"],function(p,g,t,v){return{a11y_init:function(){t.setAttr(this.domNode,"tabindex","0");t.setAttr(this.domNode,"role","checkbox");this.a11y_updateAriaLabel(this.label);""===this.label&&t.setAttr(this.domNode,"title",this.title);this.a11y_changeAriaCheckedAttr();this.own(g(this.domNode,"focus",p.hitch(this,function(){t.addClass(this.checkNode,
"dijitCheckBoxFocused")})));this.own(g(this.domNode,"blur",p.hitch(this,function(){t.removeClass(this.checkNode,"dijitCheckBoxFocused")})));this.own(g(this.domNode,v,p.hitch(this,function(){this.status&&(this.checked?this.uncheck():this.check())})))},a11y_changeAriaCheckedAttr:function(){t.setAttr(this.domNode,"aria-checked",this.checked?"true":"false")},a11y_setDisabled:function(g){g=g.toString();"false"===g?t.removeAttr(this.domNode,"disabled"):t.setAttr(this.domNode,"disabled",g);t.setAttr(this.domNode,
"aria-disabled",g)},a11y_updateAriaLabel:function(g){t.setAttr(this.domNode,"aria-label",g)}}})},"esri/arcgis/AppProxyManager":function(){define("dojo/_base/declare dojo/_base/lang ../kernel dojo/uacss dojo/Deferred dojo/promise/all dojo/json dojo/Evented dojo/Stateful ../request ./utils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p([k,f],{constructor:function(a){this.defaults={appid:"",referrers:[],proxies:[]};a=g.mixin({},this.defaults,a);this.set(a);this._init()},updateProxy:function(a){var b=
new n;if(!a||!a.proxyId)return b.reject("A proxyId is required to update a proxy"),b.promise;var f={sourceUrl:a.sourceUrl};a.intervalSeconds&&!isNaN(a.intervalSeconds)&&(f.intervalSeconds=a.intervalSeconds);a.hitsPerInterval&&!isNaN(a.hitsPerInterval)&&(f.hitsPerInterval=a.hitsPerInterval);var k=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(k+=this._folderId+"/");k+="items/"+this.appid+"/proxies/"+a.proxyId+"/update";e({url:k,content:{proxy:u.stringify(f),f:"json"},callbackParamName:"callback"},
{usePost:!0}).then(g.hitch(this,function(a){a=a&&a.appProxies||[];this.set("proxies",a);b.resolve(a)}),b.reject);return b.promise},createProxies:function(a){var b=new n;this._registerApp(this._appItem).then(g.hitch(this,function(){for(var c={referrers:this.referrers},f=[],k=0;k<a.length;k++){var m=a[k],n={sourceUrl:m.sourceUrl};m.intervalSeconds&&!isNaN(m.intervalSeconds)&&(n.intervalSeconds=m.intervalSeconds);m.hitsPerInterval&&!isNaN(m.hitsPerInterval)&&(n.hitsPerInterval=m.hitsPerInterval);f.push(n)}k=
this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(k+=this._folderId+"/");k+="items/"+this.appid+"/createProxies";e({url:k,content:{proxies:u.stringify(f),serviceProxyParams:u.stringify(c),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(g.hitch(this,function(a){a=a&&a.appProxies||[];this.set("proxies",a);b.resolve(a)}),b.reject)}),b.reject);return b.promise},deleteProxies:function(a){var b=new n,f={f:"json"},k=[];if(a&&a.length)for(var m=0;m<a.length;m++)k.push(a[m].proxyId);
k&&k.length&&(f.proxies=k.toString());a=this._sharingBaseUrl+"content/users/"+this._owner+"/";this._folderId&&(a+=this._folderId+"/");a+="items/"+this.appid+"/deleteProxies";e({url:a,content:f,callbackParamName:"callback"},{usePost:!0}).then(g.hitch(this,function(a){var c=this.proxies.slice();a=a&&a.results||[];if(c&&c.length&&a&&a.length)for(var e=0;e<c.length;e++)for(var f=c[e],g=f.proxyId,k=0;k<a.length;k++){var m=a[k].proxyId;m&&g&&m===g&&(f.proxied=!1)}this.set("proxies",c);b.resolve(c)}),b.reject);
return b.promise},_parseUrl:function(a){var b=document.createElement("a");b.href=a;return b},_init:function(){this.appid?b.getItem(this.appid).then(g.hitch(this,function(a){this._appItem=a;this._folderId=a.item.ownerFolder;var b=this._parseUrl(a.item.url);this._sharingBaseUrl="https://"+b.hostname+"/sharing/rest/";var e=b.pathname.substring(0,b.pathname.lastIndexOf("/")),e="/"===e.charAt(0)?e:"/"+e,f=b.hostname+e;this.referrers.push("http://"+f,"https://"+f,"http://www.arcgis.com"+e,"https://www.arcgis.com"+
e);-1!==b.hostname.indexOf("mapsdevext.arcgis.com")&&this.referrers.push("http://devext.arcgis.com"+e,"https://devext.arcgis.com"+e);-1!==b.hostname.indexOf("mapsqa.arcgis.com")&&this.referrers.push("http://qaext.arcgis.com"+e,"https://qaext.arcgis.com"+e);this._owner=a.item.owner;-1!==a.item.typeKeywords.indexOf("App Proxy")&&a.item.appProxies&&this.set("proxies",a.item.appProxies);this.emit("load",{});this.set("loaded",!0)})):console.error("AppProxyManager: appid required.")},_registerApp:function(a){var b=
new n,f=a.item.id,k=this._sharingBaseUrl+"oauth2/",m=this.referrers;this._registered&&this._registered===this.appid?b.resolve(a):-1!==a.item.typeKeywords.indexOf("Registered App")?b.resolve(a):e({url:k+"/registerApp",content:{itemId:f,appType:"browser",redirect_uris:u.stringify(m),f:"json"},callbackParamName:"callback"},{usePost:!0}).then(g.hitch(this,function(a){this._registered=this.appid;b.resolve(a)}),b.reject);return b.promise}})})},"builder/plugins/attribute-config/AppProxyUtil":function(){define(["dojo/_base/array",
"dojo/Deferred","jimu/portalUtils"],function(p,g,t){function v(e){return p.some(u,function(b){return-1<e.search(b)})}function n(e){return p.some(k,function(b){return-1<e.search(b)})}function m(e){var b=new g;if(e){e=[].concat(e.operationalLayers,e.baseMap&&e.baseMap.baseMapLayers);var a=[],c={},f;p.forEach(e,function(b){var e,g;b&&b.url&&(e=b.url,g=document.createElement("a"),g.href=e,e=v(g.host),g=n(g.host),e||g)&&(c[b.url]?(f=c[b.url],f.title=f.title+", "+(b.title||b.name)):(f={sourceUrl:b.url,
title:b.title||b.name,premium:e,consumeCredits:g,useProxy:!1},a.push(f),c[b.url]=f))});b.resolve(a)}else b.resolve([]);return b}var u=[/traffic\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/hydro\w*\.arcgis\.com/i,/naip\w*\.arcgis\.com/i,/livefeeds\w*\.arcgis\.com/i,/demographics\w*\.arcgis\.com/i,/landscape\w*\.arcgis\.com/i,/historical\w*\.arcgis\.com/i,/earthobs\w*\.arcgis\.com/i],k=[/demographics\w*\.arcgis\.com/i,/geoenrich\w*\.arcgis\.com/i,/route\w*\.arcgis\.com/i,
/logistics\w*\.arcgis\.com/i,/analysis\w*\.arcgis\.com/i,/elevation\w*\.arcgis\.com/i],f={queryForSecureServicesInMap:function(e,b){try{return t.getPortal(e).getItemData(b).then(function(a){return m(a)},function(){return[]})}catch(a){return e=new g,e.resolve([]),e}},isLimitedProxy:function(e){return e?!isNaN(e.hitsPerInterval)&&!isNaN(e.intervalSeconds)&&0<e.intervalSeconds&&0<e.hitsPerInterval:!1},findProxy:function(e,b){var a=f.isLimitedProxy(b),c;e=e||[];b=b||{};p.some(e,function(e){if(e.sourceUrl===
b.sourceUrl&&!1!==e.proxied&&e.proxyId&&e.proxyUrl){var g=!1;a&&e.hitsPerInterval===b.hitsPerInterval&&e.intervalSeconds===b.intervalSeconds?g=!0:a||f.isLimitedProxy(e)||(g=!0);g&&(c=e);return g}});return c},urlExists:function(e,b){return p.some(e.proxies,function(a){return a.sourceUrl===b&&!1!==a.proxied})},createProxy:function(e,b,a,c){var k,m,p,u=new g,t={};k=v(b);m=n(b);(p=f.findProxy(e.proxies,{sourceUrl:b,hitsPerInterval:a,intervalSeconds:c}))?(p.premium=k,p.consumeCredits=m,u.resolve(p)):(t.sourceUrl=
b,f.isLimitedProxy({hitsPerInterval:a,intervalSeconds:c})&&(t.hitsPerInterval=a,t.intervalSeconds=c),e.createProxies([t]).then(function(e){(p=f.findProxy(e,{sourceUrl:b,hitsPerInterval:a,intervalSeconds:c}))?(p.premium=k,p.consumeCredits=m,u.resolve(p)):u.reject("create proxy failed.")}).otherwise(function(a){u.reject(a)}));return u}};f.isPremium=v;f.consumesCredits=n;return f})},"builder/plugins/attribute-config/MapProxyItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapProxyItem.html ./AppProxyUtil jimu/dijit/CheckBox dijit/form/NumberSpinner dijit/form/Select".split(" "),
function(p,g,t,v,n,m,u,k,f,e){p=p([m,u,k,v],{baseClass:"map-proxy-item",templateString:f,appProxyManager:null,sourceUrl:"",title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,intervalSeconds:0,hitsPerInterval:0,postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,window.jimuNls.common);this.nls=g.mixin(this.nls,window.jimuNls.timeUnit)},postCreate:function(){this.inherited(arguments);!0===this.consumeCredits?t.setStyle(this.consumeCreditsContent,
"visibility","visible"):t.setStyle(this.consumeCreditsContent,"visibility","hidden");t.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):this.useProxyCheckBox.setValue(!1);isNaN(this.hitsPerInterval)||this.limitSpinner.set("value",this.hitsPerInterval);isNaN(this.intervalSeconds)||this.intervalSelect.set("value",this.intervalSeconds);this._updateLimitLabel();this.own(n(this.useProxyCheckBox,
"change",g.hitch(this,this._onUseProxyChange)));this.own(n(this.cancelBtn,"click",g.hitch(this,function(){this._hideDialog()})));this.own(n(this.okBtn,"click",g.hitch(this,function(){this._hideDialog();this._updateProxy()})));this.own(n(document.body,"click",g.hitch(this,function(b){if(!t.hasClass(this.settingDialog,"hidden")){var a=b.target||b.srcElement,c;b=a===this.settingDialog;c=t.isDescendant(a,this.settingDialog);a=t.isDescendant(a,this.settingBtn);b||c||a||this._hideDialog()}})));this.own(n(this.settingBtn,
"click",g.hitch(this,function(){this._toggleDialog()})))},_hideDialog:function(){t.addClass(this.settingDialog,"hidden");t.removeClass(this.settingBtn,"highight")},_showDialog:function(){t.removeClass(this.settingDialog,"hidden");t.addClass(this.settingBtn,"highight")},_toggleDialog:function(){t.hasClass(this.settingDialog,"hidden")?this._showDialog():this._hideDialog()},_updateLimitLabel:function(){!isNaN(this.hitsPerInterval)&&0<this.hitsPerInterval?this.requestLimitNode.innerHTML=this.hitsPerInterval:
this.requestLimitNode.innerHTML=this.nls.unlimit;switch(this.intervalSeconds){case 1:this.intervalNode.innerHTML=this.nls.second;break;case 60:this.intervalNode.innerHTML=this.nls.minute;break;case 3600:this.intervalNode.innerHTML=this.nls.hour;break;case 86400:this.intervalNode.innerHTML=this.nls.day;break;default:this.intervalNode.innerHTML=this.nls.none}},_updateProxy:function(){var b=this.hitsPerInterval,a=this.intervalSeconds;this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=
+this.limitSpinner.get("value");this._updateLimitLabel();this.useProxy&&this.appProxyManager&&(b!==this.hitsPerInterval||a!==this.previousIntervalSeconds)&&(this._startProcess("update proxy"),this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(g.hitch(this,function(){this._createProxy()})).otherwise(g.hitch(this,function(){this._stopProcess()})))},_onUseProxyChange:function(b){b&&!this.proxyId&&this._createProxy();!b&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");
this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=+this.limitSpinner.get("value");try{e.createProxy(this.appProxyManager,this.sourceUrl,this.hitsPerInterval,this.intervalSeconds).then(g.hitch(this,function(b){this.proxyUrl=b.proxyUrl;this.proxyId=b.proxyId;this.useProxy=!0;this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,proxyId:this.proxyId,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds,title:this.title,useProxy:!0});this._stopProcess("Create Proxy",
!0)})).otherwise(g.hitch(this,function(b){this._createProxiesFail(b)}))}catch(b){this._createProxiesFail(b)}},_createProxiesFail:function(b){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+" "+this.sourceUrl);this._stopProcess(b||"Create Proxy",!1)},_deleteProxy:function(){var b=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:b}])}catch(a){console.error(a)}this._stopProcess("Delete Proxy",
!1)},_startProcess:function(b){t.setStyle(this.loading,"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",b)},_stopProcess:function(b,a){t.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof a&&this.useProxyCheckBox.setValue(a);this.emit("processEnd",b)}});p.PROXY_CREATED="proxyCreated";p.PROXY_DELETED="proxyDeleted";p.PROCESS_START="processStart";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare",
"dojo/keys","./_Spinner","./NumberTextBox"],function(p,g,t,v){return p("dijit.form.NumberSpinner",[t,v.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(g,m){var n=this.constraints,k=isNaN(g),f=!isNaN(n.max),e=!isNaN(n.min);k&&0!=m&&(g=0<m?e?n.min:f?n.max:0:f?this.constraints.max:e?n.min:0);m=g+m;if(k||isNaN(m))return g;f&&m>n.max&&(m=n.max);e&&m<n.min&&(m=n.min);return m},_onKeyDown:function(n){if(!(this.disabled||this.readOnly||n.keyCode!=g.HOME&&n.keyCode!=g.END||
n.ctrlKey||n.altKey||n.metaKey||"undefined"==typeof this.get("value"))){var m=this.constraints[n.keyCode==g.HOME?"min":"max"];"number"==typeof m&&this._setValueAttr(m,!1);n.stopPropagation();n.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),function(p,g,t,v,n,m,u,k,f,e){return p("dijit.form._Spinner",k,{defaultTimeout:500,
minimumTimeout:10,timeoutChangeRate:.9,smallDelta:1,largeDelta:10,templateString:f,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(b){return b},_arrowPressed:function(b,a,c){this.disabled||this.readOnly||(this._setValueAttr(this.adjust(this.get("value"),a*c),!1),e.selectInputText(this.textbox,this.textbox.value.length))},_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(b,a,c){var e=
this.smallDelta;a==this.textbox&&(a=c.keyCode,e=a==g.PAGE_UP||a==g.PAGE_DOWN?this.largeDelta:this.smallDelta,a=a==g.UP_ARROW||a==g.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==b?this._arrowReleased(a):this._arrowPressed(a,a==this.upArrowNode?1:-1,e)},_wheelTimer:null,_mouseWheeled:function(b){if(this.focused){b.stopPropagation();b.preventDefault();var a=b.wheelDelta/120;Math.floor(a)!=a&&(a=0<b.wheelDelta?1:-1);b=b.detail?-1*b.detail:a;if(0!==b){var c=this[0<b?"upArrowNode":"downArrowNode"];this._arrowPressed(c,
b,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(c)},50)}}},_setConstraintsAttr:function(b){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(b,
a){this.focusNode.setAttribute("aria-valuenow",b);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,n.wheel,t.hitch(this,"_mouseWheeled")),u.addListener(this.upArrowNode,this.textbox,{keyCode:g.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),u.addListener(this.downArrowNode,this.textbox,{keyCode:g.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,
"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),u.addListener(this.upArrowNode,this.textbox,{keyCode:g.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),u.addListener(this.downArrowNode,this.textbox,{keyCode:g.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"builder/plugins/attribute-config/UrlProxyItem":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/_base/lang","dojo/Evented","./AppProxyUtil"],function(p,g,t,v,n){p=p([v],{appProxyManager:null,title:"",sourceUrl:"",proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,hitsPerInterval:0,intervalSeconds:0,constructor:function(g){t.mixin(this,g);this.premium=n.isPremium(this.sourceUrl);this.consumeCredits=n.consumesCredits(this.sourceUrl)},createProxy:function(){if(this.premium||this.consumeCredits)if(n.urlExists(this.appProxyManager,this.sourceUrl))this.emit("processError",
this.nls.alreadyProxied);else{this._startProcess();try{n.createProxy(this.appProxyManager,this.sourceUrl,this.hitsPerInterval,this.intervalSeconds).then(t.hitch(this,function(g){this.proxyUrl=g.proxyUrl;this.proxyId=g.proxyId;this.useProxy=!0;this.premium=g.premium;this.consumeCredits=g.consumeCredits;this._stopProcess();this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,proxyId:this.proxyId,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds,premium:this.premium,
consumeCredits:this.consumeCredits,title:this.title,useProxy:!0})})).otherwise(t.hitch(this,function(){this._stopProcess()}))}catch(m){this.emit("processError",m),this._stopProcess()}}else this.emit("processError",this.nls.notValidPremiumUrl)},deleteProxy:function(){this._startProcess();if(this.appProxyManager&&this.proxyId)try{this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(t.hitch(this,function(m){var n=g.some(m,t.hitch(this,function(g){return g.sourceUrl===this.sourceUrl&&!1===
g.proxied}));n||(n=g.every(m,t.hitch(this,function(g){return g.sourceUrl!==this.sourceUrl})));n?(this.proxyId=this.proxyUrl="",this.emit("proxyDeleted",this.sourceUrl)):this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}),t.hitch(this,function(){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl);this._stopProcess()}))}catch(m){this.emit("processError",this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()}else this.emit("processError",
this.nls.deleteProxyFailed+" "+this.sourceUrl),this._stopProcess()},_startProcess:function(){this.emit("processStart")},_stopProcess:function(){this.emit("processEnd")}});p.PROXY_CREATED="proxyCreated";p.PROCESS_START="processStart";p.PROXY_DELETED="proxyDeleted";p.PROCESS_END="processEnd";p.PROCESS_ERROR="processError";return p})},"builder/dijit/LinkEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LinkEditor.html dojo/on dojo/dom-geometry dojo/Evented ./LinkItemEditor ./LinkItem".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return p([n,m,e],{templateString:u,baseClass:"link-editor",btnLabel:"",linkList:[],canEdit:!0,canDelete:!0,isRest:!1,isProxy:!1,beforeAdd:null,afterAdd:null,beforeUpdate:null,afterUpdate:null,beforeDelete:null,afterDelete:null,postMixInProperties:function(){this.nls=g.mixin(this.nls,window.jimuNls.common);""===this.btnLabel&&(this.btnLabel="Add Link")},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.btnLabel;this.setItems(this.linkList);
this.editor=new b({nls:this.nls,isRest:this.isRest,isProxy:this.isProxy});this.editor.placeAt(this.domNode);this.editor.startup();this.editor.hide();this.own(k(this.editor,"updated",g.hitch(this,this._updateLinkItem)));this.own(k(this.addLinkBtn,"click",g.hitch(this,function(){this._showEditor(null)})))},clearItems:function(){this.linkItems=[];t.empty(this.linkListNode)},setItems:function(a){this.clearItems();this.linkList=a;v.forEach(this.linkList,g.hitch(this,function(a){this._addItem(a,!1)}))},
getItems:function(){return this.linkItems},_showEditor:function(a){var b;null!==a?b=f.position(a.domNode):(b=f.position(this.addLinkBtn),b.y+=b.h);this.editor.show(-1E3,0);var c=f.getMarginBox(this.editor.contentNode),e=f.getMarginBox(jimuConfig.layoutId);b.y+c.h+50>e.h&&(b.y=e.h-c.h-50);this.editor.setLinkItem(a);this.editor.show(b.x,b.y)},_addItem:function(a,b){b&&"function"===typeof this.beforeAdd?this.beforeAdd(a).then(g.hitch(this,function(b){b&&(this.isProxy&&(a.proxyId=b.proxyId,a.proxyUrl=
b.proxyUrl,a.premium=b.premium,a.consumeCredits=b.consumeCredits,a.hitsPerInterval=b.hitsPerInterval,a.intervalSeconds=b.intervalSeconds),this._doAddItem(a))})):this._doAddItem(a,b)},_doAddItem:function(b,e){b=new a({nls:this.nls,label:b.label,url:b.url,isProxy:this.isProxy,proxyId:b.proxyId,proxyUrl:b.proxyUrl,premium:b.premium,consumeCredits:b.consumeCredits,hitsPerInterval:b.hitsPerInterval,intervalSeconds:b.intervalSeconds,canEdit:this.canEdit,canDelete:this.canDelete});b.placeAt(this.linkListNode);
b.startup();this.linkItems.push(b);this.own(k(b,"delete",g.hitch(this,this._deleteItem)));this.own(k(b,"edit",g.hitch(this,function(a){this._showEditor(a)})));e&&"function"===typeof this.afterAdd&&this.afterAdd(b)},_updateLinkItem:function(a){if(null===a.linkItem){var b={label:a.newValue.label,url:a.newValue.url};this.isProxy&&(b.hitsPerInterval=a.newValue.hitsPerInterval,b.intervalSeconds=a.newValue.intervalSeconds);this._addItem(b,!0)}else"function"===typeof this.beforeUpdate?this.beforeUpdate(a.linkItem,
a.newValue.label,a.newValue.url).then(g.hitch(this,function(b){!0===b&&this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)})):this._doUpdateItem(a.linkItem,a.newValue.label,a.newValue.url)},_doUpdateItem:function(a,b,e){a.update(b,e);"function"===typeof this.afterUpdate&&this.afterUpdate(a,b,e)},_deleteItem:function(a){"function"===typeof this.beforeDelete?this.beforeDelete(a).then(g.hitch(this,function(b){!0===b&&this._doDeleteItem(a)})):this._doDeleteItem(a)},_doDeleteItem:function(a){this.linkItems=
v.filter(this.linkItems,function(b){return b!==a});t.destroy(a.domNode);"function"===typeof this.afterDelete&&this.afterDelete(a)}})})},"builder/dijit/LinkItemEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/ValidationTextBox jimu/dijit/URLInput dojo/text!./templates/LinkItemEditor.html dojo/on dojo/dom-style dojo/Evented dijit/form/NumberSpinner dijit/form/Select".split(" "),function(p,g,
t,v,n,m,u,k,f,e,b,a){return p([v,n,m,a],{templateString:f,baseClass:"link-item-editor",linkItem:null,isRest:!1,isProxy:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,window.jimuNls.common);this.nls=g.mixin(this.nls,window.jimuNls.timeUnit)},postCreate:function(){this.inherited(arguments);this.isProxy&&t.addClass(this.domNode,"proxy-editor");this.urlInput=new k({required:!0,rest:this.isRest,placeHolder:this.nls.inputURL,value:this.linkItem?this.linkItem.url:"",
style:"width:100%"});this.urlInput.placeAt(this.urlNode);this.urlInput.startup();this.titleInput=new u({required:!0,trim:!0,placeHolder:this.nls.inputTitle,value:this.linkItem?this.linkItem.label:"",style:"width: 100%"});this.titleInput.placeAt(this.titleNode);this.titleInput.startup();this.isProxy?(t.setStyle(this.proxyNode,"display","block"),this.limitSpinner.set("value",this.linkItem?this.linkItem.hitsPerInterval:0),this.intervalSelect.set("value",this.linkItem?this.linkItem.intervalSeconds:0)):
t.setStyle(this.proxyNode,"display","none");this.own(e(this.okBtn,"click",g.hitch(this,this._onOkClicked)));this.own(e(this.cancelBtn,"click",g.hitch(this,this.hide)));this.own(e(this.domNode,"click",g.hitch(this,this._onDomClicked)))},setLinkItem:function(a){this.linkItem=a;this.titleInput.set("value",a?a.label:"");this.urlInput.set("value",a?a.url:"");this.isProxy&&(this.limitSpinner.set("value",a?a.hitsPerInterval:0),this.intervalSelect.set("value",a?a.intervalSeconds:0))},_onDomClicked:function(a){t.isDescendant(a.target||
a.srcElement,this.contentNode)||this.hide()},show:function(a,e){b.set(this.domNode,"display","");b.set(this.contentNode,{left:a+"px",top:e+"px"})},hide:function(){b.set(this.domNode,"display","none")},_onOkClicked:function(){if(this.urlInput.isValid()&&this.titleInput.isValid()){var a={},b=this.titleInput.get("value"),e=this.urlInput.get("value");a.label=b;a.url=e;this.isProxy&&(a.hitsPerInterval=+this.limitSpinner.get("value"),a.intervalSeconds=+this.intervalSelect.get("value"));this.linkItem&&b===
this.linkItem.label&&e===this.linkItem.url||(this.emit("updated",{linkItem:this.linkItem,newValue:a,hitsPerInterval:+this.limitSpinner.get("value"),intervalSeconds:+this.intervalSelect.get("value")}),this.hide())}}})})},"jimu/dijit/URLInput":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(p,g,t,v){return p([t],{declaredClass:"jimu.dijit.URLInput",required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allowLocal:!0,
postMixInProperties:function(){this.inherited(arguments);this.invalidMessage=(this.nls=window.jimuNls.urlInput)?this.nls.invalidUrl:"Invalid Url"},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-url-input")},validator:function(g){if(!1===this.required&&""===g)return!0;if(isFinite(g))return!1;var m="^"+v.url({allowNamed:this.allowNamed,allowLocal:this.allowLocal}),m=new RegExp(m,"g");m.lastIndex=0;m=m.test(g);return this.rest?(g=/\/rest\/services/gi.test(g),m&&g):m}})})},
"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(p,g,t){var v=p.getObject("validate.regexp",!0,t);return v=t.validate.regexp={ipAddress:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowDottedDecimal&&(g.allowDottedDecimal=!0);"boolean"!=typeof g.allowDottedHex&&(g.allowDottedHex=!0);"boolean"!=typeof g.allowDottedOctal&&(g.allowDottedOctal=!0);"boolean"!=typeof g.allowDecimal&&(g.allowDecimal=!0);"boolean"!=typeof g.allowHex&&(g.allowHex=
!0);"boolean"!=typeof g.allowIPv6&&(g.allowIPv6=!0);"boolean"!=typeof g.allowHybrid&&(g.allowHybrid=!0);var m=[];g.allowDottedDecimal&&m.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");g.allowDottedHex&&m.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");g.allowDottedOctal&&m.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");g.allowDecimal&&m.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
g.allowHex&&m.push("0[xX]0*[\\da-fA-F]{1,8}");g.allowIPv6&&m.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");g.allowHybrid&&m.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");g="";0<m.length&&(g="("+m.join("|")+")");return g},host:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowIP&&(g.allowIP=!0);"boolean"!=typeof g.allowLocal&&(g.allowLocal=!1);"boolean"!=typeof g.allowPort&&(g.allowPort=!0);"boolean"!=typeof g.allowNamed&&
(g.allowNamed=!1);var m=g.allowPort?"(\\:\\d+)?":"",n="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)";g.allowIP&&(n+="|"+v.ipAddress(g));g.allowLocal&&(n+="|localhost");g.allowNamed&&(n+="|^[^-][a-zA-Z0-9_-]*");return"("+n+")"+m},url:function(n){n="object"==typeof n?n:{};"scheme"in n||(n.scheme=[!0,!1]);return g.buildGroupRE(n.scheme,function(g){return g?"(https?|ftps?)\\://":""})+v.host(n)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},
emailAddress:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowCruft&&(g.allowCruft=!1);g.allowPort=!1;var m="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+v.host(g);g.allowCruft&&(m="\x3c?(mailto\\:)?"+m+"\x3e?");return m},emailAddressList:function(g){g="object"==typeof g?g:{};"string"!=typeof g.listSeparator&&(g.listSeparator="\\s;,");var m=v.emailAddress(g);return"("+m+"\\s*["+g.listSeparator+"]\\s*)*"+m+"\\s*["+g.listSeparator+"]?\\s*"},numberFormat:function(n){n=
"object"==typeof n?n:{};"undefined"==typeof n.format&&(n.format="###-###-####");return g.buildGroupRE(n.format,function(m){return g.escapeString(m,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(g){g="object"==typeof g?g:{};"boolean"!=typeof g.allowTerritories&&(g.allowTerritories=!0);"boolean"!=typeof g.allowMilitary&&(g.allowMilitary=!0);
var m="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";g.allowTerritories&&(m+="|AS|FM|GU|MH|MP|PW|PR|VI");g.allowMilitary&&(m+="|AA|AE|AP");return"("+m+")"}}}})},"builder/dijit/LinkItem":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/dom-style dojo/dom-class dojo/Evented".split(" "),function(p,g,t,v,n,m,u,k,f){return p([t,
v,f],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"titleNode" title\x3d"${url}"\x3e${label}\x3c/div\x3e\x3cdiv class\x3d"action" data-dojo-attach-point\x3d"actionSection" style\x3d"display:none;"\x3e\x3cdiv class\x3d"btn delete-btn" data-dojo-attach-point\x3d"deleteBtn" title\x3d"${nls.deleteLink}"\x3e\x3c/div\x3e\x3cdiv class\x3d"btn edit-btn" data-dojo-attach-point\x3d"editBtn" title\x3d"${nls.editLink}"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"access-limit" data-dojo-attach-point\x3d"accessLimitNode"\x3e${nls.requestLimit}: \x3cspan data-dojo-attach-point\x3d"requestLimitNode"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;${nls.interval}: \x3cspan data-dojo-attach-point\x3d"intervalNode"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
baseClass:"link-item",label:"",url:"",isProxy:!1,proxyId:"",proxyUrl:"",hitsPerInterval:0,intervalSeconds:0,canEdit:!0,canDelete:!0,_tooltipTimeout:200,postCreate:function(){this.inherited(arguments);this.canDelete?(u.set(this.deleteBtn,"display","inline-block"),this.own(n(this.deleteBtn,"click",g.hitch(this,this._deleteLink)))):u.set(this.deleteBtn,"display","none");this.canEdit?(u.set(this.editBtn,"display","inline-block"),this.own(n(this.editBtn,"click",g.hitch(this,this._editLink)))):u.set(this.editBtn,
"display","none");this.own(n(this.domNode,m.enter,g.hitch(this,function(){u.set(this.actionSection,"display","")})));this.own(n(this.domNode,m.leave,g.hitch(this,function(){u.set(this.actionSection,"display","none")})));this.isProxy?(k.add(this.domNode,"is-proxy"),this._updateLabel(),u.set(this.accessLimitNode,"display","block")):u.set(this.accessLimitNode,"display","none")},update:function(e,b){this.label=e;this.url=b;this.titleNode.innerHTML=this.label;this.titleNode.title=this.url;this.isProxy&&
this._updateLabel()},_updateLabel:function(){!isNaN(this.hitsPerInterval)&&0<this.hitsPerInterval?this.requestLimitNode.innerHTML=this.hitsPerInterval:this.requestLimitNode.innerHTML=this.nls.unlimit;switch(this.intervalSeconds){case 1:this.intervalNode.innerHTML=this.nls.second;break;case 60:this.intervalNode.innerHTML=this.nls.minute;break;case 3600:this.intervalNode.innerHTML=this.nls.hour;break;case 86400:this.intervalNode.innerHTML=this.nls.day;break;default:this.intervalNode.innerHTML=this.nls.none}},
_deleteLink:function(){this.emit("delete",this)},_editLink:function(){this.emit("edit",this)}})})},"builder/plugins/attribute-config/dataSource/AdditionalDataSources":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdditionalDataSources.html dojo/on dojo/mouse dojo/query dojo/topic dojo/_base/lang dojo/_base/html jimu/dijit/_QueryableLayerSourcePopup jimu/dijit/Message jimu/utils ./DataSourceConfigPopup ./utils builder/dijit/RefreshInterval dijit/form/Select dijit/form/ValidationTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){var z=u.enter,E=u.leave;return p([g,t,v],{templateString:n,baseClass:"additional-data-sources",_layerId:"",_serviceType:"",_targetSourceId:"",layerType:"Features",_sourceType:"",postMixInProperties:function(){this.nls=e.mixin(this.nls,window.jimuNls.common,window.builderNls)},postCreate:function(){this.inherited(arguments);this._initRefreshInterval();this._renderUIByConfig();this._initEvent();this.own(f.subscribe("app/appConfigChanged",e.hitch(this,this._onAppConfigChanged)))},
setMap:function(a){a&&(this.map=a)},_onAppConfigChanged:function(a){var c=x.isEqual(this.appConfig.dataSource,a.dataSource);this.appConfig&&!c&&(this.appConfig=a,b.empty(this.sourcesList),this._renderUIByConfig())},_initRefreshInterval:function(){this.refreshIntervalDijit=new C({defaultRefreshTip:this.nls.defaultRefreshTip_dataSource,singleRefreshTip:this.nls.singleRefreshTip_dataSource});this.refreshIntervalDijit.placeAt(this.refreshIntervalDiv)},_renderUIByConfig:function(){var a=e.clone(this.appConfig.dataSource),
c=a.dataSources,f;for(f in c)"widget"!==f.split("~")[0]&&this._addSourceTr(c[f]);a=a.settings||{};c={};"undefined"!==typeof a.unifiedRefreshInterval?(c.useWebMapRefreshInterval=!1,c.minutes=a.unifiedRefreshInterval):c.useWebMapRefreshInterval=!0;this.refreshIntervalDijit.setValue(c);this._isNotEmptySourceList()?(b.setStyle(this.refreshIntervalDiv,"display",""),b.setStyle(this.tabelHeader,"display",""),b.setStyle(this.noDataSourceTip,"display","none")):(b.setStyle(this.refreshIntervalDiv,"display",
"none"),b.setStyle(this.tabelHeader,"display","none"),b.setStyle(this.noDataSourceTip,"display",""))},_onAddNewClick:function(a){a.stopPropagation();b.hasClass(this.dsOptions,"hide")?this._showDsOption():this._hiddenDsOption()},_showDsOption:function(){b.removeClass(this.dsOptions,"hide")},_hiddenDsOption:function(){b.addClass(this.dsOptions,"hide")},_onAddNewLayerClick:function(a){a.stopPropagation();this._sourceType="Features";this._addNewSource()},_onAddNewStatisticsClick:function(a){a.stopPropagation();
this._sourceType="FeatureStatistics";this._addNewSource()},_addNewSource:function(){this._hiddenDsOption();var b=new a({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,mustSupportStatistics:"FeatureStatistics"===this._sourceType,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(m(b,"ok",e.hitch(this,function(a){"FeatureStatistics"!==this._sourceType||this._isSupportStatistics(a.definition)?(this._setLayerId(a),a.label=a.name,this._serviceType=
b.getSelectedRadioType(),b.close(),b=null,this._createSourceConfigPopup(a,"add")):new c({message:this.nls.notSupportStatistics})})));this.own(m(b,"cancel",e.hitch(this,function(){b.close();b=null})))},_createSourceConfigPopup:function(a,b){e.mixin(a,{type:this._sourceType,serviceType:this._serviceType});this.sourceConfigPopup=new w({titleLabel:this.nls.configDataSource,dijitArgs:{nls:this.nls,map:this.map,config:a}});this.own(m(this.sourceConfigPopup,"ok",e.hitch(this,function(a){this.sourceConfigPopup.close();
this.sourceConfigPopup=null;"add"===b?this._addDataSourceToAppConfig(a):this._updateDataSourceOfAppConfig(a)})));this.own(m(this.sourceConfigPopup,"cancel",e.hitch(this,function(){this.sourceConfigPopup.close();this.sourceConfigPopup=null})))},_addDataSourceToAppConfig:function(a){a.id=this._generateSourceId();var b=e.clone(this.appConfig.dataSource);b.dataSources||(b.dataSources={});b.dataSources[a.id]=a;this._updateAppConfig(b)},_addSourceTr:function(a){this._sourceType=a.type;var c;"Features"===
this._sourceType?c=this.nls.layer:"FeatureStatistics"===this._sourceType&&(c=this.nls.statistics);c='\x3cdiv style\x3d"width: 100%;"\x3e\x3cdiv class\x3d"source-tr"\x3e\x3cdiv class\x3d"source-td source-tr-name textOverFlow" title\x3d"'+a.label+'"\x3e'+a.label+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-type textOverFlow" title\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"source-td source-tr-action"\x3e\x3cdiv class\x3d"edit hidden"\x3e\x3c/div\x3e\x3cdiv class\x3d"delete hidden"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"mid-line"\x3e\x3c/div\x3e\x3c/div\x3e';
c=b.toDom(c);var e=k(".source-tr",c)[0];e.source=a;b.place(c,this.sourcesList,"last");this._bindTrEvent(e)},_bindTrEvent:function(a){this.own(m(a,["click",z,E],e.hitch(this,function(a){a.stopPropagation();var c=a.type;a=a.target||a.srcElement;var e=null;if("click"===c)b.hasClass(a,"edit")?(e=a.parentElement.parentElement,this._targetSourceId=e.source.id,this._editSourceTr(e)):b.hasClass(a,"delete")&&(e=a.parentElement.parentElement,this._targetSourceId=e.source.id,this._deleteSourceTr(e));else{var f=
null,g=null;b.hasClass(a,"edit")?(f=a,e=f.parentElement.parentElement):b.hasClass(a,"delete")?(g=a,e=g.parentElement.parentElement):b.hasClass(a,"source-tr")&&(e=a);if(f||g||e)"mouseover"===c?(b.removeClass(k(".source-td .edit",e)[0],"hidden"),b.removeClass(k(".source-td .delete",e)[0],"hidden")):"mouseout"===c&&(b.addClass(k(".source-td .edit",e)[0],"hidden"),b.addClass(k(".source-td .delete",e)[0],"hidden"))}})))},_editSourceTr:function(a){a=a.source;this._sourceType=a.type;var b={id:a.id,label:a.label,
url:a.url,filter:a.filter,filterByExtent:a.filterByExtent,isDynamic:a.isDynamic,resultRecordType:a.resultRecordType,refreshInterval:a.refreshInterval,dataSchema:a.dataSchema};"undefined"!==typeof a.resultRecordCount&&(b.resultRecordCount=a.resultRecordCount);"undefined"!==typeof a.portalUrl&&(b.portalUrl=a.portalUrl);"undefined"!==typeof a.itemId&&(b.itemId=a.itemId);this._createSourceConfigPopup(b)},_updateDataSourceOfAppConfig:function(a){a.id=this._targetSourceId;var b=e.clone(this.appConfig.dataSource),
c;for(c in b.dataSources)c===this._targetSourceId&&(b.dataSources[c]=a);this._updateAppConfig(b)},_deleteSourceTr:function(){var a=new c({message:this.nls.removeSourceMessage,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){this._deleteDataSourceOfAppConfig();a.content=null;a.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:e.hitch(this,function(){a.content=null;a.close()})}]})},_deleteDataSourceOfAppConfig:function(){var a=e.clone(this.appConfig.dataSource);delete a.dataSources[this._targetSourceId];
this._updateAppConfig(a)},_updateDataSettingsOfAppConfig:function(){var a={},b=e.clone(this.appConfig.dataSource),c=this.refreshIntervalDijit.getValue();"undefined"!==typeof c.minutes&&(a.unifiedRefreshInterval=c.minutes);b.settings=a;this._updateAppConfig(b)},_updateAppConfig:function(a){f.publish("dataSourceChanged",a)},_generateSourceId:function(){if(this._serviceType)return q.createDataSourceId(this._serviceType,this._layerId)},_setLayerId:function(a){a.layerInfo&&a.layerInfo.id&&(this._layerId=
a.layerInfo.id)},_initEvent:function(){this.own(m(document.body,"click",e.hitch(this,function(){this._hiddenDsOption()})));this.own(m(this.refreshIntervalDijit,"user-input-change",e.hitch(this,function(){this._isNotEmptySourceList()&&this._updateDataSettingsOfAppConfig()})));this.own(m(this.addNewDs,[z,E],e.hitch(this,function(a){a.stopPropagation();var c=a.type;k("div",this.addNewDs).forEach(function(a){b.hasClass(a,"img_add")?"mouseover"===c?b.addClass(a,"img_add_hover"):"mouseout"===c&&b.removeClass(a,
"img_add_hover"):b.hasClass(a,"text_add")&&("mouseover"===c?b.addClass(a,"text_add_hover"):"mouseout"===c&&b.removeClass(a,"text_add_hover"))}.bind(this))})))},_isNotEmptySourceList:function(){return 0<k(".source-tr",this.sourcesList).length},_isSupportStatistics:function(a){return a&&"object"===typeof a?a.advancedQueryCapabilities?!!a.advancedQueryCapabilities.supportsStatistics:!!a.supportsStatistics:!1},destroy:function(){this.refreshIntervalDijit&&this.refreshIntervalDijit.destroy();this.inherited(arguments)}})})},
"jimu/dijit/_QueryableLayerSourcePopup":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare jimu/dijit/Popup jimu/dijit/QueryableLayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(p,g,t,v,n,m,u,k,f){return n([m,g],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);v.addClass(this.domNode,"jimu-queryable-layer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.sourceDijit.getSelectedRadioType()},
_initFls:function(){this.sourceDijit=new u(this.dijitArgs);this.sourceDijit.placeAt(this.contentContainerNode);this.sourceDijit.startup();this.own(p(this.sourceDijit,"ok",t.hitch(this,function(e){if(0!==e.length){var b=e[0];if(b.definition)try{b.definition.name=b.name,b.definition.url=b.url,this.emit("ok",b)}catch(a){console.error(a)}else this.loading.show(),f({url:b.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(t.hitch(this,function(a){if(this.domNode){this.loading.hide();
b.definition=a;try{b.definition.name=b.name,b.definition.url=b.url,this.emit("ok",b)}catch(c){console.error(c)}}}),t.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));this.own(p(this.sourceDijit,"cancel",t.hitch(this,function(){try{this.emit("cancel")}catch(e){console.error(e)}})))},_initLoading:function(){this.loading=new k({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/QueryableLayerSource":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableLayerSource.html dijit/form/RadioButton jimu/dijit/_QueryableLayerChooserWithButtons jimu/dijit/QueryableServiceChooserFromPortal jimu/dijit/_QueryableServiceChooserContent jimu/portalUrlUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return n([m,u,k,g],{templateString:f,baseClass:"jimu-layer-source jimu-queryable-layer-source",declaredClass:"jimu.dijit.QueryableLayerSource",nls:null,multiple:!1,createMapResponse:null,mustSupportStatistics:!1,portalUrl:null,postMixInProperties:function(){this.nls=window.jimuNls.queryableLayerSource;this.portalUrl=x.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";
if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.queryableLayerChooserFromMap.getSelectedItems():this.portalRadio.checked?a=this.queryableServiceChooserFromPortal.getSelectedItems():this.urlRadio.checked&&(a=this.queryableServiceChooserContent.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup();this.queryableServiceChooserFromPortal.startup();
this.queryableServiceChooserContent.startup()},_initSelf:function(){this._initRadios();this._createQueryableLayerChooserWithButtons();this._createQueryableServiceChooserFromPortal();this._createQueryableServiceChooserContent();this._onRadioClicked()},_createQueryableLayerChooserWithButtons:function(){this.queryableLayerChooserFromMap=new b({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,mustSupportStatistics:this.mustSupportStatistics,onlyShowWebMapLayers:!0});
this.queryableLayerChooserFromMap.operationTip=this.nls.selectLayer;this.queryableLayerChooserFromMap.placeAt(this.mapDijitContainer);this.own(p(this.queryableLayerChooserFromMap,"ok",t.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(p(this.queryableLayerChooserFromMap,"cancel",t.hitch(this,function(){this.emit("cancel")})))},_createQueryableServiceChooserFromPortal:function(){this.queryableServiceChooserFromPortal=new a({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",
height:"100%"}});this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this.queryableServiceChooserFromPortal.placeAt(this.portalDijitContainer);this.own(p(this.queryableServiceChooserFromPortal,"next",t.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(p(this.queryableServiceChooserFromPortal,"back",t.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=
this.nls.chooseItem;this._updateOperationTip()})));this.own(p(this.queryableServiceChooserFromPortal,"ok",t.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(p(this.queryableServiceChooserFromPortal,"cancel",t.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createQueryableServiceChooserContent:function(){this.queryableServiceChooserContent=
new c({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.queryableServiceChooserContent.operationTip=this.nls.setServiceUrl;this.queryableServiceChooserContent.placeAt(this.urlDijitContainer);this.own(p(this.queryableServiceChooserContent,"ok",t.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(p(this.queryableServiceChooserContent,"cancel",t.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="queryableLayerSourceRadios_"+this._getRandomString(),
b=t.hitch(this,this._onRadioClicked);this.mapRadio=new e({name:a,style:"margin-bottom: 1px;",checked:!0});this.own(p(this.mapRadio,"change",b));this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new e({name:a,style:"margin-bottom: 1px;",checked:!1});this.own(p(this.portalRadio,"change",b));this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new e({name:a,style:"margin-bottom: 1px;",checked:!1});this.own(p(this.urlRadio,"change",b));this.urlRadio.placeAt(this.urlTd,"first");this.own(p(this.mapLabel,
"click",t.hitch(this,function(){this.mapRadio.set("checked",!0)})));this.own(p(this.portalLabel,"click",t.hitch(this,function(){this.portalRadio.set("checked",!0)})));this.own(p(this.urlLabel,"click",t.hitch(this,function(){this.urlRadio.set("checked",!0)})))},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){v.setStyle(this.mapDijitContainer,"display","none");v.setStyle(this.portalDijitContainer,"display","none");v.setStyle(this.urlDijitContainer,
"display","none");this.mapRadio.checked?(v.setStyle(this.mapDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(v.setStyle(this.portalDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):this.urlRadio.checked&&(v.setStyle(this.urlDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=
this.queryableLayerChooserFromMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.queryableServiceChooserFromPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.queryableServiceChooserContent.operationTip)}})})},"jimu/dijit/_QueryableLayerChooserWithButtons":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/QueryableLayerChooserFromMap".split(" "),
function(p,g,t,v,n,m,u,k,f){return p([g,t,v,k],{baseClass:"jimu-layer-chooser-with-buttons jimu-queryable-layer-chooser-with-buttons",declaredClass:"jimu.dijit.QueryableLayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(e){this.options=e},postMixInProperties:function(){this.nls=n.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.queryableLayerChooserFromMap=new f(this.options);this.queryableLayerChooserFromMap.placeAt(this.chooserContainer);m.setStyle(this.queryableLayerChooserFromMap.domNode,{width:"100%",height:"100%"});this.own(u(this.queryableLayerChooserFromMap,"tree-click",n.hitch(this,function(){0<this.getSelectedItems().length?m.removeClass(this.btnOk,
"jimu-state-disabled"):m.addClass(this.btnOk,"jimu-state-disabled")})));this.own(u(this.btnOk,"click",n.hitch(this,function(){var e=this.getSelectedItems();0<e.length&&this.emit("ok",e)})));this.own(u(this.btnCancel,"click",n.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.queryableLayerChooserFromMap.getSelectedItems()},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup()}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/lang",
"dojo/_base/html","dojo/_base/declare","./LayerChooserFromMap"],function(p,g,t,v){return t([v],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",showImageLayer:!0,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.filter=this.showImageLayer?v.createQueryableLayerFilter(this.mustSupportStatistics):v.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,this.mustSupportStatistics);
this.ignoreVirtualLayer&&(this.filter=v.andCombineFilters([this.filter,p.hitch(this,this._ignoreVirtualLayerFilter)]))},_ignoreVirtualLayerFilter:function(g){return g.getLayerType().then(function(g){return!("ArcGISDynamicMapServiceLayer"===g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g)})},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(g){var m=this.inherited(arguments),n=g&&g.layerInfo,n=n&&n.layerObject;
m.url=n&&n.url||"";return m}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){var E=t([v,n,m,g],
{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,
displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new z({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=E.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},
basicFilter:function(a){var b=new k;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new k;a.resolve(!0);return a},getSelectedItems:function(){var b=this.tree.getSelectedItems();return x.map(b,a.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var b=this.tree.getAllItems(),c=[];x.forEach(b,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),c.push(a))}));return c},getHandledItem:function(a){return{name:a.name,
layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(b){this.createMapResponse=b;C.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(p(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(p(this.layerInfosObj,"layerInfosIsShowInMapChanged",a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},
_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(b){this._clear();c.setStyle(this.errorTipSection,"display","block");var e=[];this.onlyShowWebMapLayers?(e=b.getLayerInfoArrayOfWebmap(),e=e.concat(b.getTableInfoArrayOfWebmap())):(e=b.getLayerInfoArray(),e=e.concat(b.getTableInfoArray()));0!==e.length&&(c.setStyle(this.errorTipSection,"display",
"none"),x.forEach(e,a.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(b){b&&b.getLayerObject().then(a.hitch(this,function(){this._addItem("root",b)}),a.hitch(this,function(a){console.error(a)}))},_clear:function(){var b=this._store.query({parent:"root"});x.forEach(b,a.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(c,e){var f=null,g=e.getLayerType(),k=this.filter(e);b({layerType:g,valid:k}).then(a.hitch(this,function(g){if(g.valid){var k=
a.hitch(this,function(a,b){this._id++;f={name:e.title||"",parent:c,layerInfo:e,type:g.layerType,layerClass:e.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:b};this._store.add(f)}),m=e.getSubLayers(),n=0===m.length;n?k(n,!1):(m=x.map(m,a.hitch(this,function(a){return this.filter(a)})),b(m).then(a.hitch(this,function(a){(a=x.some(a,function(a){return a}))&&k(n,a)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var b=
this._getRootItem(),b=new u({data:[b],getChildren:function(a){return this.query({parent:a.id})}});this._store=new f(b);b=new e({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new q({multiple:this.multiple,model:b,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(a,b){"root"!==a.id&&this._onTreeOpen(a,b)}),onClick:a.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,
b,c)}),getIconStyle:a.hitch(this,function(a,b){var c=null;if(!a||"root"===a.id)return null;var e={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},f=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,b).imageName)e.backgroundImage="url("+f+"/css/images/"+a+")",c=e;return c}),getIconClass:a.hitch(this,function(a,b){return this._getIconInfo(a,b).className}),getTooltip:a.hitch(this,function(a){return this.displayTooltipForTreeNode?
a.layerInfo.title:""})});c.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var c="",e="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(c="mapserver_open.png",e="mapservice-layer-icon open"):(c="mapserver_close.png",e="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(c="group_layer2.png",e="group-layer-icon open"):(c="group_layer1.png",
e="group-layer-icon close"):"FeatureLayer"===a.type?(a=w.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(c="point_layer1.png",e="point-layer-icon"):"polyline"===a?(c="line_layer1.png",e="line-layer-icon"):"polygon"===a&&(c="polygon_layer1.png",e="polygon-layer-icon")):"Table"===a.type?(c="table.png",e="table-icon"):"ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?(c="image_layer.png",e="iamge-layer-icon"):b?(c="mapserver_open.png",e="mapservice-layer-icon open"):
(c="mapserver_close.png",e="mapservice-layer-icon close");return{imageName:c,className:e}},_onTreeOpen:function(c,e){if("root"!==c.id){var f=[];e=[];f=c.layerInfo.getSubLayers();c.checked||(this.shelter.show(),e=x.map(f,a.hitch(this,function(a){return a.getLayerObject()})),b(e).then(a.hitch(this,function(){this.domNode&&(x.forEach(f,a.hitch(this,function(a){this._addItem(c.id,a)})),c.checked=!0,this.shelter.hide())}),a.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,
b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});E.createFilterByLayerType=function(c){a.isArrayLike(c)||(c=[]);return function(a){var e=new k;if(0===c.length)e.resolve(!0);else{var f=[];a.traversal(function(a){f.push(a.getLayerType())});b(f).then(function(a){for(var b=0;b<a.length;b++)for(var f=0;f<c.length;f++)if(a[b]===c[f]){e.resolve(!0);return}e.resolve(!1)},function(a){console.error(a);e.reject(a)})}return e}};
E.createFeaturelayerFilter=function(a,c,e,f){var g=["point","polyline","polygon"];a&&0<a.length?(a=x.filter(a,function(a){return 0<=g.indexOf(a)}),0===a.length&&(a=g)):a=g;return function(g){var k=g.getLayerType();g=g.getLayerObject();return b({layerType:k,layerObject:g}).then(function(b){var g=b.layerType;b=b.layerObject;if("ArcGISDynamicMapServiceLayer"===g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g||"FeatureCollection"===g)return!0;if("FeatureLayer"===g){var g=w.getTypeByGeometryType(b.geometryType),
g=0<=x.indexOf(a,g),k=E._shouldPassStatisticsCheck(f,b);return b.url?(b=w.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),g&&b&&k):c&&g}return"Table"===g?(g=w.isFeaturelayerUrlSupportQuery(b.url,b.capabilities),b=E._shouldPassStatisticsCheck(f,b),e&&g&&b):!1})}};E.createImageServiceLayerFilter=function(a,c){return function(e){var f=e.getLayerType();e=e.getLayerObject();return b({layerType:f,layerObject:e}).then(function(b){var e=b.layerType,f=b.layerObject;return"ArcGISImageServiceLayer"===e||
"ArcGISImageServiceVectorLayer"===e?a?w.isImageServiceSupportQuery(b.layerObject.capabilities)?c?E._shouldPassStatisticsCheck(c,f):!0:!1:!0:!1})}};E._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};E.createQueryableLayerFilter=function(a){var b=E.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=E.createImageServiceLayerFilter(!0,a);return E.orCombineFilters([b,a])};E.andCombineFilters=
function(a){return E._combineFilters(a,!0)};E.orCombineFilters=function(a){return E._combineFilters(a,!1)};E._combineFilters=function(a,c){return function(e){var f=new k,g=x.map(a,function(a){return a(e)});b(g).then(function(a){var b=!1,b=c?x.every(a,function(a){return a}):x.some(a,function(a){return a});f.resolve(b)},function(a){console.error(a);f.reject(a)});return f}};return E})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(p,
g,t,v){p=function(n){function m(b,a){var c=n[b];c&&(n[b]=function(f){var g;"put"===b&&(g=n.getIdentity(f));if(e)return c.apply(this,arguments);e=!0;try{var k=c.apply(this,arguments);t(k,function(b){a("object"==typeof b&&b||f,g)});return k}finally{e=!1}})}var p=[],k=0;n=g.delegate(n);n.notify=function(b,a){k++;for(var c=p.slice(),e=0,f=c.length;e<f;e++)c[e](b,a)};var f=n.query;n.query=function(b,a){a=a||{};var c=f.apply(this,arguments);if(c&&c.forEach){var e=g.mixin({},a);delete e.start;delete e.count;
var m=n.queryEngine&&n.queryEngine(b,e),q=k,u=[],z;c.observe=function(b,e){1==u.push(b)&&p.push(z=function(b,f){t(c,function(c){var g=c.length!=a.count,p,w;if(++q!=k)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var t,x=-1,z=-1;if(void 0!==f){var B=[].concat(c);m&&!b&&(B=m(c));p=0;for(w=c.length;p<w;p++){var C=c[p];if(n.getIdentity(C)==f&&!(0>B.indexOf(C))){t=C;x=p;!m&&b||c.splice(p,1);break}}}m?b&&(m.matches?m.matches(b):m([b]).length)&&(p=-1<x?
x:c.length,c.splice(p,0,b),z=v.indexOf(m(c),b),c.splice(p,1),a.start&&0==z||!g&&z==c.length?z=-1:c.splice(z,0,b)):b&&(void 0!==f?z=x:a.start||(z=n.defaultIndex||0,c.splice(z,0,b)));if((-1<x||-1<z)&&(e||!m||x!=z))for(g=u.slice(),p=0;c=g[p];p++)c(b||t,x,z)})});var f={};f.remove=f.cancel=function(){var a=v.indexOf(u,b);-1<a&&(u.splice(a,1),u.length||p.splice(v.indexOf(p,z),1))};return f}}return c};var e;m("put",function(b,a){n.notify(b,a)});m("add",function(b){n.notify(b)});m("remove",function(b){n.notify(void 0,
b)});return n};g.setObject("dojo.store.Observable",p);return p})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,g,t,v,n,m,u){return t("dijit.tree.ObjectStoreModel",u,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(g){n.mixin(this,g);this.childrenCache={}},getRoot:function(g,f){if(this.root)g(this.root);else{var e=this.store.query(this.query);
e.then&&this.own(e);m(e,n.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];g(this.root);e.observe&&e.observe(n.hitch(this,function(a){this.onChange(a)}),!0)}),f)}},mayHaveChildren:function(){return!0},getChildren:function(g,f,e){var b=this.store.getIdentity(g);if(this.childrenCache[b])m(this.childrenCache[b],f,e);else{var a=this.childrenCache[b]=this.store.getChildren(g);a.then&&this.own(a);
a.observe&&this.own(a.observe(n.hitch(this,function(b,e,f){this.onChange(b);e!=f&&m(a,n.hitch(this,"onChildrenChange",g))}),!0));m(a,f,e)}},isItem:function(){return!0},getIdentity:function(g){return this.store.getIdentity(g)},getLabel:function(g){return g[this.labelAttr]},newItem:function(g,f,e,b){return this.store.put(g,{parent:f,before:b})},pasteItem:function(g,f,e,b,a,c){var k=new v;if(f===e&&!b&&!c)return k.resolve(!0),k;f&&!b?this.getChildren(f,n.hitch(this,function(a){a=[].concat(a);var b=p.indexOf(a,
g);a.splice(b,1);this.onChildrenChange(f,a);k.resolve(this.store.put(g,{overwrite:!0,parent:e,oldParent:f,before:c,isCopy:!1}))})):k.resolve(this.store.put(g,{overwrite:!0,parent:e,oldParent:f,before:c,isCopy:!0}));return k},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){var C=p([w._TreeNode,c],{templateString:v,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=m.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=m.toDom('\x3cinput type\x3d"checkbox" /\x3e');m.addClass(this.checkNode,"jimu-tree-check-node");m.place(this.checkNode,this.contentNode,
"first");this.own(b(this.checkNode,"click",n.hitch(this,this._onClick)));this.own(b(this.rowNode,"keydown",n.hitch(this,function(b,c){c.target=b;c.keyCode!==a.ENTER&&c.keyCode!==a.SPACE||this._onClick(c)},this.checkNode)));this.isLeaf?this.groupId?m.setStyle(this.checkNode,"display","none"):m.setStyle(this.checkNode,"display","inline"):m.setStyle(this.checkNode,"display","none");this.isLeaf?m.addClass(this.domNode,"jimu-tree-leaf-node"):m.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,m.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,m.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(n.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return p([w,c],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+q.getRandomString()},postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-tree");this.own(e.before(this,"onClick",n.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&m.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;m.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return u.map(a,n.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=u.filter(a,n.hitch(this,function(a){return a.checkNode.checked}));return u.map(a,
n.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var b=this.getAllTreeNodeWidgets(),b=u.map(b,n.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return u.filter(b,n.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),c=0;c<b.length;c++){var e=x.byNode(b[c]);if(e.item.id.toString()===a.toString())return e}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return u.filter(a,n.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return u.map(a,n.hitch(this,function(a){return x.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return f(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new C(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,b,c){b.isLeaf&&(m.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?b.toggleSelect():this.selectNodeWidget(b)));return arguments},_onCheckNodeClick:function(a,
b,c){!this.multiple&&b&&this.unselectAllLeafNodeWidgets();k.stop(c);this.focusNode(a);setTimeout(n.hitch(this,function(){b?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,c)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();u.forEach(a,n.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U,V){function A(a){return q.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var X=v("dijit._TreeNode",[K,J,L,M,Q],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);c("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:T,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";e.set(this.domNode,
"backgroundPosition",b+" 0px");e.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);p.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,c){var d="_"+b+"Class";b+="Node";var f=this[d];this[d]=this.tree["get"+c+"Class"](a,this.isExpanded);k.replace(this[b],this[d]||"",f||"");e.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;k.toggle(this.domNode,"dijitTreeIsRoot",a);k.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;k.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return A(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");k.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:I.defaultDuration}),d=this._expandDeferred=new n(function(){b.stop()});g.after(b,"onEnd",function(){d.resolve(!0)},!0);b.play();return A(d)},collapse:function(){if(this._collapseDeferred)return A(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");k.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:I.defaultDuration}),d=this._collapseDeferred=new n(function(){b.stop()});g.after(b,"onEnd",
function(){d.resolve(!0)},!0);b.play();return A(d)},indent:0,setChildItems:function(a){var b=this.tree,c=b.model,e=[],f=b.focusedChild,g=this.getChildren();p.forEach(g,function(a){L.prototype.removeChild.call(this,a)},this);this.defer(function(){p.forEach(g,function(a){if(!a._destroyed&&!a.getParent()){var d=function(a){var e=c.getIdentity(a.item),f=b._itemNodesMap[e];1==f.length?delete b._itemNodesMap[e]:(e=p.indexOf(f,a),-1!=e&&f.splice(e,1));p.forEach(a.getChildren(),d)};b.dndController.removeTreeNode(a);
d(a);if(b.persist){var e=p.map(a.getTreePath(),function(a){return b.model.getIdentity(a)}).join("/"),g;for(g in b._openedNodes)g.substr(0,e.length)==e&&delete b._openedNodes[g];b._saveExpandedNodes()}b.lastFocusedChild&&!u.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;f&&!u.isDescendant(f.domNode,b.domNode)&&b.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,p.forEach(a,function(a){var d=c.getIdentity(a),f=b._itemNodesMap[d],
g;if(f)for(var h=0;h<f.length;h++)if(f[h]&&!f[h].getParent()){g=f[h];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:a,tree:b,isExpandable:c.mayHaveChildren(a),label:b.getLabel(a),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(a),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),f?f.push(g):b._itemNodesMap[d]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&e.push(b._expandNode(g))},this),p.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=m(e);this.tree._startPaint(a);return A(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());p.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");k.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){F.focus(this.focusNode)}});c("dojo-bidi")&&X.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var aa=v("dijit.Tree",[K,S,J,Q],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:O,persist:!1,autoExpand:!1,dndController:V,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){z.publish(this.id,q.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new n;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(C(this.containerNode,
C.selector(".dijitTreeNode",E.enter),function(b){a._onNodeMouseEnter(D.byNode(this),b)}),C(this.containerNode,C.selector(".dijitTreeNode",E.leave),function(b){a._onNodeMouseLeave(D.byNode(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow",G.press),function(b){a._onNodePress(D.getEnclosingWidget(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow",G),function(b){a._onClick(D.getEnclosingWidget(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(D.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(g.after(this.model,"onChange",q.hitch(this,"_onItemChange"),!0),g.after(this.model,"onChildrenChange",q.hitch(this,"_onItemChildrenChange"),!0),g.after(this.model,"onDelete",q.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){q.isString(this.dndController)&&(this.dndController=q.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=A(this.pendingCommandsPromise);this.onLoadDeferred.then(q.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;x.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=q.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=q.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new U(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(q.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(q.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),q.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=q.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(q.hitch(this,function(){var d=
p.map(a,function(a){return!a||q.isString(a)?a:b.model.getIdentity(a)}),c=[];p.forEach(d,function(a){c=c.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",c)}))},_setPathAttr:function(a){return a.length?A(this.set("paths",[a]).then(function(a){return a[0]})):A(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function b(a,d){var e=a.shift(),f=p.filter(d,function(a){return a.getIdentity()==e})[0];if(f)return a.length?c._expandNode(f).then(function(){return b(a,
f.getChildren())}):f;throw new aa.PathError("Could not expand path at "+e);}var c=this;return A(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return m(p.map(a,function(a){a=p.map(a,function(a){return a&&q.isObject(a)?c.model.getIdentity(a):a});if(a.length)return b(a,[c.rootNode]);throw new aa.PathError("Empty path");}))}).then(function(a){c.set("selectedNodes",a);return c.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(d){return b._expandNode(d).then(function(){var b=p.filter(d.getChildren()||[],function(a){return a.isExpandable});return m(p.map(b,a))})}var b=this;return A(a(this.rootNode))},collapseAll:function(){function a(d){var c=p.filter(d.getChildren()||[],function(a){return a.isExpandable}),c=m(p.map(c,a));return!d.isExpanded||d==b.rootNode&&!b.showRoot?c:c.then(function(){return b._collapseNode(d)})}var b=this;return A(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return u.isDescendant(a,
b.expandoNode)||u.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,e){var d=this.isExpandoNode(b.target,a);a.isExpandable&&(c||d)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[e](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){x.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){x.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,c=a.item,e=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new n,b.getChildren(c,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(e,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));b=a._loadDeferred.then(q.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(b);return b},focusNode:function(a){for(var b=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)b.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(a);this.defer(function(){for(var a=0,d=b.length;a<d;a++)b[a].domNode.scrollLeft=b[a].scrollLeft,b[a].domNode.scrollTop=
b[a].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),e=this.getTooltip(a);p.forEach(b,function(b){b.set({item:a,label:c,tooltip:e});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&p.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];
b&&(p.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!u.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!u.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=t(this.cookieName);a&&p.forEach(a.split(","),function(a){this._openedNodes[a]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var d=p.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[d];b?this._openedNodes[d]=!0:delete this._openedNodes[d];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);t(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!q.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&f.setMarginBox(this.domNode,a);this._nodePixelIndent=f.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(q.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=q.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});B(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new X(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});c("dojo-bidi")&&aa.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});aa.PathError=b("TreePathError");aa._TreeNode=X;return aa})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,g,t,v){return t("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(n){v.mixin(this,n);this.connects=[];n=this.store;if(!n.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");n.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([g.after(n,
"onNew",v.hitch(this,"onNewItem"),!0),g.after(n,"onDelete",v.hitch(this,"onDeleteItem"),!0),g.after(n,"onSet",v.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var g;g=this.connects.pop();)g.remove()},getRoot:function(g,m){this.root?g(this.root):this.store.fetch({query:this.query,onComplete:v.hitch(this,function(m){if(1!=m.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+m.length+" items, but must return exactly one");this.root=m[0];g(this.root)}),onError:m})},mayHaveChildren:function(g){return p.some(this.childrenAttrs,
function(m){return this.store.hasAttribute(g,m)},this)},getChildren:function(g,m,u){var k=this.store;if(k.isItemLoaded(g)){for(var f=[],e=0;e<this.childrenAttrs.length;e++)var b=k.getValues(g,this.childrenAttrs[e]),f=f.concat(b);var a=0;this.deferItemLoadingUntilExpand||p.forEach(f,function(b){k.isItemLoaded(b)||a++});0==a?m(f):p.forEach(f,function(b,c){k.isItemLoaded(b)||k.loadItem({item:b,onItem:function(b){f[c]=b;0==--a&&m(f)},onError:u})})}else{var c=v.hitch(this,arguments.callee);k.loadItem({item:g,
onItem:function(a){c(a,m,u)},onError:u})}},isItem:function(g){return this.store.isItem(g)},fetchItemByIdentity:function(g){this.store.fetchItemByIdentity(g)},getIdentity:function(g){return this.store.getIdentity(g)},getLabel:function(g){return this.labelAttr?this.store.getValue(g,this.labelAttr):this.store.getLabel(g)},newItem:function(g,m,p){var k={parent:m,attribute:this.childrenAttrs[0]},f;this.newItemIdAttr&&g[this.newItemIdAttr]?this.fetchItemByIdentity({identity:g[this.newItemIdAttr],scope:this,
onItem:function(e){e?this.pasteItem(e,null,m,!0,p):(f=this.store.newItem(g,k))&&void 0!=p&&this.pasteItem(f,m,m,!1,p)}}):(f=this.store.newItem(g,k))&&void 0!=p&&this.pasteItem(f,m,m,!1,p)},pasteItem:function(g,m,u,k,f){var e=this.store,b=this.childrenAttrs[0];m&&p.forEach(this.childrenAttrs,function(a){if(e.containsValue(m,a,g)){if(!k){var c=p.filter(e.getValues(m,a),function(a){return a!=g});e.setValues(m,a,c)}b=a}});if(u)if("number"==typeof f){var a=e.getValues(u,b).slice();a.splice(f,0,g);e.setValues(u,
b,a)}else e.setValues(u,b,e.getValues(u,b).concat(g))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(g,m){m&&this.getChildren(m.item,v.hitch(this,function(g){this.onChildrenChange(m.item,g)}))},onDeleteItem:function(g){this.onDelete(g)},onSetItem:function(g,m){if(-1!=p.indexOf(this.childrenAttrs,m))this.getChildren(g,v.hitch(this,function(m){this.onChildrenChange(g,m)}));else this.onChange(g)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,g,t,v,n){return g("dijit.tree.ForestStoreModel",n,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(g){this.root={store:this,root:!0,id:g.rootId,label:g.rootLabel,children:g.rootChildren}},mayHaveChildren:function(g){return g===this.root||this.inherited(arguments)},getChildren:function(g,n,k){g===this.root?this.root.children?n(this.root.children):this.store.fetch({query:this.query,onComplete:v.hitch(this,
function(f){this.root.children=f;n(f)}),onError:k}):this.inherited(arguments)},isItem:function(g){return g===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(g){if(g.identity==this.root.id){var m=g.scope||t.global;g.onItem&&g.onItem.call(m,this.root)}else this.inherited(arguments)},getIdentity:function(g){return g===this.root?this.root.id:this.inherited(arguments)},getLabel:function(g){return g===this.root?this.root.label:this.inherited(arguments)},newItem:function(g,n,k){return n===
this.root?(this.onNewRootItem(g),this.store.newItem(g)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(g,n,k,f,e){if(n===this.root&&!f)this.onLeaveRoot(g);this.inherited(arguments,[g,n===this.root?null:n,k===this.root?null:k,f,e]);if(k===this.root)this.onAddToRoot(g)},onAddToRoot:function(g){console.log(this,": item ",g," added to root")},onLeaveRoot:function(g){console.log(this,": item ",g," removed from root")},_requeryTop:function(){var g=this.root.children||[];this.store.fetch({query:this.query,
onComplete:v.hitch(this,function(m){this.root.children=m;if(g.length!=m.length||p.some(g,function(g,f){return m[f]!=g}))this.onChildrenChange(this.root,m)})})},onNewItem:function(g,n){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(g){-1!=p.indexOf(this.root.children,g)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(g,n,k,f){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b){return g("dijit.tree._dndSelector",b,{constructor:function(){this.selection={};this.anchor=null;this.events.push(k(this.tree.domNode,f.press,v.hitch(this,"onMouseDown")),k(this.tree.domNode,f.release,v.hitch(this,"onMouseUp")),k(this.tree.domNode,f.move,v.hitch(this,"onMouseMove")),k(this.tree.domNode,e.press,v.hitch(this,"onClickPress")),k(this.tree.domNode,e.release,v.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
e;for(e in b)a.push(b[e]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(a){var b=p.filter(this.getSelectedTreeNodes(),function(b){return!m.isDescendant(b.domNode,a.domNode)});this.setSelection(b);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();p.forEach(this._setDifference(b,a),v.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));p.forEach(this._setDifference(a,b),v.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){p.forEach(b,function(a){a.__exclude__=!0});a=p.filter(a,function(a){return!a.__exclude__});p.forEach(b,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],e=[];p.forEach(a,function(a){var c=a.getTreePath();e.push(a);b.push(c)},this);a=p.map(e,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",e);this.tree._set("selectedNode",e[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&u.isLeft(a)&&a.preventDefault();var b="keydown"==a.type?this.tree.focusedChild:this.current;if(b){var e=n.getCopyKeyState(a),f=b.id;this.singular||a.shiftKey||!this.selection[f]?(this._doDeselect=!1,this.userSelect(b,e,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,n.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return c.compareBoundaryPoints(c.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,e){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(e&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);e=this.anchor;0>b?b=e:(b=a,a=e);for(e=[];b!=a;)e.push(b),b=this.tree._getNext(b);e.push(a);this.setSelection(e)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||t.global;for(var c in this.selection)a.call(b,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,g,t,v,n,m){return g("dijit.tree._dndContainer",null,{constructor:function(g,k){this.tree=g;this.node=g.domNode;v.mixin(this,k);this.containerState="";t.add(this.node,"dojoDndContainer");this.events=[n(this.node,m.enter,v.hitch(this,"onOverEvent")),n(this.node,m.leave,
v.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",v.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",v.hitch(this,"onMouseOut"),!0),n(this.node,"dragstart, selectstart",function(f){f.preventDefault()})]},destroy:function(){for(var g;g=this.events.pop();)g.remove();this.node=this.parent=null},onMouseOver:function(g){this.current=g},onMouseOut:function(){this.current=null},_changeState:function(g,k){var f="dojoDnd"+g;g=g.toLowerCase()+"State";t.replace(this.node,f+
k,f+this[g]);this[g]=k},_addItemClass:function(g,k){t.add(g,"dojoDndItem"+k)},_removeItemClass:function(g,k){t.remove(g,"dojoDndItem"+k)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/QueryableServiceChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableServiceChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/QueryableServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){return p([g,t,v,a],{templateString:n,declaredClass:"jimu.dijit.QueryableServiceChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-queryable-service-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=m.mixin({},window.jimuNls.common);this.nls=m.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=q.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new x({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service","Image Service"],onlyShowOnlineFeaturedItems:!1});this.own(f(this.selector,"item-selected",m.hitch(this,this._onItemSelected)));this.own(f(this.selector,"none-item-selected",m.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new w({multiple:this.multiple});this.own(f(this.serviceBrowser,"tree-click",m.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){u.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){u.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();u.setStyle(this.btnOk,"display","none");u.setStyle(this.btnNext,"display","block");u.setStyle(this.btnBack,"display","none");u.addClass(this.btnOk,"jimu-state-disabled");u.setStyle(this.selectorContainer,"display","block");u.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.selector.getSelectedItem(),b=this.getSelectedItems();a&&0<b.length&&(k.forEach(b,m.hitch(this,function(b){b.portalUrl=
a.portalUrl;b.itemId=a.id})),this.emit("ok",b))},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();a&&(u.setStyle(this.btnNext,"display","none"),u.setStyle(this.btnBack,"display","block"),u.setStyle(this.btnOk,"display","block"),u.addClass(this.btnOk,"jimu-state-disabled"),u.setStyle(this.selectorContainer,"display","none"),u.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(m.hitch(this,
function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),m.hitch(this,function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?u.removeClass(this.btnOk,"jimu-state-disabled"):u.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/QueryableServiceBrowser":function(){define(["dojo/_base/declare",
"./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(p,g,t,v,n){return p([g],{declaredClass:"jimu.dijit.QueryableServiceBrowser",baseClass:"jimu-queryable-service-browser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=n.getQueryableServiceBrowserRule()},getSelectedItems:function(){var g=this.inherited(arguments);return g=v.map(g,t.hitch(this,function(g){return{name:g.name,url:g.url,definition:g.definition}}))}})})},
"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return p([g,t,v,n],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',
_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);u.addClass(this.domNode,"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},
setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new f;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=m.trim(a);var b=a.match(/^http(s?):\/\//gi);b&&0<b.length||(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=x.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?
this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(m.hitch(this,function(a){this.domNode&&this.shelter.hide();var b=this.tree.getAllLeafTreeNodeWidgets();1===b.length&&b[0].select();this._def.resolve(a)}),m.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},
_getSubItems:function(a){var b=new f;this._getSubItemUrls(a).then(m.hitch(this,function(a){a=k.map(a,m.hitch(this,function(a){return this._getItem(a)}));e(a).then(m.hitch(this,function(a){a=k.filter(a,m.hitch(this,function(a){return a&&"object"===typeof a}));b.resolve(a)}),m.hitch(this,function(a){b.reject(a)}))}),m.hitch(this,function(a){b.reject(a)}));return b},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=
this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var c="",e=a.indexOf(b);0<=e&&(c=a.slice(0,e+b.length));return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,
b){var c=new f;this._getRestInfo(a).then(m.hitch(this,function(g){if(this.domNode){var n=[];k.map(g.folders,m.hitch(this,function(c){var e={name:c,type:"folder",url:a+"/"+c,parent:b.id};this._addItem(e);var g=new f;this._doSearchFolderServiceUrl(e.url,e.id).then(m.hitch(this,function(a){0<a.length?k.forEach(a,m.hitch(this,function(a){a.parent=e.id;this._addItem(a)})):this._removeItem(e.id);g.resolve()}),m.hitch(this,function(a){g.reject(a)}));n.push(g);return g}));k.forEach(g.services,m.hitch(this,
function(c){if(this.isServiceTypeSupported(c.type)){c=a+"/"+c.name+"/"+c.type;var e=new f;this.rule.getItem(c).then(m.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));e.resolve()}),m.hitch(this,function(a){console.error(a);e.reject(a)}));n.push(e)}}));e(n).then(m.hitch(this,function(){this.domNode&&c.resolve()}),m.hitch(this,function(a){console.error(a);this.domNode&&c.reject(a)}))}}),m.hitch(this,function(a){console.error(a);this.domNode&&c.reject({errorCode:"NETWORK_ERROR",error:a})}));
return c},_searchFolderServiceUrl:function(a,b){var c=new f;this._doSearchFolderServiceUrl(a,b).then(m.hitch(this,function(a){this.domNode&&(k.forEach(a,m.hitch(this,function(a){a.parent=b.id;this._addItem(a)})),c.resolve())}),m.hitch(this,function(a){console.error(a);this.domNode&&c.reject({errorCode:"NETWORK_ERROR",error:a})}));return c},_doSearchFolderServiceUrl:function(a){var b=new f,c=this._getBaseServiceUrl();this._getRestInfo(a).then(m.hitch(this,function(a){a=a.services;var f=[];a&&0<a.length&&
k.forEach(a,m.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(c+"/"+a.name+"/"+a.type),f.push(a))}));e(f).then(m.hitch(this,function(a){a=k.filter(a,m.hitch(this,function(a){return a}));b.resolve(a)}),m.hitch(this,function(a){console.error(a);b.reject(a)}))}),m.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_searchServiceUrl:function(a,b){var c=new f;this._getSubItems(a).then(m.hitch(this,function(e){e&&0<e.length?(k.forEach(e,m.hitch(this,function(a){a.parent=
b.id;this._addItem(a)})),c.resolve()):this._getItem(a).then(m.hitch(this,function(a){a&&(a.parent=b.id,this._addItem(a));c.resolve()}),m.hitch(this,function(a){c.reject(a)}))}),m.hitch(this,function(a){c.reject(a)}));return c},_getRestInfo:function(a){var b=new f;this.rule.getRestInfo(a).then(m.hitch(this,function(a){this.domNode&&b.resolve(a)}),m.hitch(this,function(a){this.domNode&&b.reject(a)}));return b},_clear:function(){var a=this._store.query({parent:"root"});k.forEach(a,m.hitch(this,function(a){a&&
"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var e=this._getRootItem(),e=new b({data:[e],getChildren:function(a){return this.query({parent:a.id})}});this._store=new a(e);e=new c({store:this._store,query:{id:"root"},
mayHaveChildren:m.hitch(this,this._mayHaveChildren)});this.tree=new w({multiple:this.multiple,model:e,showRoot:!1,style:{width:"100%"},isLeafItem:m.hitch(this,this.isLeafItem),onOpen:m.hitch(this,function(a,b){this._onTreeOpen(a,b);this.emit("tree-open",a,b)}),onClick:m.hitch(this,function(a,b,c){this._onTreeClick(a,b,c);this.emit("tree-click",a,b,c)}),getIconStyle:m.hitch(this,function(a,b){var c=null;if(!a)return null;var e={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",
backgroundImage:""},f=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),g=this._getIconImageName(a,b);g||("folder"===a.type?g=b?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&(g=b?"folder_open_default.png":"folder_close_default.png"));g&&(e.backgroundImage="url("+f+"/css/images/"+g+")",c=e);return c})});u.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===
typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,b){"root"===a.id||0<this._store.query({parent:a.id}).length||a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(m.hitch(this,function(b){k.forEach(b,m.hitch(this,function(b){b.parent=a.id;this._addItem(b)}));a.checking=!1;a.checked=!0}),m.hitch(this,function(b){console.error(b);a.checking=!1;a.checked=!0})))},
_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred","jimu/utils","jimu/ServiceBrowserRule"],function(p,g,t,v,n){var m={combineRules:function(m){var k=new n;g.forEach(m,function(f){g.forEach(f.leafTypes,function(e){0>k.leafTypes.indexOf(e)&&k.leafTypes.push(e)});g.forEach(f.serviceTypes,function(e){0>k.serviceTypes.indexOf(e)&&
k.serviceTypes.push(e)})});k.getMatchedRule=function(f){var e=null;g.some(m,function(b){return b.isUrlContainsServiceType(f)?(e=b,!0):!1});return e};k.getItem=function(f){var e=null;return e=(e=k.getMatchedRule(f))?e.getItem(f):k.defaultGetItem(f)};k.getSubItemUrls=function(f){var e=null;return e=(e=k.getMatchedRule(f))?e.getSubItemUrls(f):k.defaultGetSubItemUrls(f)};k.getIconImageName=function(f,e){var b="";if(f.url){var a=k.getMatchedRule(f.url);a&&"function"===typeof a.getIconImageName&&(b=a.getIconImageName(f,
e))}return b};return k},getFeaturelayerServiceBrowserRule:function(n,k,f){n=p.clone(n);var e=["point","polyline","polygon"];p.isArrayLike(n)&&0<n.length?(n=g.filter(n,function(b){return 0<=e.indexOf(b)}),0===n.length&&(n=e)):n=e;return m._getFeaturelayerServiceBrowserRule(n,k,f)},_getFeaturelayerServiceBrowserRule:function(m,k,f){return new n({types:m,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",
getItem:function(e){var b=new t;this.isUrlEndWithServiceType(e,this.serviceTypes)?b=this.defaultGetItem(e):this.getRestInfo(e).then(p.hitch(this,function(a){a=this._getItemByLayerDefinition(e,a);b.resolve(a)}),p.hitch(this,function(a){b.reject(a)}));return b},getSubItemUrls:function(e){var b=new t;return b=this.isUrlEndWithServiceType(e)?this._getSubUrlsByServiceUrl(e):this._getSubUrlsByGroupUrl(e)},getIconImageName:function(e,b){var a="";"MapServer"===e.type||"FeatureServer"===e.type?a=b?"mapserver_open.png":
"mapserver_close.png":e.type===this._groupLayerType?a=b?"group_layer2.png":"group_layer1.png":e.type===this._featureLayerType?(e=v.getTypeByGeometryType(e.definition&&e.definition.geometryType),"point"===e?a="point_layer1.png":"polyline"===e?a="line_layer1.png":"polygon"===e&&(a="polygon_layer1.png")):e.type===this._tableType?a="table.png":"root"===e.type&&this._currentUrl&&g.some(this.serviceTypes,p.hitch(this,function(a){return v.isStringEndWith(this._currentUrl,"/"+a)}))&&(a=b?"mapserver_open.png":
"mapserver_close.png");return a},_getSubUrlsByServiceUrl:function(e){var b=new t;this.getRestInfo(e).then(p.hitch(this,function(a){var c=[];g.forEach(a.layers,p.hitch(this,function(a){0<=a.parentLayerId||c.push(e+"/"+a.id)}));f&&g.forEach(a.tables,p.hitch(this,function(a){0<=a.parentLayerId||c.push(e+"/"+a.id)}));b.resolve(c)}),p.hitch(this,function(a){b.reject(a)}));return b},_getSubUrlsByGroupUrl:function(e){var b=new t;this.getRestInfo(e).then(p.hitch(this,function(a){var c=[];if(a.type===this._groupLayerType)var f=
this._getServiceUrlByLayerUrl(e),c=g.map(a.subLayers||[],p.hitch(this,function(a){return f+"/"+a.id}));b.resolve(c)}),p.hitch(this,function(a){b.reject(a)}));return b},_getItemByLayerDefinition:function(e,b){var a=null,c=b.type;if(c===this._groupLayerType)a={name:b.name,type:c,url:e,definition:b};else if(c===this._featureLayerType||c===this._tableType){var f=!1;c===this._featureLayerType?f=this._validateEsriGeometryType(b.geometryType):c===this._tableType&&(f=!0);f&&(f=!1,(f=k?v.isFeaturelayerUrlSupportQuery(e,
b.capabilities):!0)&&(a={name:b.name,type:c,url:e,definition:b}))}return a},_validateEsriGeometryType:function(e){e=v.getTypeByGeometryType(e);return 0<=this.types.indexOf(e)},_getServiceUrlByLayerUrl:function(e){for(var b="",a=0;a<this.serviceTypes.length;a++){var c=this.serviceTypes[a].toLowerCase(),f=e.toLowerCase().lastIndexOf("/"+c+"/");if(0<=f){b=e.slice(0,f+c.length+1);break}}return b}})},getGeocodeServiceBrowserRule:function(){return new n({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},
getGpServiceBrowserRule:function(){return new n({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(g){var k=new t;this.isUrlEndWithServiceType(g)?k=this.defaultGetItem(g):this.getRestInfo(g).then(p.hitch(this,function(f){k.resolve({name:f.displayName||f.name,type:"GPTask",url:g,definition:f})}),p.hitch(this,function(f){k.reject(f)}));return k},getSubItemUrls:function(m){var k=new t;this.isUrlEndWithServiceType(m)?this.getRestInfo(m).then(p.hitch(this,function(f){f=g.map(f.tasks||[],
p.hitch(this,function(e){return m+"/"+e}));k.resolve(f)}),p.hitch(this,function(f){k.reject(f)})):k.resolve([]);return k},getIconImageName:function(g,k){k="";"GPServer"===g.type?k="toolbox.png":"GPTask"===g.type&&(k="tool.png");return k}})},getImageServiceBrowserRule:function(g){return new n({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(k){var f=new t;this.isUrlEndWithServiceType(k)?this.defaultGetItem(k).then(p.hitch(this,function(e){g?v.isImageServiceSupportQuery(e.definition.capabilities)?
f.resolve(e):f.resolve(null):f.resolve(e)}),p.hitch(this,function(e){f.reject(e)})):f.resolve(null);return f},getIconImageName:function(g,f){f="";"ImageServer"===g.type&&(f="image_layer.png");return f}})},getQueryableServiceBrowserRule:function(){var g=m.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),k=m.getImageServiceBrowserRule(!0);return m.combineRules([g,k])}};return m})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),
function(p,g,t,v,n,m,u){return p([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(k){g.mixin(this,k);g.isArrayLike(this.leafTypes)||(this.leafTypes=[]);g.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(g){return this.defaultGetItem(g)},getSubItemUrls:function(g){return this.defaultGetSubItemUrls(g)},getIconImageName:function(g,f){return""},defaultGetItem:function(k){var f=new v;k=k.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(k)){var e=k.split("/"),
b=e[e.length-1],a=e[e.length-2];this.getRestInfo(k).then(g.hitch(this,function(c){f.resolve({name:a,type:b,url:k,definition:c})}),g.hitch(this,function(a){console.error(a);f.reject({errorCode:"NETWORK_ERROR",error:a})}))}else f.resolve(null);return f},defaultGetSubItemUrls:function(g){g=new v;g.resolve([]);return g},getRestInfo:function(k){var f=new v;k=k.replace(/\/*$/g,"");var e=this._restInfoCache[k];if(e)f.resolve(e);else{var e={url:k,content:{f:"json"},handleAs:"json",callbackParamName:"callback",
timeout:2E4},b=u.findCredential(k);b&&b.token&&(e.content.token=b.token);m(e).then(g.hitch(this,function(a){this._restInfoCache[k]=a;f.resolve(a)}),function(a){f.reject(a)})}return f},isServiceTypeSupported:function(k){k=k.toLowerCase();return t.some(this.serviceTypes,g.hitch(this,function(f){return f.toLowerCase()===k}))},isUrlEndWithServiceType:function(k){return t.some(this.serviceTypes,g.hitch(this,function(f){return n.isStringEndWith(k,"/"+f)}))},isUrlContainsServiceType:function(k){k=k.toLowerCase();
return t.some(this.serviceTypes,g.hitch(this,function(f){f=f.toLowerCase();return 0<=k.indexOf("/"+f)}))}})})},"jimu/dijit/_QueryableServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./QueryableServiceBrowser"],function(p,g,t){return p([g],{baseClass:"jimu-queryable-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer",
"http://myserver/arcgis/rest/services/myservice/ImageServer"],_createServiceBrowser:function(g){return new t(g)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),function(p,
g,t,v,n,m,u,k,f,e,b,a,c,x,w){return p([g,t,v,m],{templateString:n,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=e.mixin({},window.jimuNls.common);this.nls=e.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
k.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var b=new u;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),b=this._onBtnValidateClick()):b.reject();return b},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?f.forEach(this._examples,e.hitch(this,function(a){k.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):k.setStyle(this.exampleTr,"display","none");var c={multiple:this.multiple,_onTreeClick:e.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(c);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(a.after(this.urlInput,"validator",e.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(b(this.serviceBrowser,"error",e.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var b=a.split("/");if(1===b.length)return!0;if(2===b.length)return this.serviceBrowser.isServiceTypeSupported(b[1]);if(3<=b.length)return a=this.serviceBrowser.isServiceTypeSupported(b[1]),b=this.serviceBrowser.isServiceTypeSupported(b[2]),a||b}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?k.removeClass(this.btnValidate,"jimu-state-disabled"):k.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,k.addClass(this.errorSection,"visible")):k.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";k.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new u;if(this.urlInput.validate()){var b=this.urlInput.get("value");this.serviceBrowser.setUrl(b).then(e.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),e.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?k.removeClass(this.btnOk,"jimu-state-disabled"):
k.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"builder/plugins/attribute-config/dataSource/DataSourceConfigPopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup ./DataSourceConfig".split(" "),function(p,g,t,v,n,m,u){return p([m,g],{width:830,
height:580,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);n.addClass(this.domNode,"data-source-config-popup");this._initDataSourceConfig()},_initDataSourceConfig:function(){this.dataSourceConfig=new u(this.dijitArgs);this.dataSourceConfig.placeAt(this.contentContainerNode);this.dataSourceConfig.startup();this.own(t(this.dataSourceConfig,"ok",v.hitch(this,function(g){this.emit("ok",g)})));this.own(t(this.dataSourceConfig,"cancel",v.hitch(this,function(){this.emit("cancel")})))}})})},
"builder/plugins/attribute-config/dataSource/DataSourceConfig":function(){define("dojo/_base/declare dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./DataSourceConfig.html dojo/on dojo/_base/html dojo/_base/query dojo/dom-style jimu/dijit/Popup jimu/dijit/Filter dojo/_base/lang dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask dijit/form/CheckBox jimu/dijit/Message jimu/utils jimu/Query jimu/LayerInfos/LayerInfos ./DataFields ./utils jimu/DataSourceManager jimu/dijit/DataPreviewTable jimu/dijit/LoadingIndicator dijit/form/ValidationTextBox dijit/form/Select dijit/form/NumberTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L){return p([t,g,v,n],{templateString:m,baseClass:"data-sources-config",_layerDefinition:null,_filterObj:null,_filterByExtent:!1,_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],postMixInProperties:function(){this.nls=c.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.setConfig(this.config);this._initEvent()},setConfig:function(a){a&&
(this.config=a,"Features"===this.config.type?(e.set(this.layerOnlyOption,{display:"block"}),this._initFeaturesFields()):"FeatureStatistics"===this.config.type&&(e.set(this.statisticsOnlyOption,{display:"block"}),this._initFeatureStatisticsFields()),this.reset(),this.sourceName.setValue(this.config.label||""),this.sourceUrl.set("value",this.config.url||""),this.sourceUrl.title=this.config.url||"",this.config.filter&&(this._filterObj=this.config.filter),"undefined"!==typeof this.config.filterByExtent&&
(this._filterByExtent=this.config.filterByExtent),this._refreshFilterBtnDisplay(),this._setFilterExpr(),this._getDefinition().then(c.hitch(this,function(){this.queryType=G.getQueryType(this._layerDefinition);this._setRefreshInterval();"Features"===this.config.type?(this._setFeaturesFields(),this._setRecords(),this._setOrderByFieldForRecords()):"FeatureStatistics"===this.config.type&&(this._setStatisticsFields(),this._setGroupByFields())})))},_setFilterExpr:function(){var a="";this._filterObj&&(a=
this._filterObj.expr);this._filterByExtent&&(a&&(a+="\x26"),a+="Extent\x3d"+!!this._filterByExtent);a||(a=this.nls.noFilter);this.filterExpr.innerText=""},_initFeaturesFields:function(){this.featuresFields=new D({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});this.featuresFields.placeAt(this.fieldsOption);this.featuresFields.startup();this.own(u(this.featuresFields,"change",c.hitch(this,function(){this._layerDefinition&&this._setOrderByFieldForRecords()})))},
_setFeaturesFields:function(){var a=this.config.dataSchema&&this.config.dataSchema.fields,b=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry");a&&a.length?(a=this._getFieldsNames(a,!1),b=this._keepRequiredFields(b,!1),this.featuresFields.setFields(b),this.featuresFields.selectFields(a)):(b=this._keepRequiredFields(b,!0),this.featuresFields.setFields(b))},_setRecords:function(){3===this.queryType?(this._updateOptions(this.resultRecordType,null,"serviceLimitation"),this.resultRecordType.set("disabled",
!0)):(this.resultRecordType.set("disabled",!1),this.config.resultRecordType&&(this._updateOptions(this.resultRecordType,null,this.config.resultRecordType),"undefined"!==typeof this.config.resultRecordCount&&"custom"===this.config.resultRecordType&&this.customNumber.setValue(this.config.resultRecordCount)))},_setOrderByFieldForRecords:function(){if(1===this.queryType){this._activeOrderOption();var a=this._getFieldsForOrderBy();this._updateOptions(this.orderFields,a);if(this.config.dataSchema&&B.isNotEmptyObject(this.config.dataSchema.orderByFields)){var a=
this.config.dataSchema.orderByFields[0].split(" ")[0],a=this._getFieldLabelByFieldName(a),b=this.config.dataSchema.orderByFields[0].split(" ")[1];this._updateOptions(this.orderFields,null,a);"DESC"===b?this._onOrderClick(!1):this._onOrderClick(!0)}}else this._disableOrderOption()},_activeOrderOption:function(){this.orderFields.set("disabled",!1);k.removeClass(this.ascBtn,"disabled");k.removeClass(this.descBtn,"disabled")},_disableOrderOption:function(){this.orderFields.set("disabled",!0);k.addClass(this.ascBtn,
"disabled");k.addClass(this.descBtn,"disabled")},_initFeatureStatisticsFields:function(){this.statisticsFields=new D({nls:{moveUp:window.jimuNls.simpleTable.moveUp,moveDown:window.jimuNls.simpleTable.moveDown}});this.statisticsFields.placeAt(this.statisticsFieldsOption);this.statisticsFields.startup()},_setStatisticsFields:function(){var a=this._hasNumberFields(this._layerDefinition);a&&(a=this._getFilteredFields(a,"esriFieldTypeOID"),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),this.statisticsFields.setFields(a),
this.config.dataSchema&&B.isNotEmptyObject(this.config.dataSchema.fields)&&(a=this._getFieldsNames(this.config.dataSchema.fields,!1),this.config.dataSchema.groupByFields&&0<this.config.dataSchema.groupByFields.length&&a.splice(a.indexOf(this.config.dataSchema.groupByFields[0]),1),this.statisticsFields.selectFields(a)))},_setGroupByFields:function(){if(this._layerDefinition&&this._layerDefinition.fields){var a=this._getFilteredFields(this._layerDefinition.fields,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a);
a.unshift({label:"-",value:"-"});this._updateOptions(this.groupFields,a);this.config.dataSchema&&this.config.dataSchema.groupByFields&&(a=this._getFieldLabelByFieldName(this.config.dataSchema.groupByFields[0]),this._updateOptions(this.groupFields,null,a))}},_supportsStatisticsByExtent:function(){var a=!0;this.config&&"FeatureStatistics"===this.config.type&&this._layerDefinition&&this._layerDefinition.currentVersion&&10.11>Number(this._layerDefinition.currentVersion)&&(a=!1);return a},_createFilterPopup:function(a){this.filterDomNode=
k.toDom('\x3cdiv class\x3d"data-sources-filter"\x3e\x3cdiv class\x3d"filter-label"\x3e'+this.nls.extent+'\x3c/div\x3e\x3cdiv class\x3d"filterByExtent" style\x3d"margin-top: 10px;"\x3e\x3clabel for\x3d"fbe-checkbox"\x3e'+this.nls.filterByExtentLabel+'\x3c/label\x3e\x3c/div\x3e\x3cdiv style\x3d"margin-top: 20px;" class\x3d"filter-label queryCritiera"\x3e'+this.nls.queryCritiera+'\x3c/div\x3e\x3cdiv style\x3d"margin-top: 15px;" class\x3d"filterDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-float-leading sample-btn data-preview textOverFlow"\x3e'+
this.nls.sampleData+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel btnCancel"\x3e'+this.nls.cancel+'\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 btnOk"\x3e'+this.nls.ok+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");k.setStyle(f(".filter-label",this.filterDomNode)[0],"display","block");k.setStyle(f(".filterByExtent",this.filterDomNode)[0],"display","flex");k.setStyle(f(".queryCritiera",this.filterDomNode)[0],"margin-top","20px");var e=f(".filterByExtent",
this.filterDomNode)[0];this.cbxFilterByExtent=new z;this.cbxFilterByExtent.placeAt(e,"first");this.own(u(this.cbxFilterByExtent,"click",function(a){a.target.checked&&(a.preventDefault(),this._checkFilterByExtent())}.bind(this)));this.cbxFilterByExtent.set("disabled",!this._supportsStatisticsByExtent());this.popup=new b({titleLabel:this.nls.dataSourceFilter,width:680,height:485,content:this.filterDomNode});e=this.sourceUrl.getValue().trim();"set"===a?this._createNewFilter(e,"1\x3d1"):"config"===a&&
this._editFilter(e,this._filterObj);a=f(".footer .btnOk",this.filterDomNode)[0];this.own(u(a,"click",c.hitch(this,function(){var a=this.filter.toJson();if(!a||!a.expr)return new E({message:window.jimuNls.filterBuilder.setFilterTip}),null;this._filterByExtent=this.cbxFilterByExtent.get("value");this._filterObj=a;this._setFilterExpr();this.filter.destroy();this.filter=null;this.popup.close();this.popup=null;this._refreshFilterBtnDisplay()})));a=f(".footer .btnCancel",this.filterDomNode)[0];this.own(u(a,
"click",c.hitch(this,function(){this.filter.destroy();this.filter=null;this.popup.close();this.popup=null})));a=f(".sample-btn",this.filterDomNode)[0];this.own(u(a,"click",c.hitch(this,this._onSampleDataClick)))},_checkFilterByExtent:function(){var a=new b({autoHeight:!0,content:'\x3cdiv style\x3d"font-size:16px;line-height:1.5;padding-bottom:10px;"\x3e'+this.nls.fbeTip+"\x3c/div\x3e",width:480,buttons:[{label:this.nls.openFbeTip,onClick:c.hitch(this,function(){this.cbxFilterByExtent.set("value",
!0);a.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:c.hitch(this,function(){this.cbxFilterByExtent.set("value",!1);a.close()})}]})},_createFilter:function(){this.filter=new a({nls:this.nls,enableAskForValues:!1,runtime:!0,style:"width:100%;"});var b=f(".filterDiv",this.filterDomNode)[0];this.filter.placeAt(b)},_editFilter:function(a,b){b=this.upgradePartsObj(b);this._createFilter();this.filter.buildByFilterObj(a,b,this._layerDefinition);this._filterByExtent&&this.cbxFilterByExtent.set("value",
!0)},upgradePartsObj:function(a){if(a){var b=c.clone(a),e=this._getPreDefinedParts(b);if(!e||!e.length)return b=null,a;this._upgradeParts(e);return b}},_getPreDefinedParts:function(a){var b=[];a=a&&a.parts;if(!a||!a.length)return b;a.forEach(function(a){var c=a.valueObj;c&&c.type&&("multiplePredefined"!==c.type&&"uniquePredefined"!==c.type||b.push(a))});return b},_upgradeParts:function(a){a.forEach(function(a){a.interactiveObj="";var b=null,c=a.valueObj;"uniquePredefined"===c.type?(b={type:"unique",
isValid:!0},this._isNumberTypePartField(a)?b.value=null:b.value=""):"multiplePredefined"===c.type&&(b={type:"multiple",isValid:!0,value:[]});a.valueObj=b}.bind(this))},_isNumberTypePartField:function(a){if((a=a.fieldObj)&&a.type)return B.isNumberField(a.type)},_createNewFilter:function(a,b){this._createFilter();this.filter.buildByExpr(a,b,this._layerDefinition)},getConfig:function(){var a={};a.type=this.config.type;this.config.portalUrl&&(a.portalUrl=this.config.portalUrl);this.config.itemId&&(a.itemId=
this.config.itemId);var b=!!this.isDynamic.checked;if(b){var c=this.refreshInterval.getValue();c&&(a.refreshInterval=Number(c))}a.isDynamic=b;a.label=this.sourceName.getValue();a.url=this.sourceUrl.getValue().trim();a.filterByExtent=this._filterByExtent;this._filterObj&&(a.filter=this._filterObj);this.useLayerFilterCbx&&(a.useLayerFilter=this._useLayerFilter);"Features"===this.config.type&&(a=this._getFeaturesRecord(a));b=this._getVaildDataSchema();a.dataSchema=b;return a},_getFeaturesRecord:function(a){var b=
this.resultRecordType.getValue();a.resultRecordType=b;"custom"===b&&(b=this.customNumber.getValue())&&(a.resultRecordCount=parseInt(b,10));return a},_getVaildDataSchema:function(){var a={},b,e;b=B.getDataSchemaFromLayerDefinition(this._layerDefinition);b.objectIdField&&(a.objectIdFieldName=b.objectIdField.name||"");a.geometryType=b.geometryType||"";a.displayFieldName=b.displayField||"";a.typeIdField=b.typeIdField||"";if("Features"===this.config.type){if(b=this.featuresFields.getSelectedFieldNames(),
b=this._getFieldsByFieldNames(b),a.fields=b||[],b=this.orderFields.getValue())b=this._getFieldNameByFieldLabel(b),e=[],e.push(b+" "+this._getSelectedOrder()),a.orderByFields=e}else"FeatureStatistics"===this.config.type&&(e=this.statisticsFields.getSelectedFieldNames(),0===e.length&&a.objectIdFieldName&&e.push(a.objectIdFieldName),b=this._getFieldsByFieldNames(e),a.statistics=this._getStatisticDefinition(b,a.objectIdFieldName),b=c.clone(e),(e=this._getFieldNameByFieldLabel(this.groupFields.getValue()))?
(b.push(e),a.groupByFields=[e]):a.groupByFields=[],a.fields=this._getFieldsByFieldNames(b)||[]);return a},_getFieldsByFieldNames:function(a){if(a)return 0===a.length?[]:a.map(c.hitch(this,function(a){return this._getFieldByFieldName(a)}))},_getStatisticFields:function(a){var b=[];if(0>=a.length)return b;"count sum min max avg stddev".split(" ").forEach(c.hitch(this,function(e){"count"===e?b.push(this._getFormatStatisticField(a[0],e)):a.forEach(c.hitch(this,function(a){b.push(this._getFormatStatisticField(a,
e))}))}));return b},_getFormatStatisticField:function(a,b){if(B.isNotEmptyObject(a)&&!Array.isArray(a))return a=c.clone(a),a.name=a.name+"_"+b,a},_getStatisticDefinition:function(a,b){var e=[];["count","sum","min","max","avg"].forEach(c.hitch(this,function(f){"count"===f?e.push(this._getFormatStatisticDefinition(f,b)):a.forEach(c.hitch(this,function(a){e.push(this._getFormatStatisticDefinition(f,b,a))}))}));return e},_getFormatStatisticDefinition:function(a,b,c){var e={};if("count"===a)return e.onStatisticField=
b||"*",e.outStatisticFieldName="STAT_COUNT",e.statisticType=a,e;b=B.upperCaseString(c.name+"_"+a);e.onStatisticField=c.name;e.outStatisticFieldName=b;e.statisticType=a;return e},_getDefinition:function(){var a=new x;B.isObject(this.config.definition)?(this._layerDefinition=this.config.definition,a.resolve()):(this.loading.show(),w({url:this.config.url,content:{f:"json"},handleAs:"json"}).then(c.hitch(this,function(b){this.domNode?(this.loading.hide(),this._layerDefinition=b,a.resolve(b)):a.reject()}),
c.hitch(this,function(b){console.error(b);a.reject();this.domNode&&this.loading.hide()})));return a},reset:function(){this.sourceName.setValue("");this.sourceUrl.set("value","");this.isDynamic.checked=!1;this.isDynamic.setStatus(!0);this.refreshInterval.set("disabled",!1);this.resultRecordType.set("disabled",!1);this._activeOrderOption();this._layerDefinition=null;this._filterByExtent=!1;this._filterObj=null;this.filterExpr.innerText="";this._refreshFilterBtnDisplay();"Features"===this.config.type?
(this.featuresFields.setFields([]),this._updateOptions(this.resultRecordType),this._updateOptions(this.orderFields,[]),this._onOrderClick(!0),k.addClass(this.customNumberDiv,"hide")):"FeatureStatistics"===this.config.type&&(this._updateOptions(this.groupFields,[{label:"-",value:"-"}]),this.statisticsFields.setFields([]))},_onFeaturesFieldsClick:function(a){a.stopPropagation();k.hasClass(this.fieldsOptionDiv,"hide")?k.removeClass(this.fieldsOptionDiv,"hide"):k.addClass(this.fieldsOptionDiv,"hide")},
_showStatisticsFieldsList:function(){k.removeClass(this.statisticsFieldsOptionDiv,"hide")},_hideStatisticsFieldsList:function(){k.addClass(this.statisticsFieldsOptionDiv,"hide")},_onStatisticsFieldsClick:function(a){a.stopPropagation();k.hasClass(this.statisticsFieldsOptionDiv,"hide")?this._showStatisticsFieldsList():this._hideStatisticsFieldsList()},_getFieldsNames:function(a,b){return a&&0!==a.length?a.map(function(a){return b?a.alias||a.name:a.name}):[]},_getStatisticsFieldRealNames:function(a){if(!a||
0===a.length)return[];a=a.map(function(a){return a.replace(/(_count|_sum|_max|_min|_avg|_stddev)$/,"")});a=B.uniqueArray(a);if(this.config.dataSchema.groupByFields){var b=this.config.dataSchema.groupByFields[0];b&&"-"!==b&&(a=a.filter(function(a){return a!==b}))}return a},_getFieldsForOrderBy:function(){var a=[],b=this.featuresFields.getSelectedFieldNames();b&&0<b.length&&(a=this._getFieldsByFieldNames(b),a=this._getFilteredFields(a,"esriFieldTypeGeometry"),a=this._handleFieldsForSelectOption(a));
return a},_getFieldByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===a&&(b=c)});return b}},_getFieldNameByFieldLabel:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){if(c.alias===a||c.name===a)b=c.name});return b}},_getFieldLabelByFieldName:function(a){if(this._layerDefinition&&this._layerDefinition.fields){var b;this._layerDefinition.fields.forEach(function(c){c.name===
a&&(b=c.alias||c.name)});return b}},_handleFieldsForSelectOption:function(a){return!a||0>=a.length?[]:a=a.map(function(b){var c;"object"===typeof a[0]?c=b.alias||b.name:"string"===typeof a[0]&&(c=b);return{label:c,value:c}})},_updateOptions:function(a,b,c){b?(a.removeOption(a.getOptions()),a.addOption(b)):b=[];!c&&0<b.length&&(c=b[0].value);c&&a.set("value",c)},_setRefreshInterval:function(){this._settingRefreshIntervalFromMapLayer()||(this.config.isDynamic?(this.isDynamic.check(),this.config.refreshInterval&&
this.refreshInterval.setValue(this.config.refreshInterval)):this.isDynamic.uncheck())},_settingRefreshIntervalFromMapLayer:function(){var a;this.config.layerInfo?a=this.config.layerInfo:this.config.id&&"map"===this.config.id.split("~")[0]&&(a=this.config.id.split("~")[1],a=F.getInstanceSync().getLayerInfoById(a));if(a&&a.layerObject&&a.layerObject.refreshInterval)return this.isDynamic.check(),this.refreshInterval.setValue(a.layerObject.refreshInterval),this.refreshInterval.set("disabled",!0),this.isDynamic.setStatus(!1),
!0},_checkConfigValue:function(){var a=!0;this.sourceName.getValue()&&this.sourceUrl.getValue().trim()||(a=!1);!this.isDynamic.checked||this.refreshInterval.isValid()&&this.refreshInterval.getValue()||(a=!1);"custom"!==this.resultRecordType.getValue()||this.customNumber.isValid()||(a=!1);if("FeatureStatistics"===this.config.type){var b=this.statisticsFields.getSelectedFieldNames(),c=this._getFieldNameByFieldLabel(this.groupFields.getValue());-1<b.indexOf(c)&&(new E({message:this.nls.groupFieldIsNotAllowedInStatistics}),
a=!1)}return a},_hasNumberFields:function(a){var b=!1;(a=a.fields)&&0<a.length&&(b=a.filter(c.hitch(this,function(a){return 0<=this._numberFieldTypes.indexOf(a.type)})));return b},_refreshFilterBtnDisplay:function(){this._filterObj||this._filterByExtent?(k.addClass(this.btnConfig,"visible"),k.addClass(this.btnRemove,"visible"),k.removeClass(this.btnSet,"visible")):(k.removeClass(this.btnConfig,"visible"),k.removeClass(this.btnRemove,"visible"),k.addClass(this.btnSet,"visible"))},_initEvent:function(){this.own(u(document.body,
"click",c.hitch(this,function(a){var b=a.target||a.srcElement;this.featuresFields?(a=b===this.featuresFields.domNode,b=k.isDescendant(b,this.featuresFields.domNode),a||b||k.addClass(this.fieldsOptionDiv,"hide")):this.statisticsFields&&(a=b===this.statisticsFields.domNode,b=k.isDescendant(b,this.statisticsFields.domNode),a||b||k.addClass(this.statisticsFieldsOptionDiv,"hide"))})));this.own(u(this.resultRecordType,"change",c.hitch(this,function(a){"custom"===a?k.removeClass(this.customNumberDiv,"hide"):
k.addClass(this.customNumberDiv,"hide")})));this.own(u(this.btnOk,"click",c.hitch(this,function(){this._checkConfigValue()&&this.emit("ok",this.getConfig())})));this.own(u(this.btnCancel,"click",c.hitch(this,function(){this.emit("cancel")})));this.own(u(this.ascBtn,"click",c.hitch(this,function(){k.hasClass(this.ascBtn,"disabled")||this._onOrderClick(!0)})));this.own(u(this.descBtn,"click",c.hitch(this,function(){k.hasClass(this.descBtn,"disabled")||this._onOrderClick()})));this._initFilterBtnEvent()},
_onOrderClick:function(a){a?(k.addClass(this.ascBtn,"selected"),k.removeClass(this.descBtn,"selected")):(k.removeClass(this.ascBtn,"selected"),k.addClass(this.descBtn,"selected"))},_getSelectedOrder:function(){var a;k.hasClass(this.ascBtn,"selected")?a="ASC":k.hasClass(this.descBtn,"selected")&&(a="DESC");return a},_initFilterBtnEvent:function(){this.own(u(this.btnSet,"click",c.hitch(this,function(){this._createFilterPopup("set")})));this.own(u(this.btnConfig,"click",c.hitch(this,function(){this._createFilterPopup("config")})));
this.own(u(this.btnRemove,"click",c.hitch(this,function(){var a=new E({message:this.nls.removeFilterMessage,buttons:[{label:this.nls.ok,onClick:c.hitch(this,function(){this._filterObj=null;this._filterByExtent=!1;this._setFilterExpr();this._refreshFilterBtnDisplay();a.content=null;a.close()})},{label:this.nls.cancel,onClick:c.hitch(this,function(){a.content=null;a.close()})}]})})))},_keepRequiredFields:function(a,b){return a?a=a.map(function(a){"undefined"!==typeof a.nullable?(a.checked=!a.nullable,
a.disabled=!a.nullable):(a.checked="esriFieldTypeOID"===a.type,a.disabled="esriFieldTypeOID"===a.type);b&&(a.checked=!0);return a}):[]},_getFilteredFields:function(a,b){return a?a=a.filter(function(a){return a.type!==b}):[]},_isServiceSupportsOrderBy:function(a){var b=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(b=!0);return b},_onSampleDataClick:function(){var a=new C(this.config.url),b=new q;b.where="1\x3d1";b.outFields=["*"];b.returnGeometry=!1;a.execute(b).then(c.hitch(this,
function(a){a.features=a.features.slice(0,10);this._showDataPreviewTable(a,"sampleData")}))},_onPreviewClick:function(){if(this._checkConfigValue()){this.dataPreviewTableLoading||(this.dataPreviewTableLoading=new L,this.dataPreviewTableLoading.placeAt(this.domNode));this.dataPreviewTableLoading.show();var a=c.clone(this.getConfig());a.id=this.config.id?this.config.id:I.createDataSourceId(this.config.serviceType,this.config.layerInfo?this.config.layerInfo.id:null);K.getInstance().doQuery(a).then(c.hitch(this,
function(b){if(a.dataSchema.groupByFields&&0<a.dataSchema.groupByFields.length)var c=a.dataSchema.groupByFields.length[0];b.fields&&(b.fields=b.fields.sort(function(a,b){return a.name===c?1:a.name-b.name}));this._showDataPreviewTable(b,"preview")}),c.hitch(this,function(){this.dataPreviewTableLoading.hide()}))}},_showDataPreviewTable:function(a,e){this.dataPreviewPopup=new b({titleLabel:"preview"===e?this.nls.preview:this.nls.sampleData,width:800,height:610,content:new J({height:610,featureSet:a,
loadingIndicator:this.dataPreviewTableLoading}),onClose:c.hitch(this,function(){this.dataPreviewTableLoading&&this.dataPreviewTableLoading.hide&&this.dataPreviewTableLoading.hide()})});k.addClass(this.dataPreviewPopup.domNode,"data-preview-popup")},destroy:function(){this.filter&&this.filter.destroy();this.dataPreviewTableLoading&&this.dataPreviewTableLoading.destroy();this.dataPreviewPopup&&this.dataPreviewPopup.destroy();this.inherited(arguments)}})})},"dojo/_base/query":function(){define(["../query",
"./NodeList"],function(p){return p})},"jimu/dijit/Filter":function(){define("dojo/on dijit/a11yclick dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils jimu/LayerInfos/LayerInfos jimu/dijit/_filter/ValueProviderFactory dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),function(p,
g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){return v([n,m,u,f,t],{templateString:k,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,autoSwitchMode:!0,_validOptions:!1,_layerDefinition:null,_popupFieldsInfo:[],_def:null,valueProviderFactory:null,featureLayerId:null,layerInfosObj:null,mode:"desktop",noFilterTip:"",enableAskForValues:!1,mobileBreakWidth:600,runtime:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this.nls.add=window.jimuNls.common.add;this.nls.apply=
window.jimuNls.common.apply;this.layerInfosObj=b.getInstanceSync();this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._setDesktopMode();this.noFilterTip&&"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip);this._bindBtnsEvent()},startup:function(){this.inherited(arguments);this.autoUpdateMode()},resize:function(){this.autoUpdateMode()},_bindBtnsEvent:function(){this.own(p(this.btnAddExpDesktop,g,x.hitch(this,function(){this._onBtnAddExpClick()})));
this.own(p(this.btnAddSetDesktop,g,x.hitch(this,function(){this._onBtnAddSetClick()})));this.own(p(this.btnAddExpMobile,g,x.hitch(this,function(){this._onBtnAddExpClick()})));this.own(p(this.btnAddSetMobile,g,x.hitch(this,function(){this._onBtnAddSetClick()})))},autoUpdateMode:function(){this.autoSwitchMode&&(this._clearMode(),this.domNode.clientWidth>=this.mobileBreakWidth?this._setDesktopMode():this._setMobileMode())},setMode:function(a){"desktop"===a?this._setDesktopMode():"mobile"===a&&this._setMobileMode()},
_setMode:function(a){this.mode=a;this._setModeClass(this.mode)},_setModeClass:function(a){w.removeClass(this.domNode,"desktop-mode");w.removeClass(this.domNode,"mobile-mode");w.addClass(this.desktopAddSection,"hidden");w.addClass(this.mobileAddSection,"hidden");a&&w.addClass(this.domNode,a+"-mode")},_clearMode:function(){this._setModeClass("")},_setDesktopMode:function(){this._setMode("desktop");w.removeClass(this.desktopAddSection,"hidden")},_setMobileMode:function(){this._setMode("mobile");w.removeClass(this.mobileAddSection,
"hidden")},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this._layerDefinition=null,this._popupFieldsInfo=[],this.valueProviderFactory=this.partsObj=this.expr=this.featureLayerId=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},build:function(a){var b=new z;this.isBuilding()?b.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a.url,this.isHosted=e.isHostedService(this.url),this._layerDefinition=a.layerDefinition,
this.featureLayerId=a.featureLayerId,a.partsObj?(this.partsObj=this._updatePartsObj(a.partsObj),this._def=this._init("partsObj")):(this.expr=a.expr||"1\x3d1",this._def=this._init("expr")),b=this._def);return b},buildByExpr:function(a,b,c){console.warn("Filter#buildByExpr() method is deprecated, please use Filter#build() instead.");return this.build({url:a,expr:b,layerDefinition:c,featureLayerId:this.featureLayerId})},buildByFilterObj:function(a,b,c){console.warn("Filter#buildByFilterObj() method is deprecated, please use Filter#build() instead.");
return this.build({url:a,partsObj:b,layerDefinition:c,featureLayerId:this.featureLayerId})},_updatePartsObj:function(a){q.forEach(a,x.hitch(this,function(a){a.parts?q.forEach(a.parts,x.hitch(this,function(a){a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade=
"none")}));return a},removeAllFilters:function(){this._destroyAllFilters()},_getLayerDefinitionRaw:function(a,b){var c=new z;b?c.resolve(b):(this.loading.show(),E({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(x.hitch(this,function(a){this.domNode?(this.loading.hide(),c.resolve(a)):c.reject()}),x.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(b){var c=
new z;if(!this._isString(this.url))return c.reject(),c;var f=x.hitch(this,function(){setTimeout(x.hitch(this,function(){this.emit("change");c.resolve()}),1500)}),g=x.hitch(this,function(){w.addClass(this.errorSection,"hidden");this.removeAllFilters();var g;this.featureLayerId&&(this._tryOverrideFieldAliases(this.featureLayerId,this._layerDefinition),g=this.layerInfosObj.getLayerOrTableInfoById(this.featureLayerId).getPopupInfo());var k=this._layerDefinition.fields;k&&0<k.length?(this._popupFieldsInfo=
g?e.completePopupFieldFromLayerField(k,g.fieldInfos):k,(k=q.filter(k,x.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<k.length?(this._validOptions=!0,w.removeClass(this.btnAddSetDesktop,"jimu-state-disabled"),w.removeClass(this.btnAddExpDesktop,"jimu-state-disabled"),w.removeClass(this.btnAddSetMobile,"jimu-state-disabled"),w.removeClass(this.btnAddExpMobile,"jimu-state-disabled"),this.createFieldsStore(),this.valueProviderFactory=new a({url:this.url,layerDefinition:this._layerDefinition,
featureLayerId:this.featureLayerId}),"expr"===b?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?f():c.reject()):c.reject():"partsObj"===b?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),f()):c.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),f()):this._isString(this.expr)?this._parseExpr(this.expr)?f():c.reject():(this.removeAllFilters(),f())):(this._showErrorOptions(this.nls.error.noFilterFields),
c.reject())):(g&&(this._popupFieldsInfo=g.fieldInfos),c.reject())});this._validateLayerDefinition(this._layerDefinition)?g():(this.loading.show(),E({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(x.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,g()):c.reject()}),x.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},_tryOverrideFieldAliases:function(a,b){if(a=this.layerInfosObj.getLayerOrTableInfoById(a))if(a=
a.getPopupInfo())if(a=a.fieldInfos,b=b.fields,a&&0<a.length&&b&&0<b.length){var c={};q.forEach(a,x.hitch(this,function(a){a.fieldName&&(c[a.fieldName]=a)}));q.forEach(b,x.hitch(this,function(a){var b=c[a.name];b&&b.label&&(a.alias=b.label)}))}},toJson:function(){var a={logicalOperator:this.allAnySelect.value,parts:[]},b=this._getAllSingleFiltersAndFilterSets();if(0===b.length)return a.expr="1\x3d1",a;q.forEach(b,x.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return q.every(a.parts,x.hitch(this,
function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(this._layerDefinition.fields&&0!==this._layerDefinition.fields.length){var a=x.clone(this._layerDefinition.fields);0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}else this._showErrorOptions(this.nls.error.noFilterFields)},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();
var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};try{b=this.getFilterObjByExpr(a)}catch(I){b=null,console.error(I)}b?this._buildEditUIByPartsObj(b):this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),q.forEach(a.parts,
x.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&a.operator&&a.valueObj&&this._addSingleFilter(a)})),this.allAnySelect.value=a.logicalOperator,this._setFilterMsgUI(a.parts.length))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,popupFieldsInfo:this._popupFieldsInfo,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:x.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,
isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory,runtime:this.runtime};a=new B(a);a.placeAt(this.allExpsBox);a.startup();this.own(C.after(a,"_destroySelf",x.hitch(this,function(){this._checkFilterNumbers();this._focusOnMobileAdd();this.emit("change")})));this.own(p(a,"change",x.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return a},_focusOnMobileAdd:function(){w.hasClass(this.mobileAddSection,"hidden")||this.btnAddExpMobile.focus()},_addFilterSet:function(a){a=
{url:this.url,layerInfo:this._layerDefinition,popupFieldsInfo:this._popupFieldsInfo,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,partsObj:a,OPERATORS:x.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory,runtime:this.runtime};a=new G(a);a.placeAt(this.allExpsBox);a.startup();this.own(C.after(a,"_destroySelf",x.hitch(this,function(){this._checkFilterNumbers();
this._focusOnMobileAdd();this.emit("change")})));this.own(p(a,"change",x.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return a},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){var a=[];this.allExpsBox.childNodes&&0<this.allExpsBox.childNodes.length&&q.forEach(this.allExpsBox.childNodes,x.hitch(this,function(b){(w.hasClass(b,
"jimu-single-filter")||w.hasClass(b,"jimu-filter-set"))&&a.push(b)}));return a},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return q.map(a,x.hitch(this,function(a){return c.byNode(a)}))},_setFilterMsgUI:function(a){2>a?(this.allAnySelect.value="AND",w.setStyle(this.allAnySelect,"display","none"),w.setStyle(this.oneOrZeroMsg,"display","block")):(w.setStyle(this.oneOrZeroMsg,"display","none"),w.setStyle(this.allAnySelect,"display","block"))},_checkFilterNumbers:function(){var a=
this._getAllSingleFiltersAndFilterSetsDoms();this._setFilterMsgUI(a.length);0<a.length?w.addClass(this.noFilterTipSection,"hidden"):w.removeClass(this.noFilterTipSection,"hidden");this.emit("filter-number-change")},_showErrorOptions:function(a){console.error(a);w.addClass(this.errorSection,"hidden");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnApplyClicked:function(){this.emit("apply")},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&(this._addFilterSet(),this.emit("change"))},
_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&(this._addSingleFilter(),this.emit("change"))}})})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider ./AdvancedListValueProvider ./PredefinedValueProvider ./NumberListValueProvider ./DateIsInValueProvider jimu/utils jimu/LayerInfos/LayerInfos".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},
uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,
supportCaseSensitive:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsAnyOf:{values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},
multiple:{normalProviderType:"ADVANCED_LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},stringOperatorIsNoneOf:{values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},multiple:{normalProviderType:"ADVANCED_LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},
stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",
supportAskForValue:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},
field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",
supportAskForValue:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},
unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0},uniquePredefined:{normalProviderType:"UNIQUE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsAnyOf:{values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},multiple:{normalProviderType:"ADVANCED_LIST_VALUE_PROVIDER",supportAskForValue:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNoneOf:{values:{normalProviderType:"SIMPLE_VALUE_PROVIDER"},
multiple:{normalProviderType:"ADVANCED_LIST_VALUE_PROVIDER",supportAskForValue:!0},multiplePredefined:{normalProviderType:"MULTIPLE_PREDEFINED_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},
dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsIn:{value:{normalProviderType:"DATE_IS_IN_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotIn:{value:{normalProviderType:"DATE_IS_IN_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsOnOrAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},
dateOperatorInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorNotInTheLast:{value:{normalProviderType:"NUMBER_LIST_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},
q=t([],{nls:null,layerInfo:null,popupInfo:null,url:null,layerDefinition:null,featureLayerId:null,constructor:function(a){p.mixin(this,a);this.nls=window.jimuNls.filterBuilder;a=x.getInstanceSync();this.featureLayerId&&(this.layerInfo=a.getLayerOrTableInfoById(this.featureLayerId))&&(this.popupInfo=this.layerInfo.getPopupInfo())},getSupportedValueTypes:function(a,b){var c=[];if(b=w[b])b.value&&c.push("value"),b.field&&0<this._getSameShortTypeFieldNames(a).length&&c.push("field"),b.unique&&this.url&&
(this._isStreamServer(this.url)||c.push("unique")),b.multiple&&this.url&&(this._isStreamServer(this.url)||c.push("multiple")),b.uniquePredefined&&this.url&&(this._isStreamServer(this.url)||c.push("uniquePredefined")),b.multiplePredefined&&this.url&&(this._isStreamServer(this.url)||c.push("multiplePredefined"));return c},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_getSameShortTypeFieldNames:function(a){var b=[],c=this._getFieldInfo(this.layerDefinition,
a),e=q.getShortTypeByEsriType(c.type);g.forEach(this.layerDefinition.fields,p.hitch(this,function(c){c.name!==a&&q.getShortTypeByEsriType(c.type)===e&&b.push(c.name)}));return b},_getSameShortTypeFieldNameLabels:function(a){var b=[],c=this._getFieldInfo(this.layerDefinition,a),e=q.getShortTypeByEsriType(c.type);g.forEach(this.layerDefinition.fields,p.hitch(this,function(c){c.name!==a&&q.getShortTypeByEsriType(c.type)===e&&b.push({value:c.name,label:c.alias})}));return b},getValueProvider:function(g,
q){var t=null,x=p.clone(w[g.operator]);if(x){var z=g.valueObj.type,C=g.fieldObj.name,D=this._getFieldInfo(this.layerDefinition,C),I=x[z],K=I.normalProviderType,J=null,L=c.getCodedValueListForCodedValueOrSubTypes(this.layerDefinition,C);"field"===z?(C=this._getSameShortTypeFieldNameLabels(C),0<C.length&&(J=C)):L&&0<L.length&&I.codedValueProviderType&&(K=I.codedValueProviderType);g={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:g,fieldInfo:D,codedValues:L,staticValues:J,layerInfo:this.layerInfo,
popupInfo:this.popupInfo,operatorInfo:x,filterCodedValueIfPossible:!!I.filterCodedValueIfPossible,runtime:q};if("BLANK_VALUE_PROVIDER"===K)t=new v(g);else if("SIMPLE_VALUE_PROVIDER"===K)t=new n(g);else if("TWO_NUMBERS_VALUE_PROVIDER"===K)t=new m(g);else if("TWO_DATES_VALUE_PROVIDER"===K)t=new u(g);else if("LIST_VALUE_PROVIDER"===K)g.showNullValues=!1,"value"===z||"field"===z?t=new k(g):(g.providerType=K,g.selectUI="dropdown",t=new f(g));else if("NUMBER_LIST_VALUE_PROVIDER"===K)t=new b(g);else if("DATE_IS_IN_VALUE_PROVIDER"===
K)t=new a(g);else if("ADVANCED_LIST_VALUE_PROVIDER"===K)g.providerType=K,g.selectUI="dropdown",t=new f(g);else if("UNIQUE_PREDEFINED_VALUE_PROVIDER"===K||"MULTIPLE_PREDEFINED_VALUE_PROVIDER"===K)g.providerType=K,g.selectUI=g.partObj.valueObj?g.partObj.valueObj.selectUI:null,t=q?new f(g):new e(g)}return t},_getFieldInfo:function(a,b){a=a.fields;for(var c=0;c<a.length;c++){var e=a[c];if(b===e.name)return e}return null}});q.getOperatorInfo=function(a){return p.clone(w[a])};q.getOperatorsByShortType=
function(a,b){var c=[];"string"===a?c="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsAnyOf stringOperatorIsNoneOf stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):"number"===a?c="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsAtMost numberOperatorIsLessThan numberOperatorIsGreaterThan numberOperatorIsAnyOf numberOperatorIsNoneOf numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):
"date"===a&&(c="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsIn dateOperatorIsNotIn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsOnOrBefore dateOperatorIsOnOrAfter dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "),b&&c.splice(8,0,"dateOperatorInTheLast","dateOperatorNotInTheLast"));return c};q.getShortTypeByEsriType=function(a){var b=null;"esriFieldTypeString"===a?b="string":"esriFieldTypeDate"===a?b="date":0<=["esriFieldTypeOID",
"esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a)&&(b="number");return b};return q})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(p,g,t){return g([t],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},
setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),function(p,g,t,v,n,m,u,k,f,e){return m([u,k,g],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,
cascade:"none",filterCodedValue:!1,fieldPopupInfo:null,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,popupInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&
this.filterCodedValueIfPossible&&f.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1;this.popupInfo&&this.popupInfo.fieldInfos&&0<this.popupInfo.fieldInfos.length&&n.some(this.popupInfo.fieldInfos,t.hitch(this,function(b){return b.fieldName===this.fieldName?(this.fieldPopupInfo=b,!0):!1}))},getDijits:function(){return[]},bindChangeEvents:function(){var b=this.getDijits();n.forEach(b,t.hitch(this,function(a){a.declaredClass&&
0===a.declaredClass.indexOf("dijit.")&&v.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(p(a,"change",t.hitch(this,this._onChanged)));this.own(p(a,"enter",t.hitch(this,this._onEnter)))}))},_onChanged:function(){this._onEnterTriggered||this.emit("change")},_onEnterTriggered:!1,_onEnter:function(){this._onEnterTriggered=!0;this.emit("change");this.emit("enter");setTimeout(t.hitch(this,function(){this._onEnterTriggered=!1}),100)},tryLocaleNumber:function(b){var a=f.localizeNumber(b);
if(null===a||void 0===a)a=b;return a},getPartObject:function(){var b=this.getValueObject();if(!b)return null;var a=t.clone(this.partObj);a.valueObj=b;return a},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var b=1,a=this.getDijits();0<a.length&&(b=n.map(a,t.hitch(this,function(a){return"function"===typeof a.getStatus?a.getStatus():this.getStatusForDijit(a)})),b=Math.min.apply(b,b));return b},
getStatusForDijit:function(b){return b.validate()?b.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var b="1\x3d1",b=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var a=this.getCascadeFilterExpr(),b="("+b+") AND ("+a+")";return b},getLayerFilterExpr:function(){var b=
"1\x3d1";this.layerInfo&&(b=this.layerInfo.getFilter());b||(b="1\x3d1");return b},_getWebMapFilterExpr:function(){var b="";this.layerInfo&&(b=this.layerInfo.getFilterOfWebmap());b||(b="1\x3d1");return b},getDropdownFilterExpr:function(){var b="1\x3d1",b=this._getWebMapFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var a=this.getCascadeFilterExpr(),b="("+b+") AND ("+a+")";return b},getCascadeFilterExpr:function(){return"1\x3d1"},getDropdownFilterPartsObj:function(){var b={parts:[]};
if("all"===this.cascade||"previous"===this.cascade)b=this.getCascadeFilterPartsObj();return b},getCascadeFilterPartsObj:function(){return{}},getCodedValueListByPartsObj:function(b,a,c,e){var g=f.getFieldInfoByFieldName(b.fields,a),k=b.typeIdField,m=null;c=c.parts;for(var n in c){var p=c[n];if(p.fieldObj.name===k){k=p.valueObj.value;m=f._getCodedValueBySubTypeId(b,a,k,g);break}}var u;m||(m=e?e:f._getAllCodedValue(b,g));m&&0<m.length&&(u=m[0].value);return{selectedValue:u,valueLabels:m}},isDefined:function(b){return e.isDefined(b)},
disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled},destroy:function(){this.inherited(arguments)}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare dojo/keys ./ValueProvider dijit/form/ValidationTextBox dijit/form/NumberTextBox ./DateValueSelector".split(" "),function(p,g,t,v,n,m,u){return g([v],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,customId:null,postCreate:function(){this.inherited(arguments);
this.customId=this.partObj.vpId;p.addClass(this.domNode,"jimu-filter-simple-value-provider");var g=null;"string"===this.shortType?(g={required:!1,trim:!0,intermediateChanges:!1},this.customId&&(g.id=this.customId),this._dijit=new n(g),this._dijit.startup(),this._dijit.on("keydown",function(f){(f.keyCode||f.which)===t.ENTER&&this._dijit.emit("enter")}.bind(this))):"number"===this.shortType?(g={required:!1,intermediateChanges:!1,constraints:{pattern:"#####0.##########"}},this.customId&&(g.id=this.customId),
this._dijit=new m(g),this._dijit.startup(),this._dijit.on("keydown",function(f){(f.keyCode||f.which)===t.ENTER&&this._dijit.emit("enter")}.bind(this))):(g={popupInfo:this.popupInfo,_fieldInfo:this.fieldInfo},this.customId&&(g.customId=this.customId,g.prompt=this.partObj.interactiveObj.prompt+" "+this.partObj.interactiveObj.hint),this._dijit=new u(g));!this.customId||"string"!==this.shortType&&"number"!==this.shortType||(g=p.toDom('\x3clabel for\x3d"'+this.customId+'" class\x3d"screen-readers-only"\x3e'+
this.partObj.interactiveObj.prompt+" "+this.partObj.interactiveObj.hint+"\x3c/label\x3e"),p.place(g,this.domNode));p.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},getDijits:function(){return[this._dijit]},setValueObject:function(g){this.isDefined(g.value)&&("date"===this.shortType?this._dijit.setValueObject(g):this._dijit.set("value",g.value))},getValueObject:function(){if(this.isValidValue())if("date"===this.shortType){var g=this._dijit.getValueObject();if(g&&g.value)return g.isValid=
!0,g.type=this.partObj.valueObj.type,g}else return g=this._dijit.get("value"),"number"===this.shortType&&(g=parseFloat(g)),{isValid:!0,type:this.partObj.valueObj.type,value:g};return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:null}:null},setRequired:function(g){this._dijit.set("required",g)}})})},"jimu/dijit/_filter/DateValueSelector":function(){define("dojo/aspect dojo/Evented dojo/on dojo/_base/html dojo/dom-construct dojo/_base/lang dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./DateValueSelector.html jimu/filterUtils jimu/utils dijit/form/Select dijit/form/DateTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return k([f,e,b,g],{templateString:a,virtualDates:null,customId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.filterBuilder},postCreate:function(){this.inherited(arguments);v.addClass(this.domNode,"jimu-date-value-selector");var a={};this.customId&&(this.customId+="_select",a=v.toDom('\x3clabel for\x3d"'+this.customId+'" class\x3d"screen-readers-only"\x3e'+this.prompt+"\x3c/label\x3e"),v.place(a,this.domNode),a={id:this.customId});
this.dateTypeSelect=new w(a);v.addClass(this.dateTypeSelect.domNode,"date-type-select");v.addClass(this.dateTypeSelect.domNode,"restrict-select-width");this.dateTypeSelect.placeAt(this.domNode);a=v.toDom('\x3ccaption class\x3d"screen-readers-only-no-position"\x3e'+this.prompt+"\x3c/caption\x3e");n.place(a,this.dateTypeSelect.domNode,"first");this.own(p.before(this.dateTypeSelect,"change",m.hitch(this,function(){this._onDateTypeSelectChanged()})));v.setAttr(this.dateTextBox.textbox,"tabindex","-1");
this.own(t(this.dateTextBox.textbox,"focus",m.hitch(this,function(){this.dateTypeSelect.domNode.focus()})));this.virtualDates&&0<this.virtualDates.length||(this.virtualDates=[c.VIRTUAL_DATE_TODAY,c.VIRTUAL_DATE_YESTERDAY,c.VIRTUAL_DATE_TOMORROW]);this.dateTypeSelect.addOption({value:"",label:"\x26nbsp;"});this.dateTypeSelect.addOption({value:"custom",label:this.nls.custom});u.map(this.virtualDates,m.hitch(this,function(a){var b={value:a,label:a};switch(a){case c.VIRTUAL_DATE_TODAY:b.label=this.nls.today;
break;case c.VIRTUAL_DATE_YESTERDAY:b.label=this.nls.yesterday;break;case c.VIRTUAL_DATE_TOMORROW:b.label=this.nls.tomorrow}this.dateTypeSelect.addOption(b)}));this._showDateTypeSelect();this.own(t(v.byId("main-page"),"click",m.hitch(this,function(){this.dateTextBox&&this.dateTextBox.closeDropDown()})));this.own(p.before(this.dateTypeSelect,"openDropDown",m.hitch(this,function(){"custom"===this.dateTypeSelect.getValue()&&this.dateTextBox.getValue()&&(this.dateTypeSelect.textDirNode.innerText=this._formatDate(this.dateTextBox.getValue()))})));
this.own(p.after(this.dateTypeSelect,"closeDropDown",m.hitch(this,function(){"custom"===this.dateTypeSelect.getValue()&&this.dateTextBox.getValue()&&(this.dateTypeSelect.textDirNode.innerText=this._formatDate(this.dateTextBox.getValue()));this.customId||v.setAttr(this.dateTypeSelect,"aria-label",this.dateTypeSelect.textDirNode.innerText);setTimeout(m.hitch(this,function(){this._dateTextBoxDisplayed&&this.dateTextBox&&this.dateTextBox.dropDown&&this.dateTextBox.dropDown.focus()}),200)})));this.own(p.after(this.dateTypeSelect.dropDown,
"onItemClick",m.hitch(this,function(a){a&&"custom"===a.option.value?(this._showDateTextBox(),this._dateTextBoxDisplayed=!0):this._dateTextBoxDisplayed=!1}),!0));this.popupInfo&&this.popupInfo.fieldInfos&&(this.fieldInfo=this.popupInfo.fieldInfos.filter(m.hitch(this,function(a){return a.fieldName===this._fieldInfo.name}))[0])},getDijits:function(){return[]},setValueObject:function(a){a.virtualDate&&"custom"!==a.virtualDate?(this.dateTypeSelect.set("value",a.virtualDate,!1),this.customId||v.setAttr(this.dateTypeSelect,
"aria-label",a.virtualDate)):(this.dateTypeSelect.set("value","custom",!1),a.value&&(this.dateTextBox.set("value",new Date(a.value),!1),this.dateTypeSelect.textDirNode.innerText=this._formatDate(new Date(a.value)),this.customId||v.setAttr(this.dateTypeSelect,"aria-label",this.dateTypeSelect.textDirNode.innerText)))},getValueObject:function(){return this.isValidValue()?this.tryGetValueObject():null},tryGetValueObject:function(){if(this.isInvalidValue())return null;var a={value:null,virtualDate:""},
b=this.dateTypeSelect.get("value"),e=null;"custom"===b?(e=this.dateTextBox.get("value"),a.value=e?e.toDateString():null,a.virtualDate=""):(e=c.getRealDateByVirtualDate(b),a.virtualDate=b,e?a.value=e.toDateString():a=null);return a},setRequired:function(a){this.dateTextBox.set("required",a)},getStatus:function(){return"custom"===this.dateTypeSelect.get("value")?this._getStatusForDijit(this.dateTextBox):""===this.dateTypeSelect.get("value")?0:1},_getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?
1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},_showDateTypeSelect:function(){this.dateTextBox.closeDropDown()},_showDateTextBox:function(){this.dateTextBox.openDropDown();this.dateTextBoxClickBinded=!0},_onDateTypeSelectChanged:function(){"custom"===this.dateTypeSelect.get("value")&&this._showDateTextBox();this.emit("change")},_onDateTextBoxChanged:function(a){this.dateTypeSelect.textDirNode.innerText=
this._formatDate(a);this.emit("change")},_formatDate:function(a){return this.fieldInfo?x.localizeDateByFieldInfo(a,this.fieldInfo):a.toDateString()}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(p,g,t){return p("dijit.form.DateTextBox",t,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:g,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){var z=v("dijit.Calendar",[c,x,w],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){k.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new z._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:e.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(b(this.domNode,"keydown",e.hitch(this,"_onKeyDown")),b(this.dateRowsNode,"mouseover",e.hitch(this,"_onDayMouseOver")),b(this.dateRowsNode,"mouseout",e.hitch(this,"_onDayMouseOut")),b(this.dateRowsNode,"mousedown",e.hitch(this,"_onDayMouseDown")),b(this.dateRowsNode,"mouseup",e.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=m.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(m.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||
a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",m.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),m.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!m.contains(a,"dijitCalendarDisabledDate")&&(m.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&m.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,e=this.currentFocus;switch(a.keyCode){case f.RIGHT_ARROW:b=1;case f.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case f.DOWN_ARROW:b=1;case f.UP_ARROW:c="week";break;case f.PAGE_DOWN:b=1;case f.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case f.END:e=this.dateModule.add(e,"month",1),c="day";case f.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}c&&(e=this.dateModule.add(e,c,b));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});z._MonthDropDownButton=v("dijit.Calendar._MonthDropDownButton",C,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new z._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(b){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.dropDown.set("months",
c);this.containerNode.innerHTML=(6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[b.getMonth()]+"\x3c/div\x3e"}});z._MonthDropDown=v("dijit.Calendar._MonthDropDown",[x,q,w],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";p.forEach(a,function(a,b){u.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(n.get(a.target,"month"))},onChange:function(){}});return z})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){var C=g("dijit.CalendarLite",[x,w],{templateString:q,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=m.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),e=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),g=new this.dateClassObj,k=0<=this.dayOffset?this.dayOffset:t.getFirstDayOfWeek(this.lang);k>
b&&(k-=7);if(!this.summary){var m=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",m[a.getMonth()])}this._date2cell={};p.forEach(this.dateCells,function(m,p){var q=p+k,w=new this.dateClassObj(a),u="dijitCalendar",t=0;q<b?(q=e-b+q+1,t=-1,u+="Previous"):q>=b+c?(q=q-b-c+1,t=1,u+="Next"):(q=q-b+1,u+="Current");t&&(w=this.dateModule.add(w,"month",t));w.setDate(q);this.dateModule.compare(w,g,"date")||(u="dijitCalendarCurrentDate "+u);this.isDisabledDate(w,
this.lang)?(u="dijitCalendarDisabledDate "+u,m.setAttribute("aria-disabled","true")):(u="dijitCalendarEnabledDate "+u,m.removeAttribute("aria-disabled"),m.setAttribute("aria-selected","false"));(t=this.getClassForDate(w,this.lang))&&(u=t+" "+u);m.className=u+"Month dijitCalendarDateTemplate";u=w.valueOf();this._date2cell[u]=m;m.dijitDateValue=u;u=w.getDateLocalized?w.getDateLocalized(this.lang):w.getDate();this._setText(this.dateLabels[p],u);f.set(m,"aria-label",n.format(w,{selector:"date",formatLength:"long"}))},
this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;p.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?e.getObject(a.datePackage,
!1):v;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?e.getObject(a.datePackage+".locale",!1):n},_createMonthWidget:function(){return C._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=0<=this.dayOffset?this.dayOffset:t.getFirstDayOfWeek(this.lang);this.dayCellsHtml=c.substitute([a,
a,a,a,a,a,a].join(""),{d:""},function(){return b[e++%7]});a=c.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);u.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=e.hitch(this,function(a,
c,f){this[a].dojoClick=!0;return b(this[a],"click",e.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,c,f))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(b,c){var e=this.currentFocus,f=this._getNodeByDate(e);b=this._patchDate(b);this._set("currentFocus",b);this._date2cell&&0==this.dateModule.difference(e,b,"month")||(this._populateGrid(),
this._populateControls(),this._markSelectedDates([this.value]));b=this._getNodeByDate(b);b.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&b.focus();f&&f!=b&&(a("webkit")?f.setAttribute("tabIndex","-1"):f.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!k.contains(a,"dijitCalendarDisabledDate")&&this.set("value",
a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,b){k.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}p.forEach(this._selectedCells||[],e.partial(b,!1));this._selectedCells=p.filter(p.map(a,this._getNodeByDate,this),function(a){return a});p.forEach(this._selectedCells,e.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});
C._MonthWidget=g("dijit.CalendarLite._MonthWidget",x,{_setMonthAttr:function(b){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b),e=6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+p.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=e+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[b.getMonth()]+"\x3c/div\x3e"}});return C})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(p,g,t,v,n,m,u,k){new Date("X");return v("dijit.form._DateTimeTextBox",[m,u],{templateString:k,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:g.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(f,e){var b=this._isInvalidDate(f),a=this._isInvalidDate(e);if(b||a)return b&&a?0:b?-1:1;f=this.format(f,this._unboundedConstraints);e=this.format(e,this._unboundedConstraints);
b=this.parse(f,this._unboundedConstraints);a=this.parse(e,this._unboundedConstraints);return f==e?0:p.compare(b,a,this._selector)},autoWidth:!0,format:function(f,e){return f?this.dateLocaleModule.format(f,e):""},parse:function(f,e){return this.dateLocaleModule.parse(f,e)||(this._isEmpty(f)?null:void 0)},serialize:function(f,e){f.toGregorian&&(f=f.toGregorian());return t.toISOString(f,e)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(f){f=
f||{};this.dateModule=f.datePackage?n.getObject(f.datePackage,!1):p;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=f.datePackage?n.getObject(f.datePackage+".locale",!1):g;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(f){f.selector=this._selector;f.fullYear=!0;var e=t.fromISOString;"string"==typeof f.min&&(f.min=e(f.min),this.dateClassObj instanceof Date||(f.min=new this.dateClassObj(f.min)));"string"==typeof f.max&&(f.max=e(f.max),this.dateClassObj instanceof Date||(f.max=new this.dateClassObj(f.max)));this.inherited(arguments);this._unboundedConstraints=n.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(f){return!f||
isNaN(f)||"object"!=typeof f||f.toString()==this._invalidDate},_setValueAttr:function(f,e,b){void 0!==f&&("string"==typeof f&&(f=t.fromISOString(f)),this._isInvalidDate(f)&&(f=null),f instanceof Date&&!(this.dateClassObj instanceof Date)&&(f=new this.dateClassObj(f)));this.inherited(arguments,[f,e,b]);this.value instanceof Date&&(this.filterString="");!1!==e&&this.dropDown&&this.dropDown.set("value",f,!1)},_set:function(f,e){if("value"==f){e instanceof Date&&!(this.dateClassObj instanceof Date)&&
(e=new this.dateClassObj(e));var b=this._get("value");if(b instanceof this.dateClassObj&&0==this.compare(e,b))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(f){this._isInvalidDate(f)&&(f=new this.dateClassObj);this._set("dropDownDefaultValue",f)},openDropDown:function(f){this.dropDown&&this.dropDown.destroy();var e=n.isString(this.popupClass)?n.getObject(this.popupClass,!1):this.popupClass,b=this,a=this.get("value");this.dropDown=new e({onChange:function(a){b.set("value",
a,!0)},id:this.id+"_popup",dir:b.dir,lang:b.lang,value:a,textDir:b.textDir,currentFocus:this._isInvalidDate(a)?this.dropDownDefaultValue:a,constraints:b.constraints,filterString:b.filterString,datePackage:b.datePackage,isDisabledDate:function(a){return!b.rangeCheck(a,b.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(f,e){this._setValueAttr(this.parse(f,this.constraints),e,f)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/lang dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f){return t([v,n,m],{templateString:u,customId:null,postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-two-numbers-filter-value-provider");this.customId=this.partObj.vpId;var e={required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},b=g.clone(e),a;if(this.customId){e.id=this.customId+"_between";a=this.customId;var c=p.toDom('\x3clabel for\x3d"'+e.id+'" class\x3d"screen-readers-only"\x3e'+this.partObj.interactiveObj.prompt+
" "+this.partObj.interactiveObj.hint+"\x3c/label\x3e");p.place(c,this._dijit1_container)}else a=f.getUUID();b.id=a+"_and";a=p.toDom('\x3clabel for\x3d"'+b.id+'" class\x3d"screen-readers-only"\x3e'+this.nls.and+"\x3c/label\x3e");p.place(a,this._dijit2_container);this._dijit1=new k(e);this._dijit2=new k(b);this._dijit1.startup();this._dijit2.startup();this._dijit1.on("blur",function(){this._onRangeNumberBlur()}.bind(this));this._dijit2.on("blur",function(){this._onRangeNumberBlur()}.bind(this));p.setStyle(this._dijit1.domNode,
"width","100%");p.setStyle(this._dijit2.domNode,"width","100%");this._dijit1.placeAt(this._dijit1_container);this._dijit2.placeAt(this._dijit2_container)},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var e=parseFloat(this._dijit1.get("value")),b=parseFloat(this._dijit2.get("value"));e>b&&(this._dijit1.set("value",b),this._dijit2.set("value",e))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this.isDefined(e.value1)&&this._dijit1.set("value",
e.value1);this.isDefined(e.value2)&&this._dijit2.set("value",e.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var e={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(e.value1)&&(e.value1=null);isNaN(e.value2)&&(e.value2=null);return e}return null},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/Evented dojo/_base/html dojo/_base/declare dojo/_base/lang ./ValueProvider dijit/_WidgetsInTemplateMixin ./DateValueSelector dojo/text!./TwoDatesValueProvider.html jimu/utils".split(" "),function(p,g,t,v,n,m,u,k,f){return t([n,m,p],{templateString:k,customId:null,
postCreate:function(){this.inherited(arguments);this.customId=this.partObj.vpId;g.addClass(this.domNode,"jimu-two-dates-filter-value-provider");var e={popupInfo:this.popupInfo,_fieldInfo:this.fieldInfo,style:{width:"100%"}},b=v.clone(e),a;this.customId?(e.customId=this.customId+"_between",e.prompt=this.partObj.interactiveObj.prompt+" "+this.partObj.interactiveObj.hint,a=this.customId):a=f.getUUID();b.customId=a+"_and";b.prompt=this.nls.and;this._dijit1=new u(e,this._dijitDiv1);this._dijit2=new u(b,
this._dijitDiv2)},_initDateSelectors:function(){},_onDateValueSelectorChanged:function(){this.emit("change")},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this._setValueObject(this._dijit1,e,"value1","virtualDate1");this._setValueObject(this._dijit2,e,"value2","virtualDate2")},_setValueObject:function(e,b,a,c){if(this.isDefined(b[a])){var f={value:null,virtualDate:""};f.value=b[a];f.virtualDate=b[c];e.setValueObject(f)}},getValueObject:function(){if(this.isValidValue()){var e=
this._dijit1.getValueObject(),b=this._dijit2.getValueObject();if(e.value&&b.value)return{isValid:!0,type:this.partObj.valueObj.type,value1:e.value,value2:b.value,virtualDate1:e.virtualDate,virtualDate2:b.virtualDate}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:null,value2:null,virtualDate1:null,virtualDate2:null}:null},getStatus:function(){return 1===this._dijit1.getStatus()&&1===
this._dijit2.getStatus()?1:-1===this._dijit1.getStatus()||-1===this._dijit2.getStatus()?-1:0},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/_base/declare ./ValueProvider dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return u([k],{templateString:"\x3cdiv\x3e\x3c/div\x3e",
codedValues:null,staticValues:null,showNullValues:!1,layerDataChanged:!1,ifDropDown:!1,customId:null,postCreate:function(){this.inherited(arguments);v.addClass(this.domNode,"jimu-filter-list-value-provider");this.customId=this.partObj.vpId;this._initValueSelect();this._uniqueValueCache={};this.noDataTips='\x3cdiv class\x3d"error-tip-section" style\x3d"display: block;"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text"\x3e'+this.nls.noFilterValueTip+
"\x3c/span\x3e\x3c/div\x3e";var a=new f({idProperty:"id",data:[]});this.valuesSelect.set("store",a);this.isNumberField=e.isNumberField(this.fieldInfo.type);!this.staticValues&&"function"===typeof this.valuesSelect._onDropDownMouseDown&&(!this.codedValues||this.codedValues&&this.filterCodedValue)&&(this.own(p.before(this.valuesSelect,"_onDropDownMouseDown",t.hitch(this,this._onBeforeDropDownMouseDown))),this.own(m(document.body,"click",t.hitch(this,this._onBodyClick))),this.layerInfo&&this.layerInfo.getLayerObject().then(t.hitch(this,
function(a){a.on("edits-complete",t.hitch(this,function(){this.layerDataChanged=!0}))})))},_initValueSelect:function(){var a={searchAttr:"label",required:!1,intermediateChanges:!0};this.customId&&(a["aria-label"]=this.partObj.interactiveObj.prompt+" "+this.partObj.interactiveObj.hint);this.valuesSelect=new b(a);this.valuesSelect.startup();this.valuesSelect.on("input",t.hitch(this,this._onFilteringSelectInput));v.setStyle(this.valuesSelect.domNode,"width","100%");this.valuesSelect.placeAt(this.domNode)},
_onFilteringSelectInput:function(){this.emit("change")},_getCodedValueLabelsBySubTypeId:function(){var a=this.getDropdownFilterPartsObj();return this.getCodedValueListByPartsObj(this.layerDefinition,this.fieldName,a,this.codedValues)},_onBeforeDropDownMouseDown:function(){this.ifDropDown=!0;this._tryUpdatingUniqueValues(void 0,!0);return arguments},_onBodyClick:function(a){a=a.target||a.srcElement;a===this.domNode||v.isDescendant(a,this.domNode)||this.msgDiv&&v.setStyle(this.msgDiv,"display","none")},
getDijits:function(){return[this.valuesSelect]},isValidValue:function(){return 0<this.getStatus()},getStatus:function(){var a=this.valuesSelect.get("item");if(a&&void 0!==a.value){if(this.isNumberField&&!e.isValidNumber(a.value)&&"value"===this.partObj.valueObj.type){var b=parseFloat(a.value);return e.isValidNumber(b)?(a.value=b,this._getStatusForDijit(this.valuesSelect)):-1}return this._getStatusForDijit(this.valuesSelect)}return 0},_getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?
1:0:-1},setValueObject:function(a){return this.staticValues?this._setValueForStaticValues(a.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(a.value,!1):this._setValueForStaticValues(a.value,this.codedValues):this._tryUpdatingUniqueValues(a.value,!1)},getValueObject:function(){if(this.isValidValue()){var a=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},tryGetValueObject:function(){return this.isValidValue()?
this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(a){this.valuesSelect.set("required",a)},_setValueForStaticValues:function(a,b){var c=null,e=-1,c=null;b&&(c=n.map(b,t.hitch(this,function(b,c){b={id:c,value:b.value,label:b.label};b.value+""===a+""&&(e=c);return b})),this.valuesSelect.store.setData(c),0<=e&&(c=this.valuesSelect.store.get(e))&&this.valuesSelect.set("item",c),this._checkIfNoData())},
_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new g;if(this.valuesSelect._opened)this._checkIfNoData(),c.resolve();else{var e=this.getDropdownFilterExpr();e!==this._uniqueValueLoadingExpr||this.layerDataChanged?(this.valuesSelect.readOnly=!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=e,this._uniqueValueLoadingDef=this._getUniqueValues(e),
this._uniqueValueLoadingDef.then(t.hitch(this,function(e){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,e),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),this._checkIfNoData(),c.resolve())}),t.hitch(this,function(a){console.error(a);this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),this._checkIfNoData(),c.reject(a))}))):(this._checkIfNoData(),c.resolve())}return c},_setValueForUniqueValues:function(a,
b){b.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(b=n.filter(b,t.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var e=-1,c=null;b=n.map(b,t.hitch(this,function(b,c){var f={id:c,value:b.value,label:b.label};b.value+""===a+""&&(e=c);return f}));this.valuesSelect.store.setData(b);0<=e&&(c=this.valuesSelect.store.get(e));this.valuesSelect.set("item",c)},_checkIfNoData:function(){this.runtime&&
this.ifDropDown&&(this.ifDropDown=!1,0===this.valuesSelect.store.data.length&&(this.msgDiv?v.setStyle(this.msgDiv,"display","block"):(this.msgDiv=document.createElement("div"),v.addClass(this.msgDiv,"jimu-filter-list-value-provider-tip-container"),this.msgDiv.innerHTML=this.noDataTips,this.valuesSelect.domNode.parentNode.appendChild(this.msgDiv))))},_showLoadingIcon:function(){v.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){v.removeClass(this.valuesSelect.domNode,"loading")},
_getUniqueValues:function(a){var b=new g;this._uniqueValueCache[a]&&!this.layerDataChanged?b.resolve(this._uniqueValueCache[a]):(this._showLoadingIcon(),e.getUniqueValues(this.url,this.fieldName,a,this.layerDefinition,this.fieldPopupInfo).then(t.hitch(this,function(c){this.domNode&&(this._uniqueValueCache[a]=c,b.resolve(c),this._hideLoadingIcon())}),t.hitch(this,function(a){this.domNode&&(b.reject(a),this._hideLoadingIcon())})));this.layerDataChanged=!1;return b}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(p,g,t,v,n){return p("dijit.form.FilteringSelect",[v,n],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(g,n,k,f){n&&n[this.searchAttr]!==this._lastQuery||!n&&g.length&&this.store.getIdentity(g[0])!=this._lastQuery||
(g.length?this.set("item",g[0],f):this.set("value","",f||void 0===f&&!this.focused,this.textbox.value,null))},_openResultList:function(g,n,k){n[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(m,n,k,f){this._onChangeActive||(n=null);if(void 0===f){if(null===m||""===m)if(m="",!g.isString(k)){this._setDisplayedValueAttr(k||"",n);
return}var e=this;this._lastQuery=m;t(this.store.get(m),function(b){e._callbackSetLabel(b?[b]:[],void 0,void 0,n)})}else this.valueNode.value=m,this.inherited(arguments,[m,n,k,f])},_setItemAttr:function(g,n,k){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(g){return g.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(m,n){null==m&&(m="");if(!this._created){if(!("displayedValue"in this.params))return;n=!1}if(this.store){this.closeDropDown();
var k=g.clone(this.query),f=this._getDisplayQueryString(m),e;this.store._oldAPI?e=f:(e=this._patternToRegExp(f),e.toString=function(){return f});this._lastQuery=k[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=m;this._set("displayedValue",m);var b=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};g.mixin(a,this.fetchProperties);this._fetchHandle=this.store.query(k,a);t(this._fetchHandle,function(c){b._fetchHandle=null;b._callbackSetLabel(c||[],k,a,n)},function(a){b._fetchHandle=
null;b._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(p,g,t,v,n,m,u,k,f){return p("dijit.form.ComboBoxMixin",[k,m],{dropDownClass:u,hasDownArrow:!0,
templateString:f,baseClass:"dijitTextBox dijitComboBox",cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(e){this._set("hasDownArrow",e);this._buttonNode.style.display=e?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(e){e.get||v.mixin(e,{_oldAPI:!0,get:function(b){var a=new g;this.fetchItemByIdentity({identity:b,onItem:function(b){a.resolve(b)},onError:function(b){a.reject(b)}});return a.promise},query:function(b,
a){var c=new g(function(){e.abort&&e.abort()});c.total=new g;var e=this.fetch(v.mixin({query:b,onBegin:function(a){c.total.resolve(a)},onComplete:function(a){c.resolve(a)},onError:function(a){c.reject(a)}},a));return n(c)}});this._set("store",e)},postMixInProperties:function(){var e=this.params.store||this.store;e&&this._setStoreAttr(e);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var b=this.declaredClass;v.mixin(this.store,{getValue:function(a,c){t.deprecated(b+
".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly","","2.0");return a[c]},getLabel:function(a){t.deprecated(b+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return a.name},fetch:function(a){t.deprecated(b+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],v.hitch(this,function(b){(new b({objectStore:this})).fetch(a)}))}})}},buildRendering:function(){this.inherited(arguments);
this.focusNode.setAttribute("aria-autocomplete",this.autoComplete?"both":"list")}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){g=g("dijit.form._AutoCompleterMixin",b,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(a){var b=
0;if("number"==typeof a.selectionStart)b=a.selectionStart;else if(k("ie")){var e=a.ownerDocument.selection.createRange().duplicate();a=a.createTextRange();e.move("character",0);a.move("character",0);try{a.setEndPoint("EndToEnd",e),b=String(a.text).replace(/\r/g,"").length}catch(w){}}return b},_setCaretPos:function(a,b){b=parseInt(b);e.selectInputText(a,b,b)},_setDisabledAttr:function(a){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",a?"true":"false")},_onKey:function(a){if(!(32<=
a.charCode)){var b=a.charCode||a.keyCode;if(b!=v.ALT&&b!=v.CTRL&&b!=v.META&&b!=v.SHIFT){var e=this.dropDown,f=null;this._abortQuery();this.inherited(arguments);if(!(a.altKey||a.ctrlKey||a.metaKey))switch(this._opened&&(f=e.getHighlightedOption()),b){case v.PAGE_DOWN:case v.DOWN_ARROW:case v.PAGE_UP:case v.UP_ARROW:this._opened&&this._announceOption(f);a.stopPropagation();a.preventDefault();break;case v.ENTER:if(f){if(f==e.nextButton){this._nextSearch(1);a.stopPropagation();a.preventDefault();break}else if(f==
e.previousButton){this._nextSearch(-1);a.stopPropagation();a.preventDefault();break}a.stopPropagation();a.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case v.TAB:b=this.get("displayedValue");if(e&&(b==e._messages.previousMessage||b==e._messages.nextMessage))break;f&&this._selectOption(f);case v.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(a){var b=this.focusNode;e.selectInputText(b,b.value.length);
var f=this.ignoreCase?"toLowerCase":"substr";0==a[f](0).indexOf(this.focusNode.value[f](0))?(f=this.autoComplete?this._getCaretPos(b):b.value.length,f+1>b.value.length&&(b.value=a,e.selectInputText(b,f))):(b.value=a,e.selectInputText(b))},_openResultList:function(a,b,e){var c=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();a.length||0!=e.start?(this._nextSearch=this.dropDown.onPage=n.hitch(this,function(b){a.nextPage(-1!==b);this.focus()}),this.dropDown.createOptions(a,e,n.hitch(this,
"_getMenuLabelFromItem")),this._showResultList(),"direction"in e?(e.direction?this.dropDown.highlightFirstOption():e.direction||this.dropDown.highlightLastOption(),c&&this._announceOption(this.dropDown.getHighlightedOption())):!this.autoComplete||this._prev_key_backspace||/^[*]+$/.test(b[this.searchAttr].toString())||this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)):this.closeDropDown()},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded",
"true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var a=this.get("displayedValue"),b=this.dropDown;!b||a!=b._messages.previousMessage&&a!=b._messages.nextMessage?"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",a)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,
!0),this._refreshState()):this._setValueAttr(this._lastValueReported,!0);this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(a,b,e){var c="";a&&(e||(e=this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]),c=this._getValueField()!=this.searchAttr?this.store.getIdentity(a):e);this.set("value",c,b,e,a)},_announceOption:function(a){if(a){var b;if(a==this.dropDown.nextButton||a==this.dropDown.previousButton)b=a.innerHTML,this.item=void 0,this.value="";
else{var e=this.dropDown.items[a.getAttribute("item")];b=(this.store._oldAPI?this.store.getValue(e,this.searchAttr):e[this.searchAttr]).toString();this.set("item",e,!1,b)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",t.get(a,"id"));this._autoCompleteText(b)}},_selectOption:function(a){this.closeDropDown();a&&this._announceOption(a);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,
!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new (n.isString(this.dropDownClass)?n.getObject(this.dropDownClass,!1):this.dropDownClass)({onChange:n.hitch(this,this._selectOption),id:b,dir:this.dir,textDir:this.textDir})}this._lastInput=a;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},
postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new f({},this.srcNodeRef),!("value"in this.params))){var a=this.item=this.store.fetchSelectedItem();if(a){var b=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(a,b):a[b]}}},postCreate:function(){var a=m('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",a[0].id));this.inherited(arguments);p.after(this,"onSearch",
n.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(a){a=this.labelFunc(a,this.store);var b=this.labelType;"none"!=this.highlightMatch&&"text"==this.labelType&&this._lastInput&&(a=this.doHighlight(a,this._lastInput),b="html");return{html:"html"==b,label:a}},doHighlight:function(a,b){var c=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),e=this.queryExpr.indexOf("${0}");b=u.escapeString(b);return this._escapeHtml(a.replace(new RegExp((0==e?"^":"")+"("+b+")"+(e==this.queryExpr.length-
4?"$":""),c),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(a){return a=String(a).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=null;this.inherited(arguments)},labelFunc:function(a,b){return(b._oldAPI?b.getValue(a,this.labelAttr||this.searchAttr):a[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(a,
b,e,f){this._set("item",f||null);null==a&&(a="");this.inherited(arguments)}});k("dojo-bidi")&&g.extend({_setTextDirAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",a)}});return g})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),function(p,g,t,v,n,m){function u(g){return{id:g.value,value:g.value,name:t.trim(g.innerText||g.textContent||"")}}return p("dijit.form.DataList",
n,{constructor:function(k,f){this.domNode=g.byId(f);t.mixin(this,k);this.id&&m.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:v("option",this.domNode).map(u)}])},destroy:function(){m.remove(this.id)},fetchSelectedItem:function(){var g=v("\x3e option[selected]",this.domNode)[0]||v("\x3e option",this.domNode)[0];return g&&u(g)}})})},"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),
function(p,g,t,v,n,m,u){return p("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(g){this._set("list",g)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(g){return new RegExp("^"+g.replace(/(\\.)|(\*)|(\?)|\W/g,function(f,e,b,a){return b?".*":a?".":e?e:"\\"+f})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&
(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(k){if(!this.disabled&&!this.readOnly){k=k.charOrCode;this._prev_key_backspace=!1;if(k==g.DELETE||k==g.BACKSPACE)this._maskValidSubsetError=this._prev_key_backspace=!0;if(this.store)this.searchTimer=
this.defer("_startSearchFromInput",1);else this.onSearch()}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(g){this._abortQuery();var f=this,e=t.clone(this.query),b={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},a=n.substitute(this.queryExpr,[g.replace(/([\\\*\?])/g,"\\$1")]),c,k=function(){var a=f._fetchHandle=f.store.query(e,b);f.disabled||f.readOnly||c!==f._lastQuery||m(a,function(g){f._fetchHandle=
null;f.disabled||f.readOnly||c!==f._lastQuery||m(a.total,function(a){g.total=a;var c=f.pageSize;if(isNaN(c)||c>g.total)c=g.total;g.nextPage=function(a){b.direction=a=!1!==a;b.count=c;a?(b.start+=g.length,b.start>=g.total&&(b.count=0)):(b.start-=c,0>b.start&&(b.count=Math.max(c+b.start,0),b.start=0));0>=b.count?(g.length=0,f.onSearch(g,e,b)):k()};f.onSearch(g,e,b)})},function(a){f._fetchHandle=null;f._cancelingQuery||console.error(f.declaredClass+" "+a.toString())})};t.mixin(b,this.fetchProperties);
this.store._oldAPI?c=a:(c=this._patternToRegExp(a),c.toString=function(){return a});this._lastQuery=e[this.searchAttr]=c;this._queryDeferHandle=this.defer(k,this.searchDelay)},constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var g=this.list;g&&(this.store=u.byId(g))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),
function(p,g,t,v,n,m,u,k){return p("dijit.form._ComboBoxMenu",[n,m,k,u],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(g.add(this.previousButton,"dijitMenuItemRtl"),g.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var f=this.ownerDocument.createElement("div");f.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");f.setAttribute("role","option");return f},onHover:function(f){g.add(f,"dijitMenuItemHover")},onUnhover:function(f){g.remove(f,
"dijitMenuItemHover")},onSelect:function(f){g.add(f,"dijitMenuItemSelected")},onDeselect:function(f){g.remove(f,"dijitMenuItemSelected")},_page:function(f){var e=0,b=this.domNode.scrollTop,a=t.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();e<a;){var c=this.getHighlightedOption();if(f){if(!c.previousSibling||"none"==c.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!c.nextSibling||"none"==c.nextSibling.style.display)break;this.selectNextNode()}c=
this.domNode.scrollTop;e+=(c-b)*(f?-1:1);b=c}},handleKey:function(f){switch(f.keyCode){case v.DOWN_ARROW:return this.selectNextNode(),!1;case v.PAGE_DOWN:return this._page(!1),!1;case v.UP_ARROW:return this.selectPreviousNode(),!1;case v.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(p,g,t,v,n){var m=g("dijit.form._ComboBoxMenuMixin"+
(v("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=n.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(g){this._set("value",g);this.onChange(g)},onClick:function(g){if(g==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(g==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(g)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(g,k){var f=this._createMenuItem();g=k(g);g.html?f.innerHTML=g.label:f.appendChild(f.ownerDocument.createTextNode(g.label));""==f.innerHTML&&(f.innerHTML="\x26#160;");return f},createOptions:function(g,k,f){this.items=g;this.previousButton.style.display=0==k.start?"none":"";t.set(this.previousButton,"id",this.id+
"_prev");p.forEach(g,function(b,a){b=this._createOption(b,f);b.setAttribute("item",a);t.set(b,"id",this.id+a);this.nextButton.parentNode.insertBefore(b,this.nextButton)},this);var e=!1;g.total&&!g.total.then&&-1!=g.total?k.start+k.count<g.total?e=!0:k.start+k.count>g.total&&k.count==g.length&&(e=!0):k.count==g.length&&(e=!0);this.nextButton.style.display=e?"":"none";t.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var g=this.containerNode;2<g.childNodes.length;)g.removeChild(g.childNodes[g.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});v("dojo-bidi")&&(m=g("dijit.form._ComboBoxMenuMixin",
m,{_createOption:function(){var g=this.inherited(arguments);this.applyTextDir(g);return g}}));return m})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(p,g,t,v){return p("dijit.form._ListMouseMixin",v,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(g,m){this._setSelectedAttr(m,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(m)})},_onMouseDown:function(g,m){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(m,!1)},_onMouseUp:function(g,m){this._isDragging=!1;var n=this.selected,k=this._hoveredNode;n&&m==n?this.defer(function(){this._onClick(g,
n)}):k&&this.defer(function(){this._onClick(g,k)})},_onMouseOut:function(g,m){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(g,m){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=m;this.onHover(m);this._isDragging&&this._setSelectedAttr(m,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(p,g,t){return p("dijit.form._ListBase",null,{selected:null,_listConnect:function(p,n){var m=this;return m.own(g(m.containerNode,g.selector(function(g,k,f){return g.parentNode==f},p),function(g){m[n](g,this)}))},selectFirstNode:function(){for(var g=this.containerNode.firstChild;g&&"none"==g.style.display;)g=g.nextSibling;this._setSelectedAttr(g,!0)},selectLastNode:function(){for(var g=this.containerNode.lastChild;g&&"none"==g.style.display;)g=g.previousSibling;this._setSelectedAttr(g,
!0)},selectNextNode:function(){var g=this.selected;if(g){for(g=g.nextSibling;g&&"none"==g.style.display;)g=g.nextSibling;g?this._setSelectedAttr(g,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var g=this.selected;if(g){for(g=g.previousSibling;g&&"none"==g.style.display;)g=g.previousSibling;g?this._setSelectedAttr(g,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(g,n){if(this.selected!=g){var m=this.selected;if(m)this.onDeselect(m);
g&&(n&&t.scrollIntoView(g),this.onSelect(g));this._set("selected",g)}else if(g)this.onSelect(g)}})})},"jimu/dijit/_filter/AdvancedListValueProvider":function(){define("dojo/Deferred dojo/_base/lang dojo/on dojo/keys dojo/Evented dojo/_base/html dojo/_base/array dojo/_base/declare dojo/query ./ValueProvider ./AdvancedListValueSelect dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdvancedListValueProvider.html jimu/utils jimu/dijit/_filter/pageControlForQuery jimu/dijit/Popup".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){return k([e,a,c,n],{templateString:x,codedValues:null,staticValues:null,showNullValues:!1,cbxPopup:null,pageSize:1E3,pageIndex:1,emptyStr:"",postMixInProperties:function(){this.inherited(arguments);this.CommonNls=window.jimuNls.common;this.emptyStr=window.apiNls.widgets.FeatureTable.empty},postCreate:function(){this.inherited(arguments);this.noDataTips='\x3cdiv class\x3d"error-tip-section" style\x3d"display: block;"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text"\x3e'+
this.nls.noFilterValueTip+"\x3c/span\x3e\x3c/div\x3e";m.addClass(this.domNode,"jimu-filter-mutcheck-list-value-provider");"ADVANCED_LIST_VALUE_PROVIDER"===this.providerType?(this.controlType="multipleDynamic",this.checkedNumDiv.style.display="block"):"LIST_VALUE_PROVIDER"===this.providerType?(this.controlType="uniqueDynamic",this.checkedNameDiv.style.display="block"):(this.runtime&&"dropdown"===this.selectUI&&("UNIQUE_PREDEFINED_VALUE_PROVIDER"===this.providerType?this.checkedNameDiv.style.display=
"block":this.checkedNumDiv.style.display="block"),this.controlType="MULTIPLE_PREDEFINED_VALUE_PROVIDER"===this.providerType?"multiplePredefined":"uniquePredefined");this.selectType="MULTIPLE_PREDEFINED_VALUE_PROVIDER"===this.providerType?"multiple":"UNIQUE_PREDEFINED_VALUE_PROVIDER"===this.providerType?"unique":"LIST_VALUE_PROVIDER"===this.providerType?"unique":"multiple";this.disPlayLabel="value";!this.runtime||"multiplePredefined"!==this.controlType&&"uniquePredefined"!==this.controlType||(this.disPlayLabel=
"alias");!this.runtime||"multipleDynamic"!==this.controlType&&"uniqueDynamic"!==this.controlType||(this.isLoadDataAdvanced=!0);this.isNumberField=w.isNumberField(this.fieldInfo.type);this.pageControlForQuery||(this.pageControlForQuery=new q({pageSize:this.pageSize,pageIndex:1,layerUrl:this.url,fieldInfo:this.fieldInfo,queryWhere:"1\x3d1",layerDefinition:this.layerDefinition,fieldPopupInfo:this.fieldPopupInfo,isNumberField:this.isNumberField}),this.pageControlForQuery.on("query_getNewExpr",g.hitch(this,
this._resetPageControlNewExpr)));this.listSelect||(this.listSelectDataList=this.partObj&&this.partObj.valueObj&&this.partObj.valueObj.value?this.partObj.valueObj.value:[],this.listSelect=new b({emptyStr:this.emptyStr,runtime:this.runtime,pageSize:this.pageSize,selectUI:this.selectUI,controlType:this.controlType,selectType:this.selectType,dataList:this.listSelectDataList,selectedDataList:[],isNumberField:this.isNumberField}),g.isArray(this.listSelectDataList)?this.getCheckedList(this.listSelectDataList):
(this.listSelect.checkedList=[this.listSelectDataList],this.listSelect._updateCheckedLabelListFromCheckedList()),this.listSelect.on("advancedListValueSelect_itemChecked",g.hitch(this,this._createTarget)),this.listSelect.on("advancedListValueSelect_itemUnChecked",g.hitch(this,this._destoryTarget)),this.listSelect.on("advancedListValueSelect_addNextPage",g.hitch(this,this._addNextPage)),this.listSelect.on("advancedListValueSelect_searchKey",g.hitch(this,this._searchKey)),this.listSelect.on("advancedListValueSelect_searchKeyLocal",
g.hitch(this,this._searchKeyLocal)),this.listSelect.on("advancedListValueSelect_itemsConfirmed",g.hitch(this,function(){"block"===m.getStyle(this.cbxPopup.domNode,"display")&&(this._resetListSelectState(this),this.cbxPopup.hide());this.checkedBtn.focus()})),this.own(t(this.checkedBtn,"keydown",g.hitch(this,function(a){m.hasClass(a.target||a.srcElement,"checkBtn")&&a.keyCode===v.ENTER&&this._checkedBtnEvent()}))),this._resetPromptLabel(!1),this.staticValues||"function"!==typeof this._checkedBtnEvent||
(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.layerInfo&&this.layerInfo.getLayerObject().then(g.hitch(this,function(a){a.on("edits-complete",g.hitch(this,function(){this.layerDataChanged=!0}))})));"dropdown"===this.selectUI?(m.setStyle(this.checkedBtn,"display","block"),this._multipleSelectProviderEventHandler=g.hitch(this,this._multipleSelectProviderEvent),document.addEventListener("click",this._multipleSelectProviderEventHandler,{capture:!0})):this.listSelect.placeAt(this.listContent)},
_resetPromptLabel:function(a){this.promptLabel.innerHTML=this.partObj.interactiveObj.prompt+" "+this.partObj.interactiveObj.hint+(a?this.nls.noFilterValueTip+" ":"")},filterExpr:null,_resetPageControlNewExpr:function(){var a=this.getDropdownFilterExpr();return this.filterExpr!==a?(this.pageControlForQuery.reset(),this.filterExpr=this.pageControlForQuery.cascadeFilterExprs=a,!0):!1},_multipleSelectProviderEvent:function(a){a=a.target||a.srcElement;if(this.cbxPopup&&this.cbxPopup.domNode){if(m.isDescendant(a,
this.cbxPopup.domNode)||m.isDescendant(a,this.checkedBtn))return;"block"===m.getStyle(this.cbxPopup.domNode,"display")&&(this._resetListSelectState(this),this.cbxPopup.hide())}else!m.isDescendant(a,this.checkedBtn)&&this.isPopupLoading&&(this.isLoadDataAdvanced=!0);this.msgDiv&&m.setStyle(this.msgDiv,"display","none")},_checkedBtnEvent:function(){this._showPopup()},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},_isRestSelectList:!1,_resetListSelectState:function(a){"block"===
m.getStyle(a.listSelect.searchKeyInput,"display")&&("multipleDynamic"===this.controlType&&this.listSelect.showAllList(),a.listSelect.listContainer.scrollTop=0,a.listSelect.queryState=!0,a.listSelect.valueInput.set("value",""),this._isRestSelectList=!0)},_createTarget:function(a){this._checkedChanged(1,a);this.cbxPopup&&("uniqueDynamic"===this.controlType||"uniquePredefined"===this.controlType)&&this.cbxPopup.domNode&&(this._resetListSelectState(this),this.cbxPopup.close())},_destoryTarget:function(a){this._checkedChanged(-1,
a)},_checkedChanged:function(a,b){if("multipleDynamic"===this.controlType||"multiplePredefined"===this.controlType&&this.runtime&&"dropdown"===this.selectUI)b&&(a=parseInt(this.checkedNum.innerText,10)+a,this.checkedNum.innerText=0<a?a:0);else if("uniqueDynamic"===this.controlType||"uniquePredefined"===this.controlType&&this.runtime&&"dropdown"===this.selectUI)"uniqueDynamic"===this.controlType&&(b===this.emptyStr?m.addClass(this.checkedNameDiv,"checkedEmptyNameDiv"):m.removeClass(this.checkedNameDiv,
"checkedEmptyNameDiv")),a=b?b:this._getCheckedNameDivText(),this._setCheckedNameDivText(a);this.listSelect.set("displayedValue","12345678");this.emit("change")},_clearCheckedTxt:function(){this.runtime&&"dropdown"===this.selectUI&&("multipleDynamic"===this.controlType||"multiplePredefined"===this.controlType?this.checkedNum.textContent?this.checkedNum.textContent=0:this.checkedNum.innerText=0:"uniqueDynamic"!==this.controlType&&"uniquePredefined"!==this.controlType||this._setCheckedNameDivText(""),
this.valueList=[],this.listSelect.checkedList=[],this.listSelect.checkedLabelList=[],this.listSelect.valueInput.set("value",""),"multipleDynamic"===this.controlType&&this.listSelect.showAllList());this.listSelect.set("displayedValue","12345678");this.emit("change")},_layerDataChangedCallback:function(){this.layerDataChanged&&(this.pageControlForQuery.reset(),this.listSelect.ifFristPage=!0,this.layerDataChanged=!1)},_addNextPage:function(){this.listSelect&&(this._showLoadingIcon(),this._layerDataChangedCallback(),
this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage).then(g.hitch(this,function(a){this.listSelect.isCacheFinish=this.pageControlForQuery._isUniqueValueCacheFinish;this.listSelect.ifFristPage&&this._checkIfNoData(a)||(this.listSelect.setCBXData(a,!0,this.listSelect.ifFristPage),this._hideLoadingIcon())}),g.hitch(this,function(a){console.log(a);this.listSelect.queryState=!1;this._hideLoadingIcon()})))},_searchKey:function(a){this.listSelect&&(this._showLoadingIcon(),this._layerDataChangedCallback(),
this.pageControlForQuery._searchKey(a).then(g.hitch(this,function(a){this.listSelect.setCBXContentBySearch(a);this._resetPopupStyles(!a.length);this._hideLoadingIcon()}),g.hitch(this,function(a){console.log(a);this._hideLoadingIcon()})))},_searchKeyLocal:function(a,b){if(this.listSelect){"uniqueDynamic"===this.controlType&&this._isRestSelectList&&(this.listSelect.keyQueryMode=!1,this._isRestSelectList=this.listSelect.cacheQueryMode=!1);this._showLoadingIcon();var c=this.pageControlForQuery._searchKeyLocal(a);
""===a&&0===c.length?(this.layerDataChanged=!0,this._layerDataChangedCallback(),this._addNextPage()):this.listSelect.setCBXContentBySearch(c,b);this._resetPopupStyles(!0);this._hideLoadingIcon()}},queryByPage:function(){var a=this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage);a.then(g.hitch(this,function(b){a.resolve(b)}),g.hitch(this,function(b){console.log(b);a.reject(b)}))},getCheckedList:function(a){this.listSelect.checkedList=[];this.listSelect.checkedLabelList=[];u.forEach(a,
g.hitch(this,function(a){var b;g.isObject(a)?a.isChecked&&(b=a.value):b=a;if(b||0===b)b=this.isNumberField?parseFloat(b):b,this.listSelect.checkedList.push(b)}))},getCheckedStrsList:function(a){var b=[];u.forEach(a,g.hitch(this,function(a){var c;g.isObject(a)?a.isChecked&&(c=a[this.disPlayLabel]):c=a;(c||0===c)&&b.push(c)}));return b},showContent:function(a){var b=new p;this.getCheckedList(this.valueList);this.listSelect.codedValues=!1;this.listSelect.disPlayLabel="value";var c;if("multiplePredefined"===
this.controlType||"uniquePredefined"===this.controlType)return this.runtime&&(this.listSelect.disPlayLabel="alias"),(c=this._checkIfNoData(this.valueList))||this.listSelect.setCBXData(this.valueList,!0,a),this._hideLoadingIcon(),b.resolve(c),b;if(this.staticValues)return c=this._setValueForStaticValues(this.staticValues),b.resolve(c),b;if(this.codedValues)if(this.filterCodedValue)this.listSelect.codedValues=!0;else return c=this._setValueForStaticValues(this.codedValues),b.resolve(c),b;this._showLoadingIcon();
if("multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType)this._layerDataChangedCallback(),this.pageControlForQuery.queryByPage(a).then(g.hitch(this,function(e){this.listSelect.isCacheFinish=this.pageControlForQuery._isUniqueValueCacheFinish;e=this._handleCodedValue(e);(c=this._checkIfNoData(e))||this.listSelect.setCBXData(e,!0,a);this._hideLoadingIcon();b.resolve(c)}),g.hitch(this,function(a){console.log(a);this._hideLoadingIcon();b.reject(a)}));return b},_handleCodedValue:function(a){this.listSelect.disPlayLabel=
"label";if(!this.codedValues)return this.listSelect._updateCheckedLabelListFromCheckedList(),a;this.pageControlForQuery._codedvalueCache=a;"uniqueDynamic"===this.controlType&&this._setCheckedName(this.listSelect.checkedList?this.listSelect.checkedList[0]:"",a);this.listSelect._updateCheckedLabelList(this.codedValues);return a},_showDropdown:function(a){var b=m.position(a.target),c;c=this.isInFilterSet?this.domNode.parentNode.parentNode.parentNode:this.domNode.parentNode;var e=m.position(c);if("none"!==
m.getStyle(this.listContentPopup,"display"))m.setStyle(this.listContentPopup,"display","none");else{u.forEach(f(".value-type-popup",c),function(a){m.setStyle(a,"display","none")},this);m.place(this.listContentPopup,c);var g;g=m.hasClass(f(".desktop-add-section",c.parentNode)[0],"hidden")?-5:30;g=b.y-e.y-c.parentNode.scrollTop+g;g+170>c.parentNode.scrollHeight&&(g=c.parentNode.scrollHeight-170-40);window.isRTL?b=b.x-e.x+20:(b=b.x-e.x-100-90,b+150>c.clientWidth&&(b=c.clientWidth-150));m.setStyle(this.listContentPopup,
{display:"block",left:b+"px",top:g+"px"});a.stopPropagation()}},_calculatePopup:function(){var a=m.position(this.domNode.parentNode),b=m.position(document.body).h,c=a.y+30;b-c<this._cbxHeight&&(c=a.y-this._cbxHeight);return{left:a.x,top:c}},_cbxWidth:210,_cbxHeight:362,popupIsNoData:!1,isPopupLoading:!1,isLoadDataAdvanced:!1,_showPopup:function(){if(!this.isPopupLoading)if(this.cbxPopup&&this.cbxPopup.domNode&&"block"===m.getStyle(this.cbxPopup.domNode,"display"))this._resetListSelectState(this),
this.cbxPopup.hide();else{var a=this._resetPageControlNewExpr();a&&this.cbxPopup&&(this.cbxPopup.close(),this._clearCheckedTxt());var b=this._calculatePopup();this._cbxWidth=m.getStyle(this.checkedBtn,"width");if(!a&&this.cbxPopup&&this.cbxPopup.domNode&&!this.layerDataChanged)this.popupIsNoData?this._checkIfNoData([]):(this.cbxPopup.show(),this._resetPopupStyles(),this.listSelect.valueInput&&"block"===m.getStyle(this.listSelect.searchKeyInput,"display")?this.listSelect.valueInput.focus():this.listSelect.listContent.focus(),
this.listSelect.queryState=!1);else{this.isPopupLoading=!0;this.isLoadDataAdvanced||this._showDataQueryingIcon();var c=this.showContent(!0);c.then(g.hitch(this,function(a){this.isPopupLoading=!1;this._hideDataQueryingIcon();this.popupIsNoData=a;a||(this.cbxPopup=new C({width:this._cbxWidth,height:this._cbxHeight,content:this.listSelect.domNode,enableMoveable:!1,hasTitle:!1,hasOverlay:!1,contentHasNoMargin:!0,moveToCenter:!1,customPosition:{left:b.left,top:b.top},hiddenAfterInit:this.isLoadDataAdvanced,
useFocusLogic:!1,onClose:g.hitch(this,function(){this.cbxPopup.hide();return!1}),buttons:[]}),this.cbxPopup.setDomNodeStyls({"border-radius":0,border:"1px solid #999"}),this.cbxPopup.on("popupHasInitedSuccessfully",g.hitch(this,function(a){this._resetPopupStyles(!1,!0);a||(this.listSelect.valueInput&&"block"===m.getStyle(this.listSelect.searchKeyInput,"display")?this.listSelect.valueInput.focus():this.listSelect.listContent.focus())})));this.isLoadDataAdvanced&&(this.isLoadDataAdvanced=!1)}),g.hitch(this,
function(a){this.isPopupLoading=!1;console.log(a);c.reject(a)}))}}},_itemContainerH:300,_resetPopupStyles:function(a,b){var c=this._itemContainerH,e=m.getStyle(this.listSelect.listContent,"height");0===e&&this.cbxPopup&&this.cbxPopup.domNode&&"none"===m.getStyle(this.cbxPopup.domNode,"display")&&(e=this.popupInitHeight);b&&(this.popupInitHeight=e);!a||this.listSelect.codedValues||this.pageControlForQuery._isUniqueValueCacheFinish||(e+=25);this.pageControlForQuery._isUniqueValueCacheFinish&&"block"===
m.getStyle(this.listSelect.noDataTips,"display")&&(e+=30);c=e<c?e:c;m.setStyle(this.listSelect.listContainer,"height",c+"px");m.setStyle(this.listSelect.selectedContainer,"height",c+30+"px");"multipleDynamic"===this.controlType?c=c+30+30:"uniqueDynamic"===this.controlType&&(c+=30);this._cbxHeight=c+10;a=this._calculatePopup();this._cbxWidth=m.getStyle(this.checkedBtn,"width");this.cbxPopup.setCustomPosition(a.left,a.top,this._cbxWidth,this._cbxHeight);this._resetItemWidth()},_resetItemWidth:function(){var a=
this._cbxWidth-20;"uniqueDynamic"===this.controlType||this.runtime&&"uniquePredefined"===this.controlType&&"dropdown"===this.selectUI||!this.runtime&&("multiplePredefined"===this.controlType||"uniquePredefined"===this.controlType)||(a=!this.runtime||"dropdown"===this.selectUI||"uniquePredefined"!==this.controlType&&"multiplePredefined"!==this.controlType?a-30:a-15);window.isRTL&&(a-=3);this.listSelect._itemLabelW=a;f(".item .label",this.listSelect.listContent).style({"max-width":a+"px"})},_setValueForStaticValues:function(a){this.listSelect.codedValues=
!0;this.listSelect._updateCheckedLabelList(this.codedValues);if(a){this.pageControlForQuery._codedvalueCache=a;var b=this._checkIfNoData(a);b||(this.listSelect.disPlayLabel="label",this.listSelect.setCBXData(a,!0,!0));return b}return!1},_checkIfNoData:function(a){if(this.runtime&&"dropdown"===this.selectUI){if(a&&0<a.length)return this._resetPromptLabel(!1),!1;this.msgDiv?m.setStyle(this.msgDiv,"display","block"):(this.msgDiv=document.createElement("div"),m.addClass(this.msgDiv,"jimu-filter-list-value-provider-tip-container"),
this.msgDiv.innerHTML=this.noDataTips,this.checkedBtn.parentNode.appendChild(this.msgDiv));this._resetPromptLabel(!0);return!0}this._resetPromptLabel(!1);return!1},getDijits:function(){return[this.listSelect]},_setCheckedName:function(a,b){var c=a;if(b=b?b:this.codedValues){for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.value===a){c=g.label;e=!0;break}}e||(c=this.emptyStr,this.valueList=[],this.listSelect&&(this.listSelect.checkedList=[],this.listSelect.checkedLabelList=[]))}else void 0===a?(c=
this.emptyStr,m.addClass(this.checkedNameDiv,"checkedEmptyNameDiv")):m.removeClass(this.checkedNameDiv,"checkedEmptyNameDiv");this._setCheckedNameDivText(c)},setValueObject:function(a){a.value=a.value||0===a.value?a.value:[];this.valueList=a.value;this.enableEmpty=a.enableEmpty;this.listSelect.enableEmpty=a.enableEmpty;if("multipleDynamic"===this.controlType)this.checkedNum.innerText=this.valueList.length,this.isLoadDataAdvanced&&this._checkedBtnEvent();else if("uniqueDynamic"===this.controlType)a=
this.valueList,g.isArray(a)&&0===a.length&&(a=void 0),this._setCheckedName(a),this.valueList=[this.valueList],this.isLoadDataAdvanced&&this._checkedBtnEvent();else{this.emptyStr=a.emptyLabel?a.emptyLabel:this.emptyStr;this.listSelect.emptyStr=this.emptyStr;if(this.runtime&&"dropdown"===this.selectUI){var b=[];"value"===this.disPlayLabel?(this.getCheckedList(this.valueList),b=this.listSelect.checkedList):b=this.getCheckedStrsList(this.valueList);"uniquePredefined"===this.controlType?0<this.listSelect.checkedList.length?
this._setCheckedNameDivText(b[0]):this._setCheckedNameDivText(a.enableEmpty?this.emptyStr:""):this.checkedNum.innerText=b.length}this.showContent(!0);setTimeout(g.hitch(this,function(){this._cbxWidth=m.getStyle(this.listSelect.listContent,"width");this._resetItemWidth()}),50)}},_getCheckedNameDivText:function(){return this.checkedNameDiv.textContent||this.checkedNameDiv.innerText||""},_setCheckedNameDivText:function(a){this.isNumberField&&"number"===typeof a&&(a=w._getValues(this.layerDefinition,
this.fieldPopupInfo,this.fieldName,[a])[0].label);this.checkedNameDiv.textContent?this.checkedNameDiv.textContent=a:this.checkedNameDiv.innerText=a},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var a=null,a="multipleDynamic"===this.controlType||"multiplePredefined"===this.controlType?[]:"string"===this.shortType?"":null;return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},getValueObject:function(){if(this.isValidValue()){var a;
a="multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType?this.listSelect.getListCheckedValues():this.listSelect.getListValues();"uniqueDynamic"===this.controlType&&(a=g.isArray(a)?a[0]:a);!this.runtime&&this.cbxPopup&&this.cbxPopup.domNode&&(this.cbxPopup.onClose=g.hitch(this,function(){return!0}),this.cbxPopup.close());return{isValid:!0,type:this.partObj.valueObj.type,value:a}}return null},setRequired:function(a){this.listSelect.set("required",a)},_showDataQueryingIcon:function(){this._validatingNode||
(this._validatingNode=m.create("div",{"class":"jimu-circle-loading"},this.checkedBtn));m.setStyle(this._validatingNode,"display","block")},_hideDataQueryingIcon:function(){this._validatingNode&&m.setStyle(this._validatingNode,"display","none")},_showLoadingIcon:function(){this.listSelect&&this.listSelect.listContainer&&m.addClass(this.listSelect.listContainer,"jimu-circle-loading")},_hideLoadingIcon:function(){this.listSelect&&this.listSelect.listContainer&&m.removeClass(this.listSelect.listContainer,
"jimu-circle-loading")},destroy:function(){this._multipleSelectProviderEventHandler&&document.removeEventListener("click",this._multipleSelectProviderEventHandler,{capture:!0});this.inherited(arguments)},destroyProvider:function(){this.listSelect&&this.listSelect.destroy();this.listSelect=null}})})},"jimu/dijit/_filter/AdvancedListValueSelect":function(){define("dojo/_base/lang dojo/Evented dojo/_base/html dojo/_base/declare dijit/_WidgetBase dojo/on dojo/keys dojo/query dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdvancedListValueSelect.html jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return v([n,f,e,g],{templateString:b,selectType:null,dataList:[],checkedList:[],checkedLabelList:[],_itemLabelW:215,ifFristPage:!0,queryState:!0,isCacheFinish:!1,keyQueryMode:!1,cacheQueryMode:!1,emptyStr:"",postMixInProperties:function(){this.inherited(arguments);this.jimuCommonNls=window.jimuNls.common;this.Nls=window.jimuNls.filterBuilder;this.noDataNls=window.apiNls.widgets.FeatureTable.noData},postCreate:function(){this.inherited(arguments);this.inputType="unique"===
this.selectType?"radio":"checkbox";if("multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType)t.addClass(this.listContainer,"items-setting-dropdown-content"),this.searchKeyInput.style.display="block";"uniqueDynamic"===this.controlType&&t.addClass(this.listContainer,"items_content_no_selected_toggle");this.runtime?(t.addClass(this.listContainer,"items-widget-content"),"dropdown"!==this.selectUI&&(t.addClass(this.listContainer,"items-widget-expaned-content"),t.addClass(this.listContent,
"jimu-multiple-items-expanded-list"))):(t.addClass(this.listContainer,"items-setting-popup-content"),this.searchKeyInput.style.display="block");this.runtime||"predefined"!==this.controlType||(t.addClass(this.listContainer,"items-setting-dropdown-content"),t.addClass(this.listContainer,"items_content_no_selected_toggle"),this.searchKeyInput.style.display="block");this._addCBXClickEvent();("dropdown"===this.selectUI||"predefined"===this.controlType&&!this.runtime)&&this._addCBXHoverEvent();this.disPlayLabel=
"value";!this.runtime||"multiplePredefined"!==this.controlType&&"uniquePredefined"!==this.controlType||(this.disPlayLabel="alias");"multipleDynamic"===this.controlType&&(this.selectedToggleDiv.style.display="block",this.selectedToggle=k(".showAllIcon",this.selectedToggleDiv)[0],this.own(m(this.selectedToggleDiv,"click",p.hitch(this,"_toggleFilter"))),this.own(m(this.selectedToggleDiv,"keydown",p.hitch(this,function(a){a.keyCode===u.ENTER&&this._toggleFilter(a)}))),this._addSelectedContainerEvent());
this._addKeyDownEvent()},_addKeyDownEvent:function(){this.own(m(this.multipleSelect,"keydown",p.hitch(this,function(a){var b=a.which||a.keyCode,c=a.target;if(b===u.ESCAPE||"INPUT"===c.tagName&&a.shiftKey&&b===u.TAB||("multipleDynamic"===this.controlType&&t.hasClass(c,"clearAllSelectedIcon")||"multipleDynamic"!==this.controlType&&t.hasClass(c,"item"))&&!a.shiftKey&&b===u.TAB)a.preventDefault(),this.currentHoverItem&&(t.removeClass(this.currentHoverItem,"active"),this.currentHoverItem=null),this.emit("advancedListValueSelect_itemsConfirmed")})));
this.own(m(this.listContent,"focus",p.hitch(this,function(){a.isInNavMode()&&(this.currentItem=(this.currentItem=this.getCurrentItem())?this.currentItem:this._getCheckInputItems()[0],this.currentHoverItem=this.currentItem.parentNode,this.currentHoverItem.focus(),t.addClass(this.currentHoverItem,"active"),setTimeout(p.hitch(this,function(){t.addClass(this.currentHoverItem,"active")}),50))})));this.own(m(this.listContent,"blur",p.hitch(this,function(){a.isInNavMode()&&this.currentHoverItem&&t.removeClass(this.currentHoverItem,
"active")})));this.own(m(this.showAllIconBtn,"keydown",p.hitch(this,function(a){a.shiftKey&&a.keyCode===u.TAB&&(a.preventDefault(),"block"===t.getStyle(this.selectedContainer,"display")?this.selectedListContent.focus():this.listContent.focus())})));this.own(m(this.listContent,"keydown",p.hitch(this,function(b){if(a.isInNavMode()){var c=b.which||b.keyCode;-1<[u.SPACE,u.UP_ARROW,u.DOWN_ARROW].indexOf(c)&&b.preventDefault();if(c===u.TAB&&t.hasClass(b.target,"item"))b.preventDefault(),this.currentHoverItem&&
t.removeClass(this.currentHoverItem,"active"),b.shiftKey?"block"===this.searchKeyInput.style.display?this.valueInput.focus():this.emit("advancedListValueSelect_itemsConfirmed"):"multipleDynamic"===this.controlType&&this.showAllIconBtn.focus();else if(c===u.SPACE||c===u.ENTER)b=k(".checkInput",this.currentHoverItem)[0],c=k(".label",this.currentHoverItem)[0],this._setCBXChecked(b,this._getNodeText(c)),"radio"===this.inputType&&(t.removeClass(this.currentHoverItem,"active"),this.currentHoverItem=null,
this.emit("advancedListValueSelect_itemsConfirmed"));else if(c===u.UP_ARROW||c===u.DOWN_ARROW){b=(b=c===u.UP_ARROW?this.currentHoverItem.previousSibling:this.currentHoverItem.nextSibling)?b:this.currentHoverItem;if(this.listContainer.scrollHeight>this.listContainer.clientHeight){var c=this.listContainer.clientHeight+this.listContainer.scrollTop,e=b.offsetTop+b.offsetHeight,e=e-30;e>c?this.listContainer.scrollTop=e-this.listContainer.clientHeight:b.offsetTop<this.listContainer.scrollTop+30&&(this.listContainer.scrollTop=
b.offsetTop-30)}t.removeClass(this.currentHoverItem,"active");this.currentHoverItem=b;t.addClass(this.currentHoverItem,"active");this.currentHoverItem.focus()}}})));this.own(m(this.selectedListContent,"focus",p.hitch(this,function(){if(a.isInNavMode()){var b=k(".item",this.selectedListContent);b.length&&(this.currentHoverItem=b[0],this.currentHoverItem.focus(),t.addClass(this.currentHoverItem,"active"),setTimeout(p.hitch(this,function(){t.addClass(this.currentHoverItem,"active")}),50))}})));this.own(m(this.selectedListContent,
"blur",p.hitch(this,function(){a.isInNavMode()&&this.currentHoverItem&&t.removeClass(this.currentHoverItem,"active")})));this.own(m(this.selectedContainer,"keydown",p.hitch(this,function(b){if(a.isInNavMode()){var c=b.which||b.keyCode;if(c===u.TAB)b.preventDefault(),this.currentHoverItem&&t.removeClass(this.currentHoverItem,"active"),this.showAllIconBtn.focus();else if(0!==k(".item",this.selectedListContent).length)if(-1<[u.SPACE,u.UP_ARROW,u.DOWN_ARROW].indexOf(c)&&b.preventDefault(),c===u.SPACE||
c===u.ENTER)b=k(".checkInput",this.currentHoverItem)[0],c=k(".label",this.currentHoverItem)[0],this._setCBXSelectedChecked(b,this._getNodeText(c));else if(c===u.UP_ARROW||c===u.DOWN_ARROW)b=(b=c===u.UP_ARROW?this.currentHoverItem.previousSibling:this.currentHoverItem.nextSibling)?b:this.currentHoverItem,this.selectedContainer.scrollHeight>this.selectedContainer.clientHeight&&(c=b.offsetTop+b.offsetHeight,c>this.selectedContainer.clientHeight+this.selectedContainer.scrollTop?this.selectedContainer.scrollTop=
c-this.selectedContainer.clientHeight:b.offsetTop<this.selectedContainer.scrollTop&&(this.selectedContainer.scrollTop=b.offsetTop)),t.removeClass(this.currentHoverItem,"active"),this.currentHoverItem=b,t.addClass(this.currentHoverItem,"active"),this.currentHoverItem.focus()}})))},_toggleFilter:function(a){var b=a.target;t.hasClass(b,"clearAllSelectedIcon")?(this._clearAllSelected(),this.currentHoverItem=this.currentItem=null):t.hasClass(b,"iconHover")||t.hasClass(b,"selectedToggleDiv")||(t.hasClass(b,
"showAllIcon")?(this.selectedContainer.style.display="none",this.listContent.focus()):(this._initSelectedContainerItems(),this.selectedContainer.style.display="block",this.selectedListContent.focus()),t.removeClass(this.selectedToggle,"iconHover"),this.selectedToggle=b,t.addClass(this.selectedToggle,"iconHover"),a.stopPropagation())},showAllList:function(){t.hasClass(this.selectedToggle,"showSelectedIcon")&&t.hasClass(this.selectedToggle,"iconHover")&&(t.removeClass(this.selectedToggle,"iconHover"),
this.selectedToggle=k(".showAllIcon",this.selectedToggleDiv)[0],t.addClass(this.selectedToggle,"iconHover"),t.setStyle(this.selectedContainer,"display","none"))},_clearAllSelected:function(){var a;a=t.hasClass(this.selectedToggle,"showAllIcon")?this.listContainer:this.selectedListContent;a=k(".item .checkInput.checked",a);for(var b=0;b<a.length;b++)a[b].click()},_initSelectedContainerItems:function(){for(var a=this.selectedListContent.innerHTML="",b=this.runtime?" labelRuntime":"",e=0;e<this.checkedList.length;e++)var f=
this.checkedList[e],g="value"===this.disPlayLabel?f:this.checkedLabelList[e],f='data\x3d"'+(this.isNumberField?f:encodeURIComponent(f))+'"',a=a+('\x3cdiv role\x3d"option" class\x3d"item" tabindex\x3d"-1" aria-selected\x3d"true" aria-checked\x3d"true"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+' checked" '+f+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label jimu-ellipsis-Blanks'+b+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+g+"\x3c/div\x3e\x3c/div\x3e");this.selectedListContent.innerHTML=a},_addSelectedContainerEvent:function(){this.own(m(this.selectedListContent,
"click",p.hitch(this,function(a){var b=a.target,c;if(t.hasClass(b,"item"))c=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(t.hasClass(b,"checkInput"))c=b,b=b.nextSibling;else if(t.hasClass(b,"label"))c=b.previousSibling;else{a.stopPropagation();return}this._setCBXSelectedChecked(c,this._getNodeText(b));a.stopPropagation()})))},_setCBXSelectedChecked:function(a,b){var c=b;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)c=decodeURIComponent(t.getAttr(a,"data"));t.hasClass(a,
"checked")?(t.setAttr(a.parentNode,"aria-checked","false"),"radio"!==this.inputType&&(t.removeClass(a,"checked"),this._updateCheckedList("remove",c,b),this.checkCBXItems(),this.emit("advancedListValueSelect_itemUnChecked",b))):(t.setAttr(a.parentNode,"aria-checked","true"),"radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),t.removeClass(this.currentItem,"checked")),t.addClass(a,"checked"),this._updateCheckedList("add",c,b),this.checkCBXItems(),
this.emit("advancedListValueSelect_itemChecked",b))},_getNodeText:function(a){return a.textContent||a.innerText||""},_updateCheckedList:function(a,b,e){b!==this.emptyStr&&(b=this.isNumberField?parseFloat(b):b);if("remove"===a)for(var c in this.checkedList){if(this.checkedList[c]===b||this.isNumberField&&isNaN(this.checkedList[c])&&isNaN(b)){this.checkedList.splice(c,1);this.checkedLabelList.splice(c,1);break}}else"radio"===this.inputType?(this.checkedList=[b],this.checkedLabelList=[e]):(this.checkedList.push(b),
this.checkedLabelList.push(e))},_updateCheckedLabelList:function(a){this.checkedLabelList=[];for(var b=0;b<this.checkedList.length;b++)for(var c=0;c<a.length;c++)this.checkedList[b]===a[c].value&&this.checkedLabelList.push(a[c].label)},_updateCheckedLabelListFromCheckedList:function(){for(var a=0;a<this.checkedList.length;a++)this.checkedLabelList.push(this.checkedList[a]+"")},_createTarget:function(a){a=this._getNodeText(a.target).split(": ")[1];this.emit("advancedListValueSelect_itemChecked",a)},
_deleteCBXItem:function(){},_getCheckInputItems:function(){return k(".item .checkInput",this.listContent)},getListCheckedValuesOrigin:function(){for(var a=[],b=this._getCheckInputItems(),e=0;e<b.length;e++){var f=b[e],g=this._getNodeText(f.nextSibling);t.hasClass(f,"checked")&&a.push(g)}return a},getListCheckedValues:function(){for(var a=[],b=p.clone(this.checkedList),e=0;e<b.length;e++){var f=b[e],f=this.isNumberField?parseFloat(f):f;a.push(f)}return a},getListValues:function(){var a=[],b=this._getCheckInputItems();
if(0===b.length)return this.dataList;for(var e=0;e<b.length;e++){var f=b[e],g=this._getNodeText(f.nextSibling);if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)g=decodeURIComponent(t.getAttr(f,"data"));g=this.isNumberField?parseFloat(g):g;g={value:g,isChecked:!1};t.hasClass(f,"checked")&&(g.isChecked=!0);a.push(g)}return a},getIfValueExist:function(a){for(var b=this._getCheckInputItems(),c=0;c<b.length;c++){var e=this._getNodeText(b[c].nextSibling);if(a===e)return!0}return!1},getCurrentItem:function(){for(var a=
this._getCheckInputItems(),b=0;b<a.length;b++){var e=a[b];if(t.hasClass(e,"checked"))return e}return null},checkCBXItems:function(a){a=a?"":this.valueInput.get("value");this.valueInput.set("value",a);a=k(".item .label",this.listContent);for(var b=0;b<a.length;b++){var c=a[b],e="value"===this.disPlayLabel?this._getNodeText(c):decodeURIComponent(t.getAttr(c.previousSibling,"data")),e=this.isNumberField?parseFloat(e):e;0<=this.checkedList.indexOf(e)||this.isNumberField&&0<=this.checkedList.indexOf(parseFloat(e))?
t.addClass(c.previousSibling,"checked"):t.removeClass(c.previousSibling,"checked")}},reset:function(){this.listContent.innerHTML=""},setCBXData:function(a,b,e,f){f||(this.queryState=!1);a=a?a:[];if(this.listContent){t.setStyle(this.noDataTips,"display","none");var c=0,g="radio"===this.inputType?" labelBig":"",m=this.runtime?" labelRuntime":"";f=this.listContent.innerHTML;if(e){f=this.listContent.innerHTML="";if("uniquePredefined"===this.controlType&&this.enableEmpty||"uniqueDynamic"===this.controlType&&
!this.keyQueryMode)e=f="",this.checkedList[0]===this.emptyStr&&(f=" checked",e=" active",c=1),0===this.checkedList.length&&(f=" checked",this.currentItem=!0,c=1),f='\x3cdiv role\x3d"option" class\x3d"item emptyItem'+e+'" aria-selected\x3d"true" tabindex\x3d"-1" '+(f?'aria-checked\x3d"true"':'aria-checked\x3d"false"')+'\x3e\x3cdiv class\x3d"checkInput '+this.inputType+f+'" '+("data\x3d'"+this.emptyStr+"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+g+" jimu-ellipsis-Blanks"+m+'" style\x3d"max-width:'+
this._itemLabelW+'px"\x3e'+this.emptyStr+"\x3c/div\x3e\x3c/div\x3e";this.listContainer.scrollTop=0}if(0===a.length)return a=this.listContent.innerHTML.replace(/(^\s*)|(\s*$)/g,""),""!==a||this.cacheQueryMode&&!this.isCacheFinish||t.setStyle(this.noDataTips,"display","block"),""===a&&(this.listContent.innerHTML=f),this.listContent;e="";for(var n=0;n<a.length;n++){var p=a[n],q="";if(b)if(this.runtime&&("multiplePredefined"===this.controlType||"uniquePredefined"===this.controlType))p.isChecked&&(q=" checked",
this.currentItem=!0,c++);else if(0<=this.checkedList.indexOf(p.value)||this.isNumberField&&0<=this.checkedList.indexOf(parseFloat(p.value)))q=" checked",this.currentItem=!0,c++;var w="",w=q?'aria-checked\x3d"true"':'aria-checked\x3d"false"',u='data\x3d"'+(this.isNumberField?p.value:encodeURIComponent(p.value))+'"';e+='\x3cdiv class\x3d"item" role\x3d"option" tabindex\x3d"-1" aria-selected\x3d"true" '+w+'\x3e\x3cdiv class\x3d"checkInput '+this.inputType+q+'" '+u+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+
g+" jimu-ellipsis-Blanks"+m+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+p[this.disPlayLabel]+"\x3c/div\x3e\x3c/div\x3e"}a=this.checkedList.length-c;if(this.runtime&&0<a)for(b=0;b<a;b++)this.emit("advancedListValueSelect_itemUnChecked","");this.listContent.innerHTML=f+e;k(".emptyItem",this.listContent)[0]?this.currentHoverItem=(a=k(".checked",this.listContent)[0])?a.parentNode:!0:(this.currentItem=(this.currentItem=this.getCurrentItem())?this.currentItem:this._getCheckInputItems()[0],this.currentHoverItem=
this.currentItem.parentNode);t.addClass(this.currentHoverItem,"active");return this.listContent}},setCBXContentBySearch:function(a,b){0===a.length?this.setCBXData([],!1,!0,b):this.setCBXData(a,!0,!0,b)},_onSearchKeyChange:function(){var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;this.reset();this.cacheQueryMode=this.keyQueryMode=this.ifFristPage=!0;this.emit("advancedListValueSelect_searchKeyLocal",a);this.codedValues||(this.isCacheFinish||t.setStyle(this.loadMoreDataBtn,
"display","block"),0===a.length&&(this.queryState=this.cacheQueryMode=this.keyQueryMode=!1,t.setStyle(this.loadMoreDataBtn,"display","none")))},_loadMoreDataFromServer:function(){this.keyQueryMode=this.ifFristPage=!0;this.cacheQueryMode=!1;this.queryState=!0;t.setStyle(this.loadMoreDataBtn,"display","none");var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;"multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType?this.emit("advancedListValueSelect_searchKey",
a):this.runtime||this.emit("advancedListValueSelect_searchKey",a)},currentHoverItem:null,_addCBXHoverEvent:function(){this.own(m(this.listContent,"mouseover",p.hitch(this,function(b){b=b.target||b.srcElement;b=t.hasClass(b,"item")?b:a.getAncestorDom(b,function(a){return t.hasClass(a,"item")},3);this.currentHoverItem&&t.removeClass(this.currentHoverItem,"active");t.addClass(b,"active");this.currentHoverItem=b})));this.own(m(this.listContent,"mouseout",p.hitch(this,function(){this.currentHoverItem&&
t.removeClass(this.currentHoverItem,"active");this.currentHoverItem=null})))},_addCBXClickEvent:function(){this.own(m(this.valueInput,"change",p.hitch(this,function(){this._onSearchKeyChange()})));this.own(m(this.loadMoreDataBtn,"click",p.hitch(this,function(){this._loadMoreDataFromServer()})));this.own(m(this.listContainer,"scroll",p.hitch(this,this.dropDownScroll)));this.own(m(this.searchKeyInput,"click",p.hitch(this,function(a){a.stopPropagation()})));this.own(m(this.listContainer,"click",p.hitch(this,
function(a){var b=a.target,c;if(t.hasClass(b,"item"))c=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(t.hasClass(b,"checkInput"))c=b,b=b.nextSibling;else if(t.hasClass(b,"label"))c=b.previousSibling;else{a.stopPropagation();return}this._setCBXChecked(c,this._getNodeText(b));a.stopPropagation()})))},scrollDiff:100,dropDownScroll:function(a){this.runtime&&("uniquePredefined"===this.controlType||"multiplePredefined"===this.controlType)||this.cacheQueryMode||this.codedValues||(this.queryState?
this.listContainer.scrollTop=this.containerScrollTop:(a=a.target,a.scrollHeight-a.clientHeight-a.scrollTop<=this.scrollDiff&&!this.queryState&&(this.containerScrollTop=this.listContainer.scrollTop,this.queryState=!0,this.ifFristPage=!1,this.emit("advancedListValueSelect_addNextPage"))))},_setCBXChecked:function(a,b){var c=b;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)c=decodeURIComponent(t.getAttr(a,"data"));t.hasClass(a,"checked")?(t.setAttr(a.parentNode,"aria-checked","false"),"radio"===
this.inputType?this.runtime||"predefined"!==this.controlType?this.emit("advancedListValueSelect_itemChecked",b):this.emit("advancedListValueSelect_itemCheckedForPredefined",c,b):(t.removeClass(a,"checked"),this._updateCheckedList("remove",c,b),this.emit("advancedListValueSelect_itemUnChecked",b))):(t.setAttr(a.parentNode,"aria-checked","true"),"radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),this.currentItem&&(t.removeClass(this.currentItem,
"checked"),t.setAttr(this.currentItem.parentNode,"aria-checked","false"))),t.addClass(a,"checked"),this.currentItem=a,this._updateCheckedList("add",c,b),this.runtime||"predefined"!==this.controlType?this.emit("advancedListValueSelect_itemChecked",b):this.emit("advancedListValueSelect_itemCheckedForPredefined",c,b))},initDoms:function(a,b){this.setCBXData(a,b)},getData:function(){},refreshData:function(){this.checkCBXItems()},validate:function(){var a=this.checkedList.length?"12345678":null;1===this.checkedList.length&&
this.checkedList[0]===this.emptyStr&&(a=null);if(this.isNumberField)for(var b=0;b<this.checkedList.length;b++){var e=this.checkedList[b];if(e!==this.emptyStr&&isNaN(e)){a=null;break}}this.set("DisplayedValue",a);return!0},setRequired:function(a){this.mutiValuesSelect.set("required",a)},destroy:function(){t.destroy(this.domNode);this.inherited(arguments)}})})},"jimu/dijit/_filter/pageControlForQuery":function(){define("dojo/Deferred esri/tasks/query dojo/_base/array dojo/_base/lang dojo/_base/declare jimu/Query jimu/LayerStructure dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./pageControlForQuery.html jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return n([k,f,e],{templateString:b,layerUrl:null,fieldInfo:null,fieldPopupInfo:null,spatialReference:null,layerDefinition:null,isNumberField:!1,showNullValues:!1,_isUniqueValueCacheFinish:!1,_uniqueValueCache:{},_uniqueValueCacheForOtherTypes:{},_codedvalueCache:[],cascadeFilterExprs:"1\x3d1",numbericFieldLength:{esriFieldTypeOID:32,esriFieldTypeSmallInteger:16,esriFieldTypeInteger:32,esriFieldTypeSingle:128,esriFieldTypeDouble:1024},pageIndex:1,pageSize:1E3,postCreate:function(){this.inherited(arguments);
this.spatialReference=u.getInstance().map.spatialReference;this.reset();this.queryType=m.getQueryType(this.layerDefinition);this.isNumberField&&(this.fieldLength=this.numbericFieldLength[this.fieldInfo.type])},reset:function(){this.pageIndex=1;this._isUniqueValueCacheFinish=!1;this._uniqueValueCache={};this._uniqueValueCacheForOtherTypes={};this._codedvalueCache=[]},isKeyQueryLoader:!1,_searchKey:function(a){var b=new p,c=new g,e="",e=this.isNumberField?"CAST("+this.fieldInfo.name+" AS CHAR("+this.fieldLength+
")) LIKE '%"+a+"%'":this.fieldInfo.name+" LIKE '%"+a+"%'";c.where="(("+this.cascadeFilterExprs+") AND ("+e+"))";c.geometry=null;c.outSpatialReference=this.spatialReference;c.outFields=[this.fieldInfo.name];c.returnDistinctValues=!0;c.returnGeometry=!1;c.orderByFields=c.outFields;this.layerLoaderForKey=new m({url:this.layerUrl,query:c,pageSize:this.pageSize});this.isKeyQueryLoader=!0;this._uniqueValueCacheForOtherTypes={};this.queryByPage(!0).then(v.hitch(this,function(a){b.resolve(a)}),v.hitch(this,
function(a){b.reject("reject:"+a)}));return b},_searchKeyLocal:function(a){a=a.toUpperCase();this.isKeyQueryLoader=!1;var b=[],c=this._codedvalueCache,e;if(0<c.length)for(var f=0;f<c.length;f++)e=c[f],e.label&&0<=e.label.toString().toUpperCase().indexOf(a)&&b.push(e);else for(f in c=this._uniqueValueCache,c)for(var g=c[f],k=0;k<g.length;k++){e=g[k];var m=e.label;m&&0<=m.toString().toUpperCase().indexOf(a)&&b.push(e)}return b},queryByPage:function(a){var b=new p;this.layerLoader&&this.layerLoader.query.where!==
this.cascadeFilterExprs&&(this.layerLoader=null,this.isKeyQueryLoader=!1,this.reset());if(!this.layerLoader){var c=new g;c.where=this.cascadeFilterExprs;c.geometry=null;c.outSpatialReference=this.spatialReference;c.outFields=[this.fieldInfo.name];c.returnDistinctValues=!0;c.returnGeometry=!1;c.orderByFields=c.outFields;this.layerLoader=new m({url:this.layerUrl,query:c,pageSize:this.pageSize})}a&&(this.pageIndex=1);a=[];if(this.isKeyQueryLoader){if(this._uniqueValueCacheForOtherTypes[this.pageIndex])return a=
this._resolveValueLabelsFromCache(this._uniqueValueCacheForOtherTypes),b.resolve(a),b;a=this.layerLoaderForKey}else{if(this._uniqueValueCache[this.pageIndex])return a=this._resolveValueLabelsFromCache(this._uniqueValueCache),b.resolve(a),b;a=this.layerLoader}1===this.queryType?a.queryByPage(this.pageIndex).then(v.hitch(this,function(a){if(a){var c=a.features||[];a=c.length;this.showNullValues||(c=this._getNotNullValues(c));c=this._getValueLabelsFromFeatures(c);this.isKeyQueryLoader?(this._uniqueValueCacheForOtherTypes[this.pageIndex-
1]=c,a<this.pageSize&&(this._uniqueValueCacheForOtherTypes[this.pageIndex]=[])):(this._uniqueValueCache[this.pageIndex-1]=c,a<this.pageSize&&(this._uniqueValueCache[this.pageIndex]=[],this._isUniqueValueCacheFinish=!0));0===c.length&&this.pageIndex--;b.resolve(c)}else b.reject("Can't get features from current layer")}),v.hitch(this,function(a){b.reject(a)})):a.getAllFeatures().then(v.hitch(this,function(a){if(a){var c=a.features||[];this.showNullValues||(c=this._getNotNullValues(c));a=0<c.length?
!0:!1;c=this._getDistinctValues(c);c=this._getValueLabelsFromFeatures(c);c=this.isKeyQueryLoader?this._getAndStoreValueLabelsForOtherTypes(c,this._uniqueValueCacheForOtherTypes):this._getAndStoreValueLabelsForOtherTypes(c,this._uniqueValueCache);this._isUniqueValueCacheFinish=!0;b.resolve(a?c:[])}else b.reject("Can't get features from current layer")}),v.hitch(this,function(a){b.reject(a)}));this.pageIndex++;return b},_resolveValueLabelsFromCache:function(a){a=a[this.pageIndex];0!==a.length&&this.pageIndex++;
return a},_getAndStoreValueLabelsForOtherTypes:function(a,b){for(var c=0;c<a.length;c+=this.pageSize)b[parseInt(c/this.pageSize,10)+1]=a.slice(c,c+this.pageSize);for(var e in b)a=parseInt(e,10)+1,b[a]||(b[a]=[]);return b[1]},_getDistinctValues:function(a){var b={},c=[],e;for(e in a){var f=a[e],g=f.attributes[this.fieldInfo.name];b[g]||(b[g]=!0,c.push(f))}return c},_getNotNullValues:function(a){return a=t.filter(a,v.hitch(this,function(a){a=a.attributes[this.fieldInfo.name];return"\x3cNull\x3e"!==
a&&null!==a}))},_getValueLabelsFromFeatures:function(b){var c=this.fieldInfo.name;b=t.map(b,function(a){return a.attributes[c]});return a._getValues(this.layerDefinition,this.fieldPopupInfo,c,b)}})})},"jimu/LayerStructure":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on dojo/Evented ./LayerInfos/LayerInfos".split(" "),function(p,g,t,v,n,m){var u=p([n],{declaredClass:"jimu.LayerStructure",map:null,_layerInfos:null,_eventHandles:null,constructor:function(f){this._layerInfos=
f;this.map=this._layerInfos.map;this._eventHandles=[];this._bindEvents()},getLayerNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfos.getLayerInfoArray())},getTableNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfos.getTableInfoArray())},getBasemapLayerNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfos.getBasemapLayerInfoArray())},getWebmapLayerNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfos.getLayerInfoArrayOfWebmap())},
getWebmapTableNodes:function(){return this._getNodesArrayFromInfosArray(this._layerInfos.getTableInfoArrayOfWebmap())},addTable:function(f){var e=null;if(f=this._layerInfos.addTable(f))e=f._adaptor;return e},removeTable:function(f){(f=this.getNodeById(f))&&this._layerInfos.removeTable(f._layerInfo)},_traversal:function(f,e){for(var b=0;b<e.length;b++)if(e[b].traversal(f))return!0;return!1},traversal:function(f){return this._traversal(f,this.getLayerNodes().concat(this.getBasemapLayerNodes().concat(this.getTableNodes())))},
traversalWithNodes:function(f,e){return this._traversal(f,e)},getNodeById:function(f){var e=null;this.traversal(function(b){if(b.id===f)return e=b,!0});return e},getBasemapLayerObjects:function(){return this._layerInfos.getBasemapLayers()},restoreState:function(f){this._layerInfos.restoreState(f)},destroy:function(){g.forEach(this._eventHandles,function(f){f.remove()});this.inherited(arguments)},_getNodesArrayFromInfosArray:function(f){var e=[];g.forEach(f,function(b){e.push(b._adaptor)},this);return e},
_emitEvent:function(){try{this.emit.apply(this,arguments)}catch(f){console.warn(f)}},_bindEvents:function(){var f;f=v(this._layerInfos,"layerInfosChanged",t.hitch(this,this._onLayerNodesStructureChanged));this._eventHandles.push(f);f=v(this._layerInfos,"basemapLayerInfosChanged",t.hitch(this,this._onLayerNodesStructureChanged));this._eventHandles.push(f);f=v(this._layerInfos,"tableInfosChanged",t.hitch(this,this._onTableNdoesStructureChanged));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosReorder",
t.hitch(this,this._onLayerReordered));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosIsShowInMapChanged",t.hitch(this,this._onVisibilityChanged));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosIsVisibleChanged",t.hitch(this,this._onToggleChanged));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosFilterChanged",t.hitch(this,this._onFilterChanged));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosRendererChanged",t.hitch(this,this._onRendererChanged));this._eventHandles.push(f);
f=v(this._layerInfos,"layerInfosOpacityChanged",t.hitch(this,this._onOpacityChanged));this._eventHandles.push(f);f=v(this._layerInfos,"layerInfosTimeExtentChanged",t.hitch(this,this._onTimeExtentChanged));this._eventHandles.push(f)},_onLayerNodesStructureChanged:function(f,e,b){this._emitEvent(u.EVENT_STRUCTURE_CHANGE,{type:e,layerNodes:[b._adaptor],rootLayerNodes:[f._adaptor]})},_onTableNdoesStructureChanged:function(f,e){f=this._getNodesArrayFromInfosArray(f);this._emitEvent(u.EVENT_STRUCTURE_CHANGE,
{type:e,layerNodes:f,rootLayerNodes:f})},_onLayerReordered:function(f,e){f=[f._adaptor];this._emitEvent(u.EVENT_STRUCTURE_CHANGE,{type:e,layerNodes:f,rootLayerNodes:f})},_onVisibilityChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};this._emitEvent(u.EVENT_VISIBILITY_CHANGE,f)},_onToggleChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};this._emitEvent(u.EVENT_TOOGLE_CHANGE,f)},_onFilterChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};
this._emitEvent(u.EVENT_FILTER_CHANGE,f)},_onRendererChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};this._emitEvent(u.EVENT_RENDERER_CHANGE,f)},_onOpacityChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};this._emitEvent(u.EVENT_OPACITY_CHANGE,f)},_onTimeExtentChanged:function(f){f={layerNodes:this._getNodesArrayFromInfosArray(f)};this._emitEvent(u.EVENT_TIME_EXTENT_CHANGE,f)}}),k=null;u.getInstance=function(){k&&k._layerInfos._objectId===m.getInstanceSync()._objectId||
(k&&k.destroy(),k=new u(m.getInstanceSync()));return k};u.createInstance=function(f){return new u(m.createInstance(f))};t.mixin(u,{STRUCTURE_CHANGE_ADD:m.ADDED,STRUCTURE_CHANGE_REMOVE:m.REMOVED,STRUCTURE_CHANGE_SUBNODE_ADD:m.SUBLAYER_ADDED,STRUCTURE_CHANGE_SUBNODE_REMOVE:m.SUBLAYER_REMOVED,STRUCTURE_CHANGE_NODE_UPDATE:m.UPDATED,STRUCTURE_CHANGE_REORDER:m.REORDERED,EVENT_STRUCTURE_CHANGE:"structure-change",EVENT_TOOGLE_CHANGE:"toggle-change",EVENT_VISIBILITY_CHANGE:"visibility-change",EVENT_FILTER_CHANGE:"filter-change",
EVENT_RENDERER_CHANGE:"renderer-change",EVENT_OPACITY_CHANGE:"opacity-change",EVENT_TIME_EXTENT_CHANGE:"time-extent-change"});return u})},"jimu/dijit/_filter/PredefinedValueProvider":function(){define("dojo/_base/html dojo/_base/declare dojo/text!./PredefinedValueProvider.html dojo/_base/lang dojo/on jimu/dijit/Popup ./PredefinedValuePopup ./ValueProvider".split(" "),function(p,g,t,v,n,m,u,k){return g([k],{templateString:t,nls:null,url:"",layerDefinition:null,partObj:null,fieldInfo:null,codedValues:null,
staticValues:null,layerInfo:null,popupInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,runtime:!1,providerType:null,valueProvider:null,postCreate:function(){this.inherited(arguments);this.jimuNls=window.jimuNls;p.addClass(this.domNode,"jimu-filter-indexBtn-value-provider");p.addClass(this.valueProviderPopupNode,"value-type-popup");p.setStyle(this.valueProviderPopupNode,"display","none");var f="";"UNIQUE_PREDEFINED_VALUE_PROVIDER"===this.providerType?f=this.nls.predefinedUniqueTips:"MULTIPLE_PREDEFINED_VALUE_PROVIDER"===
this.providerType&&(f=this.nls.predefinedMultipleTips);this.indexBtnTips.title=f;this.indexBtnTips.innerText=f+" ...";this._initProvider();this._bindEvent()},_initProvider:function(){var f={preDefinedTips:this.indexBtnTips,nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:this.partObj,fieldInfo:this.fieldInfo,codedValues:this.codedValues,staticValues:this.staticValues,layerInfo:this.layerInfo,popupInfo:this.popupInfo,operatorInfo:this.operatorInfo,filterCodedValueIfPossible:this.filterCodedValueIfPossible,
runtime:this.runtime,selectUI:this.selectUI,providerType:this.providerType};if("UNIQUE_PREDEFINED_VALUE_PROVIDER"===this.providerType||"MULTIPLE_PREDEFINED_VALUE_PROVIDER"===this.providerType)this.valueProvider=new u(f);this.valueProvider.on("predefinedValuePopup_setApplyBtnState",v.hitch(this,function(e){this.popup&&(e?this.popup.enableButton(0):this.popup.disableButton(0))}))},_bindEvent:function(){this.own(n(this.indexBtn,"click",v.hitch(this,function(){this.valueProvider&&this.destroyProvider();
this._initProvider();this.setValueObject(this.valueObjEnd,this.valueObjEnd.type);this.popup=new m({width:800,height:600,content:this.valueProvider,titleLabel:this.indexBtnTips.title,useFocusLogic:!1,onClose:v.hitch(this,function(){this.getValueObject(!1);this._closeCBXPopup();this.destroyProvider()}),buttons:[{label:this.nls.apply,disable:!0,onClick:v.hitch(this,function(){this.getValueObject(!0)?this.popup.close():alert("please configurate some items")})},{label:this.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],
onClick:v.hitch(this,function(){this.popup.close()})}]});p.addClass(this.popup.domNode,"widget-at-filter-popup");setTimeout(v.hitch(this,function(){this.valueProvider._setApplyState(this.getValueObject(!0));this.valueProvider._setDisplayTypeStyle()}),100)})))},_closeCBXPopup:function(){this.valueProvider.cbxPopup&&this.valueProvider.cbxPopup.domNode&&(this.valueProvider.cbxPopup.onClose=v.hitch(this,function(){return!0}),this.valueProvider.cbxPopup.close())},_saveData:function(){this.valueProvider.saveData()},
reset:function(){},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(f){f&&(this.valueObjEnd=f);this.valueProvider.setValueObject(f,!0)},valueObj:null,getValueObject:function(f){if(f)return this.valueObjEnd=f=this.valueProvider.getValueObject(),f.value.length;delete this.valueObjEnd.valueList;return 0===this.valueObjEnd.value.length?0:this.valueObjEnd},destroyProvider:function(){this.valueProvider&&this.valueProvider.destroyProvider();this.valueProvider=null}})})},
"jimu/dijit/_filter/PredefinedValuePopup":function(){define("dojo/_base/lang dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/declare dojo/Evented dojo/query ./ValueProvider ./EditTable ./AdvancedListValueSelect dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PredefinedValuePopup.html dojo/store/Memory jimu/utils jimu/dijit/Popup jimu/dijit/_filter/pageControlForQuery dojox/form/CheckedMultiSelect".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){return n([k,b,a,m],
{templateString:c,codedValues:null,staticValues:null,showNullValues:!1,cbxPopup:null,pageSize:1E3,pageIndex:1,selectUI:null,postMixInProperties:function(){this.inherited(arguments);this.CommonNls=window.jimuNls.common;this.Nls=window.jimuNls.filterBuilder;this.emptyStr=window.apiNls.widgets.FeatureTable.empty},postCreate:function(){this.inherited(arguments);this.selectUI=this.selectUI?this.selectUI:"dropdown";t.addClass(this.domNode,"jimu-filter-mutcheck-list-value-provider");this.controlType="unique";
"MULTIPLE_PREDEFINED_VALUE_PROVIDER"===this.providerType&&(this.controlType="multiple");this.isNumberField=w.isNumberField(this.fieldInfo.type);this.editTable||(this.editTable=new f({tableType:this.controlType,dataList:[],codedValues:this.codedValues,emptyStr:this.emptyStr,customValue:this.Nls.addValuePlaceHolder,customLabel:this.Nls.addLabelPlaceHolder,isNumberField:this.isNumberField}),this.editTable.placeAt(this.tableContent),this.editTable.on("editTable_openListSelectByName",p.hitch(this,this._showListSelectByTable)),
this.editTable.on("editTable_itemChanged",p.hitch(this,this._editTableItemChanged)),this.editTable.on("editTable_getValLabelsArrayForNumber",p.hitch(this,this._getValLabelsArrayForNumber)));this.supportPaing=!0;this.pageControlForQuery||(this.pageControlForQuery=new C({pageSize:this.pageSize,pageIndex:1,layerUrl:this.url,fieldInfo:this.fieldInfo,queryWhere:"1\x3d1",layerDefinition:this.layerDefinition,fieldPopupInfo:this.fieldPopupInfo,isNumberField:this.isNumberField}));this.listSelect||(this.listSelect=
new e({emptyStr:this.emptyStr,runtime:this.runtime,pageSize:this.pageSize,selectType:"unique",controlType:"predefined",dataList:[],selectedDataList:[],isNumberField:this.isNumberField}),this.listSelect.on("advancedListValueSelect_itemChecked",p.hitch(this,this._createTarget)),this.listSelect.on("advancedListValueSelect_itemUnChecked",p.hitch(this,this._destoryTarget)),this.listSelect.on("advancedListValueSelect_addNextPage",p.hitch(this,this._addNextPage)),this.listSelect.on("advancedListValueSelect_searchKey",
p.hitch(this,this._searchKey)),this.listSelect.on("advancedListValueSelect_searchKeyLocal",p.hitch(this,this._searchKeyLocal)),this.listSelect.on("advancedListValueSelect_itemCheckedForPredefined",p.hitch(this,this._createTargetForPredefined)));this.mutiValuesSelect||(this.mutiValuesSelect=new z({multiple:!0,required:!1,intermediateChanges:!0,style:{width:"100%"}}));this._multipleSelectProviderEventHandler=p.hitch(this,this._multipleSelectProviderEvent);document.addEventListener("click",this._multipleSelectProviderEventHandler);
var a=new x({idProperty:"id",data:[]});this.listSelect.set("store",a)},_multipleSelectProviderEvent:function(a){var b=a.target||a.srcElement,c=t.isDescendant(b,this.editTable.searchBtn);this.editTable&&this.cbxPopup&&this.cbxPopup.domNode?(c?"block"===t.getStyle(this.cbxPopup.domNode,"display")?t.setStyle(this.cbxPopup.domNode,"display","none"):t.setStyle(this.cbxPopup.domNode,"display","block"):t.isDescendant(b,this.cbxPopup.domNode)||this._createTargetForPredefined(),a.stopPropagation()):this._isInSelectPopup(b)||
this.runtime?a.stopPropagation():t.setStyle(this.valuesPopupNode,"display","none")},_initAdvancedListValueSelect:function(){this.pageControlForQuery.pageIndex=1;this.pageControlForQuery.isKeyQueryLoader=!1;this.listSelect=new e({emptyStr:this.emptyStr,runtime:this.runtime,pageSize:this.pageSize,isCacheFinish:this.pageControlForQuery._isUniqueValueCacheFinish,selectType:"unique",controlType:"predefined",dataList:[],selectedDataList:[],isNumberField:this.isNumberField});this.listSelect.on("advancedListValueSelect_itemChecked",
p.hitch(this,this._createTarget));this.listSelect.on("advancedListValueSelect_itemUnChecked",p.hitch(this,this._destoryTarget));this.listSelect.on("advancedListValueSelect_addNextPage",p.hitch(this,this._addNextPage));this.listSelect.on("advancedListValueSelect_searchKey",p.hitch(this,this._searchKey));this.listSelect.on("advancedListValueSelect_searchKeyLocal",p.hitch(this,this._searchKeyLocal));this.listSelect.on("advancedListValueSelect_itemCheckedForPredefined",p.hitch(this,this._createTargetForPredefined))},
_isInSelectPopup:function(a){for(var b="dijitCheckBoxInput dojoxMultiSelectItemLabel dojoxMultiSelectItemBox dojoxMultiSelectItem dojoxCheckedMultiSelectWrapper dojoxCheckedMultiSelect value-type-popup popupOper pageItem".split(" "),c=!1,e=0;e<=b.length;e++)if(t.hasClass(a,b[e])){c=!0;break}return c},_createTarget:function(){this.editTable._createTarget("","","","",!0);this._editTableItemChanged()},_createTargetForPredefined:function(a,b){this.editTable._setNewLabel(a,b);this.cbxPopup.close();this._editTableItemChanged()},
_destoryTarget:function(a){this.editTable._destroyTarget(a);this._editTableItemChanged()},_editTableItemChanged:function(){if(!this.runtime){var a=this.getValueObject();this._setApplyState(a.value.length)}},_setApplyState:function(a){this.emit("predefinedValuePopup_setApplyBtnState",a)},_cbxWidth:245,_cbxHeight:340,isPopupLoading:!1,_showListSelectByTable:function(a){if(!this.isPopupLoading){this._initAdvancedListValueSelect();this.valueList=[a];this.getCheckedList(this.valueList);a=t.position(this.editTable.searchBtn);
var b=a.x-226,c=a.y+30;window.isRTL&&(b=a.x);this.cbxPopup=new q({width:this._cbxWidth,height:this._cbxHeight,content:this.listSelect.domNode,enableMoveable:!1,hasTitle:!1,hasOverlay:!1,contentHasNoMargin:!0,moveToCenter:!1,customPosition:{left:b,top:c},useFocusLogic:!1,buttons:[]});this.cbxPopup.setDomNodeStyls({"border-radius":0,border:"1px solid #999"});this.cbxPopup.on("popupHasInitedSuccessfully",p.hitch(this,function(){var a=t.position(this.editTable.searchBtn),b=a.x-226,c=a.y+30;window.isRTL&&
(b=a.x);this.cbxPopup.setCustomPosition(b,c)}));this.listSelect.valueInput&&this.listSelect.valueInput.focus();this._showLoadingIcon();this.isPopupLoading=!0;this._valueLabels().then(p.hitch(this,function(a){this.isPopupLoading=!1;this._hideLoadingIcon();if(!0!==a){var b=!1;this.valueList&&0!==this.valueList.length&&(b=!0);this.listSelect.setCBXData(a,b)}}))}},_valueLabels:function(){var a=new g;this.listSelect.codedValues=!1;this.listSelect.disPlayLabel="label";if(this.staticValues)return this._setValueForStaticValues(this.staticValues),
a.resolve(!0),a;if(this.codedValues)if(this.filterCodedValue)this.listSelect.codedValues=!0;else return this._setValueForStaticValues(this.codedValues),a.resolve(!0),a;this.pageControlForQuery.queryByPage(!0).then(p.hitch(this,function(b){a.resolve(b)}),p.hitch(this,function(b){console.log(b);this._hideLoadingIcon();a.reject(b)}));return a},_setValueForStaticValues:function(a){this.listSelect.codedValues=!0;a&&(this.pageControlForQuery._codedvalueCache=a,a=0<a.length?a:[],this.listSelect.setCBXData(a,
!0,!0))},_changeDisplayType:function(a){a=a.target||a.srcElement;a=t.hasClass(a,"option")?a:w.getAncestorDom(a,function(a){return t.hasClass(a,"option")},2);t.hasClass(a,"checked")||(t.addClass(a,"checked"),a=u("."+this.selectUI+"Option ",this.displayTypes)[0],t.removeClass(a,"checked"),this.selectUI="expanded"===this.selectUI?"dropdown":"expanded")},_setDisplayTypeStyle:function(){var a=u(".title",this.displayTypes)[0],b=u(".label",this.displayTypes),a=(t.getStyle(this.displayTypes,"width")-t.getStyle(a,
"width")-80)/2,c=t.getStyle(b[0],"width"),c=c<a?c:a,e=t.getStyle(b[1],"width"),e=e<a?e:a;t.setStyle(b[0],"width",c+"px");t.setStyle(b[1],"width",e+"px")},_addNextPage:function(){this.listSelect&&(this._showLoadingIcon(),this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage).then(p.hitch(this,function(a){this.listSelect.isCacheFinish=this.pageControlForQuery._isUniqueValueCacheFinish;this.listSelect.setCBXData(a,!0);this._hideLoadingIcon()}),p.hitch(this,function(a){console.log(a);this._hideLoadingIcon()})))},
_searchKey:function(a){this.listSelect&&(this._showLoadingIcon(),this.pageControlForQuery._searchKey(a).then(p.hitch(this,function(a){this.listSelect.setCBXContentBySearch(a);this._hideLoadingIcon()}),p.hitch(this,function(a){console.log(a);this._hideLoadingIcon()})))},_searchKeyLocal:function(a){this.listSelect&&(this._showLoadingIcon(),a=this.pageControlForQuery._searchKeyLocal(a),this.listSelect.setCBXContentBySearch(a),this._hideLoadingIcon())},_handlerPageValues:function(){},getCheckedList:function(a){this.listSelect.checkedList=
[];this.isNumberField?v.forEach(a,p.hitch(this,function(a){this.listSelect.checkedList.push(parseFloat(a))})):this.listSelect.checkedList=a},_showPopup:function(){var a=this.getValueObject().valueList;this.valueList=null===a?void 0:a;this.getCheckedList(this.valueList);this.cbxPopup?(this.listSelect.checkCBXItems(!1),this.cbxPopup.show()):(this.cbxPopup=new q({width:355,height:596,content:this.listSelect.domNode,titleLabel:this.layerDefinition.name+"("+this.fieldName+")",isResize:!1,useFocusLogic:!1,
onClose:p.hitch(this,function(){this.cbxPopup.hide();return!1}),buttons:[]}),this._showLoadingIcon(),this.pageControlForQuery.queryByPage().then(p.hitch(this,function(a){this._hideLoadingIcon();var b=!1;this.valueList&&0!==this.valueList.length&&(b=!0);this.listSelect.setCBXData(a,b)})))},getDijits:function(){return[this.mutiValuesSelect]},setValueObject:function(a){a.value=a.value?a.value:[];var b=u("."+(a.selectUI?a.selectUI:this.selectUI)+"Option ",this.displayTypes)[0];t.addClass(b,"checked");
b=null;if(this.isNumberField){for(var b=[],c=0;c<a.value.length;c++)b.push(a.value[c].value);b=this._getValLabelsArrayForNumber(!1,b)}this.editTable.emptyLabel=a.emptyLabel;this.editTable.enableEmpty=a.enableEmpty;this.editTable.setListValues(a.value,b)},_getValLabelsArrayForNumber:function(a,b){b=w._getValues(this.layerDefinition,this.fieldPopupInfo,this.fieldName,b);a&&(this.editTable.currentValLabel=b[0].label);return b},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():
this.isEmptyValue()?{isValid:!0,selectUI:this.selectUI,type:this.partObj.valueObj.type,value:[],valueList:[]}:null},getValueObject:function(){if(this.isValidValue()){var a=this.editTable.getListValues(),b={isValid:!0,selectUI:this.selectUI,type:this.partObj.valueObj.type,value:a.list,valueList:a.valueList};"unique"===this.controlType&&(b.emptyLabel=a.emptyLabel,b.enableEmpty=a.enableEmpty);return b}return null},setRequired:function(a){this.mutiValuesSelect.set("required",a)},queryByPage:function(){var a=
this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage);a.then(p.hitch(this,function(b){a.resolve(b)}),p.hitch(this,function(b){console.log(b);a.reject(b)}))},_showLoadingIcon:function(){this.listSelect&&this.listSelect.listContainer&&t.addClass(this.listSelect.listContainer,"jimu-circle-loading")},_hideLoadingIcon:function(){this.listSelect&&this.listSelect.listContainer&&t.removeClass(this.listSelect.listContainer,"jimu-circle-loading")},destroy:function(){this._multipleSelectProviderEventHandler&&
document.removeEventListener("click",this._multipleSelectProviderEventHandler);this.inherited(arguments)},destroyProvider:function(){this.editTable&&this.editTable.destroy();this.listSelect&&this.listSelect.destroy();this.listSelect=null;this.destroy();t.destroy(this.domNode)}})})},"jimu/dijit/_filter/EditTable":function(){define("dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dojo/keys dojo/dom-attr dojo/_base/declare dijit/_WidgetBase dojo/query dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./EditTable.html jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return u([k,a,c,t],{templateString:x,currentItem:null,dataList:[],codedValues:null,isNumberField:!0,tableType:"unique",postMixInProperties:function(){this.inherited(arguments);this.CommonNls=window.jimuNls.common;this.Nls=window.jimuNls.filterBuilder},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-filter-mutcheck-list-value-provider");"unique"===this.tableType?(this.inputType="radio",g.addClass(this.listContent,"radio-items-list-content")):
this.inputType="checkbox"},_onListContentDblClicked:function(a){this.isSearch=!1;var c=a.target||a.srcElement,k=w.getAncestorDom(c,function(a){return g.hasClass(a,"item")},3);if(k&&(g.hasClass(c,"name")||g.hasClass(c,"alias"))&&(!g.hasClass(k,"empty")||!g.hasClass(c,"name"))){this._dijit?(this.editState="active",this.updateInputDivPre=this.updateInputDiv,this._dijitPre=this._dijit):this.editState="negative";a=this._getNodeText(c);var q=decodeURIComponent(g.getAttr(c,"data")),k=g.hasClass(k,"custom");
this.placeHolder=g.hasClass(c,"name")&&!this.codedValues?q:a;k?g.hasClass(c,"alias")&&this.placeHolder!==this.customLabel?this.currentLabel=a:this.currentLabel=NaN:this.currentLabel=this.isNumberField&&g.hasClass(c,"name")&&!this.codedValues?parseFloat(this.placeHolder):this.placeHolder;m.set(c,"innerHTML","");a="";g.hasClass(c,"name")&&(a='\x3cdiv class\x3d"searchBtn"\x3e\x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\x3c/div\x3e');this.updateInputDiv=g.create("div",{"class":"updateInputDiv",
innerHTML:'\x3cdiv class\x3d"inputDiv"\x3e\x3c/div\x3e'+a},c);a=f(".inputDiv",this.updateInputDiv)[0];this.searchBtn=f(".searchBtn",this.updateInputDiv)[0];this.own(v(this.updateInputDiv,"dblclick",p.hitch(this,function(a){a.stopPropagation();a.preventDefault()})));q={required:!1,intermediateChanges:!1,value:this.currentLabel};this.codedValues&&g.hasClass(c,"name")&&(q.disabled=!0);this.isNumberField&&g.hasClass(c,"name")?(q.constraints={pattern:"#####0.##########"},this._dijit=new b(q)):(q.trim=
!0,this._dijit=new e(q));this._dijit.startup();this._dijit.on("keydown",function(a){(a.keyCode||a.which)===n.ENTER&&this._dijit.emit("blur")}.bind(this));this._dijit.on("blur",p.hitch(this,function(){if(this._dijit){var a="Error"!==this._dijit.state?this._dijit.displayedValue:this.currentLabel;this.isNumberField&&g.hasClass(c,"name")&&"Error"===this._dijit.state&&this._dijit.setValue(parseFloat(a));var a=w.sanitizeHTML(a),b=this._dijit.get("value");""!==b&&b?g.hasClass(c,"name")&&(this.placeHolder===
this.customValue||"NaN"===this.placeHolder&&""!==this._dijit.displayedValue)&&(b=w.getAncestorDom(this._dijit.domNode,function(a){return g.hasClass(a,"item")},4),g.removeClass(b,"custom"),this.emit("editTable_itemChanged")):a=this.placeHolder;this.newLabel=a;setTimeout(p.hitch(this,function(){var a,b;if(this.isSearch||"active"===this.editState)"active"===this.editState&&(c=this.updateInputDivPre.parentNode,b=decodeURIComponent(g.getAttr(c,"data")),g.hasClass(c,"name")?this.currentValLabel=""===this._dijitPre.displayedValue?
b===this.customValue?this.customValue:this.isNumberField?this._getLocalNumber(b):b:this.isNumberField?this._getLocalNumber(this._dijitPre.value):this._dijitPre.value:this.currentValLabel=""===this._dijitPre.displayedValue?b===this.customLabel?this.customLabel:b:this._dijitPre.displayedValue,!g.hasClass(c,"name")||"NaN"===this.newLabel||this.newLabel===this.customValue||this._getNodeText(c.nextSibling)!==this.customLabel&&this._dijit.value!==this.customLabel||(g.isDescendant(this.updateInputDiv,c.nextSibling)?
this._dijit.set("value",this.currentValLabel):(a=this.isNumberField?this.currentValLabel:this.newLabel,g.setAttr(c.nextSibling,"data",encodeURIComponent(a)),this._setNodeText(c.nextSibling,a),g.setAttr(c.nextSibling,"title",a))),a=g.hasClass(c,"name")?""===this._dijitPre.displayedValue?b===this.customValue?this.customValue:b:this._dijitPre.value:this.newLabel,g.setAttr(c,"data",encodeURIComponent(a)),a=g.hasClass(c,"name")?this.currentValLabel:this.newLabel,this._setNodeText(c,a),g.setAttr(c,"title",
a),this._dijitPre=this.updateInputDivPre=null,this.editState="negative");else{var c=this.updateInputDiv.parentNode;b=decodeURIComponent(g.getAttr(c,"data"));g.hasClass(c,"name")?this.currentValLabel=""===this._dijit.displayedValue?b===this.customValue?this.customValue:this.isNumberField?this._getLocalNumber(b):b:this.isNumberField?this._getLocalNumber(this._dijit.value):this._dijit.value:this.currentValLabel=""===this._dijit.displayedValue?b===this.customLabel?this.customLabel:b:this._dijit.displayedValue;
g.hasClass(c,"name")&&"NaN"!==this.newLabel&&this.newLabel!==this.customValue&&this._getNodeText(c.nextSibling)===this.customLabel&&(a=this.isNumberField?this.currentValLabel:this.newLabel,g.setAttr(c.nextSibling,"data",encodeURIComponent(a)),this._setNodeText(c.nextSibling,a),g.setAttr(c.nextSibling,"title",a));a=g.hasClass(c,"name")?""===this._dijit.displayedValue?b===this.customValue?this.customValue:b:this._dijit.value:this.newLabel;g.setAttr(c,"data",encodeURIComponent(a));a=g.hasClass(c,"name")?
this.currentValLabel:this.newLabel;this._setNodeText(c,a);g.setAttr(c,"title",a);this._dijit=null;this.isSearch=!1}}),300);this.placeHolder=""}}));g.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(a);f("input",this._dijit.domNode)[1].focus();this.searchBtn&&(this.own(v(this.searchBtn,"click",p.hitch(this,function(a){this.isSearch||(this.isSearch=!0,this.searchTarget=a.target||a.srcElement,this.emit("editTable_openListSelectByName",this.newLabel),a.stopPropagation(),a.preventDefault())}))),
this.codedValues&&this.searchBtn.click())}},_getLocalNumber:function(a){"string"===typeof a&&(a=parseFloat(a));this.emit("editTable_getValLabelsArrayForNumber",!0,[a]);return this.currentValLabel},_setNewLabel:function(a,b){var c;void 0===a&&void 0===b&&(""!==this._dijit.displayedValue?this.codedValues?(b=this._dijit.displayedValue,a=this._getCodeFromCodevalueLabel(b)):(b=a=this._dijit.value,this.isNumberField&&this.newLabel!==this.customValue&&(b=this._getLocalNumber(a))):(a=b=this.customValue,this.updateInputDiv&&
this.updateInputDiv.parentNode&&(c=this.updateInputDiv.parentNode,c=decodeURIComponent(g.getAttr(c,"data")),c!==this.customValue&&(a=this.isNumberField?parseFloat(c):c,b=this.codedValues?this._getLabelFromCodevalue(a):this.isNumberField?this._getLocalNumber(a):a))));this.updateInputDiv&&this.updateInputDiv.parentNode&&(c=this.updateInputDiv.parentNode,b!==this.customValue&&this._getNodeText(c.nextSibling)===this.customLabel&&(g.setAttr(c.nextSibling,"data",encodeURIComponent(b)),this._setNodeText(c.nextSibling,
b),g.setAttr(c.nextSibling,"title",b)),this.codedValues||(a=a?a:decodeURIComponent(g.getAttr(c,"data"))),g.setAttr(c,"data",encodeURIComponent(a)),a=c.parentNode,b!==this.customValue&&g.removeClass(a,"custom"),this._setNodeText(c,b),g.setAttr(c,"title",b));this._dijit=this.updateInputDiv=null},_onListContentClicked:function(a){a=a.target||a.srcElement;var b=w.getAncestorDom(a,function(a){return g.hasClass(a,"item")},3);b&&(g.hasClass(a,"checkboxEmpty")?g.hasClass(a,"checked")?g.removeClass(a,"checked"):
g.addClass(a,"checked"):g.hasClass(a,this.inputType)?("radio"===this.inputType&&!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),g.hasClass(a,"checked")?"radio"!==this.inputType?g.removeClass(a,"checked"):g.hasClass(this.currentItem,"checked")||g.removeClass(a,"checked"):("radio"===this.inputType&&this.currentItem&&g.removeClass(this.currentItem,"checked"),g.addClass(a,"checked"),this.currentItem=a)):g.hasClass(a,"action")&&(g.hasClass(a,"up")?b.previousElementSibling&&g.place(b,b.previousElementSibling,
"before"):g.hasClass(a,"down")?b.nextElementSibling&&g.place(b,b.nextElementSibling,"after"):g.hasClass(a,"delete")&&(g.destroy(b),this.emit("editTable_itemChanged"))))},_getLabelFromCodevalue:function(a){for(var b=a,c=0;c<this.codedValues.length;c++){var e=this.codedValues[c];if(e.value===a){b=e.label;break}}return b},_getCodeFromCodevalueLabel:function(a){for(var b=a,c=0;c<this.codedValues.length;c++){var e=this.codedValues[c];if(e.label===a){b=e.value;break}}return b},_createEmptyTarget:function(a){for(var b=
this.emptyStr,c=this.emptyLabel?this.emptyLabel:b,e=" checked",f=0;f<a.length;f++)if(a[f].isChecked){e="";break}" checked"===e&&(this.currentItem=!0);var f='data\x3d"'+encodeURIComponent(b)+'"',k="",m=this.Nls.emptyValueTips;if(0===a.length||this.enableEmpty)k=" checked";return g.create("div",{"class":"item empty",innerHTML:'\x3cdiv class\x3d"label name jimu-ellipsis" style\x3d"cursor: default;"'+f+"\x3e"+b+'\x3c/div\x3e\x3cdiv class\x3d"label alias jimu-ellipsis-Blanks" data\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"label '+
this.inputType+e+' jimu-ellipsis"\x3e\x3c/div\x3e\x3cdiv class\x3d"label checkbox checkboxEmpty'+k+' jimu-ellipsis jimu-flipx" title\x3d"'+m+'"\x3e\x3c/div\x3e'},this.listContent)},_createTarget:function(a,b,c,e,k){var m="item";k&&(a=b=this.customValue,c=this.customLabel,m="item custom");a=a||0===a?a:"";b=b||"";c=c?c:a;e=e?e:"";var n=a;(this.codedValues||this.isNumberField)&&a!==this.Nls.addValuePlaceHolder&&(n=this.codedValues?this._getLabelFromCodevalue(a):b);b=this.isNumberField?a:encodeURIComponent(a);
e=g.create("div",{"class":m,innerHTML:'\x3cdiv class\x3d"label name jimu-ellipsis-Blanks" '+('data\x3d"'+b+'"')+"\x3e"+n+'\x3c/div\x3e\x3cdiv class\x3d"label alias jimu-ellipsis-Blanks" data\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"label '+this.inputType+e+' jimu-ellipsis"\x3e\x3c/div\x3e\x3cdiv class\x3d"actions jimu-float-trailing"\x3e\x3cdiv class\x3d"delete action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"down action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"up action jimu-float-trailing"\x3e\x3c/div\x3e\x3c/div\x3e'},
this.listContent);k&&(k=f(".name",e)[0],g.setAttr(k,"title",a),g.setAttr(k.nextSibling,"title",c));return e},_destroyTarget:function(a){for(var b=f(".item .name",this.listContent),c=0;c<b.length;c++){var e=b[c];if(m.get(this._dijit.domNode.parentNode,"innerHTML")===a){g.destroy(e.parentNode);break}}},getCurrentItem:function(){for(var a=f(".item .radio",this.listContent),b=0;b<a.length;b++){var c=a[b];if(g.hasClass(c,"checked"))return c}return null},_getEmptyLabel:function(){var a=f(".label.alias",
this.listContent.firstChild)[0],b=this._getNodeText(a);a.children.length&&(b="Error"===this._dijit.state?decodeURIComponent(g.getAttr(a,"data")):this._dijit.value);return b=w.sanitizeHTML(b)},_getEmptyStatus:function(){var a=f(".checkboxEmpty",this.listContent.firstChild)[0];return g.hasClass(a,"checked")?!0:!1},_getNodeText:function(a){return a.textContent||a.innerText||""},_setNodeText:function(a,b){a.innerHTML="\x26nbsp;";a.textContent?a.textContent=b:a.innerText=b},getListValues:function(){this.listItemsArray=
[];this.listValuesArray=[];for(var a=f(".item .name",this.listContent),b="radio"===this.inputType?1:0;b<a.length;b++){var c=a[b],e=w.getAncestorDom(c,function(a){return g.hasClass(a,"item")},3);if(!g.hasClass(e,"custom")){var e=this._getNodeText(c),k=decodeURIComponent(g.getAttr(c,"data"));if(this.isNumberField||this.codedValues)e=k;c.children.length&&(e="Error"===this._dijit.state?k:this._dijit.value,this.codedValues&&(e=this._getCodeFromCodevalueLabel(e),e=void 0!==e?e:k));e=this.isNumberField?
parseFloat(e):w.sanitizeHTML(e);k=this._getNodeText(c.nextSibling);k===this.customLabel&&(k=e.toString(),this.isNumberField&&(k=this._getLocalNumber(k)));c.nextSibling.children.length&&(k="Error"===this._dijit.state?decodeURIComponent(g.getAttr(c.nextSibling,"data")):this._dijit.value);k=w.sanitizeHTML(k);k={value:e,alias:k,isChecked:!1};this.listItemsArray.push(k);this.listValuesArray.push(e);g.hasClass(c.nextSibling.nextSibling,"checked")&&(k.isChecked=!0)}}a={list:this.listItemsArray,valueList:this.listValuesArray};
"radio"===this.inputType&&(a.emptyLabel=this._getEmptyLabel(),a.enableEmpty=this._getEmptyStatus());return a},setListValues:function(a,b){m.set(this.listContent,"innerHTML","");"radio"===this.inputType&&this._createEmptyTarget(a);for(var c=0;c<a.length;c++){var e=a[c],k="";e.isChecked&&(k=" checked",this.currentItem=!0);this._createTarget(e.value,b?b[c].label:e.value,e.alias,k)}a=f(".name",this.listContent);for(b=0;b<a.length;b++)c=a[b],g.setAttr(c,"title",this._getNodeText(c)),c=c.nextSibling,g.setAttr(c,
"title",this._getNodeText(c))},_initTable:function(){},getDijits:function(){return[this.mutiValuesSelect]},destroy:function(){this.inherited(arguments)}})})},"dojox/form/CheckedMultiSelect":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/event dojo/dom-geometry dojo/dom-class dojo/dom-construct dojo/i18n dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Menu dijit/MenuItem dijit/Tooltip dijit/form/_FormSelectWidget dijit/form/ComboButton dojo/text!dojox/form/resources/_CheckedMultiSelectMenuItem.html dojo/text!dojox/form/resources/_CheckedMultiSelectItem.html dojo/text!dojox/form/resources/CheckedMultiSelect.html dojo/i18n!dojox/form/nls/CheckedMultiSelect dijit/form/CheckBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){var F=p("dojox.form._CheckedMultiSelectItem",[f,e,b],{templateString:E,baseClass:"dojoxMultiSelectItem",option:null,parent:null,disabled:!1,readOnly:!1,postMixInProperties:function(){this._type=this.parent.multiple?{type:"checkbox",baseClass:"dijitCheckBox"}:{type:"radio",baseClass:"dijitRadio"};this.disabled||(this.disabled=this.option.disabled=this.option.disabled||!1);this.readOnly||(this.readOnly=this.option.readOnly=this.option.readOnly||!1);
this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.labelNode.innerHTML=this.option.label},_changeBox:function(){this.get("disabled")||this.get("readOnly")||(this.parent.multiple?this.option.selected=this.checkBox.get("value")&&!0:this.parent.set("value",this.option.value),this.parent._updateSelection(),this.parent.focus())},_onClick:function(a){this.get("disabled")||this.get("readOnly")?v.stop(a):this.checkBox._onClick(a)},_updateBox:function(){this.checkBox.set("value",
this.option.selected)},_setDisabledAttr:function(a){this.disabled=a||this.option.disabled;this.checkBox.set("disabled",this.disabled);m.toggle(this.domNode,"dojoxMultiSelectDisabled",this.disabled)},_setReadOnlyAttr:function(a){this.checkBox.set("readOnly",a);this.readOnly=a}}),D=p("dojox.form._CheckedMultiSelectMenu",c,{multiple:!1,buildRendering:function(){this.inherited(arguments);var a=this.menuTableNode=this.domNode,b=this.domNode=u.create("div",{style:{overflowX:"hidden",overflowY:"scroll"}});
a.parentNode&&a.parentNode.replaceChild(b,a);m.remove(a,"dijitMenuTable");b.className=a.className+" dojoxCheckedMultiSelectMenu";a.className="dijitReset dijitMenuTable";a.setAttribute("role","listbox");b.setAttribute("role","presentation");b.appendChild(a)},resize:function(a){a&&(n.setMarginBox(this.domNode,a),"w"in a&&(this.menuTableNode.style.width="100%"))},onClose:function(){this.inherited(arguments);this.menuTableNode&&(this.menuTableNode.style.width="")},onItemClick:function(a,b){"undefined"==
typeof this.isShowingNow&&this._markActive();this.focusChild(a);if(a.disabled||a.readOnly)return!1;if(!this.multiple)this.onExecute();a.onClick(b)}}),I=p("dojox.form._CheckedMultiSelectMenuItem",x,{templateString:z,option:null,parent:null,iconClass:"",postMixInProperties:function(){this.parent.multiple?(this._iconClass="dojoxCheckedMultiSelectMenuCheckBoxItemIcon",this._type={type:"checkbox"}):(this._iconClass="",this._type={type:"hidden"});this.disabled=this.option.disabled;this.checked=this.option.selected;
this.label=this.option.label;this.readOnly=this.option.readOnly;this.inherited(arguments)},onChange:function(a){},_updateBox:function(){m.toggle(this.domNode,"dojoxCheckedMultiSelectMenuItemChecked",!!this.option.selected);this.domNode.setAttribute("aria-checked",this.option.selected);this.inputNode.checked=this.option.selected;this.parent.multiple||m.toggle(this.domNode,"dijitSelectSelectedOption",!!this.option.selected)},_onClick:function(a){this.disabled||this.readOnly||(this.parent.multiple?(this.option.selected=
!this.option.selected,this.parent.onChange(),this.onChange(this.option.selected)):this.option.selected||(t.forEach(this.parent.getChildren(),function(a){a.option.selected=!1}),this.option.selected=!0,this.parent.onChange(),this.onChange(this.option.selected)));this.inherited(arguments)}});return p("dojox.form.CheckedMultiSelect",q,{templateString:B,baseClass:"dojoxCheckedMultiSelect",required:!1,invalidMessage:"$_unset_$",_message:"",dropDown:!1,labelText:"",tooltipPosition:[],postMixInProperties:function(){this.inherited(arguments);
this._nlsResources=k.getLocalization("dojox.form","CheckedMultiSelect",this.lang);"$_unset_$"==this.invalidMessage&&(this.invalidMessage=this._nlsResources.invalidMessage)},_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this.value=this.options[0<=a?a:0].value}this.dropDown&&(m.toggle(this.selectNode,"dojoxCheckedMultiSelectHidden"),this.dropDownMenu=new D({id:this.id+"_menu",style:"display: none;",multiple:this.multiple,
onChange:g.hitch(this,"_updateSelection")}))},startup:function(){this.dropDown&&(this.dropDownButton=new C({label:this.labelText,dropDown:this.dropDownMenu,baseClass:"dojoxCheckedMultiSelectButton",maxHeight:this.maxHeight},this.comboButtonNode));this.inherited(arguments)},_onMouseDown:function(a){a.preventDefault()},validator:function(){return this.required?t.some(this.getOptions(),function(a){return a.selected&&null!=a.value&&0!=a.value.toString().length}):!0},validate:function(a){w.hide(this.domNode);
(a=this.isValid(a))||this.displayMessage(this.invalidMessage);return a},isValid:function(a){return this.validator()},getErrorMessage:function(a){return this.invalidMessage},displayMessage:function(a){w.hide(this.domNode);a&&w.show(a,this.domNode,this.tooltipPosition)},onAfterAddOptionItem:function(a,b){},_addOptionItem:function(a){var b;this.dropDown?(b=new I({option:a,parent:this.dropDownMenu}),this.dropDownMenu.addChild(b)):(b=new F({option:a,parent:this,disabled:this.disabled,readOnly:this.readOnly}),
this.wrapperDiv.appendChild(b.domNode));this.onAfterAddOptionItem(b,a)},_refreshState:function(){this.validate(this.focused)},onChange:function(a){this._refreshState()},reset:function(){this.inherited(arguments);w.hide(this.domNode)},_updateSelection:function(){this.inherited(arguments);this._handleOnChange(this.value);t.forEach(this._getChildren(),function(a){a._updateBox()});u.empty(this.containerNode);var a=this;t.forEach(this.value,function(b){b=u.create("option",{value:b,label:b,selected:"selected"});
u.place(b,a.containerNode)});if(this.dropDown&&this.dropDownButton){var b=0,c="";t.forEach(this.options,function(a){a.selected&&(b++,c=a.label)});this.dropDownButton.set("label",this.multiple?g.replace(this._nlsResources.multiSelectLabelText,{num:b}):c)}},_getChildren:function(){return this.dropDown?this.dropDownMenu.getChildren():t.map(this.wrapperDiv.childNodes,function(b){return a.byNode(b)})},invertSelection:function(a){this.multiple&&(t.forEach(this.options,function(a){a.selected=!a.selected}),
this._updateSelection())},_setDisabledAttr:function(a){this.inherited(arguments);this.dropDown&&this.dropDownButton.set("disabled",a);t.forEach(this._getChildren(),function(b){b&&b.set&&b.set("disabled",a)})},_setReadOnlyAttr:function(a){this.inherited(arguments);"readOnly"in this.attributeMap&&this[this.attributeMap.readOnly].setAttribute("readonly",a);this.readOnly=a;t.forEach(this._getChildren(),function(b){b&&b.set&&b.set("readOnly",a)})},uninitialize:function(){w.hide(this.domNode);t.forEach(this._getChildren(),
function(a){a.destroyRecursive()});this.inherited(arguments)}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){b("dijit-legacy-requires")&&q(0,function(){p(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return t("dijit.Menu",
w,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):g.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return c.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},_iframeContentDocument:function(a){return a.contentDocument||
a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(b){b=v.byId(b,this.ownerDocument);var c;if("iframe"==b.tagName.toLowerCase()){var g=b;c=this._iframeContentWindow(g);c=a.body(c.document)}else c=b==a.body(this.ownerDocument)?this.ownerDocument.documentElement:b;var m={node:b,iframe:g};n.set(b,"_dijitMenu"+this.id,this._bindings.push(m));var p=f.hitch(this,function(a){var b=this.selector,c=b?function(a){return e.selector(b,
a)}:function(a){return a},f=this;return[e(a,c(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<f._lastKeyDown+500||f._scheduleOpen(this,g,{x:a.pageX,y:a.pageY},a.target)}),e(a,c("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==k.F10||f.leftClickToOpen&&a.keyCode==k.SPACE)a.stopPropagation(),a.preventDefault(),f._scheduleOpen(this,g,null,a.target),f._lastKeyDown=(new Date).getTime()})]});m.connects=c?p(c):[];g&&(m.onloadHandler=
f.hitch(this,function(){var b=this._iframeContentWindow(g),b=a.body(b.document);m.connects=p(b)}),g.addEventListener?g.addEventListener("load",m.onloadHandler,!1):g.attachEvent("onload",m.onloadHandler))},unBindDomNode:function(a){var b;try{b=v.byId(a,this.ownerDocument)}catch(F){return}a="_dijitMenu"+this.id;if(b&&n.has(b,a)){for(var c=n.get(b,a)-1,e=this._bindings[c],f;f=e.connects.pop();)f.remove();(f=e.iframe)&&(f.removeEventListener?f.removeEventListener("load",e.onloadHandler,!1):f.detachEvent("onload",
e.onloadHandler));n.remove(b,a);delete this._bindings[c]}},_scheduleOpen:function(a,b,c,e){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:e,delegatedTarget:a,iframe:b,coords:c})},1))},_openMyself:function(a){function c(){w.refocus&&t&&t.focus();x.close(w)}var e=a.target,f=a.iframe,g=a.coords,k=!g;this.currentTarget=a.delegatedTarget;if(g){if(f){a=m.position(f,!0);var e=this._iframeContentWindow(f),e=m.docScroll(e.document),n=u.getComputedStyle(f),
p=u.toPixelValue,q=(b("ie")&&b("quirks")?0:p(f,n.paddingLeft))+(b("ie")&&b("quirks")?p(f,n.borderLeftWidth):0),f=(b("ie")&&b("quirks")?0:p(f,n.paddingTop))+(b("ie")&&b("quirks")?p(f,n.borderTopWidth):0);g.x+=a.x+q-e.x;g.y+=a.y+f-e.y}}else g=m.position(e,!0),g.x+=10,g.y+=10;var w=this,f=this._focusManager.get("prevNode");a=this._focusManager.get("curNode");var t=!a||v.isDescendant(a,this.domNode)?f:a;x.open({popup:this,x:g.x,y:g.y,onExecute:c,onCancel:c,orient:this.isLeftToRight()?"L":"R"});this.focus();
k||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);x.close(this)}},destroy:function(){g.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dijit/form/ComboButton":function(){define("dojo/_base/declare dojo/keys ../focus ./DropDownButton dojo/text!./templates/ComboButton.html ../a11yclick".split(" "),function(p,g,t,v,n){return p("dijit.form.ComboButton",v,{templateString:n,_setIdAttr:"",_setTabIndexAttr:["focusNode",
"titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{buttonNode:"dijitButtonNode",titleNode:"dijitButtonContents",_popupStateNode:"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(m){m.keyCode==g[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]&&(t.focus(this._popupStateNode),m.stopPropagation(),m.preventDefault())},_onArrowKeyDown:function(m){m.keyCode==g[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]&&(t.focus(this.titleNode),m.stopPropagation(),
m.preventDefault())},focus:function(g){this.disabled||t.focus("start"==g?this.titleNode:this._popupStateNode)}})})},"jimu/dijit/_filter/NumberListValueProvider":function(){define("dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./NumberListValueProvider.html dijit/form/NumberTextBox dijit/form/Select".split(" "),function(p,g,t,v,n,m,u,k){return v([n,m,u],{templateString:k,postCreate:function(){this.inherited(arguments);
g.addClass(this.domNode,"jimu-number-list-filter-value-provider");this.rangeSelect.removeOption(this.rangeSelect.getOptions());t.forEach("dateOperatorMinutes dateOperatorHours dateOperatorDays dateOperatorWeeks dateOperatorMonths dateOperatorYears".split(" "),p.hitch(this,function(f){this.rangeSelect.addOption({value:f,label:this.nls[f]})}));this.rangeSelect.set("value","dateOperatorDays")},getDijits:function(){return[this._dijit1,this.rangeSelect]},setValueObject:function(f){this.isDefined(f.value)&&
this._dijit1.set("value",f.value);this.isDefined(f.range)&&this.rangeSelect.set("value",f.range)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()}:null},_getRangeByUI:function(){var f=this.rangeSelect.get("value");"none"===f&&(f=null);return f},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var f={isValid:!0,type:this.partObj.valueObj.type,
value:parseFloat(this._dijit1.get("value")),range:this._getRangeByUI()};isNaN(f.value)&&(f.value=null);return f}return null},setRequired:function(f){this._dijit1.set("required",f);this.rangeSelect.set("required",f)}})})},"jimu/dijit/_filter/DateIsInValueProvider":function(){define("dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/text!./DateIsInValueProvider.html ./ValueProvider jimu/filterUtils dijit/form/Select dijit/form/DateTextBox".split(" "),
function(p,g,t,v,n,m,u,k){return v([u,n,p],{templateString:m,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.filterBuilder},virtualDates:null,postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-date-is-in-value-provider");this.dateTypeSelect.addOption({value:"",label:"\x26nbsp;"});return["thisWeek","thisMonth","thisQuarter","thisYear"].forEach(t.hitch(this,function(f){this.dateTypeSelect.addOption({value:f,label:this.nls[f]})}))},getDijits:function(){return[this.dateTypeSelect]},
_setValueObject:function(f,e,b,a){if(this.isDefined(e[b])){var c={value:null,virtualDate:""};c.value=e[b];c.virtualDate=e[a];f.setValueObject(c)}},setValueObject:function(f){this.dateTypeSelect.set("value",f.virtualDate)},getValueObject:function(){return this.isValidValue()?this.tryGetValueObject():null},tryGetValueObject:function(){if(this.isInvalidValue())return null;var f={isValid:!0,type:this.partObj.valueObj.type,value:null,virtualDate:this.dateTypeSelect.get("value")},e=this.dateTypeSelect.get("value"),
b=k.getRealDateByVirtualDate(e);f.virtualDate=e;b&&(f.value1=b[0].toDateString(),f.value2=b[1].toDateString());return f},setRequired:function(f){this.dateTypeSelect.set("required",f)},getStatus:function(){return this.dateTypeSelect.get("value")?1:0},_onDateTypeSelectChanged:function(){this.emit("change")}})})},"jimu/dijit/_SingleFilter":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/keys dijit/a11yclick dijit/focus dojo/query dojo/store/Memory jimu/utils jimu/dijit/_filter/ValueProviderFactory dijit/popup jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z){return g([t,v,n,p],{templateString:m,baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,popupFieldsInfo:[],stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,valueProvider:null,runtime:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);
this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder;this.nls.deleteText=window.jimuNls.common.deleteText},postCreate:function(){this.inherited(arguments);this._initSelf();this.own(e(this.valueTypeSetNode,a,u.hitch(this,this._onValueTypeSetClick)));this.own(e(this.btnDelete,a,u.hitch(this,function(){this._destroySelf()})));this.own(e(document,"click",u.hitch(this,function(a){a=a.target;k.isDescendant(a,
this.valueTypePopupNode)&&!k.hasClass(a,"value-type-popup-icon")||this._closeEsriPopup()})));this.customDijit&&this.own(e(window,"resize",u.hitch(this,function(){this._closeEsriPopup()})))},toJson:function(){var a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1},b=this._getFieldObjByUI();if(!b)return null;a.fieldObj=b;b=this._getOperatorByUI();if(!b)return null;a.operator=b;a.caseSensitive=this.cbxCaseSensitive.getStatus()&&this.cbxCaseSensitive.getValue();var b=this._getValueTypeByUI(),
c=this._isUseAskForValues();if(c){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value"),cascade:"none"};if("unique"===b||"multiple"===b)a.interactiveObj.cascade=this.cascadeSelect.get("value")}a.valueObj={isValid:!0,type:""};c=c?this.valueProvider.tryGetValueObject():this.valueProvider.getValueObject();if(!c)return null;c.type=b;a.valueObj=c;return a},_getFieldObjByUI:function(){var a=
this._getSelectedFilteringItem(this.fieldsSelect);if(!a)return null;var b="";0!==this.popupFieldsInfo.length&&(b=q.getDateFieldFormatByFieldName(this.popupFieldsInfo,a.name));return{name:a.name,label:a.name,dateFormat:b,shortType:a.shortType,type:a.type}},_getOperatorByUI:function(){var a=this.operatorsSelect.get("value");"none"===a&&(a=null);return a},showDelteIcon:function(){k.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){k.setStyle(this.btnDelete,"display","none")},
_showCaseSensitive:function(){k.setStyle(this.cbxCaseSensitive.domNode,"display","inline-block")},_hideCaseSensitive:function(){k.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_showAndEnableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!0);this._showCaseSensitive()},_hideAndDisableCaseSensitive:function(){this.cbxCaseSensitive.setStatus(!1);this._hideCaseSensitive()},_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),
this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(e(this.fieldsSelect,"MouseEnter",u.hitch(this,this._updateFieldsSelectTitle)));this.own(e(this.operatorsSelect,"MouseEnter",u.hitch(this,this._updateOperatorsSelectTitle)));this.enableAskForValues?(k.setStyle(this.cbxAskValues.domNode,"display","inline-block"),k.setStyle(this.promptSection,"display","block"),this.own(e(this.cbxAskValues,"status-change",u.hitch(this,this._onCbxAskValuesStatusChanged))),this.cbxAskValues.onChange=
u.hitch(this,this._onCbxAskValuesClicked)):(k.setStyle(this.cbxAskValues.domNode,"display","none"),k.setStyle(this.promptSection,"display","none"));var a=this.layerInfo.fields;a&&0<a.length&&(a=f.filter(a,u.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),0<a.length&&(this._initValueTypeUI(),this._enableAllValueTypeOptions(),this._initFieldsSelect(a),this.part?this._showPart(this.part):this._resetByFieldAndOperator(),setTimeout(u.hitch(this,function(){this._bindFieldsSelectChangeAndOperatorChangeEvents()}),
10)))},_bindFieldsSelectChangeAndOperatorChangeEvents:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();this._handle1=e(this.fieldsSelect,"change",u.hitch(this,this._onFieldsSelectChange));this._handle2=e(this.operatorsSelect,"change",u.hitch(this,this._onOperatorsSelectChange))},_removeFieldsSelectChangeAndOperatorChangeEvents:function(){this._handle1&&this._handle1.remove();this._handle2&&this._handle2.remove();this._handle2=this._handle1=null},_isServiceSupportDistinctValues:function(a,
b){if(this._isStreamServer(a))return!1;a=b.currentVersion?b:b.toJson().layerDefinition;return 10.1<=parseFloat(a.currentVersion)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title="";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=
this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label,k.setAttr(this.operatorsSelect.domNode,"aria-label",a.label))},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(B){console.error(B)}},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);return null},_getShortTypeByFieldType:function(a){return a===
this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_initFieldsSelect:function(a){a=f.map(a,u.hitch(this,function(a,b){var c=u.mixin({},a);c.id=b;c.shortType=this._getShortTypeByFieldType(a.type);c.alias||(c.alias=c.name);a="";"string"===c.shortType?a=this.nls.string:"number"===c.shortType?a=this.nls.number:"date"===c.shortType&&(a=this.nls.date);c.displayName=c.alias+" ("+a+")";return c}));if(0<a.length){var b=new w({data:a});this.fieldsSelect.set("store",
b);this.fieldsSelect.set("value",a[0].id)}setTimeout(u.hitch(this,function(){this.fieldsSelect.focusNode.focus()}),2);this._updateOperatorsByFieldsSelect()},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){this._removeFieldsSelectChangeAndOperatorChangeEvents();var b=this.part.fieldObj.name;a=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;b=this.fieldsSelect.store.query({name:b});0!==b.length&&(b=b[0])&&(this.fieldsSelect.set("value",
b.id),this._updateOperatorsByFieldsSelect(),this.operatorsSelect.set("value",a),this._resetByFieldAndOperator(this.part),a=this.part.interactiveObj)&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""),"unique"===this.part.valueObj.type||"multiple"===this.part.valueObj.type?this.cascadeSelect.set("value",a.cascade):this.cascadeSelect.set("value","none"))}},_onFieldsSelectChange:function(){this._updateOperatorsByFieldsSelect();
this._resetByFieldAndOperator()},_updateOperatorsByFieldsSelect:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,a=C.getOperatorsByShortType(a.shortType,this.isHosted),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),f.forEach(a,u.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})))},_onOperatorsSelectChange:function(){this._resetByFieldAndOperator()},_updateValueTypeClass:function(){k.removeClass(this.domNode,"value-type");k.removeClass(this.domNode,"field-type");k.removeClass(this.domNode,"unique-type");k.removeClass(this.domNode,"support-cascade");var a=this._getValueTypeByUI();"value"===a?(k.addClass(this.domNode,"value-type"),this.cascadeSelect.set("value","none")):"field"===a?(k.addClass(this.domNode,"field-type"),this.cascadeSelect.set("value",
"none")):(k.addClass(this.domNode,"unique-type"),this.cascadeSelect.set("value","previous"),a=!0,a=this._getSelectedFilteringItem(this.fieldsSelect),a=q.getCodedValuesOrTypesCount(a,this.layerInfo),(a=0<a?q.isCodedValuesSupportFilter(this.layerInfo,a):!0)?(this.cascadeSelect.set("value","previous"),k.addClass(this.domNode,"support-cascade")):this.cascadeSelect.set("value","none"))},_enableValueTypeSelectOption:function(a,b){a=x("li[data-type\x3d"+a+"]",this.valueTypePopupNode)[0];b?(k.removeClass(a,
"disabled"),k.setAttr(a,"aria-disabled","false")):(k.addClass(a,"disabled"),k.setAttr(a,"aria-disabled","true"))},_setVisibleValueTypeSelectOption:function(a,b){a=x("li[data-type\x3d"+a+"]",this.valueTypePopupNode)[0];b?k.setStyle(a,"display","block"):k.setStyle(a,"display","none")},_calcValueTypePosition:function(a){var b,c;a=k.position(a.target);b=k.position(document.body).w;c=k.position(document.body).h;var e=k.getStyle(this.valueTypePopupNode,"width"),f=k.getStyle(this.valueTypePopupNode,"height");
c=c-a.y-16-10>=f?a.y+16+10:a.y-f-10;b=b-a.x>=e?a.x:a.x+16-e;window.isRTL&&(b=a.x+16>=e?a.x+16-e:a.x);return{left:b,top:c}},_onValueTypeSetClick:function(a){z.open({popup:this.customDijit,around:a.target});var b=this._calcValueTypePosition(a);z.open({x:b.left,y:b.top,popup:this.customDijit});a.stopPropagation();q.isInNavMode()&&c.focus(this.valueTypePopupDelBtn)},_onValueTypeClick:function(a){var b=k.getAttr(a.currentTarget,"data-type");k.hasClass(a.currentTarget,"disabled")?a.stopPropagation():(x("li",
this.valueTypePopupNode).forEach(function(a){k.removeClass(a,"selected")}),k.addClass(a.currentTarget,"selected"),this._resetByFieldAndOperator(null,b),this._closeEsriPopup())},_enableValueTypeOption:function(a){this._enableValueTypeSelectOption("value",a)},_enableFieldTypeOption:function(a){this._enableValueTypeSelectOption("field",a)},_enableUniqueTypeOption:function(a){this._enableValueTypeSelectOption("unique",a)},_enableUniquePredefinedTypeOption:function(a){this.runtime?this._setVisibleValueTypeSelectOption("uniquePredefined",
!1):this._enableValueTypeSelectOption("uniquePredefined",a)},_enableValuesTypeOption:function(a){this._enableValueTypeSelectOption("values",a)},_enableMultipleTypeOption:function(a){this._enableValueTypeSelectOption("multiple",a)},_enableMultiplePredefinedTypeOption:function(a){this.runtime?this._setVisibleValueTypeSelectOption("multiplePredefined",!1):this._enableValueTypeSelectOption("multiplePredefined",a)},_enableAllValueTypeOptions:function(){this._enableValueTypeOption(!0);this._enableFieldTypeOption(!0);
this._enableUniqueTypeOption(!0);this._enableUniquePredefinedTypeOption(!0);this._enableMultipleTypeOption(!0);this._enableMultiplePredefinedTypeOption(!0)},_disableAllValueTypeOptions:function(){this._enableValueTypeOption(!1);this._enableFieldTypeOption(!1);this._enableUniqueTypeOption(!1);this._enableUniquePredefinedTypeOption(!1);this._enableMultipleTypeOption(!1);this._enableMultiplePredefinedTypeOption(!1)},_resetByFieldAndOperator:function(a,b){this._updateOperatorsSelectTitle();this.valueProvider&&
this.valueProvider.destroy();this._hideCaseSensitive();this._disableAllValueTypeOptions();a||(a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1},a.fieldObj=this._getFieldObjByUI(),a.operator=this._getOperatorByUI());var c=[],f=null;a.fieldObj&&a.operator&&(c=this.valueProviderFactory.getSupportedValueTypes(a.fieldObj.name,a.operator),a.valueObj?f=a.valueObj.type:(f=b&&0<=c.indexOf(b)?b:c[0],a.valueObj={type:f}),0<=c.indexOf("value")&&this._enableValueTypeOption(!0),0<=c.indexOf("field")&&
this._enableFieldTypeOption(!0),0<=c.indexOf("unique")&&this._enableUniqueTypeOption(!0),0<=c.indexOf("values")&&this._enableValuesTypeOption(!0),0<=c.indexOf("uniquePredefined")&&this._enableUniquePredefinedTypeOption(!0),0<=c.indexOf("multiple")&&this._enableMultipleTypeOption(!0),0<=c.indexOf("multiplePredefined")&&this._enableMultiplePredefinedTypeOption(!0),"value"===f?this._enableValueTypeOption(!0):"field"===f?this._enableFieldTypeOption(!0):"unique"===f?this._enableUniqueTypeOption(!0):"values"===
f?this._enableValuesTypeOption(!0):"uniquePredefined"===f?this._enableUniquePredefinedTypeOption(!0):"multiple"===f?this._enableMultipleTypeOption(!0):"multiplePredefined"===f&&this._enableMultiplePredefinedTypeOption(!0),this._updateValueTypeUI(f));0<c.length?(this.valueProvider=this.valueProviderFactory.getValueProvider(a,this.runtime),this.valueProvider.placeAt(this.valueProviderContainer),this.valueProvider.setValueObject(a.valueObj),this.own(e(this.valueProvider,"change",u.hitch(this,function(){this.emit("change")}))),
this.valueProvider.bindChangeEvents(),this.valueProvider.isBlankValueProvider()?(k.addClass(this.valueProvider.domNode,"hidden"),k.addClass(this.attributeValueContainer,"hidden")):k.removeClass(this.attributeValueContainer,"hidden"),(b=C.getOperatorInfo(a.operator))&&f&&(b[f]&&b[f].supportCaseSensitive&&this._showCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive))):k.addClass(this.attributeValueContainer,"hidden");this._updateWhenValueRadioChanged();this.emit("change")},_updateWhenValueRadioChanged:function(){this._updatePrompt(!1,
!0);this._updateValueTypeClass()},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt(!0)},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){var a=this._getValueTypeByUI();return"uniquePredefined"===a||"multiplePredefined"===a?!0:this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.valueProvider.setRequired(a)},
_getValueTypeByUI:function(){var a=x("li.selected",this.valueTypePopupNode)[0];return a?k.getAttr(a,"data-type"):null},_closeEsriPopup:function(){this.customDijit&&z.close(this.customDijit)},_destroyEsriPopup:function(){this.customDijit&&(this.customDijit.destroy(),z.close(this.customDijit))},_initValueTypeUI:function(){if(!this.valueTypePopupNode){this.valueTypePopupNode=document.createElement("DIV");k.addClass(this.valueTypePopupNode,"value-type-popup");this.valueTypePopupNode.innerHTML='\x3cdiv class\x3d"value-type-popup-header"\x3e\x3cspan class\x3d"value-type-popup-title jimu-ellipsis" title\x3d"'+
this.nls.setInputType+'"\x3e'+this.nls.setInputType+'\x3c/span\x3e\x3cspan role\x3d"button" tabindex\x3d"0" aria-label\x3d"'+this.nls.deleteText+'" class\x3d"value-type-popup-icon jimu-icon jimu-icon-delete"\x3e\x3c/span\x3e\x3c/div\x3e\x3cul role\x3d"listbox" tabindex\x3d"0"\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"value" title\x3d"'+this.nls.value+'"\x3e\x3cspan\x3e'+this.nls.value+'\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"field" title\x3d"'+
this.nls.field+'"\x3e\x3cspan\x3e'+this.nls.field+'\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"unique" title\x3d"'+this.nls.unique+'"\x3e\x3cspan\x3e'+this.nls.unique+'\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"uniquePredefined" title\x3d"'+this.nls.uniquePredefined+'"\x3e\x3cspan\x3e'+this.nls.uniquePredefined+'\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"multiple" title\x3d"'+
this.nls.multiple+'"\x3e\x3cspan\x3e'+this.nls.multiple+'\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"multiplePredefined" title\x3d"'+this.nls.multiplePredefined+'"\x3e\x3cspan\x3e'+this.nls.multiplePredefined+"\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e";this.customDijit=new t({baseClass:"jimu-filter-valueType",domNode:this.valueTypePopupNode});this.valueTypePopupDelBtn=x(".value-type-popup-icon",this.valueTypePopupNode)[0];
this.own(e(this.valueTypePopupDelBtn,"click",u.hitch(this,function(a){this._closeEsriPopup();a.stopPropagation()})));this.own(e(this.valueTypePopupDelBtn,"keydown",u.hitch(this,function(a){a.keyCode===b.ENTER||a.keyCode===b.SPACE?(this._closeEsriPopup(),q.isInNavMode()&&c.focus(this.valueTypeSetNode)):a.shiftKey||a.keyCode!==b.TAB||this.valueTypeList.focus()})));this.valueTypeList=x("ul",this.valueTypePopupNode)[0];var a=x("li",this.valueTypePopupNode);this.own(e(this.valueTypeList,"focus",u.hitch(this,
function(){this.selectedValueType=x("li.selected",this.valueTypePopupNode)[0];this.selectedValueType.focus()})));this.own(e(this.valueTypeList,"keydown",u.hitch(this,function(e){if(e.keyCode===b.TAB)e.shiftKey?(e.preventDefault(),this.valueTypePopupDelBtn.focus()):(e.preventDefault(),this._closeEsriPopup(),q.isInNavMode()&&c.focus(this.valueTypeSetNode));else{var f,g=!1;if(e.keyCode===b.DOWN_ARROW)for(f=this.selectedValueType,e=0;e<a.length-1;e++)if(g){if("none"!==k.getStyle(a[e],"display")){f=a[e];
break}}else a[e]===this.selectedValueType&&(g=!0);else if(e.keyCode===b.UP_ARROW)for(f=this.selectedValueType,e=a.length-1;0<=e;e--)if(g){if("none"!==k.getStyle(a[e],"display")){f=a[e];break}}else a[e]===this.selectedValueType&&(g=!0);else if(e.keyCode===b.HOME)f=a[0];else if(e.keyCode===b.END)for(e=a.length-1;0<=e;e--)if("none"!==k.getStyle(a[e],"display")){f=a[e];break}f&&(this.selectedValueType=f,f.focus())}})));this.own(e(a,"click",u.hitch(this,function(a){this._onValueTypeClick(a)})));this.own(e(a,
"keydown",u.hitch(this,function(a){a.keyCode===b.ENTER&&(this._onValueTypeClick(a),k.hasClass(a.target,"disabled")||this.valueTypeSetNode.focus())})));this.own(e(this.valueTypePopupNode,"keydown",u.hitch(this,function(a){a.keyCode===b.ESCAPE&&(a.stopPropagation(),c.focus(this.valueTypePopupDelBtn))})))}},_updateValueTypeUI:function(a){x("li",this.valueTypePopupNode).forEach(function(a){k.removeClass(a,"selected")});if(a=x("li[data-type\x3d"+a+"]",this.valueTypePopupNode)[0])return k.addClass(a,"selected")},
_updatePrompt:function(a,b){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);!a&&b&&this.cbxAskValues.uncheck(!0);k.setStyle(this.promptTable,"display","table");b=this.operatorsSelect.get("value");var c=this.nls[b],e=!1,f=this._getValueTypeByUI(),g=C.getOperatorInfo(b);g&&f&&(g=g[f])&&g.supportAskForValue&&(e=!0);e||(this.cbxAskValues.uncheck(!0),this.cbxAskValues.setStatus(!1));g=this.cbxAskValues.getValue();(f=0<=["uniquePredefined","multiplePredefined"].indexOf(f)?
!0:!1)?this.cbxAskValues.check(!0):a?g?this.cbxAskValues.check(!0):this.cbxAskValues.uncheck(!0):e?this.cbxAskValues.status||this.cbxAskValues.check(!0):this.cbxAskValues.uncheck(!0);this.cbxAskValues.status&&this.cbxAskValues.checked?(k.setStyle(this.promptTable,"display","table"),(a=this._getSelectedFilteringItem(this.fieldsSelect))&&"none"!==b&&this.promptTB.set("value",(a.alias||a.name)+" "+c)):k.setStyle(this.promptTable,"display","none");f?(this.cbxAskValues.setStatus(!1),this.cascadeSelect.setDisabled(!0)):
this.cascadeSelect.setDisabled(!1)},_destroySelf:function(){this.destroy()},destroy:function(){this._removeFieldsSelectChangeAndOperatorChangeEvents();this._destroyEsriPopup();this.inherited(arguments)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/a11yclick dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){return g([t,v,n,p],{templateString:m,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,popupFieldsInfo:[],stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,valueProviderFactory:null,runtime:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this.nls.deleteText=window.jimuNls.common.deleteText;this.nls.addText=window.jimuNls.common.add;this.inherited(arguments)},
postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=x(".jimu-single-filter",this.allExpsBox),a=e.map(a,k.hitch(this,function(a){return u.byNode(a).toJson()}));return e.every(a,k.hitch(this,function(a){return!!a}))&&0<a.length?{logicalOperator:this.allAnySelect.value,parts:a}:null},showDelteIcon:function(){f.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){f.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(b(this.btnDelete,
a,k.hitch(this,function(){this._destroySelf()})));this.own(b(this.btnAdd,a,k.hitch(this,function(){this._addSingleFilter();this.emit("change")})));if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var c=this.partsObj.parts||[];0===c.length?(this._addSingleFilter(),this._addSingleFilter()):1===c.length?(this._addSingleFilter(c[0]),this._addSingleFilter()):e.forEach(c,k.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter();setTimeout(k.hitch(this,
function(){this.allAnySelect.focus()}),5)},_addSingleFilter:function(a){a=new w({url:this.url,layerInfo:this.layerInfo,popupFieldsInfo:this.popupFieldsInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,valueProviderFactory:this.valueProviderFactory,isInFilterSet:!0,runtime:this.runtime});a.placeAt(this.allExpsBox);a.startup();this.own(c.after(a,
"_destroySelf",k.hitch(this,function(){this._checkFilterNumbers();this.allAnySelect.focus()})));this.own(b(a,"change",k.hitch(this,function(){this.emit("change")})));this._checkFilterNumbers();return a},_checkFilterNumbers:function(){var a=x(".jimu-single-filter",this.allExpsBox),b=2<a.length;e.forEach(a,k.hitch(this,function(a){a=u.byNode(a);b?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},"builder/plugins/attribute-config/dataSource/DataFields":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/text!./DataFields.html".split(" "),
function(p,g,t,v,n,m,u,k,f,e){return p([u,f,k],{baseClass:"jimu-widget-chart-setting-data-fields",templateString:e,postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"click",g.hitch(this,this._onDomClicked)))},clear:function(){v.empty(this.fieldsContent);this.emit("change")},setFields:function(b){this.clear();t.forEach(b,g.hitch(this,function(a){var b=v.toDom('\x3cdiv class\x3d"field-item"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3cspan class\x3d"jimu-ellipsis" /\x3e\x3c/div\x3e'),
e=n("input",b)[0],f=n("span",b)[0];e.checked=!!a.checked;e.disabled=!!a.disabled;f.innerHTML=a.alias||a.name;f.title=a.alias||a.name;b.fieldName=a.name;v.place(b,this.fieldsContent);this.own(m(e,"change",g.hitch(this,function(){this.emit("change")})))}));this.emit("change")},selectFields:function(b){g.isArrayLike(b)&&(b=g.clone(b),b.reverse(),t.forEach(b,g.hitch(this,function(a){if(a=this._getFieldItemDivByName(a))v.place(a,a.parentNode,"first"),n("input",a)[0].checked=!0})));this.emit("change")},
getSelectedFieldNames:function(){var b=n(".field-item",this.fieldsContent),a=[];t.forEach(b,g.hitch(this,function(b){n("input",b)[0].checked&&a.push(b.fieldName)}));return a},_getFieldItemDivByName:function(b){var a=n(".field-item",this.fieldsContent);return t.filter(a,g.hitch(this,function(a){return a.fieldName===b}))[0]},_onDomClicked:function(b){b=b.target||b.srcElement;if(v.isDescendant(b,this.fieldsContent)&&b!==this.fieldsContent){var a=b.tagName.toLowerCase(),c=null;v.hasClass(b,"field-item")?
this._selectFieldItemDom(b):"span"===a?(c=b.parentNode,this._selectFieldItemDom(c)):"input"===a&&(c=b.parentNode,b.checked?this._selectFieldItemDom(c):v.removeClass(c,"selected"));this._updateHighLightIcons()}},_updateHighLightIcons:function(){var b=this._getSelectedFieldItemDiv();b&&v.hasClass(b,"selected")&&(b.previousSibling?v.addClass(this.btnUp,"high-light"):v.removeClass(this.btnUp,"high-light"),b.nextSibling?v.addClass(this.btnDown,"high-light"):v.removeClass(this.btnDown,"high-light"))},_selectFieldItemDom:function(b){n(".field-item",
this.fieldsContent).removeClass("selected");v.addClass(b,"selected")},_getSelectedFieldItemDiv:function(){var b=null,a=n(".field-item.selected",this.fieldsContent);0<a.length&&(b=a[0]);return b},_moveUp:function(){var b=this._getSelectedFieldItemDiv();b&&b.previousSibling&&v.place(b,b.previousSibling,"before");this._updateHighLightIcons()},_moveDown:function(){var b=this._getSelectedFieldItemDiv();b&&b.nextSibling&&v.place(b,b.nextSibling,"after");this._updateHighLightIcons()}})})},"builder/plugins/attribute-config/dataSource/utils":function(){define(["jimu/utils"],
function(p){return{createDataSourceId:function(g,t){var v="";return v="map"===g&&t?"map~"+t+"~"+p.getRandomString():"external~"+p.getRandomString()}}})},"jimu/dijit/DataPreviewTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dojo/_base/lang dojo/_base/array jimu/utils dgrid/OnDemandGrid dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder".split(" "),function(p,g,t,v,n,m,u,k,f){return p([t],{declaredClass:"jimu.dijit.DataPreviewTable",baseClass:"jimu-data-preview-table",
featureSet:null,loadingIndicator:null,_AUTO_WIDTH_COLS:6,postCreate:function(){this.inherited(arguments);m.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");this.tableContainer=g.create("div",{"class":"table-container"},this.domNode);this.height&&g.style(this.tableContainer,"height",this.height-80+"px");var e=this._getColumns();this.grid=new (p([u,k,f]))({columns:e},this.tableContainer);e=this._getData();this.grid.renderArray(e)},_getColumns:function(){var e="auto";this.featureSet.fields&&this.featureSet.fields.length&&
this.featureSet.fields.length>this._AUTO_WIDTH_COLS&&(e=120);var b={};n.forEach(this.featureSet.fields,function(a){b[a.name]={label:a.alias,width:e}});return b},_getData:function(){var e=[];n.forEach(this.featureSet.features,function(b,a){var c={};n.forEach(this.featureSet.fields,function(a){c[a.name]=b.attributes[a.name]},this);e.push(v.clone(v.mixin({id:a+1},c)))},this);return e}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),
function(p,g,t,v,n,m,u,k,f){function e(a){for(var b=a.length,c=b,e=a[0].length,f=Array(b);b--;)f[b]=Array(e);for(var g={},b=0;b<c;b++)for(var k=f[b],m=a[b],n=0,p=0;n<e;n++){var w=m[p],u;if("undefined"==typeof k[n]){k[n]=w.id;if(w.rowSpan&&1<w.rowSpan){u=f;for(var t=w.rowSpan,v=b,x=n,S=w.id,T=1;T<t;T++)u[v+T][x]=S}if(0<b&&w.colSpan&&1<w.colSpan)for(u=1;u<w.colSpan;u++)if(k[++n]=w.id,w.rowSpan&&1<w.rowSpan)for(var t=f,v=w.rowSpan,x=b,S=n,T=w.id,O=1;O<v;O++)t[x+O][S]=T;g[w.id]=a[0][n].id;p++}}return g}
function b(a,b,c,e,f){if(!(0>=c)){var m=a.columns[b],n;if(m&&(n={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},e&&(n.parentType=e),!a._resizedColumns||g.emit(a.headerNode,"dgrid-columnresize",n)))return"auto"===c?delete m.width:(m.width=c,c+="px"),(e=a._columnSizes[b])?e.set("width",c):e=k.addCssRule("#"+k.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+k.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=e,!1!==f&&a.resize(),!0}}var a,c=0,x={create:function(){a=f("div.dgrid-column-resizer")},
destroy:function(){f(a,"!");a=null},show:function(b){b=m.position(b.domNode,!0);a.style.top=b.y+"px";a.style.height=b.h+"px";f(document.body,a)},move:function(b){a.style.left=b+"px"},hide:function(){a.parentNode.removeChild(a)}};return p("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);c++||x.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--c||x.destroy()},resizeColumnWidth:function(a,c){return b(this,a,c)},configStructure:function(){var a=this._oldColumnSizes=v.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=k.addCssRule("#"+k.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
k.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var a=this,b;if(this.columnSets&&this.columnSets.length)for(var c=this.columnSets.length;c--;)b=v.mixin(b||{},e(this.columnSets[c]));else this.subRows&&1<this.subRows.length&&(b=e(this.subRows));for(var c=t(".dgrid-cell",a.headerNode),m=c.length;m--;){var n=c[m],p=n.columnId,x=a.columns[p],F=n.childNodes;if(x&&!1!==x.resizable){x=f("div.dgrid-resize-header-container");for(n.contents=
x;0<F.length;)f(x,F[0]);f(n,x,"div.dgrid-resize-handle.resizeNode-"+k.escapeCssIdentifier(p,"-")).columnId=b&&b[p]||p}}a.mouseMoveListen||(g(a.headerNode,".dgrid-resize-handle:mousedown"+(u("touch")?",.dgrid-resize-handle:touchstart":""),function(b){a._resizeMouseDown(b,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=g.pausable(document,"mousemove"+(u("touch")?",touchmove":""),k.throttleDelayed(function(b){a._updateResizerPosition(b)}))),a._listeners.push(a.mouseUpListen=
g.pausable(document,"mouseup"+(u("touch")?",touchend":""),function(b){a._resizeMouseUp(b);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();n.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=t(".dgrid-column-"+k.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);x.show(this)},_resizeMouseUp:function(a){var c=this._columnSizes,
e,f,g;this.adjustLastColumn&&(g=this.headerNode.clientWidth-1);this._resizedColumns||(e=t(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?e=e.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in c)}):this.subRows&&1<this.subRows.length&&(e=e.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in c)})),f=e.map(function(a){return a.offsetWidth}),e.forEach(function(a,c){b(this,a.columnId,f[c],null,!1)},this),this._resizedColumns=!0);n.setSelectable(this.domNode,
!0);e=this._targetCell;var m=this._getResizeMouseLocation(a)-this._startX,p=e.offsetWidth+m,w=this._getResizedColumnWidths(),u=w.totalWidth,w=w.lastColId,v=t(".dgrid-column-"+k.escapeCssIdentifier(w,"-"),this.headerNode)[0].offsetWidth;p<this.minWidth&&(p=this.minWidth);b(this,e.columnId,p,a.type)&&e.columnId!=w&&this.adjustLastColumn&&(u+m<g?b(this,w,"auto",a.type):v-m<=this.minWidth&&b(this,w,this.minWidth,a.type));x.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));x.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=t((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),c=b.length;if(!c)return{};for(var e=b[c-1].columnId;c--;)a+=
b[c].offsetWidth;return{totalWidth:a,lastColId:e}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(p,g,t,v,n,m,u){function k(a,b){var c=b[2];a=a[c?"columnSets":"subRows"][b[1]];return c?a[b[2]]:a}function f(a,b,e){b[2]?a.columnSets[b[1]][b[2]]=e:a.subRows[b[1]]=e}function e(a,b){return b.slice(("dgrid-"+a+"-").length)}
var b=/(\d+)(?:-(\d+))?$/;p=g(m,{copyState:function(){return!1},checkAcceptance:function(a,b){return a==this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(a){var c=this.grid,g=b.exec(e(c.id,a[0].getAttribute("dndType"))),m=g[2]?"columnSets":"subRows",n=k(c,g),p=c.columns;this.inherited(arguments);g&&setTimeout(function(){var b=t.map(a[0].parentNode.childNodes,function(a){return p[a.columnId]});f(c,g,b);
b={grid:c,subRow:b,column:p[a[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};b[m]=c[m];v.emit(c.domNode,"dgrid-columnreorder",b)?c.set(m,c[m]):(f(c,g,n),c.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});g=g("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:p,_initSubRowDnd:function(a,b){var c,e,f,g;e=0;for(f=a.length;e<f;e++)g=a[e],!1!==g.reorderable&&(g=g.headerNode,"TH"!=g.tagName&&(g=g.parentNode),u(g,".dojoDndItem[dndType\x3d"+b+"]"),c||
(c=g.parentNode));c&&this._columnDndSources.push(new this.columnDndConstructor(c,{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",b,e;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(e=0,b=this.columnSets.length;e<b;e++)t.forEach(this.columnSets[e],function(b,c){this._initSubRowDnd(b,a+e+"-"+c)},this);else t.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&t.forEach(this._columnDndSources,
function(a){a.destroy()});this.inherited(arguments)}});g.ColumnDndSource=p;return g})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a){t.isAsync||k(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var c=g("dojo.dnd.Source",b,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,
withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){v.mixin(this,v.mixin({},b));a=this.accept;if(a.length)for(this.accept={},b=0;b<a.length;++b)this.accept[a[b]]=1;this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState="";this.isSource&&n.add(this.node,"dojoDndSource");this.targetState="";this.accept&&n.add(this.node,"dojoDndTarget");this.horizontal&&n.add(this.node,"dojoDndHorizontal");
this.topics=[f.subscribe("/dnd/source/over",v.hitch(this,"onDndSourceOver")),f.subscribe("/dnd/start",v.hitch(this,"onDndStart")),f.subscribe("/dnd/drop",v.hitch(this,"onDndDrop")),f.subscribe("/dnd/cancel",v.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<b.length;++c){for(var e=a.getItem(b[c].id).type,f=!1,g=0;g<e.length;++g)if(e[g]in this.accept){f=!0;break}if(!f)return!1}return!0},copyState:function(b,c){if(b)return!0;2>
arguments.length&&(c=this==a.manager().target);if(c){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){c.superclass.destroy.call(this);p.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(b){if(!this.isDragging||"Disabled"!=this.targetState){c.superclass.onMouseMove.call(this,b);var f=a.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(b.pageX-this._lastX)>this.delay||Math.abs(b.pageY-this._lastY)>
this.delay)){var g=this.getSelectedNodes();g.length&&f.startDrag(this,g,this.copyState(e.getCopyKeyState(b),!0))}this.isDragging&&(g=!1,this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox=m.position(this.current,!0)),g=this.horizontal?b.pageX-this.targetBox.x<this.targetBox.w/2==m.isBodyLtr(this.current.ownerDocument):b.pageY-this.targetBox.y<this.targetBox.h/2),this.current!=this.targetAnchor||g!=this.before)&&(this._markTargetAnchor(g),f.canDrop(!this.current||f.source!=
this||!(this.current.id in this.selection)))}},onMouseDown:function(a){this.mouseDown||!this._legalMouseDown(a)||this.skipForm&&e.isFormElement(a)||(this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,c.superclass.onMouseDown.call(this,a))},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,c.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(b){this!==b?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(b=a.manager(),b.canDrop("Disabled"!=this.targetState&&
(!this.current||b.source!=this||!(this.current.id in this.selection))))},onDndStart:function(b,c,e){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==b?e?"Copied":"Moved":"");c=this.accept&&this.checkAcceptance(b,c);this._changeState("Target",c?"":"Disabled");this==b&&a.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,b,c,e){if(this==e)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=
null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,b,c){var f=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return f.call(this,a.getItem(b.id).data,c)}:c?function(b){var c=a.getItem(b.id);b=b.cloneNode(!0);b.id=e.getUniqueId();return{node:b,data:c.data,type:c.type}}:function(b){var c=a.getItem(b.id);
a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();c||this.creator||a.selectNone();this.insertNodes(!0,b,this.before,this.current);!c&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=f},onDropInternal:function(a,b){var c=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(b)this._normalizedCreator=this.creator?function(a,b){return c.call(this,this.getItem(a.id).data,b)}:function(a){var b=this.getItem(a.id);a=a.cloneNode(!0);a.id=e.getUniqueId();
return{node:a,data:b.data,type:b.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=c}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){c.superclass.onOverEvent.call(this);a.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){c.superclass.onOutEvent.call(this);
a.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){if(this.current!=this.targetAnchor||this.before!=a)this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After")},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,
this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!u.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(n.contains(a,"dojoDndHandle"))return!0;if(n.contains(a,"dojoDndItem")||n.contains(a,"dojoDndIgnore"))break}return!1}});return c})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){var c=g("dojo.dnd.Selector",a,{constructor:function(a,b){b||(b={});this.singular=b.singular;this.autoSync=b.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;this.events.push(f(this.node,e.press,v.hitch(this,"onMouseDown")),f(this.node,e.release,v.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new k,c=b._empty,e;for(e in this.selection)e in c||a.push(n.byId(e));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},
selectAll:function(){this.forInItems(function(a,b){this._addItemClass(n.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=b._empty,c;for(c in this.selection)if(!(c in a)){var e=n.byId(c);this.delItem(c);m.destroy(e)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,c){c=c||t.global;var e=this.selection,f=b._empty,g;for(g in e)g in f||a.call(c,this.getItem(g),g,this)},sync:function(){c.superclass.sync.call(this);
this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],e=b._empty,f;for(f in this.selection)f in e||this.getItem(f)||a.push(f);p.forEach(a,function(a){delete this.selection[a]},this);return this},insertNodes:function(a,b,e,f){var g=this._normalizedCreator;this._normalizedCreator=function(b,c){b=g.call(this,b,c);a?(this.anchor?this.anchor!=b.node&&(this._removeItemClass(b.node,"Anchor"),this._addItemClass(b.node,"Selected")):(this.anchor=b.node,this._removeItemClass(b.node,"Selected"),
this._addItemClass(this.anchor,"Anchor")),this.selection[b.node.id]=1):(this._removeItemClass(b.node,"Selected"),this._removeItemClass(b.node,"Anchor"));return b};c.superclass.insertNodes.call(this,b,e,f);this._normalizedCreator=g;return this},destroy:function(){c.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!b.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=
!0,u.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){b.getCopyKeyState(a)||this._removeSelection();var c=this.getAllNodes();if(c.length&&(this.anchor||(this.anchor=c[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var e=0,f;e<c.length&&(f=c[e],f!=this.anchor&&f!=this.current);++e);for(++e;e<c.length;++e){f=c[e];if(f==this.anchor||f==this.current)break;this._addItemClass(f,"Selected");this.selection[f.id]=
1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?b.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):b.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):
(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&
(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=f(this.node,e.move,v.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=b._empty,c;for(c in this.selection)if(!(c in a)){var e=n.byId(c);e&&this._removeItemClass(e,"Selected")}this.selection=
{};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return c})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){g=g("dojo.dnd.Container",f,{skipForm:!1,allowNested:!1,constructor:function(a,e){this.node=m.byId(a);
e||(e={});this.creator=e.creator||null;this.skipForm=e.skipForm;this.parent=e.dropParent&&m.byId(e.dropParent);this.map={};this.current=null;this.containerState="";u.add(this.node,"dojoDndContainer");e&&e._skipStartup||this.startup();this.events=[b(this.node,c.over,v.hitch(this,"onMouseOver")),b(this.node,c.out,v.hitch(this,"onMouseOut")),b(this.node,"dragstart",v.hitch(this,"onSelectStart")),b(this.node,"selectstart",v.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},
setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(a,b){b=b||t.global;var c=this.map,e=x._empty,f;for(f in c)f in e||a.call(b,c[f],f,this);return b},clearItems:function(){this.map={}},getAllNodes:function(){return a((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var a={};this.getAllNodes().forEach(function(b){if(b.id){var c=this.getItem(b.id);if(c){a[b.id]=c;return}}else b.id=x.getUniqueId();var c=b.getAttribute("dndType"),
e=b.getAttribute("dndData");a[b.id]={data:e||b.innerHTML,type:c?c.split(/\s*,\s*/):["text"]}},this);this.map=a;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var e;if(c)for(b=0;b<a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),c.parentNode.insertBefore(e.node,c);else for(b=0;b<a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),this.parent.appendChild(e.node);
return this},destroy:function(){p.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var a=this.parent.getElementsByTagName("tbody");a&&a.length&&(this.parent=a[0])}this.defaultCreator=x._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&
b!=this.node;)try{b=b.parentNode}catch(C){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(q){a=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(a){this.withHandles||
this.skipForm&&x.isFormElement(a)||(a.stopPropagation(),a.preventDefault())},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var c="dojoDnd"+a;a=a.toLowerCase()+"State";u.replace(this.node,c+b,c+this[a]);this[a]=b},_addItemClass:function(a,b){u.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){u.remove(a,"dojoDndItem"+b)},_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&u.contains(a,"dojoDndItem"))return a;
return null},_normalizedCreator:function(a,b){a=(this.creator||this.defaultCreator).call(this,a,b);v.isArray(a.type)||(a.type=["text"]);a.node.id||(a.node.id=x.getUniqueId());u.add(a.node,"dojoDndItem");return a}});x._createNode=function(a){return a?function(b){return k.create(a,{innerHTML:b})}:x._createSpan};x._createTrTd=function(a){var b=k.create("tr");k.create("td",{innerHTML:a},b);return b};x._createSpan=function(a){return k.create("span",{innerHTML:a})};x._defaultCreatorNodes={ul:"li",ol:"li",
div:"div",p:"div"};x._defaultCreator=function(a){a=a.tagName.toLowerCase();var b="tbody"==a||"thead"==a?x._createTrTd:x._createNode(x._defaultCreatorNodes[a]);return function(a,c){var e=a&&v.isObject(a),f;e&&a.tagName&&a.nodeType&&a.getAttribute?(f=a.getAttribute("dndData")||a.innerHTML,e=(e=a.getAttribute("dndType"))?e.split(/\s*,\s*/):["text"]):(f=e&&a.data?a.data:a,e=e&&a.type?a.type:["text"],a=("avatar"==c?x._createSpan:b)(String(f)));a.id||(a.id=x.getUniqueId());return{node:a,data:f,type:e}}};
return g})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){var w=g("dojo.dnd.Manager",[m],{constructor:function(){this.source=this.avatar=null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:u("touch")?4:16,OFFSET_Y:u("touch")?4:16,overSource:function(a){this.avatar&&
(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=!!this.target,this.avatar.update());e.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),e.publish("/dnd/source/over",null)):e.publish("/dnd/source/over",null)},startDrag:function(a,g,k){function m(a){a.preventDefault();a.stopPropagation()}c.autoScrollStart(v.doc);this.source=a;this.nodes=g;this.copy=!!k;this.avatar=this.makeAvatar();v.body().appendChild(this.avatar.node);
e.publish("/dnd/start",a,g,this.copy);this.events=[f(v.doc,b.move,t.hitch(this,"onMouseMove")),f(v.doc,b.release,t.hitch(this,"onMouseUp")),f(v.doc,"keydown",t.hitch(this,"onKeyDown")),f(v.doc,"keyup",t.hitch(this,"onKeyUp")),f(v.doc,"dragstart",m),f(v.body(),"selectstart",m)];a="dojoDnd"+(k?"Copy":"Move");n.add(v.body(),a)},canDrop:function(a){a=!(!this.target||!a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){n.remove(v.body(),["dojoDndCopy","dojoDndMove"]);
p.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new x(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(b){var e=this.avatar;e&&(c.autoScrollNodes(b),e=e.node.style,e.left=b.pageX+this.OFFSET_X+"px",e.top=b.pageY+this.OFFSET_Y+"px",e=!!this.source.copyState(a.getCopyKeyState(b)),this.copy!=e&&this._setCopyStatus(e));u("touch")&&b.preventDefault()},onMouseUp:function(b){if(this.avatar){if(this.target&&
this.canDropFlag){var c=!!this.source.copyState(a.getCopyKeyState(b));e.publish("/dnd/drop/before",this.source,this.nodes,c,this.target,b);e.publish("/dnd/drop",this.source,this.nodes,c,this.target,b)}else e.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case k.CTRL:a=!!this.source.copyState(!0);this.copy!=a&&this._setCopyStatus(a);break;case k.ESCAPE:e.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==k.CTRL&&(a=
!!this.source.copyState(!1),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();n.replace(v.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?"Move":"Copy"))}});a._manager=null;w.manager=a.manager=function(){a._manager||(a._manager=new w);return a._manager};return w})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),
function(p,g,t,v,n,m,u,k){return p("dojo.dnd.Avatar",null,{constructor:function(f){this.manager=f;this.construct()},construct:function(){var f=m.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",margin:"0px"}}),e=this.manager.source,b,a=m.create("tbody",null,f),c=m.create("tr",null,a),g=m.create("td",null,c),k=Math.min(5,this.manager.nodes.length),n=0;u("highcontrast")&&m.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},g);m.create("span",{innerHTML:e.generateText?
this._generateText():""},g);for(v.set(c,{"class":"dojoDndAvatarHeader",style:{opacity:.9}});n<k;++n)e.creator?b=e._normalizedCreator(e.getItem(this.manager.nodes[n].id).data,"avatar").node:(b=this.manager.nodes[n].cloneNode(!0),"tr"==b.tagName.toLowerCase()&&(c=m.create("table"),m.create("tbody",null,c).appendChild(b),b=c)),b.id="",c=m.create("tr",null,a),g=m.create("td",null,c),g.appendChild(b),v.set(c,{"class":"dojoDndAvatarItem",style:{opacity:(9-n)/10}});this.node=f},destroy:function(){m.destroy(this.node);
this.node=!1},update:function(){n.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(u("highcontrast")){var f=t.byId("a11yIcon"),e="+";this.manager.canDropFlag&&!this.manager.copy?e="\x3c ":this.manager.canDropFlag||this.manager.copy?this.manager.canDropFlag||(e="x"):e="o";f.innerHTML=e}k("tr.dojoDndAvatarHeader td span"+(u("highcontrast")?" span":""),this.node).forEach(function(b){b.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},
"builder/dijit/RefreshInterval":function(){define("dojo/on dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/RefreshInterval.html jimu/utils dijit/form/Select dijit/form/NumberTextBox".split(" "),function(p,g,t,v,n,m,u,k,f,e){return n([m,u,k,g],{templateString:f,baseClass:"refresh-interval",handle1:null,handle2:null,lastRefreshInterval:null,defaultRefreshInterval:{useWebMapRefreshInterval:!0},
defaultRefreshTip:"",singleRefreshTip:"",postMixInProperties:function(){this.nls=window.builderNls;this.defaultRefreshTip||(this.defaultRefreshTip=this.nls.defaultRefreshTip);this.singleRefreshTip||(this.singleRefreshTip=this.nls.singleRefreshTip)},postCreate:function(){this.inherited(arguments);this.refreshSelect.dropDown&&this.refreshSelect.dropDown.domNode&&t.addClass(this.refreshSelect.dropDown.domNode,"refresh-interval-select-dropdown");this.lastRefreshInterval=this.defaultRefreshInterval;this._bindEvents()},
getValue:function(){var b=null;"defaultRefresh"===this.refreshSelect.get("value")?(b={useWebMapRefreshInterval:!0},t.addClass(this.refreshIntervalInputs,"hidden")):(t.removeClass(this.refreshIntervalInputs,"hidden"),b=this.refreshIntervalNTB.get("value"),b=0<=b&&this.refreshIntervalNTB.validate()?{useWebMapRefreshInterval:!1,minutes:b}:null);return b},setValue:function(b){b||(b=this.defaultRefreshInterval);this.lastRefreshInterval=b;this._releaseEvents();b.useWebMapRefreshInterval?this.refreshSelect.set("value",
"defaultRefresh"):(this.refreshSelect.set("value","singleRefresh"),this.refreshIntervalNTB.set("value",b.minutes));this._bindEvents()},reset:function(){this.setValue(this.defaultRefreshInterval)},_releaseEvents:function(){this.handle1&&this.handle1.remove();this.handle2&&this.handle2.remove();this.handle2=this.handle1=null},_bindEvents:function(){this._releaseEvents();this.handle1=p(this.refreshSelect,"change",v.hitch(this,this._onChanged));this.handle2=p(this.refreshIntervalNTB,"change",v.hitch(this,
this._onChanged))},_onChanged:function(){var b=this.getValue();b&&!e.isEqual(b,this.lastRefreshInterval)&&(this.lastRefreshInterval=b,this.emit("user-input-change",b))},destroy:function(){this._releaseEvents();this.inherited(arguments)}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(p,g,t,v,n){var m=g.NodeList,u={},k=0,f=function(a){var b=n.get(a,"data-dojo-dataid");b||(b="pid"+k++,n.set(a,"data-dojo-dataid",b));return b},
e=p._nodeData=function(a,b,e){var c=f(a),g;u[c]||(u[c]={});if(1==arguments.length)return u[c];"string"==typeof b?2<arguments.length?u[c][b]=e:g=u[c][b]:g=t.mixin(u[c],b);return g},b=p._removeNodeData=function(a,b){a=f(a);u[a]&&(b?delete u[a][b]:delete u[a])};m._gcNodeData=p._gcNodeData=function(){var a=g("[data-dojo-dataid]").map(f),b;for(b in u)0>v.indexOf(a,b)&&delete u[b]};t.extend(m,{data:m._adaptWithCondition(e,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:m._adaptAsForEach(b)});
return m})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector jimu/utils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a){return p([g,t],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:'\x3cdiv role\x3d"button" tabindex\x3d"0"data-dojo-attach-event\x3d"onclick:_domNodeClick,onkeydown:_domNodeKeydown" aria-pressed\x3d"false"\x3e\x3c/div\x3e',
_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof k||(this.color=new k(this.color)):this.color=new k("#ccc");n.setStyle(this.domNode,"backgroundColor",this.color.toHex());this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){e.close(this.tooltipDialog);
this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;return a===b||n.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},_showTooltipDialog:function(){e.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0;this.picker.cursorNode.focus()},_hideTooltipDialog:function(){this._isTooltipDialogOpened=!1;this.onClose();e.close(this.tooltipDialog)},
_createTooltipDialog:function(){var a=n.create("div");this.tooltipDialog=new f({content:a});n.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");this.own(m(this.tooltipDialog.domNode,"keydown",v.hitch(this,function(a){a.keyCode===u.ESCAPE&&(this._hideTooltipDialog(),this.domNode.focus(),n.setAttr(this.domNode,"aria-pressed","false"))})));var e=new b({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:v.hitch(this,function(a){this.ensureMode||
(a=new k(a),this.setColor(a))})});e.placeAt(a);e.startup();if(this.ensureMode){var g=n.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing",title:this.nls.cancel,innerHTML:this.nls.cancel},a);this.own(m(g,"click",v.hitch(this,function(){this._hideTooltipDialog()})));"undefined"===typeof this.showOk&&(g=n.create("div",{"class":"jimu-btn jimu-float-trailing ok",title:this.nls.ok,innerHTML:this.nls.ok},a),this.own(m(g,"click",v.hitch(this,function(){var a=this.picker.get("value");this.setColor(new k(a));
this._hideTooltipDialog()}))));a=n.create("div",{"class":"jimu-btn jimu-float-trailing",title:this.nls.apply,innerHTML:this.nls.apply},a);this.own(m(a,"click",v.hitch(this,function(){var a=this.picker.get("value");this.setColor(new k(a))})))}this.own(m(document.body,"click",v.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})));this.picker=e},_domNodeClick:function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?(this._hideTooltipDialog(),
n.setAttr(this.domNode,"aria-pressed","false")):(this._showTooltipDialog(),n.setAttr(this.domNode,"aria-pressed","true"))},_domNodeKeydown:function(a){a.keyCode!==u.ENTER&&a.keyCode!==u.SPACE||this._domNodeClick(a)},setColor:function(a,b){if(a instanceof k){var c=this.color,e="";c&&(e=c.toHex());c=a.toHex();this.color=a;n.setStyle(this.domNode,"backgroundColor",c);if(e!==c&&(this.picker.set("value",c),!1!==b))this.onChange(new k(c))}},getColor:function(){return this.color},_changeLabel:function(b){n.empty(this.domNode);
n.create("span",{innerHTML:b.toHex(),className:"color-label",style:{color:a.invertColor(b.toHex())}},this.domNode)},onChange:function(a){this.showLabel&&this._changeLabel(a)},onClose:function(){},getPopup:function(){return this.tooltipDialog||null},setLabel:function(a){n.empty(this.domNode);n.create("span",{innerHTML:a||"",className:"text-label"},this.domNode)},isTooltipDialogOpened:function(){return this._isTooltipDialogOpened}})})},"jimu/dijit/ColorSelector":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dojox/widget/ColorPicker dijit/_base/focus dojo/fx dojo/_base/lang dojo/_base/html dojo/sniff".split(" "),
function(p,g,t,v,n,m,u,k,f){return g([t,v,p],{baseClass:"jimu-color-selector",declaredClass:"jimu.dijit.ColorSelector",_setPoint:function(e){e&&n.focus(e.target);if(!this._CURSOR_WIDTH||!this._CURSOR_HEIGHT){var b=k.getMarginBox(this.cursorNode);b.w&&b.h&&(this._CURSOR_WIDTH=b.w/2,this._CURSOR_HEIGHT=b.h/2)}this._BORDER_WIDTH&&this._BORDER_HEIGHT||(b=k.getBorderExtents(e.target||e.srcElement),b.w&&b.h&&(this._BORDER_WIDTH=b.w,this._BORDER_HEIGHT=b.h));var a=b=0;f("ff")||f("ie")||f("MSIE")?(b=e.offsetX,
a=e.offsetY):e.offsetX&&e.offsetY&&(b=e.offsetX+this._BORDER_WIDTH,a=e.offsetY+this._BORDER_HEIGHT);e=a-this._CURSOR_HEIGHT;b-=this._CURSOR_WIDTH;this.animatePoint?m.slideTo({node:this.cursorNode,duration:this.slideDuration,top:e,left:b,onEnd:u.hitch(this,function(){this._updateColor(!0);n.focus(this.cursorNode)})}).play():(k.style(this.cursorNode,{left:b+"px",top:e+"px"}),this._updateColor(!0))},_setHuePoint:function(e){e=e.offsetY-this.PICKER_HUE_SELECTOR_H/2;this.animatePoint?m.slideTo({node:this.hueCursorNode,
duration:this.slideDuration,top:e,left:0,onEnd:u.hitch(this,function(){this._updateColor(!0);n.focus(this.hueCursorNode)})}).play():(k.style(this.hueCursorNode,"top",e+"px"),this._updateColor(!0))}})})},"dojox/widget/ColorPicker":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){p.experimental("dojox.widget.ColorPicker");return g("dojox.widget.ColorPicker",C,{showRgb:!0,showHsv:!0,showHex:!0,webSafe:!0,animatePoint:!0,slideDuration:250,liveUpdate:!1,PICKER_HUE_H:150,PICKER_SAT_VAL_H:150,PICKER_SAT_VAL_W:150,PICKER_HUE_SELECTOR_H:8,PICKER_SAT_SELECTOR_H:10,PICKER_SAT_SELECTOR_W:10,value:"#ffffff",_underlay:require.toUrl("dojox/widget/ColorPicker/images/underlay.png"),_hueUnderlay:require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
_pickerPointer:require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"),_huePickerPointer:require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"),_huePickerPointerAlly:require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"),templateString:D,postMixInProperties:function(){b.contains(k.body(),"dijit_a11y")&&(this._huePickerPointer=this._huePickerPointerAlly);this._uId=w.getUniqueId(this.id);t.mixin(this,B.getLocalization("dojox.widget","ColorPicker"));t.mixin(this,B.getLocalization("dojo.cldr",
"number"));this.inherited(arguments)},postCreate:function(){this.inherited(arguments);7>u("ie")&&(this.colorUnderlay.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'"+this._underlay+"', sizingMethod\x3d'scale')",this.colorUnderlay.src=this._blankGif.toString());this.showRgb||(this.rgbNode.style.visibility="hidden");this.showHsv||(this.hsvNode.style.visibility="hidden");this.showHex||(this.hexNode.style.visibility="hidden");this.webSafe||(this.safePreviewNode.style.visibility=
"hidden")},startup:function(){this._started||(this._started=!0,this.set("value",this.value),this._mover=new x.boxConstrainedMoveable(this.cursorNode,{box:{t:-(this.PICKER_SAT_SELECTOR_H/2),l:-(this.PICKER_SAT_SELECTOR_W/2),w:this.PICKER_SAT_VAL_W,h:this.PICKER_SAT_VAL_H}}),this._hueMover=new x.boxConstrainedMoveable(this.hueCursorNode,{box:{t:-(this.PICKER_HUE_SELECTOR_H/2),l:0,w:0,h:this.PICKER_HUE_H}}),this._subs=[],this._subs.push(m.subscribe("/dnd/move/stop",t.hitch(this,"_clearTimer"))),this._subs.push(m.subscribe("/dnd/move/start",
t.hitch(this,"_setTimer"))),this._keyListeners=[],this._connects.push(z.addKeyListener(this.hueCursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(z.addKeyListener(this.hueCursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateHueCursorNode),25,25)),this._connects.push(z.addKeyListener(this.cursorNode,{charOrCode:a.UP_ARROW,shiftKey:!1,metaKey:!1,
ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateCursorNode),25,25)),this._connects.push(z.addKeyListener(this.cursorNode,{charOrCode:a.DOWN_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateCursorNode),25,25)),this._connects.push(z.addKeyListener(this.cursorNode,{charOrCode:a.LEFT_ARROW,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateCursorNode),25,25)),this._connects.push(z.addKeyListener(this.cursorNode,{charOrCode:a.RIGHT_ARROW,shiftKey:!1,
metaKey:!1,ctrlKey:!1,altKey:!1},this,t.hitch(this,this._updateCursorNode),25,25)))},_setValueAttr:function(a,b){this._started&&this.setColor(a,b)},setColor:function(a,b){a=E.fromString(a);this._updatePickerLocations(a);this._updateColorInputs(a);this._updateValue(a,b)},_setTimer:function(a){if(a.node==this.cursorNode||a.node==this.hueCursorNode)q.focus(a.node),e.setSelectable(this.domNode,!1),this._timer=setInterval(t.hitch(this,"_updateColor"),45)},_clearTimer:function(a){this._timer&&(clearInterval(this._timer),
this._timer=null,this.onChange(this.value),e.setSelectable(this.domNode,!0))},_setHue:function(a){n.style(this.colorUnderlay,"backgroundColor",E.fromHsv(a,100,100).toHex())},_updateHueCursorNode:function(b,c,e){if(-1!==b){b=n.style(this.hueCursorNode,"top");c=this.PICKER_HUE_SELECTOR_H/2;b+=c;var f=!1;e.charOrCode==a.UP_ARROW?0<b&&(--b,f=!0):e.charOrCode==a.DOWN_ARROW&&b<this.PICKER_HUE_H&&(b+=1,f=!0);f&&n.style(this.hueCursorNode,"top",b-c+"px")}else this._updateColor(!0)},_updateCursorNode:function(b,
c,e){c=this.PICKER_SAT_SELECTOR_H/2;var f=this.PICKER_SAT_SELECTOR_W/2;if(-1!==b){b=n.style(this.cursorNode,"top");var g=n.style(this.cursorNode,"left");b+=c;var g=g+f,k=!1;e.charOrCode==a.UP_ARROW?0<b&&(--b,k=!0):e.charOrCode==a.DOWN_ARROW?b<this.PICKER_SAT_VAL_H&&(b+=1,k=!0):e.charOrCode==a.LEFT_ARROW?0<g&&(--g,k=!0):e.charOrCode==a.RIGHT_ARROW&&g<this.PICKER_SAT_VAL_W&&(g+=1,k=!0);k&&(g-=f,n.style(this.cursorNode,"top",b-c+"px"),n.style(this.cursorNode,"left",g+"px"))}else this._updateColor(!0)},
_updateColor:function(a){var b=this.PICKER_HUE_SELECTOR_H/2,c=this.PICKER_SAT_SELECTOR_H/2,e=this.PICKER_SAT_SELECTOR_W/2,b=n.style(this.hueCursorNode,"top")+b,c=n.style(this.cursorNode,"top")+c,e=n.style(this.cursorNode,"left")+e,b=Math.round(360-b/this.PICKER_HUE_H*360),e=E.fromHsv(b,e/this.PICKER_SAT_VAL_W*100,100-c/this.PICKER_SAT_VAL_H*100);this._updateColorInputs(e);this._updateValue(e,a);b!=this._hue&&this._setHue(b)},_colorInputChange:function(a){var b,c=!1;switch(a.target){case this.hexCode:b=
E.fromString(a.target.value);c=!0;break;case this.Rval:case this.Gval:case this.Bval:b=E.fromArray([this.Rval.value,this.Gval.value,this.Bval.value]);c=!0;break;case this.Hval:case this.Sval:case this.Vval:b=E.fromHsv(this.Hval.value,this.Sval.value,this.Vval.value),c=!0}c&&(this._updatePickerLocations(b),this._updateColorInputs(b),this._updateValue(b,!0))},_updateValue:function(a,b){a=a.toHex();this.value=this.valueNode.value=a;if(b&&(!this._timer||this.liveUpdate))this.onChange(a)},_updatePickerLocations:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2,e=this.PICKER_SAT_SELECTOR_H/2,f=this.PICKER_SAT_SELECTOR_W/2;a=a.toHsv();b=Math.round(this.PICKER_HUE_H-a.h/360*this.PICKER_HUE_H)-b;f=Math.round(a.s/100*this.PICKER_SAT_VAL_W)-f;e=Math.round(this.PICKER_SAT_VAL_H-a.v/100*this.PICKER_SAT_VAL_H)-e;this.animatePoint?(c.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:b,left:0}).play(),c.slideTo({node:this.cursorNode,duration:this.slideDuration,top:e,left:f}).play()):(n.style(this.hueCursorNode,"top",b+"px"),
n.style(this.cursorNode,{left:f+"px",top:e+"px"}));a.h!=this._hue&&this._setHue(a.h)},_updateColorInputs:function(a){var b=a.toHex();this.showRgb&&(this.Rval.value=a.r,this.Gval.value=a.g,this.Bval.value=a.b);this.showHsv&&(a=a.toHsv(),this.Hval.value=Math.round(a.h),this.Sval.value=Math.round(a.s),this.Vval.value=Math.round(a.v));this.showHex&&(this.hexCode.value=b);this.previewNode.style.backgroundColor=b;this.webSafe&&(this.safePreviewNode.style.backgroundColor=b)},_setHuePoint:function(a){var b=
this.PICKER_HUE_SELECTOR_H/2;a=a.layerY||a.y-a.target.getBoundingClientRect().top;a-=b;this.animatePoint?c.slideTo({node:this.hueCursorNode,duration:this.slideDuration,top:a,left:0,onEnd:t.hitch(this,function(){this._updateColor(!0);q.focus(this.hueCursorNode)})}).play():(n.style(this.hueCursorNode,"top",a+"px"),this._updateColor(!0))},_setPoint:function(a){var b=this.PICKER_SAT_SELECTOR_H/2,e=this.PICKER_SAT_SELECTOR_W/2,f=a.layerY||a.y-a.target.getBoundingClientRect().top,f=f-b,b=a.layerX||a.x-
a.target.getBoundingClientRect().left,b=b-e;a&&q.focus(a.target);this.animatePoint?c.slideTo({node:this.cursorNode,duration:this.slideDuration,top:f,left:b,onEnd:t.hitch(this,function(){this._updateColor(!0);q.focus(this.cursorNode)})}).play():(n.style(this.cursorNode,{left:b+"px",top:f+"px"}),this._updateColor(!0))},_handleKey:function(a){},focus:function(){this.focused||q.focus(this.focusNode)},_stopDrag:function(a){f.stop(a)},destroy:function(){this.inherited(arguments);v.forEach(this._subs,function(a){m.unsubscribe(a)});
delete this._subs}})})},"dojox/color":function(){define(["./color/_base"],function(p){return p})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(p,g,t,v){p=g.getObject("color",!0,p);p.Color=t;p.blend=t.blendColors;p.fromRgb=t.fromRgb;p.fromHex=t.fromHex;p.fromArray=t.fromArray;p.fromString=t.fromString;p.greyscale=v.makeGrey;g.mixin(p,{fromCmy:function(n,m,p){g.isArray(n)?(m=n[1],p=n[2],n=n[0]):g.isObject(n)&&(m=n.m,p=n.y,n=n.c);return new t({r:Math.round(255*
(1-n/100)),g:Math.round(255*(1-m/100)),b:Math.round(255*(1-p/100))})},fromCmyk:function(n,m,p,k){g.isArray(n)?(m=n[1],p=n[2],k=n[3],n=n[0]):g.isObject(n)&&(m=n.m,p=n.y,k=n.b,n=n.c);k/=100;return new t({r:Math.round(255*(1-Math.min(1,n/100*(1-k)+k))),g:Math.round(255*(1-Math.min(1,m/100*(1-k)+k))),b:Math.round(255*(1-Math.min(1,p/100*(1-k)+k)))})},fromHsl:function(n,m,p){g.isArray(n)?(m=n[1],p=n[2],n=n[0]):g.isObject(n)&&(m=n.s,p=n.l,n=n.h);m/=100;for(p/=100;0>n;)n+=360;for(;360<=n;)n-=360;var k,f;
120>n?(k=(120-n)/60,f=n/60,n=0):240>n?(k=0,f=(240-n)/60,n=(n-120)/60):(k=(n-240)/60,f=0,n=(360-n)/60);k=2*m*Math.min(k,1)+(1-m);f=2*m*Math.min(f,1)+(1-m);n=2*m*Math.min(n,1)+(1-m);.5>p?(k*=p,f*=p,n*=p):(k=(1-p)*k+2*p-1,f=(1-p)*f+2*p-1,n=(1-p)*n+2*p-1);return new t({r:Math.round(255*k),g:Math.round(255*f),b:Math.round(255*n)})}});p.fromHsv=function(n,m,p){g.isArray(n)?(m=n[1],p=n[2],n=n[0]):g.isObject(n)&&(m=n.s,p=n.v,n=n.h);360==n&&(n=0);m/=100;p/=100;var k,f,e;if(0==m)f=e=k=p;else{var b=n/60;n=Math.floor(b);
var a=b-n,b=p*(1-m),c=p*(1-m*a);m=p*(1-m*(1-a));switch(n){case 0:k=p;f=m;e=b;break;case 1:k=c;f=p;e=b;break;case 2:k=b;f=p;e=m;break;case 3:k=b;f=c;e=p;break;case 4:k=m;f=b;e=p;break;case 5:k=p,f=b,e=c}}return new t({r:Math.round(255*k),g:Math.round(255*f),b:Math.round(255*e)})};g.extend(t,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var g,m=this.r/255,p=this.g/255,k=this.b/255;g=Math.min(1-m,1-p,1-
k);return{c:Math.round((1-m-g)/(1-g)*100),m:Math.round((1-p-g)/(1-g)*100),y:Math.round((1-k-g)/(1-g)*100),b:Math.round(100*g)}},toHsl:function(){var g=this.r/255,m=this.g/255,p=this.b/255,k=Math.min(g,p,m),f=Math.max(g,m,p),e=f-k,b=0,a=0,k=(k+f)/2;0<k&&1>k&&(a=e/(.5>k?2*k:2-2*k));0<e&&(f==g&&f!=m&&(b+=(m-p)/e),f==m&&f!=p&&(b+=2+(p-g)/e),f==p&&f!=g&&(b+=4+(g-m)/e),b*=60);return{h:b,s:Math.round(100*a),l:Math.round(100*k)}},toHsv:function(){var g=this.r/255,m=this.g/255,p=this.b/255,k=Math.max(g,m,
p),f=k-Math.min(g,p,m),e=null,b=0==k?0:f/k;0==b?e=0:(e=g==k?60*(m-p)/f:m==k?120+60*(p-g)/f:240+60*(g-m)/f,0>e&&(e+=360));return{h:e,s:Math.round(100*b),v:Math.round(100*k)}}});return p})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w){p=t("dijit._editor.plugins._FontDropDown",[e,b,a],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:p,postMixInProperties:function(){this.inherited(arguments);this.strings=n.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=f.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new k({idProperty:"value",data:g.map(this.values,function(a){var b=this.strings[a]||a;return{label:this.getLabel(a,b),name:b,value:a}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(a,b){b=!1!==b;this.select.set("value",0>g.indexOf(this.values,a)?"":a,b);b||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(a){this._set("disabled",a);this.select.set("disabled",a)}});var q=t("dijit._editor.plugins._FontNameDropDown",p,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(a,b){return this.plainText?b:"\x3cdiv style\x3d'font-family: "+a+"'\x3e"+b+"\x3c/div\x3e"},_normalizeFontName:function(a){var b=this.values;if(!a||!b)return a;var c=a.split(",");if(1<c.length)for(var e=0,f=c.length;e<f;e++){var k=u.trim(c[e]);if(-1<g.indexOf(b,k))return k}return a},_setValueAttr:function(a,b){b=!1!==
b;a=this._normalizeFontName(a);this.generic&&(a={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[a]||a);this.inherited(arguments,[a,b])}}),C=t("dijit._editor.plugins._FontSizeDropDown",p,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(a,
b){return this.plainText?b:"\x3cfont size\x3d"+a+"'\x3e"+b+"\x3c/font\x3e"},_setValueAttr:function(a,b){b=!1!==b;a.indexOf&&-1!=a.indexOf("px")&&(a={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(a,10)]||a);this.inherited(arguments,[a,b])}}),z=t("dijit._editor.plugins._FormatBlockDropDown",p,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(a,b){return this.plainText||
"noFormat"==a?b:"\x3c"+a+"\x3e"+b+"\x3c/"+a+"\x3e"},_execCommand:function(a,b,c){if("noFormat"===c){var e;if((b=w.getSelection(a.window))&&0<b.rangeCount){c=b.getRangeAt(0);var f;if(c){b=c.startContainer;for(e=c.endContainer;b&&b!==a.editNode&&b!==a.document.body&&1!==b.nodeType;)b=b.parentNode;for(;e&&e!==a.editNode&&e!==a.document.body&&1!==e.nodeType;)e=e.parentNode;var k=m.hitch(this,function(b,c){if(b.childNodes&&b.childNodes.length){var e;for(e=0;e<b.childNodes.length;e++){var f=b.childNodes[e];
if(1==f.nodeType&&a.selection.inSelection(f)){var m=f.tagName?f.tagName.toLowerCase():"";-1!==g.indexOf(this.values,m)&&c.push(f);k(f,c)}}}});c=m.hitch(this,function(b){if(b&&b.length){for(a.beginEditing();b.length;)this._removeFormat(a,b.pop());a.endEditing()}});var n=[];if(b==e){var p;for(e=b;e&&e!==a.editNode&&e!==a.document.body;){if(1==e.nodeType&&(f=e.tagName?e.tagName.toLowerCase():"",-1!==g.indexOf(this.values,f))){p=e;break}e=e.parentNode}k(b,n);p&&(n=[p].concat(n))}else for(e=b;a.selection.inSelection(e);)1==
e.nodeType&&(f=e.tagName?e.tagName.toLowerCase():"",-1!==g.indexOf(this.values,f)&&n.push(e),k(e,n)),e=e.nextSibling;c(n);a.onDisplayChanged()}}}else a.execCommand(b,c)},_removeFormat:function(a,b){if(a.customUndo){for(;b.firstChild;)v.place(b.firstChild,b,"before");b.parentNode.removeChild(b)}else{a.selection.selectElementChildren(b);var c=a.selection.getSelectedHtml();a.selection.selectElement(b);a.execCommand("inserthtml",c||"")}}}),E=t("dijit._editor.plugins.FontChoice",x,{useDefaultCommand:!1,
_initButton:function(){var a={fontName:q,fontSize:C,formatBlock:z}[this.command],b=this.params;this.params.custom&&(b.values=this.params.custom);var c=this.editor;this.button=new a(m.delegate({dir:c.dir,lang:c.lang},b));this.own(this.button.select.on("change",m.hitch(this,function(a){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=a.indexOf(" ")&&(a="'"+a+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,a):this.editor.execCommand(this.command,
a)})))},updateState:function(){var a=this.editor,b=this.command;if(a&&a.isLoaded&&b.length&&this.button){var c=this.get("disabled");this.button.set("disabled",c);if(!c){var e;try{e=a.queryCommandValue(b)||""}catch(K){e=""}(c=m.isString(e)&&(e.match(/'([^']*)'/)||e.match(/"([^"]*)"/)))&&(e=c[1]);"fontSize"!==b||e||(e=3);if("formatBlock"===b)if(e&&"p"!=e)0>g.indexOf(this.button.values,e)&&(e="noFormat");else{e=null;var f;(b=w.getSelection(this.editor.window))&&0<b.rangeCount&&(b=b.getRangeAt(0))&&(f=
b.endContainer);for(;f&&f!==a.editNode&&f!==a.document;){if((b=f.tagName?f.tagName.toLowerCase():"")&&-1<g.indexOf(this.button.values,b)){e=b;break}f=f.parentNode}e||(e="noFormat")}e!==this.button.get("value")&&this.button.set("value",e,!1)}}}});g.forEach(["fontName","fontSize","formatBlock"],function(a){x.registry[a]=function(b){return new E({command:a,plainText:b.plainText})}});E._FontDropDown=p;E._FontNameDropDown=q;E._FontSizeDropDown=C;E._FormatBlockDropDown=z;return E})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(p,g,t,v,n,m){g.experimental("dijit.editor.plugins.EditorTextColor");var u=v("dijit.editor.plugins.EditorTextColor",n,{buttonClass:m,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var g="",f=!1;this.params.custom&&(this.params.custom.recordUID&&(g=this.params.custom.recordUID),this.params.custom.forceAttr&&(f=this.params.custom.forceAttr));var e=this;this.button.set("iconClass",
this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(b){function a(a){e.button.dropDown=new a({dir:e.editor.dir,ownerDocument:e.editor.ownerDocument,value:e.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:g,onChange:function(a){e.editor.execCommand("useCSS",f);e.editor.execCommand("styleWithCSS",!f);e.editor.execCommand(e.hackCommand,
a)},onClose:function(){e.button.closeDropDown()}});b()}"string"===typeof e.colorPicker?p([e.colorPicker],a):a(e.colorPicker)}},updateState:function(){var g=this.editor,f=this.hackCommand;if(g&&g.isLoaded&&f.length){var e;if(this.button){var b=this.get("disabled");this.button.set("disabled",b);if(b)return;try{e=g.queryCommandValue(f)||""}catch(a){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(g=this.button.dropDown)&&g.getColor&&e!==g.getColor()&&(g.refreshRecords(),
g.setColor(e))}}});g.subscribe(t._scopeName+".Editor.getPlugin",null,function(g){if(!g.plugin)switch(g.args.name){case "editorTextColor":g.plugin=new u}});return u})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(p,g,t,v,n,m){g.experimental("dijit.editor.plugins.EditorBackgroundColor");var u=v("dijit.editor.plugins.EditorBackgroundColor",n,{buttonClass:m,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var g="";this.params.custom&&this.params.custom.recordUID&&(g=this.params.custom.recordUID);var f=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(e){function b(a){f.button.dropDown=new a({dir:f.editor.dir,ownerDocument:f.editor.ownerDocument,
value:f.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:g,onChange:function(a){f.editor.execCommand("useCSS",!1);f.editor.execCommand("styleWithCSS",!0);f.editor.execCommand(f.hackCommand,a)},onExecute:function(){f.editor.execCommand(f.hackCommand,this.get("value"))},onClose:function(){f.button.closeDropDown()}});e()}"string"===typeof f.colorPicker?p([f.colorPicker],b):b(f.colorPicker)}},updateState:function(){var g=
this.editor,f=this.hackCommand;if(g&&g.isLoaded&&f.length){var e;if(this.button){var b=this.get("disabled");this.button.set("disabled",b);if(b)return;try{e=g.queryCommandValue(f)||""}catch(a){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(g=this.button.dropDown)&&g.getColor&&e!==g.getColor()&&(g.refreshRecords(),g.setColor(e))}}});g.subscribe(t._scopeName+".Editor.getPlugin",null,function(g){if(!g.plugin)switch(g.args.name){case "editorBackgroundColor":g.plugin=new u}});
return u})},"builder/plugins/creation-entry/_build-generate_module":function(){define(["builder/plugins/creation-entry/Plugin","dojo/text!builder/plugins/creation-entry/Plugin.html","dojo/text!builder/plugins/creation-entry/css/style.css","dojo/i18n!builder/plugins/creation-entry/nls/strings"],function(){})},"builder/plugins/creation-entry/Plugin":function(){define("dojo/_base/declare dojo/_base/html dojo/Deferred dojo/keys builder/BasePlugin dijit/_WidgetsInTemplateMixin dojo/text!./Plugin.html dojo/_base/lang dojo/query dojo/promise/all jimu/dijit/Message jimu/dijit/Popup builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter builder/serviceUtils builder/utils ./SaveAsPage ./CreateNewAppPage builder/dijit/FullScreenPopup".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B){return p([n,m],{templateString:u,baseClass:"plugin-creation-app",fromAppId:null,postMixInProperties:function(){this.inherited(arguments);this.nls=k.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments)},popupNewCreateDlg:function(a,b){this._getInitAppInfo().then(k.hitch(this,function(c){this.createAppPage=new E({appInfo:c,pluginManager:this.pluginManager,createFromAppInfo:b,nls:this.nls,creationEntryPlugin:this,isPortalSupport3D:window.isPortalSupport3D});
c=f("#main-page")[0];this.createAppPopup=new B({zIndex:101,subDijit:this.createAppPage,titleStr:a||this.nls.appCreateNewAppTitle,content:this.createAppPage.domNode,blurContainer:c.firstElementChild,buttons:[{label:this.nls.next,key:v.ENTER,isHighLight:!0,onClick:k.hitch(this.createAppPage,this.createAppPage._onNextClick)},{label:this.nls.back,key:v.ENTER,isHighLight:!0,onClick:k.hitch(this.createAppPage,this.createAppPage._onBackClick)},{label:this.nls.ok,key:v.ENTER,isHighLight:!0,onClick:k.hitch(this,
this._onCreateNewClick)},{label:this.nls.cancel,key:v.ESCAPE,isHighLight:!1,onClick:k.hitch(this,this._onCreateNewCancelClick)}],btnsAtuoBottom:!0});this.createAppPopup.placeAt(c);this.createAppPopup.show();this.createAppPage.setPopup(this.createAppPopup);this.createAppPage.startup()}))},createNewApp:function(c){var e=new t;q.createApp(c).then(k.hitch(this,function(b){if(b.success){var f=k.clone(c);f.id=b.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(f);e.resolve();c.sharing&&
(c.webmap?this._shareAppWithWebmapOrWebscene(b.newAppId,c.folderId,c.webmap):c.webscene&&this._shareAppWithWebmapOrWebscene(b.newAppId,c.folderId,c.webscene))}else{var m=new a({content:C.localizeErrMessageByCode(b),container:"main-page",titleLabel:builderNls.createError||"",width:400,autoHeight:!0,buttons:[{label:this.nls.ok,key:v.ENTER,onClick:k.hitch(this,function(){b.href&&(g.setStyle(m.domNode,"display","none"),window.location.href=b.href);m.close()})}]});e.reject()}}),k.hitch(this,function(a){new b({message:a.message});
e.reject(a)}));return e},popupSaveAsDlg:function(b,c,e){this._getInitAppInfo(c).then(k.hitch(this,function(f){this.saveAsPage=new z({fromAppId:c,appInfo:f,nls:this.nls});this.saveAsPage.startup();this.saveAsPopup=new a({content:this.saveAsPage,container:"main-page",titleLabel:b||"",width:669,autoHeight:!0,buttons:[{label:this.nls.ok,key:v.ENTER,onClick:k.hitch(this,this._onSaveAsPopupNextClick,e)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:v.ESCAPE,onClick:k.hitch(this,this._onSaveAsPopupCancelClick)}]})}))},
_onSaveAsPopupCancelClick:function(){this._close()},_onSaveAsPopupNextClick:function(a){var c=this.saveAsPage._getAppInfoFromDlg(),e=this.pluginManager.getPluginByName("app-list");if(c.name){var f=new w;f.placeAt(this.saveAsPopup.domNode);f.startup();this._saveAs(c,a).then(k.hitch(this,function(){e&&window.isXT&&(c.isTemplate?e.refreshTemplatePage():e.refreshAppPage());f.destroy()}),function(){f.destroy()})}else new b({message:this.nls.noAppName})},_close:function(){this.saveAsPopup?(this.saveAsPopup.close(),
this.saveAsPopup=null):this.saveAsPage&&this.saveAsPage.destroy();this.createAppPopup&&(this.createAppPopup.close(),this.createAppPopup=null,this.createAppPage.destroy())},_saveAs:function(a,c){var e=new t;q.saveAs(a,c).then(k.hitch(this,function(c){if(c.success){var f=k.clone(a);f.id=c.newAppId;f.name=a.name;this._close();this.pluginManager.getPluginByName("startup").switchToAppConfig(f);e.resolve()}else new b({message:c.message}),e.reject()}),k.hitch(this,function(a){new b({message:a.message});
e.reject()}));return e},_onCreateNewClick:function(){var a=this.createAppPage._getAppInfoFromDlg(),c=this.pluginManager.getPluginByName("app-list");if(a.name){var e=new w;e.placeAt(this.createAppPopup.domNode);e.startup();this.createNewApp(a).then(k.hitch(this,function(){c&&window.isXT&&c.refreshAppPage();e.destroy();setTimeout(k.hitch(this,function(){this._close()}),300)}),function(){e.destroy()})}else new b({message:this.nls.noAppName})},_onCreateNewCancelClick:function(){this._close()},_getInitAppInfo:function(a){var b=
new t,e=this._getEmptyAppInfo();window.isXT?a?q.getAppInfo(a).then(k.hitch(this,function(a){e.name=a.name+this.nls._copy;e.description=a.description;e.appType=a.appType;e.isTemplate=a.isTemplate;e.thumbnail=a.thumbnail;b.resolve(e)}),k.hitch(this,function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(e):a?c.getPortal(x.getPortalUrlFromLocation()).getItemById(a).then(k.hitch(this,function(a){e.name=a.title+this.nls._copy;e.tags=a.tags;e.description=a.snippet;b.resolve(e)}),k.hitch(this,
function(a){console.error(this.nls.saveAsFaied,a);b.reject()})):b.resolve(e);return b},_getEmptyAppInfo:function(){return{name:"",description:"",tags:["AppBuilder App"],folderId:"",sharing:!1,appType:window.appInfo.appType,webmap:null,fromAppId:null,creator:null,isPredefined:!0,isTemplate:!1,thumbnail:"/webappbuilder/builder/images/appthumbnail_2d.jpg",icon:"/webappbuilder/builder/images/logo.png"}},_shareAppWithWebmapOrWebscene:function(a,f,g){var m=c.getPortal(x.getPortalUrlFromLocation()),n=new t,
p=new t,q=new t,u=new t;m.getUser().then(k.hitch(this,function(a){n.resolve(a)}),k.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);n.reject()}));m.getItemById(g).then(k.hitch(this,function(a){p.resolve(a)}),k.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);p.reject(a)}));e({user:n,userItem:q}).then(k.hitch(this,function(c){var e={};switch(c.userItem.sharing.access){case "public":e.everyone=!0;e.groups=c.userItem.sharing.groups.toString();
break;case "account":case "org":e.org=!0;e.groups=c.userItem.sharing.groups.toString();break;case "shared":e.groups=c.userItem.sharing.groups.toString()}c.user.shareItem(e,a,f).then(k.hitch(this,function(a){u.resolve(a)}),k.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);u.reject()}))}));e({user:n,webmapItem:p}).then(k.hitch(this,function(c){if(c.webmapItem.owner===c.user.username)c.user.getItemById(g,c.webmapItem.ownerFolder).then(k.hitch(this,function(a){q.resolve(a)}),
k.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);q.reject(a)}));else{var e={};switch(c.webmapItem.access){case "public":e.everyone=!0;break;case "account":case "org":e.org=!0}c.user.shareItem(e,a,f).then(k.hitch(this,function(a){u.resolve(a)}),k.hitch(this,function(a){new b({message:this.nls.createAppUrlError});console.error(a.message);u.reject()}))}}))}})})},"builder/plugins/creation-entry/SaveAsPage":function(){define(["dojo/_base/declare","builder/BasePlugin",
"dijit/_WidgetsInTemplateMixin","dojo/text!./SaveAsPage.html","builder/dijit/ItemInfo"],function(p,g,t,v,n){return p([g,t],{templateString:v,baseClass:"saveas-app-page",fromAppId:null,appInfo:null,appType:null,_stemappExtensions:null,webmap:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){window.isXT?(this.appInfo.tags=void 0,this.appInfo.folderId=void 0,this.appInfo.sharing=void 0):this.fromAppId&&(this.appInfo.sharing=
void 0,this.appInfo.thumbnail=void 0);this.itemInfoDijit=new n({itemInfo:this.appInfo});this.itemInfoDijit.placeAt(this.itemInfoBox)},_getAppInfoFromDlg:function(){var g=this.itemInfoDijit.getProperties();g.appType=this.appInfo.appType;g.webmap=this.webmap;g.fromAppId=this.fromAppId;g.isPredefined="default"!==this.fromAppId&&this.fromAppId?!1:!0;g.isTemplate=this.appInfo.isTemplate?!0:!1;g.saveAsTemplate=!1;return g}})})},"builder/plugins/creation-entry/CreateNewAppPage":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html builder/BasePlugin dojo/dom-style dijit/_WidgetsInTemplateMixin dojo/text!./CreateNewAppPage.html dojo/query dojo/on dojo/dom-class dojo/_base/lang dojo/Evented builder/dijit/EditItemInfo builder/serviceUtils jimu/portalUrlUtils builder/portalUtils jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){return p([v,m,a],{templateString:u,baseClass:"create-app-page",appInfo:null,pluginManager:null,postMixInProperties:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments)},startup:function(){"undefined"===typeof this.isPortalSupport3D&&(this.isPortalSupport3D=!1);this.isPortalSupport3D=!!this.isPortalSupport3D;this.initAppInfoPage();this.createFromAppInfo?(this.selectedApp=this.createFromAppInfo,this._displaySecondPage(),this._hideButton(1)):
(this.initAppSelectPage(),this._displayFirstPage())},destroy:function(){this.itemInfoDijit&&(this.itemInfoDijit.destroy(),this.itemInfoDijit=null);this.popup&&(this.popup=null);t.destroy(this.domNode);this.inherited(arguments)},initAppSelectPage:function(){this._stemappExtensions=this.pluginManager.getExtensions("startup.stemapps");this._stemappExtensions.sort(function(a,b){return a.parameters.index-b.parameters.index});x.getTemplateList(!0).then(b.hitch(this,function(a){var c=this._filterInfosByIsPortalSupport3D(a);
g.forEach(c,function(a){!a.id||"HTML_default"!==a.id&&"HTML3D_default"!==a.id?this._createAppNodeAndBindEvent(a,this.othersApps):("HTML_default"===a.id?a.name=this.nls.Default2D:"HTML3D_default"===a.id&&(a.name=this.nls.Default3D),this._createAppNodeAndBindEvent(a,this.defaultApps))},this);this._selecteApp(k(".app-image-border-div",this.allAppContent)[0]);c=w.getStandardPortalUrl(window.portalUrl);q.getPortal(c).getUser().then(b.hitch(this,function(b){var c=g.filter(a,function(a){return a.isTemplate&&
a.creator===b.username}),c=this._filterInfosByIsPortalSupport3D(c);g.forEach(c,function(a){this._createAppNodeAndBindEvent(a,this.ownAppContent)},this)}))}))},_filterInfosByIsPortalSupport3D:function(a){var b=this.isPortalSupport3D;return g.filter(a,function(a){return!1===b?"HTML3D"!==a.appType:!0})},initAppInfoPage:function(){this.itemInfoDijit=new c({itemInfo:this.appInfo,nls:this.nls});this.itemInfoDijit.placeAt(this.appInfoTable)},_createAppNode:function(a,b,c){this.zIndex=10;b=t.create("div",
{"class":"app-node jimu-float-leading",style:c},b);c=t.create("div",{"class":"app-image-border-div",title:C.stripHTML(a.description)},b);t.create("div",{"class":"app-image-div",style:{backgroundImage:"url("+a.thumbnail+")"}},c);var e;"HTML"===a.appType?e="2D":"HTML3D"===a.appType&&(e="3D");e=t.create("div",{"class":"flag-image flag-image-"+e},c);n.set(e,"z-index",this.zIndex++);t.create("div",{"class":"app-name",innerHTML:C.stripHTML(a.name),title:C.stripHTML(a.name)},b);return c},_createAppNodeAndBindEvent:function(a,
c){c=this._createAppNode(a,c);this.own(f(c,"click",b.hitch(this,this._onAppNodeClick,c)));c.appInfo=a;return c},_onAppNodeClick:function(a){var b=k(".app-image-border-div",this.appSelectPage);g.forEach(b,function(a){this._unselecteApp(a)},this);this._selecteApp(a)},_selecteApp:function(a){this.selectedApp=a.appInfo;e.add(a,"jimu-state-active")},_unselecteApp:function(a){e.remove(a,"jimu-state-active")},_onAllAppBtnClick:function(){var a=k(".app-image-border-div",this.allAppContent)[0];a&&(this._onAppNodeClick(a),
this.creationEntryPlugin.createAppPopup.enableButton(0));t.setStyle(this.allAppContent,"display","block");t.setStyle(this.ownAppContent,"display","none");t.addClass(this.allAppBtn,"selected");t.removeClass(this.ownAppBtn,"selected")},_onOwnAppBtnClick:function(){var a=k(".app-image-border-div",this.ownAppContent)[0];a?(this._onAppNodeClick(a),this.creationEntryPlugin.createAppPopup.enableButton(0)):this.creationEntryPlugin.createAppPopup.disableButton(0);t.setStyle(this.allAppContent,"display","none");
t.setStyle(this.ownAppContent,"display","block");t.addClass(this.ownAppBtn,"selected");t.removeClass(this.allAppBtn,"selected")},_onNextClick:function(){this._displaySecondPage();"HTML"===this.selectedApp.appType?this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_2d.jpg"):this.itemInfoDijit.imageChooser.setDefaultSelfSrc("/webappbuilder/builder/images/appthumbnail_3d.jpg")},_onBackClick:function(){this._displayFirstPage()},_displayFirstPage:function(){t.setStyle(this.appInfoPage,
"display","none");t.setStyle(this.appSelectPage,"display","block");this._displayButtion(0);this._hideButton(1);this._hideButton(2);this.popup&&this.popup.resize()},_displaySecondPage:function(){t.setStyle(this.appSelectPage,"display","none");t.setStyle(this.appInfoPage,"display","block");this._hideButton(0);this._displayButtion(1);this._displayButtion(2);this.popup&&this.popup.resize();this.itemInfoDijit&&this.itemInfoDijit.focusItemByName("appName")},setPopup:function(a){this.popup=a},_hideButton:function(a){t.setStyle(this.popup.enableButton(a),
"display","none")},_displayButtion:function(a){t.setStyle(this.popup.enableButton(a),"display","inline-block")},_getAppInfoFromDlg:function(){var a=this.itemInfoDijit.getProperties();a.appType=this.selectedApp.appType;a.webmap=this.webmap;a.fromAppId=this.selectedApp.id;a.isPredefined=!1;a.isTemplateApp=this.selectedApp.isTemplate;0===a.icon.indexOf("/webappbuilder/builder/images/")&&(a.icon=null);0===a.thumbnail.indexOf("/webappbuilder/builder/images/")&&(a.thumbnail=null);return a}})})},"builder/plugins/header/_build-generate_module":function(){define(["builder/plugins/header/Plugin",
"dojo/text!builder/plugins/header/Plugin.html","dojo/text!builder/plugins/header/css/style.css","dojo/i18n!builder/plugins/header/nls/strings"],function(){})},"builder/plugins/header/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/topic dojo/Deferred dojo/request dojo/request/script dijit/_WidgetsInTemplateMixin builder/portalUtils jimu/portalUrlUtils builder/tokenUtils jimu/utils jimu/dijit/Popup jimu/dijit/Message builder/BasePlugin builder/serviceUtils dojo/_base/config ./AppParameters ./AppItem jimu/dijit/LoadingIndicator".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G){return p([C,e],{baseClass:"plugin-header",_trainingUrls:{administrator:"//www.esri.com/training/main/arcgis-online-administrators",publisher:"//www.esri.com/training/main/arcgis-online-publishers",user:"//www.esri.com/training/main/arcgis-online-users","public":"//www.esri.com/training/main/arcgis-online-training",custom:"//www.esri.com/training/main/arcgis-online-training"},_esriCommunityLink:"https://community.esri.com",_myEsriLink:"https://my.esri.com",
postCreate:function(){this.inherited(arguments);this._initSelf();window.isXT?(v.setStyle(this.appXTBtn,"display","block"),v.setStyle(this.app2DBtn,"display","none"),v.setStyle(this.app3DBtn,"display","none")):(v.setStyle(this.appXTBtn,"display","none"),v.setStyle(this.app2DBtn,"display","block"),v.setStyle(this.app3DBtn,"display","block"))},_initSelf:function(){this._isWebTier(window.portalUrl).then(g.hitch(this,function(a){a&&v.setStyle(this.signOutItem,"display","none")}));window.isXT?(v.addClass(this.domNode,
"xt"),v.destroy(this.homeSection),this._bindXtEvents()):(v.addClass(this.homeLabel,"js-home-dropdown"),v.destroy(this.switchSection),this._bindIntegratedEvents(window.portalUrl));var c=b.getPortal(window.portalUrl);c.haveSignIn()?(c.getUser().then(g.hitch(this,function(b){if(b){this.user=b;window.isXT||v.removeClass(this.organizationItem,"hidden");var c=b.firstName||b.username;c&&(this.userNameNode.innerHTML=c);if(b.thumbnail&&(c=a.getUserThumbnailUrl(window.portalUrl,b.username,b.thumbnail))){var e=
b.credential&&b.credential.token;e&&(c+="?token\x3d"+e);this.userIcon.src=c;this.profileImg.src=c}this.profileNameNode.innerHTML=b.username;a.isOnline(window.portalUrl)?"both"===b.userType&&(this.communityNode.href=this._esriCommunityLink,this.myesriNode.href=this._myEsriLink,v.removeClass(this.communityNode,"hidden"),v.removeClass(this.myesriNode,"hidden"),c="",c=b.isAdminRole()?this._trainingUrls.administrator:b.isPublisherRole()?this._trainingUrls.publisher:b.isUserRole()?this._trainingUrls.user:
this._trainingUrls.custom,this.trainingNode.href=c,v.removeClass(this.trainingNode,"hidden")):b.isAdminRole()}}),g.hitch(this,function(a){console.error(a)})),!window.isXT||queryObject.id||queryObject.appid?v.setStyle(this.newAppSection,"display","block"):v.setStyle(this.newAppSection,"display","none")):v.setStyle(this.newAppSection,"display","none")},_isWebTier:function(a){var b=new u,e=esri.id.findServerInfo(a);e&&e.webTierAuth?b.resolve(!0):b=c.isWebTierPortal(a);return b},_isUserMenuShow:function(){return v.hasClass(this.userSection,
"is-active")},_showUserMenu:function(){v.addClass(this.userSection,"is-active")},_hideUserMenu:function(){v.removeClass(this.userSection,"is-active")},_isAppsMenuShow:function(){return v.hasClass(this.newAppSection,"is-active")},_showAppsMenu:function(){this.recentApps&&0<this.recentApps.length&&(t.forEach(this.recentApps,function(a){a.destroy()}),v.empty(this.recentAppsContainer));v.setStyle(this.recentAppsSeperator,"display","none");v.addClass(this.newAppSection,"is-active");this.shelter.show();
this._getRecentApps().then(g.hitch(this,function(a){a&&0<a.length&&v.setStyle(this.recentAppsSeperator,"display","block");this.recentApps=[];t.forEach(a,g.hitch(this,function(a){a=new G({appItem:a});a.placeAt(this.recentAppsContainer);a.startup();this.own(n(a,"app-click",g.hitch(this,function(a){window.isXT?this._openXTApp(a):this._openOnlineApp(a.id)})));this.recentApps.push(a)}));this.shelter.hide()}))},_hideAppsMenu:function(){v.removeClass(this.newAppSection,"is-active")},_bindXtEvents:function(){this.own(n(document.body,
"click",g.hitch(this,function(a){a=a.target||a.srcElement;a===this.userSection||v.isDescendant(a,this.userSection)||this._hideUserMenu();a===this.newAppSection||v.isDescendant(a,this.newAppSection)||this._hideAppsMenu()})));this.own(m.subscribe("iframeClick",g.hitch(this,function(){this._hideUserMenu();this._hideAppsMenu()})));this.own(m.subscribe("userSignOut",g.hitch(this,function(){this.userNameNode.innerHTML=""})));this.own(m.subscribe("userSignIn",g.hitch(this,function(a){this.userNameNode.innerHTML=
a.userId||""})));this.own(m.subscribe("switchToAppList",g.hitch(this,function(){v.setStyle(this.newAppSection,"display","none")})));this.own(m.subscribe("switchToAppConfig",g.hitch(this,function(){v.setStyle(this.newAppSection,"display","block")})));this.logoTitle.title=this.nls.backToHomePage||"";this.own(n(this.logoTitle,"click",g.hitch(this,function(a){a.preventDefault();v.hasClass(this.domNode,"app-opened")&&this.pluginManager.getPluginByName("startup").switchToAppList()})));this.own(n(this.profileItem,
"click",g.hitch(this,function(){var b=g.hitch(this,function(){window.location.href=a.getHomeUserUrl(window.portalUrl)});this._isInConfig()?m.publish("closeAppConfigPage",b):b()})));this.helpNode.href="help";this.signOutItem&&this.own(n(this.signOutItem,"click",g.hitch(this,function(){var b=g.hitch(this,function(){this.userNameNode.innerHTML="";c.signOutAll();var b=a.getOAuth2SignOutUrl(window.portalUrl),b=a.setHttpsProtocol(b),e=function(){var a=x.getLocationUrlWithoutHashAndQueryParams(),a=x.url.addQueryParamToUrl(a,
"action","setportalurl");window.location.href=a};this._getSigninInfo(window.portalUrl).then(function(a){if(a.success&&a.info&&a.info.portalUrl&&a.info.supportsOAuth)try{f.get(b).always(function(){e()})}catch(J){console.error(J),e()}else e()},function(){e()})});this._isInConfig()?m.publish("closeAppConfigPage",b):b()})));this.own(n(window,"resize",g.hitch(this,function(){this._calculateWidth()})));this.own(n(this.appSwitch,"click",g.hitch(this,this._onAppsClicked)));this.own(n(this.templateSwitch,
"click",g.hitch(this,this._onTemplatesClicked)));this._calculateWidth()},_calculateWidth:function(){1816>=window.innerWidth?v.addClass(this.domNode,"width-less1816"):v.removeClass(this.domNode,"width-less1816")},_getSigninInfo:function(a){return k("/webappbuilder/rest/signininfo/getsignininfo",{handleAs:"json",query:"portalUrl\x3d"+a,method:"GET"})},_bindIntegratedEvents:function(b){a.isOnline(window.portalUrl)&&(v.removeClass(this.switchAccountsNode,"hidden"),this.switchAccountsNode.href=a.getSwitchAccoutnsUrl(window.portalUrl,
"arcgisonline",""));this.own(n(document.body,"click",g.hitch(this,function(a){a=a.target||a.srcElement;a!==this.homeLabel&&v.removeClass(this.homeSection,"is-active");a===this.userSection||v.isDescendant(a,this.userSection)||this._hideUserMenu();a===this.newAppSection||v.isDescendant(a,this.newAppSection)||this._hideAppsMenu()})));this.own(m.subscribe("iframeClick",g.hitch(this,function(){v.removeClass(this.homeSection,"is-active");this._hideUserMenu();this._hideAppsMenu()})));this.own(n(this.homeLabel,
"click",g.hitch(this,function(a){a.preventDefault();v.hasClass(this.homeSection,"is-active")?v.removeClass(this.homeSection,"is-active"):v.addClass(this.homeSection,"is-active")})));this.own(n(this.homeItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeIndexUrl(b)})})));this.own(n(this.galleryItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeGalleryUrl(b)})})));this.own(n(this.mapItem,
"click",g.hitch(this,function(){window.appConfig&&window.appConfig.map&&m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeMapViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl,window.appConfig.map.itemId)})})));this.own(n(this.sceneItem,"click",g.hitch(this,function(){window.appConfig&&window.appConfig.map&&m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeSceneViewerUrl(window.appConfig.map.portalUrl||window.appConfig.portalUrl)})})));
this.own(n(this.groupsItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeGroupsUrl(b)})})));this.own(n(this.contentItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeMyContentUrl(b)})})));this.own(n(this.organizationItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeMyOrganizationUrl(b)})})));this.own(n(this.profileItem,"click",
g.hitch(this,function(){m.publish("closeAppConfigPage",function(){window.location.href=a.getHomeUserUrl(b)})})));0<=b.toLowerCase().indexOf(".arcgis.com")?this.helpNode.href="http://doc.arcgis.com/en/web-appbuilder/":this.helpNode.href=a.getPortalHelpUrl(b,E.locale);this.signOutItem&&this.own(n(this.signOutItem,"click",g.hitch(this,function(){m.publish("closeAppConfigPage",function(){if(a.isOnline(window.portalUrl)){var b=a.getSwitchAccoutnsUrl(window.portalUrl,"arcgisonline","");window.location.href=
b+"\x26signout\x3dtrue"}else c.signOutAll(),window.location.href=a.getPortalSignInUrlFromLocation()})})))},setAppName:function(a){a=a||"";(this.appName.innerHTML=a)?(window.isXT?this.logoTitle.title=this.nls.backToHomePage||"":v.setStyle(this.logoTitle,"color","#4c4c4c"),v.addClass(this.domNode,"app-opened"),v.removeClass(this.domNode,"app-not-opened"),window.isXT||(v.setAttr(this.appName,"href",window.portalUrl+"/home/item.html?id\x3d"+window.appInfo.id),v.setAttr(this.appName,"title",this.nls.showItemDetails),
v.addClass(this.appName,"highlight"),v.setAttr(this.appNameIcno,"href",window.portalUrl+"/home/item.html?id\x3d"+window.appInfo.id),v.setAttr(this.appNameIcno,"title",this.nls.showItemDetails),v.addClass(this.appNameIcno,"highlight"))):(this.logoTitle.title="",v.removeClass(this.domNode,"app-opened"),v.addClass(this.domNode,"app-not-opened"))},getAppName:function(){return this.appName.innerHTML||""},_isInConfig:function(){return"appconfig"===this.pluginManager.getPluginByName("startup").getCurrentView().label},
_onUserSectionClicked:function(a){a=a.target||a.srcElement;var b=!0;if(v.isDescendant(a,this.userInfoDom)||a===this.userInfoDom)this._isUserMenuShow()||(b=!1);b?this._hideUserMenu():this._showUserMenu()},_onAppsClicked:function(){v.removeClass(this.templateSwitch,"selected");v.addClass(this.appSwitch,"selected");m.publish("switchToAppListApps")},_onTemplatesClicked:function(){v.removeClass(this.appSwitch,"selected");v.addClass(this.templateSwitch,"selected");m.publish("switchToAppListTemplates")},
_onNewAppClicked:function(a){a=a.target||a.srcElement;var b=!0;if(v.isDescendant(a,this.appsInfoDom)||a===this.appsInfoDom)this._isAppsMenuShow()||(b=!1);b?this._hideAppsMenu():this._showAppsMenu()},_checkUnsavedChanges:function(){var a=new u,b=this.pluginManager.getPluginByName("app-actions.save-app");if(!b._appHasChanged())return a.resolve(!0),a;var c=new w({content:"\x3cdiv style\x3d'font-size: 14px'\x3e\x3cimg class\x3d'alert-image jimu-float-leading'  src\x3d'"+this.folderUrl+"css/images/alert.png'  style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+
b.nls.unSaveMegBegin+b.options.name+b.nls.unSaveMegEnd+"\x3c/span\x3e\x3c/div\x3e",titleLabel:b.nls.toHomeTitle,width:525,height:180,buttons:[{label:b.nls.save,onClick:g.hitch(this,function(){b.saveApp().then(g.hitch(this,function(){c.close();a.resolve(!0)}),g.hitch(this,function(b){console.error(this.nls.saveFailedMeg,b);new q({message:this.nls.saveFailedMeg});a.resolve(!1)}))})},{label:b.nls.doNotSave,onClick:g.hitch(this,function(){c.close();b.lastAppConfig=b.appConfig;b._disableUnloadDlg();a.resolve(!0)})},
{label:b.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){c.close();a.resolve(!1)})}]});return a},_createXTApp:function(){this._checkUnsavedChanges().then(g.hitch(this,function(a){if(a)if(this.pluginManager.getPluginByName("startup").switchToAppList(),a=this.pluginManager.getPluginByName("app-list"))a._onCreateClick();else var b=n(this.pluginManager,"pluginCreated",g.hitch(this,function(a){"app-list"===a.name&&(a._onCreateClick(),b.remove())}))}))},_create2DApp:function(){this._createOnlineApp("2D")},
_create3DApp:function(){this._createOnlineApp("3D")},_createOnlineApp:function(a){this._checkUnsavedChanges().then(g.hitch(this,function(b){b&&this.user&&this.user.getContent().then(g.hitch(this,function(b){this._popupAppDialog(a,b.folders)}))}))},_popupAppDialog:function(a,b){var c=[{id:"empty",title:this.user.username}];b=b||[];b=c.concat(b);var e=new B({nls:this.nls,folders:b}),f=new w({content:e.domNode,titleLabel:"2D"===a?this.nls.new2DApp:this.nls.new3DApp,autoHeight:!0,width:480,buttons:[{label:window.jimuNls.common.save,
onClick:g.hitch(this,function(){e.isValid()&&this._doCraeteApp(a,e.getValue()).then(g.hitch(this,function(){f.close()}))})},{label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this,function(){f.close()})}]})},_doCraeteApp:function(a,b){var c=new u,e={name:b.title,description:b.summary,tags:b.tags,folderId:"empty"===b.folder?"":b.folder,appType:"2D"===a?"HTML":"HTML3D"};z.createApp(e).then(g.hitch(this,function(a){if(a.success){var b=g.clone(e);b.id=a.newAppId;this.pluginManager.getPluginByName("startup").switchToAppConfig(b);
c.resolve()}else new q({message:a.message}),c.reject()}),g.hitch(this,function(a){new q({message:a.message});c.reject(a)}));return c},_getRecentApps:function(){var a=new u;if(window.isXT)z.getAppList().then(g.hitch(this,function(b){b=b||[];b=t.filter(b,function(a){return a.id!==window.appInfo.id});b=b.sort(function(a,b){return a.lastUpdated&&b.lastUpdated?b.lastUpdated-a.lastUpdated:a.createdTime&&b.createdTime?b.createdTime-a.createdTime:0});5<b.length&&(b=b.slice(0,5));a.resolve(b)}),function(){a.resolve([])});
else{var c=b.getPortal(window.portalUrl);c.haveSignIn()&&this.user?c.queryItems({q:"-id:"+window.appInfo.id+" AND owner:"+this.user.username+' AND type:"Web Mapping Application" AND typekeywords:"Web AppBuilder"',num:5,sortField:"modified",sortOrder:"desc"}).then(g.hitch(this,function(b){a.resolve(b.results||[])})):a.resolve([])}return a},_openOnlineApp:function(a,b){var c=window.location.href,e,f=c.match(/[?&](id=[^&]+)/g);e=f&&0<f.length?c.replace(f[0],f[0].substr(0,4)+a):window.portalUrl+"/apps/webappbuilder/index.html?id\x3d"+
a;!1!==b?this._checkUnsavedChanges().then(g.hitch(this,function(a){a&&(window.location.href=e)})):window.location.href=e},_openXTApp:function(a){this._checkUnsavedChanges().then(g.hitch(this,function(b){b&&this.pluginManager.getPluginByName("startup").switchToAppConfig(a)}))}})})},"builder/plugins/header/AppParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppParameters.html dijit/form/Form dijit/form/ValidationTextBox builder/plugins/header/Tags dijit/form/SimpleTextarea dijit/form/Select".split(" "),
function(p,g,t,v,n,m,u){return p([v,n,m],{templateString:u,postCreate:function(){t.forEach(this.folders,g.hitch(this,function(g){this.folderSelect.addOption({label:g.title,value:g.id})}))},getValue:function(){return this.appFormDijit.get("value")},isValid:function(){return this.appFormDijit.validate()}})})},"builder/plugins/header/Tags":function(){define(["dojo/_base/declare","dojo/dom-attr","esri/dijit/Tags"],function(p,g,t){return p([t],{validate:function(){if(this._created&&!this.isValid())return g.set(this.domNode,
"aria-invalid","true"),this._displayMessage(this.i18n.required),!1;g.set(this.domNode,"aria-invalid","false");this._displayMessage(null);return!0}})})},"esri/dijit/Tags":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-style dojo/has dojo/html dojo/keys dojo/on dojo/query dojo/string dojo/store/Memory dijit/focus dijit/form/TextBox dijit/registry dijit/Tooltip dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/Keyboard ../kernel ../lang dojo/i18n!../nls/jsapi dojo/NodeList-traverse dojo/NodeList-manipulate dojo/_base/sniff".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M){return g([F,B,G],{declaredClass:"esri.dijit.Tags",templateString:'\x3cdiv class\x3d"${baseClass}"\x3e\x3c/div\x3e',baseClass:"esriTags",_attachmentNode:"",_autocompleteList:"",_grid:"",_store:"",_matchParam:"",_idProperty:"",_gridId:"",_filterId:"",_placeHolder:"",_noDataMsg:"",_maxWidth:"",_minWidth:"",_inputTextBox:"",_gridHasFocus:!1,_metaKeyPressed:!1,_shiftKeyPressed:!1,_CSS_STYLES:{CLASS_SELECTOR:".",ALL_SELECTOR:"\x3e",MULTI:"select2-container select2-container-multi",
CHOICES:"select2-choices",CHOICE:"select2-search-choice",SEARCH_CHOICE_FOCUS:"select2-search-choice-focus",SEARCH_FIELD:"select2-search-field",CLOSE_ICON:"select2-search-choice-close"},values:[],_selRows:[],_CHOICE_SELECTOR:"",_CHOICE_FOCUS:"",_CHOICE_FOCUS_ALL:"",tooltipPosition:[],constructor:function(a){this._idProperty=a.idProperty||"tag";this._maxWidth=a.maxWidth||"auto";this._minWidth=a.minWidth||"auto";this._matchParam=a.matchParam||"first";this.values=[];this._selRows=[];this._CHOICE_ALL_SELECTOR=
this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE+this._CSS_STYLES.ALL_SELECTOR;this._CHOICE_FOCUS=this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.SEARCH_CHOICE_FOCUS;this._CHOICE_FOCUS_ALL=this._CHOICE_FOCUS+this._CSS_STYLES.ALL_SELECTOR},postMixInProperties:function(){this.inherited(arguments);var a=(new Date).getTime();this._tagsId="userTags-"+a;this._gridId="grid-"+a;this._filterId="filter-"+a;this._isIE8=9>f("ie");this.i18n={};t.mixin(this.i18n,M.widgets.tags)},postCreate:function(){if(this._isIE8)this._textTags=
new C({trim:!0,placeHolder:this.i18n.addTags,style:{minWidth:this.minWidth,maxWidth:this.maxWidth}},u.create("div",{id:this._tagsId},this.domNode)),this._textTags.startup(),m.add(this._textTags.domNode,"ie8Style");else{this._attachmentNode=u.create("div",{id:this._tagsId,className:"grid_1"},this.domNode);this._createContainerNode();this._createTagList();this._createDropDownList();this._createInput();var a=t.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";if(1>
b.length)return!0;if(!a.tag)return!1;a=(a.tag+"").toLowerCase().match(new RegExp("^"+b.toLowerCase()));return null!==a&&0<a.length?!0:!1}),b=t.hitch(this,function(a,b,c){b=this._inputTextBox?this._inputTextBox.get("value")+"":"";return 1>b.length?!0:a.tag?(a.tag+"").toLowerCase().indexOf(b.toLowerCase())?!0:!1:!1}),c=[{field:this._idProperty}],e=[{attribute:this._idProperty,ascending:!0}];this._store=new w({idProperty:this._idProperty,data:[]});this._grid=new (g([D,I,K]))({store:this._store,showHeader:!1,
noDataMessage:this.i18n.noTagsFound,selectionMode:"extended",allowSelectAll:!0,cellNavigation:!1,columns:c,sort:e,renderRow:this._renderItem},this._dropDownList);this._grid.startup();m.add(this._grid.domNode,"gridHeightLimiter");this._grid.query="first"===this._matchParam?a:b;var f;this.own(this._inputTextBox.watch("value",t.hitch(this,function(a,b,c){f&&(clearTimeout(f),f=null);this._grid.refresh()})));this.own(this._grid.on(".dgrid-row:click",t.hitch(this,function(a){var b="";this._shiftKeyPressed||
this._metaKeyPressed?a.shiftKey||a.metaKey||a.ctrlKey||(b=this._selRows[0],this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox()):(b=this._grid.row(a).data.tag,this._createTags(b),this._store.remove(b),this._grid.refresh(),this._resetInputTextBox())})));this.own(this._grid.on("dgrid-deselect",t.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._grid.selection.hasOwnProperty(b)&&this._selRows.push(b)})));this.own(this._grid.on("dgrid-select",
t.hitch(this,function(a){this._selRows=[];for(var b in this._grid.selection)this._grid.selection.hasOwnProperty(b)&&this._selRows.push(b)})));this.own(this.connect(this.domNode,"keydown","_keydownHandler"));window.onkeydown=t.hitch(this,function(a){if(a.shiftKey||a.ctrlKey||224===a.keyCode)this._metaKeyPressed=!0});this.own(this.connect(document,"onkeydown",t.hitch(this,function(a){this._metaKeyPressed=this._shiftKeyPressed=!0})))}},_keydownHandler:function(a){this._clearMessage();var e;void 0!==
q.curNode.value&&(e=q.curNode.value.length);var f=c(this._CHOICE_FOCUS,v.byId(this.id)),g=c(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,v.byId(this.id)).last(),m;switch(a.keyCode){case b.RIGHT_ARROW:this._navigate(f,e,g,"right");this._hideGrid();break;case b.LEFT_ARROW:this._navigate(f,e,g,"left");this._hideGrid();break;case b.DOWN_ARROW:a.preventDefault();this._unhighlightTag(f);"none"===k.get(this._gridId,"display")&&this._showGrid();this._gridHasFocus||(this._grid.focus(this._setFocusOnFirstRow(this._grid,
0)),this._gridHasFocus=!0);break;case b.UP_ARROW:break;case b.BACKSPACE:var n;if(0===e&&0===c(this._CHOICE_FOCUS_ALL).length&&void 0!==c(this._CHOICE_ALL_SELECTOR)[c(this._CHOICE_ALL_SELECTOR).length-1]&&(n=c(this._CHOICE_ALL_SELECTOR)[c(this._CHOICE_ALL_SELECTOR).length-1].title,0<c("li",this._attachmentNode).length&&(u.destroy(g[0]),void 0!==n)))try{this._store.add({tag:n})}catch(V){}if(0<c(this._CHOICE_FOCUS_ALL).length&&(n=c(this._CHOICE_FOCUS_ALL).text(),u.destroy(f[0]),void 0!==n))try{this._store.add({tag:n})}catch(V){}this._grid.refresh();
0===e&&this._hideGrid();this._removeTag(n);this._emitRemoved(n);this._emitChanged();this.validate();break;case b.CTRL:this._metaKeyPressed=!0;break;case b.META:this._metaKeyPressed=!0;break;case b.SHIFT:this._shiftKeyPressed=!0;break;case b.ENTER:if(0<e)e=this._stripHTML(q.curNode.value),e=e.split(","),m=[],p.forEach(e,function(a,b){-1===p.indexOf(m,a)&&m.push(x.trim(a))}),p.forEach(m,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));else{for(e=0;e<
this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();q.focus(v.byId(this._filterId));break;case b.TAB:if(q.curNode.id!==this._filterId||0!==e){if(0<e)e=this._stripHTML(q.curNode.value),e=e.split(","),m=[],p.forEach(e,function(a,b){-1===p.indexOf(m,a)&&m.push(x.trim(a))}),p.forEach(m,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));
else{for(e=0;e<this._selRows.length;e++)this._createTags(this._selRows[e]),this._store.remove(this._selRows[e]);this._metaKeyPressed=this._shiftKeyPressed=!1}this._resetInputTextBox();a.preventDefault();q.focus(v.byId(this._filterId))}break;case b.ESCAPE:this._hideGrid();break;default:-1<e&&("none"===k.get(v.byId(this._gridId),"display")&&this._showGrid(),this._unhighlightTag(f)),this._metaKeyPressed=!1}},_blurHandler:function(a,b,c){if(!this.focused){a=this._stripHTML(this._inputTextBox.value);if(0<
a.length){var e=[];a=a.split(",");p.forEach(a,function(a,b){-1===p.indexOf(e,a)&&e.push(x.trim(a))});p.forEach(e,t.hitch(this,function(a,b){this._isEmpty(a)||this._contains(this.values,a)||this._createTags(a)}));this._resetInputTextBox()}this._hideGrid()}this.validate()},isValid:function(){var a=this.get("value");return this.required?L.isDefined(a)&&0<a.length:!0},validate:function(){this._created&&!this.isValid()?(n.set(this.domNode,"aria-invalid","true"),this._displayMessage(this.i18n.required)):
(n.set(this.domNode,"aria-invalid","false"),this._displayMessage(null))},_clearMessage:function(){this._displayMessage(null)},_displayMessage:function(a){var b=this._isIE8?this._textTags.domNode:v.byId(this._tagsId);a&&this.focused?E.show(a,b):E.hide(b)},_resetInputTextBox:function(){z.byId(this._filterId).set("value","")},_isEmpty:function(a){a=a.replace(/^\s+|\s+$/,"");return 0===a.length?!0:!1},_navigate:function(a,b,c,e){0<a.length&&1>b?("right"===e?this._hightlightTag(a.next()):this._hightlightTag(a.prev()),
this._unhighlightTag(a)):1>b&&this._hightlightTag(c)},_contains:function(a,b){return 0<=p.indexOf(a,b)},_hightlightTag:function(a){a.addClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_unhighlightTag:function(a){a.removeClass(this._CSS_STYLES.SEARCH_CHOICE_FOCUS)},_removeTag:function(a){a&&-1!==p.indexOf(this.values,a)&&this.values.splice(p.indexOf(this.values,a),1)},_hideGrid:function(){v.byId(this._gridId)&&k.set(v.byId(this._gridId),"display","none");this._gridHasFocus=!1},_showGrid:function(){k.set(v.byId(this._gridId),
"display","block");var a=k.get(v.byId(this._attachmentNode),"width");k.set(v.byId(this._gridId),"width",a+"px")},_setFocusOnFirstRow:function(a,b){return c(".dgrid-content .dgrid-cell",this._grid.domNode)[b]||c(".dgrid-content .dgrid-row",this._grid.domNode)[b]},_createTags:function(b){c(this._CHOICE_FOCUS,v.byId(this.id)).removeClass("select2-search-choice-focus");var f=u.create("li",null,this._autocompleteList);m.add(f,this._CSS_STYLES.CHOICE);f=u.create("div",{title:b},f);e.set(f,this._htmlEncode(b));
f=u.create("a",{href:"#"},f);m.add(f,this._CSS_STYLES.CLOSE_ICON);a(f,"click",t.hitch(this,function(a){var b=x.trim(a.target.parentElement.innerText||a.target.parentElement.textContent);try{this._store.add({tag:b})}catch(W){}this._grid.refresh();this._removeTag(b);this._emitRemoved(b);this._emitChanged();u.destroy(a.target.parentNode.parentNode);a.preventDefault()}));f=z.byId(this._filterId);u.place(f.domNode,this._autocompleteList,"last");this._hideGrid();this.values.push(b);this._emitAdded(b);this._emitChanged()},
_emitAdded:function(a){this.emit("tags-add",{tag:a})},_emitRemoved:function(a){this.emit("tags-remove",{tag:a})},_emitChanged:function(){this.emit("tags-change",{tags:this.get("tags")})},_renderItem:function(a){return u.create("div",{innerHTML:a.tag})},_createContainerNode:function(){this._containerNode=u.create("div",null,this._attachmentNode);m.add(this._containerNode,this._CSS_STYLES.MULTI);k.set(this._containerNode,"maxWidth",this._maxWidth);k.set(this._containerNode,"minWidth",this._minWidth)},
_createTagList:function(){this._autocompleteList=u.create("ul",null,this._containerNode);m.add(this._autocompleteList,this._CSS_STYLES.CHOICES)},_createInput:function(){var a=u.create("li",null,this._autocompleteList,"last");m.add(a,this._CSS_STYLES.SEARCH_FIELD);this._inputTextBox=new C({id:this._filterId,placeHolder:this.i18n.addTags,intermediateChanges:!0,trim:!0,style:{border:"none"}},a);m.add(this._inputTextBox,"inputTextBox");k.set(this._inputTextBox,"width",this._minWidth);(8<f("ie")||4<f("trident"))&&
m.add(this._inputTextBox.domNode,"ieStyle");this.own(q.watch("curNode",t.hitch(this,this._blurHandler)))},_createDropDownList:function(){this._dropDownList=u.create("div",{id:this._gridId},this._containerNode);m.add(this._dropDownList,"dropDownList");k.set(this._dropDownList,"width",this._minWidth)},focus:function(){q.focus(this.domNode);this._isIE8?this._textTags.focus():this._inputTextBox.focus()},reset:function(){this.clearTags()},prepopulate:function(a){p.forEach(a,t.hitch(this,function(a,b){this._createTags(a);
this._store.remove(a)}))},clearTags:function(){var a=c(this._CSS_STYLES.CLASS_SELECTOR+this._CSS_STYLES.CHOICE,v.byId(this.id)),b=!1,e;0<a.length&&(b=!0,p.forEach(a,t.hitch(this,function(a,b){try{e=c(this._CHOICE_ALL_SELECTOR,v.byId(this.id))[0].title,this._store.add({tag:e})}catch(U){}u.destroy(a);this._emitRemoved(e)})),this.values=[],b&&this._emitChanged())},addStyledTags:function(a,b){m.add(v.byId(b),this._CSS_STYLES.MULTI);var c=u.create("ul",null,v.byId(b));m.add(c,this._CSS_STYLES.CHOICES);
k.set(c,"border","none");p.forEach(a,function(a,b){b=u.create("li",null,c);k.set(b,"padding","3px 5px 3px 5px");m.add(b,"select2-search-resultSet");b=u.create("div",{title:a},b);e.set(b,a)})},_getUniqueTags:function(a){var b=[],c;p.forEach(a,t.hitch(this,function(a){c=this._stripHTML(a);L.isDefined(c)&&0<c.length&&b.push(c)}));return p.filter(b,t.hitch(this,function(a,c){return p.indexOf(b,a)===c}))},_setValueAttr:function(a){this._setTagsAttr(a)},_getValueAttr:function(){return this._getTagsAttr()},
_setTagsAttr:function(a){!a||a instanceof Array||(a=a.split(","));this._isIE8?this._textTags&&this._textTags.set("value",this._getUniqueTags(a).join(",")):(this.clearTags(),this.prepopulate(a?this._getUniqueTags(a):[]))},_getTagsAttr:function(){return this._isIE8?this._textTags?this._textTags.get("value"):"":this.values?this.values.join(","):""},_setRequiredAttr:function(a){this.required=a},_getRequiredAttr:function(){return this.required},_setMinWidthAttr:function(a){this.minWidth=a},_setMaxWidthAttr:function(a){this.maxWidth=
a},_setKnownTagsAttr:function(a){if(!this._isIE8){var b=[],c;for(c=0;c<a.length;c++)0>p.indexOf(this.values,a[c])&&b.push(a[c]);this._store=new w({idProperty:this._idProperty,data:b});this._grid.set("store",this._store);this._grid.refresh()}},_stripHTML:function(a){return a&&a.replace(/<(?:.|\s)*?>/g,"")},_htmlEncode:function(a){return a?a.replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):a}})})},"builder/plugins/header/AppItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./AppItem.html".split(" "),
function(p,g,t,v,n,m,u,k){return p([m,u,v],{templateString:k,baseClass:"app-item",postCreate:function(){var f,e;window.isXT?(f=this.appItem.thumbnail,e=this.appItem.name):(f=this.appItem.thumbnailUrl,e=this.appItem.title);f?t.setStyle(this.thumbnailNode,"background-image","url("+f+")"):t.addClass(this.thumbnailNode,"default");this.labelNode.innerHTML=e;this.labelNode.title=e;this.own(n(this.domNode,"click",g.hitch(this,function(){this.emit("app-click",this.appItem)})))}})})},"builder/plugins/map-config/_build-generate_module":function(){define(["builder/plugins/map-config/Plugin",
"dojo/text!builder/plugins/map-config/Plugin.html","dojo/text!builder/plugins/map-config/css/style.css","dojo/i18n!builder/plugins/map-config/nls/strings"],function(){})},"builder/plugins/map-config/Plugin":function(){define("dojo/on dojo/keys dojo/json dojo/topic dojo/Deferred dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/event dojo/promise/all dojo/dom-construct dojo/_base/declare dojo/text!./Plugin.html dijit/_WidgetsInTemplateMixin builder/BasePlugin builder/portalUtils jimu/Role jimu/utils jimu/dijit/Popup jimu/portalUrlUtils jimu/dijit/Message ./MapSelector ./CustomizeScale builder/dijit/RefreshInterval".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I){return c([q,w],{templateString:x,baseClass:"map-config",appConfig:null,map:null,sceneView:null,item:null,widgetsConfigCache:null,postMixInProperties:function(){var a=m.clone(window.builderNls);this.nls=m.mixin(a,this.nls);this.nls.scaleDisabledTip2=this.nls.scaleDisabledTip.replace("${scaleTitle}",'"'+this.nls.scaleTitle+'"');this._is3D()?(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebScene,this.nls.chooseWebMapOrWebScene=this.nls.chooseWebScene):
(this.nls.clickChooseWebMapOrWebScene=this.nls.clickChooseWebMap,this.nls.chooseWebMapOrWebScene=this.nls.selectWebMap)},postCreate:function(){this.inherited(arguments);this._init()},destroy:function(){this.appConfigPlugin=null;this.inherited(arguments)},_is3D:function(){return"HTML3D"===window.appInfo.appType},_init:function(){this.widgetsConfigCache={};this.own(v.subscribe("app/appConfigChanged",m.hitch(this,this.appConfigChanged)));this.own(v.subscribe("app/appConfigLoaded",m.hitch(this,this.appConfigLoaded)));
this.own(v.subscribe("app/mapLoaded",m.hitch(this,function(a){this._setMap(a)})));this.own(v.subscribe("app/mapChanged",m.hitch(this,function(a){this._setMap(a);this.refreshIntervalDijit.reset()})));this.own(v.subscribe("app/sceneViewLoaded",m.hitch(this,function(a){this.sceneView=a})));this.own(v.subscribe("app/sceneViewChanged",m.hitch(this,function(a){this.sceneView=a})));this.appConfigPlugin=this.pluginManager.getPluginByName("app-config");this.embeddedMapViewerHelper={portalUrl:void 0,container:void 0,
popup:void 0,webmapId:void 0,frameName:"embeddedMapViewer",hideItems:"hide\x3dshare,lnk,analysis,directions",params:"embedded\x3d1\x26locale\x3d"+dojoConfig.locale,loadingShelter:void 0,loaded:void 0,hasUnsavedChanged:void 0,readyToClose:void 0,loadInterval:void 0,unsavedInterval:void 0,webmapIdInterval:void 0,isClosing:!1};this.own(p(window,"message",m.hitch(this,this.receiveViewerMessage)));this._is3D()?k.addClass(this.mapOptions3D,"enabled"):(k.addClass(this.mapOptions2D,"enabled"),this.own(p(this.refreshIntervalDijit,
"user-input-change",m.hitch(this,this._onRefreshIntervalChange))))},_onRefreshIntervalChange:function(a){v.publish("mapRefreshIntervalChanged",a)},_setInitialExtent:function(){try{v.publish("mapOptionsChanged",{extent:this.map.extent.toJson()})}catch(K){console.error(K)}},_blinkMapContainer:function(){var a=null;if(a=this._is3D()?this.sceneView.container:this.map.container){var b=k.create("div");k.addClass(b,"blink-map-border");k.place(b,a);var c=0,e=setInterval(m.hitch(this,function(){k.toggleClass(b,
"blink-map-border-show");c++;6===c&&(b.parentNode.removeChild(b),clearInterval(e))}),200)}},_useCurrentMapExtent:function(){this.map&&(this._setInitialExtent(),this._blinkMapContainer())},_useDefaultMapExtent:function(a){E.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.appConfig&&this.appConfig.geometryService).then(m.hitch(this,function(){this._setInitialExtent();a&&this._blinkMapContainer()}),m.hitch(this,function(a){"string"===typeof a&&new F({message:a});console.error(a)}))},
showMapSelector:function(){this.hideMapOptions();var a=new D({nls:this.nls,type:"HTML3D"===window.appInfo.appType?"Web Scene":"Web Map"}),b=new B({width:1024,titleLabel:this.nls.chooseWebMapOrWebScene,content:a,container:"main-page",onClose:m.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(L){console.error(L)}a=null;return!0}),buttons:[{label:this.nls.ok,key:g.ENTER,disable:!0,classNames:["map-selector-btn-ok"],onClick:m.hitch(this,function(){var c=a.getSelectedMapItem();this._selectItem(c,
b)})},{label:this.nls.cancel,key:g.ESCAPE,classNames:["map-selector-btn-cancel","jimu-btn-vacation"],onClick:m.hitch(this,function(){b.close()})}]});this.own(p(a,"map-selected",function(){b.enableButton(0)}))},embedWebMap:function(b,c,e){this.embeddedMapViewerHelper.portalUrl=G.getStandardPortalUrl(b);b=this.embeddedMapViewerHelper.portalUrl+"/home/webmap/viewer.html?"+(e?"webmap\x3d"+e+"\x26":"")+this.embeddedMapViewerHelper.params+"\x26"+this.embeddedMapViewerHelper.hideItems;e=C.getPortal(this.embeddedMapViewerHelper.portalUrl);
b+="#"+e.credential.token;this.embeddedMapViewerHelper.container=a.create("div",{"class":"embed-mapviewer-content"});a.create("iframe",{src:b,name:this.embeddedMapViewerHelper.frameName,style:"width:100%;height:99%"},this.embeddedMapViewerHelper.container);this.embeddedMapViewerHelper.loadingShelter=a.create("div",{"class":"load-container map-loading"},this.embeddedMapViewerHelper.container);k.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","block");c=new B({titleLabel:c,content:this.embeddedMapViewerHelper.container,
container:"main-page",customPosition:{top:"5%",left:"5%",width:"90%",height:"90%"},onClose:m.hitch(this,function(){if(!0===this.embeddedMapViewerHelper.readyToClose)return!0;this._closeEmbeddedMapViewer();return!1})});c.startup();this.embeddedMapViewerHelper.popup=c;this.embeddedMapViewerHelper.loaded=!1;this.embeddedMapViewerHelper.readyToClose=!1;this.embeddedMapViewerHelper.isClosing=!1;this.embeddedMapViewerHelper.loadInterval=setInterval(m.hitch(this,function(){this.embeddedMapViewerHelper.loaded?
(k.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none"),clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=null):this.sendPostMessage({type:"isLoaded"})}),500)},showMapOptions:function(a){e.stop(a);k.setStyle(this.webMapEditOptions,"display","");k.setStyle(this.webMapOptionsMask,"display","")},hideMapOptions:function(){k.setStyle(this.webMapEditOptions,"display","none");k.setStyle(this.webMapOptionsMask,"display","none")},editWebMap:function(){this.hideMapOptions();
this.embedWebMap(this.appConfig.map.portalUrl,this.nls.editMap,this.appConfig.map.itemId)},createWebMap:function(){this.hideMapOptions();this.embedWebMap(this.appConfig.portalUrl,this.nls.createMap)},_closeEmbeddedMapViewer:function(){this.embeddedMapViewerHelper.isClosing||(this.embeddedMapViewerHelper.isClosing=!0,k.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display",""),this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.hasUnsavedChanged=void 0,this.embeddedMapViewerHelper.unsavedInterval=
setInterval(m.hitch(this,function(){if("undefined"===typeof this.embeddedMapViewerHelper.hasUnsavedChanged)this.sendPostMessage({type:"hasUnsavedChanges"});else if(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null,this.embeddedMapViewerHelper.hasUnsavedChanged)var a=new B({content:this.nls.hasUnsavedChanges,titleLabel:this.nls.customMap,autoHeight:!0,width:600,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){a.close();this._doCloseEmbeddedMapViewer()})},
{label:this.nls.cancel,onClick:m.hitch(this,function(){k.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.isClosing=!1;a.close()})}]});else this._doCloseEmbeddedMapViewer()}),500)):this._doCloseEmbeddedMapViewer())},_doCloseEmbeddedMapViewer:function(){k.setStyle(this.embeddedMapViewerHelper.loadingShelter,"display","none");this.embeddedMapViewerHelper.loadInterval&&(clearInterval(this.embeddedMapViewerHelper.loadInterval),this.embeddedMapViewerHelper.loadInterval=
null);this.embeddedMapViewerHelper.unsavedInterval&&(clearInterval(this.embeddedMapViewerHelper.unsavedInterval),this.embeddedMapViewerHelper.unsavedInterval=null);this.embeddedMapViewerHelper.loaded?(this.embeddedMapViewerHelper.webmapId=void 0,this.sendPostMessage({type:"getWebmapId"}),this.embeddedMapViewerHelper.webmapIdInterval=setInterval(m.hitch(this,function(){"undefined"!==typeof this.embeddedMapViewerHelper.webmapId&&(clearInterval(this.embeddedMapViewerHelper.webmapIdInterval),this.embeddedMapViewerHelper.webmapIdInterval=
null,a.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close(),this.embeddedMapViewerHelper.webmapId&&C.getPortal(this.embeddedMapViewerHelper.portalUrl).getItemById(this.embeddedMapViewerHelper.webmapId).then(m.hitch(this,function(a){G.isSamePortalUrl(this.appConfig.map.portalUrl,a.portalUrl)&&this.appConfig.map.itemId===a.id?v.publish("mapContentModified"):this._updateWebMap(a)})))}),
500)):(a.destroy(this.embeddedMapViewerHelper.container),this.embeddedMapViewerHelper.container=null,this.embeddedMapViewerHelper.readyToClose=!0,this.embeddedMapViewerHelper.popup.close())},sendPostMessage:function(a){this.embeddedMapViewerHelper.portalUrl&&window.frames[this.embeddedMapViewerHelper.frameName]&&window.frames[this.embeddedMapViewerHelper.frameName].postMessage(t.stringify(a),this.embeddedMapViewerHelper.portalUrl)},receiveViewerMessage:function(a){console.log("received",a.origin,
a.data);if(!(this.embeddedMapViewerHelper.portalUrl&&0>this.embeddedMapViewerHelper.portalUrl.indexOf(a.origin)))try{var b=t.parse(a.data);switch(b.type){case "webmapId":this.embeddedMapViewerHelper.webmapId=b.webmapId;break;case "loaded":this.embeddedMapViewerHelper.loaded=b.value;break;case "unsavedChanges":this.embeddedMapViewerHelper.hasUnsavedChanged=b.value;break;case "message":console.log(b.message)}}catch(L){console.log("not valid json: "+a.data)}},_selectItem:function(a,b){a&&(this._hasSameWebMap(this.appConfig,
{map:{portalUrl:a.portalUrl,itemId:a.id}})?b.close():this._updateWebMap(a,b))},_updateWebMap:function(a,b){var c=this.appConfig,c=this._getHttpWebMapItemUrl(c.map.portalUrl||c.portalUrl,c.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var e=this.widgetsConfigCache[c],g=m.clone(this.appConfig);g.map.portalUrl=a.portalUrl;g.map.itemId=a.id;var n=this._tryResetWidgetsConfigWhenMapSwitched(g);if(0<n.length){var c=u.map(n,m.hitch(this,function(a){return a.label})),p=k.toDom("\x3cdiv style\x3d'font-size:14px;line-height:22px;'\x3e\x3cdiv\x3e"+
this.nls.mapChangeConfimationTip+"\x3c/div\x3e\x3cdiv style\x3d'margin-top:25px;margin-bottom:20px;color:#596679;'\x3e"+this.nls.theseWidgetsAre+":\x3c/div\x3e\x3cul class\x3d'reset-widget-list' style\x3d'color:#596679;'\x3e\x3c/ul\x3e\x3cdiv style\x3d'margin-top:25px;'\x3e"+this.nls.sureToSwitch+"\x3c/div\x3e\x3c/div\x3e"),q=f(".reset-widget-list",p)[0];u.forEach(c,m.hitch(this,function(a,b){a=k.create("li",{innerHTML:a},q);0!==b&&(a.style.marginTop="8px")}));var t=new B({content:p,titleLabel:this.nls.mapSwitchConfimation,
autoHeight:!0,width:640,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){b&&b.close();t.close();this.appConfigPlugin.showLoadingCover();v.publish("new-webmap-item-selected",a);v.publish("setAppConfig",g);u.forEach(n,m.hitch(this,function(a){e[a.id]=a.config}))})},{label:this.nls.cancel,onClick:m.hitch(this,function(){t.close()})}]})}else b&&b.close(),this.appConfigPlugin.showLoadingCover(),this._publishMapChange(a)},_publishMapChange:function(a){v.publish("new-webmap-item-selected",a);
this._is3D()?v.publish("sceneViewChanged",{portalUrl:a.portalUrl,itemId:a.id}):v.publish("mapChanged",{portalUrl:a.portalUrl,itemId:a.id})},_hasSameWebMap:function(a,b){var c=(a=a&&a.map)&&a.itemId,e=(b=b&&b.map)&&b.itemId;return G.isSamePortalUrl(a&&a.portalUrl,b&&b.portalUrl)&&c===e},_setMap:function(a){this.map=a;this._checkCustomScaleAvailablity()},_updateChoseMapButtons:function(a){var c=this._checkUpdatePrivileges(a.map.portalUrl);a=this._checkUpdatePrivileges(a.portalUrl);b([c,a]).then(m.hitch(this,
function(a){var b=a[0];a=a[1];b||a?(k.setStyle(this.mapOptions,"display",""),k.setStyle(this.chooseMapButton,"width","140px"),k.setStyle(this.chooseMapButton,"max-width","140px"),b?k.setStyle(this.btnEditWebMap,"display",""):k.setStyle(this.btnEditWebMap,"display","none"),a?k.setStyle(this.btnCreateWebMap,"display",""):k.setStyle(this.btnCreateWebMap,"display","none")):(k.setStyle(this.mapOptions,"display","none"),k.setStyle(this.chooseMapButton,"width","100%"),k.setStyle(this.chooseMapButton,"max-width",
"100%"))}),m.hitch(this,function(){k.setStyle(this.mapOptions,"display","none");k.setStyle(this.chooseMapButton,"width","100%");k.setStyle(this.chooseMapButton,"max-width","100%")}))},_checkUpdatePrivileges:function(a){var b=new n;this._is3D()||!G.isSameServer(a,window.location.host)?b.resolve(!1):C.getPortal(a).getUser().then(m.hitch(this,function(a){var c=!1;if(a){var e=new z({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&(e.setPrivileges(a.privileges),c=e.canCreateItem())}b.resolve(c)}),
m.hitch(this,function(a){console.error(a);b.resolve(!1)}));return b},appConfigLoaded:function(a){this.setAppConfig(a);this._is3D()||this.refreshIntervalDijit.setValue(a.map.mapRefreshInterval)},appConfigChanged:function(a){this.setAppConfig(a)},setAppConfig:function(a){if(this.appConfig){var b=this._hasSameWebMap(this.appConfig,a);this.appConfig=a;b||this._requestCurrentItem()}else this.appConfig=a,this._requestCurrentItem();this._updateChoseMapButtons(this.appConfig)},_getHttpWebMapItemUrl:function(a,
b){a=G.getItemUrl(a,b);return a=G.setHttpProtocol(a)},_tryResetWidgetsConfigWhenMapSwitched:function(a){var b=[],c=this._getHttpWebMapItemUrl(a.map.portalUrl||a.portalUrl,a.map.itemId);this.widgetsConfigCache[c]||(this.widgetsConfigCache[c]={});var e=this.widgetsConfigCache[c];a.visitElement(m.hitch(this,function(a){if(!a.widgets&&a.uri&&!1===a.keepConfigAfterMapSwitched){var c=a.config,f=e&&e[a.id];f?a.config=f:delete a.config;if(!a.isDefaultConfig||f)a=m.clone(a),a.config=c,b.push(a)}}));return b},
_requestCurrentItem:function(){var a=this.appConfig&&this.appConfig.map&&this.appConfig.map.itemId;if(a){var a={q:"id:"+a,num:1,f:"json"},b=C.getPortal(this.appConfig.map&&this.appConfig.map.portalUrl);b&&b.queryItems(a).then(m.hitch(this,function(a){this.domNode&&(a=a.results,0<a.length&&this._showSelectedItem(a[0]))}),m.hitch(this,function(a){console.debug("query item from portal failed",a)}))}},_tryLocaleDate:function(a){var b=E.localizeDate(a,{selector:"date"});b||(b=a.toLocaleDateString());return b},
_showSelectedItem:function(a){this.item=a;var b=a.type.toLowerCase();k.empty(this.thumbnailContainer);k.removeClass(this.webItemIcon,"webmap");k.removeClass(this.webItemIcon,"webscene");this.webItemType.innerHTML=a.type;var c=k.create("div",{"class":"thumbnail"},this.thumbnailContainer);a.thumbnailUrl?k.setStyle(c,"backgroundImage","url("+E.url.addQueryParamToUrl(a.thumbnailUrl,"w",400)+")"):"web map"===b?k.addClass(c,"default-webmap"):"web scene"===b&&k.addClass(c,"default-webscene");"web map"===
b?k.addClass(this.webItemIcon,"webmap"):"web scene"===b&&k.addClass(this.webItemIcon,"webscene");this.snippet.innerHTML=a.snippet||"";this.lastModified.innerHTML=this._tryLocaleDate(new Date(a.modified));this.lastModified.title=this.lastModified.innerHTML;this.webMapDetails.href=a.detailsPageUrl;b=a.owner||"";this.ownerName.innerHTML=b;this.ownerName.title=b;this.ownerName.href=a.ownerPageUrl||"";this.mapTitle.innerHTML=a.title;this.mapTitle.title=a.title},_checkCustomScaleAvailablity:function(){this._isBasemapLayerSupportLods()?
(k.removeClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=""):(k.addClass(this.btnScale,"jimu-state-disabled"),this.btnScale.title=this.nls.scaleDisabledTip2)},_isBasemapLayerSupportLods:function(){var a=!1;if(this.map){var b=this.map.layerIds;b&&0<b.length&&(a=(a=this.map.getLayer(b[0]))&&a.tileInfo&&a.tileInfo.lods)}return a},_onBtnScaleClicked:function(){if(this._isBasemapLayerSupportLods())var a=new I({nls:this.nls,map:this.map}),b=new B({width:640,height:590,titleLabel:this.nls.scaleTitle,
content:a,container:"main-page",onClose:m.hitch(this,function(){try{a&&a.domNode&&a.destroy()}catch(L){console.error(L)}a=null;return!0}),buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){var c=a.getLodsFromListNode(),e=a.getLodsFromMap();b.close();var f=!1,f=c.length===e.length?u.every(c,m.hitch(this,function(a,b){b=e[b];var c=a.scale===b.scale,f=a.resolution===b.resolution;return a.level===b.level&&c&&f})):!1;f||(this.appConfigPlugin.showLoadingCover(),v.publish("mapOptionsChanged",{lods:c}))})},
{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:m.hitch(this,function(){b.close()})}]})},_setInitialViewpoint:function(a){try{v.publish("mapOptionsChanged",{initialState:{viewpoint:a}})}catch(J){console.error(J)}},_useCurrentViewpoint:function(){if(this.sceneView){var a=this.sceneView.viewpoint.toJSON();this._setInitialViewpoint(a);this._blinkMapContainer()}},_useDefaultViewpoint:function(){var a=this.sceneView.map.itemInfo.itemData.initialState.viewpoint,a=m.clone(a);this._setInitialViewpoint(a);
this._blinkMapContainer()}})})},"builder/plugins/map-config/MapSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapSelector.html dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on dojo/Evented jimu/utils jimu/dijit/TabContainer3 jimu/portalUrlUtils jimu/dijit/Search builder/portalUtils ./MapTable dijit/form/Select".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){return p([t,
v,n,c],{templateString:m,baseClass:"map-selector",tab:null,isPublicTabShow:!1,nls:null,type:"",_user:null,_group:null,_webMapQueryString:"",_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_signIn:!1,portal:null,postCreate:function(){this.inherited(arguments);this._webMapQueryString=" "+
x.getItemQueryStringByTypes([this.type])+" ";this.portal=z.getPortal(this._getPortalUrl());this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initMapTables();this._initPrivate();this._initPublic();this._bindMapTableEvents();this._updateUIbySignIn()},startup:function(){this.tab._started||(this.tab.startup(),this.tab._started=!0)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},c={title:this.nls.myOrganization,content:this.organizationTabNode},
f={title:this.nls.myGroup,content:this.groupTabNode},g={title:this.nls.publicMap,content:this.publicTabNode};this.isPublicTabShow=!1;this.tab=new w({tabs:[b,c,f,g]},this.tabNode);this.own(a(this.tab,"tabChanged",k.hitch(this,function(a){e.addClass(this.signinSection,"hidden");a!==this.nls.publicMap?(this.isPublicTabShow=!1,this._updateUIbySignIn(),this.portal.getUser().then(k.hitch(this,function(b){a===this.nls.myContent?this._searchMyContent(b):a===this.nls.myOrganization?this._searchOrganization(b):
a===this.nls.myGroup&&this._searchGroups(b)}))):(this.isPublicTabShow=!0,this._searchPublic())})))},_bindMapTableEvents:function(){this.own(a(this.mycontentMapTable,"select",k.hitch(this,this._onMapSelected)));this.own(a(this.organizationMapTable,"select",k.hitch(this,this._onMapSelected)));this.own(a(this.groupMapTable,"select",k.hitch(this,this._onMapSelected)));this.own(a(this.publicPortalMapTable,"select",k.hitch(this,this._onMapSelected)));this.own(a(this.publicOnlineMapTable,"select",k.hitch(this,
this._onMapSelected)))},_onMapSelected:function(a){if(a=a&&a.selectedNode)this.mycontentMapTable.unselect(),this.organizationMapTable.unselect(),this.groupMapTable.unselect(),this.publicPortalMapTable.unselect(),this.publicOnlineMapTable.unselect(),e.addClass(a,"selected"),this.emit("map-selected")},_updateUIbySignIn:function(){e.addClass(this.signinSection,"hidden");var a=b(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);this.portal.haveSignIn()?
a.removeClass("hidden"):(a.addClass("hidden"),this.isPublicTabShow||e.removeClass(this.signinSection,"hidden"))},_initPortalRadio:function(){var a=this._getPortalUrl(),a=q.getServerByUrl(a);q.isArcGIScom(a)?(this.portalPublicRaido.set("disabled",!0),this.onlinePublicRaido.set("checked",!0),e.addClass(this.portalPublicRaido,"hidden"),e.addClass(this.portalNameLabel,"hidden")):(this.portalPublicRaido.set("disabled",!1),this.portalPublicRaido.set("checked",!0),this.portalNameLabel.innerHTML=a)},_initSearchQuery:function(){var a=
"esri_"+(u.locale&&u.locale.slice(0,2)||"en").toLowerCase(),b=f.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),k.hitch(this,function(b){return b!==a})),c="";f.forEach(b,k.hitch(this,function(a){c+=" -owner:"+a+" "}));b=" ";this.portal.user&&this.portal.user.orgId&&(b=" orgid:"+this.portal.user.orgId+" ");b=b+this._webMapQueryString+
" AND access:public "+c;this._allPublicPortalQuery=this._getQuery({q:b});this._filterPublicPortalQuery=this._getQuery({q:b});this._allPublicOnlineQuery=this._getQuery({q:'(group:"c755678be14e4a0984af36a15f5b643e" OR  group:"b8787a74b4d74f7fb9b8fac918735153") '+this._webMapQueryString+" AND access:public"});this._filterPublicOnlineQuery=this._getQuery({q:this._webMapQueryString+" AND access:public"});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=
this._getQuery();this._filterMyContentQuery=this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return k.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return q.getStandardPortalUrl(window.portalUrl)},_initMapTables:function(){var a=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalMapTable.set("portalUrl",a),this.publicPortalMapTable.set("filteredQuery",this._filterPublicPortalQuery));
this.publicOnlineMapTable.set("portalUrl",window.location.protocol+"//www.arcgis.com");this.publicOnlineMapTable.set("filteredQuery",this._filterPublicOnlineQuery)},_initPublic:function(){this.own(a(this.portalPublicRaido,"click",k.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this.own(a(this.onlinePublicRaido,"click",k.hitch(this,function(){this._onPublicRaidoClicked();this._searchPublicByRadio()})));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?
(this.publicPortalMapTable.show(),this.publicOnlineMapTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalMapTable.hide(),this.publicOnlineMapTable.show())},_onPublicSearch:function(){var a=this._getSortFieldAndSortOrder(this.publicSelect),b=this.publicSearch.getValue();(b=b&&k.trim(b))?(this.publicPortalMapTable.showFilterMapsSection(),this.publicOnlineMapTable.showFilterMapsSection(),this._filterPublicPortalQuery.q=b+this._allPublicPortalQuery.q,this._filterPublicPortalQuery.start=
1,k.mixin(this._filterPublicPortalQuery,a),this.publicPortalMapTable.searchFilteredMaps(this._filterPublicPortalQuery),this._filterPublicOnlineQuery.q=b+this._webMapQueryString+" AND access:public",this._filterPublicOnlineQuery.start=1,k.mixin(this._filterPublicOnlineQuery,a),this.publicOnlineMapTable.searchFilteredMaps(this._filterPublicOnlineQuery)):(this.publicPortalMapTable.showAllMapsSection(),this.publicOnlineMapTable.showAllMapsSection(),this._allPublicPortalQuery.start=1,k.mixin(this._allPublicPortalQuery,
a),this.publicPortalMapTable.showAllMapsSection(this._allPublicPortalQuery),this._allPublicOnlineQuery.start=1,k.mixin(this._allPublicOnlineQuery,a),this.publicOnlineMapTable.showAllMapsSection(this._allPublicOnlineQuery))},_searchPublic:function(){this.tab.getSelectedTitle()===this.nls.publicMap&&(this.publicTabNode.isSearched||this._searchPublicByRadio())},_searchPublicByRadio:function(){this.portalPublicRaido.get("checked")?this.publicPortalMapTable.isSearched||(this._onPublicSearch(),this.publicPortalMapTable.isSearched=
!0):this.publicOnlineMapTable.isSearched||(this._onPublicSearch(),this.publicOnlineMapTable.isSearched=!0)},_initPrivate:function(){this._resetPortalMaps();this.own(g.subscribe("userSignIn",k.hitch(this,this._onSignIn)));this.own(g.subscribe("userSignOut",k.hitch(this,this._onSignOut)));this.own(a(this.groupsSelect,"change",k.hitch(this,this._onGroupsSelectChange)));var b=q.getServerByUrl(this._getPortalUrl());q.isArcGIScom(b)&&(b="ArcGIS.com");this.portal.haveSignIn()&&this._onSignIn()},_getSortFieldAndSortOrder:function(a){var b=
{};a=a.get("value");b.sortField=a;"modified"===a?b.sortOrder="desc":"numviews"===a?b.sortOrder="desc":"avgrating"===a?b.sortOrder="desc":"title"===a?b.sortOrder="asc":"owner"===a&&(b.sortOrder="asc");return b},_onOrganizationSearch:function(){var a=this._getSortFieldAndSortOrder(this.organizationSelect),b=this.organizationSearch.getValue();(b=b&&k.trim(b))?(this._filterOrganizationQuery.q=b+" "+this._allOrganizationQuery.q,this._filterOrganizationQuery.start=1,k.mixin(this._filterOrganizationQuery,
a),this.organizationMapTable.searchFilteredMaps(this._filterOrganizationQuery)):(this._allOrganizationQuery.start=1,k.mixin(this._allOrganizationQuery,a),this.organizationMapTable.showAllMapsSection(this._allOrganizationQuery))},_onMyContentSearch:function(){var a=this._getSortFieldAndSortOrder(this.mycontentSelect),b=this.mycontentSearch.getValue();(b=b&&k.trim(b))?(this._filterMyContentQuery.q=b+" "+this._allMyContentQuery.q,this._filterMyContentQuery.start=1,k.mixin(this._filterMyContentQuery,
a),this.mycontentMapTable.searchFilteredMaps(this._filterMyContentQuery)):(this._allMyContentQuery.start=1,k.mixin(this._allMyContentQuery,a),this.mycontentMapTable.showAllMapsSection(this._allMyContentQuery))},_onGroupSearch:function(){var a=this._getSortFieldAndSortOrder(this.groupSelect),b=this.groupSearch.getValue();(b=b&&k.trim(b))?(this._filterGroupQuery.q=b+" "+this._allGroupQuery.q,this._filterGroupQuery.start=1,k.mixin(this._filterGroupQuery,a),this.groupMapTable.searchFilteredMaps(this._filterGroupQuery)):
(this._allGroupQuery.start=1,k.mixin(this._allGroupQuery,a),this.groupMapTable.showAllMapsSection(this._allGroupQuery))},_onSignIn:function(){this._updateUIbySignIn();this._signIn||(this._signIn=!0,this.portal.getUser().then(k.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))})))},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationMapTable.clear();
this.mycontentMapTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){if(this.tab.getSelectedTitle()===this.nls.myOrganization&&!this.organizationTabNode.isSearched){this.organizationMapTable.clear();a=" orgid:"+a.orgId+" AND "+this._webMapQueryString+" AND (access:org OR access:public) ";var b=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationMapTable.set("portalUrl",b);this._onOrganizationSearch();
this.organizationTabNode.isSearched=!0}},_searchMyContent:function(a){if(this.tab.getSelectedTitle()===this.nls.myContent&&!this.mycontentTabNode.isSearched){this.mycontentMapTable.clear();var b=this._getPortalUrl();a="owner:"+a.username+" AND "+this._webMapQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentMapTable.set("portalUrl",b);this._onMyContentSearch();this.mycontentTabNode.isSearched=!0}},_searchGroups:function(a){if(this.tab.getSelectedTitle()===
this.nls.myGroup&&!this.groupTabNode.isSearched){this._resetGroupsSection();e.removeClass(this.groupsSection,"hidden");a=a.getGroups();if(0<a.length){e.removeClass(this.groupSearchSection,"hidden");this.groupMapTable.show();e.empty(this.groupsSelect);for(var b=0;b<a.length;b++){var c=a[b];e.create("option",{value:c.id,innerHTML:c.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length);this.groupTabNode.isSearched=!0}},_resetGroupsSection:function(){e.addClass(this.groupsSection,
"hidden");e.empty(this.groupsSelect);e.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupMapTable.clear();e.addClass(this.groupSearchSection,"hidden");this.groupMapTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?e.setStyle(this.groupsSection,"top","15px"):e.setStyle(this.groupsSection,"top","70px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupMapTable.clear();if("nodata"===a)e.addClass(this.groupSearch,
"hidden"),this.groupMapTable.hide();else{e.addClass(this.groupSearch,"hidden");this.groupMapTable.show();var b=this._getPortalUrl(),a="group:"+a+" AND "+this._webMapQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});this.groupMapTable.set("portalUrl",b);this._onGroupSearch()}},_onMyContentRefreshIconClicked:function(){this._onMyContentSearch()},_onOrgRefreshIconClicked:function(){this._onOrganizationSearch()},_onGroupRefreshIconClicked:function(){this._onGroupSearch()},
_onPublicRefreshIconClicked:function(){this._onPublicSearch()},getSelectedMapItem:function(){var a=null,c=b(".map-item-bg.selected",this.domNode);0<c.length&&(a=c[0].parentNode.item);return a}})})},"builder/plugins/map-config/MapTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator dojo/i18n!./nls/strings".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C){return p([g,t,v,m],{templateString:n,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,type:"",postMixInProperties:function(){this.nls=C},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=w.getStandardPortalUrl(this.portalUrl));this.own(a(this.allMapsTableDiv,"scroll",u.hitch(this,this._onAllMapsSectionScroll)));this.own(a(this.filteredMapsTableDiv,
"scroll",u.hitch(this,this._onFilteredMapsSectionScroll)));this._showAllMapsSection();this.searchAllMaps()},show:function(){f.removeClass(this.domNode,"hidden")},hide:function(){f.addClass(this.domNode,"hidden")},searchAllMaps:function(a){this._showAllMapsSection();a&&(this.query=u.clone(a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),x.getPortal(this.portalUrl).queryItems(this.query).then(u.hitch(this,function(b){this.domNode&&
(a&&this.clearAllMapsSection(),this.allMapsShelter.hide(),this.query.start=b.nextStart,this._createMapItems(b,this.allMapsTbody))}),u.hitch(this,function(a){console.error(a);this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this._showFilterMapsSection();a&&(this.filteredQuery=u.clone(a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),x.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(u.hitch(this,
function(b){this.domNode&&(this._showFilterMapsSection(),a&&this.clearFilteredMapsSection(),this.filteredQuery.start=b.nextStart,this._createMapItems(b,this.filteredMapsTbody),this._filterMapCallback())}),u.hitch(this,function(a){console.error(a);this.domNode&&this._filterMapCallback()})))},_filterMapCallback:function(){this.filteredMapsShelter.hide();0<this._getWebMapCount(this.filteredMapsTbody)?(f.removeClass(this.filteredMapsTableDiv,"hidden"),f.addClass(this.searchNoneTipSection,"hidden")):(f.addClass(this.filteredMapsTableDiv,
"hidden"),f.removeClass(this.searchNoneTipSection,"hidden"))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},clearAllMapsSection:function(){f.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){f.empty(this.filteredMapsTbody)},showAllMapsSection:function(a){this._showAllMapsSection();a&&this.searchAllMaps(a)},_showAllMapsSection:function(){f.removeClass(this.allMapsSection,"hidden");f.addClass(this.filteredMapsSection,"hidden")},showFilterMapsSection:function(a){this._showFilterMapsSection();
a&&this.searchFilteredMaps(a)},_showFilterMapsSection:function(){f.addClass(this.allMapsSection,"hidden");f.removeClass(this.filteredMapsSection,"hidden");f.removeClass(this.filteredMapsTableDiv,"hidden");f.addClass(this.searchNoneTipSection,"hidden")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return c.isScrollToBottom(a)},
_createMapItems:function(a,c){a=k.filter(a.results,u.hitch(this,function(a){return a.type.toLowerCase()===this.type.toLowerCase()}));if(0!==a.length){var e={},g,m=b("td.empty",c),n;if(0<m.length){var p=Math.min(a.length,m.length),q=a.splice(0,p);for(n=0;n<p;n++){var t=m[n];g=this._createMapItem(q[n]);e[g.item.id]=g;f.place(g,t);f.removeClass(t,"empty")}}if(0!==a.length){m=Math.ceil(a.length/5);for(n=0;n<m;n++)for(g=f.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
f.place(g,c),p=b("td",g),q=0;q<p.length;q++)t=p[q],(g=a[5*n+q])?(g=this._createMapItem(g),e[g.item.id]=g,f.place(g,t)):f.addClass(t,"empty");!this.getSelectedMapItem()&&this.appConfig&&this.appConfig.map.itemId&&(g=e[this.appConfig.itemId])&&(c=b(".map-item-bg",g),f.addClass(c,"selected"))}}},_getWebMapCount:function(a){return b(".map-item-div",a).length},_createMapItem:function(e){var g=f.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail jimu-auto-vertical'\x3e\x3cdiv class\x3d'none-thumbnail-tip jimu-auto-vertical-content'\x3e\x3c/div\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
k=b(".map-item-bg",g)[0],m=b(".map-item-thumbnail",g)[0],n=b(".map-item-title",g)[0],p=b(".map-item-detail-icon",g)[0];b(".none-thumbnail-tip",g);p.href=e.detailsPageUrl;p.title=this.nls.viewItemDetails||"";g.item=e;p=e.thumbnailUrl||c.getDefaultWebMapThumbnail();f.setStyle(m,"backgroundImage","url("+p+")");this.own(a(k,"click",u.hitch(this,this._onMapItemBgClick)));n.innerHTML=e.title;n.title=e.title;return g},unselect:function(){b(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=
a.target||a.srcElement;var b=null;f.hasClass(a,"map-item-thumbnail")?b=a.parentNode:f.hasClass(a,"none-thumbnail-tip")&&(b=a.parentNode.parentNode);b&&f.hasClass(b,"map-item-bg")&&(this.unselect(),f.addClass(b,"selected"),this.emit("select",{mapTable:this,selectedNode:b}))},getSelectedMapItem:function(){var a=null,c=b(".map-item-bg.selected",this.domNode);0<c.length&&(a=c[0].parentNode.item);return a}})})},"builder/plugins/map-config/CustomizeScale":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomizeScale.html dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/dijit/Message dijit/form/NumberTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return p([g,t,v],{templateString:n,baseClass:"mapconfig-customize-scale",map:null,postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.scaleNumberBox=new a({placeholder:this.nls.scale,intermediateChanges:!0,trim:!0,constraints:{min:1,pattern:"###############0.################"},style:"width:550px;height:100%;"});f.addClass(this.scaleNumberBox.domNode,"jimu-float-leading");this.scaleNumberBox.placeAt(this.scaleInputDiv,"first");
var b=this.getLodsFromMap();this._resetLodListByLods(b)},getLodsFromMap:function(){var a=[];this.map._params&&this.map._params.lods&&(a=k.map(this.map._params.lods,u.hitch(this,function(a){return a.toJson()})));return a},_getLodsFromBasemapLayer:function(){var a=[],b=this.map.getLayer(this.map.layerIds[0]);b&&b.tileInfo&&b.tileInfo.lods&&(a=k.map(b.tileInfo.lods,u.hitch(this,function(a){return{level:a.level,resolution:a.resolution,scale:a.scale}})));return a},getLodsFromListNode:function(){for(var a=
this._getLodItems(),b=[],e=null,f=0;f<a.length;f++)e=a[f].lod,b.push({level:e.level,scale:e.scale,resolution:e.resolution});return b},_resetLodListByLods:function(a){f.empty(this.listNode);k.forEach(a,u.hitch(this,function(a){a=this._createLodItem(a);f.place(a,this.listNode)}))},_createLodItem:function(a){var b=f.create("div",{innerHTML:e.localizeNumber(a.scale),"class":"lod-item"});b.lod=a;return b},_getLodItems:function(){return m(".lod-item",this.listNode)},_getSelectedLodItem:function(){var a=
null,b=m(".selected",this.listNode);0<b.length&&(a=b[0]);return a},_selectLodItem:function(a){this._removeSelectedClass();f.addClass(a,"selected");f.addClass(this.btnDelete,"enabled-operation");a.previousSibling||f.setStyle(a,"borderTop","0")},_removeSelectedClass:function(){m(".lod-item",this.listNode).removeClass("selected");f.removeClass(this.btnDelete,"enabled-operation")},_onLodListClicked:function(a){a=a.target||a.srcElement;f.hasClass(a,"lod-item")&&this._selectLodItem(a)},_onBtnAddClicked:function(){if(this.scaleNumberBox.validate()){var a=
this.scaleNumberBox.get("value");this.scaleNumberBox.set("displayedValue","");var b=this._getLodItems();if(0!==b.length&&!k.some(b,u.hitch(this,function(b){return b.lod.scale===a}))){var e=b.length-1,g=b[0].lod,m=b[e].lod,n=null,n={level:null,resolution:g.resolution/g.scale*a,scale:a};if(n.scale>g.scale)n.level=g.level-1,n=this._createLodItem(n),f.place(n,this.listNode,"first");else if(n.scale<m.scale)n.level=m.level+1,n=this._createLodItem(n),f.place(n,this.listNode);else for(var p=null,g=null,m=
e;1<=m;m--)if(p=b[m],g=b[m-1],n.scale>p.lod.scale&&n.scale<g.lod.scale){n.level=p.lod.level;n=this._createLodItem(n);f.place(n,g,"after");for(n=m;n<=e;n++)b[n].lod.level+=1;break}}}},_onBtnDeleteClicked:function(){var a=this._getSelectedLodItem();if(a)if(1===this.getLodsFromListNode().length)new b({message:this.nls.atLeastOneScale});else{var e=a;if(!a.previousSibling)for(;a.nextSibling;)a=a.nextSibling,--a.lod.level;f.destroy(e);this._removeSelectedClass()}},_onBtnResetClicked:function(){this._removeSelectedClass();
var a=this._getLodsFromBasemapLayer();this._resetLodListByLods(a)}})})},"builder/plugins/popup-actions/configmode-switch/_build-generate_module":function(){define(["builder/plugins/popup-actions/configmode-switch/Plugin","dojo/i18n!builder/plugins/popup-actions/configmode-switch/nls/strings"],function(){})},"builder/plugins/popup-actions/configmode-switch/Plugin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","builder/BasePlugin"],function(p,g,t,v){return p([v],{baseClass:"plugin-app-actions-popup-saveas",
disabled:null,postCreate:function(){this.inherited(arguments);this._bindEvent();this.label=this.nls.advanceConfigLabel;this.isAdvance=!1},onClick:function(){var g=this.pluginManager.getPluginByName("app-config");this.isAdvance?(this.isAdvance=!1,this.label=this.nls.advanceConfigLabel,g.switchToTemplateConfigPart()):(this.isAdvance=!0,this.label=this.nls.templateConfigLabel,g.switchToPreviewConfig())},_bindEvent:function(){this.own(t.subscribe("app/appConfigLoaded",g.hitch(this,this._setAppConfig)))},
_setAppConfig:function(g){this.appConfig=g;g.templateConfig&&g.isTemplateApp||g.templateConfig&&g._appData?(this.visible=!0,this.isAdvance=!1):(this.visible=!1,this.isAdvance=!0)}})})},"builder/plugins/popup-actions/popup-agoltemplate/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-agoltemplate/Plugin","dojo/text!builder/plugins/popup-actions/popup-agoltemplate/css/style.css","dojo/i18n!builder/plugins/popup-actions/popup-agoltemplate/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-agoltemplate/Plugin":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all dojo/Deferred dojo/on dojo/topic dojo/_base/html dojo/json builder/BasePlugin builder/serviceUtils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/dijit/Popup jimu/Role builder/dijit/template-config/Template builder/dijit/template-config/utils builder/dijit/TemplateAttributes".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){return p([e],{baseClass:"plugin-app-actions-popup-template",disabled:null,postMixInProperties:function(){this.inherited(arguments);this.nls=t.mixin(this.nls,builderNls)},constructor:function(){"HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id?this.disabled=!0:a.getPortal(window.portalUrl).getUser().then(t.hitch(this,function(a){this.user=a;var b=new q({id:a.roleId?a.roleId:a.role,role:a.role});a.privileges&&b.setPrivileges(a.privileges);b.isAdmin()?
this.disabled=!1:a.username===window.appInfo.appOwner&&(window.isXT||b.canCreateItem())?this.disabled=!1:this.disabled=!0}),t.hitch(this,function(a){this.disabled=!0;console.log(a)}))},postCreate:function(){this.inherited(arguments);this.label=this.nls.exportTitle;var a=this.pluginManager.getPluginByName("startup");this.shelter=(new x({hidden:!0})).placeAt(a.domNode);this._bindEvent()},onClick:function(){if(!this.disabled){var e=new n,f=window.appInfo.id;this.shelter.show();window.isXT?b.getAppInfo(f).then(t.hitch(this,
function(a){e.resolve(a)}),function(){e.reject()}):a.getPortal(c.getPortalUrlFromLocation()).getItemData(f).then(t.hitch(this,function(a){a=a.agolTemplateInfo;!a&&this.appConfig.agolTemplateJson&&(a={itemId:null,json:this.appConfig.agolTemplateJson});a={id:f,name:this.pluginManager.getPluginByName("header").getAppName(),agolTemplateInfo:a};e.resolve(a)}),function(){e.reject()});var g=z.loadAllWidgetConfigs(t.clone(this.appConfig)),k=this.pluginManager.getPluginByName("app-actions.save-app").saveApp();
v({app:e,appConfig:g,saveApp:k}).then(t.hitch(this,function(a){var b=a.app;this._createAGOLTemplate(b,a.appConfig);this._createAGOLTemplatePrview();this.popupDlg(b);this.shelter.hide()}),t.hitch(this,function(a){console.error(a.message);this.shelter.hide()}))}},popupDlg:function(a){var b=k.create("div",{"class":"template-popup-content"});this.popup=new w({content:b,"class":"plugin-app-actions-template-popup",container:"main-page",titleLabel:this.nls.title,height:668,horizontalWidthRate:.9,buttons:[{label:this.nls.exportStr,
onClick:t.hitch(this,this._onExportClick)},{label:this.nls.saved,onClick:t.hitch(this,this._onSaveClick)},{label:this.nls.close,classNames:["jimu-btn-vacation"],onClick:t.hitch(this,this._onCancelClick)}]});this._initPopup(a);this.agoltemplateDijit.loading.placeAt(this.popup.domNode);this.popup.configPart=k.create("div",{"class":"config-part jimu-float-leading"},b);a=k.create("div",{"class":"privew-part-box jimu-float-leading"},b);a=k.create("div",{"class":"privew-part-inset-box"},a);this.popup.previewPart=
k.create("div",{"class":"privew-part"},a);k.place(this.agoltemplateDijit.domNode,this.popup.configPart);k.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_onExportClick:function(a){window.isXT?k.hasClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")?k.removeClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):k.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden"):this.agoltemplateDijit.exportOrUpdateAGOLTemplate();a.stopPropagation()},_onExportAGOLTemplateClick:function(a){this._hasCreateItemPrivilege()?
this.agoltemplateDijit.exportOrUpdateAGOLTemplate():a.stopPropagation()},_onExportWABTemplateClick:function(){this.agoltemplateDijit.exportWABTemplate()},_onSaveClick:function(){k.setAttr(this.popup.enabledButtons[1],"innerHTML",this.nls.saving);this.agoltemplateDijit.saveAgolTemplate().then(t.hitch(this,function(){this._disablePopupButton(1,this.nls.saved)}))},_onCancelClick:function(){if(this.agoltemplateDijit.hasChanged())var a=new w({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image jimu-float-leading'src\x3d'"+
this.folderUrl+"/css/images/alert.png' style\x3d'margin-left:20px;margin-right:20px;'\x3e\x3c/img\x3e\x3cspan style\x3d'display:inline-block;width:285px'\x3e"+this.nls.unSaveMeg+"\x3c/span\x3e\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:t.hitch(this,function(){this.agoltemplateDijit.saveAgolTemplate().then(t.hitch(this,function(){a.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()}))})},{label:this.nls.doNotSave,
onClick:t.hitch(this,function(){a.close();this._closePopup();this.agoltemplateDijit.destroyRecursive()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:t.hitch(this,function(){a.close()})}]});else this._closePopup(),this.agoltemplateDijit.destroyRecursive()},_closePopup:function(){this.popup&&(this.popup.closeTemplate=!0,this.popup.close())},_initPopup:function(b){this.popup.disableButton(1);this.popup.onClose=t.hitch(this,function(){if(this.popup.closeTemplate)return!0;this._onCancelClick();
return!1});if(window.isXT){this.popup.exportDrawBoxDomNode=k.create("div",{"class":"export-draw-box export-draw-box-hiden"});var c;c=this._hasCreateItemPrivilege()?"export-draw-box-btn":"export-draw-box-btn export-draw-box-btn-disable";this.popup.exportAGOLTemplateDomNode=k.create("div",{"class":c,innerHTML:this.nls.exportAGOLTemplate},this.popup.exportDrawBoxDomNode);this.popup.exportWABTemplateDomNode=k.create("div",{"class":"export-draw-box-btn",innerHTML:this.nls.exportWABTemplate},this.popup.exportDrawBoxDomNode);
k.addClass(this.popup.domNode,"plugin-app-actions-template-popup-for-xt");k.addClass(this.popup.enabledButtons[0],"export-btn");k.place(this.popup.exportDrawBoxDomNode,this.popup.enabledButtons[0]);this.popup.own(m(this.popup,"click",t.hitch(this,function(){k.addClass(this.popup.exportDrawBoxDomNode,"export-draw-box-hiden")})));this.popup.own(m(this.popup.exportAGOLTemplateDomNode,"click",t.hitch(this,this._onExportAGOLTemplateClick)));this.popup.own(m(this.popup.exportWABTemplateDomNode,"click",
t.hitch(this,this._onExportWABTemplateClick)))}else this._hasCreateItemPrivilege()||this.popup.disableButton(0);b.agolTemplateInfo&&b.agolTemplateInfo.itemId&&a.getPortal(window.portalUrl).getItemById(b.agolTemplateInfo.itemId).then(t.hitch(this,function(){window.isXT?k.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):k.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.update)}),t.hitch(this,function(){b.agolTemplateInfo.itemId=null;window.isXT?k.setAttr(this.popup.exportAGOLTemplateDomNode,
"innerHTML",this.nls.exportAGOLTemplate):k.setAttr(this.popup.enabledButtons[0],"innerHTML",this.nls.exportStr)}))},_disablePopupButton:function(a,b){this.popup.disableButton(a);k.setAttr(this.popup.disabledButtons[a],"innerHTML",b)},_enablePopupButton:function(a,b){this.popup.enableButton(a);k.setAttr(this.popup.enabledButtons[a],"innerHTML",b)},_createAGOLTemplate:function(a,b){var c;c=a.agolTemplateInfo&&a.agolTemplateInfo.json?f.parse(a.agolTemplateInfo.json):b.templateConfig?b.templateConfig:
null;this.agoltemplateDijit=new C({appConfig:b,appInfo:a,templateConfig:c});this.own(this.agoltemplateDijit.on("hasChanged",t.hitch(this,function(a){a?this._enablePopupButton(1,this.nls.save):this._disablePopupButton(1,this.nls.saved);this._refreshAGOLTempaltePrview()})));this.own(this.agoltemplateDijit.on("exported",t.hitch(this,function(a,b){a&&(window.isXT&&this.popup.exportAGOLTemplateDomNode?b&&k.setAttr(this.popup.exportAGOLTemplateDomNode,"innerHTML",this.nls.updateAGOLTemplate):this._enablePopupButton(0,
this.nls.update))})));this.agoltemplateDijit.startup()},_createAGOLTemplatePrview:function(){var a;this.agoltemplateDijit&&(a=this.agoltemplateDijit.getTemplateConfig());this.agoltemplatePrivew=new E({templateConfig:a});this.agoltemplatePrivew.startup()},_refreshAGOLTempaltePrview:function(){this.agoltemplatePrivew&&this.agoltemplatePrivew.destroy();this._createAGOLTemplatePrview();k.place(this.agoltemplatePrivew.domNode,this.popup.previewPart)},_bindEvent:function(){this.own(u.subscribe("app/appConfigLoaded",
t.hitch(this,this._setAppConfig)));this.own(u.subscribe("app/appConfigChanged",t.hitch(this,this._setAppConfig)))},_setAppConfig:function(a){this.appConfig=a;this.visible=a.templateConfig&&a.isTemplateApp||!a.templateConfig?!0:!1},_hasCreateItemPrivilege:function(){var a=!1;this.user?g.forEach(this.user.privileges,function(b){0<=b.indexOf("createItem")&&(a=!0)},this):a=!0;return a}})})},"builder/plugins/popup-actions/popup-saveas/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-saveas/Plugin",
"dojo/i18n!builder/plugins/popup-actions/popup-saveas/nls/strings"],function(){})},"builder/plugins/popup-actions/popup-saveas/Plugin":function(){define("dojo/_base/declare dojo/_base/lang builder/BasePlugin jimu/Role jimu/portalUrlUtils builder/portalUtils".split(" "),function(p,g,t,v,n,m){return p([t],{baseClass:"plugin-app-actions-popup-saveas",disabled:null,constructor:function(){if("HTML"===window.appInfo.id||"HTML3D"===window.appInfo.id)this.disabled=!0;else if(window.isXT)this.disabled=!1;
else{var p=n.getStandardPortalUrl(window.portalUrl);m.getPortal(p).getUser().then(g.hitch(this,function(g){var f=new v({id:g.roleId?g.roleId:g.role,role:g.role});g.privileges&&f.setPrivileges(g.privileges);f.canCreateItem()||(this.disabled=!0)}),g.hitch(this,function(){this.disable=!0}))}},postCreate:function(){this.inherited(arguments);this.label=this.nls.label},onClick:function(){if(!this.disabled){var m=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[m.pluginName]).then(g.hitch(this,
function(g){g.popupSaveAsDlg(this.nls.saveAsTitle,window.appInfo.id,window.appConfig)}))}}})})},"builder/plugins/popup-actions/popup-share/_build-generate_module":function(){define(["builder/plugins/popup-actions/popup-share/Plugin"],function(){})},"builder/plugins/popup-actions/popup-share/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys jimu/dijit/Popup builder/BasePlugin jimu/portalUrlUtils jimu/dijit/ShareOptions jimu/dijit/ShareLink dojo/topic dojo/query jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return p([u],{baseClass:"plugin-app-actions-popup-share",disabled:null,_isShowFindLocation:!0,postCreate:function(){this.inherited(arguments);this.label=window.jimuNls.common.share;this.own(b.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(b.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoadedOrChanged)));this.own(b.subscribe("ShareOptions/onClickEveryone",g.hitch(this,function(a){if(this.shareLink&&this.shareLink.onShareToPublicChanged)this.shareLink.onShareToPublicChanged(a)})));
this.own(b.subscribe("ShareLink/onHideContainer",g.hitch(this,function(){this.hide()})));this.own(b.subscribe("ShareLink/onShowContainer",g.hitch(this,function(){this.show()})));this.own(b.subscribe("ShareLink/onHideLinkOptions",g.hitch(this,function(){this._changeBtnsByShareLink("hide")})));this.own(b.subscribe("ShareLink/onShowLinkOptions",g.hitch(this,function(){this._changeBtnsByShareLink("show")})))},onClick:function(){this.disabled||this.popupDlg()},_onAppConfigLoadedOrChanged:function(a){this._isShowFindLocation=
this._findSearchWidget(a);this.shareLink&&this.shareLink.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation})},_findSearchWidget:function(a){a=a.getConfigElementsByName("Search");return 0<a.length&&a[0].visible},popupDlg:function(){var a=this._initContent(),b=this._initPupupBtns(),e=this._initPopupHeight();this.sharePopup=new m({content:a,"class":"share-container",container:"main-page",titleLabel:window.jimuNls.common.share,width:640,height:e,buttons:b});this.shareLink.startup();
this.shareOptions&&this.shareOptions.startup()},_onOkClick:function(){this.shareOptions&&this.shareOptions.share();this.sharePopup.close()},_onCancelClick:function(){this.sharePopup.close()},_initContent:function(){var a=t.create("div",{"class":"template-popup-content"});t.create("div",{"class":"app-name"},a);window.isXT||(this.shareOptions=new f(window.appConfig.portalUrl),this.shareOptions.placeAt(a));this.shareLink=new e({portalUrl:window.appConfig.portalUrl,appTitle:window.appInfo.name,isOnline:k.isOnline(window.top.location.href),
isShowSocialMediaLinks:!0,isSharedToPublic:!1,isShowBackBtn:!1,isShowFindLocation:this._isShowFindLocation});this.shareLink.placeAt(a);return a},_initPupupBtns:function(){var a=[];this.shareOptions&&a.push({label:window.jimuNls.common.ok,key:n.ENTER,isHighLight:!0,onClick:g.hitch(this,this._onOkClick)});a.push({label:window.jimuNls.common.cancel,classNames:["jimu-btn-vacation"],key:n.ESCAPE,onClick:g.hitch(this,this._onCancelClick)});return a},_initPopupHeight:function(){var a=560;this.shareOptions&&
(a=600);return a},_changeBtnsByShareLink:function(a){var b=this.shareOptions?1:0;"hide"===a?(this.sharePopup.setTitleLabel(window.jimuNls.common.share),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel}),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel})):"show"===a&&(this.sharePopup.setTitleLabel(window.jimuNls.shareLink.linkOptions),this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.back}),this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.back}),
this._disableShareBtn(),this.own(v.once(this.sharePopup,"Close",g.hitch(this,function(){this.sharePopup.setTitleLabel(window.jimuNls.common.share);this.sharePopup.setButtonProps(b,{title:window.jimuNls.common.cancel});this.sharePopup.setButtonProps(b,{label:window.jimuNls.common.cancel});this._enableShareBtn();this.shareLink._toggleLinkOptions();return!1}))))},_disableShareBtn:function(){this.shareOptions&&this.sharePopup.hideButton(0)},_enableShareBtn:function(){this.shareOptions&&this.sharePopup.showButton(0)},
hide:function(){a("#main-page \x3e .jimu-overlay").style("display","none");a("#main-page \x3e .jimu-popup").style("display","none")},show:function(){a("#main-page \x3e .jimu-overlay").style("display","block");a("#main-page \x3e .jimu-popup").style("display","block")}})})},"jimu/dijit/ShareOptions":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang esri/lang dojo/_base/array dojo/dom-style dojo/on dojo/dom dojo/query dojo/topic dojo/text!./templates/ShareOptions.html jimu/shareUtils dijit/form/Textarea dijit/form/CheckBox dijit/layout/BorderContainer".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x){return p([g,t,v],{templateString:c,declaredClass:"jimu.dijit.ShareOptions",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.shareOptions},constructor:function(a){this.portalUrl=a},startup:function(){x.getShareInfo(this.portalUrl).then(n.hitch(this,function(a){this._initShow(a);this.own(f(e.byId("share-everyone-check"),"change",n.hitch(this,this.clickEveryone)))}))},_initShow:function(a){this.shareInfo=a;this.shareInfo.items=[this.shareInfo.item];
this.shareInfo.sortField="title";(this.shareInfo.userRole.isAdmin()||this.shareInfo._roleCanUpdateItems&&this.shareInfo._roleCanShare||this.shareInfo._roleCanShareOthersItems)&&this.shareInfo.itemUser?this.showAdmin(this.shareInfo.user.groups,this.shareInfo.itemUser,this.shareInfo.adminGroups):this.shareInfo.user&&x._isUserOwnTheApp(this.shareInfo.user)?this.show(this.shareInfo.user.groups):this.shareInfo.user&&("public"===this.shareInfo.item.access||"shared"===this.shareInfo.item.access||"org"===
this.shareInfo.item.access&&this.shareInfo.currentUser.orgId)?this.showGroups(this.shareInfo.user.groups):this.show(this.shareInfo.user.groups)},clear:function(){e.byId("share-groups-list").innerHTML="";e.byId("share-everyone-check").setAttribute("value",!1);e.byId("share-account-check").setAttribute("value",!1);e.byId("share-groups-check").setAttribute("value",!1);k.set(e.byId("share-everyone-check_div"),"display","none");k.set(e.byId("share-account-check_div"),"display","none");this.shareInfo.shareType=
"item"},showAdmin:function(a,b,c){this.shareInfo.itemUser=b;this.shareInfo.userGroups=u.filter(a||[],n.hitch(this,function(){return!this.shareInfo.item.capabilities||!this.shareInfo.item.capabilities.length}));this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.shareInfo.adminGroups=this.filterAdminGroups(c);this.checkForAccount("admin")},filterAdminGroups:function(a){if(a){for(var b=[],c=0;c<this.shareInfo.user.groups.length;c++)b.push(this.shareInfo.user.groups[c].id);for(var e=[],
c=0;c<a.length;c++)-1!==u.indexOf(b,a[c].id)||a[c].capabilities&&a[c].capabilities.length||e.push(a[c]);return e}return null},showGroups:function(a){this.shareInfo.userGroups=this.filterOwnedGroups(a);this.shareInfo.userGroups&&this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.clear();this.shareInfo.shareType="group";this.checkForAccount("group")},filterOwnedGroups:function(a){if(a){for(var b=[],c,e=0;e<a.length;e++)c=a[e],!c.userMembership||"owner"!==c.userMembership.memberType&&
"admin"!==c.userMembership.memberType||c.capabilities&&c.capabilities.length||b.push(c);return b}return null},show:function(a){this.shareInfo.userGroups=this.filterViewOnlyGroups(a);this.shareInfo.userGroups.sort(n.hitch(this,this._sortFunc));this.checkForAccount("item")},filterViewOnlyGroups:function(a){if(a){for(var b=[],c,e=0;e<a.length;e++)c=a[e],c.capabilities&&c.capabilities.length||(!c.userMembership||"owner"!==c.userMembership.memberType&&"admin"!==c.userMembership.memberType)&&m.isDefined(c.isViewOnly)&&
c.isViewOnly||b.push(c);return b}return null},checkForAccount:function(a){e.byId("share-account-check-label").innerHTML=this.shareInfo.organization.name;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg||k.set(e.byId("share-account-check_div"),"display","none");this.clear();this.shareInfo.shareType=a;var b=this.shareInfo.items[0];this.shareInfo.lowestAccess=this.findLowestAccessLevel(this.shareInfo.items);x.getItemById(b,this.portalUrl).then(n.hitch(this,
function(a){b.sharing=a.sharing;"admin"===this.shareInfo.shareType?x.getItemByUserAndItemId(b,this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(n.hitch(this,function(a){b.sharing=a.sharing;this.buildAdminList()})):"group"===this.shareInfo.shareType?x.getItemsGroups(b,this.portalUrl).then(n.hitch(this,function(a){var c=[];if(a.admin)for(var e=0;e<a.admin.length;e++)c.push(a.admin[e].id);b.sharing={groups:c};this.buildGroupList()})):"item"===this.shareInfo.shareType&&x.getItemByUserAndItemId(b,
this.shareInfo.itemUser,this.shareInfo.user,this.portalUrl).then(n.hitch(this,function(a){b.sharing=a.sharing;this.buildList()}))}))},buildAdminList:function(){var a,b,c;if(this.shareInfo.user.groups&&0<this.shareInfo.user.groups.length||this.shareInfo.adminGroups&&0<this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?k.set(e.byId("share-groups-div"),"display","block"):k.set(e.byId("share-groups-div"),
"display","none");this.shareInfo.itemsAreSharedToGroups=",";var g=[],m=null,p=null;b=[];for(a=0;a<this.shareInfo.items.length;a++)if(m=this.shareInfo.items[a],m.sharing)for(c=0;c<m.sharing.groups.length;c++)if(p=m.sharing.groups[c],-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+p+","))this.shareInfo.itemsAreSharedToGroups+=p+",",b=[],b[0]=p,b[1]=1,g[g.length]=b;else for(b=0;b<g.length;b++)if(g[b][0]===p){g[b][1]+=1;break}m="";c=!1;var t,u;for(a=0;a<this.shareInfo.user.groups.length;a++){p=
this.shareInfo.user.groups[a];t="";u=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+p.id+","))for(t="checked",c=!0,b=0;b<g.length;b++)if(g[b][0]===p.id){u=g[b][1];break}m=u<this.shareInfo.items.length?m+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+
'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+p.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"' class\x3d'labels'\x3e"+p.title+"\x3c/label\x3e"):m+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox" class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"' class\x3d'labels'\x3e"+p.title+"\x3c/label\x3e");
m=this._addOpenDataStr(p,m);m+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(m+='\x3cdiv style\x3d"display:block;"\x3e\x3chr/\x3e\x3c/div\x3e',b=0;b<this.shareInfo.adminGroups.length;b++){p=this.shareInfo.adminGroups[b];t="";u=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+p.id+",")){t="checked";c=!0;for(var v=0;v<g.length;v++)if(g[v][0]===p.id){u=g[v][1];break}}m=
u<this.shareInfo.items.length?m+('\x3cdiv id\x3d"img_group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+(b+a)+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+p.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
(b+a)+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+p.title+"\x3c/label\x3e"):m+('\x3cdiv id\x3d"group_'+(b+a)+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+(b+a)+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+p.title+"\x3c/label\x3e");m=this._addOpenDataStr(p,m);m+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(f(e.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=m;if(this.shareInfo.organization){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&g++;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg?
(0===g?(dijit.byId("share-account-check").set("checked",!1),dijit.byId("share-account-check").set("disabled",!1)):g===this.shareInfo.items.length?(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!1)):(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0)),k.set(e.byId("share-account-check_div"),"display","block")):(dijit.byId("share-account-check").set("disabled",!0),k.set(e.byId("share-account-check_div"),
"display","none"))}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=g=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&g++;0===g?(dijit.byId("share-everyone-check").set("checked",!1),k.set(e.byId("share-everyone-check_div"),"display","block")):(g===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",!0),k.set(e.byId("share-everyone-check_div"),"display","block")):
dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",dijit.byId("share-everyone-check").get("checked"))));this.clickEveryone()}else dijit.byId("share-everyone-check").set("checked",!1),k.set(e.byId("share-everyone-check_div"),"display","none");c?dijit.byId("share-groups-check").set("checked",
!0):dijit.byId("share-groups-check").set("checked",!1);this.own(f(e.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&this.own(f(e.byId("share-account-check"),"click",n.hitch(this,this.clickAccount)))},buildList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?
this.shareInfo.userGroups&&0<this.shareInfo.userGroups.length&&k.set(e.byId("share-groups-div"),"display","block"):k.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var c=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var m=0;m<g.sharing.groups.length;m++){var p=g.sharing.groups[m];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+p+","))this.shareInfo.itemsAreSharedToGroups+=p+",",b=[],b[0]=p,b[1]=1,
c[c.length]=b;else for(b=0;b<c.length;b++)if(c[b][0]===p){c[b][1]+=1;break}}}m="";g=!1;for(a=0;a<this.shareInfo.userGroups.length;a++){var p=this.shareInfo.userGroups[a],t="",u=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+p.id+","))for(t="checked",g=!0,b=0;b<c.length;b++)if(c[b][0]===p.id){u=c[b][1];break}m=u<this.shareInfo.items.length?m+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+
a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+p.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+p.title+"\x3c/label\x3e"):m+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+a+"'\x3e"+p.title+"\x3c/label\x3e");m=this._addOpenDataStr(p,
m);m+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(f(e.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=m;if(this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)){for(a=c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"org"===this.shareInfo.items[a].sharing.access&&c++;0===c?dijit.byId("share-account-check").set("checked",
!1):dijit.byId("share-account-check").set("checked",!0);k.set(e.byId("share-account-check_div"),"display","block")}if(!this.shareInfo.organization||this.shareInfo._orgUserCanSharePublicOrOverride){for(a=c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&c++;0===c?(dijit.byId("share-everyone-check").set("checked",!1),k.set(e.byId("share-everyone-check_div"),"display","block")):(c===this.shareInfo.items.length?(dijit.byId("share-everyone-check").set("checked",
!0),k.set(e.byId("share-everyone-check_div"),"display","block")):dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),k.set(e.byId("share-everyone-check_div"),"display","block")));this.clickEveryone()}else if(this.shareInfo.organization&&!this.shareInfo.organization.canSharePublic){for(a=
c=0;a<this.shareInfo.items.length;a++)this.shareInfo.items[a].sharing&&"public"===this.shareInfo.items[a].sharing.access&&c++;c?(dijit.byId("share-everyone-check").set("checked",!0),this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&(dijit.byId("share-account-check").set("checked",!0),k.set(e.byId("share-account-check_div"),"display","block"))):(dijit.byId("share-everyone-check").set("checked",
!1),k.set(e.byId("share-everyone-check_div"),"display","none"))}else dijit.byId("share-everyone-check").set("checked",!1),k.set(e.byId("share-everyone-check_div"),"display","none");g?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(f(e.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)));this.shareInfo.organization&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&
this.own(f(e.byId("share-account-check"),"click",n.hitch(this,this.clickAccount)))},buildGroupList:function(){var a,b;!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToGroup||this.shareInfo._roleCanShareOthersItemsToGroup?0<this.shareInfo.userGroups.length&&k.set(e.byId("share-groups-div"),"display","block"):k.set(e.byId("share-groups-div"),"display","none");this.shareInfo.itemsAreSharedToGroups=",";var c=[];for(a=0;a<this.shareInfo.items.length;a++){var g=this.shareInfo.items[a];if(g.sharing)for(var m=
0;m<g.sharing.groups.length;m++){var p=g.sharing.groups[m];if(-1===this.shareInfo.itemsAreSharedToGroups.indexOf(","+p+","))this.shareInfo.itemsAreSharedToGroups+=p+",",b=[],b[0]=p,b[1]=1,c[c.length]=b;else for(b=0;b<c.length;b++)if(c[b][0]===p){c[b][1]+=1;break}}}var g="",m=!1,t,u;for(a=0;a<this.shareInfo.userGroups.length;a++){p=this.shareInfo.userGroups[a];t="";u=this.shareInfo.items.length;if(-1<this.shareInfo.itemsAreSharedToGroups.indexOf(","+p.id+","))for(t="checked",m=!0,b=0;b<c.length;b++)if(c[b][0]===
p.id){u=c[b][1];break}g=u<this.shareInfo.items.length?g+('\x3cdiv id\x3d"img_group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cimg id\x3d\"img_group_"+a+'" src\x3d"'+this._checkboxImgUrl+'" border\x3d"0"\x3e\x3c/td\x3e\x3ctd\x3e'+p.title+'\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e\x3cdiv id\x3d"group_'+a+"_div\"style\x3d\"display:none;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+
a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\''+p.id+"'\x3e"+p.title+"\x3c/label\x3e"):g+('\x3cdiv id\x3d"group_'+a+"_div\" style\x3d\"display:block;\"\x3e\x3ctable cellpadding\x3d'0' cellspacing\x3d'0' class\x3d'share-groups-table'\x3e\x3ctr\x3e\x3ctd width\x3d'17' valign\x3d'bottom'\x3e\x3cinput id\x3d\"group_"+a+'" '+t+' value\x3d"'+p.id+'" type\x3d"checkbox"class\x3d\'share-groups-input-checkbox\' dojoType\x3d"dijit.form.Checkbox" /\x3e\x3c/td\x3e\x3ctd\x3e\x3clabel for\x3d\'group_'+
a+"'\x3e"+p.title+"\x3c/label\x3e");g=this._addOpenDataStr(p,g);g+="\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e"}this.own(f(e.byId("share-groups-list"),"click",n.hitch(this,this.checkGroup)));e.byId("share-groups-list").innerHTML=g;m?dijit.byId("share-groups-check").set("checked",!0):dijit.byId("share-groups-check").set("checked",!1);this.own(f(e.byId("share-groups-check"),"click",n.hitch(this,this.checkGroups)))},share:function(a){"group"===this.shareInfo.shareType?this.shareItemToGroups():
"admin"===this.shareInfo.shareType?this.shareItemAsAdmin(a):this.shareItem(a)},checkGroup:function(a){-1<a.target.id.indexOf("img_group_")&&(k.set(e.byId(a.target.id+"_div"),"display","none"),k.set(e.byId(a.target.id.substring(4,a.target.id.length)+"_div"),"display","block"));!0===a.target.checked&&-1<a.target.id.indexOf("group_")&&dijit.byId("share-groups-check").set("checked",!0)},checkGroups:function(){},clickEveryone:function(){var b=dijit.byId("share-everyone-check").get("checked");if(!0===b){var c=
e.byId("share-account-check_div");this.shareInfo.organization&&c&&"block"===k.get(c,"display")&&(dijit.byId("share-account-check").set("checked",!0),dijit.byId("share-account-check").set("disabled",!0))}else this.shareInfo.organization&&this.shareInfo.userRole&&(!this.shareInfo._isCustomRole||this.shareInfo._roleCanShareToOrg||this.shareInfo._roleCanShareOthersItemsToOrg)&&k.set(e.byId("share-account-check_div"),"display","block"),dijit.byId("share-account-check").set("disabled",!1);a.publish("ShareOptions/onClickEveryone",
b)},clickAccount:function(){!0===dijit.byId("share-account-check").get("checked")?(this.shareInfo._orgUserCanSharePublicOrOverride&&("none"===k.get(e.byId("share-everyone-check_div"),"display")&&k.set(e.byId("share-everyone-check_div"),"display","block"),dijit.byId("share-everyone-check").set("checked",!1)),dijit.byId("share-account-check").set("checked",!0)):dijit.byId("share-account-check").set("checked",!1)},shareItemAsAdmin:function(){var a="",b="";u.forEach(this.shareInfo.items,function(c){a+=
b+c.id;b=","});var c=!1,f=!1;e.byId("share-everyone-check_div")&&"block"===k.get(e.byId("share-everyone-check_div"),"display")&&(c=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&"block"===k.get(e.byId("share-account-check_div"),"display")&&(f=dijit.byId("share-account-check").get("checked"));var g="",m="",p="",t="",v=0;if(dijit.byId("share-groups-check").get("checked")){var I;if(this.shareInfo.user.groups&&this.shareInfo.user.groups.length)for(v=0;v<this.shareInfo.user.groups.length;v++)I=
this.shareInfo.user.groups[v].id,"block"===k.get(e.byId("group_"+v+"_div"),"display")&&(e.byId("group_"+v).checked?(g+=p+I,p=","):(m+=t+I,t=","));if(this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess)for(var K=0;K<this.shareInfo.adminGroups.length;K++)I=this.shareInfo.adminGroups[K].id,"block"===k.get(e.byId("group_"+(K+v)+"_div"),"display")&&(e.byId("group_"+(K+v)).checked?(g+=p+I,p=","):(m+=t+I,t=","))}else t="",this.shareInfo.user.groups&&this.shareInfo.user.groups.length&&
u.forEach(this.shareInfo.user.groups,function(a){m+=t+a.id;t=","}),this.shareInfo.adminGroups&&this.shareInfo.adminGroups.length&&1<this.shareInfo.lowestAccess&&u.forEach(this.shareInfo.adminGroups,function(a){m+=t+a.id;t=","});if(0<m.length)for(p={items:a,groups:m},v=0;v<this.shareInfo.items.length;v++)x._unshareItemById(p,this.shareInfo.items[v].id,this.portalUrl).then(n.hitch(this,this.unShareHandler_admin,this.shareInfo.items,a,g,c,f));else this.unShareHandler_admin(this.shareInfo.items,a,g,c,
f)},unShareHandler_admin:function(a,b,c,e,f){var g=a.length,k=function(){g--};b={items:b,groups:c,everyone:e,account:f};for(c=0;c<a.length;c++)e=a[c],this.shareInfo.user.shareItem(b,e.id,e.folderId).then(n.hitch(this,k))},shareItem:function(){var a="",b="";u.forEach(this.shareInfo.items,function(c){a+=b+c.id;b=","});var c=!1,f=!1;e.byId("share-everyone-check_div")&&"block"===k.get(e.byId("share-everyone-check_div"),"display")&&(c=dijit.byId("share-everyone-check").get("checked"));e.byId("share-account-check_div")&&
"block"===k.get(e.byId("share-account-check_div"),"display")&&(f=dijit.byId("share-account-check").get("checked"));var g=dijit.byId("share-groups-check").get("checked"),m="",p="",t="",v="";this.shareInfo.userGroups=this.shareInfo.user.group;g?this.shareInfo.userGroups&&this.shareInfo.userGroups.length&&u.forEach(this.shareInfo.userGroups,function(a,b){a=a.id;"block"===k.get(e.byId("group_"+b+"_div"),"display")&&(e.byId("group_"+b).checked?(m+=t+a,t=","):(p+=v+a,v=","))}):(v="",this.shareInfo.userGroups&&
this.shareInfo.userGroups.length&&u.forEach(this.shareInfo.userGroups,function(a){p+=v+a.id;v=","}));0<p.length?(g={items:a,groups:p},this.shareInfo.itemUser&&null!==this.shareInfo.itemUser?x.unshareItemsByUser(this.shareInfo.itemUser.username?this.shareInfo.itemUser.username:this.shareInfo.itemUser.email,g,this.portalUrl).then(n.hitch(this,this.unShareHandler_item,this.shareInfo.itemUser,a,m,c,f)):x.unshareItems(this.shareInfo.itemUser,g,this.portalUrl).then(n.hitch(this,this.unShareHandler_item,
this.shareInfo.itemUser,a,m,c,f))):this.unShareHandler_item(this.shareInfo.itemUser,a,m,c,f)},unShareHandler_item:function(a,b,c,e,f){b={items:b,groups:c,everyone:e,account:f};a&&null!==a?x.shareItemsByUser(a.username?a.username:a.email,b,this.portalUrl).then(n.hitch()):x.shareItems(a,b,this.portalUrl).then()},findLowestAccessLevel:function(a){for(var b=3,c,e,f=0;f<a.length;f++)(e=a[f].access)||(e="private"),1===e.length&&(e=e[0]),"public"===e?c=3:"org"===e?c=2:"shared"===e?c=1:"private"===e&&(c=
0),c<b&&(b=c);return b},_sortFunc:function(a,b){a=a[this.shareInfo.sortField].toLowerCase();b=b[this.shareInfo.sortField].toLowerCase();return null===a||null===b||a===b?0:a<b?-1:1},_addOpenDataStr:function(a,b){a.isOpenData&&!x.portal.isPortal&&(b+=" "+this.i18n.openData);return b},_clearGroupCheckboxes:function(){if(!1===dijit.byId("share-groups-check").get("checked"))for(var a=b(".share-groups-input-checkbox"),c=0,e=a.length;c<e;c++)a[c].setAttribute("value",!1)}})})},"jimu/shareUtils":function(){define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e){var b={getBaseHrefUrl:function(a){var b="HTML3D"===window.appInfo.appType?"webappviewer3d":"webappviewer",e="";window.isXT?e=window.location.protocol+"//"+window.location.host+window.appInfo.appPath:(e=f.urlToObject(window.location.href).query||{},e=e.appid?a+"apps/"+b+"/index.html?appid\x3d"+e.appid:e.id?a+"apps/"+b+"/index.html?id\x3d"+e.id:f.getAppHref());return e},addQueryParamToUrl:function(a,b,f,g){a=e.urlToObject(a);a.query||(a.query={});a.query[b]=f;b=a.path;
for(var c in a.query)f=a.query[c],!0===g&&(f=encodeURIComponent(f)),b=b===a.path?b+"?"+c+"\x3d"+f:b+"\x26"+c+"\x3d"+f;return b},removeQueryParamFromUrl:function(a,b,f){a=e.urlToObject(a);a.query&&delete a.query[b];b=a.path;for(var c in a.query){var g=a.query[c];!0===f&&(g=encodeURIComponent(g));b=b===a.path?b+"?"+c+"\x3d"+g:b+"\x26"+c+"\x3d"+g}return b},getShareUrlContent:function(a){return"\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e"+
window.jimuNls.common.url+"\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d"+a+"\x3e\x3c/input\x3e\x3c/div\x3e\x3c/div\x3e"},getShareUrl:function(a,c,e){var f=b.getBaseHrefUrl(window.portalUrl),g="",k,m,n,p,t;c&&(c.longitude&&c.latitude?(k=c.longitude,m=c.latitude,g=c.longitude+","+c.latitude+","):c.x&&c.y&&c.spatialReference&&c.spatialReference.wkid&&(n=c.x,p=c.y,t=c.spatialReference.wkid,g=c.x+","+c.y+","+c.spatialReference.wkid));f=b.addQueryParamToUrl(f,
"marker",g,!0);f=b.addQueryParamToUrl(f+",,,","markertemplate",encodeURIComponent(JSON.stringify({title:c.title,x:n,y:p,wkid:t,longitude:k,latitude:m,isIncludeShareUrl:e})));c=a.getLevel();return f="number"===typeof c&&-1!==c?b.addQueryParamToUrl(f,"level",a.getLevel(),!0):b.addQueryParamToUrl(f,"scale",a.getScale(),!0)},getXyContent:function(a){var b="\x3cdiv class\x3d'marker-feature-action-popup'\x3e";a.longitude&&a.latitude?b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+
window.jimuNls.common.longitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+f.localizeNumber(parseFloat(a.longitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e"+window.jimuNls.common.latitude+"\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+f.localizeNumber(parseFloat(a.latitude).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e":a.x&&a.y&&(b+="\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+
f.localizeNumber(parseFloat(a.x).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e"+f.localizeNumber(parseFloat(a.y).toFixed(4))+"\x3c/span\x3e\x3c/div\x3e");return b+"\x3c/div\x3e"},_isUserOwnTheApp:function(a){return a&&a.username&&a.username===window.appInfo.appOwner?!0:!1},getItemByUserAndItemId:function(a,b,e,f){var c=new n;f=v.getStandardPortalUrl(f);f=f+"/sharing/rest/content/users/"+(b?b.username?b.username:
b.email:e.email);if(m.isDefined(a.folderId)&&"/"!==a.folderId||m.isDefined(a.ownerFolder)&&"/"!==a.ownerFolder)f+="/"+(a.folderId||a.ownerFolder);f+="/items/"+a.id;g({url:f,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getProfile:function(a,b){var c=new n;a=v.getUserUrl(b,a.owner);g({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,
function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_unshareItemById:function(a,b,e){var c=new n;e=v.getStandardPortalUrl(e);e+="/sharing/rest/content/items/"+b+"/unshare";b={f:"json"};b=p.mixin(b,a);g({url:e,handleAs:"json",content:b,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},canSharePublic:function(a){return!a.selfUrl||!0!==a.canSharePublic&&
!1!==a.canSharePublic?!0:a.canSharePublic},unshareItemsByUser:function(a,b,e){var c=new n;e=v.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+a+"/unshareItems";a={f:"json"};a=p.mixin(a,b);g({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},unshareItems:function(a,b,e){var c=new n;e=v.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+(b.owner||
a.email)+"/unshareItems";a={f:"json"};a=p.mixin(a,b);g({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},shareItemsByUser:function(a,b,e){var c=new n;e=v.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+a+"/shareItems";a={f:"json"};a=p.mixin(a,b);g({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),
p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},shareItems:function(a,b,e){var c=new n;e=v.getStandardPortalUrl(e);e+="/sharing/rest/content/users/"+(b.owner||a.email)+"/shareItems";a={f:"json"};a=p.mixin(a,b);g({url:e,handleAs:"json",content:a,callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemsGroups:function(a,b){var c=new n;b=v.getStandardPortalUrl(b);b+="/sharing/rest/content/items/"+
a.id+"/groups";g({url:b,handleAs:"json",content:{f:"json"},callbackParamName:"callback"},{usePost:!0}).then(p.hitch(this,function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},isSharedToPublic:function(a){return window.isXT?!1:null===a?!0:"undefined"!==typeof a&&"undefined"!==typeof a.item&&"undefined"!==typeof a.item.access&&"public"===a.item.access?!0:!1},isShowSocialMediaLinks:function(a){return window.isXT?!0:null===a?!0:"undefined"!==typeof a&&"undefined"!==
typeof a.item&&"undefined"!==typeof a.item.access&&"private"===a.item.access?!1:!0},getItemShareInfo:function(a){var b=new n,e="";if(window.isXT)return b.resolve(null);e=f.urlToObject(f.getAppHref()).query||{};e=e.id||e.appid;if("undefined"===typeof e||""===e)return b.resolve(null);u.getPortal(a).getItemById(e).then(p.hitch(this,function(a){var c={};c.item=a;c.item&&"undefined"===typeof c.item.sharing&&c.item.access&&(c.item.sharing={access:c.item.access});b.resolve(c)}),p.hitch(this,function(a){console.log(a);
b.resolve(null)}));return b},getShareInfo:function(a){var c=u.getPortal(a),e=new n,g="";if(window.isXT)return e.resolve(null);g=f.urlToObject(f.getAppHref()).query||{};g=g.id||g.appid;if("undefined"===typeof g||""===g)return e.resolve(null);t({getUser:c.getUser(),loadSelfInfo:c.loadSelfInfo(),getItem:c.getItemById(g)}).then(p.hitch(this,function(c){var f={};f.item=c.getItem;f.item&&f.item.ownerFolder&&f.item.ownerFolder.length&&"/"!==f.item.ownerFolder&&(f.item.folderId=f.item.ownerFolder);"undefined"===
typeof f.item.sharing&&f.item.access&&(f.item.sharing={access:f.item.access});f.user=c.getUser;b._setUserRole(c.loadSelfInfo,f);f.currentUser=f.user;f.isAdmin=!1;f.userRole&&(f.userRole.isAdmin()||f.userRole.isCustom()&&f.userRole.canUpdateOrgItems())?(f.isAdmin=!0,f.item.owner!==f.currentUser.name?b._getProfile(f.item,a).then(p.hitch(this,function(a){f.itemUser=a;f.itemUser.orgId!==f.currentUser.orgId&&(f.isAdmin=!1);e.resolve(f)})):(f.itemUser=f.currentUser,e.resolve(f))):(f.currentUser&&(f.itemUser=
f.currentUser),e.resolve(f))}),p.hitch(this,function(a){console.log(a);e.resolve(null)}));return e},_setUserRole:function(a,b){b.userPortalUrl=a.urlKey?a.urlKey+"."+a.customBaseUrl:this.portalUrl;!a||a.code||a.message||(b.organization=a);if(a&&a.user)b.userRole=new k({id:a.user.roleId?a.user.roleId:a.user.role,role:a.user.role}),b._isCustomRole=b.userRole.isCustom(),b._roleCanShareToGroup=b._isCustomRole&&b.userRole.canShareItemToGroup(),b._roleCanShareToOrg=b._isCustomRole&&b.userRole.canShareItemToOrg(),
b._roleCanSharePublic=b._isCustomRole&&b.userRole.canShareItemToPublic(),b._roleCanShare=b._roleCanShareToGroup||b._roleCanShareToOrg||b._roleCanShareToPublic,b._roleCanUpdateItems=b._isCustomRole&&b.userRole.canUpdateOrgItems(),b._roleCanShareOthersItemsToGroup=b._isCustomRole&&b.userRole.canShareOthersItemsToGroup(),b._roleCanShareOthersItemsToOrg=b._isCustomRole&&b.userRole.canShareOthersItemsToOrg(),b._roleCanShareOthersItemsToPublic=b._isCustomRole&&b.userRole.canShareOthersItemsToPublic(),b._roleCanShareOthersItems=
b._isCustomRole&&(b.userRole.canShareOthersItemsToGroup()||b.userRole.canShareOthersItemsToOrg()||b._roleCanShareOthersItemsToPublic),b._orgUserCanSharePublicOrOverride=b.organization&&(!0===b.organization.canSharePublic&&(!b._isCustomRole||b._roleCanSharePublic||b._roleCanShareOthersItemsToPublic)||b.userRole.isAdmin());else return!1},getItemById:function(a,b){var c=new n;b=v.getStandardPortalUrl(b);b+="/sharing/rest/content/items/"+a.id;g({url:b,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,
function(a){c.resolve(a)}),p.hitch(this,function(a){console.error(a);c.reject(a)}));return c},disableWebMapPopup:function(a){a&&a.setInfoWindowOnClick&&a.setInfoWindowOnClick(!1)},enableWebMapPopup:function(a){a&&a.setInfoWindowOnClick&&a.setInfoWindowOnClick(!0)}};return b})},"dijit/form/Textarea":function(){define(["dojo/_base/declare","dojo/dom-style","./_ExpandingTextAreaMixin","./SimpleTextarea"],function(p,g,t,v){return p("dijit.form.Textarea",[v,t],{baseClass:"dijitTextBox dijitTextArea dijitExpandingTextArea",
cols:"",buildRendering:function(){this.inherited(arguments);g.set(this.textbox,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"})}})})},"dijit/form/_ExpandingTextAreaMixin":function(){define("dojo/_base/declare dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/_base/window ../Viewport".split(" "),function(p,g,t,v,n,m,u){t.add("textarea-needs-help-shrinking",function(){var k=m.body(),f=g.create("textarea",
{rows:"5",cols:"20",value:" ",style:{zoom:1,fontSize:"12px",height:"96px",overflow:"hidden",visibility:"hidden",position:"absolute",border:"5px solid white",margin:"0",padding:"0",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"}},k,"last"),e=f.scrollHeight>=f.clientHeight;k.removeChild(f);return e});return p("dijit.form._ExpandingTextAreaMixin",null,{_setValueAttr:function(){this.inherited(arguments);this.resize()},postCreate:function(){this.inherited(arguments);
var g=this.textbox;g.style.overflowY="hidden";this.own(n(g,"focus, resize",v.hitch(this,"_resizeLater")))},startup:function(){this.inherited(arguments);this.own(u.on("resize",v.hitch(this,"_resizeLater")));this._resizeLater()},_onInput:function(g){this.inherited(arguments);this.resize()},_estimateHeight:function(){var g=this.textbox;g.rows=(g.value.match(/\n/g)||[]).length+1},_resizeLater:function(){this.defer("resize")},resize:function(){function g(){var a=!1;""===f.value&&(f.value=" ",a=!0);var b=
f.scrollHeight;a&&(f.value="");return b}var f=this.textbox;"hidden"==f.style.overflowY&&(f.scrollTop=0);if(!this.busyResizing){this.busyResizing=!0;if(g()||f.offsetHeight){var e=g()+Math.max(f.offsetHeight-f.clientHeight,0),b=e+"px";b!=f.style.height&&(f.style.height=b,f.rows=1);if(t("textarea-needs-help-shrinking")){var a=g(),c=f.style.minHeight,m=4,n=f.scrollTop;f.style.minHeight=b;for(f.style.height="auto";0<e;){f.style.minHeight=Math.max(e-m,4)+"px";b=g();a-=b;e-=a;if(a<m)break;a=b;m<<=1}f.style.height=
e+"px";f.style.minHeight=c;f.scrollTop=n}f.style.overflowY=g()>f.clientHeight?"auto":"hidden";"hidden"==f.style.overflowY&&(f.scrollTop=0)}else this._estimateHeight();this.busyResizing=!1}}})})},"dijit/layout/BorderContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/touch ../_WidgetBase ../_Widget ../_TemplatedMixin ./LayoutContainer ./utils".split(" "),function(p,g,
t,v,n,m,u,k,f,e,b,a,c,x,w,q){var C=t("dijit.layout._Splitter",[c,x],{live:!0,templateString:'\x3cdiv class\x3d"dijitSplitter" data-dojo-attach-event\x3d"onkeydown:_onKeyDown,press:_startDrag,onmouseenter:_onMouse,onmouseleave:_onMouse" tabIndex\x3d"0" role\x3d"separator"\x3e\x3cdiv class\x3d"dijitSplitterThumb"\x3e\x3c/div\x3e\x3c/div\x3e',constructor:function(){this._handlers=[]},postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region);this._factor=
/top|left/.test(this.region)?1:-1;this._cookieName=this.container.id+"_"+this.region},buildRendering:function(){this.inherited(arguments);v.add(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V"));if(this.container.persist){var a=g(this._cookieName);a&&(this.child.domNode.style[this.horizontal?"height":"width"]=a)}},_computeMaxSize:function(){var a=this.horizontal?"h":"w",b=m.getMarginBox(this.child.domNode)[a],c=p.filter(this.container.getChildren(),function(a){return"center"==a.region})[0],a=
m.getContentBox(c.domNode)[a]-10;return Math.min(this.child.maxSize,b+a)},_startDrag:function(a){this.cover||(this.cover=n.place("\x3cdiv class\x3ddijitSplitterCover\x3e\x3c/div\x3e",this.child.domNode,"after"));v.add(this.cover,"dijitSplitterCoverActive");this.fake&&n.destroy(this.fake);(this._resize=this.live)||((this.fake=this.domNode.cloneNode(!0)).removeAttribute("id"),v.add(this.domNode,"dijitSplitterShadow"),n.place(this.fake,this.domNode,"after"));v.add(this.domNode,"dijitSplitterActive dijitSplitter"+
(this.horizontal?"H":"V")+"Active");this.fake&&v.remove(this.fake,"dijitSplitterHover dijitSplitter"+(this.horizontal?"H":"V")+"Hover");var c=this._factor,g=this.horizontal,k=g?"pageY":"pageX",p=a[k],q=this.domNode.style,g=g?"h":"w",t=u.getComputedStyle(this.child.domNode),w=m.getMarginBox(this.child.domNode,t)[g],x=this._computeMaxSize(),z=Math.max(this.child.minSize,m.getPadBorderExtents(this.child.domNode,t)[g]+10),g=this.region,C="top"==g||"bottom"==g?"top":"left",E=parseInt(q[C],10),T=this._resize,
O=f.hitch(this.container,"_layoutChildren",this.child.id),g=this.ownerDocument;this._handlers=this._handlers.concat([e(g,b.move,this._drag=function(a,b){a=a[k]-p;var e=c*a+w,f=Math.max(Math.min(e,x),z);(T||b)&&O(f);q[C]=a+E+c*(f-e)+"px"}),e(g,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),e(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()}),e(g,b.release,f.hitch(this,"_stopDrag"))]);a.stopPropagation();a.preventDefault()},_onMouse:function(a){a=
"mouseover"==a.type||"mouseenter"==a.type;v.toggle(this.domNode,"dijitSplitterHover",a);v.toggle(this.domNode,"dijitSplitter"+(this.horizontal?"H":"V")+"Hover",a)},_stopDrag:function(a){try{this.cover&&v.remove(this.cover,"dijitSplitterCoverActive"),this.fake&&n.destroy(this.fake),v.remove(this.domNode,"dijitSplitterActive dijitSplitter"+(this.horizontal?"H":"V")+"Active dijitSplitterShadow"),this._drag(a),this._drag(a,!0)}finally{this._cleanupHandlers(),delete this._drag}this.container.persist&&
g(this._cookieName,this.child.domNode.style[this.horizontal?"height":"width"],{expires:365})},_cleanupHandlers:function(){for(var a;a=this._handlers.pop();)a.remove()},_onKeyDown:function(a){this._resize=!0;var b=this.horizontal,c=1;switch(a.keyCode){case b?k.UP_ARROW:k.LEFT_ARROW:c*=-1;case b?k.DOWN_ARROW:k.RIGHT_ARROW:break;default:return}b=m.getMarginSize(this.child.domNode)[b?"h":"w"]+this._factor*c;this.container._layoutChildren(this.child.id,Math.max(Math.min(b,this._computeMaxSize()),this.child.minSize));
a.stopPropagation();a.preventDefault()},destroy:function(){this._cleanupHandlers();delete this.child;delete this.container;delete this.cover;delete this.fake;this.inherited(arguments)}}),z=t("dijit.layout._Gutter",[c,x],{templateString:'\x3cdiv class\x3d"dijitGutter" role\x3d"presentation"\x3e\x3c/div\x3e',postMixInProperties:function(){this.inherited(arguments);this.horizontal=/top|bottom/.test(this.region)},buildRendering:function(){this.inherited(arguments);v.add(this.domNode,"dijitGutter"+(this.horizontal?
"H":"V"))}});t=t("dijit.layout.BorderContainer",w,{gutters:!0,liveSplitters:!0,persist:!1,baseClass:"dijitBorderContainer",_splitterClass:C,postMixInProperties:function(){this.gutters||(this.baseClass+="NoGutter");this.inherited(arguments)},_setupChild:function(a){this.inherited(arguments);var b=a.region,c=a.isLeftToRight();"leading"==b&&(b=c?"left":"right");"trailing"==b&&(b=c?"right":"left");b&&"center"!=b&&(a.splitter||this.gutters)&&!a._splitterWidget&&(c=a.splitter?this._splitterClass:z,f.isString(c)&&
(c=f.getObject(c)),c=new c({id:a.id+"_splitter",container:this,child:a,region:b,live:this.liveSplitters}),c.isSplitter=!0,a._splitterWidget=c,b="bottom"==b||b==(this.isLeftToRight()?"right":"left"),n.place(c.domNode,a.domNode,b?"before":"after"),c.startup())},layout:function(){this._layoutChildren()},removeChild:function(a){var b=a._splitterWidget;b&&(b.destroy(),delete a._splitterWidget);this.inherited(arguments)},getChildren:function(){return p.filter(this.inherited(arguments),function(a){return!a.isSplitter})},
getSplitter:function(a){return p.filter(this.getChildren(),function(b){return b.region==a})[0]._splitterWidget},resize:function(a,b){if(!this.cs||!this.pe){var c=this.domNode;this.cs=u.getComputedStyle(c);this.pe=m.getPadExtents(c,this.cs);this.pe.r=u.toPixelValue(c,this.cs.paddingRight);this.pe.b=u.toPixelValue(c,this.cs.paddingBottom);u.set(c,"padding","0px")}this.inherited(arguments)},_layoutChildren:function(a,b){if(this._borderBox&&this._borderBox.h){var c=[];p.forEach(this._getOrderedChildren(),
function(a){c.push(a);a._splitterWidget&&c.push(a._splitterWidget)});q.layoutChildren(this.domNode,{l:this.pe.l,t:this.pe.t,w:this._borderBox.w-this.pe.w,h:this._borderBox.h-this.pe.h},c,a,b)}},destroyRecursive:function(){p.forEach(this.getChildren(),function(a){var b=a._splitterWidget;b&&b.destroy();delete a._splitterWidget});this.inherited(arguments)}});t.ChildWidgetProperties={splitter:!1,minSize:0,maxSize:Infinity};f.mixin(t.ChildWidgetProperties,w.ChildWidgetProperties);f.extend(a,t.ChildWidgetProperties);
t._Splitter=C;t._Gutter=z;return t})},"dijit/layout/LayoutContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-style dojo/_base/lang ../_WidgetBase ./_LayoutWidget ./utils".split(" "),function(p,g,t,v,n,m,u,k){g=g("dijit.layout.LayoutContainer",u,{design:"headline",baseClass:"dijitLayoutContainer",startup:function(){this._started||(p.forEach(this.getChildren(),this._setupChild,this),this.inherited(arguments))},_setupChild:function(f){this.inherited(arguments);
f.region&&t.add(f.domNode,this.baseClass+"Pane")},_getOrderedChildren:function(){var f=p.map(this.getChildren(),function(e,b){return{pane:e,weight:["center"==e.region?Infinity:0,e.layoutPriority,("sidebar"==this.design?1:-1)*(/top|bottom/.test(e.region)?1:-1),b]}},this);f.sort(function(e,b){e=e.weight;b=b.weight;for(var a=0;a<e.length;a++)if(e[a]!=b[a])return e[a]-b[a];return 0});return p.map(f,function(e){return e.pane})},layout:function(){k.layoutChildren(this.domNode,this._contentBox,this._getOrderedChildren())},
addChild:function(f,e){this.inherited(arguments);this._started&&this.layout()},removeChild:function(f){this.inherited(arguments);this._started&&this.layout();t.remove(f.domNode,this.baseClass+"Pane");v.set(f.domNode,{top:"auto",bottom:"auto",left:"auto",right:"auto",position:"static"});v.set(f.domNode,/top|bottom/.test(f.region)?"width":"height","auto")}});g.ChildWidgetProperties={region:"",layoutAlign:"",layoutPriority:0};n.extend(m,g.ChildWidgetProperties);return g})},"jimu/dijit/ShareLink":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/dom-class dojo/_base/html dojo/on dojo/keys dijit/Tooltip dojo/topic dojo/query jimu/utils jimu/shareUtils dojo/_base/config dojo/cookie dojo/text!./templates/ShareLink.html dojo/string dijit/form/Select dijit/form/NumberTextBox dojo/dom-attr dojo/Deferred esri/request esri/tasks/query esri/tasks/QueryTask esri/symbols/jsonUtils esri/InfoTemplate jimu/LayerInfos/LayerInfos esri/symbols/PictureMarkerSymbol esri/graphic esri/layers/GraphicsLayer jimu/dijit/FeaturelayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox dijit/form/TextBox dijit/form/Textarea dijit/form/RadioButton jimu/dijit/CheckBox dijit/form/SimpleTextarea dijit/form/ValidationTextBox".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q,S,T,O,W,U){return p([g,t,v],{templateString:z,declaredClass:"jimu.dijit.ShareLink",bitlyUrl:"https://arcg.is/prod/shorten",share:{shareEmailSubject:"",shareTwitterTxt:"",languages:"ar cs da de en el es et fi fr he hr it ja ko lt lv nb nl pl pt-br pt-pt ro ru sr sv th tr zh-cn vi zh-hk zh-tw".split(" "),DEFAULT_MOBILE_LAYOUT:600},_hasZoomLevelMarkerAdded:!1,_hasMapScaleMarkerAdded:!1,_hasAddMarkerMarkerAdded:!1,HAS_INIT_URL:!1,postMixInProperties:function(){this.inherited(arguments);
this.nls=window.jimuNls.shareLink;this.nls.symbol=window.jimuNls.common.symbol;this.nls.label=window.jimuNls.common.label;this.nls.WKID=window.jimuNls.common.wkid||"wkid";this.nls.popupTitle=window.jimuNls.shareLink.popupTitle||"Pop-up title";this.nls.zoomLevel=window.jimuNls.shareLink.zoomLevel||"Zoom level";this.share.shareEmailSubject=this.nls.shareEmailSubject+" ${appTitle} ";this.share.shareTwitterTxt=this.nls.shareEmailSubject+"${appTitle}\n"},postCreate:function(){this.inherited(arguments);
this._initUI();this._initMap();this._showSocialMediaLinksByConfig()},constructor:function(a){a&&(this._portalUrl=a.portalUrl,this._isOnline=a.isOnline,this._appTitle=a.appTitle,this._isShowBackBtn=a.isShowBackBtn,this._isShowSocialMediaLinks=a.isShowSocialMediaLinks,this._isSharedToPublic=a.isSharedToPublic,this._isShowFindLocation=a.isShowFindLocation,this._config=a.config)},startup:function(){this.baseHrefUrl=w.getBaseHrefUrl(this._portalUrl);"undefined"===typeof this.optionSrc&&(this.optionSrc=
"currentMapExtent");this.updateUrl(null);this._initOptions();this._initOptionsEvent();var a=c(".shareLinkOptionsWrapper",this.domNode);this.own(f(a,"keydown",n.hitch(this,function(a){a.keyCode===e.ESCAPE&&(a.stopPropagation(),this.backBtn.focus())})));this.own(f(this.preview,"keydown",n.hitch(this,function(a){a.shiftKey||a.keyCode!==e.TAB||(a.preventDefault(),this.backBtn.focus())})))},destroy:function(){this._cleanMarkerStatus();this._mapClickHandler&&(this._mapClickHandler=null);this.inherited(arguments)},
onShareToPublicChanged:function(a){this._isSharedToPublic=a;this.updateUrl(null);this._isSharedToPublic?u.add(this.shareTips,"displaynone"):u.remove(this.shareTips,"displaynone")},onCloseContainer:function(){this._cleanMarkerStatus()},updateShareLinkOptionsUI:function(a){a&&"undefined"!==typeof a.isShowFindLocation&&this.findLocationRow&&(!1===a.isShowFindLocation?u.add(this.findLocationRow,"displaynone"):!0===a.isShowFindLocation&&u.remove(this.findLocationRow,"displaynone"))},_initMap:function(){this.layerInfosObj=
Q.getInstanceSync();this.own(f(this.layerInfosObj,"layerInfosIsVisibleChanged",n.hitch(this,this._watchLayerChange)));window.isBuilder?(this.own(a.subscribe("app/mapLoaded",n.hitch(this,this._onMapLoaded))),this.own(a.subscribe("app/mapChanged",n.hitch(this,this._onMapLoaded)))):(this.own(a.subscribe("mapLoaded",n.hitch(this,this._onMapLoaded))),this.own(a.subscribe("mapChanged",n.hitch(this,this._onMapLoaded))));window._widgetManager.map&&(this.map=window._widgetManager.map,this._mapEventUpdateUrls(),
this._addGraphicsLayer())},_onMapLoaded:function(a){this.map=a;this._mapEventUpdateUrls();this._addGraphicsLayer()},_mapEventUpdateUrls:function(){this.map&&(this.own(f(this.map,"pan-end",n.hitch(this,function(){this._mapEventHandler("pan-end")}))),this.own(f(this.map,"resize",n.hitch(this,function(){this._mapEventHandler("resize")}))),this.own(f(this.map,"zoom-end",n.hitch(this,function(){this._mapEventHandler("zoom-end")}))))},_mapEventHandler:function(){this._isShareLinkOptionsShow()&&this.updateUrl()},
_showSocialMediaLinksByConfig:function(){this._config&&this._config.socialMedias&&("undefined"!==typeof this._config.socialMedias.email&&!1===this._config.socialMedias.email&&u.add(this.emailShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.facebook&&!1===this._config.socialMedias.facebook&&u.add(this.FacebookShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.twitter&&!1===this._config.socialMedias.twitter&&u.add(this.TwitterShare,"displaynone"),"undefined"!==typeof this._config.socialMedias.googlePlus&&
!1===this._config.socialMedias.googlePlus&&u.add(this.googlePlusShare,"displaynone"))},_initUI:function(){this._isShowBackBtn?(F.set(this.backBtn,"title",window.jimuNls.common.back),this.own(f(this.backBtn,"click",n.hitch(this,this._toggleLinkOptions))),this.own(f(this.backBtn,"keydown",n.hitch(this,function(a){a.keyCode===e.ENTER||a.keyCode===e.SPACE||a.keyCode===e.ESCAPE?(this._toggleLinkOptions(),this.linkOptions.focus()):a.shiftKey&&a.keyCode===e.TAB&&(a.preventDefault(),this.preview.textbox.focus())})))):
u.add(this.backBtn,"displaynone");!1===this._isShowSocialMediaLinks&&u.toggle(this.socialNetworkLinks,"displaynone");!0===this._isSharedToPublic&&u.toggle(this.shareTips,"displaynone");this.own(f(this.linkOptions,"click",n.hitch(this,this._toggleLinkOptions)));this.own(f(this.linkOptions,"keydown",n.hitch(this,this._toggleLinkOptionsKeydown)));this._setInputsClicktoSelect(this._linkUrlTextBox);x.addTooltipByDomNode(b,this.emailShare,this.nls.shareEmail);x.addTooltipByDomNode(b,this.FacebookShare,
this.nls.shareFacebook);x.addTooltipByDomNode(b,this.TwitterShare,this.nls.shareTwitter);x.addTooltipByDomNode(b,this.googlePlusShare,this.nls.shareGooglePlus);this.own(f(this.googlePlusShare,"click",n.hitch(this,this._toGooglePlus)));this.own(f(this.googlePlusShare,"keydown",n.hitch(this,this._toGooglePlusKeyDown)));this._setInputsClicktoSelect(this._embedCodeTextArea);this.own(f(this.MoreOptionsContainer,"keydown",n.hitch(this,function(a){a.keyCode===e.ESCAPE&&(a.stopPropagation(),this._moreOptionsExpandCollapse(),
this.MoreOptions.focus())})));this._sizeOptions=new B({options:[{label:this.nls.smallSize,value:"small",selected:!0},{label:this.nls.mediumSize,value:"medium",selected:!1},{label:this.nls.largeSize,value:"large",selected:!1},{label:this.nls.customSize,value:"custom",selected:!1}],"class":"sizeOptionsSelect"});this._sizeOptions.placeAt(this.SizeSelect);this.own(f(this._sizeOptions,"change",function(a){switch(a){case "small":this._widthTextBox.set("value",300);this._heightTextBox.set("value",200);u.add(this.CustomSizeContainer,
"disable");this._updateEmbedCodeFrameSize();break;case "medium":this._widthTextBox.set("value",800);this._heightTextBox.set("value",600);u.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "large":this._widthTextBox.set("value",1080);this._heightTextBox.set("value",720);u.add(this.CustomSizeContainer,"disable");this._updateEmbedCodeFrameSize();break;case "custom":u.remove(this.CustomSizeContainer,"disable")}}.bind(this)));this.own(f(this._sizeOptions,"keydown",function(a){a.shiftKey&&
a.keyCode===e.TAB&&(a.preventDefault(),this._moreOptionsExpandCollapse(),this.MoreOptions.focus())}.bind(this)));this._widthTextBox=new G({"class":"sizeTextBox inputsText",value:300,constraints:{pattern:"#",places:0}});this._widthTextBox.placeAt(this.CustomSizeContainer,1);this.own(f(this._widthTextBox,"change",function(a){200>a?this._widthTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this._heightTextBox=new G({"class":"sizeTextBox inputsText",value:200,constraints:{pattern:"#",
places:0}});this._heightTextBox.placeAt(this.CustomSizeContainer,3);this.own(f(this._heightTextBox,"change",function(a){200>a?this._heightTextBox.set("value",200>a?200:a):this._updateEmbedCodeFrameSize()}.bind(this)));this.own(f(this._heightTextBox,"keydown",function(a){a.shiftKey||a.keyCode!==e.TAB||(a.preventDefault(),this._moreOptionsExpandCollapse(),this.MoreOptions.focus())}.bind(this)));this.mobileLayout.set("value",this.share.DEFAULT_MOBILE_LAYOUT);this.updateShareLinkOptionsUI({isShowFindLocation:this._isShowFindLocation});
this._setInputsClicktoSelect(this.preview)},_setLinkUrl:function(a){this._linkUrlTextBox.set("value",a);k.hasClass(this._linkUrlTextBox.domNode,"dijitFocused")&&this._linkUrlTextBox.textbox.select();F.set(this._linkUrlTextBox.domNode,"data-old",a)},_setEmbedCode:function(a){this._embedCodeTextArea.set("value",'\x3ciframe width\x3d"'+this._widthTextBox.value+'" height\x3d"'+this._heightTextBox.value+'" frameborder\x3d"0" scrolling\x3d"no" allowfullscreen src\x3d"'+a+'"\x3e\x3c/iframe\x3e');F.set(this._embedCodeTextArea.domNode,
"data-old-shortened",a)},_updateEmbedCodeFrameSize:function(a){a=this._embedCodeTextArea.get("value");a=a.replace(/width=\"[0-9]*\"/i,'width\x3d"'+this._widthTextBox.value+'"');a=a.replace(/height=\"[0-9]*\"/i,'height\x3d"'+this._heightTextBox.value+'"');this._embedCodeTextArea.set("value",a)},_initOptions:function(){var a=[],b=this.map.getLevel();"number"===typeof b&&-1!==b?u.remove(this.chooseCenterWithLevelRow,"displaynone"):u.add(this.chooseCenterWithLevelRow,"displaynone");a=[];this.setlanguage_languages.removeOption(this.setlanguage_languages.getOptions());
m.forEach(this.share.languages,function(b){var c={label:b,value:b};c.selected=b===q.locale?!0:!1;a.push(c)});this.setlanguage_languages.addOption(a);b="";try{var c=C("esri_auth");c&&(b=JSON.parse(c).token)}catch(aa){console.log("ShareLink can't parse Auth:"+aa)}b&&this.authtoken.set("value",b);c=new W({createMapResponse:this.map.webMapResponse,showLayerFromFeatureSet:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1});u.add(c.domNode,"share-layerChooser-dropbox");this.layerChooserFromMapWithDropbox=
new U({layerChooser:c,customClass:"jimu-shareLink-dropbox-popup"});this.layerChooserFromMapWithDropbox.placeAt(this.queryFeature_layer);this.own(f(this.layerChooserFromMapWithDropbox,"selection-change",n.hitch(this,this._updateQueryFeature_Layer)));"undefined"!==typeof this.map.spatialReference&&"undefined"!==typeof this.map.spatialReference.wkid&&this.addMarker_spatialReference.set("value",this.map.spatialReference.wkid)},_initOptionsEvent:function(){var a=x.has("ie")||x.has("edge")?"change":"KeyUp",
b=c(".shareRadios",this.domNode);this.own(f(b,"click",n.hitch(this,function(a){this.optionSrc=F.get(a.srcElement||a.target,"data-id");this.updateUrl()})));b=c(".shareCheckBoxes",this.domNode);this.own(f(b,"click",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.chooseCenterWithLevel_levels,"change",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.chooseCenterWithScale_scales,"change",n.hitch(this,function(){this.updateUrl()})));this.own(f(this.setlanguage_languages,"change",
n.hitch(this,function(){this.updateUrl()})));this.own(f(this.findLocation_input,a,n.hitch(this,this.updateUrl)));this.own(f(this.queryFeature_field,"change",n.hitch(this,this._updateQueryFeature_Value)));this.own(f(this.queryFeature_value,"change",n.hitch(this,this.updateUrl)));this.own(f(this.mobileLayout,a,n.hitch(this,this.updateUrl)));this.own(f(this.authtoken,a,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})));this.own(f(this.addMarker_spatialReference,
"change",n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_title,a,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_symbolURL,a,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_label,a,n.hitch(this,this.updateUrl)));this.own(f(this.addMarker_level,"change",n.hitch(this,this.updateUrl)));this.own(f(this.chooseCenterWithLevel_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})));this.own(f(this.chooseCenterWithScale_marker,"click",n.hitch(this,function(a){this._onMarkersClick(a)})))},
_onMarkersClick:function(a){w.disableWebMapPopup(this.map);this._unselectMarkerBtn();this._selectMarkerBtn(a);this._hidePopup();this._removeGraphicsLayer();this._mapClickHandler=f.once(this.map,"click",n.hitch(this,this._onMapClick))},_onMapClick:function(a){var b=a.mapPoint;this._addGraphicsLayerMarker(a);"chooseCenterWithLevel"===this.optionSrc?this._hasZoomLevelMarkerAdded=!1:"chooseCenterWithScale"===this.optionSrc?this._hasMapScaleMarkerAdded=!1:"addMarker"===this.optionSrc&&(this._hasAddMarkerMarkerAdded=
!1);this._unselectMarkerBtn();this.updateUrl(b);this._showPopup();w.enableWebMapPopup(this.map)},_hidePopup:function(){a.publish("ShareLink/onHideContainer")},_showPopup:function(){a.publish("ShareLink/onShowContainer")},_updateResUrls:function(a){"currentMapExtent"===this.optionSrc?(a=this.getMapExtent(this.map),this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,"extent",a,!0)):"chooseCenterWithLevel"===this.optionSrc?(!1===this._hasZoomLevelMarkerAdded&&(this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,
"center",this.getMapCenter(this.map,a),!0),a&&a.x&&a.y&&(this._hasZoomLevelMarkerAdded=!0)),this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),!0)):"chooseCenterWithScale"===this.optionSrc?(!1===this._hasMapScaleMarkerAdded&&(this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,"center",this.getMapCenter(this.map,a),!0),a&&a.x&&a.y&&(this._hasMapScaleMarkerAdded=!0)),this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0)):"findLocation"===this.optionSrc?
(a=this.findLocation_input.get("value"),this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,"find",a,!0)):"queryFeature"===this.optionSrc?this._updateUrlByQueryFeatures():"addMarker"===this.optionSrc&&(!1===this._hasAddMarkerMarkerAdded?(this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,"marker",this.getMapCenter(this.map,a,null,this._getWkid()),!0),this.resultUrl+=",",a&&a.x&&a.y&&(this._hasAddMarkerMarkerAdded=!0,this._lastAddMarkerParamObj=a)):(this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,
"marker",this.getMapCenter(this.map,this._lastAddMarkerParamObj,null,this._getWkid()),!0),this.resultUrl+=","),this.resultUrl+=encodeURIComponent(this.addMarker_title.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_symbolURL.get("value")||""),this.resultUrl+=",",this.resultUrl+=encodeURIComponent(this.addMarker_label.get("value")||""),a=this._getMapLevel(),this.resultUrl="number"===typeof a&&-1!==a?w.addQueryParamToUrl(this.resultUrl,"level",this._getMapLevel(),
!0):w.addQueryParamToUrl(this.resultUrl,"scale",this._getMapScale(),!0));this.resultUrl=w.removeQueryParamFromUrl(this.resultUrl,"mobileBreakPoint",!0);this.resultUrl=w.removeQueryParamFromUrl(this.resultUrl,"locale",!0);this.resultUrl=w.removeQueryParamFromUrl(this.resultUrl,"token",!0);this.resultUrl=w.removeQueryParamFromUrl(this.resultUrl,"layers",!0);this.overwirteMobileLayout.checked&&(this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"mobileBreakPoint",this.mobileLayout.getValue(),!0));this.setlanguage.checked&&
(this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"locale",this.setlanguage_languages.getValue(),!0));this.auth.checked&&(this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"token",this.authtoken.getValue(),!0));this.setLayerVisibility.checked&&(this.resultUrl=w.addQueryParamToUrl(this.resultUrl,"showlayers",this._getLayersVisibility(),!0))},_getLayersVisibility:function(){var a=[],b=this.layerInfosObj.getSimplificationState();b&&b.showLayers&&b.showLayers.join&&(a=b.showLayers.join(";"));return a},
_updateUrlByQueryFeatures:function(){var a=this._getIdFromLayerChoose()||"",b=this.queryFeature_field.get("value"),c=this.queryFeature_value.get("value");this.resultUrl=w.addQueryParamToUrl(this.baseHrefUrl,"query",a,!0);b&&(this.resultUrl+=",",this.resultUrl+=b,c&&(this.resultUrl+=",",this.resultUrl+=c))},_updateQueryFeature_Layer:function(){this._updateUrlByQueryFeatures();this._updateQueryFeature_Field();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Field:function(){var a=
this._getFieldsFromLayerChoose(),b=[];this.queryFeature_field.removeOption(this.queryFeature_field.getOptions());m.forEach(a,n.hitch(this,function(a){-1<"esriFieldTypeString esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" ").indexOf(a.type)&&b.push({label:a.name,value:a.name})}));this.queryFeature_field.addOption(b);this._updateUrlByQueryFeatures();this._updateQueryFeature_Value();this.updateUrl()},_updateQueryFeature_Value:function(){var a=
[],b=this.queryFeature_field.get("value");a.push(b);this._query(a,this._getUrlFromLayerChoose(),this.map).then(n.hitch(this,function(a){var c=[],c=this._getQueryedValues(b,a);this.queryFeature_value.removeOption(this.queryFeature_value.getOptions());this.queryFeature_value.addOption(c);this._updateUrlByQueryFeatures();this.updateUrl()}))},_getIdFromLayerChoose:function(){var a=null,b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.id&&(a=b.layerInfo.id);return a},
_getFieldsFromLayerChoose:function(){var a=[],b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.layerInfo&&b.layerInfo.layerObject&&b.layerInfo.layerObject.fields&&(a=b.layerInfo.layerObject.fields);return a},_getUrlFromLayerChoose:function(){var a="",b=this.layerChooserFromMapWithDropbox.getSelectedItem();b&&b.url&&(a=b.url);return a},_updateLinkOptionsUI:function(){c(".optionsMore",this.domNode).style("display","none");c("."+this.optionSrc+"_optionsMore",this.domNode).style("display",
"block");this.overwirteMobileLayout.checked&&c(".share-options-overwirteMobileLayout_optionsMore",this.domNode).style("display","block");this.setlanguage.checked&&c(".share-options-language_optionsMore",this.domNode).style("display","block");this.auth.checked&&c(".share-options-auth_optionsMore",this.domNode).style("display","block")},_fixUrlIfIsOnline:function(a){if(this._isOnline&&this._isSharedToPublic){var b="",b=window.isBuilder?window.top.location.protocol:window.location.protocol,c=this._getUrlQueryString(a);
a=this._getOnlinePublicUrl(a);a=b+"//"+a+"/apps/webappviewer/index.html"+c}return a},updateUrl:function(a){this._updateResUrls(a);this._updateLinkOptionsUI();!0!==this.config.useOrgUrl&&(this.resultUrl=this._fixUrlIfIsOnline(this.resultUrl));this.preview.set("value",this.resultUrl);null===a&&this._generateShortenUrl();this._updateEmailHref()},_generateShortenUrl:function(){var a=this.preview.get("value");try{this.isUseShortenUrl()?this.shortenUrl(a,this.bitlyUrl).then(n.hitch(this,function(a){this._useShortenUrl(a);
this.HAS_INIT_URL=!0}),n.hitch(this,function(b){this._useLengthenUrl(a,b);this.HAS_INIT_URL=!0})):(this._useLengthenUrl(a),this.HAS_INIT_URL=!0)}catch(A){console.error(A),this.HAS_INIT_URL=!0}},_useShortenUrl:function(a){this.shortenedUrl=a;this._setLinkUrl(a);this._setEmbedCode(a)},_useLengthenUrl:function(a){a=a||"";this._setLinkUrl(a);this._setEmbedCode(a)},_toFacebook:function(){var a="http://www.facebook.com/sharer/sharer.php?u\x3d"+encodeURIComponent(this._linkUrlTextBox.get("value"))+"\x26t\x3d"+
encodeURIComponent(x.stripHTML(this.socialNetworkTitle(this._appTitle)));window.open(a,"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},_toFacebookKeyDown:function(a){a.keyCode===e.ENTER&&this._toFacebook()},_toTwitter:function(){var a=E.substitute(this.share.shareTwitterTxt,{appTitle:x.stripHTML(this._appTitle)}),b=this._linkUrlTextBox.get("value");window.open("http://twitter.com/home?status\x3d"+encodeURIComponent(a+b+"\n@ArcGISOnline"),"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},
_toTwitterKeyDown:function(a){a.keyCode===e.ENTER&&this._toTwitter()},_updateEmailHref:function(){var a="mailto:?subject\x3d"+E.substitute(this.share.shareEmailSubject,{appTitle:x.stripHTML(this._appTitle)}),b=this.preview.get("value"),a=a+("\x26body\x3d"+encodeURIComponent(this.nls.shareEmailTxt1)+"%0D%0A%0D%0A"+x.stripHTML(this._appTitle)),a=a+("%0D%0A"+encodeURIComponent(b)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt2)),a=a+("%0D%0A%0D%0A"+encodeURIComponent(this.nls.shareEmailTxt3));
k.setAttr(this.emailShare,"href",a)},_toGooglePlus:function(){var a=this._linkUrlTextBox.get("value"),a="http://plus.google.com/share?url\x3d"+encodeURIComponent(a);window.open(a,"","toolbar\x3d0,status\x3d0,width\x3d626,height\x3d436")},_toGooglePlusKeyDown:function(a){a.keyCode===e.ENTER&&this._toGooglePlus()},_toggleLinkOptions:function(){w.enableWebMapPopup(this.map);var b=c(".shareOptionsWrapper",this.domNode.parentNode||this.domNode.parentElement),e=c(".shareUrlsWrapper",this.domNode),f=c(".shareLinkOptionsWrapper",
this.domNode);this._isShareLinkOptionsShow()?(a.publish("ShareLink/onHideLinkOptions"),this._cleanMarkerStatus(),this._generateShortenUrl()):a.publish("ShareLink/onShowLinkOptions");b&&b[0]&&u.toggle(b[0],"displaynone");u.toggle(e[0],"displaynone");u.toggle(f[0],"displaynone")},_toggleLinkOptionsKeydown:function(a){if(a.keyCode===e.ENTER&&(this._toggleLinkOptions(),this._isShareLinkOptionsShow())){a=c(".shareRadios input",this.shareOptionsRadios);for(var b=0,f=a.length;b<f;b++){var g=a[b];g.checked&&
g.focus()}}},_moreOptionsExpandCollapse:function(){u.toggle(this.MoreOptionsContainer,"displaynone");u.toggle(this.MoreOptionsIcon,"rotate")},_moreOptionsExpandCollapseKeyDown:function(a){a.keyCode===e.ENTER&&(this._moreOptionsExpandCollapse(),k.hasClass(this.MoreOptionsContainer,"displaynone")||this._sizeOptions.focus())},_setInputsClicktoSelect:function(a){F.set(a,"onclick","this.select()");F.set(a,"onmouseup","return false;");F.set(a,"onfocus","this.select()");F.set(a,"onblur","return false;")},
isUseShortenUrl:function(){return location.hostname.endWith("esri.com")||location.hostname.endWith("arcgis.com")?!0:!1},shortenUrl:function(a,b){var c=new D;a=w.addQueryParamToUrl(b,"longUrl",a,!0);a=w.addQueryParamToUrl(a,"format","json",!0);I({url:a,handleAs:"json",callbackParamName:"callback"}).then(n.hitch(this,function(a){a&&200===a.status_code&&a.data&&a.data.url&&0<a.data.url.length?c.resolve(a.data.url):c.reject(a)}),n.hitch(this,function(a){console.log("can't fetch shortenUrl "+a);c.reject(a)}));
return c},socialNetworkTitle:function(a){100<a.length&&(a=a.substring(0,97)+"...");return a},getMapExtent:function(a){a=a.extent;var b="";a.spatialReference.wkid?b=a.spatialReference.wkid:!a.spatialReference.wkid&&a.spatialReference.wkt&&(b="wkt\x3d"+a.spatialReference.wkt);return null!==a?this._roundValue(a.xmin,1E4)+","+this._roundValue(a.ymin,1E4)+","+this._roundValue(a.xmax,1E4)+","+this._roundValue(a.ymax,1E4)+","+b:""},_roundValue:function(a,b){return Math.round(a*b)/b},getMapCenter:function(a,
b,c,e){c=c?c:",";var f=null;b&&b.x&&b.y?f=b:a.extent.getCenter()&&(f=a.extent.getCenter());a=e||f.spatialReference.wkid;return null!==f?this._roundValue(f.x,1E4)+c+this._roundValue(f.y,1E4)+c+a:""},_getMapLevel:function(){return this.map.getLevel()},_getMapScale:function(){return this.map.getScale()},_getWkid:function(){return this.addMarker_spatialReference.get("value")||""},_query:function(a,b,c){var e=new K;e.where="1\x3d1";e.outSpatialReference=c.spatialReference;e.outFields=a;return(new J(b)).execute(e)},
_getQueryedValues:function(a,b){var c=[];m.forEach(b.features,n.hitch(this,function(b){b=b.attributes[a]+"";c.push({label:b,value:b})}));return c},_addGraphicsLayer:function(){window.isBuilder||"undefined"!==typeof this._graphicsLayer||(this.map.getLayer("marker-feature-action-layer")?this._graphicsLayer=this.map.getLayer("marker-feature-action-layer"):(this._graphicsLayer=new O({id:"marker-feature-action-layer"}),this.map.addLayer(this._graphicsLayer)))},_removeGraphicsLayer:function(){window.isBuilder||
"undefined"===typeof this._graphicsLayer||(this.map.infoWindow&&this.map.infoWindow.features&&this.map.infoWindow.features[0]===this._markerGraphic&&this.map.infoWindow.hide(),this._markerGraphic&&this._markerGraphic._textSymbol&&this._graphicsLayer.remove(this._markerGraphic._textSymbol),this._graphicsLayer.remove(this._markerGraphic),this._markerGraphic=null)},_addGraphicsLayerMarker:function(a){if(!window.isBuilder&&"undefined"!==typeof this._graphicsLayer)if("addMarker"!==this.optionSrc)this._markerGraphic=
this._getMarkerGraphic(a.mapPoint),this._graphicsLayer.add(this._markerGraphic);else{var b=new M("",this.addMarker_title.get("value")||""),c=L.fromJson({type:"esriPMS",url:require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",contentType:"image/png"});c.width=26;c.height=26;c.setOffset(0,12);this._markerGraphic=new T(a.mapPoint,c,null,b);this._graphicsLayer.add(this._markerGraphic);if(b=L.fromJson({color:[0,0,0,255],type:"esriTS",verticalAlignment:"baseline",horizontalAlignment:"left",angle:0,xoffset:0,
yoffset:0,rotated:!1,kerning:!0,font:{size:12,style:"normal",weight:"bold",family:"Arial"},text:this.addMarker_label.get("value")||""}))b.xoffset=c.width/2,b.yoffset=c.height/2+c.yoffset,a=new T(a.mapPoint,b),this._graphicsLayer.add(a),this._markerGraphic._textSymbol=a}},_getMarkerGraphic:function(a){var b=new S(require.toUrl("jimu")+"/images/EsriBluePinCircle26.png",26,26);b.setOffset(0,12);return new T(a,b)},_unselectMarkerBtn:function(){for(var a=c(".markers",this.domNode),b=0,e=a.length;b<e;b++)u.remove(a[b],
"selected")},_selectMarkerBtn:function(a){u.add(a.srcElement||a.target,"selected")},_cleanMarkerStatus:function(){this._mapClickHandler&&this._mapClickHandler.remove&&this._mapClickHandler.remove();this._unselectMarkerBtn();this._removeGraphicsLayer()},_isShareLinkOptionsShow:function(){var a=c(".shareLinkOptionsWrapper",this.domNode);return!u.contains(a[0],"displaynone")},_getUrlQueryString:function(a){var b="";-1!==a.indexOf("?")&&(b=a.substring(a.indexOf("?")));return b},_getOnlinePublicUrl:function(){var a=
"www.arcgis.com",b=this._portalUrl;b&&"string"===typeof b&&(-1<b.indexOf("devext.arcgis.com")?a="devext.arcgis.com":-1<b.indexOf("qaext.arcgis.com")&&(a="qaext.arcgis.com"));return a},_watchLayerChange:function(){this.setLayerVisibility.checked&&this.updateUrl()}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(p,g,t,v,n){return p([n],{baseClass:"jimu-featurelayer-chooser-from-map",
declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=v.hitch(this,this.basicFilter);this.filter=n.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&
(this.filter=n.andCombineFilters([this.filter,v.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);t.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(g){return g.getLayerType().then(function(g){return!("ArcGISDynamicMapServiceLayer"===g||"ArcGISTiledMapServiceLayer"===g||"GroupLayer"===g)})},basicFilter:function(m){var n=new g;0<=this.ignoredFeaturelayerIds.indexOf(m.id)?n.resolve(!1):this.onlyShowVisible&&"Table"!==
m.getLayerType()?n.resolve(m.isShowInMap()):n.resolve(!0);return n},getHandledItem:function(g){var m=this.inherited(arguments),k=g&&g.layerInfo,k=k&&k.layerObject;m.url=k&&k.url||"";return m}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return p([f,e,m],{templateString:b,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource},postCreate:function(){this.inherited(arguments);this.layerInfosObj=a.getInstanceSync();this.layerChooser.domNode.style.zIndex=
1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(v(this.layerChooser,"tree-click",g.hitch(this,this._onTreeClick)));this.own(v(this.layerChooser,"update",g.hitch(this,this._onLayerChooserUpdate)));this.own(v(document.body,"click",g.hitch(this,this._onBodyClicked)));this.own(v(document.body,"keydown",g.hitch(this,function(a){a.keyCode===n.ENTER&&this._onBodyClicked(a)})));this.own(v(this.layerChooser.domNode,"keydown",g.hitch(this,
function(a){a.keyCode===n.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new u;if(a){var c=this.layerInfosObj.getLayerInfoById(a.id);c?this.layerChooser.filter(c).then(g.hitch(this,function(e){e?(this._onSelectNewItem({layerInfo:c,name:c.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),
g.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||t.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||t.isDescendant(a,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?
this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(a){a.keyCode===n.ENTER&&this._onDropDownClick(a)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";k.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&(t.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup"),this.customClass&&
t.addClass(a,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){k.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=g.getObject("layerInfo.id",!1,
this._selectedItem)||-1,c=g.getObject("layerInfo.id",!1,a)||-1,b=b!==c;this._selectedItem=a;this.hideLayerChooser();a=g.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;t.setAttr(this.layerNameNode,"title",a);a=g.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"builder/plugins/startup/_build-generate_module":function(){define(["builder/plugins/startup/Plugin",
"dojo/text!builder/plugins/startup/Plugin.html","dojo/text!builder/plugins/startup/css/style.css"],function(){})},"builder/plugins/startup/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/topic builder/BasePlugin builder/serviceUtils jimu/dijit/ViewStack jimu/utils".split(" "),function(p,g,t,v,n,m,u,k){return p([n],{baseClass:"plugin-startup",constructor:function(){this.appTypes=["HTML","HTML3D"]},postCreate:function(){this.main=new u({viewType:"dijit",views:[]},
this.viewStackNode)},startup:function(){this.main.startup();this._loadHeaderPlugin().then(g.hitch(this,function(){this._afterHeaderLoaded()}))},getCurrentView:function(){return this.main.getSelectedView()},switchToAppList:function(){var f=g.hitch(this,function(){if(window.history&&window.history.pushState){this._switchToAppList();var e=k.url.removeQueryParamFromUrl(window.location.href,"id");window.history.pushState({path:e},"",e)}else window.location.href="index.html"});document.title="Web AppBuilder for ArcGIS";
"appconfig"===this.main.getSelectedLabel()?v.publish("closeAppConfigPage",f):""===this.main.getSelectedLabel()&&(t.empty(this.viewStackNode),f());v.publish("switchToAppList")},switchToAppConfig:function(f){var e=window.location.href;window.queryObject.id?(e=k.url.removeQueryParamFromUrl(e,"id"),e=k.url.addQueryParamToUrl(e,"id",f.id)):window.queryObject.appid?(e=k.url.removeQueryParamFromUrl(e,"appid"),e=k.url.addQueryParamToUrl(e,"appid",f.id)):(e=k.url.removeQueryParamFromUrl(e,"title"),e=k.url.removeQueryParamFromUrl(e,
"tags"),e=k.url.removeQueryParamFromUrl(e,"summary"),e=k.url.removeQueryParamFromUrl(e,"folder"),e=k.url.removeQueryParamFromUrl(e,"sharewithwebmap"),e=k.url.removeQueryParamFromUrl(e,"webmap"),e=k.url.removeQueryParamFromUrl(e,"sharewithwebscene"),e=k.url.removeQueryParamFromUrl(e,"webscene"),e=k.url.removeQueryParamFromUrl(e,"appType"),e=k.url.removeQueryParamFromUrl(e,"categories"),e=k.url.addQueryParamToUrl(e,"id",f.id));if(window.location.href!==e)if(window.history&&window.history.pushState)window.history.pushState({path:e},
"",e);else{window.location.href=e;return}this._switchToApp(f);v.publish("switchToAppConfig")},_afterHeaderLoaded:function(){var f;if(window.isXT)queryObject.id?(f={id:queryObject.id.replace("#","")},this._switchToApp(f)):this._switchToAppList();else if(queryObject.id)f={id:queryObject.id.replace("#","")},this._switchToApp(f);else if(queryObject.appid)f={appid:queryObject.appid.replace("#","")},this._switchToApp(f);else if(queryObject.title){f={name:queryObject.title};queryObject.tags&&(f.tags=queryObject.tags);
queryObject.summary&&(f.description=queryObject.summary);queryObject.folder&&(f.folderId=queryObject.folder);if(queryObject.sharewithwebmap||queryObject.sharewithwebscene)f.sharing="true"===queryObject.sharewithwebmap||"true"===queryObject.sharewithwebscene;queryObject.categories&&(f.categories=queryObject.categories);queryObject.appType?(f.appType=queryObject.appType,queryObject.webmap&&(f.webmap=queryObject.webmap),queryObject.webscene&&(f.webscene=queryObject.webscene)):queryObject.webmap?(f.webmap=
queryObject.webmap,f.appType="HTML"):queryObject.webscene?(f.webscene=queryObject.webscene,f.appType="HTML3D"):f.appType="HTML";this._createApp(f)}else window.location.href=window.portalUrl},_switchToApp:function(f){var e=this.main.getViewByLabel("appconfig");e&&this.main.removeView(e);"stemapp"===f.id&&(f.id="HTML");"stemapp3d"===f.id&&(f.id="HTML3D");m.getAppInfo(f.id||f.appid).then(g.hitch(this,function(b){if("undefined"===typeof b.id)this.viewStackNode.innerHTML='\x3cimg class\x3d"image-404" src\x3d"'+
this.folderUrl+'images/404.png"\x3e';else{var a=this.pluginManager.getStemappInfo(b.appType);a.name="HTML3D"===a.appType?"stemapp3d":"stemapp";var c;c=-1<this.appTypes.indexOf(f.id)?a.appPath:window.isXT?window.path+"apps/"+b.id+"/":"HTML3D"===b.appType?window.path+"stemapp3d/":window.path+"stemapp/";window.stemappInfo=a;window.appInfo={appType:b.appType,appPath:c,appOwner:b.creator||b.owner,id:b.id,name:b.name,isPredefined:b.isPredefined,isTemplate:b.isTemplate,isTemplateApp:b.isTemplateApp};a=this.filterExtensionsByAppType("app-config",
b.appType);0===a.length?console.error("Do not find app-config extension."):1<a.length?console.error("Find more than one app-config extension."):(a=this.pluginsMeta[a[0].pluginName],a.options={appInfo:b},this.pluginManager.loadPlugin(a).then(g.hitch(this,function(a){a.label="appconfig";this.main.addView(a);this.main.switchView("appconfig")})),this._showAppName(b))}}))},_showAppName:function(f){"stemapp"===f.id?this.header.setAppName("stemapp"):f.isTemplate?this.header.setAppName(builderNls.templateLabel+
" "+f.name):this.header.setAppName(f.name);document.title=f.name+" - Web AppBuilder for ArcGIS"},_hideAppName:function(){this.header.setAppName("")},_createApp:function(f){var e=this.pluginManager.getStemappInfo(f.appType);e.name="HTML3D"===e.appType?"stemapp3d":"stemapp";window.stemappInfo=e;e=this.pluginManager.getExtensions("startup.creation-entry")[0];this.pluginManager.loadPlugin(this.pluginsMeta[e.pluginName]).then(g.hitch(this,function(b){b.createNewApp(f)}))},_switchToAppList:function(){if(this.main.getViewByLabel("applist"))this.main.switchView("applist");
else{var f=this.getPluginsMetaByExtensionPoint("app-list")[0];this.pluginManager.loadPlugin(f).then(g.hitch(this,function(e){e.label="applist";this.main.addView(e);this.main.switchView("applist")}))}this._hideAppName()},_loadHeaderPlugin:function(){var f=this.getPluginsMetaByExtensionPoint("header")[0];return this.pluginManager.loadPlugin(f).then(g.hitch(this,function(e){t.place(e.domNode,this.headerNode);e.startup();return this.header=e}))}})})},"builder/plugins/stemapps/web2d/_build-generate_module":function(){define([],
function(){})},"builder/plugins/stemapps/web3d/_build-generate_module":function(){define([],function(){})},"builder/plugins/theme-config/_build-generate_module":function(){define(["builder/plugins/theme-config/Plugin","dojo/text!builder/plugins/theme-config/Plugin.html","dojo/text!builder/plugins/theme-config/css/style.css","dojo/i18n!builder/plugins/theme-config/nls/strings"],function(){})},"builder/plugins/theme-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/Color dojo/topic dojo/on dojo/dom dojo/cookie dojo/query dojo/text!./Plugin.html dojo/dom-construct dojo/dom-style dojo/_base/array dojo/Deferred dojo/promise/all jimu/dijit/Message jimu/dijit/CheckBox ./ThemeColorChooser ./ThemeManager builder/serviceUtils builder/BasePlugin jimu/utils jimu/portalUtils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){return p([G],{baseClass:"plugin-theme-config",templateString:e,themeLoadDef:void 0,_themePageDef:void 0,_disableShowThemeSwitchMessage:null,constructor:function(){this._themePageDef=new x;this._disableShowThemeSwitchMessage=!0},postMixInProperties:function(){this.inherited(arguments);this.nls=g.mixin(this.nls,builderNls)},postCreate:function(){this.inherited(arguments);this.own(n.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigLoaded)));
this.own(n.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.own(n.subscribe("app/editLayout",g.hitch(this,this._onEditLayout)))},startup:function(){this.inherited(arguments);this.themeManager=new E;this.themeLoadDef=this.themeManager.loadThemes();this.themeLoadDef.then(g.hitch(this,function(a){this.initThemePage(a);this._themePageDef.resolve()}));this.portalSelfDef=D.getPortal(window.portalUrl).loadSelfInfo()},initThemePage:function(a){var e,f,k,n,p,q;c.forEach(a,function(a){n=
t.create("div",{"class":"catalog-theme-content-div jimu-float-leading"},this.themeList);e=t.create("div",{"class":"catalog-theme-div","data-themeName":a.getName()},n);t.create("div",{"class":"catalog-theme-name-div",innerHTML:a.getLabel(),title:a.getLabel()},n);p=t.create("div",{"class":"catalog-theme-img-box-div"},e);q=t.create("div",{"class":"catalog-theme-img-div"},p);b.create("img",{src:a.getIcon(),"class":"catalog-theme-img"},q);m(e,"click",g.hitch(this,this._onStartChangeTheme,a.getName()));
f=b.create("div",{"class":""},this.styleList);this.initStyle(a,f);k=b.create("div",{"class":""},this.layoutList);this.initLayout(a,k);a.domNodes.theme=e;a.domNodes.themeImgBox=p;a.domNodes.themeSL=void 0;a.domNodes.styleList=f;a.domNodes.layoutList=k},this)},initStyle:function(e,f){var k,p,q;k=b.create("div",{"class":"style-section"},f);b.create("div",{innerHTML:this.nls.styleTitle,"class":"style-text"},k);q=b.create("div",{"class":"style-color-content"},k);var u=e.getStyles().slice();k=u.pop();c.forEach(u,
function(c){p=b.create("div",{"class":"style-div jimu-float-leading"},q);a.set(p,"backgroundColor",c.styleColor);c.domNode=p;m(p,"click",g.hitch(this,this._onStyleChanged,c.name))},this);p=b.create("div",{"class":"style-div jimu-float-leading"},q);u=new z({showLabel:!0,recordUID:F.getColorRecordName("theme-config-Plugin")},p);k.domNode=u.domNode;k.isCustom=!0;u.domNode.className+=" style-div jimu-float-leading";e._wabDefaultColor=k.styleColor;u.setColor(new v(e._wabDefaultColor));u.setTitle(this.nls.setCustomColor);
u.startup();this.own(m(u,"clickContainer",g.hitch(this,function(a,b){b.toHex()!==(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0)},e)));this.own(m(u,"sharedThemeChanged",g.hitch(this,function(a,b,c){b.toHex()!==(a.appConfig.theme.customStyles&&a.appConfig.theme.customStyles.mainBackgroundColor)&&this._setThemeStyleToColor(a,b,!0);a=g.mixin(a.appConfig.theme.sharedTheme,c);n.publish("sharedThemeChanged",a)},e)));e._cp=u;e._lastStyle=
k;t.setStyle(f,"display","none")},initLayout:function(a,e){var f;f=b.create("div",{"class":"layout-section",id:a.getName()+"-layout-section"},e);b.create("div",{innerHTML:this.nls.layoutTitle,"class":"layout-text"},f);c.forEach(a.getLayouts(),function(b){this._drawLayout(a,b,f)},this);t.setStyle(e,"display","none")},_drawLayout:function(a,c,e){var f;c.domClass||(c.domClass=" ");e=b.create("div",{"class":"layout-out-div jimu-float-leading "},e);f=b.create("div",{"class":"layout-box-div "},e);e=b.create("div",
{"class":"layout-div "+c.domClass},f);a=isRTL?c.RTLIcon?a.getUrl()+c.RTLIcon:this.folderUrl+"css/images/current_layout.png":c.icon?a.getUrl()+c.icon:this.folderUrl+"css/images/current_layout.png";b.create("img",{"class":"layout-image",src:a},e);c.domNode=e;c.boxDomNode=f;m(e,"click",g.hitch(this,this._onLayoutChanged,c.name));a=b.create("div",{"class":"layout-selected-div"},e);b.create("img",{"class":"layout-selected-img",src:this.folderUrl+"css/images/check.png"},a);c.selectedNode=a},_onStyleChanged:function(a){this.changeStyle(a,
null,!0)},_onLayoutChanged:function(a){this.changeLayout(a,null,!0)},_onStartChangeTheme:function(a){if(this.themeManager.currentThemeName!==a)if(this._disableShowThemeSwitchMessage)this.changeTheme(a,!0);else if(k("disable_theme_switch_Message"))this.changeTheme(a,!0);else{var b=new q({message:"\x3cdiv\x3e"+this.nls.themeChangeMessage+"\x3c/div\x3e",width:500,buttons:[{label:this.nls.ok,onClick:g.hitch(this,function(){c.checked&&k("disable_theme_switch_Message",!0);b.close();this.changeTheme(a,!0)})},
{label:this.nls.cancel}]}),c=new C({label:this.nls.disableThemeSwitchMessage,"class":"jimu-float-leading",style:{marginTop:"10px"}});c.placeAt(b.contentContainerNode)}},changeStyle:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());var e=b.getCurrentStyle();if(b.currentStyleName!==a||e&&e.name===a&&e.isCustom)b.currentStyleName&&t.removeClass(b.getCurrentStyle().domNode,"style-selected"),b.changeCurrentStyle(a),t.addClass(b.getCurrentStyle().domNode,"style-selected"),c&&n.publish("styleChanged",
g.clone(b.getCurrentStyle()))},changeLayout:function(a,b,c){b||(b=this.themeManager.getCurrentTheme());b.currentLayoutName!==a&&(b.currentLayoutName&&(t.removeClass(b.getCurrentLayout().domNode,"layout-selected"),t.removeClass(b.getCurrentLayout().boxDomNode,"layout-box-selected")),b.changeCurrentLayout(a),t.addClass(b.getCurrentLayout().domNode,"layout-selected"),t.addClass(b.getCurrentLayout().boxDomNode,"layout-box-selected"),c&&n.publish("layoutChanged",g.clone(b.getCurrentLayout())))},_copyThemeFromRepo:function(a){var b=
new x,c=this.themeManager.getThemeByName(a);c.loadLayouts().then(g.hitch(this,function(){var e=c.getLayoutByName("default");B.copyThemeToApp(window.appInfo.id,a,c.appConfig?c.appConfig.getCleanConfig():e.layoutConfig).then(g.hitch(this,function(a){a.success?b.resolve():(b.reject(),console.error("change theme error, response of 'copytheme' unsuccess"))}),function(a){b.reject(a);console.error("change theme error"+a)})}));return b},changeTheme:function(a,b){var c=new x;this.themeManager.currentThemeName!==
a?(b&&this.pluginManager.getPluginByName("app-config").showLoadingCover(),this._copyThemeFromRepo(a).then(g.hitch(this,function(){this.themeManager.currentThemeName&&(t.removeClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected"),t.removeClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected"),t.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","none"),t.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display",
"none"));this.themeManager.changeCurrentTheme(a);if(b){var e=this.themeManager.getCurrentTheme(),f=e._cp;delete e._cp;n.publish("themeChanged",g.clone(e));e._cp=f}t.addClass(this.themeManager.getCurrentTheme().domNodes.theme,"catalog-theme-selected");t.addClass(this.themeManager.getCurrentTheme().domNodes.themeImgBox,"selected");t.setStyle(this.themeManager.getCurrentTheme().domNodes.styleList,"display","block");t.setStyle(this.themeManager.getCurrentTheme().domNodes.layoutList,"display","block");
e=u.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");this._toggleEditLayoutButton(this.themeManager.getCurrentTheme().getLayoutByName("default"),e);c.resolve()}))):c.resolve();return c},_onAppConfigLoaded:function(a){this._setAppConfig(a,!0);this._listenConfigPreviewWindowResizeEvent()},_listenConfigPreviewWindowResizeEvent:function(){var a=f(".preview-config\x3eiframe")[0],b=a?a.contentWindow:null;b&&(this.configWin=b,m(b,"resize",g.hitch(this,function(){this.editLayoutButton&&
(b.appInfo.isRunInMobile?t.setStyle(this.editLayoutButton,"display","none"):t.setStyle(this.editLayoutButton,"display","block"))})))},_onAppConfigChanged:function(a,b){this._setAppConfig(a,!1,b)},_setAppConfig:function(a,b,e){var f;w([this._themePageDef,this.portalSelfDef]).then(g.hitch(this,function(k){k=k[1];if(b){var m=g.getObject("portalProperties.sharedTheme.header.background",!1,k);c.forEach(this.themeManager.themes,function(b){a.theme.sharedTheme.isPortalSupport&&a.theme.sharedTheme.useHeader?
(m||(m=b._wabDefaultColor),this._setThemeStyleToColor(b,m,!1)):this.changeStyle("default",b,!1);this.changeLayout("default",b,!1);var c=g.getObject("theme.sharedTheme",!1,a);b._cp.setSharedThemeConfig(c);b.clear()},this);this.changeTheme(a.theme.name,!1).then(g.hitch(this,function(){a.theme.styles&&a.theme.styles[0]&&this.changeStyle(a.theme.styles[0],this.themeManager.getCurrentTheme(),!1);this._setLayout(a);f=this.themeManager.getCurrentTheme().getLayoutByAppConfig(a.getCleanConfig());f||(f=this.themeManager.getCurrentTheme().addLayout("appLayout",
a.getCleanConfig(),"app-layout",this.nls.appLayout),this._drawLayout(this.themeManager.getCurrentTheme(),f,void 0));this.changeLayout(f.name,this.themeManager.getCurrentTheme(),!1);this.resetStyleForOrgOrCustom(a,b,e);t.setStyle(this.themeList,"display","block")}))}else this.resetStyleForOrgOrCustom(a,b,e),this._setLayout(a)}))},_setLayout:function(a){var b,c=a.getCleanConfig();if(this.themeManager.getCurrentTheme()){b=u.byId(this.themeManager.getCurrentTheme().getName()+"-layout-section");var e=
this.themeManager.getCurrentTheme();a=e.getLayoutByAppConfig(a.getCleanConfig());a||((a=e.getLayoutByName("appLayout"))?a.layoutConfig=c:(a=e.addLayout("appLayout",c,"app-layout",this.nls.appLayout),this._drawLayout(e,a,b)));this.changeLayout(a.name,e,!1)}},_toggleEditLayoutButton:function(a,c){this._loadLayoutManager(a.layoutConfig.layoutDefinition?a.layoutConfig.layoutDefinition.manager:"jimu/layoutManagers/AbsolutePositionLayoutManager").then(g.hitch(this,function(a){a.isSupportEdit()&&!this.editLayoutButton?
(this.editLayoutButton=b.create("div",{innerHTML:'\x3cspan class\x3d"modify-icon"\x3e\x3c/span\x3e\x3cspan\x3e'+this.nls.modifyLayout+"\x3c/span\x3e","class":"layout-action"},c),this.own(m(this.editLayoutButton,"click",g.hitch(this,function(){this._editLayout()}))),this.configWin&&(this.configWin.appInfo.isRunInMobile?t.setStyle(this.editLayoutButton,"display","none"):t.setStyle(this.editLayoutButton,"display","block"))):this.editLayoutButton&&(b.destroy(this.editLayoutButton),this.editLayoutButton=
null)}))},_onEditLayout:function(){this._editLayout()},_editLayout:function(){this.pluginManager.getPluginByName("app-config").showLoadingCover();n.publish("actionTriggered",{action:"editLayout"})},_loadLayoutManager:function(a){var b=new x;require([a],g.hitch(this,function(a){a=a.getInstance();b.resolve(a)}));return b},resetStyleForOrgOrCustom:function(a,b,c){var e=this.themeManager.getCurrentTheme();if(e){e.setAppConfig(a);var f=g.getObject("theme.sharedTheme",!1,a);(f&&"sharedThemeChange"===c||
"themeChange"===c||!0===b)&&e._cp.setSharedThemeConfig(f);a=g.getObject("theme.customStyles.mainBackgroundColor",!1,a);f&&!f.useHeader&&e._cp.setNoChecked(!f.useHeader&&!a);b=!1;f&&"undefined"!==typeof f.useHeader&&!a&&"undefined"!==typeof e._wabDefaultColor&&(b=!0);a&&(e._cp.setColor(new v(a)),"sharedThemeChange"===c&&this._setThemeStyleToColor(e,a,b||e._lastStyle.styleColor!==a))}},_setThemeStyleToColor:function(a,b,c){b=new v(b);a._lastStyle.styleColor=b.toHex();a._lastStyle.isCustom=!0;a._cp.setColor(b);
this.changeStyle(a._lastStyle.name,a,c)}})})},"builder/plugins/theme-config/ThemeColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color builder/dijit/SharedThemeChooserPopup jimu/dijit/ColorPickerPopup jimu/utils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return g([t,v,p],{baseClass:"jimu-theme-color-chooser",declaredClass:"jimu.dijit.ThemeColorChooser",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',
color:null,showLabel:!1,recordUID:"",isPortalSupport:!1,postCreate:function(){this.inherited(arguments)},startup:function(){this._createTooltipDialog();this.own(u(this.domNode,"click",n.hitch(this,function(a){a.stopPropagation();a.preventDefault();this.emit("clickContainer",this.getColor())})));this.own(u(this.domNode,"mouseenter",n.hitch(this,function(){this.popup.showPopup()})));this.own(u(this.domNode,"mouseleave",n.hitch(this,function(){this.popup.hidePopup()})))},destroy:function(){this.colorPickerPopup.picker.destroy();
this.popup.destroy();this.inherited(arguments)},showSharedThemeColor:function(a){this.popup.setChecked(this.popup.ACTION.SHARED);this.emitSharedThemeChangedEvent(!0,a)},showCustomColor:function(a){a&&(a.stopPropagation(),a.preventDefault());this.popup.hidePopup();this.colorPickerPopup.showTooltipDialog();this.colorPickerPopup.initUI()},emitSharedThemeChangedEvent:function(a,b){!1!==b&&(this._useHeader=a,this.emit("sharedThemeChanged",this.getColor(),{useHeader:this._useHeader}));this.popup.hideTooltipDialog()},
_createTooltipDialog:function(){this.popup=new f({isPortalSupport:this.isPortalSupport,placeAt:this.getParent(),around:this.domNode});this.own(u(this.popup,"btnClick",n.hitch(this,function(a,b){a===this.popup.ACTION.SHARED?this.showSharedThemeColor():a===this.popup.ACTION.CUSTOM&&this.showCustomColor(b)})));this.own(u(this.popup,"showPopup",n.hitch(this,function(){this._isNoChooseState()?this.popup.setChecked("clean"):this.popup.setChecked(this._useHeader?this.popup.ACTION.SHARED:this.popup.ACTION.CUSTOM)})));
this.colorPickerPopup=new e({showColorPickerOK:!0,showLabel:!1,recordUID:this.recordUID,around:this.domNode});this.colorPickerPopup.placeAt(this.getParent());this.colorPickerPopup.startup();this.own(u(this.colorPickerPopup,"change",n.hitch(this,function(a){this.setColor(a);this.emitSharedThemeChangedEvent(!1);this.popup.setChecked(this.popup.ACTION.CUSTOM)})))},setSharedThemeConfig:function(a){a&&"undefined"!==typeof a.useHeader&&(this._useHeader=a.useHeader,this.popup.setIsPortalSupport(a.isPortalSupport),
this._isNoChooseState()||!0===a.useHeader&&this.showSharedThemeColor(!1))},_isNoChooseState:function(){return!1===this._useHeader&&!0===this._isNoChecked?!0:!1},setNoChecked:function(a){this._isNoChecked=!0===a?!0:!1},setColor:function(a){if(a instanceof k){null===this.color&&!0===this.showLabel&&this._changeLabel(a);var b=a.toHex();this.color=a;this.colorPickerPopup&&(m.setStyle(this.colorPickerPopup.domNode,"backgroundColor",b),this.colorPickerPopup.picker.refreshRecords(),this.colorPickerPopup.picker.setColor(b,
!1,!0));this.showLabel&&this._changeLabel(this.color);m.setStyle(this.domNode,"backgroundColor",b)}},getColor:function(){return this.color},_changeLabel:function(a){m.empty(this.domNode);m.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:b.invertColor(a.toHex())}},this.domNode)},onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.colorPickerPopup&&this.colorPickerPopup.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},
setTitle:function(a){this.domNode.title=a}})})},"jimu/dijit/ColorPickerPopup":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorPalette jimu/utils".split(" "),function(p,g,t,v,n,m,u,k,f,e,b){return p([g,t],{baseClass:"jimu-color-pickerPopup",declaredClass:"jimu.dijit.ColorPickerPopup",templateString:'\x3cdiv class\x3d"jimu-color-picker"\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,
color:null,showLabel:!1,around:null,_ENABLE:!0,recordUID:"",postCreate:function(){this.inherited(arguments);this._createTooltipDialog(this.domNode);this._hideTooltipDialog()},destroy:function(){f.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},enable:function(){this._ENABLE=!0;n.removeClass(this.domNode,"disable")},disable:function(){this._ENABLE=!1;n.addClass(this.domNode,"disable")},isPartOfPopup:function(a){var b=this.tooltipDialog.domNode;
return a===b||n.isDescendant(a,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},showTooltipDialog:function(){this._showTooltipDialog()},initUI:function(){this.picker.initUI()},_showTooltipDialog:function(){f.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.around?this.around:this.domNode,orient:this.orient});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){f.hide(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var a=n.create("div");
this.tooltipDialog=new k({content:a});n.addClass(this.tooltipDialog.domNode,"jimu-color-picker-popup-dialog");var b=new e({appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!0,showCoustomRecord:!0,closeDialogWhenChange:!0},recordUID:this.recordUID,onChange:v.hitch(this,function(a){a&&(a=new u(a),this.setColor(a),this.onChange(a))})});b.placeAt(a);b.startup();this.own(m(b,"close",v.hitch(this,function(){this._hideTooltipDialog()})));this.own(m(b,
"change-style",v.hitch(this,function(){this._hideTooltipDialog();this._showTooltipDialog()})));this.own(m(this.domNode,"click",v.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():!1!==this._ENABLE&&this._showTooltipDialog()})));this.own(m(document,"click",v.hitch(this,function(a){this.isPartOfPopup(a.srcElement||a.target)||this._hideTooltipDialog()})));this.picker=b},setColor:function(a){if(a instanceof u){null===this.color&&!0===this.showLabel&&
this._changeLabel(a);var b=a.toHex();this.color=a;n.setStyle(this.domNode,"backgroundColor",b);this.picker&&(this.picker.refreshRecords(),this.picker.setColor(b,!1,!0));this.showLabel&&this._changeLabel(this.color)}},getColor:function(){return this.color},_changeLabel:function(a){n.empty(this.domNode);n.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:b.invertColor(a.toHex())}},this.domNode)},onChange:function(a){a&&this.showLabel&&this._changeLabel(a)},changeColor:function(){this.picker&&
this.picker.changeColor();this.showLabel&&this._changeLabel(this.color)},setTitle:function(a){this.domNode.title=a},getTooltipDialog:function(){return this.tooltipDialog||null}})})},"jimu/dijit/ColorPalette":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojo/query jimu/dijit/ColorChooser jimu/dijit/CustomColorPicker jimu/dijit/ColorRecords dijit/popup jimu/utils dijit/a11yclick".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){return g([t,n,v,p],{templateString:"\x3cdiv\x3e\x3c/div\x3e",baseClass:"jimu-color-palette",declaredClass:"jimu.dijit.ColorPalette",_TRANSPARENT_STR:"rgba(0, 0, 0, 0)",value:"",_defaultAppearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!1,showColorPickerApply:!0,showCoustomRecord:!0,closeDialogWhenChange:!1},recordUID:"",postMixInProperties:function(){this.nls=window.jimuNls.colorPalette},postCreate:function(){this.inherited(arguments);
this.value=this.value?new f(this.value):new f("#fff");this._createContent()},initUI:function(){this._toggleCustomColorPicker("init",!1)},_createContent:function(){this.appearance=m.mixin(this._defaultAppearance,this.appearance);var a=u.create("div",{"class":"jimu-colorpalette"},this.domNode);this.initPanel=u.create("div",{"class":"init-panel"},a);this.customPanel=u.create("div",{"class":"custom-panel hide"},a);this.appearance.showTransparent&&this._createSpecialColors(this.initPanel);this.appearance.showColorPalette&&
this._createColorChooser(this.initPanel);this.appearance.showCoustom&&this._createCustomColorPicker(this.initPanel);this.appearance.showCoustom&&this.appearance.showCoustomRecord&&this._createCoustomRecord(this.initPanel)},setColor:function(a){this._isColorEqual(a)||(this.value=new f(a),this._setSpatialColor(this.value),"undefined"!==typeof this.value.a&&0===this.value.a?(this.colorChooser.setColor(new f("transparent"),!1),this.picker.setColor(new f("#fff"),!1)):(this.colorChooser.setColor(this.value.toHex(),
!1),this.picker.setColor(this.value,!1)),this.colorRecords&&this.colorRecords.selecteColor(this.value))},getColor:function(){return this.value},changeColor:function(a){if("undefined"!==typeof this.value.a&&0===this.value.a)this.onChange(this.value);else this.onChange(this.value.toHex());this.emit("change",this.value);!0===this.appearance.closeDialogWhenChange&&!1!==a&&this._closeDialog()},refreshRecords:function(){this.colorRecords&&this.colorRecords.refresh()},destroy:function(){x.close(this.tooltipDialog);
this.picker.destroy();this.inherited(arguments)},_createSpecialColors:function(a){a=u.create("div",{"class":"special-color"},a);this.transparentBtn=u.create("div",{"class":"transparent btn",innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"transparent icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"transparent text jimu-float-leading"\x3e'+this.nls.transparent+"\x3c/div\x3e\x3c/div\x3e"},a);this.own(k(this.transparentBtn,q,m.hitch(this,this._onTransparentClick)))},_onTransparentClick:function(){this.setColor(new f("transparent"));
this.changeColor()},_setSpatialColor:function(a){if(this.transparentBtn){var b=e(".btn-wapper",this.transparentBtn)[0];u.removeClass(b,"selected");a&&a.toString&&a.toString()===this._TRANSPARENT_STR&&u.addClass(b,"selected")}},_createColorChooser:function(a){this.colorChooser=new b({});this.colorChooser.placeAt(a);this.own(k(this.colorChooser,"change",m.hitch(this,function(a){a=new f(a);this.setColor(a);this.changeColor()})))},_createCustomColorPicker:function(){this.coustomtBtn=u.create("div",{"class":"coustom btn",
innerHTML:'\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"custom icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"custom text jimu-float-leading"\x3e'+this.nls.custom+"\x3c/div\x3e\x3c/div\x3e"},this.initPanel);this.own(k(this.coustomtBtn,"click",m.hitch(this,function(){this._toggleCustomColorPicker("custom")})));this.picker=new a({showOk:this.appearance.showColorPickerOK,showApply:this.appearance.showColorPickerApply,value:this.value.toHex()});this.picker.placeAt(this.customPanel);this.picker.setColor(this.value);
this.own(k(this.picker,"ok",m.hitch(this,function(a){this.setColor(new f(a));this.changeColor();this._addAColorRecord(a);this._toggleCustomColorPicker("init");this._closeDialog()})));this.own(k(this.picker,"apply",m.hitch(this,function(a){this.setColor(new f(a));this.changeColor(!1);this._addAColorRecord(a)})));this.own(k(this.picker,"cancel",m.hitch(this,function(){this._toggleCustomColorPicker("init");this._closeDialog()})))},_toggleCustomColorPicker:function(a,b){"custom"===a?(u.removeClass(this.customPanel,
"hide"),u.addClass(this.initPanel,"hide")):(u.addClass(this.customPanel,"hide"),u.removeClass(this.initPanel,"hide"));"undefined"!==typeof b&&!1===b||this.emit("change-style")},_createCoustomRecord:function(a){this.colorRecords=new c({recordsLength:10,uid:this.recordUID||""});this.colorRecords.placeAt(a);this.own(k(this.colorRecords,"choose",m.hitch(this,function(a){this.setColor(new f(a));this.changeColor()})))},_addAColorRecord:function(a){this.colorRecords&&this.colorRecords.push&&this.colorRecords.push(a)},
_isColorEqual:function(a){return this.value.toString()===(new f(a)).toString()?!0:!1},_changeLabel:function(a){u.empty(this.domNode);u.create("span",{innerHTML:a.toHex(),className:"color-label",style:{color:w.invertColor(a.toHex())}},this.domNode)},onOpen:function(){this.openDialog()},openDialog:function(){this.initUI()},_closeDialog:function(){this.emit("close")},onClose:function(){this._closeDialog()}})})},"jimu/dijit/ColorChooser":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/i18n dojo/_base/Color dijit/a11yclick dojo/i18n!dojo/nls/colors".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a){return g([t,v,n,p],{templateString:'\x3cdiv\x3e\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\x3ctable class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e',baseClass:"jimu-color-chooser",declaredClass:"jimu.dijit.ColorChooser",uid:"",colorsArray:["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),
"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),
"rgb(0,0,1) darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],postCreate:function(){this.inherited(arguments);this.colorTitleNls=e.getLocalization("dojo","colors");this._createColorsBlocks()},_createColorsBlocks:function(){this._row=this.colorsArray.length;this._col=this.colorsArray[0].length;for(var c=0;c<this._row;c++)for(var e=u.create("tr",{role:"row"},this.gridNode),f=0;f<this._col;f++){var g=this.colorsArray[c][f],n=b.named[g],p="";n?p=g:"rgb(0,0,1)"===
g&&(p="black",n="rgb(0,0,1)");g=this.colorTitleNls[p];n=(new b(n)).toString();this["record"+f]=u.create("td",{"class":"dijitPaletteCell","data-title":n,role:"gridcell"},e);var t=u.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+f]);u.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),alt:g,title:g,"data-title":p,width:"16px",height:"16px",style:"background-color: "+n},t)}this.own(k(this.gridNode,a,m.hitch(this,this.onColorClick)))},onColorClick:function(a){for(var c=
a.target;"TD"!==c.tagName;){if(!c.parentNode||c===this.gridNode)return;c=c.parentNode}c=u.getAttr(c,"data-title");c=(new b(c)).toString();this.setColor(c);a.stopPropagation();a.preventDefault()},_onChange:function(a){this.emit("change",a)},setColor:function(a,e){a=new b(a);for(var c=null,g=f("td",this.domNode),k=0,m=g.length;k<m;k++)u.removeClass(g[k],"dijitPaletteCellSelected");k=0;for(m=g.length;k<m;k++)if(a.toString()===u.getAttr(g[k],"data-title")){c=g[k];break}c&&u.addClass(c,"dijitPaletteCellSelected");
(c&&"undefined"===typeof e||!0===e)&&this._onChange(a)}})})},"jimu/dijit/CustomColorPicker":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color jimu/dijit/ColorSelector".split(" "),function(p,g,t,v,n,m,u,k,f){return g([t,v,p],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,
ensureMode:!1,showLabel:!1,postMixInProperties:function(){this.nls=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof k||(this.color=new k(this.color)):this.color=new k("#ccc");m.setStyle(this.domNode,"backgroundColor",this.color.toHex());this._createDialog(this.domNode)},destroy:function(){this.picker.destroy();this.inherited(arguments)},_handlerOk:function(e){e&&e.stopPropagation&&e.preventDefault&&(e.stopPropagation(),e.preventDefault());this.emit("ok",
this.color)},_handlerApply:function(e){e&&e.stopPropagation&&e.preventDefault&&(e.stopPropagation(),e.preventDefault());this.emit("apply",this.color)},_handlerCancel:function(e){e&&e.stopPropagation&&e.preventDefault&&(e.stopPropagation(),e.preventDefault());this.emit("cancel")},_createDialog:function(){var e=m.create("div",{"class":"dojox-color-picker-container"},this.domNode),b=new f({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:n.hitch(this,function(a){a=
new k(a);this.setColor(a)})});b.placeAt(e);b.startup();e=m.create("div",{"class":"btns-container jimu-float-trailing"},e);if(!0===this.showOk){var a=m.create("div",{"class":"jimu-btn jimu-float-leading ok",title:this.nls.ok,innerHTML:this.nls.ok},e);this.own(u(a,"click",n.hitch(this,function(a){var b=this.picker.get("value");this.setColor(new k(b));this._handlerOk(a)})))}!0===this.showApply&&(a=m.create("div",{"class":"jimu-btn jimu-float-leading apply",title:this.nls.apply,innerHTML:this.nls.apply},
e),this.own(u(a,"click",n.hitch(this,function(a){var b=this.picker.get("value");this.setColor(new k(b));this._handlerApply(a)}))));e=m.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-leading",title:this.nls.cancel,innerHTML:this.nls.cancel},e);this.own(u(e,"click",n.hitch(this,function(a){this._handlerCancel(a)})));this.picker=b},setColor:function(e){if(e instanceof k){var b=this.color,a="";b&&(a=b.toHex());b=e.toHex();this.color=e;a!==b&&this.picker.set("value",b)}},getColor:function(){return this.color},
onClose:function(){}})})},"jimu/dijit/ColorRecords":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/_base/Color dojo/cookie dojo/text!./templates/ColorRecords.html dijit/a11yclick".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){return g([t,v,n,p],{templateString:a,baseClass:"jimu-color-records",declaredClass:"jimu.dijit.ColorRecords",uid:"",recordsLength:10,colorList:null,
postCreate:function(){this.inherited(arguments);this.colorList=[];this._createCoustomRecord();""===this.uid&&(this.uid="wab_colorRecords");this.refresh()},push:function(a){this.colorList.unshift(a);this.colorList.length>this.recordsLength&&this.colorList.pop();this._setColors()},selecteColor:function(a){a=new e(a);for(var b=null,c=f("td",this.domNode),g=0,k=c.length;g<k;g++)u.removeClass(c[g],"dijitPaletteCellSelected");g=0;for(k=c.length;g<k;g++)if(a.toString()===u.getAttr(c[g],"title")){b=c[g];
break}b&&(u.addClass(b,"dijitPaletteCellSelected"),this.onChoose(a))},refresh:function(){this._getCookie(this.uid);this._setColors()},_setColors:function(){for(var a=0;a<this.recordsLength;a++){var b=this["record"+a];if(b&&this.colorList[a]&&this.colorList[a].toString){var c=this.colorList[a].toString();u.setAttr(b,"title",c);b=this._findImg(b);u.setStyle(b,"background-color",c);u.setAttr(b,"alt",c);u.setAttr(b,"title",c)}}this._setCookie(this.uid)},_createCoustomRecord:function(){for(var a=0;a<this.recordsLength;a++){this["record"+
a]=u.create("td",{"class":"dijitPaletteCell",tabindex:a,title:"",role:"gridcell"},this.container);var b=u.create("span",{"class":"dijitInline dijitPaletteImg"},this["record"+a]);u.create("img",{"class":"dijitColorPaletteSwatch",src:require.toUrl("dojo/resources/blank.gif"),style:"background-color: #ffffff"},b)}this.own(k(this.gridNode,c,m.hitch(this,this.onRecordClick)))},onRecordClick:function(a){for(var b=a.target;"TD"!==b.tagName;){if(!b.parentNode||b===this.gridNode)return;b=b.parentNode}b=u.getAttr(b,
"title");b=(new e(b)).toString();this.onChoose(b);a.stopPropagation();a.preventDefault()},onChoose:function(a){this.emit("choose",a)},_findImg:function(a){var b=null;return a.nodeName&&"IMG"===a.nodeName.toUpperCase()?a:b=f(".dijitColorPaletteSwatch",a)[0]},_setCookie:function(a){for(var c=[],e=0,f=this.recordsLength;e<f;e++){var g=this.colorList[e];g&&g.toString&&(c[e]=g.toString())}this._cleanCookie(a);try{var k=JSON.stringify(c);b(a,k,{expires:1E3,path:"/"})}catch(B){console.error("ColorRecords: cookieList JSON.stringify error."+
B.stack)}},_getCookie:function(a){a=b(a);if("undefined"!==typeof a)try{var c=JSON.parse(a);if(c&&"undefined"!==typeof c.length){a=0;for(var f=this.recordsLength;a<f;a++){var g=c[a];g&&g.toString&&(this.colorList[a]=new e(g.toString()))}}}catch(z){console.error("ColorRecords: cookieList JSON.parse error."+z.stack)}},_cleanCookie:function(a){b(a,null,{expires:-1})}})})},"builder/plugins/theme-config/ThemeManager":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred ./Theme builder/serviceUtils".split(" "),
function(p,g,t,v,n,m){return p(null,{themes:void 0,constructor:function(){this.currentThemeName=null;this.themes=[]},loadThemes:function(){var p=new v;m.getAllThemes().then(t.hitch(this,function(k){k.success?(g.forEach(k.themes,function(f){this.themes.push(new n(f))},this),p.resolve(this.themes)):(console.error("Gets themes failed! The response of getThemes is 'unsuccess'!"),p.reject(this.themes))}),function(g){console.error("Gets themes failed!"+g);p.reject(this.themes)});return p},changeCurrentTheme:function(g){this.currentThemeName=
g},getCurrentTheme:function(){return this.getThemeByName(this.currentThemeName)},getThemeByName:function(g){for(var k=0;k<this.themes.length;k++)if(g===this.themes[k].getName())return this.themes[k]}})})},"builder/plugins/theme-config/Theme":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/request jimu/utils".split(" "),function(p,g,t,v,n,m,u,k){return p(null,{appConfig:void 0,currentStyleName:void 0,currentLayoutName:void 0,
_manifest:void 0,constructor:function(f){this._manifest=f;this.domNodes={}},clear:function(){var f;this.appConfig=null;for(f=0;f<this._manifest.layouts.length;f++)if("appLayout"===this._manifest.layouts[f].name){this._manifest.layouts[f].domNode&&t.destroy(this._manifest.layouts[f].domNode);this._manifest.layouts.splice(f,1);break}},loadLayouts:function(){var f=new n,e=[],b=v.filter(this._manifest.layouts,function(a){return"appLayout"!==a.name});v.forEach(b,function(a){e.push(u(this._manifest.url+
a.uri,{handleAs:"json"}))},this);m(e).then(g.hitch(this,function(a){var c;v.forEach(b,function(b,e){b.layoutConfig=a[e];"default"===b.name?c=b.layoutConfig:(e=b.layoutConfig.layoutDefinition,b.layoutConfig=k.mixinAppConfigPosition(c,b.layoutConfig),b.layoutConfig.layoutDefinition=e);b.layoutConfig.mobileLayout&&(b.layoutConfig.mobileLayout=k.mixinAppConfigPosition(b.layoutConfig,b.layoutConfig.mobileLayout),delete b.layoutConfig.mobileLayout.mobileLayout)},this);f.resolve()}),function(){f.reject()});
return f},_processLayoutConfig:function(f,e){return k.mixinAppConfigPosition(f,e)},setAppConfig:function(f){this.appConfig=f},getName:function(){return this._manifest.name},getVersion:function(){return this._manifest.version},getLabel:function(){return this._manifest.label},getIcon:function(){return this._manifest.icon},getLayouts:function(){return this._manifest.layouts},getStyles:function(){return this._manifest.styles},getUrl:function(){return this._manifest.url},getCurrentStyle:function(){return this.getStyleByName(this.currentStyleName)},
getCurrentLayout:function(){return this.getLayoutByName(this.currentLayoutName)},changeCurrentStyle:function(f){this.currentStyleName=f},changeCurrentLayout:function(f){this.currentLayoutName=f},addLayout:function(f,e,b,a){var c,g=this.getLayouts();for(c=0;c<g.length;c++)if(g[c].name===f)return null;f={description:"this is current app layout",name:f,label:a,layoutConfig:e,domClass:b};this._manifest.layouts.push(f);return f},getStyleByName:function(f){var e,b=null;for(e=0;e<this._manifest.styles.length;e++)if(this._manifest.styles[e].name===
f){b=this._manifest.styles[e];break}return b},getLayoutByName:function(f){var e,b=null;for(e=0;e<this._manifest.layouts.length;e++)if(this._manifest.layouts[e].name===f){b=this._manifest.layouts[e];break}return b},getLayoutByAppConfig:function(f){var e,b=null;for(e=0;e<this._manifest.layouts.length;e++)if(this.isAppUseLayout(f,this._manifest.layouts[e].layoutConfig)){b=this._manifest.layouts[e];break}return b},isAppUseLayout:function(f,e){f=g.clone(f);e=g.clone(e);f.map||(f.map={});e.map||(e.map=
f.map);f.map.position||(f.map.position={left:0,top:0});e.map.position||(e.map.position=f.map.position);if(!k.isEqual(f.layoutDefinition,e.layoutDefinition)||!k.isEqual(f.map.position,e.map.position))return!1;f.widgetOnScreen||(f.widgetOnScreen={});e.widgetOnScreen||(e.widgetOnScreen={});f.widgetOnScreen.widgets||(f.widgetOnScreen.widgets=[]);e.widgetOnScreen.widgets||(e.widgetOnScreen.widgets=[]);f.widgetOnScreen.groups||(f.widgetOnScreen.groups=[]);e.widgetOnScreen.groups||(e.widgetOnScreen.groups=
[]);var b,a;b=f.widgetOnScreen.widgets.length<e.widgetOnScreen.widgets.length?f.widgetOnScreen.widgets.length:e.widgetOnScreen.widgets.length;for(a=0;a<b;a++)if(f.widgetOnScreen.widgets[a].position||(f.widgetOnScreen.widgets[a].position={}),e.widgetOnScreen.widgets[a].position||(e.widgetOnScreen.widgets[a].position=f.widgetOnScreen.widgets[a].position),e.widgetOnScreen.widgets[a].position.relativeTo||(e.widgetOnScreen.widgets[a].position.relativeTo=f.widgetOnScreen.widgets[a].position.relativeTo),
!k.isEqual(f.widgetOnScreen.widgets[a].position,e.widgetOnScreen.widgets[a].position))return!1;b=f.widgetOnScreen.groups.length<e.widgetOnScreen.groups.length?f.widgetOnScreen.groups.length:e.widgetOnScreen.groups.length;for(a=0;a<b;a++)if(f.widgetOnScreen.groups[a].panel||(f.widgetOnScreen.groups[a].panel={}),e.widgetOnScreen.groups[a].panel||(e.widgetOnScreen.groups[a].panel=f.widgetOnScreen.groups[a].panel),f.widgetOnScreen.groups[a].panel.position||(f.widgetOnScreen.groups[a].panel.position={}),
e.widgetOnScreen.groups[a].panel.position||(e.widgetOnScreen.groups[a].panel.position=f.widgetOnScreen.groups[a].panel.position),e.widgetOnScreen.groups[a].panel.position.relativeTo||(e.widgetOnScreen.groups[a].panel.position.relativeTo=f.widgetOnScreen.groups[a].panel.position.relativeTo),!k.isEqual(f.widgetOnScreen.groups[a].panel.position,e.widgetOnScreen.groups[a].panel.position))return!1;return!0},getLayoutFromConfig:function(f){var e={};f=g.clone(f);f.widgetOnScreen&&(e.widgetOnScreen={},f.widgetOnScreen.widgets&&
(e.widgetOnScreen.widgets=[],v.forEach(f.widgetOnScreen.widgets,function(b,a){e.widgetOnScreen.widgets[a]={position:b.position?b.position:{left:0,top:0}}})),f.widgetOnScreen.groups&&(e.widgetOnScreen.groups=[],v.forEach(f.widgetOnScreen.groups,function(b,a){e.widgetOnScreen.groups[a]={position:b.position?b.position:{left:0,top:0}}})));f.map&&(e.map={position:f.map.position});return e}})})},"builder/plugins/widget-config/_build-generate_module":function(){define(["builder/plugins/widget-config/Plugin",
"dojo/text!builder/plugins/widget-config/Plugin.html","dojo/text!builder/plugins/widget-config/css/style.css","dojo/i18n!builder/plugins/widget-config/nls/strings"],function(){})},"builder/plugins/widget-config/Plugin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/fx dojo/topic dojo/on dijit/_WidgetBase ./WidgetsList ./MoveableNode ./WidgetSettingPage ./GroupSettingPage ./WidgetChoosePage jimu/utils jimu/PoolControllerMixin jimu/dijit/ViewStack jimu/dijit/Popup builder/BasePlugin esri/lang".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E){return p([z],{baseClass:"plugin-widget-config app-widgets",postMixInProperties:function(){this.nls=g.mixin(this.nls,window.builderNls)},postCreate:function(){this.inherited(arguments);this.notRemoveableWidgetOnScreen=new f({name:"notRemoveableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.notRemoveableOnScreenWidgetsListNode);this.removeableWidgetOnScreen=new f({name:"removeableWidgetOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.removeableOnScreenWidgetsListNode);
this.groupOnScreen=new f({name:"groupOnScreen",nls:this.nls,folderUrl:this.folderUrl},this.onScreenGroupsListNode);this.poolWidgets=new f({name:"poolWidgets",nls:this.nls,folderUrl:this.folderUrl},this.poolWidgetsListNode);this.viewStack=new q({viewType:"dom",views:[this.preloadWidgetsNode,this.poolWidgetsNode]});this.viewStack.placeAt(this.domNode);this.poolControllerClass=p([k,w]);this.own(m.subscribe("editWidget",g.hitch(this,this._onEditWidget)));this.own(m.subscribe("chooseWidget",g.hitch(this,
this._onChooseWidget)));this.own(m.subscribe("editGroup",g.hitch(this,this._onEditGroup)));this.own(m.subscribe("app/appConfigChanged",g.hitch(this,this._onAppConfigChanged)));this.own(m.subscribe("app/appConfigLoaded",g.hitch(this,this._onAppConfigChanged)));this.own(m.subscribe("widgetSettingPageOk",g.hitch(this,this._onWidgetSettingPageOk)));this.own(u(this.poolWidgets,"offpanel-group-error",g.hitch(this,this._onOffPanelGroupError)));this.own(u(this.groupOnScreen,"group-exceed-max-error",g.hitch(this,
this._onGroupExceedMaxError)));this.own(u(this.groupOnScreen,"groupOpened",g.hitch(this,this._onOnScreenGroupOpenClose)));this.own(u(this.groupOnScreen,"groupClosed",g.hitch(this,this._onOnScreenGroupOpenClose)));window.isRTL&&(t.removeClass(this.backArrowNode,"icon-arrow-back"),t.addClass(this.backArrowNode,"icon-arrow-forward"))},startup:function(){this.inherited(arguments);this.viewStack.startup();this.poolWidgets.opened=!1;this._init(this.appConfig)},destroy:function(){v.forEach(this.controllers,
function(a){a.destroy()});this.controllers=[];this.inherited(arguments)},onShown:function(){this._init(this.appConfig)},onHidden:function(){},_onAppConfigChanged:function(a){this._started?this.appConfig&&x.isEqual(this.appConfig.widgetOnScreen,a.widgetOnScreen)&&x.isEqual(this.appConfig.widgetPool,a.widgetPool)?this.appConfig=a:this._init(a):this.appConfig=a},_init:function(a){this.appConfig=a;this._createControllerWidgetNodes();this.poolWidgets.opened?0<this.controllers.length?v.some(this.controllers,
function(a){if(this.poolWidgets.controller.id===a.id)return this._initWidgetPool(a),!0},this)||this._initWidgetPool(this.controllers[0]):(this._initWidgetPool(null),this._onBackWidgetsClick()):this._initOnScreenWidget(a);this.widgetChoosePage&&this.widgetChoosePage.setAppConfig(a);this.widgetSettingPage&&this.widgetSettingPage.setAppConfig(a)},_onOffPanelGroupError:function(){t.setStyle(this.offPanelToGroupErrorNode,{display:"block",opacity:1});n.fadeOut({node:this.offPanelToGroupErrorNode,duration:5E3,
onEnd:g.hitch(this,function(){t.setStyle(this.offPanelToGroupErrorNode,{display:"none"})})}).play()},_onGroupExceedMaxError:function(a){a=E.substitute({maxCount:a.maxWidgets},this.nls.addWidgetExceedMax);this.groupExceedMaxErrorStringNode.innerText=a;t.setStyle(this.groupExceedMaxErrorNode,{display:"block",opacity:1});n.fadeOut({node:this.groupExceedMaxErrorNode,duration:5E3,onEnd:g.hitch(this,function(){t.setStyle(this.groupExceedMaxErrorNode,{display:"none"})})}).play()},_onOnScreenGroupOpenClose:function(){t.setStyle(this.onScreenGroupsListNode,
{height:this.groupOnScreen.getListHeight()+"px"})},_getNonControllerAndNotRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];v.forEach(a.widgetOnScreen.widgets,function(a){a.isController||!1!==a.inPanel||!0===a.closeable||b.push(a)},this);return b},_getNonControllerAndRemoveableOnScreenWidgets:function(a){var b=[];if(!a.widgetOnScreen)return[];v.forEach(a.widgetOnScreen.widgets,function(a){a.isController||(!1!==a.inPanel||!0!==a.closeable)&&!0!==a.inPanel&&a.uri||b.push(a)},
this);return b},_getOnScreenGroups:function(a){return a.widgetOnScreen&&a.widgetOnScreen.groups?a.widgetOnScreen.groups:[]},_createControllerWidgetNodes:function(){v.forEach(this.controllers,function(a){t.destroy(a.node);a.destroy()},this);this.controllers=[];v.forEach(this.appConfig.widgetOnScreen.widgets,function(a){a.isController&&this._createControllerWidgetNode(a)},this);this.controllerWidgetsHeight=118*this.controllers.length;t.setStyle(this.controllerWidgetsNode,{height:this.controllerWidgetsHeight+
"px"})},_createControllerWidgetNode:function(a){var b=t.create("div",{"class":"controller-widget"},this.controllerWidgetsNode),c={};window.isRTL?c.right="30px":c.left="30px";c=new e({type:"widget",w:74,h:118,setting:a,listName:"controllerWidgets",style:c,nls:this.nls});t.place(c.domNode,b);c.startup();c=t.create("div",{"class":"action-node"},b);t.create("div",{"class":"action-text jimu-float-leading jimu-leading-margin1",title:this.nls.setControlledWidgets,innerHTML:this.nls.setControlledWidgets},
c);window.isRTL?t.create("div",{"class":"action-arrow feature-action icon-arrow-left jimu-float-trailing jimu-trailing-margin2"},c):t.create("div",{"class":"action-arrow feature-action icon-arrow-right jimu-float-trailing jimu-trailing-margin2"},c);a=new this.poolControllerClass(a);a.appConfig=this.appConfig;a.node=b;this.controllers.push(a);this.own(u(c,"click",g.hitch(this,this._openWidgetPool,a)))},_openWidgetPool:function(a){!1!==a.visible&&(this.currentController=a,this.viewStack.switchView(this.poolWidgetsNode),
this.poolWidgets.opened=!0,this.removeableWidgetOnScreen.opened=!1,this.notRemoveableWidgetOnScreen.opened=!1,this.controllerLabelNode.innerHTML=x.stripHTML(a.label),this.poolWidgets._started||this.poolWidgets.startup(),this._initWidgetPool(a))},_initWidgetPool:function(a){this.poolWidgets.controller=a;this.poolWidgets.setAppConfig(this.appConfig);this.poolWidgets.setSettings(a?a.getAllConfigs():[])},_initOnScreenWidget:function(a){this.groupOnScreen._started||this.groupOnScreen.startup();this.groupOnScreen.setSettings(this._getOnScreenGroups(a));
this.groupOnScreen.setAppConfig(a);0<this.controllers.length&&0<this.groupOnScreen.settings.length&&(0<this.controllers.length||0<this.groupOnScreen.settings.length)?t.setStyle(this.onScreenGroupsHline,"display",""):t.setStyle(this.onScreenGroupsHline,"display","none");t.setStyle(this.onScreenGroupsListNode,{height:this.groupOnScreen.getListHeight()+"px"});this.notRemoveableWidgetOnScreen._started||this.notRemoveableWidgetOnScreen.startup();this.notRemoveableWidgetOnScreen.setAppConfig(a);this.notRemoveableWidgetOnScreen.setSettings(this._getNonControllerAndNotRemoveableOnScreenWidgets(a));
0<this.notRemoveableWidgetOnScreen.settings.length?t.setStyle(this.notRemoveableOnScreenWidgetsHline,"display",""):t.setStyle(this.notRemoveableOnScreenWidgetsHline,"display","none");t.setStyle(this.notRemoveableOnScreenWidgetsListNode,{height:this.notRemoveableWidgetOnScreen.getListHeight()+"px"});this.removeableWidgetOnScreen._started||this.removeableWidgetOnScreen.startup();this.removeableWidgetOnScreen.setAppConfig(a);this.removeableWidgetOnScreen.setSettings(this._getNonControllerAndRemoveableOnScreenWidgets(a));
0<this.removeableWidgetOnScreen.settings.length&&(0<this.controllers.length||0<this.notRemoveableWidgetOnScreen.settings.length)?t.setStyle(this.removeableOnScreenWidgetsHline,"display",""):t.setStyle(this.removeableOnScreenWidgetsHline,"display","none")},_onBackWidgetsClick:function(){this._createControllerWidgetNodes();this.viewStack.switchView(this.preloadWidgetsNode);this.poolWidgets.opened=!1;this.removeableWidgetOnScreen.opened=!0;this.notRemoveableWidgetOnScreen.opened=!0;this._initOnScreenWidget(this.appConfig)},
_onEditWidget:function(a,c){this.widgetSettingPage=new b({appConfig:this.appConfig,nls:this.nls},this.widgetSettingPageNode);this.widgetSettingPage.setting=g.clone(a);this.widgetSettingPage.fromNode=c;a=new C({titleLabel:this.nls.configLabel+" "+a.label,content:this.widgetSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:g.hitch(this.widgetSettingPage,this.widgetSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:g.hitch(this.widgetSettingPage,this.widgetSettingPage.onCancel)}],
onClose:g.hitch(this.widgetSettingPage,this.widgetSettingPage.onClose)});t.addClass(a.domNode,"widget-setting-popup");this.widgetSettingPage.startup()},_onChooseWidget:function(a,b){this.widgetChoosePage=new c({appConfig:this.appConfig,nls:this.nls,options:{includeOffPanel:"groupOnScreen"===b?!1:!0}},this.widgetChoosePageNode);this.widgetChoosePage.fromNode=a;this.widgetChoosePage.fromList=b;new C({titleLabel:this.nls.chooseWidget,content:this.widgetChoosePage,container:"main-page",buttons:[{label:this.nls.ok,
onClick:g.hitch(this.widgetChoosePage,this.widgetChoosePage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});this.widgetChoosePage.startup()},_onEditGroup:function(b,c){this.groupSettingPage=new a({setting:g.clone(c),nls:this.nls});new C({titleLabel:c.groupPopupTitle||c.label,content:this.groupSettingPage,container:"main-page",buttons:[{label:this.nls.ok,onClick:g.hitch(this.groupSettingPage,this.groupSettingPage.onOk)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}]});
this.groupSettingPage.startup()},_onWidgetSettingPageOk:function(a){a.isController&&m.publish("widgetChanged",a)},_getPopupSize:function(){var a=t.getContentBox("main-page"),b={};1024>=a.w?(b.width=a.w-20,b.height=a.h-20):(b.width=1024,b.height=768);return b}})})},"builder/plugins/widget-config/WidgetsList":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/aspect dojo/Evented dojo/query dojo/NodeList-dom dijit/_WidgetBase ./MoveableNode ./LinkList jimu/utils".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){function x(a){var b={};isFinite(a.l)&&(b.left=a.l+"px");isFinite(a.t)&&(b.top=a.t+"px");isFinite(a.w)&&(b.width=a.w+"px");isFinite(a.h)&&(b.height=a.h+"px");return b}var w,q=window.Sortable,C=p([e],{box:null,marginBox:null,postCreate:function(){this.inherited(arguments);this.domNode=t.create("div",{"class":"node-margin"});this.type="addBtn"===this.node.type?"addMargin":"margin"}});return p([e,u],{postCreate:function(){this.nodeList=new a({name:this.name});this.own(n.subscribe("widgetChoosePageOk",
g.hitch(this,this._onWidgetChoosePageOk)));this.own(n.subscribe("widgetSettingPageOk",g.hitch(this,this._onWidgetSettingPageOk)))},startup:function(){this.inherited(arguments);this.settings&&this.initNodes()},setSettings:function(a){this.settings=g.clone(a);this.initNodes()},setAppConfig:function(a){this.appConfig=a},addWidget:function(a){a=this.createMoveableNode("widget",a);this.nodeList.insertNode(a);this.placeNodes()},createMoveableNode:function(a,e){var f=g.clone(this.box);f.h=Infinity;var k=
new b({type:a,w:74,h:118,setting:e,listName:this.name,parentBox:f,nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig});t.place(k.domNode,this.domNode);k.startup();this.bindMoveEvent(k);"group"===a&&(m.after(k,"openGroup",g.hitch(this,this.openGroup,k)),m.after(k,"closeGroup",g.hitch(this,this.closeGroup,k)));k.on("removeNode",g.hitch(this,function(){"poolWidgets"===this.name||"groupOnScreen"===this.name?(k.gnode?(this.nodeList.removeNode(k),this._reopenGroup()):this.nodeList.removeNode(k),
this.placeNodes(),"poolWidgets"===this.name?this.publishPoolChangeEvent():n.publish("groupChanged",k.gnode.setting)):(k.setting.uri="",k.setting.label=this.nls.defaultWidgetLabel,k.setting.name=void 0,k.setting.placeholderIndex="?",k.setting.config=void 0,this.label=this.nls.defaultWidgetLabel,c.widgetJson.removeManifestFromWidgetJson(k.setting),n.publish("widgetChanged",k.setting))}));k.on("clickOpenAtStart",g.hitch(this,function(){var a={id:k.setting.id,openAtStart:!k.setting.openAtStart};a.isOnScreen=
"poolWidgets"===this.name?!1:!0;n.publish("openAtStartChange",a)}));this.createMarginNode(k);return k},openGroup:function(a){var b,c,e,f,k,m,n;this.openedGNode&&this.openedGNode!==a&&this.openedGNode.closeGroup(this.openedGNode);b=a.setting.widgets;k=this.getNodePosition(this.nodeList.getNodeIndex(a)).r;m=this._groupCanAddMoreWidget(a)?Math.ceil((b.length+1)/w):Math.ceil(b.length/w);c=k*w+1;e=this.nodeList.getNodeByIndex(c);for(f=this.nodeList.getCount()+1;f<c;f++)n=this.createMoveableNode("empty"),
n.gnode=a,this.nodeList.insertNode(n,e);this.openedGNode=a;this.openedGNode.panelRow=k+1;this.createGroupPanel(k+1,m);b.forEach(g.hitch(this,function(b){b=this.createMoveableNode("widget",b);b.gnode=a;this.nodeList.insertNode(b,e)}));"groupOnScreen"===this.name?this._groupCanAddMoreWidget(a)?(f=this.createMoveableNode("addBtn"),f.gnode=a,this.nodeList.insertNode(f,e),b=w*m-b.length-1):b=w*m-b.length:b=w*m-b.length;for(f=0;f<b;f++)n=this.createMoveableNode("empty"),n.gnode=a,this.nodeList.insertNode(n,
e);this.placeNodes();this.emit("groupOpened")},_groupCanAddMoreWidget:function(a){return"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length},createGroupPanel:function(a,b){a={t:118*(a-1)-10,h:118*b+0*(b-1),w:94*w-20+20};window.isRTL?a.r=10:a.l=10;this.groupPanel=t.create("div",{"class":"widget-group-panel",style:x(a)},this.domNode);a=(this.openedGNode.pos.c-1)%w*94+37;window.isRTL&&(a=1===this.openedGNode.pos.c?94*w-37:(w-this.openedGNode.pos.c+1)%w*94-37);t.create("div",
{"class":"group-triangle",style:{left:a+"px"}},this.groupPanel);this.groupPanel.type="panel"},closeGroup:function(a){var b=[];a.setting.widgets=[];this.nodeList.visitNodes(g.hitch(this,function(c){c.gnode===a&&("empty"!==c.type&&"addBtn"!==c.type&&a.setting.widgets.push(c.setting),b.push(c))}));b.forEach(g.hitch(this,function(a){this.nodeList.removeNode(a)}));0===a.setting.widgets.length?"poolWidgets"===this.name&&this.nodeList.removeNode(a):a.updateSmallWidgets();this.placeNodes();t.destroy(this.groupPanel);
this.openedGNode=null;this.emit("groupClosed")},initNodes:function(){this.box=t.getContentBox(this.domNode);this.position=t.position(this.domNode,!0);w=Math.floor(this.box.w/94);this.destroyShadowNode();var a=this.settings;"notRemoveableWidgetOnScreen"===this.name?a=a.sort(function(a,b){return a.label.localeCompare(b.label)}):"removeableWidgetOnScreen"===this.name?1<a.length&&(a=a.sort(function(a,b){var c;v.some(["left","top","right","bottom"],function(e){if(!isNaN(a.position[e])){if(isNaN(b.position[e]))return c=
1,!0;if(a.position[e]!==b.position[e])return c=a.position[e]-b.position[e],!0}else if(!isNaN(b.position[e]))return c=-1,!0});return isNaN(c)?0:c})):a=a.sort(function(a,b){return a.index-b.index});var b;this.openedGNode&&(b=this.openedGNode.label,this.closeGroup(this.openedGNode));this.nodeList.destroyAllNodes();"poolWidgets"===this.name&&(this.addBtn=this.createMoveableNode("addBtn"),this.nodeList.insertNode(this.addBtn));a.forEach(g.hitch(this,function(a,b){if(a=a.widgets?this.createMoveableNode("group",
a):a.uri?this.createMoveableNode("widget",a):this.createMoveableNode("placeholder",a))t.setAttr(a.domNode,"data-id",b),this.nodeList.insertNode(a)}));"poolWidgets"===this.name&&this.nodeList.insertNode(this.createMoveableNode("empty"));"removeableWidgetOnScreen"===this.name&&q?(this.sortableNodes&&this.sortableNodes.destroy(),this.sortableNodes=q.create(this.domNode,{sort:!0,disabled:!1,draggable:".widget-node",animation:150,onSort:g.hitch(this,function(){var b=[],c;this.sortableNodes.toArray().forEach(function(e,
f){c=g.clone(a[+e]);c.position=g.clone(a[f].position);b.push(c)});n.publish("onScreenOrderChanged",b)})})):this.placeNodes();b&&(b=this.nodeList.getNodeByLabel(b))&&(this.openGroup(b),b.status="open")},getListHeight:function(){var a=0;this.nodeList.visitNodes(function(b){a=Math.max(b.pos.r,a)});return 118*a},_removeActive:function(){k(".node-margin-active",this.domNode).removeClass("node-margin-active");k(".empty-node-active",this.domNode).removeClass("empty-node-active");k(".node-active",this.domNode).removeClass("node-active")},
bindMoveEvent:function(a){"addBtn"!==a.type&&a.dnd&&(m.after(a.dnd,"onMove",g.hitch(this,function(b,c,e){b=this.getMousePosition(e);this.mouseNode=this.getNodeByMousePosition(a,b);this._removeActive();this.mouseNode&&"margin"===this.mouseNode.type?t.addClass(this.mouseNode.domNode,"node-margin-active"):this.mouseNode&&"empty"===this.mouseNode.type?t.addClass(this.mouseNode.domNode,"empty-node-active"):!this.mouseNode||"group"!==this.mouseNode.type&&"widget"!==this.mouseNode.type||t.addClass(this.mouseNode.domNode,
"node-active")}),!0),m.after(a.dnd,"onMoveStart",g.hitch(this,function(){this.destroyShadowNode();this.createShadowNode(a);t.setStyle(a.boxNode,"cursor","move")}),!0),m.after(a.dnd,"onMoveStop",g.hitch(this,this._onMoveStop,a),!0))},_onMoveStop:function(a){var b=!1,c=[];t.setStyle(a.boxNode,"cursor","pointer");this.mouseNode&&(a===this.mouseNode?console.log("move to the same node"):"margin"===this.mouseNode.type?(this.moveNodeToMargin(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),
b=!0):"empty"===this.mouseNode.type?this.mouseNode.gnode&&"group"===a.type?console.log("not allow move group to opened group, revert"):(this.moveNodeToEmpty(a,this.mouseNode),"groupOnScreen"===this.name&&c.push(a.gnode.setting),b=!0):"group"===this.mouseNode.type?"group"===a.type?console.log("not allow move group to closed group, revert"):"open"===this.mouseNode.status?console.log("please put widget into the opened group panel"):!1===a.setting.inPanel?this._showOffPanelToGroupError():a.gnode&&a.gnode===
this.mouseNode?console.log("the moving widget is already in the group"):this.mouseNode.setting.maxWidgets&&this.mouseNode.setting.widgets&&this.mouseNode.setting.widgets.length+1>this.mouseNode.setting.maxWidgets?this._showGroupExceedMaxError(this.mouseNode.setting):(this.moveWidgetToGroup(a,this.mouseNode),"groupOnScreen"===this.name&&(c.push(a.gnode.setting),c.push(this.mouseNode.setting)),b=!0):"widget"===this.mouseNode.type&&("group"===a.type?console.log("not allow move group to widget, revert"):
!1===a.setting.inPanel||!1===this.mouseNode.setting.inPanel?this._showOffPanelToGroupError():a.gnode||this.mouseNode.gnode?console.log("can not nest group"):(this.moveWidgetToWidget(a,this.mouseNode),b=!0)),this._reopenGroup());this.destroyShadowNode();b&&("poolWidgets"===this.name?this.publishPoolChangeEvent():0<c.length&&this.publishOnScreenGroupsChangeEvent());this.placeNodes()},_reopenGroup:function(){if(this.openedGNode){var a=this.openedGNode;this.closeGroup(a);this.nodeList.isExist(a)&&this.openGroup(a)}},
getNodePosition:function(a){var b={},c;c=Math.ceil(a/w);a%=w;0===a&&(a=w);b.t=118*(c-1);var e=94*(a-1)+20;b.l=window.isRTL?this.box.w-e-74:e;b.w=74;b.h=118;b.r=c;b.c=a;return b},getMarginNodePosition:function(a){var b={};a=a.pos;b.l=window.isRTL?a.l+74+10:a.l-10-2.5;b.t=a.t;b.w=5;b.h=118;return b},createMarginNode:function(a){var b=new C({label:a.label,node:a});t.place(b.domNode,this.domNode);return a.margin=b},getMousePosition:function(a){return{x:a.pageX-this.position.x,y:a.pageY-this.position.y}},
moveNodeToMargin:function(a,b){b=this.getNodeByMarginNode(b);console.log("moveNodeToMargin");k(".node-margin-active",this.domNode).removeClass("node-margin-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},moveNodeToEmpty:function(a,b){k(".empty-node-active",this.domNode).removeClass("empty-node-active");b.gnode&&!a.gnode?a.gnode=b.gnode:!b.gnode&&a.gnode&&(a.gnode=null);this.nodeList.moveNode(a,b)},getNodeByMarginNode:function(a){var b;this.nodeList.visitNodes(function(c){c.margin===
a&&(b=c)});return b},placeNodes:function(){var a,b;this.nodeList.visitNodes(g.hitch(this,function(c,e){a=this.getNodePosition(e);c.pos=a;t.setStyle(c.domNode,x(a));b=this.getMarginNodePosition(c);c.margin.pos=b;t.setStyle(c.margin.domNode,x(b))}));this.nodeList.printNodeList()},moveWidgetToGroup:function(a,b){a&&a.setting&&delete a.setting.openAtStart;b.addWidget(a);this.nodeList.removeNode(a)},moveWidgetToWidget:function(a,b){var c;a&&a.setting&&delete a.setting.openAtStart;c=this.createMoveableNode("group",
{label:this._getGroupLabel(),widgets:[a.setting,b.setting]});this.nodeList.insertNode(c,b);this.nodeList.removeNode(a);this.nodeList.removeNode(b)},createShadowNode:function(a){this.shadowNode=t.create("div",{"class":"node-shadow",style:x(t.getMarginBox(a.domNode))},this.domNode)},destroyShadowNode:function(){this.shadowNode&&t.destroy(this.shadowNode)},getNodeByMousePosition:function(a,b){var c;this.nodeList.visitNodes(function(e){if("addBtn"!==e.type){if(b.x>e.pos.l+10&&b.x<e.pos.l+e.pos.w-10&&
b.y>e.pos.t+10&&b.y<e.pos.t+e.pos.h-10&&e!==a)return c=e,!0;if(b.x>e.margin.pos.l&&b.x<e.margin.pos.l+e.margin.pos.w&&b.y>e.margin.pos.t&&b.y<e.margin.pos.t+e.margin.pos.h&&e.margin!==a)return c=e.margin,!0}});return c},_getGroupLabel:function(){var a=-1;this.appConfig.visitElement(g.hitch(this,function(b){if(b.widgets)if(b.label===this.nls.newGroup)a=0;else if(b.label.startWith(this.nls.newGroup)){var c=b.label.lastIndexOf("_");-1<c&&(b=parseInt(b.label.substr(c+1,b.label.length),10),a=Math.max(a,
b))}}));return-1===a?this.nls.newGroup:this.nls.newGroup+"_"+(a+1)},_showOffPanelToGroupError:function(){console.log("Off panel widget is not allowed in group.");this.emit("offpanel-group-error")},_showGroupExceedMaxError:function(a){this.emit("group-exceed-max-error",a)},_onWidgetChoosePageOk:function(a,b){if(b.listName===this.name)if(1===a.length){var c;"addBtn"===b.type?c=a[0]:"group"===b.type?c=a[0]:(c=g.clone(b.setting),g.mixin(c,a[0]));n.publish("editWidget",c,b)}else"poolWidgets"===this.name?
(v.forEach(a,function(a){this.addWidget(a)},this),this.publishPoolChangeEvent()):("addBtn"===b.type?c=g.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=g.clone(this.appConfig.getConfigElementById(b.setting.id))),c.widgets=c.widgets.concat(a),n.publish("groupChanged",c))},_onWidgetSettingPageOk:function(a,b){if(b.listName===this.name)if(a.id)n.publish("widgetChanged",a);else if("poolWidgets"===this.name)this.addWidget(a),this.publishPoolChangeEvent();else{var c;
"addBtn"===b.type?c=g.clone(this.appConfig.getConfigElementById(b.gnode.setting.id)):"group"===b.type&&(c=g.clone(this.appConfig.getConfigElementById(b.setting.id)));c.widgets.push(a);c.label||(c.label=this._getGroupLabel());n.publish("groupChanged",c)}},publishPoolChangeEvent:function(){var a=[],b=[];this.nodeList.visitNodes(function(c,e){"widget"!==c.type||c.gnode?"group"===c.type&&(c.setting.index=e,a.push(c.setting)):(c.setting.index=e,b.push(c.setting))});n.publish("widgetPoolChanged",{widgets:b,
groups:a,controllerId:this.controller.id})},publishOnScreenGroupsChangeEvent:function(){var a=[];this.nodeList.visitNodes(function(b){"group"===b.type&&a.push(b.setting)});n.publish("onScreenGroupsChanged",{groups:a})}})})},"builder/plugins/widget-config/MoveableNode":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/Evented dojo/aspect dojo/mouse dojo/touch dojo/topic dojo/query ./Mover dojo/dnd/move dijit/_WidgetBase jimu/dijit/Message jimu/utils dojo/NodeList-dom dojo/NodeList-manipulate".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q){var C="click",z=k.enter,E=k.leave;"ontouchstart"in document&&(C=f.press,z=f.enter,E=f.leave);return p([x,m],{type:"",label:"",isMoving:!1,isMouseDown:!1,postCreate:function(){this.inherited(arguments);if("addBtn"===this.type)this.label="addBtn",this.createAddBtn();else if("empty"===this.type)this.label="empty",this.createEmptyNode();else if("widget"===this.type){if(this.createWidgetNode(),"poolWidgets"===this.listName||"groupOnScreen"===this.listName)this.dnd=
new c.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:a}),this.bindMoveEvent()}else"placeholder"===this.type?this.createPlaceholderNode():(this.createGroupNode(),"poolWidgets"===this.listName&&(this.dnd=new c.boxConstrainedMoveable(this.domNode,{handle:this.boxNode,box:this.parentBox,within:!0,delay:5,mover:a}),this.bindMoveEvent()));g.addClass(this.domNode,"moveable");g.setStyle(this.domNode,{width:this.w+"px",height:this.h+"px"})},bindMoveEvent:function(){u.after(this.dnd,
"onMoveStart",t.hitch(this,function(){this.isMoving=!0}),!0);u.after(this.dnd,"onMoveStop",t.hitch(this,function(){this.isMoving=!1}),!0)},_createWidgetIconNode:function(){var a=q.processUrlInAppConfig(this.setting.icon);this.iconNode=g.create("img",{"class":"icon",src:a,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);window.isRTL&&this.setting.mirrorIconForRTL&&g.addClass(this.iconNode,"jimu-flipx")},_createPlaceholderNode:function(){this.placeholderNode=g.create("div",
{"class":"placeholder",style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);g.create("div",{"class":"placeholder-inner",innerHTML:this.setting.placeholderIndex,style:{width:"16px",height:"16px",lineHeight:"16px",borderRadius:"8px",margin:"7px"}},this.placeholderNode)},createWidgetNode:function(){g.addClass(this.domNode,"widget-node");g.setAttr(this.domNode,"data-widget-name",this.setting.name);this.boxNode=g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+
"px"}},this.domNode);this._createWidgetIconNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=g.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),title:this.label},this.domNode);!1===this.setting.visible&&g.addClass(this.domNode,"hide");this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,C,t.hitch(this,function(a){a.stopPropagation();
this.emit("clickOpenAtStart")}))));this.own(n(this.boxNode,z,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode();this.own(n(this.editNode,C,t.hitch(this,function(a){a.stopPropagation();e.publish("editWidget",this.setting,this)})));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,C,t.hitch(this,function(a){a.stopPropagation();
this.emit("clickOpenAtStart")}))));!1===this.setting.inPanel&&this.setting.isOnScreen&&"undefined"===typeof this.setting.closeable?(this.switchNode=this._createSwitchNode(),this.own(n(this.switchNode,C,t.hitch(this,function(a){a.stopPropagation();a=t.clone(this.setting);!1===a.visible?(a.visible=!0,g.removeClass(this.domNode,"hide")):(a.visible=!1,g.addClass(this.domNode,"hide"));e.publish("widgetChanged",a)})))):(this.dropNode=this._createDropNode(),this.own(n(this.dropNode,C,t.hitch(this,function(a){a.stopPropagation();
var b;b=this._checkDataSource(this.setting.id)?new w({message:this.nls.dataSourceIsUsed,buttons:[{label:this.nls.ok,onClick:t.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]}):new w({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:t.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]})}))))})));this.own(n(this.boxNode,E,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});
this.editNode&&g.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&g.destroy(this.openAtStartNode);this.dropNode&&g.destroy(this.dropNode);this.switchNode&&g.destroy(this.switchNode)})))},createPlaceholderNode:function(){g.addClass(this.domNode,"widget-node");g.addClass(this.domNode,"placeholder");g.setAttr(this.domNode,"data-placeholder-index",this.setting.placeholderIndex);this.boxNode=g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);
this._createPlaceholderNode();this.label=this.setting.label?this.setting.label:this.nls.defaultWidgetLabel;this.name=this.setting.name?this.setting.name:this.nls.defaultWidgetLabel;this.labelNode=g.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),title:this.label},this.domNode);this.own(n(this.boxNode,z,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"})})));this.own(n(this.boxNode,E,t.hitch(this,function(){e.publish("actionTriggered",
{elementId:this.setting.id,action:"removeHighLight"})})));this.own(n(this.domNode,C,t.hitch(this,function(){e.publish("chooseWidget",this,this.listName)})))},createGroupNode:function(){"poolWidgets"===this.listName?this._createPoolGroupNode():this._createOnScreenGroupNode()},_createOnScreenGroupNode:function(){g.addClass(this.domNode,"group-node");this.boxNode=g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);if(0===this.setting.widgets.length)g.addClass(this.domNode,
"placeholder"),this._createPlaceholderNode(),this.name=this.label=this.nls.defaultWidgetLabel;else if(1===this.setting.widgets.length){var a=this.setting.widgets[0],b=q.processUrlInAppConfig(a.icon);this.iconNode=g.create("img",{"class":"icon",src:b,style:{width:"32px",height:"32px",margin:(this.w-32)/2+"px"}},this.boxNode);window.isRTL&&a.mirrorIconForRTL&&g.addClass(this.iconNode,"jimu-flipx");this.label=a.label;this.name=a.name}else this._createSmallWidgets(),this.label=this.setting.label?this.setting.label:
"Group",this.name=this.setting.name?this.setting.name:"Group";this.labelNode=g.create("div",{"class":"label",innerHTML:q.stripHTML(this.label),title:this.label},this.domNode);this.own(n(this.boxNode,z,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});if(0!==this.setting.widgets.length){if("undefined"===typeof this.setting.maxWidgets||this.setting.widgets.length<this.setting.maxWidgets)this.addNode=this._createAddNode(),this.own(n(this.addNode,C,t.hitch(this,
function(a){e.publish("chooseWidget",this,this.listName);a.stopPropagation()}))),this.own(n(this.addNode,"mousedown",function(a){a.stopPropagation()})),this.own(n(this.addNode,"mouseup",function(a){a.stopPropagation()}));1===this.setting.widgets.length&&(this.editNode=this._createEditNode(),this.own(n(this.editNode,C,t.hitch(this,function(a){a.stopPropagation();e.publish("editWidget",this.setting.widgets[0],this)}))),this.dropNode=this._createDropNode(),this.own(n(this.dropNode,C,t.hitch(this,function(a){var b=
new w({message:this.nls.dropWidgetMessage,buttons:[{label:this.nls.ok,onClick:t.hitch(this,function(){this.setting.widgets=[];e.publish("groupChanged",this.setting);b.close()})},{label:this.nls.cancel}]});a.stopPropagation()}))))}})));this.own(n(this.boxNode,E,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"removeHighLight"});this.addNode&&g.destroy(this.addNode);this.editNode&&g.destroy(this.editNode);this.dropNode&&g.destroy(this.dropNode)})));this.own(n(this.boxNode,
C,t.hitch(this,function(){if(0===this.setting.widgets.length)e.publish("chooseWidget",this,this.listName);else if(1!==this.setting.maxWidgets||1!==this.setting.widgets.length)"open"===this.status?this.closeGroup():this.openGroup()})))},_createPoolGroupNode:function(){g.addClass(this.domNode,"group-node");this.boxNode=g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode);this.label=this.setting.label?this.setting.label:"Group";this.name=this.setting.name?this.setting.name:
"Group";this.labelNode=g.create("div",{"class":"label",innerHTML:q.stripHTML(this.setting.label),title:this.setting.label},this.domNode);this._createSmallWidgets();this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,C,t.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));this.own(n(this.boxNode,z,t.hitch(this,function(){e.publish("actionTriggered",{elementId:this.setting.id,action:"highLight"});this.editNode=this._createEditNode({isGroupNode:!0});
this.own(n(this.editNode,C,t.hitch(this,function(a){a.stopPropagation();this.setting.groupPopupTitle=this.nls.configLabel;e.publish("editGroup",this,this.setting)})));this.own(n(this.editNode,"mousedown",function(a){a.stopPropagation()}));this.own(n(this.editNode,"mouseup",function(a){a.stopPropagation()}));this.supportOpenAtStart()&&!this.setting.openAtStart&&(this.openAtStartNode=this._createOpenAtStartNode(),this.own(n(this.openAtStartNode,C,t.hitch(this,function(a){a.stopPropagation();this.emit("clickOpenAtStart")}))));
this.dropNode=this._createDropNode();this.own(n(this.dropNode,C,t.hitch(this,function(a){var b=new w({message:this.nls.dropGroupMessage,buttons:[{label:this.nls.ok,onClick:t.hitch(this,function(){this.emit("removeNode");b.close()})},{label:this.nls.cancel}]});a.stopPropagation()})));this.own(n(this.dropNode,"mousedown",function(a){a.stopPropagation()}));this.own(n(this.dropNode,"mouseup",function(a){a.stopPropagation()}))})));this.own(n(this.boxNode,E,t.hitch(this,function(){e.publish("actionTriggered",
{elementId:this.setting.id,action:"removeHighLight"});this.editNode&&g.destroy(this.editNode);this.openAtStartNode&&!this.setting.openAtStart&&g.destroy(this.openAtStartNode);this.dropNode&&g.destroy(this.dropNode)})));this.own(n(this.boxNode,C,t.hitch(this,function(a){a.preventDefault();a.stopPropagation();"open"===this.status?this.closeGroup():this.openGroup()})))},closeGroup:function(){this.status="close"},openGroup:function(){this.status="open"},createAddBtn:function(){g.addClass(this.domNode,
"add-widget-node");var a=g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"},title:this.nls.addWidget},this.domNode);g.create("img",{src:this.folderUrl+"css/images/add_widget.png"},a);this.own(n(this.domNode,C,t.hitch(this,function(){e.publish("chooseWidget",this,this.listName)})))},createEmptyNode:function(){g.addClass(this.domNode,"empty-node");g.create("div",{"class":"box",style:{width:this.w+"px",height:this.w+"px"}},this.domNode)},_createEditNode:function(a){var b={bottom:"0",
width:"20px",height:"20px"};b[window.isRTL?"left":"right"]="0";var c=this.nls.configureWidget;a&&a.isGroupNode&&(c=this.nls.configLabel);return g.create("div",{"class":"edit-btn",style:b,title:c},this.boxNode)},supportOpenAtStart:function(){var a=this.setting;return"group"===this.type?"poolWidgets"===this.listName?!0:!1:!a.isController&&!a.isThemeWidget&&a.visible&&(a.isOnScreen&&(a.closeable||a.inPanel&&!this.gnode)||!a.isOnScreen&&!this.gnode)},_createOpenAtStartNode:function(){var a={bottom:"4px",
width:"12px",height:"12px"};a[window.isRTL?"right":"left"]="4px";return g.create("div",{"class":this.setting.openAtStart?"open-at-start-btn active":"open-at-start-btn deactive",style:a,title:this.setting.openAtStart?this.nls.activeOpenAtStart:this.nls.deactiveOpenAtStart},this.boxNode)},_createDropNode:function(){var a={top:"0",width:"20px",height:"20px"};a[window.isRTL?"left":"right"]="0";return g.create("div",{"class":"drop-btn",style:a,title:this.nls.removeWidget},this.boxNode)},_createAddNode:function(){var a=
{top:"0",width:"20px",height:"20px"};a[window.isRTL?"right":"left"]="0";return g.create("div",{"class":"small-add-btn",style:a,title:this.nls.addWidget},this.boxNode)},_createSwitchNode:function(){var a=g.hasClass(this.domNode,"hide")?this.nls.showWidget:this.nls.hideWidget,b={top:"3px",width:"15px",height:"10px"};b[window.isRTL?"left":"right"]="3px";return g.create("div",{"class":"switch-btn",style:b,title:a},this.boxNode)},_createSmallWidgets:function(){b(".small",this.boxNode).remove();var a=[],
c=!1;4<this.setting.widgets.length?(a=this.setting.widgets.slice(0,3),c=!0):(a=this.setting.widgets,c=!1);a.forEach(t.hitch(this,function(a){this._createSmallWidget(a)}));c&&this._createSmallMore()},_createSmallWidget:function(a){var b;b=g.create("div",{"class":"small small-widget","data-wid":a.id,style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);var c=a.icon;if(a.icon.startWith("widgets")||a.icon.startWith("configs")||a.icon.startWith("themes"))c=
require(q.getRequireConfig()).toUrl(a.icon);c=g.create("img",{src:c,style:{width:"20px",height:"20px"}},b);window.isRTL&&a.mirrorIconForRTL&&g.addClass(c,"jimu-flipx");return b},_createSmallMore:function(){var a;a=g.create("div",{"class":"small small-more",style:{width:"20px",height:"20px",marginLeft:(this.w-40)/3+"px",marginTop:(this.w-40)/3+"px"}},this.boxNode);g.create("img",{src:"builder/images/more_widget.png",style:{width:"20px"}},a);return a},addWidget:function(a){"group"!==this.type?console.log("can not add widget to widget"):
(this.setting.widgets.push(a.setting),this._createSmallWidgets())},updateSmallWidgets:function(){this._createSmallWidgets()},destroy:function(){this.margin&&this.margin.destroy();this.inherited(arguments)},_checkDataSource:function(a){return this.appConfig.dataSource?v.some(Object.keys(this.appConfig.dataSource.dataSources),function(b){if(b.startWith("widget~"+a+"~")){var c=!1;this.appConfig.visitElement(function(e){if(e.id!==a&&e.config&&"object"===typeof e.config&&-1<JSON.stringify(e.config).indexOf(b))return c=
!0});return c}},this):!1}})})},"builder/plugins/widget-config/Mover":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/sniff dojo/_base/window dojo/dom dojo/dom-geometry dojo/dom-style dojo/Evented dojo/on dojo/touch dojo/dnd/common dojo/dnd/autoscroll".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){v.add("ie11",function(){var a=-1,b="",c=null;"Microsoft Internet Explorer"===navigator.appName?(b=navigator.userAgent,c=/MSIE ([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1))):
"Netscape"===navigator.appName&&(b=navigator.userAgent,c=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/,null!==c.exec(b)&&(a=parseFloat(RegExp.$1)));return a});return g("dojo.dnd.Mover",[f],{constructor:function(a,f,g){function k(a){a.preventDefault();a.stopPropagation()}this.node=m.byId(a);this.marginBox={l:f.pageX,t:f.pageY};this.mouseButton=f.button;f=this.host=g;a=a.ownerDocument;this.events=[e(a,b.move,t.hitch(this,"onFirstMove")),e(a,b.move,t.hitch(this,"onMouseMove")),e(a,b.release,t.hitch(this,"onMouseUp")),
e(a,"dragstart",k),e(a.body,"selectstart",k)];c.autoScrollStart(a);if(f&&f.onMoveStart)f.onMoveStart(this)},onMouseMove:function(a){c.autoScroll(a);var b=this.marginBox;this.host.onMove(this,{l:b.l+a.pageX,t:b.t+a.pageY},a);a.preventDefault();a.stopPropagation()},onMouseUp:function(a){var b=v("webkit")&&v("mac")&&2===this.mouseButton,c=(v("ie")||v("ie11"))&&-1===this.mouseButton;(b||c?0===a.button:this.mouseButton===a.button)&&this.destroy();a.preventDefault();a.stopPropagation()},onFirstMove:function(a){var b=
this.node.style,c,e=this.host;switch(b.position){case "relative":case "absolute":c=Math.round(parseFloat(b.left))||0;b=Math.round(parseFloat(b.top))||0;break;default:b.position="absolute";b=u.getMarginBox(this.node);c=n.doc.body;var f=k.getComputedStyle(c),g=u.getMarginBox(c,f),f=u.getContentBox(c,f);c=b.l-(f.l-g.l);b=b.t-(f.t-g.t)}this.marginBox.l=c-this.marginBox.l;this.marginBox.t=b-this.marginBox.t;if(e&&e.onFirstMove)e.onFirstMove(this,a);this.events.shift().remove()},destroy:function(){p.forEach(this.events,
function(a){a.remove()});var a=this.host;if(a&&a.onMoveStop)a.onMoveStop(this);this.events=this.node=this.host=null}})})},"builder/plugins/widget-config/LinkList":function(){define(["dojo/_base/declare","dojo/_base/html","dojo/_base/array"],function(p){return p(null,{headNode:null,currentNode:null,constructor:function(g){this.name=g.name},visitNodes:function(g){for(var p=this.headNode,v=1;p;)g(p,v),v++,p=p.next},destroyAllNodes:function(){for(var g=this.headNode,p;g;)p=g.next,g.destroy(),g=null,g=
p;this.headNode=null},getCount:function(){var g=0;this.visitNodes(function(p,v){g=v});return g},isExist:function(g){var p=!1;this.visitNodes(function(t){t===g&&(p=!0)});return p},printNodeList:function(){this.visitNodes(function(g){})},getPreNode:function(g){var p;this.visitNodes(function(t){t.next===g&&(p=t)});return p},getNodeByIndex:function(g){var p;this.visitNodes(function(t,n){n===g&&(p=t)});return p},getNodeByLabel:function(g){var p;this.visitNodes(function(t){t.label===g&&(p=t)});return p},
getNodeIndex:function(g){var p;this.visitNodes(function(t,n){t===g&&(p=n)});return p},removeNode:function(g){var p;(p=this.getPreNode(g))?p.next=g.next:this.headNode=g.next;g.destroy()},removeNodeByIndex:function(g){this.removeNode(this.getNodeByIndex(g))},insertNode:function(g,p){var t;p="number"===typeof p?this.getNodeByIndex(p):p;(t=this.getPreNode(p))?t.next=g:this.headNode=g;g.next=p},moveNode:function(g,p){var t=this.getPreNode(g),n=this.getPreNode(p);g!==p&&g!==n&&(t?t.next=g.next:this.headNode=
g.next,g.next=p,n?n.next=g:this.headNode=g)}})})},"builder/plugins/widget-config/WidgetSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/config dojo/Deferred dojo/request dojo/topic dojo/aspect dojo/on dojo/mouse dojo/query dojo/string dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./WidgetSettingPage.html ./WidgetDefaultSettingPage jimu/utils jimu/WidgetManager jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/ImageChooser jimu/dijit/LoadingIndicator jimu/dijit/Message dijit/form/CheckBox esri/request".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I,K,J,L,M,Q){var S="en de es fr ja ru zh-cn zh-tw zh-hk ar it ko pl pt-br pt-pt ro".split(" "),T=[],O=null;return p([w,q,C],{templateString:z,startup:function(){this.inherited(arguments);this.own(u("builder/widgethelp.json",{handleAs:"json"}).then(function(a){O=a},function(a){console.error(a)}).always(g.hitch(this,function(){this.domNode&&(this.own(e(window,"resize",g.hitch(this,this.resize))),this.init())})))},init:function(){this.loading=new J;
t.addClass(this.loading.domNode,"load-widget-setting");this.loading.placeAt(this.widgetSettingNode);this.initCommonAttr();this.initWidgetAttr();this.resize()},resize:function(){var a=t.getContentBox(this.domNode);t.setStyle(this.widgetSettingNode,{height:a.h-94+"px"})},onCancel:function(){this.onClose();this.popup.close()},onOk:function(){var a=this._checkLabelExist();if(a)return new L({message:a}),!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=
B.sanitizeHTML(this.labelNode.get("value"));if(this.settingDijit){var b=this.settingDijit.getConfig(!0);if(!1===b)return!1;b&&"function"===typeof b.then?b.then(g.hitch(this,function(a){if(!1===a)return!1;var b=this.settingDijit.getDataSources();b&&"function"===typeof b.then?b.then(g.hitch(this,function(b){this.setting.config=a;this.setting.provideDataSources=b;this._closeSettingPopup()})):(this.setting.config=a,this.setting.provideDataSources=b,this._closeSettingPopup())})):(a=this.settingDijit.getDataSources())&&
"function"===typeof a.then?a.then(g.hitch(this,function(a){this.setting.config=b;this.setting.provideDataSources=a;this._closeSettingPopup()})):(this.setting.config=b,this.setting.provideDataSources=a,this._closeSettingPopup())}else this._closeSettingPopup()},_closeSettingPopup:function(){delete this.setting.isDefaultConfig;k.publish("widgetSettingPageOk",this.setting,this.fromNode);this.onClose();this.popup.close()},_checkLabelExist:function(){var a=0,b=this.labelNode.get("value");if(""===c.trim(b))return this.nls.labelRequired;
var e=B.getControllerWidgets(this.appConfig);this.appConfig.visitElement(g.hitch(this,function(c){this.setting.id!==c.id&&c.label===b&&(0<e.length?a++:c.isOnScreen&&a++)}));return 0<a?this.nls.labelExists:""},onClose:function(){this.popup&&this.popup.closeBtnNode&&this.popup.closeBtnNode.focus();this.settingViewStack?(this.settingDijitUI.destroy(),this.settingDijitJSON.destroy(),this.settingViewStack.destroy()):this.settingDijit&&this.settingDijit.destroy()},_getHelpLink:function(a,b){var c=new m,
e=null;a=a.toLowerCase();b="html"===(b||"html").toLowerCase()?"widgets2d":"widgets3d";if(window.isXT)u("/webappbuilder/help/exists",{handleAs:"json"}).then(g.hitch(this,function(d){d&&d.exists?u("/webappbuilder/help/cxhelp.js",{handleAs:"json"}).then(g.hitch(this,function(d){var f="#";e=g.getObject("dev."+b+"."+a,!1,O);d&&d.m&&e&&d.m[e]?f="/webappbuilder/help/"+d.m[e]:e&&(f="/webappbuilder/help/"+e);c.resolve(f)}),g.hitch(this,function(a){console.warn(a);c.resolve("#")})):c.resolve("#")}),function(a){console.error(a);
c.resolve("#")});else{var f=F.getPortalUrlFromLocation();if(-1<f.indexOf("arcgis.com")){var k="#",e=g.getObject("online."+b+"."+a,!1,O);"widgets3d"===b||n.locale.toLowerCase().startWith("en")||-1<T.indexOf(a)||-1===S.indexOf(n.locale.toLowerCase())?(e&&(k="http://"+(-1<f.indexOf("maps.arcgis.com")?"doc":"docdev")+".arcgis.com/en/web-appbuilder/create-apps/"+e),c.resolve(k)):(k={url:F.getPortalSelfInfoUrl(f),content:{f:"json",culture:n.locale},handleAs:"json",callbackParamName:"callback",preventCache:!0},
Q(k).then(g.hitch(this,function(a){var b="#";if(a&&a.helpBase&&e)try{b=a.helpBase.split("/").slice(0,4).join("/")+"/web-appbuilder/create-apps/"+e}catch(r){b="http://doc.arcgis.com/en/web-appbuilder/create-apps/"+e}c.resolve(b)}),g.hitch(this,function(a){console.warn(a);c.resolve("#")})))}else{var l=n.locale||"en",e=g.getObject("portal."+b+"."+a,!1,O);u(f+"sharing/rest/portals/helpmap?f\x3djson",{handleAs:"json"}).then(g.hitch(this,function(a){var b="#";a&&a.helpMap&&a.helpMap.m&&e&&a.helpMap.m[e]&&
(b=f+"portalhelp/"+l+"/"+a.helpMap.m[e]);c.resolve(b)}),g.hitch(this,function(a){console.warn(a);c.resolve("#")}))}}return c},initCommonAttr:function(){var a=B.processUrlInAppConfig(this.setting.icon);t.setAttr(this.iconNode,"src",a);window.isRTL&&this.setting.mirrorIconForRTL&&t.addClass(this.iconNode,"jimu-flipx");this.labelNode.set("value",this.setting.label);this._getHelpLink(this.setting.name,g.getObject("manifest.platform",!1,this.setting)).then(g.hitch(this,function(a){"#"!==a&&(t.setStyle(this.helpNode,
"display","inline-block"),t.setAttr(this.helpNode,"href",a))}));this.imageChooser=new K({goldenWidth:24,goldenHeight:24,format:[K.GIF,K.JPEG,K.PNG],label:this.nls.changeIcon},this.imageChooserPlaceholder);t.addClass(this.imageChooser.domNode,"jimu-float-leading");!1===this.setting.inPanel&&!0===this.setting.isOnScreen&&!0!==this.setting.closeable?(this.imageChooser.disableChooseImage(),t.setAttr(this.imageChooser.domNode,"title",this.nls.unableChangeIcon)):(this.imageChooser.enableChooseImage(),this.own(e(this.imageChooser,
"imageChange",g.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a}))))},initWidgetAttr:function(){!1===this.setting.hasConfig?this.widgetSettingNode.innerHTML='\x3cdiv class\x3d"noconfig-info"\x3e'+this.nls.noConfig+"\x3c/div\x3e":G.getInstance().tryLoadWidgetConfig(this.setting).then(g.hitch(this,function(a){this.setting.hasSettingPage?G.getInstance().loadWidgetSettingPage(this.setting).then(g.hitch(this,function(a){this.widgetSettingNode?(this.settingDijit=a,this.settingDijit.settingPagePopup=
this.popup,t.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.startup(),this.loading.destroy(),t.setAttr(this.widgetSettingNode,"data-widget-loaded","true")):a.destroy()})):this.widgetSettingNode&&(this.settingDijit=new E({config:this.setting.config}),t.place(this.settingDijit.domNode,this.widgetSettingNode),this.settingDijit.settingPagePopup=this.popup,this.settingDijit.startup(),this.loading.destroy())}))},setAppConfig:function(a){this.appConfig=a}})})},"builder/plugins/widget-config/WidgetDefaultSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dijit/_WidgetBase ./JSONEditor".split(" "),
function(p,g,t,v,n,m){return p([n],{baseClass:"widget-default-setting",postCreate:function(){this.inherited(arguments);this.jsonEditor=new m({json:this.config});this.jsonEditor.init();this.jsonEditor.placeAt(this.domNode);this.own(t(this.domNode,"keydown",g.hitch(this,"_onEnterPress")))},_onEnterPress:function(g){(void 0!==g.keyCode?g.keyCode:g.which)===v.ENTER&&g.stopPropagation()},getDataSources:function(){return[]},setConfig:function(g){return this.jsonEditor.setJSON(g)},getConfig:function(){return this.jsonEditor.getJSON()}})})},
"builder/plugins/widget-config/JSONEditor":function(){define(["dojo/_base/declare","dojo/_base/lang","dijit/_WidgetBase"],function(p,g,t){return p([t],{baseClass:"json-editor",postCreate:function(){this.inherited(arguments)},init:function(){require(["builder/libs/ace/ace.js"],g.hitch(this,function(){this.editor=ace.edit(this.domNode);this.editor.setTheme("ace/theme/textmate");this.editor.setHighlightActiveLine(!0);this.editor.setValue(JSON.stringify(this.json,null,2));this.editor.getSession().setMode("ace/mode/json")}))},
setJSON:function(g){this.json=g;this.editor.setValue(JSON.stringify(this.json,null,2))},getJSON:function(){return JSON.parse(this.editor.getValue())}})})},"builder/plugins/widget-config/GroupSettingPage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/topic jimu/utils dojo/string dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/ImageChooser dojo/text!./GroupSettingPage.html".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a){return p([k,
f,e],{templateString:a,baseClass:"group-setting-page",startup:function(){this.initCommonAttr()},initCommonAttr:function(){var a=m.processUrlInAppConfig(this.setting.icon);t.setAttr(this.iconNode,"src",a);this.labelNode.set("value",this.setting.label);this.imageChooser=new b({goldenWidth:24,goldenHeight:24,format:[b.GIF,b.JPEG,b.PNG],label:this.nls.changeGroupIcon},this.imageChooserPlaceholder);t.addClass(this.imageChooser.domNode,"jimu-float-leading");this.imageChooser.enableChooseImage();this.own(v(this.imageChooser,
"imageChange",g.hitch(this,function(a){this.iconNode.src=a;this.setting.icon=a})))},_checkLabelExist:function(){var a=this.labelNode.get("value");return""===u.trim(a)?this.nls.labelRequired:""},onOk:function(){if(this._checkLabelExist())return!1;this.imageChooser.imageData&&(this.setting.icon=this.imageChooser.imageData);this.setting.label=m.stripHTML(this.labelNode.get("value"));n.publish("groupChanged",this.setting);this.popup.close()},onCancel:function(){}})})},"builder/plugins/widget-config/WidgetChoosePage":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/topic dojo/on dojo/Deferred dojo/promise/all dojo/query dojo/NodeList-dom dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./WidgetChoosePage.html jimu/dijit/Search jimu/WidgetManager jimu/dijit/LoadingShelter jimu/dijit/Message jimu/dijit/TabContainer3 jimu/utils jimu/portalUtils jimu/portalUrlUtils builder/serviceUtils esri/lang ./CustomWidgets".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D,I){return p([b,a],{templateString:c,showCustomWidgets:!1,postMixInProperties:function(){this.widgetManager=w.getInstance()},startup:function(){this.inherited(arguments);G.isOnline(window.portalUrl)?this.showCustomWidgets=!1:this.showCustomWidgets=window.appInfo.isRunInPortal?window.queryObject.hideCustomWidgets?!1:!0:!1;this.showCustomWidgets||t.addClass(this.domNode,"hide-custom-widgets");this.tab=new z({tabs:[{title:this.nls.officialWidgets,
content:this.officialSection},{title:this.nls.customWidgets,content:this.customSection}]});this.tab.placeAt(this.domNode);this.searchDijit1=new x({placeholder:this.nls.widgetSearchHint,onSearch:g.hitch(this,this._onFilterDefaultWidget),searchWhenInput:!0},this.searchInputNode);this._getWidgets();this.own(m(window,"resize",g.hitch(this,this.resize)));setTimeout(g.hitch(this,function(){this.resize()}),100);this.loading=new q({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup();setTimeout(g.hitch(this,
function(){this.searchDijit1.inputSearch.focus()}),60);this.showCustomWidgets&&(this.searchDijit2=new x({placeholder:this.nls.widgetSearchHint,onChange:g.hitch(this,this._onFilterCustomWidget),onSearch:g.hitch(this,this._onSearchCustomWidget),searchWhenInput:!1},this.customSearchInputNode),this.allCustomWidgets=new I({portalUrl:window.portalUrl,fromNode:this.fromNode,widgetDomNode:this.domNode}),this.allCustomWidgets.placeAt(this.customSection),this.filterCustomWidgets=new I({portalUrl:window.portalUrl,
hidden:!0,fromNode:this.fromNode,widgetDomNode:this.domNode}),this.filterCustomWidgets.placeAt(this.customSection),this.own(m(this.tab,"tabChanged",g.hitch(this,function(a){a===this.nls.customWidgets?(this.searchDijit2.inputSearch.focus(),this.allCustomWidgets.queried||(this.allCustomWidgets.queried=!0,this.allCustomWidgets.queryItems())):this.searchDijit1.inputSearch.focus()}))))},_onFilterCustomWidget:function(a){this.allCustomWidgets.show();this.filterCustomWidgets.hide();a?this.allCustomWidgets.filterLocally(function(b){return b.title&&
0<=b.title.toUpperCase().indexOf(a.toUpperCase())}):this.allCustomWidgets.filterLocally(function(){return!0})},_onSearchCustomWidget:function(a){a?(this.allCustomWidgets.hide(),this.filterCustomWidgets.show(),this.filterCustomWidgets.queryItems({q:'title:"'+a+'"'})):(this.allCustomWidgets.show(),this.filterCustomWidgets.hide())},_onFilterDefaultWidget:function(a){var b;b=""===a?this.allWidgets:v.filter(this.allWidgets,function(b){if(-1<b.label.toUpperCase().indexOf(a.toUpperCase()))return!0});this._createWidgetNodes(b)},
resize:function(){var a=f(".widget-choose-page").closest(".jimu-popup .content.content-absolute");t.setStyle(a[0],{overflowY:"hidden"});var a=t.getContentBox(this.domNode).h,b=f("\x3e div",this.tab.domNode),c=f("div.official-section",this.tab.domNode)[0].parentNode,c=b.indexOf(c),e=0,g=0;b.slice(0,c).forEach(function(a){e+=t.getContentBox(a).h});g=a-60-e;t.setStyle(this.searchSectionNode,{height:a+"px"});t.setStyle(this.widgetListNode,{height:g+"px"})},setAppConfig:function(a){this.appConfig=a},_getWidgets:function(){var a=
{};this.appConfig.map["2D"]&&(a.support2D=!0);this.appConfig.map["3D"]&&(a.support3D=!0);this.appConfig.map["2D"]&&this.appConfig.map["3D"]&&(a.support2D=!0,a.support3D=!0);a.platform=window.stemappInfo.appType;this.options.includeOffPanel||(a["properties.inPanel"]=!0);F.searchWidgets(a).then(g.hitch(this,function(a){a.success?(this.allWidgets=this._filterSingletonWidgets(a.widgets),this._createWidgetNodes(this.allWidgets)):console.log(a.message)}))},_filterSingletonWidgets:function(a){return v.filter(a,
function(a){return!1===a.properties.supportMultiInstance&&this._checkWidgetIsInAppConfig(this.appConfig,a.name)?!1:!0},this)},_checkWidgetIsInAppConfig:function(a,b){var c=[];0===E.getControllerWidgets(a).length?a.visitElement(g.hitch(this,function(a){a.isOnScreen&&a.name===b&&c.push(a)})):c=a.getConfigElementsByName(b);return 0<c.length},_createWidgetNodes:function(a){t.empty(this.widgetListNode);v.forEach(a,function(a){this._createWidgetNode(a)},this)},_createWidgetNode:function(a){var b,c,e;b=
t.create("div",{"class":"widget-node","data-widget-name":a.name},this.widgetListNode);c=t.create("div",{"class":"box"},b);t.create("div",{"class":"box-selected"},b);e=t.create("img",{"class":"icon",src:a.icon},c);window.isRTL&&a.properties&&a.properties.mirrorIconForRTL&&t.addClass(e,"jimu-flipx");t.create("div",{"class":"label",innerHTML:E.stripHTML(a.label),title:a.label},b);b.setting={name:a.name,label:a.label,version:a.version,closeable:"removeableWidgetOnScreen"===this.fromList?!0:void 0};E.widgetJson.addManifest2WidgetJson(b.setting,
a);b.setting.uri=a.amdFolder+"Widget";b.box=c;this.own(m(b,"click",g.hitch(this,this._onWidgetClick,b)));return b},_onWidgetClick:function(a){0===this.tab.getSelectedIndex()?f(".custom-section .jimu-state-selected",this.domNode).removeClass("jimu-state-selected"):f(".official-section .jimu-state-selected",this.domNode).removeClass("jimu-state-selected");this._isMultipleSelection()?t.hasClass(a,"jimu-state-selected")?t.removeClass(a,"jimu-state-selected"):t.addClass(a,"jimu-state-selected"):(f(".jimu-state-selected",
this.domNode).removeClass("jimu-state-selected"),t.addClass(a,"jimu-state-selected"))},_isMultipleSelection:function(){var a=this.fromNode;return"addBtn"===a.type&&"poolWidgets"===this.fromList||"addBtn"===a.type&&"groupOnScreen"===this.fromList&&this._canAddMoreWidgetsInGroup(a.gnode)||"group"===a.type&&this._canAddMoreWidgetsInGroup(a)},_canAddMoreWidgetsInGroup:function(a){return a?"undefined"===typeof a.setting.maxWidgets||a.setting.maxWidgets>a.setting.widgets.length+1:!1},onOk:function(){(0===
this.tab.getSelectedIndex()?this._getOfficialSelection():this._getCustomSelection()).then(g.hitch(this,function(a){var b=[];"group"===this.fromNode.type&&"undefined"!==typeof this.fromNode.setting.maxWidgets&&this.fromNode.setting.widgets.length+a.length>this.fromNode.setting.maxWidgets?(new C({message:D.substitute({maxCount:this.fromNode.setting.maxWidgets},this.nls.addWidgetExceedMax)}),this.loading.hide()):(v.forEach(a,function(a){b.push(this._copyWidget(a))},this),k(b).then(g.hitch(this,function(b){var c;
for(c=0;c<b.length;c++)if(!b[c].success){new C({message:b[c].message});this.loading.hide();return}this.loading.hide();this.popup.domNode&&(n.publish("widgetChoosePageOk",a,this.fromNode),this.popup.close())})))}),function(a){console.log("No widget is selected. ",a.message)})},_getOfficialSelection:function(){var a=new u,b=f(".jimu-state-selected",this.domNode);if(0===b.length)return new C({message:this.nls.emptyMessage}),a.reject({message:this.nls.emptyMessage}),a;this.loading.show();b=v.map(b,function(a){return g.clone(a.setting)});
a.resolve(b);return a},_getCustomSelection:function(){var a=[],a=this.allCustomWidgets.isVisible()?this.allCustomWidgets.getSelectedWidgetItems():this.filterCustomWidgets.getSelectedWidgetItems();return k(a.map(function(a){return F.getManifestFromItem(a).then(function(b){var c={name:b.name,label:a.title,version:b.version};E.widgetJson.addManifest2WidgetJson(c,b);c.uri=E.widgetJson.getUriFromItem(a);c.itemId=a.id;return c})}))},_copyWidget:function(a){var b=0,c,e=[],f=E.getControllerWidgets(this.appConfig);
this.appConfig.visitElement(g.hitch(this,function(c){if(0!==f.length||c.isOnScreen)c.name===a.name&&b++,e.push(c.label)}));a.icon=a.manifest.folderUrl+"images/icon.png?wab_dv\x3d"+window.deployVersion;if(0===b)a.label=a.label,c=F.copyWidgetToApp(window.appInfo.id,a);else if(0<b){c=new u;for(var k=a.label+"_"+(b+1);-1<e.indexOf(k);)b++,k=a.label+"_"+(b+1);a.label=k;c.resolve({success:!0})}return c}})})},"builder/plugins/widget-config/CustomWidgets":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./CustomWidgets.html dojo/Evented dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),
function(p,g,t,v,n,m,u,k,f,e,b,a,c){return p([g,t,v,m],{templateString:n,baseClass:"custom-widgets",query:null,nls:null,type:"AppBuilder Extension",portalUrl:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this.portalUrl=c.getStandardPortalUrl(this.portalUrl);this.portal=a.getPortal(this.portalUrl);this.baseQ='type:"'+this.type+'" AND typekeywords:"Widget,'+window.appInfo.appType+'"';"HTML"===window.appInfo.appType.toUpperCase()&&
(this.baseQ+=' -typekeywords:"HTML3D"');this.hidden&&this.hide()},filterLocally:function(a){u(".widget-node",this.domNode).forEach(k.hitch(this,function(b){a(b.item)?e.removeClass(b,"hidden"):e.addClass(b,"hidden")}))},queryItems:function(a){a=a||{};this.loading.show();this.clear();k.mixin(this.query,a);this.query.start=1;this.query.q=a.q?this.baseQ+" AND "+a.q:this.baseQ;return this.portal.queryItems(this.query).then(k.hitch(this,function(a){if(this.domNode)return this.domNode&&this.loading.hide(),
this.query.start=a.nextStart,this._createItemsNode(a)}),k.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))},_createItemsNode:function(a){a=a.results;var b=this.type.toLowerCase();a=f.filter(a,k.hitch(this,function(a){return(a.type&&a.type.toLowerCase()||"")===b}));f.forEach(a,k.hitch(this,function(a){this._createItemNode(a)}));return a},_createItemNode:function(a){var c=e.toDom('\x3cdiv class\x3d"widget-node"\x3e\x3cdiv class\x3d"box"\x3e\x3cimg class\x3d"icon"\x3e\x3ca target\x3d"_blank" class\x3d"detail-icon"\x3e\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"box-selected"\x3e\x3c/div\x3e\x3cdiv class\x3d"label"\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;u("img",c)[0].src=b.widgetJson.getFolderUrlFromItem(a)+"images/icon.png";var f=u(".label",c)[0];f.innerHTML=a.title||"";f.title=a.title||"";f=u(".detail-icon",c)[0];f.href=a.detailsPageUrl;f.title=this.nls.viewItemDetails||"View item details";e.place(c,this.list)},clear:function(){this.query={q:this.baseQ,sortField:"title",sortOrder:"asc",num:100,start:1};e.empty(this.list)},_onClick:function(a){a=a.target||a.srcElement;var c=null;if(c=e.hasClass(a,"widget-node")?a:b.getAncestorDom(a,function(a){return e.hasClass(a,
"widget-node")},this.list))u(".official-section .jimu-state-selected",this.widgetDomNode).removeClass("jimu-state-selected"),"addBtn"===this.fromNode.type?e.toggleClass(c,"jimu-state-selected"):(u(".jimu-state-selected",this.domNode).removeClass("jimu-state-selected"),e.addClass(c,"jimu-state-selected"))},_onScroll:function(){this._isScrollToBottom(this.domNode)},_isScrollToBottom:function(a){return b.isScrollToBottom(a)},getSelectedWidgetItems:function(){var a=u(".widget-node.jimu-state-selected",
this.domNode).filter(k.hitch(this,function(a){return!e.hasClass(a,"hidden")}));return f.map(a,k.hitch(this,function(a){return a.item}))},isVisible:function(){return!e.hasClass(this.domNode,"hidden")},show:function(){e.removeClass(this.domNode,"hidden")},hide:function(){e.addClass(this.domNode,"hidden")}})})},"jimu/PoolControllerMixin":function(){define(["dojo/_base/declare","dojo/_base/array","jimu/PanelManager"],function(p,g,t){return p(null,{constructor:function(){this.panelManager=t.getInstance()},
postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(g){},getConfigById:function(g){for(var n=this.getAllConfigs(),m=0;m<n.length;m++)if(n[m].id===g)return n[m]},getAllConfigs:function(){var p=[],p=p.concat(this.getWidgetConfigs(),this.getGroupConfigs()),p=g.filter(p,function(g){return g.visible});return p.sort(function(g,m){return g.index-m.index})},getAllConfigsIncludeInvisible:function(){var g=
[],g=g.concat(this.getWidgetConfigs(),this.getGroupConfigs());return g.sort(function(g,m){return g.index-m.index})},isControlled:function(p){return g.some(this.getAllConfigsIncludeInvisible(),function(g){return g.id===p})},widgetIsControlled:function(p){return g.some(this.getAllConfigsIncludeInvisible(),function(n){return n.id===p?!0:g.some(n.widgets,function(g){return g.id===p})})},getGroupConfigs:function(){var p=[];if(!this.appConfig.widgetPool)return p;this.appConfig.widgetPool.groups&&g.forEach(this.appConfig.widgetPool.groups,
function(g){this.controlledGroups&&(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(g.id)&&p.push(g):"all"===this.controlledGroups&&p.push(g))},this);return p},getWidgetConfigs:function(){var p=[];if(!this.appConfig.widgetPool)return p;this.appConfig.widgetPool.widgets&&g.forEach(this.appConfig.widgetPool.widgets,function(g){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(g.id)&&p.push(g):"all"===this.controlledWidgets&&p.push(g))},
this);return p}})})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c){var x,w=null;x=p(null,{constructor:function(){this.panels=[];this.widgetManager=c.getInstance();k(window,"resize",g.hitch(this,this.onWindowResize));this.activePanel=null;f.subscribe("/dnd/move/start",g.hitch(this,this._onMoveStart));
f.subscribe("widgetActived",g.hitch(this,this._onWidgetActived))},showPanel:function(b){var c=new m,e=this.getPanelById(b.id+"_panel");e?("closed"===e.state&&this.openPanel(e),c.resolve(e)):u({Panel:this._loadPanelClass(b.panel.uri),nls:this._loadThemeI18N(b.panel.uri)}).then(g.hitch(this,function(e){var f=b.id+"_panel",k=this.getPanelById(f),m={label:b.label,config:b,uri:b.panel.uri,position:b.panel.position,map:this.map,widgetManager:this.widgetManager,panelManager:this,id:f,gid:b.gid,nls:e.nls};
g.mixin(m,b.panel.options);try{k=new e.Panel(m),console.log("panel ["+f+"] created.")}catch(D){console.log("create panel error: "+D+", panelId: "+f);c.reject(D);return}k.setPosition(b.panel.position);a.setVerticalCenter(k.domNode);this.openPanel(k);k.domNode.addEventListener("click",g.hitch(this,this._onPanelClick,k),{capture:!0});c.resolve(k)}));return c},setMap:function(a){this.map=a;k(this.map,"resize",g.hitch(this,this.onMapResize))},closeOtherPanelsInTheSameGroup:function(a){if("string"===typeof a&&
(a=this.getPanelById(a),!a))return;for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a.gid&&this.panels[b].id!==a.id&&this.closePanel(this.panels[b])},closeAllPanelsInGroup:function(a){for(var b=0;b<this.panels.length;b++)this.panels[b].gid===a&&this.closePanel(this.panels[b])},openPanel:function(a){var b=new m;if("string"===typeof a){if(a=this.getPanelById(a),!a)return b.reject(),b}else this.panels.some(function(b){return b.id===a.id})||this.panels.push(a);if(!a.started)try{a.started=!0,
a.startup()}catch(z){console.error("fail to startup panel "+a.id+". "+z.stack)}if("opened"===a.state)return this._activePanel(a),b.resolve(a),b;a.setState("opened");return this.playOpenPanelAnimation(a).then(g.hitch(this,function(){v.setStyle(a.domNode,"display","");a.onOpen();this._activePanel(a);return a}))},closePanel:function(a){var b=new m;return"string"===typeof a&&(a=this.getPanelById(a),!a)||"closed"===a.state?(b.resolve(),b):this.playClosePanelAnimation(a).then(g.hitch(this,function(){this.activePanel&&
this.activePanel.id===a.id&&(this.activePanel.onDeActive(),this.activePanel=null);a.setState("closed");a.onClose();a.domNode&&v.setStyle(a.domNode,"display","none")}))},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(C){console.log(console.error("fail to minimize panel "+a.id+". "+C.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;
"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(C){console.log(console.error("fail to maximize panel "+a.id+". "+C.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(C){console.log(console.error("fail to noralize panel "+a.id+". "+C.stack))}},changeWindowStateTo:function(a,b){if("string"===typeof a&&(a=this.getPanelById(a),
!a))return;"normal"===b?this.normalizePanel(a):"minimized"===b?this.minimizePanel(a):"maximized"===b?this.maximizePanel(a):console.log("error state: "+b)},getPanelById:function(a){for(var b=0;b<this.panels.length;b++)if(this.panels[b].id===a)return this.panels[b]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&"map"!==this.panels[a].position.relativeTo&&this.panels[a].resize()},onMapResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==
this.panels[a].state&&"map"===this.panels[a].position.relativeTo&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a);this._removePanel(a);try{a.destroy()}catch(C){console.log(console.error("fail to destroy panel "+a.id+". "+C.stack))}}},destroyAllPanels:function(){var a=t.map(this.panels,function(a){return a.id});t.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},playOpenPanelAnimation:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a)||!a.openAnimation||0===a.animationDuration)return e();var b=new m;"string"===typeof a.openAnimation?"fadeIn"===a.openAnimation?(v.setStyle(a.domNode,{opacity:0,display:""}),n.fadeIn({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play()):b.resolve():b.resolve();return b},playClosePanelAnimation:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a)||!a.closeAnimation||0===a.animationDuration)return e();var b=new m;"string"===
typeof a.closeAnimation&&("fadeOut"===a.closeAnimation?n.fadeOut({node:a.domNode,duration:a.animationDuration,onEnd:function(){b.resolve()}}).play():b.resolve());return b},getPositionOnMobile:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return{};var b=v.getMarginBox(window.jimuConfig.layoutId),c=b.h/2;a.titleHeight||(a.titleHeight=35);return"maximized"===a.windowState?{left:0,right:0,top:0,bottom:0,width:"auto",height:"auto",contentHeight:b.h-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:0,
borderTopRightRadius:0,borderBottomLeftRadius:0,borderBottomRightRadius:0}}:"minimized"===a.windowState?(c=0,this.panels.filter(function(b){return"minimized"===b.windowState&&"closed"!==b.state&&b.id!==a.id}).some(function(a){return 0===a._mobileBottom})&&(c=a.titleHeight),a._mobileBottom=c,b.h>b.w?{left:0,right:0,top:"auto",bottom:c,width:"auto",height:a.titleHeight,contentHeight:0,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:0}}:
{left:b.w-b.w/2,right:0,top:"auto",bottom:c,width:b.w/2,height:a.titleHeight,contentHeight:b.h,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}):b.h>b.w?{left:0,right:0,top:c,bottom:0,width:"auto",height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",
borderBottomLeftRadius:0,borderBottomRightRadius:0}}:{left:b.w-b.w/2,right:0,top:0,bottom:0,width:b.w/2,height:"auto",contentHeight:b.h-c-a.titleHeight,borderRadiusStyle:window.isRTL?{borderTopLeftRadius:0,borderTopRightRadius:"4px",borderBottomLeftRadius:0,borderBottomRightRadius:"4px"}:{borderTopLeftRadius:"4px",borderTopRightRadius:0,borderBottomLeftRadius:"4px",borderBottomRightRadius:0}}},_onPanelClick:function(a){this._activePanel(a)},activatePanel:function(a){"closed"!==a.state&&this._activePanel(a)},
_activePanel:function(a){if(this.activePanel){if(this.activePanel.id===a.id){this.activePanel.moveTopOnActive&&v.setStyle(this.activePanel.domNode,"zIndex",101);return}"active"===this.activePanel.state&&(this.activePanel.setState("opened"),v.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive())}var b=this.widgetManager.activeWidget;b&&"active"===b.state&&b.getPanel()!==a&&(b.setState("opened"),
!1===b.inPanel&&v.setStyle(b.domNode,"zIndex","undefined"!==typeof b.position.zIndex?b.position.zIndex:"auto"),b.onDeActive(),this.widgetManager.activeWidget=null);this.activePanel=a;"active"!==this.activePanel.state&&(this.activePanel.setState("active"),this.activePanel.moveTopOnActive&&v.setStyle(this.activePanel.domNode,"zIndex",101),this.activePanel.onActive())},_removePanel:function(a){var b=this.panels.indexOf(a);-1<b&&this.panels.splice(b,1);this.activePanel&&this.activePanel.id===a.id&&(this.activePanel=
null)},_onMoveStart:function(a){t.forEach(this.panels,function(b){b.domNode===a.node&&this._activePanel(b)},this)},_onWidgetActived:function(a){this.activePanel&&"active"===this.activePanel.state&&a.getPanel()!==this.activePanel&&(this.activePanel.setState("opened"),v.setStyle(this.activePanel.domNode,"zIndex","undefined"!==typeof this.activePanel.position.zIndex?this.activePanel.position.zIndex:"auto"),this.activePanel.onDeActive(),this.activePanel=null)},_loadPanelClass:function(a){var c=new m;
b([a],function(a){c.resolve(a)});return c},_loadThemeI18N:function(a){var c=new m;a.startWith("themes")?(a=a.split("/"),b(["dojo/i18n!"+(a[0]+"/"+a[1]+"/nls/strings")],function(a){c.resolve(a)})):c.resolve({});return c}});x.getInstance=function(){null===w&&(w=new x,window._panelManager=w);return w};return x})},"url:esri/core/request/iframe.html":'\x3c!DOCTYPE html\x3e\r\n\x3chtml\x3e\r\n\x3chead\x3e\r\n  \x3cmeta http-equiv\x3d"Content-Security-Policy" content\x3d"default-src \'none\'; script-src * \'unsafe-inline\'"\x3e\r\n\r\n  \x3cscript\x3e\r\n    var dojoConfig \x3d {\r\n      async: true,\r\n      baseUrl: "../../../dojo/",\r\n      has: {\r\n        "csp-restrictions": true,\r\n        "dojo-preload-i18n-Api": false\r\n      }\r\n    };\r\n  \x3c/script\x3e\r\n  \x3c!--\r\n  This src is relative to this page and assumes dojo is a sibling to esri.\r\n  It is updated when this file is set as the iframe\'s `srcdoc` value.\r\n  --\x3e\r\n  \x3cscript src\x3d"../../../dojo/dojo.js"\x3e\x3c/script\x3e\r\n\r\n  \x3cscript\x3e\r\n    function windowMessageHandler(event) {\r\n      window.removeEventListener("message", windowMessageHandler);\r\n\r\n      var port \x3d event.ports[0];\r\n\r\n      require([\r\n        "dojo/request/script"\r\n      ], function(script) {\r\n        port.postMessage("ready");\r\n\r\n        port.addEventListener("message", function(event) {\r\n          var data \x3d event.data;\r\n          script.get(data.url, data.options)\r\n              .then(function(response) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  response: response\r\n                });\r\n              })\r\n              .otherwise(function(error) {\r\n                port.postMessage({\r\n                  id: data.id,\r\n                  isError: true,\r\n                  message: error.message\r\n                });\r\n              });\r\n        });\r\n        port.start();\r\n      });\r\n    }\r\n\r\n    window.addEventListener("message", windowMessageHandler);\r\n  \x3c/script\x3e\r\n\x3c/head\x3e\r\n\x3cbody\x3e\r\n\x3c/body\x3e\r\n\x3c/html\x3e\r\n',
"url:dijit/templates/Dialog.html":'\x3cdiv class\x3d"dijitDialog" role\x3d"dialog" aria-labelledby\x3d"${id}_title"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"titleBar" class\x3d"dijitDialogTitleBar"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"titleNode" class\x3d"dijitDialogTitle" id\x3d"${id}_title"\r\n\t\t\t\trole\x3d"heading" level\x3d"1"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"closeButtonNode" class\x3d"dijitDialogCloseIcon" data-dojo-attach-event\x3d"ondijitclick: onCancel" title\x3d"${buttonCancel}" role\x3d"button" tabindex\x3d"-1"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"closeText" class\x3d"closeText" title\x3d"${buttonCancel}"\x3ex\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitDialogPaneContent"\x3e\x3c/div\x3e\r\n\t${!actionBarTemplate}\r\n\x3c/div\x3e\r\n\r\n',
"url:dijit/form/templates/Button.html":'\x3cspan class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" role\x3d"presentation"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\ttabIndex\x3d"-1" aria-hidden\x3d"true" data-dojo-attach-point\x3d"valueNode"\r\n/\x3e\x3c/span\x3e\r\n',
"url:dijit/form/templates/TextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Tooltip.html":'\x3cdiv class\x3d"dijitTooltip dijitTooltipLeft" id\x3d"dojoTooltip" data-dojo-attach-event\x3d"mouseenter:onMouseEnter,mouseleave:onMouseLeave"\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipConnector" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitTooltipContainer dijitTooltipContents" data-dojo-attach-point\x3d"containerNode" role\x3d\'alert\'\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/form/templates/ValidationTextBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputInner" data-dojo-attach-point\x3d\'textbox,focusNode\' autocomplete\x3d"off"\r\n\t\t\t${!nameAttrSetting} type\x3d\'${type}\'\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/plugins/plugins.json":'{\n  "app-actions.launch-app": {\n    "name": "app-actions.launch-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.launch-app"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-actions.preview-app": {\n    "name": "app-actions.preview-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "HTML",\n          "index": 2\n        },\n        "pluginName": "app-actions.preview-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.save-app": {\n    "name": "app-actions.save-app",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 3\n        },\n        "pluginName": "app-actions.save-app"\n      },\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "_onClick",\n          "index": 1\n        },\n        "pluginName": "app-actions.save-app"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-actions.to-template-config": {\n    "name": "app-actions.to-template-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.main-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "index": 1\n        },\n        "pluginName": "app-actions.to-template-config"\n      }\n    ],\n    "properties": {\n      "hasUIFile": false,\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true\n    }\n  },\n  "app-config": {\n    "name": "app-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-template": {\n        "description": "Config template",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-template",\n        "name": "config-template",\n        "extensions": [\n          {\n            "point": "app-config.config-template",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-templateconfig"\n          }\n        ]\n      },\n      "config-part": {\n        "description": "The config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.config-part",\n        "name": "config-part",\n        "extensions": [\n          {\n            "point": "app-config.config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-configpart"\n          }\n        ]\n      },\n      "morepreview-selction-part": {\n        "description": "The more preview selection part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.morepreview-selction-part",\n        "name": "morepreview-selction-part",\n        "extensions": [\n          {\n            "point": "app-config.morepreview-selction-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-morepreview-selectionpart"\n          }\n        ]\n      },\n      "template-config-part": {\n        "description": "The Template config part",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "app-config.template-config-part",\n        "name": "template-config-part",\n        "extensions": [\n          {\n            "point": "app-config.template-config-part",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config-template-configpart"\n          }\n        ]\n      },\n      "main-app-actions": {\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.main-app-actions",\n        "name": "main-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.launch-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "HTML",\n              "index": 2\n            },\n            "pluginName": "app-actions.preview-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 3\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.main-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "index": 1\n            },\n            "pluginName": "app-actions.to-template-config"\n          }\n        ]\n      },\n      "popup-app-actions": {\n        "parameters": {\n          "onClickAction": {\n            "type": "function",\n            "name": "onClickAction"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config.popup-app-actions",\n        "name": "popup-app-actions",\n        "extensions": [\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "_onClick",\n              "index": 1\n            },\n            "pluginName": "app-actions.save-app"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 4\n            },\n            "pluginName": "popup-actions.configmode-switch"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 3\n            },\n            "pluginName": "popup-actions.popup-agoltemplate"\n          },\n          {\n            "point": "app-config.popup-app-actions",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "onClickAction": "onClick",\n              "index": 2\n            },\n            "pluginName": "popup-actions.popup-saveas"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "startup.app-config",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config"\n      }\n    ],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-configpart": {\n    "name": "app-config-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "config-sections": {\n        "description": "The config page for section of full config",\n        "parameters": {\n          "label": {\n            "type": "string",\n            "required": true,\n            "name": "label"\n          },\n          "icon": {\n            "type": "url",\n            "required": true,\n            "name": "icon"\n          },\n          "selectedIcon": {\n            "type": "url",\n            "required": true,\n            "name": "selectedIcon"\n          },\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          },\n          "republishEvents": {\n            "type": "string",\n            "required": true,\n            "description": "The events that change app config. These events will be pushed to preview window",\n            "name": "republishEvents"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "app-config-configpart.config-sections",\n        "name": "config-sections",\n        "extensions": [\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n              "index": 4\n            },\n            "pluginName": "attribute-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged,mapContentModified",\n              "index": 2\n            },\n            "pluginName": "map-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n              "index": 1\n            },\n            "pluginName": "theme-config"\n          },\n          {\n            "point": "app-config-configpart.config-sections",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all",\n              "label": "${_paramLabel}",\n              "icon": "images/icon.svg",\n              "selectedIcon": "images/selected_icon.svg",\n              "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged,onScreenOrderChanged",\n              "index": 3\n            },\n            "pluginName": "widget-config"\n          }\n        ]\n      }\n    },\n    "extensions": [\n      {\n        "point": "app-config.config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-morepreview-selectionpart": {\n    "name": "app-config-morepreview-selectionpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the config part of the config page.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.morepreview-selction-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-morepreview-selectionpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-template-configpart": {\n    "name": "app-config-template-configpart",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the template config part.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.template-config-part",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-template-configpart"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-config-templateconfig": {\n    "name": "app-config-templateconfig",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "app-config.config-template",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all"\n        },\n        "pluginName": "app-config-templateconfig"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "app-list": {\n    "name": "app-list",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {},\n    "extensions": [\n      {\n        "point": "startup.app-list",\n        "description": "",\n        "pluginName": "app-list"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "attribute-config": {\n    "name": "attribute-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "appAttributeChanged,loadingPageChanged,actionTriggered,appProxyForMapChanged,appProxyForUrlChanged",\n          "index": 4\n        },\n        "pluginName": "attribute-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "creation-entry": {\n    "name": "creation-entry",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.creation-entry",\n        "description": "",\n        "pluginName": "creation-entry"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "header": {\n    "name": "header",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.header",\n        "description": "",\n        "pluginName": "header"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "map-config": {\n    "name": "map-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "setAppConfig,mapChanged,mapOptionsChanged,sceneViewChanged,dataSourceChanged,mapRefreshIntervalChanged,mapContentModified",\n          "index": 2\n        },\n        "pluginName": "map-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "popup-actions.configmode-switch": {\n    "name": "popup-actions.configmode-switch",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 4\n        },\n        "pluginName": "popup-actions.configmode-switch"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-agoltemplate": {\n    "name": "popup-actions.popup-agoltemplate",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 3\n        },\n        "pluginName": "popup-actions.popup-agoltemplate"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-saveas": {\n    "name": "popup-actions.popup-saveas",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config.popup-app-actions",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 2\n        },\n        "pluginName": "popup-actions.popup-saveas"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "popup-actions.popup-share": {\n    "name": "popup-actions.popup-share",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "onClickAction": "onClick",\n          "index": 1,\n          "republishEvents": "SharePluginOnClickEveryone"\n        },\n        "pluginName": "popup-actions.popup-share"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": false,\n      "hasStyle": false,\n      "hasUIFile": false\n    }\n  },\n  "startup": {\n    "name": "startup",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "the first plugin that builder loads.",\n    "copyright": "",\n    "license": "",\n    "extensionPoints": {\n      "app-list": {\n        "description": "the app list page.",\n        "id": "startup.app-list",\n        "name": "app-list",\n        "extensions": [\n          {\n            "point": "startup.app-list",\n            "description": "",\n            "pluginName": "app-list"\n          }\n        ]\n      },\n      "header": {\n        "description": "the header.",\n        "id": "startup.header",\n        "name": "header",\n        "extensions": [\n          {\n            "point": "startup.header",\n            "description": "",\n            "pluginName": "header"\n          }\n        ]\n      },\n      "app-config": {\n        "description": "the app config page.",\n        "parameters": {\n          "supportAppTypes": {\n            "type": "string",\n            "required": true,\n            "name": "supportAppTypes"\n          }\n        },\n        "id": "startup.app-config",\n        "name": "app-config",\n        "extensions": [\n          {\n            "point": "startup.app-config",\n            "description": "",\n            "parameters": {\n              "supportAppTypes": "all"\n            },\n            "pluginName": "app-config"\n          }\n        ]\n      },\n      "creation-entry": {\n        "description": "The create new entry point.",\n        "id": "startup.creation-entry",\n        "name": "creation-entry",\n        "extensions": [\n          {\n            "point": "startup.creation-entry",\n            "description": "",\n            "pluginName": "creation-entry"\n          }\n        ]\n      },\n      "stemapps": {\n        "description": "the stemapp.",\n        "parameters": {\n          "appType": {\n            "type": "string",\n            "required": true,\n            "name": "appType"\n          },\n          "appPath": {\n            "type": "string",\n            "description": "By default, it\'s plugin\'s folder path",\n            "name": "appPath"\n          },\n          "appVersionManager": {\n            "type": "string",\n            "description": "path relative to app path. required if app config is old.",\n            "name": "appVersionManager"\n          },\n          "index": {\n            "type": "number",\n            "required": true,\n            "description": "1 based index.",\n            "name": "index"\n          }\n        },\n        "id": "startup.stemapps",\n        "name": "stemapps",\n        "extensions": [\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML",\n              "appPath": "../../../../stemapp/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 1\n            },\n            "pluginName": "stemapps.web2d"\n          },\n          {\n            "point": "startup.stemapps",\n            "description": "",\n            "parameters": {\n              "appType": "HTML3D",\n              "appPath": "../../../../stemapp3d/",\n              "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n              "index": 2\n            },\n            "pluginName": "stemapps.web3d"\n          }\n        ]\n      }\n    },\n    "extensions": [],\n    "properties": {\n      "hasLocale": false,\n      "hasClass": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web2d": {\n    "name": "stemapps.web2d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML",\n          "appPath": "../../../../stemapp/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 1\n        },\n        "pluginName": "stemapps.web2d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "stemapps.web3d": {\n    "name": "stemapps.web3d",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "startup.stemapps",\n        "description": "",\n        "parameters": {\n          "appType": "HTML3D",\n          "appPath": "../../../../stemapp3d/",\n          "appVersionManager": "jimu.js/shared/AppVersionManager.js",\n          "index": 2\n        },\n        "pluginName": "stemapps.web3d"\n      }\n    ],\n    "properties": {\n      "hasClass": false,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "theme-config": {\n    "name": "theme-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "themeChanged,styleChanged,layoutChanged,sharedThemeChanged,layoutDefinitionChanged",\n          "index": 1\n        },\n        "pluginName": "theme-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  },\n  "widget-config": {\n    "name": "widget-config",\n    "type": "plugin",\n    "version": "2.0.1",\n    "author": "Esri R\x26D Center Beijing",\n    "description": "",\n    "copyright": "",\n    "license": "",\n    "extensions": [\n      {\n        "point": "app-config-configpart.config-sections",\n        "description": "",\n        "parameters": {\n          "supportAppTypes": "all",\n          "label": "${_paramLabel}",\n          "icon": "images/icon.svg",\n          "selectedIcon": "images/selected_icon.svg",\n          "republishEvents": "widgetChanged,widgetPoolChanged,openAtStartChange,actionTriggered,groupChanged,onScreenGroupsChanged,onScreenOrderChanged",\n          "index": 3\n        },\n        "pluginName": "widget-config"\n      }\n    ],\n    "properties": {\n      "hasClass": true,\n      "hasLocale": true,\n      "hasStyle": true,\n      "hasUIFile": true\n    }\n  }\n}\n',
"url:builder/plugins/app-actions/launch-app/css/style.css":".plugin-app-actions-launch-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-launch-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-launch-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-launch-app a{color: inherit; display: block; text-decoration: none; height: 47px;}.plugin-app-actions-launch-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}",
"url:builder/plugins/app-actions/preview-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button  preview-button" data-dojo-attach-point\x3d"btnPreview" title\x3d\'${nls.previewMore}\'\x3e${nls.previewMore}\x3c/div\x3e\r\n  \x3cdiv class\x3d"footer-button  config-button" style\x3d"display:none" data-dojo-attach-point\x3d"btnConfig" title\x3d\'${nls.back2Configure}\'\x3e${nls.back2Configure}\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-actions/preview-app/css/style.css":".plugin-app-actions-preview-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-preview-app .footer-button{background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-preview-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-preview-app:hover .footer-button {color:#24B5CC;}.plugin-app-actions-preview-app .footer-button.preview-button{background-image: url(images/icon.svg);}.plugin-app-actions-preview-app:hover .footer-button.preview-button{background-image: url(images/hover_icon.svg);}.plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure01.svg);}.jimu-rtl .plugin-app-actions-preview-app .footer-button.config-button{background-image: url(images/configure03.svg);}.plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure02.svg);}.jimu-rtl .plugin-app-actions-preview-app:hover .footer-button.config-button{background-image: url(images/configure04.svg);}",
"url:builder/plugins/app-actions/save-app/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"footer-button" title\x3d${nls.label} data-dojo-attach-point\x3d"actionNode"\x3e${nls.label}\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-actions/save-app/css/style.css":".plugin-app-actions-save-app{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: default;}.plugin-app-actions-save-app .footer-button{background-image: url(images/icon.svg); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-save-app .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-save-app:hover .footer-button{color:#24B5CC; background-image: url(images/hover_icon.svg);}.plugin-app-actions-save-app .footer-button.save-enable{background-image:url(images/hover_icon.svg); background-repeat: no-repeat; color: #24B5CC;}.plugin-app-actions-save-app .footer-button.save-block{color: #d2dae2; background-image: url(images/block_icon.png);}",
"url:builder/plugins/app-actions/to-template-config/css/style.css":".plugin-app-actions-to-template-config{margin-top:3px; height: 47px; line-height: 47px; background-color:#F3F3F3; text-align: center; cursor: pointer;}.plugin-app-actions-to-template-config .footer-button{background-image: url(images/icon.png); background-position:left center; background-repeat: no-repeat; white-space: nowrap; display: inline-block; padding-left:20px; height: 100%; max-width: 100%; text-overflow: ellipsis; overflow: hidden;}.jimu-rtl .plugin-app-actions-to-template-config .footer-button{padding-right:20px; padding-left:0; background-position:right center; cursor: pointer;}.plugin-app-actions-to-template-config:hover .footer-button{color:#15a4fa; background-image: url(images/hover_icon.png);}",
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/AGOLLoading.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"at-view-stack" data-dojo-attach-point\x3d"atViewStackNode"\x3e\r\n    \x3cdiv class\x3d"config-app-pane" data-dojo-attach-point\x3d"configAppNode"\x3e\r\n      \x3cdiv class\x3d"left-pane" data-dojo-attach-point\x3d"leftPaneNode"\x3e\r\n        \x3cdiv class\x3d"opts-viewstack" data-dojo-attach-point\x3d"optsViewStackNode"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"configOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"morePreviewOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv data-dojo-attach-point\x3d"templateOptsPaneNode"\x3e\r\n\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"actions-pane" data-dojo-attach-point\x3d"actionsPaneNode"\x3e\r\n          \x3cdiv class\x3d"main-action-box" data-dojo-attach-point\x3d"mainActionBoxNode"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"footer-button-arrow jimu-float-leading" data-dojo-attach-point\x3d"btnArrow" data-dojo-attach-event\x3d"onclick: _onBtnArrowClick"\x3e\r\n            \x3cdiv class\x3d"foot-menu" data-dojo-attach-point\x3d"popupActionsMenu"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-preview-section" data-dojo-attach-point\x3d"rightPreviewSection"\x3e\r\n        \x3cdiv class\x3d"preview-config" data-dojo-attach-point\x3d"previewConfig"\x3e\r\n          \x3ciframe name\x3d"previewConfigFrame" data-dojo-attach-point\x3d"previewConfigFrameNode" style\x3d"border:none" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"preview-more" data-dojo-attach-point\x3d"previewMore"\x3e\r\n          \x3cdiv class\x3d"preview-more-iframe-section" data-dojo-attach-point\x3d"previewMoreIframeSection"\x3e\r\n            \x3cdiv class\x3d"preview-more-iframe-container" data-dojo-attach-point\x3d"previewMoreContainer"\x3e\r\n              \x3ciframe name\x3d"previewMoreFrame" data-dojo-attach-point\x3d"previewMoreFrameNode" style\x3d"border-color:#cad1d9;" allowfullscreen\x3d"true"\x3e\x3c/iframe\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"description" data-dojo-attach-point\x3d"previewMoreDes"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"screen-switch-section"\x3e\r\n            \x3cdiv class\x3d"portrait jimu-float-leading selected" data-dojo-attach-point\x3d"btnPortrait"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"landscape jimu-float-trailing" data-dojo-attach-point\x3d"btnLandscape"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-template-pane" data-dojo-attach-point\x3d"configTemplateNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/app-config/css/style.css":".plugin-config-app .at-view-stack{width: 100%; height: 100%; position: relative;}.plugin-config-app .at-view-stack \x3e .view{position: absolute; left: 0; top: 0;}.plugin-config-app .at-view-stack \x3e .view.config-app-pane{display: block !important; visibility: hidden;}.plugin-config-app .at-view-stack \x3e .view.config-template-pane{z-index: 2;}.plugin-config-app .left-pane{font-size: 20px; width: 400px; height: 100%; position: absolute; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-app .left-pane \x3e .jimu-loading-shelter{background-color: rgba(0, 0, 0, 0.5);}.plugin-config-app .left-pane .opts-viewstack{position: absolute; left: 0; right: 0; top: 0; bottom: 50px;}.plugin-config-app .right-preview-section{position: absolute; left: 400px; top: 0; right: 0; height: 100%;}.plugin-config-app .right-preview-section .preview-viewstack{width:100%; height:100%;}.plugin-config-app .preview-config,.plugin-config-app .preview-more{width:100%; height:100%;}.plugin-config-app .preview-config iframe{width: 100%; height: 100%;}.plugin-config-app .preview-more{position:relative; background-color:#f3f3f3; overflow:auto;}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container{margin-left:auto; margin-right:auto; background:#eaecee; padding:20px; border:2px solid #666; -webkit-border-radius:15px; -moz-border-radius:15px; -o-border-radius:15px; -ms-border-radius:15px; border-radius:15px; -webkit-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -moz-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -o-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); -ms-box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9); box-shadow:0 0 25px 0 rgba(0, 0, 0, 0.9);}.plugin-config-app .preview-more .preview-more-iframe-section .preview-more-iframe-container iframe{width:100%; height:100%;}.plugin-config-app .preview-more .description{display:none; text-align:center; font-size:15px; margin-top:20px;}.plugin-config-app .preview-more .screen-switch-section{position:absolute; right:12px; top:12px; height:38px;}.jimu-rtl .plugin-config-app .preview-more .screen-switch-section{right: auto; left: 12px;}.plugin-config-app .preview-more .screen-switch-section div{width:38px; height:100%; background-repeat:no-repeat; background-position:center center; cursor:pointer; background-color:#FFFFFF;}.plugin-config-app .preview-more .screen-switch-section div.selected{background-color:#0090A8;}.plugin-config-app .preview-more .screen-switch-section .portrait{border-top-left-radius:3px; border-bottom-left-radius:3px; background-image:url(images/portrait.png);}.plugin-config-app .preview-more .screen-switch-section .landscape{border-top-right-radius:3px; border-bottom-right-radius:3px; background-image:url(images/landscape.png);}.plugin-config-app .preview-more .screen-switch-section .portrait.selected{background-image:url(images/portrait_selected.png);}.plugin-config-app .preview-more .screen-switch-section .landscape.selected{background-image:url(images/landscape_selected.png);}.jimu-rtl .plugin-config-app .right-preview-section{left: 0; right: 400px;}.plugin-config-app .actions-pane{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color:#F3F3F3; font-size:14px;}.plugin-config-app .actions-pane .footer-button-box{height: 47px; font-family: Avenir Medium;}.plugin-config-app .actions-pane .seprate{width:1px; height: 35px; background-image:url(images/seprate.png); background-position: 0 20px; background-repeat:no-repeat;}.plugin-config-app .actions-pane .footer-button-arrow{width: 39px; height: 100%; background-image: url(images/arrow.png); background-position: 17px 25px; background-repeat: no-repeat; position: absolute; left: 360px; cursor: pointer; z-index: 10;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow{right: 360px; left: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu{display: none; position: absolute; right: 1px; box-shadow: 0 0 4px #646464;}.jimu-rtl .plugin-config-app .actions-pane .footer-button-arrow .foot-menu{left: 1px; right: auto;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div{display: block; height: 30px; line-height: 30px; padding-left: 25px; padding-right: 25px; cursor: pointer; white-space: nowrap; font-size: 14px; background-color: #fafafc; text-decoration: none; color: #4d4d4d;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div:hover{background-color: #edf2f5; color: #24B5CC;}.plugin-config-app .actions-pane .footer-button-arrow .foot-menu div.disable{color: #d2dae2;}",
"url:builder/plugins/app-config-configpart/TabContainer2.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable class\x3d"control-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-viewstack2" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/app-config-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section" data-dojo-attach-point\x3d"configSection"\x3e\r\n    \x3cdiv class\x3d"tabs" data-dojo-attach-point\x3d"tabsNode"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-configpart/css/style.css":'.plugin-appconfig-configpart{font-size: 20px; width: 400px; height: 100%; position: relative; box-shadow: 4px 0px 8px -4px rgba(0,0,0,0.4); z-index: 2;}.plugin-appconfig-configpart .config-section{width:100%; height:100%;}.jimu-tab2 .control-table{width: 100%; table-layout: fixed; background: #5E5E5E; border-collapse: collapse; font-size: 12px; text-align: center; color: #fff;}.jimu-tab2 .tab-item-div{position: relative; width: 100%; height: 80px; cursor: pointer; font-family: "Avenir Medium";}.jimu-tab2 .tab-item-div:hover{color: #fff; background-color: #444;}.jimu-tab2 .selected-tab-item-div{background-color: #24B5CC; background-size: 100% 100%; background-origin: content-box; background-repeat: no-repeat; font-family: "Avenir Medium"; color: #fff;}.jimu-tab2 .selected-tab-item-div:hover{background-color: #24B5CC;}.jimu-tab2 .tab-item-icon{display: inline-block; margin-left: auto; margin-right: auto; margin-top: 20px; margin-bottom: 6px; width: 24px; height: 24px; background-repeat: no-repeat; background-position: center center;}.jimu-tab2 .tab-item-title{width: 99%; margin: auto; white-space: pre-line; overflow: hidden; text-overflow: ellipsis; height: 16px;}.jimu-tab2 .jimu-viewstack2{background-color:#fff; position:absolute; left:0; right:0; top:80px; bottom:0; height:auto;}',
"url:builder/plugins/app-config-morepreview-selectionpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preview-section" data-dojo-attach-point\x3d"previewSection"\x3e\r\n    \x3cdiv class\x3d"preview-header"\x3e\r\n      \x3cdiv class\x3d"header-item size-section"\x3e\r\n        \x3ctable class\x3d"size-table"\x3e\r\n          \x3ccolgroup\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"20px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"86px"\x3e\x3c/col\x3e\r\n            \x3ccol width\x3d"25px"\x3e\x3c/col\x3e\r\n          \x3c/colgroup\x3e\r\n          \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"width-tip jimu-ellipsis" title\x3d"${nls.width}"\x3e${nls.width}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"customWidthNode" class\x3d"jimu-float-leading wh"\x3e\x3c/div\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"height-tip jimu-ellipsis" title\x3d"${nls.height}"\x3e${nls.height}\x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n              \x3ctd\x3e\r\n                \x3cdiv class\x3d"pixel-div"\x3e\r\n                  \x3cdiv data-dojo-attach-point\x3d"customHeightNode" class\x3d"jimu-float-leading wh"\x3e\x3c/div\x3e\r\n                  \x3cdiv class\x3d"jimu-float-leading pixel"\x3e Px \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n              \x3ctd\x3e\x3c/td\x3e\r\n            \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"preview-body"\x3e\r\n      \x3cdiv class\x3d"preview-items-section"\x3e\r\n        \x3ctable\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"previewTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"preview-qrcode-section" \x3e\r\n        \x3cdiv class\x3d"qrcode-image jimu-float-leading" data-dojo-attach-point\x3d"qrcodeImage"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"qrcode-description jimu-float-leading" data-dojo-attach-point\x3d"qrcodeDescription"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-morepreview-selectionpart/css/style.css":".left-pane .plugin-appconfig-morepreview-selectionpart .preview-section{position:relative; width:100%; height:100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header{position: relative; width: 100%; height: 52px; background-color: #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .header-item{position:absolute; top: 0; margin: auto; bottom:0;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-header .size-section{width:100%; height: 32px; color:#444444;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table td *{height: 32px; line-height: 32px; text-align: center; font-size: 14px; color: #fff;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .width-tip{width: 100%;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div{width: 110px; overflow: hidden;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .wh{width: 60px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .wh .dijitInputField{padding-left: 4px; padding-right: 4px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .wh .dijitTextBoxFocused{border: none !important; box-shadow: 0 0 0 transparent;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div input{width: 54px; color: #444444; border-style: none;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .size-table .pixel-div .pixel{width: 32px; text-align: center; margin: 0; color: white; background-color: #d2dae2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body{position:absolute; width:100%; top: 52px; bottom:0; background-color: white;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .operation-tip{font-size:14px; margin-left:22px; margin-top:28px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{position:absolute; left:0; right:0; top:0; bottom:120px; overflow-x:hidden; overflow-y:auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section{position: absolute; left: 2px; right: 2px; bottom: 0; height: 116px; border-top: 1px solid; border-color: #e3ecf2;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-image{margin: 20px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-qrcode-section .qrcode-description{width: 277px; height: 100%; padding-top: 25px; font-size: 14px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section{padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section table{width:370px; table-layout:fixed; margin-left: auto; margin-right: auto;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td{vertical-align:top; padding-top: 10px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item{margin-left: auto; margin-right: auto; width:74px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg{position:relative; width:100%; height:74px; cursor:pointer; border:1px solid #ccc;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected{border:3px solid #24B5CC;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-selected-icon{display:none; position:absolute; left:41px; top:42px; width:30px; height:26px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/check.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhoneX{background-image: url(images/preview/iPhoneX.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6{background-image: url(images/preview/iPhone6.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone6-plus{background-image: url(images/preview/iPhone6_Plus.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone5{background-image:url(images/preview/iPhone5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPhone4{background-image:url(images/preview/iPhone4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-Air{background-image: url(images/preview/iPad_Air.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad4{background-image: url(images/preview/iPad4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .new-iPad{background-image:url(images/preview/iPad3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .iPad-mini{background-image:url(images/preview/iPad-Mini.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Galaxy-S4{background-image: url(images/preview/Samsung_Galaxy_S4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-Note-3{background-image: url(images/preview/Samsung_Note_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Samsung-s8{background-image: url(images/preview/Samsung_s8.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-5{background-image: url(images/preview/Nexus_5.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-4{background-image: url(images/preview/Nexus_4.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .Nexus-7{background-image: url(images/preview/Nexus_7.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .htc-one{background-image: url(images/preview/HTC_One.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .xiaomi-3{background-image: url(images/preview/Xiaomi_3.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .LG-G2{background-image: url(images/preview/LG_G2.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .google-pixel{background-image: url(images/preview/google_pixel.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .google-pixel-xl{background-image: url(images/preview/google_pixel_XL.png);}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-bg.selected .preview-selected-icon{display:none; left:38px;}.left-pane .plugin-appconfig-morepreview-selectionpart .preview-section .preview-body .preview-items-section td .preview-item-title{display:inline-block; width:100%; text-align:center; color:#666; font-size:12px; margin-top:10px; line-height: 13px;}",
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',
"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:esri/dijit/ColorPicker/templates/ColorPicker.html":'\x3cdiv class\x3d"${css.container}" aria-label\x3d"${labels.widgetLabel}"\x3e\r\n  \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_header" tabindex\x3d"0"\x3e\r\n    \x3cspan class\x3d"${css.swatchPreview} ${css.container}"\x3e\r\n      \x3cspan class\x3d"${css.swatch} ${css.swatchTransparencyBackground}"\x3e\x3c/span\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"dap_previewSwatch"\r\n            class\x3d"${css.swatch}"\x3e\x3c/span\x3e\r\n    \x3c/span\x3e\r\n    \x3cspan aria-hidden\x3d"true" role\x3d"presentation"\r\n          class\x3d"${css.collapseIcon} ${css.downArrowIcon}"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.colorControls}" data-dojo-attach-point\x3d"dap_colorControls"\r\n       id\x3d"${id}-color-controls" tabindex\x3d"-1"\x3e\r\n    \x3cdiv class\x3d"${css.middle}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_paletteContainer"\r\n           class\x3d"${css.palette} ${css.container}" tabindex\x3d"0"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_primaryPalette"\r\n             class\x3d"${css.palette}" role\x3d"grid"\x3e\x3c/div\x3e\x3c!--\r\n      --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_secondaryPalette"\r\n             class\x3d"${css.palette}" role\x3d"grid"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.paletteOptions}"\x3e\r\n        \x3cinput type\x3d"text" aria-label\x3d"${labels.selectedColor}" data-dojo-type\x3d"dijit/form/TextBox"\r\n               data-dojo-attach-point\x3d"dap_hexInput" class\x3d"${css.hexInput}" /\x3e\r\n        \x3cinput class\x3d"${css.paletteToggle}" type\x3d"button"\r\n               data-dojo-type\x3d"dijit/form/ToggleButton"\r\n               data-dojo-attach-point\x3d"dap_paletteToggle"\r\n               label\x3d"${labels.more}" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.footer}" data-dojo-attach-point\x3d"dap_footer"\x3e\r\n      \x3cdiv class\x3d"${css.section} ${css.displayNone}"\r\n           data-dojo-attach-point\x3d"dap_suggestedColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}" id\x3d"${id}-suggested-colors-label"\x3e${labels.suggested}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.suggested} ${css.palette}"\r\n             aria-labelledby\x3d"${id}-suggested-colors-label"\r\n             data-dojo-attach-point\x3d"dap_suggestedColorPaletteContainer"\r\n             tabindex\x3d"0" role\x3d"grid"\x3e\r\n          \x3cdiv class\x3d"${css.suggested} ${css.swatchRow}"\r\n               data-dojo-attach-point\x3d"dap_suggestedColorPalette"\r\n               role\x3d"row"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}"\r\n           data-dojo-attach-point\x3d"dap_recentColorSection"\x3e\r\n        \x3cdiv class\x3d"${css.label}" id\x3d"${id}-recent-colors-label"\x3e${labels.recent}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.recent} ${css.palette}" aria-labelledby\x3d"${id}-recent-colors-label"\r\n             data-dojo-attach-point\x3d"dap_recentColorPaletteContainer"\r\n             tabindex\x3d"0" role\x3d"grid"\x3e\r\n          \x3cdiv class\x3d"${css.recent} ${css.swatchRow}"\r\n               data-dojo-attach-point\x3d"dap_recentColorPalette"\r\n               role\x3d"row"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.section}"\r\n           data-dojo-attach-point\x3d"dap_transparencySection"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_transparencyLabel"\r\n             class\x3d"${css.label}"\x3e${labels.transparency}\r\n      \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.transparencySlider}"\r\n             data-dojo-attach-point\x3d"dap_transparencySlider"\r\n             data-dojo-type\x3d"esri/dijit/HorizontalSlider"\r\n             data-dojo-props\x3d"minimum: 0, maximum: 100, discreteValues: 100, labels: ${_transparencyLabels}"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/DropDownButton.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d\'dijitReset dijitInline dijitButtonNode\'\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:__onClick" data-dojo-attach-point\x3d"_buttonNode"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"focusNode,titleNode,_arrowWrapperNode,_popupStateNode"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon"\r\n\t\t\t\tdata-dojo-attach-point\x3d"iconNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonInner"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitArrowButtonChar"\x3e\x26#9660;\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1"\r\n\t\tdata-dojo-attach-event\x3d"onclick:_onClick" data-dojo-attach-point\x3d"valueNode" aria-hidden\x3d"true"\r\n/\x3e\x3c/span\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"head-part"\x3e\r\n    \x3cdiv class\x3d"decorator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"description data-dojo-attach-point\x3d"description"" \x3e\r\n      \x3cdiv class\x3d"description-text"\x3e${nls.description}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-part-box"\x3e\r\n    \x3cdiv class\x3d"config-part" data-dojo-attach-point\x3d"configPart"\x3e\r\n      \x3cdiv class\x3d"map-category"\x3e\r\n        \x3cdiv class\x3d"map-title" data-dojo-attach-point\x3d"mapTitle"\x3e${nls.map}\x3c/div\x3e\r\n        \x3cdiv class\x3d"select-part"\x3e\r\n          \x3cdiv class\x3d"jimu-btn select-map" data-dojo-attach-point\x3d"selectMapBtn" data-dojo-attach-event\x3d"click:_onSelectMapClick"\x3e${nls.changeWebMap}\x3c/div\x3e\r\n          \x3cdiv class\x3d"map-name" data-dojo-attach-point\x3d"mapName"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"control-part" data-dojo-attach-point\x3d"controlPart"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-config-template-configpart/css/style.css":".plugin-appconfig-template-configpart {background-color: #ffffff; font-size: 12px; overflow-y: auto;}.plugin-appconfig-template-configpart .header-line {width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0); display: none;}.plugin-appconfig-template-configpart .head-part {position: absolute; top: 0; height: 80px; background-color: #f3f3f3; width: 100%; z-index: 1;}.plugin-appconfig-template-configpart .head-part .decorator {height: 16px; background-color: #24B5CC;}.plugin-appconfig-template-configpart .head-part .description {height: 64px; padding-top: 10px; color: #666666; font-size: 14px; width: 90%; margin: 0 auto;}.plugin-appconfig-template-configpart .config-part-box {width: 100%; overflow: auto; height: 100%;}.plugin-appconfig-template-configpart .config-part {width: 90%; height: 100%; margin: 0 auto; padding-top: 80px;}.plugin-appconfig-template-configpart .config-part .map-category .map-title{border-bottom: 1px solid #eaeaea; margin: 12px 0 10px 0; font-weight: bold; font-size: 14px; color: #565656; padding-bottom: 0.3em;}.plugin-appconfig-template-configpart .config-part .map-category {overflow: hidden;}.plugin-appconfig-template-configpart .config-part .map-category .select-map{padding: 0 15px; font-size: 14px; line-height: 33px; text-align: center; color: #ffffff; float: left; max-width: 50%;}.plugin-appconfig-template-configpart .config-part .map-category .map-name{margin-top: 10px; color: #596679; font-size: 12px; max-width: 100%; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; float: right; width: 50%;}",
"url:builder/dijit/template-config/templates/Template.html":'\x3cdiv\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part jimu-float-leading" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title"\x3e${nls.appProperties}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part jimu-float-leading" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-content"\x3e\r\n          \x3cdiv class\x3d"right-part-head" \x3e\r\n            \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n            \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick" style\x3d"display:none"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n            \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"right-part-subhead"\x3e\r\n            ${nls.rightPartSubhead}\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n            \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/template-config/templates/Export.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:block;" class\x3d"message-div" data-dojo-attach-point\x3d"templateTitle"\x3e${nls.templateTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"message-div" data-dojo-attach-point\x3d"message1"\x3e\x3c/p\x3e\r\n  \x3cdiv style\x3d"display:none;" class\x3d"explain-div" data-dojo-attach-point\x3d"explain1"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/template-config/templates/ExportMessage.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"element resMessage" data-dojo-attach-point\x3d"resMessage"\x3e\x3c/div\x3e\r\n    \x3c!--div class\x3d"element" data-dojo-attach-point\x3d"message1"\x3e\x3c/div--\x3e\r\n    \x3cdiv class\x3d"element itemLink"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word1" \x3e\x3c/span\x3e\r\n      \x3ca class\x3d"download-a" target\x3d"_blank" data-dojo-attach-point\x3d"itemLink"\x3e\x3c/a\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"word2" \x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/ItemInfo.html":'\x3cdiv\x3e\r\n        \x3cdiv\x3e\r\n          \x3ctable style\x3d"width:100%" cellspacing\x3d"6"\x3e\r\n            \x3ctbody\x3e\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" width\x3d"10%"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-name"\x3e\r\n                    ${nls.nameLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd width\x3d"90%"\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;padding:2px;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"tagsTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n                    ${nls.tagsLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags" style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr\x3e\r\n                \x3ctd class\x3d"label-tr" valign\x3d"top"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n                    ${nls.summaryLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true" maxlength\x3d"250" required\x3d"true" style\x3d"width:95%;max-width:95%;min-width:95%;height:200px;max-height:200px;min-height:200px;padding:2px;resize:none;"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"thumbnailTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-thumbnail"\x3e\r\n                    ${nls.thumbnailLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n\r\n              \x3ctr data-dojo-attach-point\x3d"folderTr"\x3e\r\n                \x3ctd class\x3d"label-tr"\x3e\r\n                  \x3clabel for\x3d"publish-webmap-folder"\x3e\r\n                    ${nls.saveFolderLabel}\r\n                  \x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-folder" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:96%;"\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n              \x3ctr data-dojo-attach-point\x3d"sharingTr"\x3e\r\n                \x3ctd\x3e\x26nbsp;\x3c/td\x3e\r\n                \x3ctd\x3e\r\n                  \x3cdiv id\x3d"publish-webmap-sharing" data-dojo-type\x3d"dijit/form/CheckBox" checked\x3e\x3c/div\x3e\r\n                  \x3clabel for\x3d"publish-webmap-sharing"\x3e${nls.shareSameLevel}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n              \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/Tags.html":'\x3cdiv class\x3d"${baseClass}" style\x3d"outline:none;"\x3e\x3c/div\x3e\r\n',"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n  \x3cimg class\x3d"tmp-image" style\x3d"display:none" data-dojo-attach-point\x3d"tmpImg"\x3e--\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_CropImage.html":'\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\r\n\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" width\x3d"100%" height\x3d"100%" style\x3d"display:none;width:100%;height:100%"\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-config-templateconfig/Plugin.html":'\x3cdiv \x3e\r\n  \x3cdiv class\x3d"header-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"left-part jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"config-panel" data-dojo-attach-point\x3d"configPanel"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-panel"\x3e\r\n      \r\n      \x3cdiv class\x3d"to-app-btn jimu-float-leading" title\x3d"${nls.toConfigApp}" data-dojo-attach-event\x3d"onclick:_onToAppClick" \x3e${nls.toConfigApp}\x3c/div\x3e\r\n      \x3cdiv class\x3d"save-btn jimu-float-trailing" data-dojo-attach-point\x3d"savePluginNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"separate jimu-float-trailing"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e    \r\n  \x3c/div\x3e\r\n\r\n \x3cdiv class\x3d"preview-panel jimu-float-leading" \x3e\r\n    \x3cdiv class\x3d"preview-content" data-dojo-attach-point\x3d"previewPanel"\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:builder/plugins/app-config-templateconfig/css/style.css":".plugin-config-template {background-color: #ffffff; position: relative;}.plugin-config-template .header-line{width: 100%; position: absolute; border-style: none none solid none; border-width: 1px; box-shadow: 0px 0px 6px rgba(0,0,0,0.4); border-color: rgba(0,0,0,0.0);}.plugin-config-template .left-part{width: 60%; height: 100%; position: relative; box-shadow: 0px 0px 8px rgba(0,0,0,0.4);}.plugin-config-template .config-panel{position: absolute; left: 0; right: 0; top: 0; bottom: 50px; box-shadow: 0px 0px 8px rgba(0,0,0,0.4); z-index: 2;}.plugin-config-template .action-panel{width: 100%; position: absolute; left: 0; right: 0; bottom: 0; height: 52px; background-color: #F3F3F3; font-size: 14px;}.plugin-config-template .action-panel .to-app-btn{background-image: url(../../../../stemapp/jimu.js/css/images/setting_disabled.png); height: 100%; line-height: 52px; padding-left: 50px; background-repeat: no-repeat; background-position: 25px center; cursor: pointer;}.jimu-rtl .plugin-config-template .action-panel .to-app-btn{padding-right: 50px; padding-left: auto; background-position: right 25px center;}.plugin-config-template .action-panel .to-app-btn:hover{background-image: url(../../../../stemapp/jimu.js/css/images/setting_hover.png); color: #15a4fa;}.plugin-config-template .action-panel .separate{border: 1px solid #a3a3a3; height: 20px; margin-top: 16px;}.plugin-config-template .action-panel .save-btn{margin-right: 40px; margin-left: 40px;}.plugin-config-template .preview-panel{width: 40%; height: 100%; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-config-template .preview-panel .preview-content{width: 80%; margin: 0 auto; min-width: 300px;}",
"url:builder/plugins/app-list/Plugin.html":'\x3cdiv\x3e\r\n  \x3c!--header\x3e\x3c--\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"header"\x3e\r\n    \x3cdiv class\x3d"navigator-box" data-dojo-attach-point\x3d"navigatorBox"\x3e\r\n      \x3c!--div class\x3d"switch-app" style\x3d"float: left; cursor: pointer; margin-right: 5px" data-dojo-attach-point\x3d"switchApps"  data-dojo-attach-event\x3d"onclick:_onSwitchToAppContent"\x3eapps\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-template" style\x3d"float: left; cursor: pointer;" data-dojo-attach-point\x3d"switchTemplates" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateContent"\x3etempaltes\x3c/div--\x3e\r\n      \x3cdiv class\x3d"navigator" data-dojo-attach-point\x3d"navigator"\x3e\r\n        \x3cdiv class\x3d"filter-box jimu-float-leading" data-dojo-attach-point\x3d"filterBox"\x3e\r\n          \x3cdiv class\x3d"filter all selected jimu-float-leading" id\x3d"ALL" data-dojo-attach-point\x3d"filterAllBtn" data-dojo-attach-event\x3d"onclick:_filterAllBtnClick"\x3e${nls.all}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 2d jimu-float-leading" id\x3d"HTML" data-dojo-attach-point\x3d"filter2dBtn" data-dojo-attach-event\x3d"onclick:_filter2dBtnClick"\x3e${nls.d2}\x3c/div\x3e\r\n          \x3cdiv class\x3d"filter 3d jimu-float-leading" id\x3d"HTML3D" data-dojo-attach-point\x3d"filter3dBtn" data-dojo-attach-event\x3d"onclick:_filter3dBtnClick"\x3e${nls.d3}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"search jimu-float-trailing" data-dojo-attach-point\x3d"search"\x3e\r\n          \x3cdiv class\x3d"search-box jimu-float-leading" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"searchBox" trim\x3d"true" maxlength\x3d"250" required\x3d"true" placeholder\x3d${nls.searchPlaceholder} data-dojo-attach-event\x3d"onKeyUp:_onSearchBoxChange"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"search-btn jimu-float-leading" data-dojo-attach-point\x3d"searchBtn"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"sort-box jimu-float-trailing" data-dojo-attach-point\x3d"sortBox"\x3e\r\n          \x3cdiv class\x3d"sort by-modified-time selected jimu-float-leading" id\x3d"lastUpdated" data-dojo-attach-point\x3d"sortByModifiedTimeBtn" data-dojo-attach-event\x3d"onclick:_sortByModifiedTimeBtnClick" title\x3d"${nls.sortByModifiedTime}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-name jimu-float-leading" id\x3d"name" data-dojo-attach-point\x3d"sortByNameBtn"  data-dojo-attach-event\x3d"onclick:_sortByNameBtnClick" title\x3d"${nls.sortByName}"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"sort by-author jimu-float-leading" id\x3d"creator" data-dojo-attach-point\x3d"sortByAuthorBtn" data-dojo-attach-event\x3d"onclick:_sortByAuthorBtnClick" title\x3d"${nls.sortByAuthor}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"author-filter-box jimu-float-trailing" data-dojo-attach-point\x3d"authorFilterBox"\x3e\r\n          \x3cdiv class\x3d"author-filter" data-dojo-attach-point\x3d"authorFilter" data-dojo-attach-event\x3d"onclick:_onAuthorFilterClick"\x3e\r\n            ${nls.authorFilterByOwnedByMe}\r\n          \x3c/div\x3e\r\n            \x3cdiv class\x3d"dropdowmenu-btn" data-dojo-attach-point\x3d"authorFilterSelector" data-dojo-type\x3d"jimu/dijit/DropdownMenu"\r\n              data-dojo-props\x3d"dropdownMenuClass: \'authorFilterSelector\', highlightValue: \'ownedByMe\', items: [{label: \'${nls.authorFilterByOwnedByMe}\', value: \'ownedByMe\'}, {label: \'${nls.authorFilterByOwnedByAnyone}\', value: \'ownedByAnyone\'}, {label: \'${nls.authorFilterByNotOwnedByMe}\', value: \'notOwnedByMe\'}]"\r\n              data-dojo-attach-event\x3d"click-item:_authorFilterChanged"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"content-box" id\x3d"content-box" data-dojo-attach-point\x3d"contentBox"\x3e\r\n    \x3c!--operation\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"operation-box" data-dojo-attach-point\x3d"operationBox"\x3e\r\n      \x3cdiv class\x3d"create jimu-float-leading" data-dojo-attach-point\x3d"createNewBtn" data-dojo-attach-event\x3d"onclick:_onCreateClick" title\x3d${nls.appCreate}\x3e${nls.appCreate}\x3c/div\x3e\r\n      \x3cdiv class\x3d"import jimu-float-leading" data-dojo-attach-point\x3d"importBtn"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"switch-app-page-box" data-dojo-attach-point\x3d"switchAppPapgeBox"\x3e \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--content\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"content app-content selected" id\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"content tempalte-content" id\x3d"template-content" data-dojo-attach-point\x3d"templateContent"\x3e\x3c/div\x3e\r\n    \x3c!--footer\x3e\x3c--\x3e\r\n    \x3cdiv class\x3d"footer" data-dojo-attach-point\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"footer-text"\x3e\r\n        \x3cspan class\x3d"jimu-float-leading"\x3e\u00a9 Copyright 2019 Environmental Systems Research Institute, Inc.\x3c/span\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/privacy"\x3ePrivacy\x3c/a\x3e\r\n        \x3cspan class\x3d"separator jimu-float-leading"\x3e|\x3c/span\x3e\r\n        \x3ca class\x3d"jimu-float-leading" target\x3d"_blank" href\x3d"//www.esri.com/legal/software-license"\x3eLegal\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ciframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:builder/plugins/app-list/Import.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"actions jimu-float-trailing" data-dojo-attach-point\x3d"actionsNode"\x3e\r\n    \x3cspan class\x3d"actions-label jimu-ellipsis" title\x3d"${nls.actionsLabel}" data-dojo-attach-event\x3d"onclick:_onActionsLabelClick"\x3e${nls.actionsLabel}\x3c/span\x3e\r\n    \x3cdiv class\x3d"actions-menu" data-dojo-attach-point\x3d"actionsMenu"\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-import" data-dojo-attach-point\x3d"itemImportBtn" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"import-button jimu-ellipsis" title\x3d"${nls.importAction}" data-dojo-attach-event\x3d"onclick:_onImportClick"\x3e${nls.importAction}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"actions-menu-item item-upload" data-dojo-attach-event\x3d"onclick:_onMenuItemClick"\x3e\r\n        \x3cdiv class\x3d"upload-button-div"\x3e\r\n          \x3cdiv class\x3d"upload-button jimu-ellipsis" title\x3d"${nls.uploadAction}"\x3e${nls.uploadAction}\x3c/div\x3e\r\n          \x3cform enctype\x3d"multipart/form-data" title\x3d"${nls.uploadAction}" method\x3d"post" action\x3d"/webappbuilder/rest/apps/upload" data-dojo-attach-point\x3d"uploadAppFileFormNode"\x3e\r\n            \x3cinput class\x3d"file-input" title\x3d"${nls.uploadAction}" name\x3d"app" type\x3d"file" accept\x3d".zip" style\x3d"width:100%;height:100%;"\r\n              data-dojo-attach-point\x3d"appFileInputNode" data-dojo-type\x3d"dojox/form/Uploader" data-dojo-attach-event\x3d"onChange:_onAppFileChange,onError:_onAppFileUploadError,onComplete:_onAppFileUploadComplete"\x3e\r\n            \x3cinput name\x3d"creator" type\x3d"text" value\x3d"1234" style\x3d"display:none;" data-dojo-attach-point\x3d"appFileCreatorInputNode"\x3e\r\n            \x3cinput name\x3d"portalUrl" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"appPortalUrlInputNode"\x3e\r\n            \x3cinput name\x3d"fromList" type\x3d"text" style\x3d"display:none" data-dojo-attach-point\x3d"fromListNode"\x3e\r\n          \x3c/form\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/FullScreenPopup.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onContainerClick"\x3e\r\n  \x3cdiv class\x3d"background" data-dojo-attach-point\x3d"background"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"main" data-dojo-attach-point\x3d"main"\x3e\r\n    \x3cdiv class\x3d"head" data-dojo-attach-point\x3d"head"\x3e\r\n      \x3cdiv class\x3d"head-underline"\x3e\r\n        \x3cspan class\x3d"title" data-dojo-attach-point\x3d"fullscreenPopupTitle"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"close" data-dojo-attach-point\x3d"fullscreenPopupClose"\r\n             data-dojo-attach-event\x3d"onclick:_onCloseClick"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"content-scroller" data-dojo-attach-point\x3d"contentScroller"\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"fullscreenPopupContent"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btnsContainer" data-dojo-attach-point\x3d"fullscreenPopupBtnsContainer"\x3e\r\n      \x3cdiv class\x3d"btns" data-dojo-attach-point\x3d"fullscreenPopupBtns"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/form/resources/Uploader.html":'\x3cspan class\x3d"dijit dijitReset dijitInline"\r\n\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonNode"\r\n\t\tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n\t\t\x3e\x3cspan class\x3d"dijitReset dijitStretch dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode,focusNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitToggleButtonIconChar"\x3e\x26#x25CF;\x3c/span\r\n\t\t\t\x3e\x3cspan class\x3d"dijitReset dijitInline dijitButtonText"\r\n\t\t\t\tid\x3d"${id}_label"\r\n\t\t\t\tdata-dojo-attach-point\x3d"containerNode"\r\n\t\t\t\x3e\x3c/span\r\n\t\t\x3e\x3c/span\r\n\t\x3e\x3c/span\r\n\t\x3e \r\n\t\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" class\x3d"dijitOffScreen" tabIndex\x3d"-1" data-dojo-attach-point\x3d"valueNode" /\x3e\r\n\x3c/span\x3e\r\n',
"url:builder/plugins/app-list/AppCatalogPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/AppOperMenu.html":'\x3cdiv data-dojo-attach-event\x3d"onclick:_onMenuClick"\x3e\r\n  \x3cdiv class\x3d"up-triangle" data-dojo-attach-point\x3d"upTriangle"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"down-triangle" data-dojo-attach-point\x3d"downTriangle"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"item item-createApp-from-template" data-dojo-attach-point\x3d"createAppFromTemplate" data-dojo-attach-event\x3d"onclick:_onCreateAppFromTempalteClick"\x3e${nls.createApp}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-editAppInfo" data-dojo-attach-point\x3d"editAppInfo" data-dojo-attach-event\x3d"onclick:_onEditClick"\x3e${nls.editAppInfo}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-download" data-dojo-attach-point\x3d"download" data-dojo-attach-event\x3d"onclick:_onDownloadClick"\x3e\r\n    \x3ca data-dojo-attach-point\x3d"downloadLinkNode" style\x3d"display:inline-block;width:100%;height:100%;" target\x3d"downloadTargetFrame"\x3e${nls.download}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-duplicate" data-dojo-attach-point\x3d"duplicate" data-dojo-attach-event\x3d"onclick:_onDuplicateClick"\x3e${nls.duplicate}\x3c/div\x3e\r\n  \x3cdiv class\x3d"item item-remove" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"remove" data-dojo-attach-event\x3d"onclick:_onRemoveClick"\x3e${nls.deleteMenu}\x3c/div\x3e\r\n  \x3c!--div class\x3d"item item-agol-template" style\x3d"border-bottom-left-radius:5px;border-bottom-right-radius:5px;" data-dojo-attach-point\x3d"agolTemplate" data-dojo-attach-event\x3d"onclick:_onAgolTemplateClick"\x3e${nls.agolTemp}\x3c/div\x3e \r\n  \x3cdiv class\x3d"item item-qrcode" style\x3d"" data-dojo-attach-point\x3d"qrcode" data-dojo-attach-event\x3d"onclick:_onQRCodeClick"\x3eqrcodeeeeeee-nonls\x3c/div--\x3e \r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/EditItemInfo.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"image-chooser-container" data-dojo-attach-point\x3d"imageChooserContainer"\x3e\r\n    \x3cdiv class\x3d"chooser-border"\x3e\r\n      \x3cdiv class\x3d"image-chooser-masker" data-dojo-attach-point\x3d"imageChooserMasker"\x3e${nls.change}\x3c/div\x3e\r\n      \x3cdiv class\x3d"image-chooser-base" id\x3d"publish-webmap-thumbnail" data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-edit" data-dojo-attach-point\x3d"appInfoEdit"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-name"\x3e\r\n        ${nls.nameLabel}\r\n      \x3c/label\x3e\r\n      \x3cinput id\x3d"publish-webmap-name" data-dojo-type\x3d"dijit/form/TextBox" trim\x3d"true" data-dojo-attach-point\x3d"appName"\r\n             maxlength\x3d"250" required\x3d"true" placeHolder\x3d"${nls.nameLabelPlaceHolder}"\r\n             class\x3d"app-info-edit-name"\x3e\r\n      \x3c/input\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-summary"\x3e\r\n        ${nls.summaryLabel}\r\n      \x3c/label\x3e\r\n      \x3ctextarea id\x3d"publish-webmap-summary" data-dojo-type\x3d"dijit/form/SimpleTextarea" rows\x3d\'5\' trim\x3d"true"\r\n                maxlength\x3d"250" required\x3d"true" style\x3d"resize:none;" class\x3d"app-info-edit-summary"\r\n                data-dojo-attach-point\x3d"publishWebmapSummary"\x3e\x3c/textarea\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv\x3e\r\n      \x3clabel for\x3d"publish-webmap-tags"\x3e\r\n        ${nls.tagsLabel}\r\n      \x3c/label\x3e\r\n      \x3cdiv id\x3d"publish-webmap-tags" data-dojo-type\x3d"builder/dijit/Tags" data-dojo-attach-point\x3d"tags"\r\n           style\x3d"width:95%;max-width:95%;"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e--\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/app-list/CardPageWithBigThumbnail.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"card-page-content" data-dojo-attach-point\x3d"cardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/app-list/CardPageWithSmallThumbnail.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-card-page-content" id\x3d"app-card-page-content" data-dojo-attach-point\x3d"appCardPageContent"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',"url:builder/plugins/app-list/css/style.css":'.app-oper-menu {position: absolute; background-color:#354052; min-width:160px; max-width: 300px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-oper-menu.white-style {background-color:#ffffff; box-shadow: 0 0 8px rgba(0, 0, 0, 0.2)}.app-oper-menu .item{width: 100%; height: 40px; min-height: 30px; padding-left: 20px; padding-right: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; line-height: 40px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.app-oper-menu.white-style .item{color: #333333; border-bottom: 1px solid #e4e7e7;}.app-oper-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.app-oper-menu.white-style .item:hover{background-color: #f8f9fb; color: #31aacd;}.jimu-rtl .app-oper-menu .item{padding-right: 20px; padding-left: 0px;}.app-oper-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-oper-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-oper-menu .item a{text-decoration: none; color: inherit;}.app-oper-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -11px; right: 20px; background: url("images/up_triangle.png");}.app-oper-menu.white-style .up-triangle{background: url("images/up_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .up-triangle{left: 20px; right: auto;}.app-oper-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.app-oper-menu.white-style .down-triangle{background: url("images/down_triangle_white.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .app-oper-menu .down-triangle{left: 20px; right: auto;}.import-app .actions{margin-right:2px; position: relative; display: inline-block; background-color: #ffffff; border-radius: 2px; border: 1px solid #31aacd; height: 40px;}.import-app .actions:hover{background-color: #f4f4f4;}.jimu-rtl .import-app .actions{margin-left:2px;}.import-app .actions-label{display: inline-block; width: 120px; margin: 0 15px; padding-right: 8px; background: url("images/v_blue.png") right no-repeat; color: #31aacd; line-height: 35px; font-size: 14px; font-weight: bold; text-align: center; cursor: pointer;}.jimu-rtl .import-app .actions-label{padding-left: 8px; padding-right: 0; background-position: left center;}.import-app .actions-menu {display: none; position: absolute; top: 41px; left: 0; z-index: 9999; background: #fff; box-shadow: 0 0 4px #646464; color: #333333; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; border-radius: 5px;}.jimu-rtl .import-app .actions-menu{left: auto; right: 0;}.import-app .actions-menu-item{position: relative; width: 250px; height: 30px; overflow: hidden; white-space: nowrap; padding: 0 25px; background-color: #ffffff; border-bottom: 1px solid #e4e7e7; border-radius: 5px; font-size: 14px;}.import-app .actions-menu-item .upload-button,.import-app .actions-menu-item .import-button {line-height: 30px; padding-left: 18px; background-repeat: no-repeat; background-position: left center;}.jimu-rtl .import-app .item-import .import-button,.jimu-rtl .import-app .item-upload .upload-button{padding-right: 18px; padding-left: 0; background-position: right center;}.import-app .item-import .import-button{background-image: url("images/clouda.png"); cursor: pointer;}.import-app .item-import:hover .import-button{background-image: url("images/cloudb.png");}.import-app .item-upload .upload-button{background-image: url("images/computera.png");}.import-app .item-upload:hover .upload-button{background-image: url("images/computerb.png");}.import-app .actions-menu-item:hover{background-color: #f8f9fb; color: #31aacd;}.import-app .upload-button-div form{position:absolute; top:0; bottom:0; width:100%; opacity:0; overflow: hidden; width: 200px; filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButtonNode{filter: Alpha(opacity\x3d0); -ms-filter: "Alpha(opacity\x3d0)";}.import-app .upload-button-div form span.dijitButton input{cursor: pointer; font-size: 20em\\9\\0 !important;}.jimu-rtl .import-app .upload-button-div form span.dijitButton input{left:-3px; right:auto !important;}.fullscreen-popup-container .content .control-node {line-height: 30px; height: 30px; width: 470px;}.fullscreen-popup-container .content .control-node .jimu-item-selector .jimu-tab3\x3e.container-node {top: 62px;}.fullscreen-popup-container .control-node .control-table {font-size: 14px; color: #999; line-height: 14px;}.fullscreen-popup-container .control-node .tab-item-td {width: 100px; padding: 0 10px; border: none;}.fullscreen-popup-container .control-node .tab-item-td:last-child {display: none;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node{top:54px;}.fullscreen-popup-container .jimu-item-selector .jimu-tab3\x3e.container-node .jimu-item-table{top:40px; height: 100%;}.fullscreen-popup-container .control-node .jimu-state-active {color: #d84b28; border: none; border-bottom: 2px solid #d84b28;}.fullscreen-popup-container .container-node {min-height: 400px;}.fullscreen-popup-container .jimu-item-table .items-section {bottom:70px;}.fullscreen-popup-container .container-node .jimu-item-table .items-table-div {}.fullscreen-popup-container .container-node .tab-content .jimu-search {height: 40px; margin-top: 12px;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search {width: 16px; height: 16px; background: url("images/search.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .jimu-search .jimu-icon-search:hover {background: url("images/search_selected.png") center no-repeat;}.fullscreen-popup-container .container-node .tab-content .public-item-section{top: 35px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table {margin-top: 20px;}.fullscreen-popup-container .container-node .tab-content .items-table .jimu-item-table .item-thumbnail {width: 180px; height: 120px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-thumbnail:hover {border: 2px solid #0f95bc; border-radius: 0px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .item-info{left: 180px;}.fullscreen-popup-container .container-node .tab-content .jimu-item-table .items-table td {padding-bottom: 20px;}.fullscreen-popup-container .container-node .jimu-item-table .item-thumbnail{border: 2px solid transparent;}.fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{left: 2px; top: 1px; width: 176px; height: 112px;}.jimu-rtl .fullscreen-popup-container .container-node .jimu-item-table .items-table .item-border{right: 2px; left: auto;}.fullscreen-popup-container .container-node .jimu-item-table .item-border {border: 2px solid #15a4fa;;}.fullscreen-popup-container .container-node .item-info{width:180px; height:100px; margin: 10px 30px 0 10px;}.fullscreen-popup-container .container-node .item-border {border: 3px solid #15a4fa; -webkit-border-radius: 0; -moz-border-radius: 0; -o-border-radius: 0; -ms-border-radius: 0; border-radius: 0;}.fullscreen-popup-container .container-node .item-info .item-name{font-size: 18px; font-family: "Avenir Medium"; color: #333; line-height: 18px;}.fullscreen-popup-container .container-node .item-info .item-type-owner,.fullscreen-popup-container .container-node .item-info .item-date {margin-top: 10px; font-size: 12px; color: #666; line-height: 18px; overflow:hidden;}.fullscreen-popup-container .container-node .item-info .item-date{margin-top: 8px;}.app-list-page{width: 100%; height: 100%; position: relative;}.app-list-page .separate-line {height: 47px; border-bottom: 1px solid #cfd7d7;}.app-list-page .switch-app-template {top: 16px; position: relative; max-width: 1180px; min-width: 1024px; margin: 0 auto; font-size: 16px; color: #a3a3a3; font-weight: bold;}.app-list-page .switch-app-template .switch-btn-box {position: relative; display: inline-block; margin-right: 1px;}.app-list-page .switch-app-template .switch-btn {margin-right: 8px; margin-left: 8px; cursor: pointer; min-width: 80px; text-align: center;}.app-list-page .switch-app-template .switch-btn-box:hover {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected {color: #508dca;}.app-list-page .switch-app-template .switch-btn-box .blue-block {position: absolute; width: 100%; height: 4px; bottom: -8px;}.app-list-page .switch-app-template .switch-btn-box:hover .blue-block{background-color: #508dca;}.app-list-page .switch-app-template .switch-btn-box.selected .blue-block{background-color: #508dca;}.app-list-page .app-content{position: relative; max-width: 1180px; min-width: 1024px; margin: 50px auto; height: 100%;}.app-list-page .head-section {display: inline-block; width: 100%; padding-bottom: 30px;}.app-list-page .head-section .textPart1{margin-top: 15px; color: #6f7a8b; font-size: 18px;}.app-list-page .head-section .textPart2{margin-top: 20px; margin-left: 3px; color: #002157; font-size: 14px;}.jimu-rtl .app-list-page .head-section .textPart2{margin-right: 3px;}.app-list-page .head-section .create-button-div{height: 50px; position: relative; left: -16px; display: inline-block; padding-top: 8px;}.jimu-rtl .app-list-page .head-section .create-button-div{right: -16px;}.app-list-page .head-section .create-button{width: 140px; height: 37px; background-color: #518dca; border: 1px solid #348599; color: #ffffff; font-size: 15px; font-weight: bold; border-radius: 4px; cursor: pointer; box-shadow: 0px 1px 2px #a0acbf;} .app-list-page .app-content .list-section{position: absolute; top: 78px; width: 100%;} .app-list-page .app-content .list-section-head {table-layout: fixed; border-spacing: 0px; background-color: #6f7e95; width: 100%; height: 49px; border-top-left-radius: 4px; border-top-right-radius: 4px; box-shadow: 1px 1px 2px #a0acbf;}.app-list-page .app-content .list-section .head-content {}.app-list-page .app-content .list-section .head-content .name{width: 270px; color: #ffffff; font-size: 14px; border: 0px solid; padding-left: 25px;}.jimu-rtl .app-list-page .app-content .list-section .head-content .name{padding-right: 25px;}.app-list-page .app-content .list-section .head-content .desc{width: 300px; color: #ffffff; font-size: 14px; border: 0px solid;}.app-list-page .app-content .list-section .head-content .time{color: #ffffff; font-size: 14px; border: 0px solid; width: 150px;}.app-list-page .app-content .list-section .head-content .modified{color: #ffffff; font-size: 14px; border: 0px solid; width: 100px; display: none;}.app-list-page .app-content .list-section .head-content .creator{color: #ffffff; font-size: 14px; border: 0px solid;} .app-list-page .app-content .list-section-body{position: absolute; top: 127px; bottom: 150px; width: 100%; overflow: hidden;}.app-list-page .app-content .list-section-body-content{max-height: 100%; border: 1px solid #a0acbf; box-shadow: 1px 1px 2px #a0acbf; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;}.app-list-page .app-content .list-table{table-layout: fixed; border-spacing: 0px; width: 100%;}.app-list-page .app-content .list-table-item{height: 40px; background-color: #fafafa;}.app-list-page .app-content .list-table-item-add{}.app-list-page .app-content .list-table-item-mouseover{background-color: #e3ecf2;}.app-list-page .app-content .list-table-next-item-mouseover td{border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item-dbclick{background-color: #fffce4;}.app-list-page .app-content .list-table-item .item-first-td{width: 4px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-second-td{width: 16px; vertical-align: top;}.app-list-page .app-content .list-table-item .item-first-td-selected {background-color: #15a4fa;}.app-list-page .app-content .list-table-item .item-end-td{width: 4px;}.app-list-page .app-content .list-table-item .item-name-td{width: 250px; vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-name{overflow: hidden; color: #596679; font-size: 14px; border: 0px solid; width: 230px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-input-name{width: 230px; height: 30px; margin-left: 10px; margin-top: 5px; border: 1px solid #999999; background-color: #ffffff}.app-list-page .app-content .list-table-item .item-desc-td{width:300px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-desc{overflow: hidden; color: #596979; font-size: 14px; border: 0px solid; margin-right: 5px; width: 270px; max-height: 40px; min-height: 20px; margin-top: 10px; margin-bottom: 10px; line-height: 20px; white-space: normal; word-wrap: break-word; word-break: break-word;}.app-list-page .app-content .list-table-item .item-textarea-description{width: 285px; height: 82px; border: 1px solid #999999; resize: none; margin-top: 7px; margin-bottom: 7px;}.app-list-page .app-content .list-table-item .item-time-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 150px;}.app-list-page .app-content .list-table-item .item-time{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px; height: 40px;}.app-list-page .app-content .list-table-item .item-modified-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 100px; display: none;}.app-list-page .app-content .list-table-item .item-modified{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-creator-td{vertical-align: top; border-bottom: 2px solid #e3ecf2; width: 83px;}.app-list-page .app-content .list-table-item .item-creator{color: #7989a0; font-size: 14px; border: 0px solid; cursor: default; padding-top: 10px;}.app-list-page .app-content .list-table-item .item-loading-td{width: 14px; max-width: 14px; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-loading-td .loading-div{display: none; width: 14px;}.app-list-page .app-content .list-table-item .item-operations-td{vertical-align: top; border-bottom: 2px solid #e3ecf2;}.app-list-page .app-content .list-table-item .item-operations-div{border: 0px solid; width: 190px; margin: 0px 0px 0px auto; color: #A0acbf; font-size: 14px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-operations-div{margin: 0px auto 0px 0px;}.app-list-page .app-content .list-table-item .item-edit{border: 0px solid; margin-right: 5px; cursor: pointer; height: 40px; width: 65px; background-image: url("images/edit_icon01.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit{margin-left: 5px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-edit:hover{background-image: url("images/edit_icon02.png"); color: #518dca !important;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-image{}.app-list-page .app-content .list-table-item .item-edit-text{line-height: 40px; padding-left: 17px; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.jimu-rtl .app-list-page .app-content .list-table-item .item-edit-text{padding-right: 17px; padding-left: 0;}.app-list-page .app-content .list-table-item .item-preview{border: 0px solid; margin-right: 0px; cursor: pointer; width: 80px; height: 40px; line-height: 40px; background-image: url("images/launch2.png"); background-repeat: no-repeat; background-position: center left; overflow: hidden;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview{margin-left: 0px; margin-right: auto; background-position: center right;}.app-list-page .app-content .list-table-item .item-preview:hover{background-image: url("images/launch3.png"); color: #518dca !important;}.app-list-page .app-content .list-table-item .item-preview a{text-decoration: none; color: inherit; display: inline-block; padding-left: 19px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 100%;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview a{padding-right: 24px; padding-left: 0px;}.app-list-page .app-content .list-table-item .item-preview img{margin-top: 13px; margin-right: 5px;}.jimu-rtl .app-list-page .app-content .list-table-item .item-preview img{margin-left: 13px; margin-right: auto;}.app-list-page .app-content .list-table-item .item-more{height: 40px; width: 38px; text-align: center; cursor: pointer; background-image: url("images/moreaction_icon.png"); background-repeat: no-repeat; background-position: center center; overflow: hidden;}.app-list-page .app-content .list-table-item .item-more-selected{background-image: url("images/moreaction_icon1.png") !important;}.app-list-page .app-content .list-table-item .item-more:hover{background-image: url("images/moreaction_icon1.png");}.app-list-page .app-content .list-table-item .item-more-image{margin-top: 18px;}.app-list-page .app-menu {position: absolute; background-color:#354052; width:160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-list-page .app-menu .item{width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-list-page .app-menu .item{padding-right: 20px; padding-left: 0px;}.app-list-page .app-menu .item.border-top-radius{border-top-left-radius:5px; border-top-right-radius:5px;}.app-list-page .app-menu .item.border-bottom-radius{border-bottom-left-radius:5px; border-bottom-right-radius:5px;}.app-list-page .app-menu .item a{text-decoration: none; color: inherit;}.app-list-page .app-menu .up-triangle{position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-list-page .app-menu .up-triangle{left: 20px; right: auto;}.app-list-page .app-menu .down-triangle{position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-list-page .app-menu .down-triangle{left: 20px; right: auto;}.app-list-page .app-menu .item:hover{background-color: #6f7e95; color: #ffffff;}.edit-app-info-content {color: #4d4d4d; font-size: 14px; font-family: monospace;}.edit-app-info-content .app-thumbnail {width: 200px; height: 133px; margin-top:20px; margin-left: 30px; display: inline-block;}.edit-app-info-content .app-name {margin-left: 30px;}.edit-app-info-content .app-description {margin-left: 30px; margin-top: 20px;}.edit-app-info-content .dijitTextBox {}.edit-app-info-content .dijitTextBoxFocused {border-color: #406b9b !important; box-shadow: 0 0 0 #ffffff !important;}.edit-app-info-content .dijitTextBoxHover{background-color: #ffffff; background-image: none;}.edit-app-info-content .dijitInputField {line-height: 15px !important; padding: 0 0 0 !important;}.edit-app-info-content .dijitTextBox .dijitInputInner{height: 23px;}.edit-app-info-content .app-name .name-text-box{width: 95%; padding: 2px;}.edit-app-info-content .app-description .desc-text-area{width: 95%; max-width: 95%; min-width: 95%; height: 200px; max-height: 200px; min-height: 200px; padding: 2px; resize: none;}.dj_ie8 .app-list-page .app-content .list-section-head,.dj_ie8 .app-list-page .app-content .list-section-body-content{filter: progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue); -ms-filter: "progid:dXImageTransform.Microsoft.DropShadow(color\x3d#a0acbf,offX\x3d1,offY\x3d1,positives\x3dtrue)";}.app-catalog-page {width: 100%; height: 100%; position: relative; overflow: hidden; background-color: #f8f9fb;}.app-catalog-page .app-content {position: relative; max-width: 1300px; min-width: 1024px; margin: 0 auto; height: 100%; min-height: 340px; padding-top: 20px; padding-left: 20px; padding-right: 20px;}.app-catalog-page .app-content .list-table {table-layout: fixed; border-spacing: 0; width: 100%;}.app-catalogs.list-table-item {}.item-td {}.app-catalog-page .app-catalogs .catalog {background-color: #fff; height: 120px; width: 100%; margin: 0 auto 10px; -moz-box-shadow: 0 0 12px rgba(0, 0, 0, .1); -webkit-box-shadow: 0 0 12px rgba(0, 0, 0, .1); box-shadow: 0 0 12px rgba(0, 0, 0, .1);}.app-catalog-page .app-catalogs .catalog .content-theme {height: 100%; width: 180px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {width: 4px; position: absolute; left: 0; height: 100%;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-color {right: 0;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {position: absolute; top: 0px; left: 0px; width: 100%; height: 120px; background-size: 100% 100%; background-repeat: no-repeat; background-position: center; cursor: pointer;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg{position: absolute; width: 26px; height: 22px; bottom: 10px; left: 140px; background-position: center; background-repeat: repeat; display: block; z-index: 10;}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-2D{background-image: url("images/flag_2d.png");}.app-catalog-page .app-catalogs .catalog .content-theme .content-theme-flagImg-3D{background-image: url("images/flag_3d.png");}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-theme .content-theme-icon {left: auto; right: 0px;} .app-catalog-page .app-catalogs .catalog .content-opers {height: 100%; width: 198px; position: relative;}.app-catalog-page .app-catalogs .catalog .content-opers:before {background-color: #e5e5e5; content: ""; position: absolute; top: 20px; width: 1px; height: 80px;}.app-catalog-page .app-catalogs .catalog .content-opers-btns {margin: 44px 0 44px 20px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .content-opers-btns {margin-left: 0; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn {display: inline-block; position: relative; width: 32px; height: 32px; border: 2px solid #999; -moz-border-radius: 16px; -webkit-border-radius: 16px; border-radius: 16px; margin-right: 10px;}.app-catalog-page .app-catalogs .catalog .content-opers-btn:hover {cursor: pointer; border: 2px solid #333;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download {background: url("images/download.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-download:hover {background: url("images/download_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit {background: url("images/edit.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-edit:hover {background: url("images/edit_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch {background: url("images/view.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-launch:hover {background: url("images/view_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more {background: url("images/more.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more:hover {background: url("images/more_hover.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content-opers-btns-more.content-opers-btns-more-selected {border: 2px solid #0f95bc; background: url("images/more_selected.png") center no-repeat;}.app-catalog-page .app-catalogs .catalog .content {margin: 20px 20px 20px 30px;}.catalog-content {padding: 20px 20px 20px 200px;}.jimu-rtl .catalog-content {padding-right: 180px; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head {}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {left: 0px; font-family: "Avenir Medium"; font-size: 14px; color: #333; display: inline-block; max-width: 550px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appname {padding-right: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 20px; font-size: 12px; display: inline-block;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo {padding-right: 0; padding-left: 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-time {font-family: "Avenir Light"; color: #999; padding-top: 1px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner {font-family: "Avenir Light"; color: #999; position: relative; padding: 0 20px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {background-color: #e5e5e5; content: ""; position: absolute; top: 5px; left: 10px; width: 1px; height: 10px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner:before {content: ""; left: 0; right: 10px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {font-family: "Avenir Light"; color: #999; line-height: 18px; display: inline-block; vertical-align: top; padding-right: 6px;}.jimu-rtl .app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-tip {padding-left: 6px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-owner-name{display: inline-block; max-width: 100px; padding-top: 1px; height: 18px; line-height: 18px;}.app-catalog-page .app-catalogs .catalog .catalog-content-head .catalog-content-appinfo-type {font-family: "Avenir Medium"; color: #31a6e0;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis {padding: 10px 20px 0 0; font-family: "Avenir Light"; font-size: 14px; color: #333; word-wrap: break-word; word-break: break-all; overflow: hidden; height: 70px;}.app-catalog-page .app-catalogs .catalog .catalog-content-dis.place-holder-class {color: #cccccc;}.app-catalog-page .app-menu {position: absolute; background-color: #354052; width: 160px; border: 1px solid #dddddd; box-shadow: 0px 0px 6px #dddddd; z-index: 1; border-radius: 5px;}.app-catalog-page .app-menu .item {width: 100%; min-height: 30px; padding-left: 20px; border: 0px solid; color: #a0acbf; font-size: 14px; cursor: pointer; padding-top: 12px; padding-bottom: 12px;}.jimu-rtl .app-catalog-page .app-menu .item {padding-right: 20px; padding-left: 0px;}.app-catalog-page .app-menu .item.border-top-radius {border-top-left-radius: 5px; border-top-right-radius: 5px;}.app-catalog-page .app-menu .item.border-bottom-radius {border-bottom-left-radius: 5px; border-bottom-right-radius: 5px;}.app-catalog-page .app-menu .item a {text-decoration: none; color: inherit;}.app-catalog-page .app-menu .up-triangle {position: absolute; width: 18px; height: 11px; top: -10px; right: 20px; background: url("images/up_triangle.png");}.jimu-rtl .app-catalog-page .app-menu .up-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .down-triangle {position: absolute; width: 18px; height: 11px; right: 20px; background: url("images/down_triangle.png"); display: none; background-repeat: no-repeat;}.jimu-rtl .app-catalog-page .app-menu .down-triangle {left: 20px; right: auto;}.app-catalog-page .app-menu .item:hover {background-color: #6f7e95; color: #ffffff;}.app-card-page {position: relative; overflow: hidden;}.app-card-page .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.app-card-page .app-card-box {position: relative; width: 300px; height: 170px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.app-card-page .app-card-box .card {height: 100%; width: 100%;}.app-card-page .app-card-box .app-info-card {}.app-card-page .app-card-box .app-info-card .app-style-part {width: 100%; height: 4px;}.app-card-page .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 125px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .app-card-page .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon-td {width: 110px; height: 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon {width: 80px; height: 80px; border: 2px solid #e5e5e5; border-radius: 10px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.app-card-page .app-card-box .app-info-card .app-title-part .app-icon.default-icon {background-size: 50px 50px;}.app-card-page .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 20px; max-height: 38px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 16px; color: #333333; font-weight: bold;}.app-card-page .app-card-box .app-info-card .app-title-part .app-time-div {margin-top: 20px; color: #999999; font-size: 12px; line-height: 12px;}.app-card-page .app-card-box .app-des-card {position: absolute; width: 100%; height: 125px; top: 4px; left: 0; display: block; opacity: 0;}.app-card-page .app-card-box .app-des-card .app-des-part {width: 100%; height: 100%;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name{width: 100%; height: 75px;}.app-card-page .app-card-box .app-des-card .app-des-part .app-name-div{max-height: 48px; line-height: 16px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.app-card-page .app-card-box .app-des-card .app-des-part .app-info-div{padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; line-height: 13px; margin-top: 10px; overflow: hidden;}.app-card-page .app-card-box .app-des-card .app-des-part .app-des{width: 100%; height: 50px; overflow: hidden; line-height: 16px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.app-card-page .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .app-card-page .app-card-box .app-operation-part {right: 10px; left: auto;}.app-card-page .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.app-card-page .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.app-card-page .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.app-card-page .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.app-card-page .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.app-card-page .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.app-card-page .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.app-card-page .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.app-card-page .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.app-card-page .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.app-card-page .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}.template-card-page {position: relative; overflow: hidden;}.template-card-page .template-card-page-content {max-width: 1300px; min-width: 1024px; margin: 20px auto 0; overflow: hidden; padding-left: 20px; min-height: 340px;}.template-card-page .template-card {position: relative; width: 300px; height: 320px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.template-card-page .template-card .template-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .template-card-page .template-card .template-type-div {right: auto; left: 5px;}.template-card-page .template-card .template-type-2d {background-image: url("images/flag_2d.png");}.template-card-page .template-card .template-type-3d {background-image: url("images/flag_3d.png");}.template-card-page .template-card .thumbnail-part {width: 100%; height: 180px; background-repeat: no-repeat; background-position: center;}.template-card-page .template-card .appInfo-part {width: 100%; height: 99px;}.template-card-page .template-card .appInfo-part .template-name {width: 100%; height: 40px;}.template-card-page .template-card .appInfo-part .template-name-div {max-height: 40px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 18px; color: #333333; font-family: "Avenir Medium"; font-weight: bold;}.template-card-page .template-card .appInfo-part .template-des-div {width: 100%; height: 57px; overflow: hidden; line-height: 18px; font-size: 14px; color: #666666; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px;}.template-card-page .template-card .template-operation-part {position: relative; position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .template-card-page .template-card .template-operation-part {right: 10px; left: auto;}.template-card-page .template-card .template-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.template-card-page .template-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.template-card-page .template-card .launch-operation:hover {background-image: url("images/view_hover.png");}.template-card-page .template-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.template-card-page .template-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.template-card-page .template-card .edit-operation.disable {display: none;}.template-card-page .template-card .template-operation a{display: inline-block; width: 100%; height: 100%;}.template-card-page .template-card .create-app-from-template-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.template-card-page .template-card .create-app-from-template-operation:hover {background-image: url("images/add_hover.png");}.template-card-page .template-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.template-card-page .template-card .more-operation:hover {background-image: url("images/more_hover.png");}.template-card-page .template-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.template-card-page .template-card .more-operation.disable {display: none;}.card-page {position: relative; overflow: hidden;}.card-page .card-page-content {max-width: 1300px; min-width: 1024px; margin: 0px auto 0; padding-top: 20px; overflow: hidden; padding-left: 20px; min-height: 340px;}.card-page .item-card {position: relative; width: 300px; height: 350px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page .item-card .item-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 22px; bottom: 10px; right: 5px;}.jimu-rtl .card-page .item-card .item-type-div {right: auto; left: 5px;}.card-page .item-card .item-type-2d {background-image: url("images/flag_2d.png");}.card-page .item-card .item-type-3d {background-image: url("images/flag_3d.png");}.card-page .item-card .thumbnail-part {position: relative; display: inline-block; width: 100%; height: 200px; background-repeat: no-repeat; background-position: center; background-size: 100% 100%;}.card-page .item-card .appInfo-part {width: 100%; height: 109px; overflow: hidden;}.card-page .item-card .appInfo-part .item-name {width: 100%; height: 60px;}.card-page .item-card .appInfo-part .item-name-div {max-height: 39px; line-height: 20px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-left: 20px; padding-right: 20px; font-size: 14px; color: #333333; font-family: "Avenir Medium"; font-weight: bold; margin-top: 9px;}.card-page .item-card .appInfo-part .item-info-div {padding-left: 20px; padding-right: 20px; color: #999999; font-size: 12px; margin-top: 10px; margin-bottom: 9px; overflow: hidden;}.card-page .item-card .desc-wrap{padding-left: 20px; padding-right: 20px;}.card-page .item-card .appInfo-part .item-des-div {width: 100%; overflow: hidden; line-height: 22px; font-size: 12px; color: #666666; white-space: normal; word-wrap: break-word;}.card-page .item-card .appInfo-part .item-des-div.place-holder-class {color: #cccccc;}.card-page .item-card .item-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page .item-card .item-operation-part {right: 10px; left: auto;}.card-page .item-card .item-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page .item-card .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page .item-card .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page .item-card .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page .item-card .download-operation:hover {background-image: url("images/download_hover.png");}.card-page .item-card .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page .item-card .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page .item-card .edit-operation.disable {display: none;}.card-page .item-card .item-operation a{display: inline-block; width: 100%; height: 100%;}.card-page .item-card .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page .item-card .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page .item-card .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page .item-card .more-operation:hover {background-image: url("images/more_hover.png");}.card-page .item-card .more-operation.item-more-selected{background-image: url("images/more_selected.png");}.card-page .item-card .more-operation.disable {display: none;}.card-page-with-small-thumbnail {position: relative; overflow: hidden;}.card-page-with-small-thumbnail .app-card-page-content {max-width: 1300px; min-width: 1024px; margin: 0 auto 0; overflow: hidden; padding-left: 20px; padding-top: 20px; min-height: 340px;}.card-page-with-small-thumbnail .app-card-box {position: relative; width: 300px; height: 220px; margin-right: 20px; margin-bottom: 20px; background-color: #ffffff; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;}.card-page-with-small-thumbnail .app-card-box .card {height: 100%; width: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card {}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part {position: relative; width: 100%; height: 120px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {position: absolute; background-repeat: no-repeat; background-position: center; width: 30px; height: 20px; top: 5px; right: 5px;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-div {right: auto; left: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-2d {background-image: url("images/flag_2d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-type-3d {background-image: url("images/flag_3d.png");}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-table {width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail-td {width: 155px; height: 100%;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {width: 120px; height: 80px; border-radius: 4px; display: block; background-repeat: no-repeat; background-position: center; margin-left: 20px; background-size: 100% 100%;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-thumbnail {margin-left: auto; margin-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-td {display: inline-block;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-title-div {line-height: 16px; max-height: 32px; overflow: hidden; white-space: normal; word-wrap: break-word; word-break: break-word; padding-right: 10px; font-family: "Avenir Medium"; font-size: 14px; color: #333333; font-weight: bold; margin-top: 25px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-time-div {color: #999999; font-size: 12px; line-height: 12px; margin-top: 14px; margin-bottom: 10px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-title-part .app-creator-div {color: #999999; font-size: 12px; line-height: 12px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-box {position: relative; width: 100%; height: 59px; padding-left: 20px; padding-right: 20px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {width: 100%; overflow: hidden; line-height: 18px; font-size: 12px; color: #666666; white-space: normal; padding-top: 5px;}.card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part.place-holder-class {color: #cccccc;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-info-card .app-desc-part {}.card-page-with-small-thumbnail .app-card-box .app-operation-part {position: relative; width: 280px; height: 41px; left: 10px; border-top: 1px solid #e5e5e5;}.jimu-rtl .card-page-with-small-thumbnail .app-card-box .app-operation-part {right: 10px; left: auto;}.card-page-with-small-thumbnail .app-card-box .app-operation {background-repeat: no-repeat; background-position: center; overflow: hidden; cursor: pointer;}.card-page-with-small-thumbnail .app-card-box .app-operation.disable {display: none;}.card-page-with-small-thumbnail .app-card-box .download-operation {height: 40px; width: 40px; background-image: url("images/download.png");}.card-page-with-small-thumbnail .app-card-box .download-operation:hover {background-image: url("images/download_hover.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation {height: 40px; width: 40px; background-image: url("images/edit.png");}.card-page-with-small-thumbnail .app-card-box .edit-operation:hover {background-image: url("images/edit_hover.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation {height: 40px; width: 40px; background-image: url("images/view.png");}.card-page-with-small-thumbnail .app-card-box .launch-operation:hover {background-image: url("images/view_hover.png");}.card-page-with-small-thumbnail .app-card-box .app-operation a{display: inline-block; width: 100%; height: 100%;}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation{height: 40px; width: 40px; background-image: url("images/add.png");}.card-page-with-small-thumbnail .app-card-box .create-app-from-item-operation:hover {background-image: url("images/add_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation {height: 40px; width: 40px; background-image: url("images/more.png");}.card-page-with-small-thumbnail .app-card-box .more-operation:hover {background-image: url("images/more_hover.png");}.card-page-with-small-thumbnail .app-card-box .more-operation.item-more-selected {background-image: url("images/more_selected.png");}body{background-color: white;}#main-view-stack{position: absolute; top: 40px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #E3ECF2;}.plugin-app-list {position: relative; background-color: #f8f9fb;}.plugin-app-list .header {width: 100%; background-color: #ffffff;}.plugin-app-list .header .navigator-box{width: 100%; height: 50px; border-bottom: 1px solid #e5e5e5;}.plugin-app-list .header .navigator{position: relative; min-width: 1024px; max-width: 1300px; padding-left: 20px; padding-right: 20px; height: 50px; margin: 0 auto;}.plugin-app-list .header .navigator .filter-box{}.plugin-app-list .header .navigator .filter{margin-right:10px; height: 50px; line-height: 50px; color: #999999; font-size: 14px; min-width: 40px; text-align: center;}.jimu-rtl .plugin-app-list .header .navigator .filter{margin-left: 10px; margin-right: auto;}.plugin-app-list .header .navigator .filter.selected{color: #d84b28; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .filter:hover{color: #d84b28; cursor: pointer; border-bottom: 2px solid #d84b28;}.plugin-app-list .header .navigator .sort-box{padding-left: 20px; padding-right: 20px;}.plugin-app-list .header .navigator .sort {margin-right: 15px; height: 50px; width: 16px; background-repeat: no-repeat; background-position: center; cursor: pointer;}.plugin-app-list .header .navigator .sort-box .by-modified-time {background-image: url(images/most_recent.png);}.plugin-app-list .header .navigator .sort.by-modified-time.selected{background-image: url(images/most_recent_selected.png);}.plugin-app-list .header .navigator .sort.by-modified-time:hover{background-image: url(images/most_recent_hover.png);}.plugin-app-list .header .navigator .sort-box .by-name {background-image: url(images/by_name.png);}.plugin-app-list .header .navigator .sort.by-name.selected{background-image: url(images/by_name_selected.png);}.plugin-app-list .header .navigator .sort.by-name:hover{background-image: url(images/by_name_hover.png);}.plugin-app-list .header .navigator .sort-box .by-author {background-image: url(images/by_author.png);}.plugin-app-list .header .navigator .sort.by-author.selected{background-image: url(images/by_author_selected.png);}.plugin-app-list .header .navigator .sort.by-author:hover{background-image: url(images/by_author_hover.png);}.plugin-app-list .header .navigator .author-filter-box {height: 50px; position: relative; font-size: 14px;}.plugin-app-list .header .navigator .author-filter-box .author-filter {height: 30px; margin-top: 10px; display: inline-block; padding: 0 30px 0 10px; line-height: 30px; border-radius: 15px; cursor: pointer;}.jimu-rtl .plugin-app-list .header .navigator .author-filter-box .author-filter {padding: 0 10px 0 30px;}.plugin-app-list .header .navigator .author-filter-box .dropdowmenu-btn{position: absolute; right: 10px; top: 17px; background-image: url(images/v2.png); background-repeat: no-repeat; background-position: center center;}.jimu-rtl .plugin-app-list .header .navigator .author-filter-box .dropdowmenu-btn{right: auto; left: 10px;}.plugin-app-list .header .navigator .author-filter-box .dropdowmenu-btn:hover{background-image: url(images/v2.png);}.jimu-dijit-dropdownmenu-items-container.authorFilterSelector{min-width: 140px; max-width: none;}.jimu-dijit-dropdownmenu-items-container.authorFilterSelector .dropdown-menu-item.selected{background-color: #555;}.plugin-app-list .header .navigator .search{width: 300px; border: 1px solid #e5e5e5; border-radius: 15px; margin-top: 10px; padding-left: 5px;}.plugin-app-list .header .navigator .search .search-box{height: 30px; width: 250px; border: 0 solid; border-radius: 25px;}.plugin-app-list .header .navigator .search .search-box.dijitText{border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxFocused {border-color: #ffffff !important; box-shadow: 0 0 0 #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box.dijitTextBoxHover{background-color: #ffffff !important; border-color: #ffffff !important; background-image: none;}.plugin-app-list .header .navigator .search .search-box .dijitInputContainer {margin: 1px 5px;}.plugin-app-list .header .navigator .search .search-box .dijitInputInner{box-shadow: 0px 0px 0px #FFF !important;}.plugin-app-list .header .navigator .search .search-box .dijitPlaceHolder{font-style: normal;}.plugin-app-list .header .navigator .search .search-btn{width: 40px; height: 30px; background-image: url(images/search_normal.svg); background-repeat: no-repeat; background-position: center center;}.plugin-app-list .switch-app-page-box {position: absolute; right: 20px; bottom: 20px; z-index: 1;}.jimu-rtl .plugin-app-list .switch-app-page-box {left: 20px; right: auto;}.plugin-app-list .switch-app-page-box.hidden {display: none;}.plugin-app-list .switch-app-page-box .switch-app-page-btn {width: 21px; height: 21px; background-repeat: no-repeat; background-position: center center; cursor: pointer;}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page:hover {background-image: url(images/card_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page {background-image: url(images/catalog.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page.selected {background-image: url(images/catalog_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.catalog-page:hover {background-image: url(images/catalog_hover.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2 {background-image: url(images/card.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2.selected {background-image: url(images/card_selected.png);}.plugin-app-list .switch-app-page-box .switch-app-page-btn.card-page2:hover {background-image: url(images/card_hover.png);}.plugin-app-list .operation-box{position: relative; min-width: 1024px; max-width: 1300px; margin: 0 auto; height: 60px; padding-left: 20px; padding-right: 20px; padding-top: 20px;}.plugin-app-list .create{width: 150px; height: 40px; line-height: 40px; background-color: #31aacd; color: #ffffff; font-size: 14px; font-weight: bold; border-radius: 2px; cursor: pointer; text-align: center; margin-right: 20px;}.plugin-app-list .create:hover{background-color: #1b91b3;}.jimu-rtl .plugin-app-list .create{margin-left: 20px; margin-right: auto;}.plugin-app-list .content-box {position: absolute; left: 0; right: 0; top: 50px; bottom: 0; overflow: auto;}.plugin-app-list .content {display: none; min-height: 540px;}.plugin-app-list .content.selected{display: block;}.plugin-app-list .content .app-page-box {height: 100%; display: none;}.plugin-app-list .content .app-page-box.selected {display: block;}.plugin-app-list .footer {color: #999999; font-size: 12px; overflow: hidden; text-align: center;}.plugin-app-list .footer .footer-text {padding-left: 20px; padding-right: 20px; margin: 120px auto 30px; text-align: center; display: inline-block;}.plugin-app-list .footer .separator {margin-left: 5px; margin-right: 5px; font-weight: bold;}.plugin-app-list .footer a {text-decoration: none; color: #999999;}.plugin-app-list .empty-description-box {text-align: center; margin-top: 210px;}.plugin-app-list .empty-description-box.card-page{padding-right: 20px;}.plugin-app-list .empty-description {display: inline-block; text-align: left; color: #999999; font-size: 16px; font-family: "Avenir Medium"; line-height: 26px;}.plugin-app-list .empty-description span{color: #000000;}.fullscreen-popup-container .content .image-chooser-container{width: 150px; margin: 0 auto; padding: 30px 0; text-align: center; position: relative;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate{width: 300px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker{position: absolute; display: none; background-color: rgba(0,0,0,.8); text-align: center; font-size: 14px; color: #fff; z-index: 9999; cursor:pointer;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .image-chooser-base{width: 150px; height: 150px; background-color: #31aacd; border-radius: 50%;}.fullscreen-popup-container .content .image-chooser-container.imageChooserApp .jimu-image-chooser{width: 80px; height: 80px; background-color: #f7fafa; border-radius: 10px; margin-top: 35px;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserApp{width: 150px; height: 150px; border-radius: 50%; line-height: 150px;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .image-chooser-base{width: 330px; height: 230px; border: 1px solid #ccc; border-radius: 4px; background-size: 100% 100%; padding: 10px; background-color: #fff;}.fullscreen-popup-container .content .image-chooser-container.imageChooserTemplate .jimu-image-chooser{width: 100%; height: 100%;}.fullscreen-popup-container .content .image-chooser-container .image-chooser-masker.imageChooserTemplate{width: 330px; height: 230px; line-height: 210px; border-radius: 5px;}.fullscreen-popup-container .content .app-info-edit label{display: block; font-size: 14px; color:#333;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-name{height:40px; line-height: 40px; width: 100%; margin: 15px 0 30px 0;}.fullscreen-popup-container .content .app-info-edit .app-info-edit-summary{height:100px; width: 100%; margin: 15px 0 30px 0; padding: 5px 10px; font-size: 12px; font-family: "Avenir Light";}.jimu-popup.jimu-popup-in-home .jimu-btn{background-color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn:hover{background-color: #1b91b3;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation{background-color: #FFFFFF; border: 1px solid #31aacd; color: #31aacd;}.jimu-popup.jimu-popup-in-home .jimu-btn.jimu-btn-vacation:hover{background-color: #f4f4f4;}',
"url:builder/plugins/attribute-config/Plugin.html":'\x3cdiv class\x3d"attribute-config" \x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attributeSection"\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading header-section" data-dojo-attach-point\x3d"headerSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.headerTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.headerDesc}\x3c/div\x3e\r\n\r\n      \x3cdiv data-dojo-attach-point\x3d"logoNodeDiv"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"titles jimu-float-leading"\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"title" data-dojo-attach-point\x3d"titleNodeDiv"\x3e\r\n          \x3cinput placeholder\x3d"${nls.title}" data-dojo-attach-point\x3d"titleNode" maxLength\x3d"100" class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor" title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onTitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"background-color:#fafafc;" class\x3d"subtitle" data-dojo-attach-point\x3d"subtitleNodeDiv"\x3e\r\n          \x3cinput  placeholder\x3d"${nls.subtitle}" data-dojo-attach-point\x3d"subtitleNode" maxLength\x3d"100"  class\x3d"styled-text"\x3e\r\n          \x3cspan class\x3d"label-editor"  title\x3d"${nls.formatStyle}" data-dojo-attach-event\x3d"click:onSubtitleEditorClick"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading links-section" data-dojo-attach-point\x3d"linksSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.linksTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cdiv class\x3d"list-header"\x3e\r\n          \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddLinkClick"\x3e${nls.addLink}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditLinkClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n          \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteLinkClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"links-list" data-dojo-attach-point\x3d"linksListNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading appId-section" data-dojo-attach-point\x3d"appIdSection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appIdTitle}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3ca target\x3d"_blank" href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.appIdAbout}\x3c/a\x3e\r\n      \x3cdiv class\x3d"attribute-content"\x3e\r\n        \x3cinput type\x3d"text" placeholder\x3d"AppId" data-dojo-attach-point\x3d"appIdNode" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading" data-dojo-attach-point\x3d"useProxySection" style\x3d"display:none"\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"useProxySetting"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-section" data-dojo-attach-point\x3d"proxySection"\x3e\r\n        \x3clabel class\x3d"rules-label"\x3e${nls.proxyRulesLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"attribute-content"\x3e\r\n          \x3cdiv class\x3d"list-header"\x3e\r\n            \x3cspan class\x3d"header-button add" data-dojo-attach-event\x3d"onclick: onAddProxyRuleClick"\x3e${nls.addProxyRule}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button edit" data-dojo-attach-event\x3d"onclick: onEditProxyRuleClick"\x3e${nls.editLabel}\x3c/span\x3e\r\n            \x3cspan class\x3d"header-button delete" data-dojo-attach-event\x3d"onclick: onDeleteProxyRuleClick"\x3e${nls.deleteLabel}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-header"\x3e\r\n            \x3cdiv class\x3d"prefix"\x3e${nls.prefixHeader}\x3c/div\x3e\r\n            \x3cdiv class\x3d"proxy-url"\x3e${nls.proxyUrlHeader}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"proxy-rule-list" data-dojo-attach-point\x3d"proxyRulesListNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"always-use-proxy" data-dojo-attach-point\x3d"alwaysUseProxy"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"attribute-content" data-dojo-attach-point\x3d"proxyUrlSection" \x3e\r\n          \x3cinput type\x3d"text" placeholder\x3d"${nls.proxyUrl}" data-dojo-attach-point\x3d"proxyUrlNode" /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading section-appstate"\r\n         data-dojo-attach-point\x3d"appStateController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appState}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e\r\n        \x3cdiv class\x3d"appstate-check" data-dojo-attach-point\x3d"appStateSetting"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Additional Data Sources --\x3e\r\n    \x3cdiv class\x3d"section jimu-float-leading datasources"\r\n        data-dojo-attach-event\x3d"click:_openDataSourcesPage" data-dojo-attach-point\x3d"dataSourceSection"\x3e\r\n        \x3cdiv class\x3d"title"\x3e\r\n          \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n          \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing icon-arrow-right"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"action-text"\x3e${nls.dataSourceIntroduce}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-loading"\r\n         data-dojo-attach-point\x3d"loadingPageController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.setLoadingPage}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section jimu-float-leading controller-appproxy"\r\n         data-dojo-attach-point\x3d"appProxyController"\x3e\r\n      \x3cdiv class\x3d"title"\x3e\r\n        \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n        \x3cdiv class\x3d"arrow-forward feature-action jimu-float-trailing"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"action-text"\x3e${nls.configureAppProxy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading loadingpage-section"\r\n       data-dojo-attach-point\x3d"loadingPageSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.loadingPageTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.backgroudColor}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgColorPicker"\r\n             data-dojo-type\x3d"jimu/dijit/ColorPicker" title\x3d"${nls.selectBackgoundColor}"\r\n             class\x3d"bgColor-control" class\x3d"jimu-float-trailing"\r\n             data-dojo-props\x3d"showLabel:true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"bgUploaderDiv" class\x3d"jimu-leading-margin2"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"bgImageChooser"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"config-part"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifCheckBoxDiv"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"gifModeSection" class\x3d"jimu-leading-margin2" style\x3d"margin-top:10px;"\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"selectMode"\r\n            data-dojo-attach-event\x3d"onclick: _onSelectGifMode"/\x3e\r\n        \x3clabel\x3e${nls.selectPredefinedGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"predefinedGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifSelect" style\x3d"margin-top:10px;"\r\n                  data-dojo-type\x3d"dijit/form/Select"\x3e\r\n            \x3cspan value\x3d"0"\x3e${nls.selectGif}\x3c/span\x3e\r\n            \x3cspan value\x3d"1"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"29" style\x3d"margin-top:2px;" src\x3d"${folderUrl}images/loading1.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"2"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"58" height\x3d"10" style\x3d"margin-top:12px;" src\x3d"${folderUrl}images/loading2.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"3"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"32" height\x3d"32" src\x3d"${folderUrl}images/loading3.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n            \x3cspan value\x3d"4"\x3e\r\n              \x3cdiv style\x3d"background:#3bb6d5;height:34px;"\x3e\r\n                \x3cimg width\x3d"34" height\x3d"34" src\x3d"${folderUrl}images/loading4.gif"/\x3e\r\n              \x3c/div\x3e\r\n            \x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput class\x3d"jimu-radio-btn" name\x3d"gifMode" type\x3d"radio" data-dojo-attach-point\x3d"uploadMode"\r\n            data-dojo-attach-event\x3d"onclick: _onUploadGifMode"\r\n            style\x3d"margin-top:10px;"/\x3e\r\n        \x3clabel\x3e${nls.uploadCustomGif}\x3c/label\x3e\x3cbr/\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customGif" class\x3d"jimu-leading-margin2" style\x3d"display:none;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"gifImageChooser"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading appproxy-section"\r\n       data-dojo-attach-point\x3d"appProxySection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"attribute-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading" data-dojo-attach-point\x3d"backController2"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.appProxy}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section" data-dojo-attach-point\x3d"mapSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.mapLayers}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.mapLayersNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"mapProxyContent"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin" data-dojo-attach-point\x3d"urlSection"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.customUrls}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note"\x3e${nls.customUrlsNote}\x3c/div\x3e\r\n      \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"linkEditorNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sub-section double-margin"\x3e\r\n      \x3cdiv class\x3d"title"\x3e${nls.note}\x3c/div\x3e\r\n      \x3cdiv class\x3d"note-content"\x3e\r\n        ${nls.creditsNote}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"loading"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"jimu-float-leading datasources-section" data-dojo-attach-point\x3d"datasourcesSection" style\x3d"display:none"\x3e\r\n    \x3cdiv class\x3d"datasources-link"\x3e\r\n      \x3cdiv class\x3d"arrow-back feature-action jimu-float-leading icon-arrow-back" data-dojo-attach-point\x3d"backMapController"\r\n      data-dojo-attach-event\x3d"click:_closeDataSourcesPage"\x3e\x3c/div\x3e\r\n      \x3cspan\x3e${nls.customDataSource}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"additionalDataSourcesDiv" style\x3d"width: 100%;height: 100%;overflow:hidden;"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/attribute-config/AttrbuteLogoChooser.html":'\x3cdiv class\x3d"jimu-float-leading jimu-trailing-margin1" data-dojo-attach-point\x3d"logoContainer"\r\n data-dojo-attach-event\x3d"onmouseenter:onMouseEnterHandler"\r\n data-dojo-attach-event\x3d"onmouseleave:onMouseLeaveHandler"\x3e\r\n  \x3cdiv data-dojo-type\x3d"jimu/dijit/ImageChooser" data-dojo-attach-point\x3d"imageChooser"\r\n  data-dojo-props\x3d"cropImage:false,showSelfImg:true,stretchImg:false,goldenWidth:30,goldenHeight:30,format:[\'image/gif\',\'image/png\',\'image/jpeg\']"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-logo" data-dojo-attach-point\x3d"addLogoNode"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"masker-node" data-dojo-attach-point\x3d"maskerNode"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"remove-logo" data-dojo-attach-point\x3d"removeLogoNode" data-dojo-attach-event\x3d"onclick:onRemoveLogoHandler"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TooltipDialog.html":'\x3cdiv role\x3d"alertdialog" tabIndex\x3d"-1"\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"contentsNode" class\x3d"dijitTooltipContents dijitTooltipFocusNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\t\t\t${!actionBarTemplate}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTooltipConnector" role\x3d"presentation" data-dojo-attach-point\x3d"connectorNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/dijit/templates/SharedThemeChooserPopup.html":'\x3cdiv class\x3d"shared-theme-chooser-popup"\x3e\r\n  \x3cdiv class\x3d"btns-container"\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"sharedItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"shared"\x3e${nls.sharedTheme}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"sharedCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-itmes" data-dojo-attach-point\x3d"customItem"\x3e\r\n      \x3cdiv class\x3d"btns jimu-float-leading" data-dojo-attach-point\x3d"custom"\x3e${nls.custom}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-float-trailing " data-dojo-attach-point\x3d"customCheck"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/CustomLogoPage.html":'\x3cdiv class\x3d"container"\x3e\r\n  \x3cdiv class\x3d"preview-container jimu-float-leading"\x3e\r\n    \x3cimg data-dojo-attach-point\x3d"image" class\x3d"image-node"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noImage" class\x3d"no-image"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"setting-container jimu-float-leading"\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.image}\x3c/div\x3e\r\n      \x3cdiv class\x3d"choose-image-btn" data-dojo-attach-point\x3d"chooseImageBtn"\x3e${nls.upload}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"setting-item"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.link}\x3c/div\x3e\r\n      \x3cinput type\x3d"text" class\x3d"link-text" data-dojo-type\x3d"jimu/dijit/URLInput" data-dojo-props\x3d"required:false,rest:false"\r\n        placeHolder\x3d"" data-dojo-attach-point\x3d"linkText"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/MapProxyItem.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"proxy-check" data-dojo-attach-point\x3d"useProxyCheckBox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layer-title" title\x3d"${title}"\x3e\r\n    \x3cdiv class\x3d"layer-name"\x3e${title}\x3c/div\x3e\r\n    \x3cdiv class\x3d"access-limit"\x3e\r\n        ${nls.requestLimit}: \x3cspan data-dojo-attach-point\x3d"requestLimitNode"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\r\n        ${nls.interval}: \x3cspan data-dojo-attach-point\x3d"intervalNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" title\x3d"${nls.consumeCredits}" class\x3d"credits"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"settingBtn" class\x3d"setting" title\x3d"${nls.settings}"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"setting-dialog hidden" data-dojo-attach-point\x3d"settingDialog" title\x3d""\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.requestLimit}:\x3c/div\x3e\r\n        \x3cdiv\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"limitSpinner"\r\n            data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n            data-dojo-props\x3d"constraints:{min:0,places:0}"\r\n            value\x3d"0" class\x3d"limit-spinner"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.interval}:\x3c/div\x3e\r\n        \x3cdiv class\x3d"input"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"intervalSelect" data-dojo-type\x3d"dijit/form/Select"\r\n            class\x3d"interval-select"\x3e\r\n            \x3coption value\x3d"0"\x3e${nls.none}\x3c/option\x3e\r\n            \x3coption value\x3d"1"\x3e${nls.second}\x3c/option\x3e\r\n            \x3coption value\x3d"60"\x3e${nls.minute}\x3c/option\x3e\r\n            \x3coption value\x3d"3600"\x3e${nls.hour}\x3c/option\x3e\r\n            \x3coption value\x3d"86400"\x3e${nls.day}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"button-section"\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation jimu-popup-action-btn jimu-float-trailing"\r\n        data-dojo-attach-point\x3d"cancelBtn"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1"\r\n          data-dojo-attach-point\x3d"okBtn"\x3e\r\n        ${nls.ok}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\r\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:builder/dijit/templates/LinkEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-url-btn" data-dojo-attach-point\x3d"addLinkBtn"\x3e\r\n    \x3cdiv class\x3d"add-icon"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"text" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"link-list" data-dojo-attach-point\x3d"linkListNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/dijit/templates/LinkItemEditor.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.title}:\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.url}:\x3c/div\x3e\r\n      \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"proxy-setting" data-dojo-attach-point\x3d"proxyNode"\x3e\r\n        \x3cdiv class\x3d"col-2"\x3e\r\n          \x3cdiv class\x3d"label"\x3e${nls.requestLimit}:\x3c/div\x3e\r\n          \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"limitNode"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"limitSpinner"\r\n            data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n            data-dojo-props\x3d"constraints:{min:0,places:0}"\r\n            value\x3d"0" class\x3d"limit-spinner"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-2"\x3e\r\n          \x3cdiv class\x3d"label"\x3e${nls.interval}:\x3c/div\x3e\r\n          \x3cdiv class\x3d"input" data-dojo-attach-point\x3d"intervalNode"\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"intervalSelect" data-dojo-type\x3d"dijit/form/Select"\r\n              class\x3d"interval-select"\x3e\r\n              \x3coption value\x3d"0"\x3e${nls.none}\x3c/option\x3e\r\n              \x3coption value\x3d"1"\x3e${nls.second}\x3c/option\x3e\r\n              \x3coption value\x3d"60"\x3e${nls.minute}\x3c/option\x3e\r\n              \x3coption value\x3d"3600"\x3e${nls.hour}\x3c/option\x3e\r\n              \x3coption value\x3d"86400"\x3e${nls.day}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-section jimu-float-trailing"\x3e\r\n      \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"okBtn"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"cancelBtn"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/AdditionalDataSources.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"ds-header"\x3e\r\n    \x3cspan class\x3d"ds-title ds-title-box textOverFlow" title\x3d"${nls.dataSource}"\x3e${nls.dataSource}\x3c/span\x3e\r\n    \x3cdiv class\x3d"dataSource-add-box dataSource-add margin-right-10" data-dojo-attach-point\x3d"addNewDs" data-dojo-attach-event\x3d"click:_onAddNewClick" title\x3d"${nls.addNew}"\x3e\r\n      \x3cdiv class\x3d"img_add"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"text_add textOverFlow" title\x3d"${nls.addNew}"\x3e${nls.addNew}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"dsOptions" class\x3d"ds-suspension ds-options ds-options-lr jimu-float-trailing hide"\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddLayer" data-dojo-attach-event\x3d"click:_onAddNewLayerClick" title\x3d"${nls.layer}"\x3e${nls.layer}\x3c/div\x3e\r\n    \x3cdiv nowrap class\x3d"option-item textOverFlow" data-dojo-attach-point\x3d"btnAddStatistics" data-dojo-attach-event\x3d"click:_onAddNewStatisticsClick" title\x3d"${nls.statistics}"\x3e${nls.statistics}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d\'tabelHeader\'\x3e\r\n    \x3cdiv class\x3d"table-header"\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.name}"\x3e${nls.name}\x3c/div\x3e\r\n      \x3cdiv class\x3d"textOverFlow" title\x3d"${nls.type}"\x3e${nls.type}\x3c/div\x3e\r\n      \x3cdiv\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"horizontial-line"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"no-data-source-tip no-data-source-tip-box" data-dojo-attach-point\x3d"noDataSourceTip"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"sourcesList" data-dojo-attach-point\x3d"sourcesList"\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"margin-top: 30px;" data-dojo-attach-point\x3d"refreshIntervalDiv"\x3e\r\n  \x3c/div\x3e\r\n  \r\n\x3c/div\x3e',
"url:jimu/dijit/templates/QueryableLayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"mapDijitContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"portalDijitContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"urlDijitContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/QueryableServiceChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataSourceConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"data-source-label"\x3e${nls.dataSource}\x3c/div\x3e\r\n  \x3cdiv class\x3d"source ds-text-box marginTop5" data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\'\x3e\x3c/div\x3e\r\n\r\n\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.name}\x3c/div\x3e\r\n  \x3cdiv class\x3d"marginTop5 ds-text-box" data-dojo-props\x3d\'required:true,trim:true\' data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"sourceName"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFilterLabel}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"btnSet"/\x3e\r\n    \x3cinput class\x3d"button" type\x3d"button" value\x3d${nls.config} data-dojo-attach-point\x3d"btnConfig"/\x3e\r\n    \x3cinput class\x3d"button marginLeft15" type\x3d"button" value\x3d${nls.remove} data-dojo-attach-point\x3d"btnRemove"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"filterExpr" class\x3d"marginLeft10 filterExpr"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"layerOptionDiv" data-dojo-attach-point\x3d"layerOnlyOption"\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3cinput class\x3d"button visible marginTop5" type\x3d"button" value\x3d${nls.set} data-dojo-attach-event\x3d"click:_onFeaturesFieldsClick"/\x3e\r\n\r\n    \x3cdiv class\x3d"hide fieldsOption fieldsOptionDiv fields-position-lr" data-dojo-attach-point\x3d"fieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.sourceRecordsLabel}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.number}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.orbderBy}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n\r\n      \x3cdiv class\x3d"resultRecordType"\x3e\r\n        \x3cselect  data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"resultRecordType"\x3e\r\n          \x3coption value\x3d"serviceLimitation"\x3e${nls.serviceLimitation}\x3c/option\x3e\r\n          \x3coption value\x3d"all"\x3e${nls.all}\x3c/option\x3e\r\n          \x3coption value\x3d"custom"\x3e${nls.custom}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"marginLeft5 custom-number-div"\x3e\r\n          \x3cdiv class\x3d"hide" data-dojo-attach-point\x3d"customNumberDiv"\x3e\r\n          \x3cinput type\x3d"text" class\x3d"custom-number" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:1,places:0},value:1000\' data-dojo-attach-point\x3d"customNumber"\x3e\x3c/input\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n\r\n      \x3cdiv class\x3d"marginLeft20 orderByField"\x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"orderFields"\x3e\x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"marginLeft20 order"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"ascBtn" class\x3d"order-btn selected textOverFlow" title\x3d"${nls.ASC}"\x3e${nls.ASC}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"descBtn" style\x3d"margin-left: -1px;" class\x3d"order-btn textOverFlow" title\x3d"${nls.DESC}"\x3e${nls.DESC}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv style\x3d"display: none;" class\x3d"statisticsOptionDiv" data-dojo-attach-point\x3d"statisticsOnlyOption"\x3e\r\n    \x3cdiv class\x3d"marginTop20 data-source-label"\x3e${nls.statistics}\x3c/div\x3e\r\n    \x3cdiv style\x3d"margin-top: 12px;" class\x3d"flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.groupBy}\x3c/div\x3e\r\n      \x3cdiv class\x3d"data-source-sub-label"\x3e${nls.sourceFieldsLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"marginTop5 flex-ltr-start"\x3e\r\n      \x3cdiv class\x3d"groupFields" \x3e\r\n        \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupFields"\x3e\r\n          \x3coption value\x3d"-"\x3e-\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput class\x3d"marginLeft20 button visible" type\x3d"button" value\x3d${nls.set} data-dojo-attach-point\x3d"statisticsFields" data-dojo-attach-event\x3d"click:_onStatisticsFieldsClick"/\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"hide statisticsFieldsOption fieldsOptionDiv statisrics-fields-position-lr" data-dojo-attach-point\x3d"statisticsFieldsOptionDiv"\x3e\r\n      \x3cdiv class\x3d"left-arrow transform"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"statisticsFieldsOption" class\x3d"suspension"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"data-source-label marginTop20"\x3e${nls.refreshInterval}\x3c/div\x3e\r\n  \x3cdiv class\x3d"refreshContent marginTop5"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"isDynamic"\x3e\x3c/div\x3e\x3clabel class\x3d"margin-left-10 textOverFlow"\x3e${nls.refreshDataEvery}\x3c/label\x3e\r\n    \x3cinput type\x3d"text" class\x3d"timeDiv" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0},value:0.5\' data-dojo-attach-point\x3d"refreshInterval"\x3e\x3c/input\x3e\r\n     \x3cspan\x3e${nls.refreshDataEvery_Minutes}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading data-preview textOverFlow" title\x3d"${nls.preview}" data-dojo-attach-point\x3d"btnPreview" data-dojo-attach-event\x3d"click:_onPreviewClick"\x3e${nls.preview}\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"desktopAddSection" class\x3d"desktop-add-section hidden"\x3e\r\n\t\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"btnAddExpDesktop" class\x3d"add-with-icon add-expression jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"btnAddSetDesktop" class\x3d"add-with-icon add-set jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"matchMsg" class\x3d"match-msg"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"oneOrZeroMsg" style\x3d"display:none;"\x3e${nls.oneOrZeroMsg}\x3c/div\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.matchMsgAll}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.matchMsgAny}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" class\x3d"hidden"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"mobileAddSection" class\x3d"mobile-add-section hidden"\x3e\r\n\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" title\x3d"${nls.addAnotherExpression}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddExpMobile"\x3e\r\n\t\t\t+ ${nls.addAnotherExpression}\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" title\x3d"${nls.addSet}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddSetMobile"\x3e\r\n\t\t\t+ ${nls.addSet}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip hidden"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/DateValueSelector.html":'\x3cdiv\x3e\r\n\t\x3cinput data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-point\x3d"dateTextBox" class\x3d"custom-date-text-box" data-dojo-attach-event\x3d"change:_onDateTextBoxChanged" data-dojo-props\x3d\'required:false,trim:true\' /\x3e\r\n\x3c/div\x3e',"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;" data-dojo-attach-point\x3d"_dijit1_container"\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;" data-dojo-attach-point\x3d"_dijit2_container"\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3c!-- \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e --\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"_dijitDiv1"  data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3c!-- \x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e --\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"_dijitDiv2"  data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/AdvancedListValueSelect.html":'\x3cdiv class\x3d"jimu-list-multiple-select" data-dojo-attach-point\x3d"multipleSelect" tabindex\x3d"0"\x3e\r\n  \x3cdiv class\x3d"selectedContainer" data-dojo-attach-point\x3d"selectedContainer"\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-items-list items-content" data-dojo-attach-point\x3d"selectedListContent" tabindex\x3d"0"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\x3e\r\n    \x3c!-- \x3cdiv style\x3d"position:absolute;height:345px;width:100%;z-index:1;display:none;" data-dojo-attach-point\x3d"listContainerOverlay"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"searchKeyInput" data-dojo-attach-point\x3d"searchKeyInput" style\x3d"display:none;"\x3e\r\n      \x3cinput value\x3d"" placeholder\x3d"${jimuCommonNls.search}" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n       data-dojo-attach-point\x3d"valueInput" data-dojo-props\x3d\'"required":false,intermediateChanges:true\' style\x3d"width:100%;" tabindex\x3d"0"/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"items-content loading-center" data-dojo-attach-point\x3d"listContainer"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listContentStore"style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\r\n      \x3c/div\x3e --\x3e\r\n      \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"listContent" tabindex\x3d"0"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadMoreDataBtn" class\x3d"jimu-list-multiple-select-Tips load-more-data-Tips"\x3e${jimuCommonNls.searchMore}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${Nls.noData}\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${noDataNls}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"createNewItem" data-dojo-attach-point\x3d"createNewItem" data-dojo-attach-event\x3d"click:_createTarget"\x3e\x26nbsp;\x3c/div\x3e --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n    \x3cspan class\x3d"selectedToggle" data-dojo-attach-point\x3d"selectedToggle"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"toggleTxt" title\x3d"${Nls.showSelected}"\x3e${Nls.showSelected}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  --\x3e\r\n\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n      \x3cdiv class\x3d"showAllIcon iconHover jimu-flipx" title\x3d"${Nls.showAll}" data-dojo-attach-point\x3d"showAllIconBtn"  tabindex\x3d"0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"showSelectedIcon jimu-flipx" title\x3d"${Nls.showSelected}" data-dojo-attach-point\x3d"showSelectedIconBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"clearAllSelectedIcon jimu-flipx" title\x3d"${Nls.unCheckAll}" data-dojo-attach-point\x3d"clearAllSelectedBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/AdvancedListValueProvider.html":'\x3cdiv\x3e\r\n   \x3cdiv role\x3d"button" class\x3d"checkBtn" tabindex\x3d"0" data-dojo-attach-point\x3d"checkedBtn" style\x3d"display:none;" data-dojo-attach-event\x3d"click:_checkedBtnEvent"\x3e\r\n       \x3cspan class\x3d"screen-readers-only" data-dojo-attach-point\x3d"promptLabel"\x3e\x3c/span\x3e\r\n       \x3cdiv data-dojo-attach-point\x3d"checkedNumDiv" class\x3d"checkedNumDiv"\x3e\x3cspan class\x3d"checkedNum" data-dojo-attach-point\x3d"checkedNum"\x3e\x3c/span\x3e${CommonNls.selected}\x3c/div\x3e\r\n       \x3cdiv data-dojo-attach-point\x3d"checkedNameDiv" class\x3d"checkedNum checkedNameDiv jimu-ellipsis-Blanks"\x3e\x3c/div\x3e\r\n       \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8 checkBtnDownIcon"\x3e\x3c/div\x3e\r\n   \x3c/div\x3e\r\n   \x3cdiv data-dojo-attach-point\x3d"listContent"\x3e\x3c/div\x3e\r\n   \x3cdiv class\x3d"value-multiple-popup" data-dojo-attach-point\x3d"listContentPopup"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"listContent"\x3e\x3c/div\x3e\r\n   \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/pageControlForQuery.html":'\x3cdiv class\x3d"pageControl pageItem"\x3e\r\n  \x3c!--\r\n  \x3cdiv data-dojo-attach-point\x3d"prevPage" class\x3d"pageBtn pageDisabled pageItem"\x3e\x3c-prevPage\x3c/div\x3e\r\n  \x3cdiv class\x3d"pageItem" data-dojo-attach-point\x3d"currentPage"\x3e1\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"nextPage" class\x3d"pageBtn pageItem"\x3enextPage-\x3e\x3c/div\x3e\r\n  --\x3e\r\n\r\n  \x3c!-- \x3cdiv data-dojo-attach-point\x3d"addNextPage"\x3eLoad more data(Test)\x3c/div\x3e --\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/PredefinedValueProvider.html":'\x3cdiv\x3e\r\n    \x3c!-- \x3cdiv data-dojo-attach-point\x3d"valueproviderStore" style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"jimu-filter-popup-btn jimu-not-selectable"\x3e\r\n      \x3cdiv class\x3d"predefined-btn"  data-dojo-attach-point\x3d\'indexBtn\'\x3e\r\n        \x3cdiv class\x3d"tip jimu-ellipsis" title\x3d"predefined" data-dojo-attach-point\x3d\'indexBtnTips\'\x3epredefined\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d\'valueProviderPopupNode\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/EditTable.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-set-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"" class\x3d"items-list-content items-list-header"  \x3e\r\n        \x3cdiv class\x3d"item"\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis" title\x3d"${Nls.value}"\x3e${Nls.value}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis" title\x3d"${CommonNls.label}"\x3e${CommonNls.label}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label checkboxHeader jimu-ellipsis" title\x3d"${CommonNls.defaults}"\x3e${CommonNls.defaults}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label lableR jimu-ellipsis" title\x3d"${CommonNls.actions}"\x3e${CommonNls.actions}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"listContent" class\x3d"items-list-content" data-dojo-attach-event\x3d"click:_onListContentClicked, dblclick:_onListContentDblClicked"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e',
"url:jimu/dijit/_filter/PredefinedValuePopup.html":'\x3cdiv\x3e\r\n   \x3c!--\r\n    \x3cselect data-dojo-attach-point\x3d"valProviderSelect" class\x3d"dijit-form-Select multiple-Select"  data-dojo-attach-event\x3d"onclick:_showPopup"\x3e\r\n    \x3c/select\x3e\r\n    --\x3e\r\n    \x3c!-- \x3cdiv class\x3d"subTitle"\x3e${CommonNls.layer}: \x3cspan data-dojo-attach-point\x3d"layerName"\x3e\x3c/span\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"jimu-filter-popup-btn jimu-not-selectable"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listSelectStore" style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\x3c/div\x3e --\x3e\r\n\r\n      \x3c!-- for list select popup --\x3e\r\n      \x3c!-- \x3cdiv class\x3d"add-label-btn" data-dojo-attach-event\x3d"click:_showPopup"\x3e --\x3e\r\n      \x3c!-- for eidtTable --\x3e\r\n      \x3cdiv class\x3d"add-label-btn" data-dojo-attach-event\x3d"click:_createTarget"\x3e\r\n        \x3cdiv class\x3d"icon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"tip"\x3e${CommonNls.add}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"add-btn" data-dojo-attach-event\x3d"click:_showPopup"\x3e\r\n        \x3cdiv class\x3d"tip"\x3eopenLayer-temp\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"add-btn add-btn-right" data-dojo-attach-event\x3d"click:_createTarget"\x3e\r\n        \x3cdiv class\x3d"tip"\x3e${CommonNls.add}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n       --\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tableContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"displayTypes" data-dojo-attach-point\x3d"displayTypes" data-dojo-attach-event\x3d"click:_changeDisplayType"\x3e\r\n      \x3cdiv class\x3d"title jimu-ellipsis"\x3e${Nls.displayAs}\x3c/div\x3e\r\n      \x3cspan class\x3d"option dropdownOption"\x3e\r\n        \x3cdiv class\x3d"radio"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"label jimu-ellipsis"\x3e${Nls.aDrowdownList}\x3c/div\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"option expandedOption"\x3e\r\n      \x3cdiv class\x3d"radio"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label jimu-ellipsis"\x3e${Nls.aExpandedList}\x3c/div\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv class\x3d"jimu-multiple-set-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"" class\x3d"items-list-content items-list-header"  \x3e\r\n        \x3cdiv class\x3d"item"\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis"\x3e${CommonNls.name}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis"\x3e${CommonNls.label}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label checkboxHeader jimu-ellipsis" title\x3d"set default?"\x3e${CommonNls.defaults}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label lableR jimu-ellipsis"\x3e${CommonNls.actions}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"listContent" class\x3d"items-list-content" data-dojo-attach-event\x3d"click:_onListContentClicked"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    --\x3e\r\n\r\n    \x3cdiv class\x3d"value-type-popup" data-dojo-attach-point\x3d"valuesPopupNode" style\x3d"display:none;"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"mutiValuesSelect" multiple\x3d"true" data-dojo-type\x3d"dojox/form/CheckedMultiSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;" \x3e\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"pageControlContainer"\x3eLoad more data\x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- \x3ca data-dojo-attach-event\x3d"onclick:_setSelectType" class\x3d"popupOper" style\x3d"display:none;"\x3etype\x3c/a\x3e --\x3e\r\n  \x3c/div\x3e',
"url:dijit/form/templates/ComboButton.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tcellspacing\x3d\'0\' cellpadding\x3d\'0\' role\x3d"presentation"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point\x3d"buttonNode" data-dojo-attach-event\x3d"ondijitclick:__onClick,onkeydown:_onButtonKeyDown"\r\n\t\t\x3e\x3cdiv id\x3d"${id}_button" class\x3d"dijitReset dijitButtonContents"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode"\r\n\t\t\trole\x3d"button" aria-labelledby\x3d"${id}_label"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitIcon" data-dojo-attach-point\x3d"iconNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInline dijitButtonText" id\x3d"${id}_label" data-dojo-attach-point\x3d"containerNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd id\x3d"${id}_arrow" class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'\r\n\t\t\tdata-dojo-attach-point\x3d"_popupStateNode,focusNode,_buttonNode"\r\n\t\t\tdata-dojo-attach-event\x3d"onkeydown:_onArrowKeyDown"\r\n\t\t\ttitle\x3d"${optionsTitle}"\r\n\t\t\trole\x3d"button" aria-haspopup\x3d"true"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonInner" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitArrowButtonChar" role\x3d"presentation"\x3e\x26#9660;\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd style\x3d"display:none !important;"\r\n\t\t\t\x3e\x3cinput ${!nameAttrSetting} type\x3d"${type}" value\x3d"${value}" data-dojo-attach-point\x3d"valueNode"\r\n\t\t\t\tclass\x3d"dijitOffScreen" aria-hidden\x3d"true" data-dojo-attach-event\x3d"onclick:_onClick"\r\n\t\t/\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dojox/form/resources/_CheckedMultiSelectMenuItem.html":'\x3ctr class\x3d"dijitReset dijitMenuItem" dojoAttachPoint\x3d"focusNode" role\x3d"menuitemcheckbox" tabIndex\x3d"-1"\r\n\tdojoAttachEvent\x3d"ondijitclick:_onClick"\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\r\n\t\t\x3e\x3cdiv src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitMenuItemIcon ${_iconClass}" dojoAttachPoint\x3d"iconNode"\r\n\t\t\t\x3e\x3cinput class\x3d"dojoxCheckedMultiSelectCheckBoxInput" dojoAttachPoint\x3d"inputNode" type\x3d"${_type.type}"\r\n\t\t/\x3e\x3c/div\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" dojoAttachPoint\x3d"containerNode,labelNode"\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" dojoAttachPoint\x3d"accelKeyNode"\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26nbsp;\x3c/td\r\n\x3e\x3c/tr\x3e',
"url:dojox/form/resources/_CheckedMultiSelectItem.html":'\x3cdiv class\x3d"dijitReset ${baseClass}"\r\n\t\x3e\x3cinput class\x3d"${baseClass}Box" data-dojo-type\x3d"dijit.form.CheckBox" data-dojo-attach-point\x3d"checkBox" \r\n\t\tdata-dojo-attach-event\x3d"_onClick:_changeBox" type\x3d"${_type.type}" data-dojo-props\x3d\'disabled:${disabled}, readOnly:${readOnly}\' baseClass\x3d"${_type.baseClass}"\r\n\t/\x3e\x3cdiv class\x3d"dijitInline ${baseClass}Label" data-dojo-attach-point\x3d"labelNode" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dojox/form/resources/CheckedMultiSelect.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"comboButtonNode"\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"selectNode" class\x3d"dijit dijitReset dijitInline ${baseClass}Wrapper" data-dojo-attach-event\x3d"onmousedown:_onMouseDown,onclick:focus"\r\n\t\t\x3e\x3cselect class\x3d"${baseClass}Select dojoxCheckedMultiSelectHidden" multiple\x3d"true" data-dojo-attach-point\x3d"containerNode,focusNode"\x3e\x3c/select\r\n\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"wrapperDiv"\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\x3e\x3c/div\x3e',
"url:jimu/dijit/_filter/NumberListValueProvider.html":'\x3cdiv\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"numberListTable" style\x3d"width:100%;border-collapse:collapse;"\r\n        cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                        data-dojo-props\x3d\'"required":false,constraints:{min:0,pattern:"#####0.##########"}\'\r\n                        style\x3d"width:100%;" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"rangeSelect" data-dojo-type\x3d"dijit/form/Select"\r\n                        style\x3d"width:100%;" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n                        \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/DateIsInValueProvider.html":'\x3cdiv\x3e\r\n\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"dateTypeSelect" class\x3d"date-type-select restrict-select-width" data-dojo-attach-event\x3d"change:_onDateTypeSelectChanged"\x3e\r\n\t\x3c/select\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"settings-container"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"fields-select dijit-form-FilteringSelect"\x3e\x3c/div\x3e\r\n    \x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n      \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n    \x3c/select\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"attribute-value-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"valueProviderContainer" class\x3d"value-provider-container"\x3e\x3c/div\x3e\r\n      \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"valueTypeSetNode" title\x3d"${nls.setInputType}" class\x3d"value-type-set jimu-icon jimu-icon-setting"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" tabindex\x3d"0" aria-label\x3d"\'${nls.deleteText}\'" class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"askvalues"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table" style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"cascadeTr" class\x3d"cascade-tr"\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cdiv style\x3d"margin-bottom:5px;"\x3e${nls.listValues}:\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"cascadeSelect" class\x3d"cascade-select restrict-select-width" style\x3d"width:100%;"\x3e\r\n              \x3coption value\x3d"none"\x3e${nls.noneCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"previous"\x3e${nls.previousCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"all"\x3e${nls.allCascadeFilterTip}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.matchMsgSetAll}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.matchMsgSetAny}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"jimu-filter-set-delete"\x3e\r\n\t\t\t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"btnDelete" aria-label\x3d"\'${nls.deleteText}\'" class\x3d"jimu-icon jimu-icon-delete" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"jimu-filter-set-add"\x3e\r\n\t\t\t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"btnAdd" aria-label\x3d"\'${nls.addText}\'" class\x3d"jimu-icon jimu-icon-add" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox" class\x3d"jimu-filter-exps-box"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/attribute-config/dataSource/DataFields.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fieldsContent" class\x3d"fields-content"\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operation"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnUp" data-dojo-attach-event\x3d"onclick:_moveUp" class\x3d"jimu-icon jimu-icon-up" title\x3d"${nls.moveUp}"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"btnDown" data-dojo-attach-event\x3d"onclick:_moveDown" class\x3d"jimu-icon jimu-icon-down" title\x3d"${nls.moveDown}"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/dijit/templates/RefreshInterval.html":'\x3cdiv class\x3d"map-option refresh-option"\x3e\r\n  \x3cdiv class\x3d"option-title"\x3e${nls.setRefreshInterval}\x3c/div\x3e\r\n  \x3cp class\x3d"option-statement" style\x3d"font-family:\'Avenir Light\';"\x3e${nls.refreshTip}\x3c/p\x3e\r\n  \x3cselect data-dojo-attach-point\x3d"refreshSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"refresh-select dijit-form-Select restrict-select-width" style\x3d"width:100%; box-sizing:border-box;"\x3e\r\n    \x3coption value\x3d"defaultRefresh"\x3e${defaultRefreshTip}\x3c/option\x3e\r\n    \x3coption value\x3d"singleRefresh"\x3e${singleRefreshTip}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"refreshIntervalInputs" class\x3d"refresh-interval-inputs hidden"\x3e\r\n    \x3cinput data-dojo-attach-point\x3d"refreshIntervalNTB" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'required:true,constraints:{min:0,pattern:"#####0.##########"},value:0.5\' class\x3d"jimu-float-leading" style\x3d"width:55px;" /\x3e\r\n    \x3cdiv class\x3d"minutes-text jimu-float-leading"\x3e${nls.minutes}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dojox/widget/ColorPicker/ColorPicker.html":'\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
"url:builder/plugins/attribute-config/css/style.css":'.attribute-config {overflow-x: hidden; overflow-y: auto; font-size: 14px;}.attribute-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.attribute-config .section {padding: 15px 20px;}.header-section input,.links-section input,.appId-section input,.proxy-section input {height: 30px; border: 1px solid #d2dae2; padding: 5px; margin: 0; font-size: 12px; color: #232323; width: 100%; background-color: #fafafc; font-family: "Avenir Light";}.header-section input:focus,.links-section input:focus,.appId-section input:focus,.proxy-section input:focus {border: 1px solid #15a4fa; background-color: white; color: black;}.attribute-config .header-section {border: 0 solid;}.attribute-config .header-section .header-title,.attribute-config .title {color: #596679; line-height: 1.0; display: inline-block; width: 100%;}.attribute-config .styled-text {padding-right: 30px;}.jimu-rtl .attribute-config .styled-text {padding-left: 20px; padding-right: 0;}.attribute-config .header-section .logo-container {position: relative; font-size: 10px; width: 82px; height: 82px; margin-top: 10px; cursor: pointer; background-color: #ececec;}.attribute-config .header-section .logo-container:hover {background-color: #dcdcdc;}.attribute-config .header-section .logo-container.logo {border: 1px solid #d2dae2;}.attribute-config .header-section .logo-container.no-logo {border: 1px dashed #d2dae2;}.attribute-config .header-section .logo-container .hide {display: none;}.attribute-config .header-section .logo-container .jimu-image-chooser {width: 100%;}.attribute-config .header-section .logo-container.no-logo .jimu-image-chooser {position: absolute !important; opacity: 0; -ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.attribute-config .header-section .logo-container .jimu-image-chooser .hint .display-image {width: auto; height: auto; max-width: 80px; max-height: 80px; background-size: contain;}.attribute-config .header-section .logo-container .add-logo {text-align: center; margin-top: 31px; cursor: pointer;}.attribute-config .header-section .logo-container .add-logo .image {margin: auto; margin-top: 10px; background: url(images/add_header.png) no-repeat center; width: 20px; height: 20px;}.attribute-config .header-section .logo-container .add-logo .text {font-size: 12px; color: #aaaaaa; text-align: center;}.attribute-config .header-section .logo-container .masker-node {position: absolute; z-index: 200; height: 100%; width: 100%; top: 0;}.attribute-config .header-section .logo-container .remove-logo {display: none; position: absolute; width: 25px; height: 25px; right: 0; z-index: 9999; cursor: pointer; background-color: rgba(0, 0, 0, .4); background-repeat: no-repeat; background-position: center;}.attribute-config .header-section .logo-container .remove-logo {top: 0; background-image: url(images/remove_logo.png);}.attribute-config .header-section .logo-container.logo:hover .remove-logo {display: block;}.attribute-config .header-section .logo-container.logo .remove-logo:hover {background-color: rgba(0, 0, 0, .6);}.attribute-config-plugin-logo-options.remove-logo {width: 25px; height: 25px; border-radius: 4px; background-repeat: no-repeat; background-position: center; background-image: url(images/remove_logo.png); z-index: 10000000; cursor: pointer; -ms-filter: "Alpha(opacity\x3d40)"; filter: Alpha(opacity\x3d40); background-color: rgb(0, 0, 0);}.attribute-config-plugin-logo-options.remove-logo:hover {-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60); background-color: rgb(0, 0, 0);}.attribute-config .header-section .titles {font-size: 10px; margin-top: 10px; width: calc(100% - 82px - 1em);}.attribute-config .header-section .titles input {height: 36px; background-color: white;}.attribute-config .header-section .titles .title {width: 100%; position: relative;}.attribute-config .header-section\x3e.title {width: 100%; height: 20px; position: relative;}.attribute-config .header-section .subtitle {width: 100%; height: 32px; margin-top: 10px; position: relative;}.attribute-config .header-section .label-editor {position: absolute; width: 12px; height: 12px; background: url("./images/A.png") no-repeat center; top: 12px; right: 10px; cursor: pointer; background-color: white;}.attribute-config .header-section .label-editor:hover {background: url("./images/A_hover.png") no-repeat center; background-color: #fafafc;}.jimu-rtl .attribute-config .header-section .label-editor {right: auto; left: 1px;}.format-font-style .dijitEditorIFrameContainer {position: absolute; top: 36px; left: 1px; right: 1px; bottom: 3px;}.format-font-style .dijitToolbar .dijitTextBox {width: 180px !important;}.el .format-font-style .dijitToolbar .dijitTextBox {width: 150px !important;}.pt-pt .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.it .format-font-style .dijitToolbar .dijitTextBox {width: 160px !important;}.format-font-style .dijitToolbar {font-size: 12px;}.appId-section .attribute-content {margin-top: 10px;}.appId-section a {color: #7EC6F8; float: right; cursor: pointer;}.proxy-section {display: none;}.attribute-config .sub-title {padding: 15px 0 10px 0;}.links-section .attribute-content {width: 340px; padding-top: 15px;}.links-section,.proxy-section {color: #a0acbf;}.attribute-config .attribute-content .links-list,.attribute-config .attribute-content .proxy-rule-list {padding-top: 10px;}.attribute-config .attribute-content .list-item.selected-item,.attribute-config .attribute-content .list-item:hover {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item.selected-item .mask,.attribute-config .attribute-content .list-item:hover .mask {background-color: #e3ecf2;}.attribute-config .attribute-content .list-item {overflow: hidden; border-top-style: none; border: 1px solid #d2dae2; border-bottom-color: #eef2f5;}.attribute-config .attribute-content .list-item+.list-item {border-top-style: none;}.attribute-config .attribute-content .list-item:last-child {border-bottom-color: #dad2de;}.attribute-config .attribute-content .list-item:first-child {border-top-color: #dad2de;}.attribute-config .attribute-content .list-item .mask {width: 100%; height: 30px; color: #a0acbf; font-size: 12px; line-height: 30px; padding-left: 10px; border-width: 1px; background-color: #fafafc;}.attribute-config .attribute-content .list-item .mask:first-child {font-size: 14px;}.attribute-config .attribute-content .list-item .first,.attribute-config .attribute-content .list-item .second {height: 30px;}.proxy-rule-header {width: 100%; height: 30px; line-height: 30px; background-color: #518dca; color: white; margin: 10px 0 -10px;}.proxy-rule-header div {float: left; border-style: none; padding-left: 10px;}.attribute-content .list-item .first,.proxy-rule-header .prefix {width: 110px;}.proxy-rule-header .proxy-url {width: 228px;}.attribute-content .list-item .second {width: 228px; border-left: 1px solid #eef2f5;}.attribute-config .attribute-content .list-item .first input {border-right-style: none;}.attribute-config .attribute-content .list-header {}.attribute-config .list-header .header-button {display: inline-block; padding: 0 15px 0 19px; color: #a0acbf; cursor: default;}.attribute-config .list-header .header-button.add {color: #518dca; cursor: pointer; background: url(images/add_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.add:hover {background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .header-button.edit {background: url(images/edit_icon01.png) no-repeat left;}.attribute-config .list-header .header-button.delete {background: url(images/delete_icon01.png) no-repeat left;}.attribute-config .list-header .highlight-button {color: #518dca; cursor: pointer;}.attribute-config .list-header .highlight-button.add {color: #518dca; background: url(images/add_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.edit {background: url(images/edit_icon02.png) no-repeat left;}.attribute-config .list-header .highlight-button.delete {background: url(images/delete_icon02.png) no-repeat left;}.jimu-rtl .attribute-config .list-header .header-button,.jimu-rtl .attribute-config .list-header .highlight-button {background-position: right !important;}.attribute-config .section .always-use-proxy {color: #596679; cursor: pointer; display: inline-block; margin-top: 15px; margin-bottom: 6px;}.attribute-config .section .always-use-proxy .label {display: inline; float: none;}.proxy-section .rules-label {color: #596679; font-size: 12px; margin: 10px 0 12px 0; display: block; line-height: 12px;}.proxy-section .error-status {border: 1px solid #e84b4b; background-color: #fff;}.controller-loading,.controller-appproxy {cursor: pointer;}.controller-loading:hover,.datasources:hover,.controller-appproxy:hover {background: #F3F3F3;}.controller-loading .action-content {padding-top: 15px; height: 48px;}.section-appstate .action-content {padding-top: 15px;}.section-appstate .appstate-check .label {float: none !important; font-size: 12px !important; margin-left: 30px; color: #000;}.jimu-rtl .section-appstate .appstate-check .label {margin-right: 30px; margin-left: auto;}.loadingpage-section,.appproxy-section {margin-top: 25px; width: 100%; padding: 0 20px;}.appproxy-section .attribute-link,.loadingpage-section .attribute-link {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.loadingpage-section .config-part {margin-top: 10px; font-size: 14px; color: #7889a0; width: 300px;}.loadingpage-section .bgColor-control {height: 30px; width: 340px; margin-top: 10px; text-align: center; line-height: 30px; color: #000000;}.loadingpage-section .bgUploaderDiv {width: 300px; height: 30px;}.loadingpage-section .loading-image-chooser {width: auto; height: 30px; line-height: 30px; margin-top: 10px;}.loadingpage-section .jimu-btn {padding-top: 1px;}.loadingpage-section .config-part .label {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.loadingpage-section .config-part .jimu-checkbox .label {font-family: "Avenir Light"; font-size: 12px; color: #000000;}.loadingpage-section .config-part label {font-family: "Avenir Light"; font-size: 12px; color: #333333;}.loadingpage-section .config-part .value {font-size: 14px; color: #000000; margin-left: 15px;}.loadingpage-section .gif_select {width: 100px; height: 32px;}.section {width: 100%;}.section .title \x3e span {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323}.section .action-text,.sub-section .note {margin-top: 5px; line-height: 16px; font-size: 12px; color: #999999;}.appproxy-section {width: 100%;}.appproxy-section .sub-section {margin-top: 20px; width: 100%;}.appproxy-section .sub-section.double-margin {margin-top: 40px;}.appproxy-section .sub-section .title {line-height: 20px; font-family: "Avenir Medium"; font-size: 14px; color: #232323;}.appproxy-section .sub-section .content {margin-top: 10px;}.appproxy-section .sub-section .row {height: 30px; margin-top: 13px; width: calc(100% - 25px);}.appproxy-section .sub-section .row \x3e .col:first-child {text-align: left;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:first-child {text-align: right;}.appproxy-section .sub-section .row \x3e .col:last-child {text-align: right;}.jimu-rtl .appproxy-section .sub-section .row \x3e .col:last-child {text-align: left;}.appproxy-section .sub-section .col {width: calc(30% - 8px); line-height: 16px; font-family: "Avenir-Book"; font-size: 12px; color: #232323; display: inline-block; text-align: center; text-overflow: ellipsis; overflow: hidden; white-space: nowrap;}.appproxy-section .sub-section .col-proxy {width: 25px;}.appproxy-section .sub-section .col .checkbox {float: right !important;}.jimu-rtl .appproxy-section .sub-section .col .checkbox {float: left !important;}.appproxy-section .sub-section .header {height: 36px; margin: 10px 0;}.appproxy-section .sub-section .header .row {height: 36px; margin: 0;}.appproxy-section .sub-section .header .row .col {color: #898989; height: 36px; line-height: 36px;}.appproxy-section .sub-section .sepeartor {width: 100%; height: 1px; background: #EFEFEF;}.appproxy-section .note-content {font-family: "Avenir Medium"; font-size: 12px; color: #232323;}.map-proxy-item {width: 100%; height: auto; border-top: 1px solid #EEE; border-bottom: 1px solid #EEE; position: relative; padding: 10px 0;}.map-proxy-item \x3e div {display: inline-block; vertical-align: top;}.map-proxy-item .proxy-check {width: 18px; height: 18px;}.map-proxy-item .layer-title {margin: 0 6px; width: calc(100% - 100px); font-size: 12px;}.map-proxy-item .layer-title .title {height: auto; font-size: 12px;}.map-proxy-item .layer-title .access-limit {color: #999;}.map-proxy-item .credits {background: url(images/PremiumContentUserCredit16.png) no-repeat center; height: 16px; width: 16px; margin: 0 5px;}.map-proxy-item .setting {background: url(images/settings_default.svg) no-repeat center; height: 16px; width: 16px; cursor: pointer; margin: 0 5px;}.map-proxy-item .setting.highight {background: url(images/settings_hover.svg) no-repeat center;}.map-proxy-item .setting:hover {background: url(images/settings_hover.svg) no-repeat center;}.map-proxy-item .setting-dialog {position: absolute; top: 40px; left: 0; width: 340px; height: 160px; background-color: #fff; z-index: 100; border: 1px solid #E0E0E0; box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.20);}.map-proxy-item .setting-dialog.hidden {display: none;}.map-proxy-item .setting-dialog .input-section {margin: 30px 20px 0 20px;}.map-proxy-item .setting-dialog .input-section \x3e div {width: 49%; display: inline-block;}.map-proxy-item .setting-dialog .limit-spinner,.map-proxy-item .setting-dialog .interval-select {width: 100%;}.map-proxy-item .setting-dialog .button-section {margin: 20px;}.loading {background: transparent;}.attribute-config .datasources {margin-top: 15px; cursor: pointer;}.datasources-link,.datasources-section {text-align: center; font-family: "Avenir Medium"; font-size: 16px; color: #232323; height: 22px; width: 100%;}.datasources-section {margin-top: 25px; width: 100%; height: auto; padding: 0 20px;}.attribute-config .additional-data-sources {text-align: initial; height: 100%; width: 100%;}.additional-data-sources .margin-right-10 {margin-right: 10px;}.jimu-rtl .additional-data-sources .margin-right-10 {margin-left: 10px; margin-right: 0;}.additional-data-sources .no-data-source-tip {background-size: contain; background: center center no-repeat url(\'images/no-data-source-tip.svg\');}.additional-data-sources .no-data-source-tip-box {width: 100px; height: 97px; margin: 80px auto 0 auto;}.additional-data-sources .ds-header {display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .ds-title-box {max-width: 200px; text-overflow: ellipsis; height: 19px; margin-top: 15px}.additional-data-sources .ds-title {font-family: "Avenir Medium"; font-size: 14px; color: #000000;}.additional-data-sources .dataSource-add-box {margin-top: 15px; display: flex; height: 26px; justify-content: space-around; align-items: center;}.additional-data-sources .dataSource-add {cursor: pointer;}.additional-data-sources .dataSource-add .img_add {width: 12px; height: 12px; padding: 0 10px; background: no-repeat center center url(./images/ds_add.svg);}.additional-data-sources .dataSource-add .img_add_hover {background: no-repeat center center url(./images/ds_add_hover.svg);}.additional-data-sources .dataSource-add .text_add {font-family: Avenir-Medium; font-size: 12px; color: #666666; letter-spacing: 0.33px; max-width: 200px; text-overflow: ellipsis;}.additional-data-sources .dataSource-add .text_add_hover {color: #0C839C;}.additional-data-sources .ds-suspension.ds-options.hide {display: none;}.additional-data-sources .ds-suspension {position: absolute; box-shadow: 0 0 8px 0 rgba(0, 0, 0, 0.30); height: 194px; width: 160px; background: #ffffff;}.additional-data-sources .ds-options-lr {right: 39px; left: inherit;}.jimu-rtl .additional-data-sources .ds-options-lr {left: 39px; right: inherit;}.additional-data-sources .ds-options {background: #FFFFFF; box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.50); width: 143px; padding: 5px 2px; height: 84px; margin-top: 13px; display: flex; flex-direction: column; justify-content: center; align-items: center;}.additional-data-sources .ds-options .option-item {width: 143px; height: 32px; cursor: pointer; font-family: "Avenir Medium"; font-size: 14px; color: #000000; padding: 6px 23px;}.additional-data-sources .ds-options .option-item:hover {background-color: #DDDDDD;}.additional-data-sources .table-header {margin-top: 23px; display: flex; justify-content: space-between; align-items: center;}.additional-data-sources .table-header {padding-right: 7px;}.additional-data-sources .table-header div {font-size: 12px; color: #000; font-family: \'Avenir Medium\'; font-weight: bold;}.additional-data-sources .table-header div:first-child {width: 200px;}.additional-data-sources .table-header div:nth-child(2) {width: 51px;}.additional-data-sources .table-header div:nth-child(3) {width: 30px;}.attribute-config .additional-data-sources .horizontial-line {width: 340px; height: 1px; background: #D8D8D8; margin-top: 6px;}.additional-data-sources .sourcesList {max-height: 460px; overflow-x: hidden; overflow-y: auto; display: flex; flex-direction: column; justify-content: center; align-items: center; padding-right: 7px;}.additional-data-sources .sourcesList .source-tr {display: flex; justify-content: space-between; align-items: center; height: 34px; font-size: 12px; color: #000000; width: 100%; background-repeat: no-repeat;}.additional-data-sources .sourcesList .source-tr:hover {}.additional-data-sources .sourcesList .mid-line {width: 340px; height: 1px; background: #ccc;}.additional-data-sources .sourcesList .source-tr .source-tr-name {width: 200px; cursor: default;}.additional-data-sources .sourcesList .source-tr .source-tr-type {width: 51px;}.additional-data-sources .sourcesList .source-tr .source-tr-action {display: flex; justify-content: space-between; width: 30px; cursor: pointer;}.additional-data-sources .sourcesList .source-tr .source-tr-action .hidden {display: none;}.additional-data-sources .sourcesList .source-tr .source-tr-action div {width: 10px; height: 10px;}.additional-data-sources .sourcesList .edit {cursor: pointer; background-image: url(./images/ds_edit.svg); background-position: center;}.additional-data-sources .sourcesList .edit:hover {background-image: url(./images/ds_edit_hover.svg);}.additional-data-sources .sourcesList .delete {cursor: pointer; background-image: url(./images/ds_delete.svg); background-position: center;}.additional-data-sources .sourcesList .delete:hover {background-image: url(./images/ds_delete_hover.svg);}.additional-data-sources .dijitSelect {background-color: #ffffff;}.additional-data-sources .hidden {display: none;}.data-sources-config .marginTop5 {margin-top: 5px;}.data-sources-config .marginTop15 {margin-top: 15px;}.data-sources-config .marginTop20 {margin-top: 20px;}.data-sources-config .marginLeft5 {margin-left: 5px;}.jimu-rtl .data-sources-config .marginLeft5 {margin-right: 5px; margin-left: 0;}.data-sources-config .marginLeft10 {margin-left: 10px;}.jimu-rtl .data-sources-config .marginLeft10 {margin-right: 10px; margin-left: auto;}.data-sources-config .marginLeft15 {margin-left: 15px;}.jimu-rtl .data-sources-config .marginLeft15 {margin-right: 15px; margin-left: 0;}.data-sources-config .marginLeft20 {margin-left: 20px;}.jimu-rtl .data-sources-config .marginLeft20 {margin-right: 20px; margin-left: 0;}.data-sources-config .data-source-label {font-size: 14px; color: #353535; font-family: \'Avenir Medium\';}.data-sources-config .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .data-source-sub-label {font-size: 12px; color: #353535; font-family: \'Avenir Medium\'; width: 270px;}.data-sources-config .ds-text-box {width: 750px; height: 30px;}.data-sources-config .flex-ltr-start {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .order {display: flex;}.data-sources-config .order .order-btn {width: 64px; height: 30px; font-size: 12px; border: 1px solid #999999; text-align: center; padding: 8px 0; cursor: pointer; color: #666666;}.data-sources-config .order .order-btn:hover {color: #0090A8;}.data-sources-config .order .order-btn.disabled {background: #EEEEEE; cursor: default; color: #CCCCCC; border: none;}.data-sources-config .order .order-btn.selected {background: #24B5CC; border: none; color: #FFFFFF;}.data-sources-config .order .order-btn.selected:hover {color: #FFFFFF;}.data-sources-config .order .order-btn.selected.disabled {background: #CCCCCC; color: #FFFFFF; cursor: default;}.data-sources-config .filterExpr {font-size: 12px; color: #999999; white-space: nowrap;}.data-sources-config .source {font-family: Avenir-Medium; font-size: 12px; color: #353535; cursor: default; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.data-sources-config .radio {margin-top: 3px;}.data-sources-config .refreshContent label,.data-sources-config .refreshContent span {white-space: nowrap;}.data-sources-config .refreshContent {display: flex; justify-content: flex-start; align-items: center;}.data-sources-config .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-config .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-config .timeDiv {width: 70px; margin: auto 10px;}.data-sources-config .button {cursor: pointer; display: none; width: 75px; height: 30px; font-size: 12px; color: #353535; text-align: center; background: #FFFFFF; border: 1px solid #D7D7D7;}.data-sources-config .button:hover {background: #EFEFEF;}.data-sources-config .visible {display: block;}.data-sources-config .hide {display: none !important;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect {width: 186px; background-color: white;}.data-sources-config .layerOptionDiv .resultRecordType .dijitSelect .dijitButtonText span {max-width: 138px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect .dijitButtonText span {max-width: 193px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 12px; color: #232323;}.data-sources-config .layerOptionDiv .groupFields .dijitSelect .dijitButtonText span {max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-config .layerOptionDiv .orderByField .dijitSelect,.data-sources-config .statisticsOptionDiv .groupFields .dijitSelect {width: 250px; background-color: white;}.data-sources-config .layerOptionDiv .custom-number-div,.data-sources-config .layerOptionDiv .custom-number-div .custom-number {width: 60px; height: 30px;}.data-sources-config .inlineBlock {display: inline-block;}.data-sources-config .statisticsDiv .groupFields {display: inline-block; margin-left: 20px;}.data-sources-config .footer,.data-sources-filter .footer {position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: 36px;}.data-sources-config .footer .data-preview,.data-sources-filter .footer .data-preview {width: 115px; height: 30px; border: 1px solid #D7D7D7; cursor: pointer; font-size: 14px; color: #232323; text-align: center; padding: 5px 0;}.data-sources-filter .textOverFlow {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.data-sources-filter .filterByExtent {display: flex; align-content: center;}.data-sources-filter .filterByExtent \x3e label {white-space: nowrap; margin: 0 5px;}.data-sources-filter .footer .data-preview:hover,.data-sources-config .footer .data-preview:hover {background: #EFEFEF;}.data-sources-filter .footer .data-preview.sample-btn {width: 160px;}.data-sources-filter .filter-label {font-family: Avenir-Medium; font-size: 14px; color: #353535;}.data-sources-filter .filterDiv {width: 100%; height: calc(100% - 100px);}.data-sources-filter .margin-left-10 {margin-left: 10px;}.jimu-rtl .data-sources-filter .margin-left-10 {margin-right: 10px; margin-left: 0;}.data-sources-filter {overflow-x: hidden; overflow-y: auto; height: 365px;}.data-sources-filter .sourcesFilterDiv {width: 100%; overflow-y: auto;}.data-sources-config .left-arrow {width: 15px; height: 28px; z-index: 1; background-image: url(images/leftArrow.svg);}.jimu-rtl .data-sources-config .left-arrow.transform {-moz-transform: scaleX(-1); -webkit-transform: scaleX(-1); -o-transform: scaleX(-1); transform: scaleX(-1); filter: FlipH;}.data-sources-config .fieldsOptionDiv {display: flex; align-items: center; position: absolute; width: 175px;}.data-sources-config .suspension {height: 194px; background: #FFFFFF; overflow-x: hidden; box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.30);}.jimu-rtl .data-sources-config .fieldsOption.fields-position-lr {right: 86px; left: inherit;}.data-sources-config .fieldsOption.fields-position-lr {left: 86px; right: inherit;}.data-sources-config .fieldsOption {z-index: 300; margin-top: -118px;}.jimu-rtl .data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {right: 355px; left: inherit;}.data-sources-config .statisticsFieldsOption.statisrics-fields-position-lr {left: 355px; right: inherit;}.data-sources-config .statisticsFieldsOption {z-index: 300; margin-top: -118px;}.jimu-widget-chart-setting-data-fields {width: 100%; margin: 13px 10px 13px 20px;}.jimu-widget-chart-setting-data-fields .fields-content {width: 100%;}.jimu-widget-chart-setting-data-fields .field-item {height: 20px; line-height: 20px; font-size: 12px; margin-top: 7px;}.jimu-rtl .jimu-widget-chart-setting-data-fields .field-item input {margin-left: 6px; margin-right: 0;}.jimu-widget-chart-setting-data-fields .field-item input {margin-right: 6px; position: relative; top: -4px;}.jimu-widget-chart-setting-data-fields .field-item span {width: 100px; display: inline-block; cursor: default;}.jimu-widget-chart-setting-data-fields .operation {display: none;}.custom-logo-page {font-family: Avenir-Book; font-size: 14px; color: #000000; margin-top: 10px;}.custom-logo-page .hide {display: none;}.custom-logo-page .preview-container {width: 130px; height: 130px; position: relative;}.custom-logo-page .preview-container .image-node,.custom-logo-page .preview-container .no-image {position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);}.custom-logo-page .preview-container .image-node {max-width: 50px; max-height: 50px; background-color: #ececec;}.custom-logo-page .preview-container .no-image {background-color: transition; white-space: nowrap;}.custom-logo-page .separator {height: 150px; width: 1px; background: #CCCCCC; margin: 0 35px; border-radius: 2px;}.custom-logo-page .setting-container .setting-item {margin: 10px;}.custom-logo-page .setting-container .setting-item .label {margin: 10px 0;}.custom-logo-page .setting-container .setting-item .link-text {width: 350px;}.custom-logo-page .setting-container .choose-image-btn {width: 100px; height: 30px; border: 1px solid #CCCCCC; text-align: center; line-height: 30px; cursor: pointer;}',
"url:builder/plugins/creation-entry/Plugin.html":"\x3cdiv\x3e\r\n\r\n\x3c/div\x3e\r\n","url:builder/plugins/creation-entry/SaveAsPage.html":'\x3cdiv\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"configureApp"\x3e${nls.savePublish}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderTitle}\x3c/p\x3e\r\n  \x3cp style\x3d"display:none;" class\x3d"appBuilder"\x3e${nls.appBuilderMsg}\x3c/p\x3e\r\n\r\n\r\n  \x3cdiv class\x3d"item-info-box" data-dojo-attach-point\x3d"itemInfoBox" \x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/creation-entry/CreateNewAppPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"app-select-page" data-dojo-attach-point\x3d"appSelectPage"\x3e\r\n    \x3cdiv class\x3d"switch-btn-box-container"\x3e\r\n      \x3cdiv class\x3d"switch-btn-box"\x3e\r\n        \x3cdiv class\x3d"switch-btn all-app-btn selected" data-dojo-attach-point\x3d"allAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onAllAppBtnClick"\x3e ${nls.all}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"separate"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"switch-btn own-app-btn" data-dojo-attach-point\x3d"ownAppBtn"\r\n             data-dojo-attach-event\x3d"onclick:_onOwnAppBtnClick"\x3e ${nls.myTemplates}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content all-app-content" data-dojo-attach-point\x3d"allAppContent"\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"defaultApps"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"app-line" data-dojo-attach-point\x3d"othersApps"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"app-content own-app-content" data-dojo-attach-point\x3d"ownAppContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-info-page" data-dojo-attach-point\x3d"appInfoPage"\x3e\r\n    \x3cdiv class\x3d"app-info-table" data-dojo-attach-point\x3d"appInfoTable"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/creation-entry/css/style.css":".create-app-page {border: 0px solid; position: relative; margin: 0 auto;}.create-app-page .app-select-page {min-height: 200px;}.create-app-page .app-select-page .switch-btn-box-container {height: 50px; position: relative; margin-bottom: 10px; margin-left: 10px;}.create-app-page .app-select-page .switch-btn-box {position: absolute; left: 0; top: 20px; font-size: 14px; color: #999; font-weight: bold; line-height: 20px;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {right: 0; left: auto;}.jimu-rtl .create-app-page .app-select-page .switch-btn-box {margin-right: 8px; margin-left: auto;}.create-app-page .app-select-page .switch-btn-box .switch-btn {display: inline-block; cursor: pointer; font-size: 14px; text-align: center; min-width: 40px; border-bottom: 2px solid transparent;}.create-app-page .app-select-page .switch-btn-box .switch-btn:hover {color: #d84b28;}.create-app-page .app-select-page .switch-btn-box .switch-btn.selected {color: #d84b28; border-bottom: 2px solid #d84b28; min-width: 40px; text-align: center;}.create-app-page .app-select-page .switch-btn-box .separate {display: inline-block; width: 30px;}.create-app-page .app-info-page {width: 100%; border: 0px solid; top: 70px; margin: 0 auto;}.app-select-page .app-content {overflow: hidden;}.app-select-page .all-app-content {overflow: auto; padding: 10px;}.app-select-page .own-app-content {overflow: auto; display: none; padding: 10px;}.app-select-page .app-content .app-line {float: left; width: 100%;}.jimu-rtl .app-select-page .app-content .app-line {float: right;}.app-select-page .app-content .app-node {border: 0px solid; text-align: center; position: relative; margin-right: 14px; cursor: pointer; max-width: 182px;}.app-select-page .app-content .app-node .flag-image {position: absolute; width: 26px; height: 22px; top: 86px; right: 10px; background-position: center; background-repeat: repeat; display: block;}.app-select-page .app-content .app-node .jimu-state-active .flag-image {}.app-select-page .app-content .app-node .flag-image-2D{background-image: url(images/flag_2d.png);}.app-select-page .app-content .app-node .flag-image-3D{background-image: url(images/flag_3d.png);}.app-select-page .app-content .app-node .app-image-border-div {position: relative; width: 180px; height: 120px; border: 2px solid transparent; border-radius: 4px; -webkit-box-shadow:0 0 10px rgba(0, 0, 0, .1); -moz-box-shadow:0 0 10px rgba(0, 0, 0, .1); box-shadow: 0 0 10px rgba(0, 0, 0, .1); background-color: #fff;}.app-select-page .app-content .app-node .app-image-div {width: 120px; height: 80px; background-repeat: no-repeat; background-color: #f2f2f2; background-position: center; margin: 0 auto; margin-top: 18px; background-size: 100% 100%;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-container {width: 180px; height: 120px; background-color: rgba(255,255,255,0.6); position: absolute;}.app-select-page .app-content .app-node .jimu-state-active .app-image-selected-icon{position: absolute; width: 24px; height: 24px; top: 10px; right: 10px; background-position: center;}.app-select-page .app-content .app-node .app-name {color: #333; max-height: 50px; min-height: 20px; padding-top: 10px; padding-bottom: 10px; height: 40px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.app-select-page .app-content .app-node .jimu-state-active {border: 2px solid #31aacd; border-radius: 4px;}",
"url:builder/plugins/header/AppParameters.html":'\x3cdiv class\x3d"app-setting"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"appFormDijit"\x3e\r\n    \x3cdiv class\x3d"form-label"\x3e${nls.title}*\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cinput class\x3d"text-input" placeholder\x3d"${nls.titleTip}" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\', required:true"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"form-label"\x3e${nls.tags}*\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cdiv class\x3d"text-input" placeholder\x3d"${nls.tagsTip}" data-dojo-type\x3d"builder/plugins/header/Tags" data-dojo-attach-point\x3d"tagsDijit"\r\n      data-dojo-props\x3d"name:\'tags\', required:true, value: \'\'"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"form-label"\x3e${nls.summary}\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cinput class\x3d"textarea-input" placeholder\x3d"${nls.summaryTip}" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d"name:\'summary\'"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"form-label"\x3e${nls.saveInFolder}*\x3c/div\x3e\r\n    \x3cdiv\x3e\r\n      \x3cselect class\x3d"select-input" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'folder\', required:true" data-dojo-attach-point\x3d"folderSelect"\x3e\r\n      \x3c/select\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/header/AppItem.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"thumbnail-icon" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/header/Plugin.html":'\x3cdiv class\x3d"top-nav clearfix"\x3e\r\n  \x3cdiv class\x3d"switch-section" data-dojo-attach-point\x3d"switchSection"\x3e\r\n    \x3cdiv class\x3d"switch-container"\x3e\r\n      \x3cdiv id\x3d"app_switch_of_header" class\x3d"jimu-float-leading applist-switch apps selected" data-dojo-attach-point\x3d"appSwitch"\x3e${nls.apps}\x3c/div\x3e\r\n      \x3cdiv id\x3d"template_switch_of_header" class\x3d"jimu-float-leading applist-switch templates" data-dojo-attach-point\x3d"templateSwitch"\x3e${nls.templates}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"dropdown left dropdown-home" data-dojo-attach-point\x3d"homeSection"\x3e\r\n    \x3ca class\x3d"dropdown-btn top-nav-title site_logo" data-dojo-attach-point\x3d"homeLabel"\x3e${nls.home}\x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu" data-dojo-attach-point\x3d"homeMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"homeItem"\x3e${nls.home}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"galleryItem"\x3e${nls.gallery}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"mapItem"\x3e${nls.map}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"sceneItem"\x3e${nls.scene}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"groupsItem"\x3e${nls.groups}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"contentItem"\x3e${nls.content}\x3c/a\x3e\r\n      \x3ca class\x3d"dropdown-link hidden" nowrap target\x3d"_self" href\x3d"#" data-dojo-attach-point\x3d"organizationItem"\x3e${nls.organization}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3ca class\x3d"top-nav-link top-nav-logo left" data-dojo-attach-point\x3d"logoTitle"\x3e\r\n    Web AppBuilder for ArcGIS\r\n  \x3c/a\x3e\r\n\r\n  \x3ch1 class\x3d"avenir-light left text-ellipsis font-size-1 leader-1 app-name"\x3e\r\n    \x3ca target\x3d"_blank" class\x3d"name" data-dojo-attach-point\x3d"appName"\x3e\x3c/a\x3e\r\n    \x3ca target\x3d"_blank" class\x3d"icon" data-dojo-attach-point\x3d"appNameIcno"\x3e\x3c/a\x3e\r\n  \x3c/h1\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right" data-dojo-attach-point\x3d"userSection" data-dojo-attach-event\x3d"onclick:_onUserSectionClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"userInfoDom"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"userIcon" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" width\x3d"16" height\x3d"16"/\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"userNameNode"\x3e\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis" data-dojo-attach-point\x3d"userMenu"\x3e\r\n      \x3ca class\x3d"dropdown-link" nowrap target\x3d"_self" data-dojo-attach-point\x3d"profileItem"\x3e\r\n        \x3cimg width\x3d"32" height\x3d"32" class\x3d"gutter-right-half gutter-left-0 content-box left" data-dojo-attach-point\x3d"profileImg" src\x3d"${folderUrl}/css/images/no-user-thumb.jpg" /\x3e\r\n        \x3cspan\x3e${nls.profile}\x3c/span\x3e\r\n        \x3cbr\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"profileNameNode" class\x3d"profile-name"\x3e\x3c/span\x3e\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"communityNode" class\x3d"hidden dropdown-link dropdown-link-external communityNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.communityAndForums}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"myesriNode" class\x3d"hidden dropdown-link dropdown-link-external myesriNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.myesri}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"trainingNode" class\x3d"hidden dropdown-link dropdown-link-external trainingNode"\x3e\r\n        \x3cspan class\x3d"icon-ui-link-external dropdown-link-external-icon"\x3e\x3c/span\x3e ${nls.training}\r\n      \x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"switchAccountsNode" class\x3d"hidden dropdown-link"\x3e${nls.switchAccounts}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"helpNode" class\x3d"dropdown-link"\x3e${nls.help}\x3c/a\x3e\r\n      \x3ca target\x3d"_blank" data-dojo-attach-point\x3d"adminHelpNode" class\x3d"hidden dropdown-link admin-guide"\x3e${nls.administratorGuide}\x3c/a\x3e\r\n      \x3ca class\x3d"sign-out dropdown-link" data-dojo-attach-point\x3d"signOutItem"\x3e${nls.signOut}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"dropdown right jimu-trailing-margin2" data-dojo-attach-point\x3d"newAppSection" data-dojo-attach-event\x3d"onclick:_onNewAppClicked"\x3e\r\n    \x3ca class\x3d"top-nav-link dropdown-btn top-nav-username text-ellipsis" data-dojo-attach-point\x3d"appsInfoDom"\x3e\r\n      \x3cspan\x3e${nls.newApp}\x3c/span\x3e\r\n    \x3c/a\x3e\r\n    \x3cdiv class\x3d"dropdown-menu dropdown-right text-ellipsis app-menu" data-dojo-attach-point\x3d"appsMenu"\x3e\r\n      \x3cdiv class\x3d"app-menu-item" data-dojo-attach-event\x3d"onclick:_createXTApp" data-dojo-attach-point\x3d"appXTBtn"\x3e\r\n        \x3cdiv class\x3d"app-new icon"\x3e\x3c/div\x3e\r\n        \x3cspan\x3e${nls.createNewApp}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"app-menu-item" data-dojo-attach-event\x3d"onclick:_create2DApp" data-dojo-attach-point\x3d"app2DBtn"\x3e\r\n        \x3cdiv class\x3d"app-2d icon"\x3e\x3c/div\x3e\r\n        \x3cspan\x3e${nls.new2DApp}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"app-menu-item" data-dojo-attach-event\x3d"onclick:_create3DApp" data-dojo-attach-point\x3d"app3DBtn"\x3e\r\n        \x3cdiv class\x3d"app-3d icon"\x3e\x3c/div\x3e\r\n        \x3cspan\x3e${nls.new3DApp}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"command-sep" data-dojo-attach-point\x3d"recentAppsSeperator"\x3e\r\n        ${nls.recentApps}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"apps-container"\x3e\r\n        \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"recentAppsContainer"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/header/css/style.css":'.plugin-header .switch-section{position: absolute; left: 0; right: 0; height: 100%; z-index: -1;}.plugin-header.app-opened .switch-section{display: none;}.plugin-header .switch-section .switch-container{min-width: 1024px; max-width: 1260px; height: 100%; margin-left: auto; margin-right: auto; overflow: hidden;}.plugin-header.width-less1816 .switch-section .switch-container{margin-left: 280px; margin-right: 0;}.jimu-rtl .plugin-header.width-less1816 .switch-section .switch-container{margin-right: 280px; margin-left: 0;}.plugin-header .switch-section .switch-container .applist-switch{height: 100%; line-height: 60px; cursor: pointer; color: #999999; font-size: 14px;}.plugin-header .switch-section .switch-container .applist-switch.selected{color: #31aacd;}.plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 40px;}.jimu-rtl .plugin-header .switch-section .switch-container .applist-switch.apps{margin-right: 0; margin-left: 40px;}.plugin-header.clearfix:after {content: \'\'; display: table; clear: both;}.plugin-header .left {float: left;}.plugin-header .right {float: right;}.plugin-header .avenir-light {letter-spacing: 0em; font-weight: 300; font-style: normal;}.plugin-header .avenir-light b, .plugin-header .avenir-light strong {font-weight: 500;}.plugin-header .avenir-regular,.plugin-header.top-nav,.plugin-header .top-nav-link,.plugin-header .dropdown-link {letter-spacing: 0em; font-weight: 400; font-style: normal;}.plugin-header .avenir-regular b,.plugin-header.top-nav b,.plugin-header .top-nav-link b,.plugin-header .avenir-regular strong,.plugin-header.top-nav strong,.plugin-header .top-nav-link strong {font-weight: 500;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header [class^\x3d"esri-icon-"]:before,.plugin-header [class*\x3d" esri-icon-"]:before,.plugin-header [class^\x3d"icon-ui-"]:before,.plugin-header [class*\x3d" icon-ui-"]:before {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; line-height: 1; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .esri-icon-link-external:before,.plugin-header .icon-ui-link-external:before {content: "\\e65c";}.plugin-header .esri-icon-down-arrow:before,.plugin-header .icon-ui-down-arrow:before,.plugin-header .dropdown-btn:after {content: "\\e608";}.plugin-header .esri-icon-user:before,.plugin-header .icon-ui-user:before {content: "\\e675";}.plugin-header .esri-icon-menu:before,.plugin-header .icon-ui-menu:before {content: "\\e663";}.plugin-header .top-nav-username {max-width: 175px; margin-bottom: -4px;}@media screen and (max-width: 1080px) {.plugin-header .top-nav-username {max-width: 130px;}}.plugin-header.top-nav {font-size: 17px; background-color: white;}.plugin-header.top-nav a {text-decoration: none;}.plugin-header.top-nav .dropdown-btn:after {top: 22px;}.plugin-header.top-nav {padding: 0 .5em; overflow: visible; z-index: 100;}.plugin-header .dropdown {position: relative; display: inline-block;}.plugin-header .dropdown.is-active .dropdown-menu {pointer-events: auto; display: block;}.plugin-header .dropdown-btn:after {font-family: \'CalciteWebCoreIcons\'; padding-right: 0.5166666667em; speak: none; font-style: normal; font-weight: normal; font-variant: normal; text-transform: none; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;}.plugin-header .dropdown-btn:after {padding-right: 0; padding-left: 0.5166666667em;}.plugin-header .dropdown-btn {padding-right: 2em; cursor: pointer; position: relative;}.jimu-rtl .plugin-header .dropdown-btn{padding-right: 0; padding-left: 2em;}.plugin-header .dropdown-btn:after {font-size: 0.8125em; line-height: 1.55em; position: absolute; right: .75em;}.jimu-rtl .plugin-header .dropdown-btn:after{right: auto; left: 0.75em;}.plugin-header .dropdown-menu {position: absolute; left: 0; right: auto; min-width: 200px; max-width: 300px; margin-top: -12px; top: 100%; -webkit-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); -moz-box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); box-shadow: 0 0 16px 0 rgba(0, 0, 0, 0.05); z-index: 1000; pointer-events: none; display: none;}.jimu-rtl .plugin-header .dropdown-menu {left: auto; right: 0;}.plugin-header .dropdown-menu.dropdown-right {left: auto; right: 0;}.jimu-rtl .plugin-header .dropdown-menu.dropdown-right {left: 0; right: auto;}.plugin-header .dropdown-home .dropdown-btn {padding-top: 1em;}.plugin-header .side-nav, .plugin-header .dropdown-menu {-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; border: 1px solid #efefef; border-top: none; background-color: white;}.plugin-header .side-nav-title {margin: 0; padding: 0.5166666667em; font-size: 0.9375em; line-height: 1.55em; background-color: #f8f8f8; border-top: 1px solid #efefef;}.plugin-header .side-nav-link, .plugin-header .dropdown-link {position: relative; display: block; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0.5166666667em 1.55em 0.5166666667em 0.5166666667em; font-size: 0.875em; line-height: 1.55em; color: #6e6e6e; background-color: white; border-top: 1px solid #efefef; -webkit-transition: all 150ms linear; transition: all 150ms linear; text-decoration: none; cursor: pointer;}.plugin-header .side-nav-link:after, .plugin-header .dropdown-link:after {content: "\\00BB"; opacity: 0; position: absolute; right: 0; top: .5em; padding: 0 0.3875em; -webkit-transition: all 150ms linear; transition: all 150ms linear;}.plugin-header .side-nav-link:hover, .plugin-header .dropdown-link:hover {text-decoration: none; color: #828282;}.plugin-header .side-nav-link:hover:after, .plugin-header .dropdown-link:hover:after {opacity: 1;}.plugin-header .side-nav-link.is-active, .plugin-header .is-active.dropdown-link {background-color: #d2e9f9; font-weight: inherit !important;}.plugin-header .dropdown-link {white-space: nowrap;}.plugin-header .dropdown-link-external {padding: 0.5166666667em 2em !important;}.plugin-header .dropdown-link-external-icon {position: absolute; left: .5em;}.plugin-header.top-nav {border-bottom: 1px solid #efefef;}.plugin-header.top-nav .esri-logo {margin-top: 1em;}.plugin-header.top-nav .sign-in {padding-top: 1.55em;}.plugin-header .top-nav-title {font-size: 1em; float: left; padding-top: 15px; padding-bottom: 15px; line-height: 1.5em; color: #4c4c4c;}.plugin-header .top-nav-title:hover {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-title.icon-ui-menu:before {vertical-align: -1px; padding-right: .5em;}.plugin-header .top-nav-list {padding: 0; float: left;}.plugin-header .top-nav-list .top-nav-link + .top-nav-link {margin-left: .75em;}.plugin-header .top-nav-link {font-size: 0.9375em; line-height: 1.55em; color: #4c4c4c; padding: 19px 0; line-height: 1.5em; display: inline-block;}.plugin-header .top-nav-link:hover, .plugin-header .top-nav-link:focus {color: #3b8fc4; background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent; text-decoration: none;}.plugin-header .top-nav-link:hover a, .plugin-header .top-nav-link:focus a {color: #3b8fc4;}.plugin-header .top-nav-link:focus {outline: none;}.plugin-header .top-nav-link.is-active {background: url(\'./images/top-nav-ie9.gif\') repeat-x bottom left transparent;}.plugin-header .top-nav-link a {color: #4c4c4c;}.plugin-header .top-nav-link a:hover {text-decoration: none;}.plugin-header .top-nav-link.dropdown-btn {padding-right: 1em;}.plugin-header .top-nav-link.dropdown-btn:after {right: 0;}.plugin-header .user-nav-name {padding: 0.3875em;}.plugin-header .user-nav-image {width: 1.55em; height: 1.55em; margin-right: 0.3875em; vertical-align: -0.3875em;}.plugin-header .link-blue a, .plugin-header a.link-blue {color: #3b8fc4;}.plugin-header .link-blue a:hover, .plugin-header a.link-blue:hover {color: #196fa6;}.plugin-header .link-darkest-gray a,.plugin-header a.link-darkest-gray {color: #595959;}.plugin-header .link-darkest-gray a:hover, .plugin-header a.link-darkest-gray:hover {color: #4c4c4c;}.plugin-header .text-ellipsis {white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.plugin-header .font-size--3 {font-size: 0.8125em; line-height: 1.55em;}.plugin-header .font-size--2 {font-size: 0.875em; line-height: 1.55em;}.plugin-header .font-size--1 {font-size: 0.9375em; line-height: 1.55em;}.plugin-header .font-size-0 {font-size: 1em; line-height: 1.55em;}.plugin-header .font-size-1 {font-size: 1.1875em; line-height: 1.55em;}.plugin-header .font-size-2 {font-size: 1.25em;}.plugin-header .font-size-3 {font-size: 1.484375em; line-height: 2.325em;}.plugin-header .leader-half {margin-top: 11px;}.plugin-header .trailer-half {margin-bottom: 0.775em;}.plugin-header .padding-leader-half {padding-top: 0.775em;}.plugin-header .padding-trailer-half {padding-bottom: 0.775em;}.plugin-header .leader-0 {margin-top: 0em;}.plugin-header .trailer-0 {margin-bottom: 0em;}.plugin-header .padding-leader-0 {padding-top: 0em;}.plugin-header .padding-trailer-0 {padding-bottom: 0em;}.plugin-header .leader-1 {margin-top: 14px;}.plugin-header .padding-leader-1 {padding-top: 22px;}.plugin-header .gutter-left-half {padding-left: 0.5em;}.plugin-header .gutter-right-half {padding-right: 0.5em;}.plugin-header .gutter-left-0 {padding-left: 0em;}.plugin-header .gutter-right-0 {padding-right: 0em;}.plugin-header .gutter-left-1 {padding-left: 1em;}.plugin-header .gutter-right-1 {padding-right: 1em;}.plugin-header .gutter-right-2 {padding-right: 2em;}.jimu-rtl .plugin-header .gutter-left-half {padding-left: 0; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-right: 0; padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0; padding-right: 0;}.jimu-rtl .plugin-header .gutter-left-1 {padding-left: 0; padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-right: 0; padding-left: 1em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-right: 0; padding-left: 2em;}.jimu-rtl .plugin-header .left {float: right;}.jimu-rtl .plugin-header .right {float: left;}.jimu-rtl .plugin-header .top-nav-title {float: right;}.jimu-rtl .plugin-header .top-nav-link {float: right;}.jimu-rtl .plugin-header .top-nav-list {float: right;}.jimu-rtl .plugin-header .top-nav-link + .top-nav-link {margin-left: 0; margin-right: .75em;}.jimu-rtl .plugin-header .gutter-left-half {padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-half {padding-left: 0.5em;}.jimu-rtl .plugin-header .gutter-left-0 {padding-right: 0em;}.jimu-rtl .plugin-header .gutter-right-0 {padding-left: 0em;}.jimu-rtl .plugin-header .gutter-left-1 {padding-right: 1em;}.jimu-rtl .plugin-header .gutter-right-1 {padding-left: 1em; padding-right: 0.5em;}.jimu-rtl .plugin-header .gutter-right-2 {padding-left: 2em;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn:after {left: 0; right: auto; padding-right: 0.5166666667em; padding-left: 0;}.jimu-rtl .plugin-header .top-nav-link.dropdown-btn {padding-left: 1em; padding-right: 0;}.jimu-rtl .plugin-header .side-nav-link:after, .jimu-rtl .plugin-header .dropdown-link:after {left: 0; right: auto;}.jimu-rtl .plugin-header .side-nav-link, .jimu-rtl .plugin-header .dropdown-link {padding: 0.5166666667em 0.5166666667em 0.5166666667em 2.5em;}.jimu-rtl .plugin-header [class^\x3d"icon-ui-"]:before, .jimu-rtl .plugin-header [class*\x3d" icon-ui-"]:before {padding-right: 0; padding-left: 0.5166666667em;}.jimu-rtl .plugin-header .sub-nav-link, .jimu-rtl .plugin-header a.sub-nav-link {float: right;}.jimu-rtl .plugin-header .dropdown-link-external-icon {left: auto; right: .5em;}.plugin-header.top-nav .hidden {display: none;}.plugin-header .top-nav-logo {padding-left: 36px; padding-right: 15px; background: url(images/logo.png) no-repeat left center;}.plugin-header .top-nav-logo:hover {background: url(images/logo.png) no-repeat left center;}.plugin-header.xt.app-opened .top-nav-logo{cursor: pointer;}.jimu-rtl .plugin-header .top-nav-logo {padding-left: 15px; padding-right: 36px; background: url(images/logo.png) no-repeat right center;}.jimu-rtl .plugin-header .top-nav-logo {background: url(images/logo.png) no-repeat right center;}.plugin-header .content-box {box-sizing: content-box !important;}.plugin-header .app-name {max-width: 60%; display: flex; justify-content: center; align-items: center;}.plugin-header .app-name .name{color: black;}.plugin-header .app-name .name.highlight{background-image: -webkit-linear-gradient(left, #3b8fc4 calc(50% - 1px), #ccc calc(50% - 1px)); background-image: linear-gradient(90deg, #3b8fc4 calc(50% - 1px), #ccc calc(50% - 1px)); transition: background-position-x .4s; background-position: 100% calc(100% - .05em); background-repeat: no-repeat; background-size: 200% 1px;}.plugin-header .app-name .name.highlight:hover {background-position-x: 0;}.plugin-header .app-name .icon{display: none;}.plugin-header .app-name .icon.highlight{display: flex; background: url(images/details.svg) center center no-repeat; background-size: contain; width: 15px; height: 15px; margin: auto 5px; cursor: pointer;}.plugin-header .app-name a.highlight:hover{color: #3b8fc4;}@media screen and (max-width: 960px) {.plugin-header .app-name {max-width: 40%;}}@media screen and (max-width: 720px) {.plugin-header .app-name {max-width: 30%;}}.plugin-header .top-nav-logo{position: relative; top: 1px;}.plugin-header .top-nav-username{font-size: 14px;}.plugin-header .top-nav-username img{position: relative; top: 3px;}.plugin-header .top-nav-username span{position: relative;}.plugin-header.app-not-opened{background-color: #333333;}.plugin-header.app-not-opened .top-nav-link.top-nav-logo{color: #ffffff !important;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch{color: #999999;}.plugin-header.app-not-opened .switch-section .switch-container .applist-switch.selected{color: #ffffff;}.plugin-header.app-not-opened .top-nav-link.top-nav-username{color: #999999 !important;}.plugin-header .app-menu {width: 286px; border: 1px solid #ddd;}.plugin-header .app-menu-item {height: 40px; border-bottom: 1px solid #ddd; line-height: 40px; font-size: 14px; color: #666; cursor: pointer;}.plugin-header .app-menu-item:hover {background-color: #EEE;}.plugin-header .app-menu-item .icon {width: 16px; height: 16px; margin: 12px 10px; background-size: 16px; display: inline-block; vertical-align: bottom;}.plugin-header .app-menu-item .app-new {background-image: url(images/icon_newApp.svg); width: 13px; height: 13px; margin: 14px 12px; background-size: 13px 13px;}.plugin-header .app-menu-item .app-2d {background-image: url(images/icon_2d.svg);}.plugin-header .app-menu-item .app-3d {background-image: url(images/icon_3d.svg);}.plugin-header .command-sep {background-color: #EEE; border-bottom: 1px solid #ddd; height: 35px; line-height: 35px; font-size: 14px; padding: 0 12px; color: #666;}.plugin-header .command-sep div {font-size: 12px; line-height: 24px; margin-left: 20px;}.jimu-rtl .plugin-header .command-sep div {margin-right: 20px; margin-left: auto;}.plugin-header .app-menu-item {height: 40px;}.app-setting {width: 400px; margin: 0 auto 20px;}.app-setting .form-label{font-size: 14px; margin: 20px 0 10px 0;}.app-setting .form-label:first-child{margin-top: 0;}.app-setting .dijitTextBox,.app-setting .dijitSelect {width: 400px;}.app-setting .esriTags .grid_1,.app-setting .esriTags .grid_2 {float: none;}.app-setting .esriTags .select2-container {height: auto; width: 400px;}.app-setting .esriTags .select2-container .dijitTextBox {width: 400px;}.app-setting textarea.dijitTextBox {width: 400px; height: 80px; resize: none;}.apps-container .app-item:last-child {border-bottom: none;}.app-item {border-bottom: 1px solid #ddd; cursor: pointer;}.app-item:hover {background: #EEEEEE;}.app-item .thumbnail-icon {width: 67px; height: 47px; margin: 10px; display: inline-block; vertical-align: middle; background-size: 67px 44px;}.app-item .thumbnail-icon.default {background-image: url(images/default.jpg);}.app-item .label {display: inline-block; vertical-align: top; margin-top: 10px; font-size: 14px; color: #666; max-width: calc(100% - 100px); padding-right: 10px; white-space: normal; overflow: hidden; text-overflow: ellipsis; line-height: 1em; max-height: 3em;}.jimu-rtl .app-item .label{padding-right: auto; padding-left: 10px;}',
"url:builder/plugins/map-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"map-info-section"\x3e\r\n    \x3cdiv class\x3d"map-selected-meta-data"\x3e\r\n      \x3cdiv class\x3d"thumbnail-container" data-dojo-attach-point\x3d"thumbnailContainer" data-dojo-attach-event\x3d"click:showMapSelector" title\x3d"${nls.clickChooseWebMapOrWebScene}"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"detail-info"\x3e\r\n        \x3cdiv style\x3d"overflow:hidden;"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webItemIcon" class\x3d"web-item-icon jimu-float-leading"\x3e\x3c/div\x3e\r\n          \x3cdiv class\x3d"owner-div jimu-float-leading" style\x3d"width:140px;"\x3e\r\n            \x3cspan class\x3d"item-type" data-dojo-attach-point\x3d"webItemType"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"owner-link-div"\x3e\r\n          \x3cspan class\x3d"owner-tip"\x3e${nls.owner}\x3c/span\x3e\r\n          \x3ca class\x3d"owner-name" href\x3d"#" target\x3d"_blank" data-dojo-attach-point\x3d"ownerName"\x3e\x3c/a\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"color:#596679;"\x3e\r\n          \x3cspan\x3e${nls.lastModified}:\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"lastModified" class\x3d"last-modified"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"webmap-details-div"\x3e\r\n          \x3ca data-dojo-attach-point\x3d"webMapDetails" href\x3d"#" target\x3d"_blank" class\x3d"webmap-details" title\x3d"${nls.moreDetails}"\x3e${nls.moreDetails}...\x3c/a\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"map-chooser"\x3e\r\n          \x3cdiv nowrap class\x3d"choose-map-btn" data-dojo-attach-event\x3d"click:showMapSelector"\x3e\r\n            \x3cdiv class\x3d"label" data-dojo-attach-point\x3d"chooseMapButton" title\x3d"${nls.chooseWebMapOrWebScene}"\x3e${nls.chooseWebMapOrWebScene}\x3c/div\x3e\r\n            \x3cdiv class\x3d"options jimu-float-trailing" data-dojo-attach-point\x3d"mapOptions" data-dojo-attach-event\x3d"click:showMapOptions"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapEditOptions" class\x3d"edit-options" style\x3d"display: none;"\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnEditWebMap" data-dojo-attach-event\x3d"click:editWebMap" title\x3d"${nls.editMap}"\x3e${nls.editMap}\x3c/div\x3e\r\n            \x3cdiv nowrap class\x3d"option-item" data-dojo-attach-point\x3d"btnCreateWebMap" data-dojo-attach-event\x3d"click:createWebMap" title\x3d"${nls.createMap}"\x3e${nls.createMap}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"webMapOptionsMask" class\x3d"overlay-mask" data-dojo-attach-event\x3d"click:hideMapOptions" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"map-info-content"\x3e\r\n      \x3cdiv class\x3d"map-info-title option-title" data-dojo-attach-point\x3d"mapTitle"\x3e\x3c/div\x3e\r\n      \x3cp class\x3d"snippet" data-dojo-attach-point\x3d"snippet"\x3e\x3c/p\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions2D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialExtent}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.statement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useCurrentMapExtent"\x3e${nls.useCurrentExtent}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_useDefaultMapExtent"\x3e${nls.restoreInitialExtent}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"map-option scale-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.scaleTitle}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.scaleStatement}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn scale-btn jimu-btn-vacation" data-dojo-attach-point\x3d"btnScale" data-dojo-attach-event\x3d"onclick:_onBtnScaleClicked"\x3e${nls.customize}...\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"builder/dijit/RefreshInterval" data-dojo-attach-point\x3d"refreshIntervalDijit"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"map-options" data-dojo-attach-point\x3d"mapOptions3D"\x3e\r\n        \x3cdiv class\x3d"map-option extent-option"\x3e\r\n          \x3cdiv class\x3d"option-title"\x3e${nls.setInitialSceneState}\x3c/div\x3e\r\n          \x3cp class\x3d"option-statement"\x3e${nls.sceneStateTip}\x3c/p\x3e\r\n          \x3cspan class\x3d"jimu-btn init-ext-btn jimu-btn-vacation" title\x3d"${nls.useCurrentSceneState}" data-dojo-attach-event\x3d"onclick:_useCurrentViewpoint"\x3e${nls.useCurrentSceneState}\x3c/span\x3e\x3cbr\x3e\r\n          \x3cspan class\x3d"jimu-btn restore-ext-btn jimu-btn-vacation" title\x3d"${nls.useWebSceneDefaultState}" data-dojo-attach-event\x3d"onclick:_useDefaultViewpoint"\x3e${nls.useWebSceneDefaultState}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapSelector.html":'\x3cdiv style\x3d"position:relative;width:100%;height:100%;"\x3e\r\n\t\x3cdiv class\x3d"map-setting-tab-container" style\x3d"width:100%;height:100%;"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onMyContentRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"mycontentSelect" data-dojo-attach-event\x3d"change:_onMyContentSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"  style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onOrgRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"organizationSelect" data-dojo-attach-event\x3d"change:_onOrganizationSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:65px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:70px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"groupSearchSection"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onGroupRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"groupSelect" data-dojo-attach-event\x3d"change:_onGroupSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified" selected\x3d"true"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'" style\x3d"top:113px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"search-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" class\x3d"jimu-float-leading"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"refresh-icon jimu-float-trailing" data-dojo-attach-event\x3d"click:_onPublicRefreshIconClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"publicSelect" data-dojo-attach-event\x3d"change:_onPublicSearch" class\x3d"jimu-float-trailing restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"modified"\x3e${nls.mostRecent}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"numviews" selected\x3d"true"\x3e${nls.mostViewed}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"avgrating"\x3e${nls.highestRated}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"title"\x3e${nls.title}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"owner"\x3e${nls.owner}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tid\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalNameLabel" for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-name"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tid\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlineNameLabel" for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading online-name"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicMapSection" class\x3d"public-map-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineMapTable" data-dojo-type\x3d"builder/plugins/map-config/MapTable" data-dojo-props\x3d"type:\'${type}\'"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section hidden" data-dojo-attach-point\x3d"signinSection"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section hidden" data-dojo-attach-point\x3d"filteredMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section hidden" data-dojo-attach-point\x3d"searchNoneTipSection"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/CustomizeScale.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"scale-input-div" data-dojo-attach-point\x3d"scaleInputDiv"\x3e\r\n    \x3cdiv class\x3d"add-btn jimu-float-leading" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onBtnAddClicked"\x3e+\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"operations-div"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn delete-btn" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onBtnDeleteClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.deleteTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading operation-btn reset-btn" data-dojo-attach-event\x3d"onclick:_onBtnResetClicked"\x3e\r\n      \x3cspan class\x3d"jimu-float-leading icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"jimu-float-leading label"\x3e${nls.resetTip}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"list" data-dojo-attach-point\x3d"listNode" data-dojo-attach-event\x3d"onclick:_onLodListClicked"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/map-config/css/style.css":".map-config{margin: 0; padding: 0; overflow-y: hidden;}.map-config .hidden{display: none;}.map-config .map-info-section{position:absolute; left: 20px; right: 20px; top: 20px; bottom: 0;}.map-config .big-img{position:relative; width:100%; height:240px; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background:#e5e5e5;}.map-config .add-map-tip{margin-top:13px; padding-left:6px; padding-right:6px; color:#999999; font-size:12px;}.map-config .map-selected-meta-data{position: relative; width: 100%; height: 133px;}.map-config .thumbnail-container{position:absolute; left: 0; right: auto; top: 0; width:190px; height:133px; cursor: pointer;}.jimu-rtl .map-config .thumbnail-container{left: auto; right: 0;}.map-config .thumbnail-container .thumbnail{width: 100%; height: 100%; background-color:#e5e5e5; border:1px solid #d2dae2; background-repeat:no-repeat; background-position:center center; background-size:cover;}.map-config .thumbnail-container .thumbnail.default-webmap{background-image: url(images/WebMapThumbnail.png);}.map-config .thumbnail-container .thumbnail.default-webscene{background-image: url(images/WebSceneThumbnail.jpeg);}.map-config .detail-info{position: absolute; left: 200px; top: 0; right: 0; height: 100%; color: #333333; font-size: 12px; display: flex; flex-direction: column; justify-content: space-between;}.has-mozilla .map-config .detail-info{font-size: 12px;}.jimu-rtl .map-config .detail-info{left: 0; right: 200px;}.map-config .web-item-icon{display: inline-block; width: 16px; height: 16px; background-position: center center; background-repeat: no-repeat;}.map-config .web-item-icon.webmap{background-image: url(images/WebMapIcon.png);}.map-config .web-item-icon.webscene{background-image: url(images/WebSceneIcon.png);}.map-config .owner-div{padding-left: 5px; color: #596679;}.jimu-rtl .map-config .owner-div{padding-left: 0; padding-right: 5px;}.map-config .owner-link-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .owner-link-div .owner-name{color: #24B5CC; text-decoration: none;}.map-config .owner-link-div .owner-name:hover{text-decoration: underline;}.map-config .last-modified{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.map-config .webmap-details-div{white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}html.ar .map-config .webmap-details-div{margin-top: 0;}.map-config .webmap-details{text-decoration: none; color: #24B5CC;}.map-config .webmap-details:hover{text-decoration: underline;}.map-config .map-info-content{position: absolute; width: 100%; left: 0; right: 0; top: 143px; bottom: 0; overflow: auto;}.map-config .snippet{max-height:115px; overflow: hidden; text-overflow: ellipsis; margin-top: 10px; font-size:12px; color: #666;}.map-config .map-options{display: none;}.map-config .map-options.enabled{display: block;}.map-config .extent-option{margin-top: 33px;}.map-config .option-title{font-size: 14px; color: #000; font-family: 'Avenir Medium';}.map-config .option-statement{font-size: 12px; color: #999; margin-top: 9px;}.map-config .init-ext-btn{margin-top:10px;}.map-config .restore-ext-btn{margin-top:10px;}.map-config .scale-option{margin-top: 38px;}.map-config .scale-btn{margin-top: 10px;}.map-config .refresh-interval{margin-top: 38px; margin-bottom: 30px; padding-right: 10px;}.jimu-rtl .map-config .refresh-interval{padding-right: 0; padding-left: 10px;}.map-config .map-chooser{position: relative; width: 100%;}.map-config .overlay-mask{position: fixed; width: 100%; height: 100%; left: 0; top: 0; z-index: 119;}.map-config .edit-options{box-shadow: 0 0 16px rgba(160,160,160,0.4); background-color: white; z-index: 120; width: 160px; position: absolute; left: 0; top: 36px;}.jimu-rtl .map-config .edit-options{left: auto; right: 0;}.map-config .edit-options \x3e .option-item{width: 100%; height: 36px; cursor: pointer; line-height: 36px; font-size: 14px; white-space:nowrap; overflow:hidden; text-align: left; text-overflow: ellipsis; background-color: #24B5CC; color: #ffffff; border-top: 2px solid #ffffff; padding: 0 10px;}.jimu-rtl .map-config .edit-options \x3e .option-item{text-align: right;}.map-config .edit-options \x3e .option-item:hover{background-color: #0090A7;}.map-config .choose-map-btn{width: 160px; height: 36px; overflow:hidden; text-align: center; background-color: #24B5CC; cursor: pointer;}.map-config .choose-map-btn .label{display: inline-block; line-height: 36px; text-overflow: ellipsis; white-space:nowrap; font-size: 14px; color: #ffffff; max-width: 140px; padding: 0 5px; overflow: hidden;}.map-config .choose-map-btn .label:hover{background-color: #0090A7;}.map-config .choose-map-btn .options{display: inline-block; height: 36px; background: url('images/v-White.png') no-repeat center; width: 20px; border-left: 1px solid rgba(255, 255, 255, 0.3);}.map-config .choose-map-btn .options:hover{background-color: #0090A7;}.jimu-rtl .map-config .choose-map-btn .options{border-left: none; border-right: 1px solid rgba(255, 255, 255, 0.3);}.map-config .jimu-btn{padding: 0 15px; font-size: 14px; line-height: 34px; text-align: center; max-width: 100%;}.map-config .jimu-btn.jimu-btn-vacation:hover{background-color: #0090A7; color: white; border-color: #0090A7;}.map-config .jimu-btn.jimu-btn-vacation.jimu-state-disabled{background: #E0E0E0; color: #666;}.map-config .map-info-title{margin-top:10px;}.map-config .option-title.map-info-title{font-size: 12px;}.map-config .set-extent-tip{color:#999999; font-size:12px;}.map-config .description{position:absolute; top:420px; bottom:0; width:100%; overflow:auto; color:#999999; font-size:12px;}.map-table{position:absolute; width: 100%; top:0; bottom: 0; height: auto;}.map-table .maps-section{position: absolute; width: 100%; top: 0; bottom: 0;}.map-table .maps-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.map-table .maps-table{width: 100%; table-layout: fixed; border-collapse: collapse;}.map-table .maps-table td{vertical-align:top;}.map-table .map-item-div{width:176px; padding:3px;}.map-table .map-item-div .map-item-bg{position:relative; width:100%; height:118px; text-align:center; color:#999999; font-size:13px;}.map-table .map-item-div .map-item-bg .map-item-thumbnail{position:absolute; left:0; top:0; width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid #d2dae2; background-size:cover;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-thumbnail{left: auto; right: 0;}.map-table .map-item-div .map-item-bg.selected .map-item-thumbnail{outline: 3px solid #24B5CC;}.map-table .map-item-div .map-item-bg .map-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:15px; height:15px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/info.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-rtl .map-table .map-item-div .map-item-bg .map-item-detail-icon{right: auto; left: 7px;}.map-table .map-item-div .map-item-bg:hover .map-item-detail-icon{display: block;}.map-table .map-item-div .map-item-title{display:inline-block; width:100%; max-height: 31px; text-align:center; color:#596679; font-size:13px; margin-top: 10px; overflow: hidden; word-wrap: break-word;}.map-table .search-none-tip-section .search-none-icon{margin-left:5px;}.jimu-rtl .map-table .search-none-tip-section .search-none-icon{margin-left: 0; margin-right: 5px;}.map-table .search-none-tip-section .search-none-tip{font-size:13px; color:#ff0000; margin-left:10px;}.jimu-rtl .map-table .search-none-tip-section .search-none-tip{margin-left: 0; margin-right: 10px;}.map-selector .hidden{display: none;}.map-selector .jimu-tab3{height: 100%;}.map-selector .jimu-tab3\x3e.container-node{position:absolute; width:100%; left:0; right:0; top:60px; bottom:0;}.map-selector .jimu-tab3 .tab-item-div{height: 48px; line-height: 48px;}.map-selector .tab-content{position: relative;}.map-selector .tab-content .tab-content-main{position: absolute; width: 100%; top:0; bottom:0;}.map-selector .search-section{position:absolute; width:100%; height:45px; top: 15px; font-size: 12px;}.map-selector .search-section .jimu-search{width: 81%;}.map-selector .search-section .dijitSelect{box-sizing: border-box;}.map-selector .refresh-icon{width: 16px; height: 16px; cursor: pointer; background: url(images/reset1.png) center center no-repeat; margin-top: 12px; margin-left: 7px;}.jimu-rtl .map-selector .refresh-icon{margin-left: auto; margin-right: 7px;}.map-selector .search-section .restrict-select-width{position: relative; width: 146px; top: 5px;}.map-selector .public-search-radios{position:absolute; width:100%; top:75px; height: 20px; line-height:1em; font-size: 14px;}.map-selector .public-search-radios \x3e *{vertical-align: middle; line-height: 18px;}.map-selector .public-search-radios span{display: inline-block;}.map-selector .public-search-radios .portal-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .portal-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-search-radios .portal-name{margin-right: 28px;}.jimu-rtl .map-selector .public-search-radios .portal-name{margin-right: 0; margin-left: 28px;}.map-selector .public-search-radios .online-public-radio{margin-right: 10px;}.jimu-rtl .map-selector .public-search-radios .online-public-radio{margin-right: 0; margin-left: 10px;}.map-selector .public-map-section{position:absolute; width:100%; top:100px; bottom:0;}.map-selector .signin-section{position: absolute; top:75px; width:100%;}.map-selector .signin-section .signin-tip{width:100%; color:#d6d6d6; font-size:13px;}.map-selector .groups-section{font-size: 14px;}.map-selector .groups-section .groups-select{height: 30px; padding: 0 5px;}.mapconfig-customize-scale{width: 100%; height: 100%;}.mapconfig-customize-scale .scale-input-div{position:relative; height:30px;}.mapconfig-customize-scale .add-btn{width: 30px; height: 100%; line-height: 30px; color: #ffffff; font-size: 28px; text-align: center; vertical-align: center; cursor: default; background-color: #d2dae2;}.claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: left;}.jimu-rtl .claro .mapconfig-customize-scale .scale-input-div .dijitNumberTextBox input.dijitInputInner{text-align: right;}.mapconfig-customize-scale .scale-input-div:hover .add-btn{background-color: #24B5CC;}.mapconfig-customize-scale .operations-div{height: 24px; margin-top: 13px; margin-bottom: 2px;}.mapconfig-customize-scale .operation-btn{display: inline-block; overflow: hidden; height: 24px; cursor: default; font-size: 13px;}.mapconfig-customize-scale .operation-btn .icon{width: 14px; height: 100%; background-repeat: no-repeat; background-position: center center;}.mapconfig-customize-scale .delete-btn{color: #a0acbf; cursor: default;}.mapconfig-customize-scale .delete-btn.enabled-operation{color: #518dca; cursor: pointer;}.mapconfig-customize-scale .delete-btn .icon{background-image: url(images/delete1.png);}.mapconfig-customize-scale .delete-btn.enabled-operation .icon{background-image: url(images/delete2.png);}.mapconfig-customize-scale .reset-btn .icon{background-image: url(images/reset2.png);}.mapconfig-customize-scale .reset-btn{margin-left: 15px; color: #24B5CC; cursor: pointer;}.jimu-rtl .mapconfig-customize-scale .reset-btn{margin-left: 0; margin-right: 15px;}.mapconfig-customize-scale .operation-btn .label{height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px;}.jimu-rtl .mapconfig-customize-scale .operation-btn .label{margin-left: 0; margin-right: 7px;}.mapconfig-customize-scale .list{width: 100%; height: 395px; border: 1px solid #dfe4ea; background-color: #fafafc; color: #7989a0; font-size: 14px; overflow: auto;}.mapconfig-customize-scale .list .lod-item{height: 30px; line-height: 30px; padding-left: 10px; cursor: default; border-bottom: 1px solid #f2f4f7;}.mapconfig-customize-scale .list .lod-item.selected{background-color: #e3ecf2; color: #596670;}.embed-mapviewer-content {width: 100%; height: 100%; position: relative;}.embed-mapviewer-content .load-container {float: left; position: absolute; overflow: hidden; bottom: 60px; right: 20px;}.embed-mapviewer-content .load-container .loader {font-size: 20px; width: 1.5em; height: 1.5em; border-radius: 50%; position: relative; text-indent: -9999em;}",
"url:builder/plugins/popup-actions/popup-agoltemplate/css/style.css":".plugin-app-actions-template-popup .template-popup-content {height: 100%;}.plugin-app-actions-template-popup .template-popup-content .config-part {width: 70%; height: 100%;}.plugin-app-actions-template-popup .template-popup-content .privew-part-box {height: 100%; width: 30%; padding: 10px 0 10px 0;}.plugin-app-actions-template-popup .template-popup-content .privew-part-inset-box {height: 100%; width: 100%; box-shadow: 0px 0px 8px rgba(0,0,0,0.4) inset; overflow-y: auto; overflow-x: hidden; -ms-overflow-y: auto; -ms-overflow-x: hidden;}.plugin-app-actions-template-popup .template-popup-content .privew-part {width: 90%; height: 100%; min-width: 275px; max-width: 500px; margin: 0 auto;}.plugin-app-actions-template-popup-for-xt .button-container {overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-btn {position: relative; overflow: visible;}.plugin-app-actions-template-popup-for-xt .export-draw-box {position: absolute; height: 60px; background-color: #cccccc; top: -61px; left: 0; cursor: default; background: #fff; box-shadow: 0 0 4px #646464; color: #7989a0; text-align: left; max-width: 270px; overflow: hidden;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box {right: 0; left: auto;}.plugin-app-actions-template-popup-for-xt .export-draw-box.export-draw-box-hiden{display: none;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{cursor: pointer; height: 30px; padding-left: 20px; padding-right: 20px;}.jimu-rtl .plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn{text-align: right;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn:hover{background: #edf2f5; color: #15a4fa;}.plugin-app-actions-template-popup-for-xt .export-draw-box .export-draw-box-btn.export-draw-box-btn-disable{color: #d2dae2;}",
"url:jimu/dijit/templates/ShareOptions.html":'\x3cdiv class\x3d"shareOptions"\x3e\r\n  \x3cdiv class\x3d"shareOptionsWrapper"\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.shareMap}\x3c/div\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.shareMapTips}\x3c/div\x3e\r\n    \x3cdiv id\x3d"share-everyone-check_div" class\x3d"shareOptionItems" data-dojo-attach-point\x3d"share-everyone-check_div"\x3e\r\n      \x3cinput id\x3d"share-everyone-check" data-dojo-attach-point\x3d"shareEveryoneCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-everyone-check-label" for\x3d"share-everyone-check" class\x3d"labels"\x3e${nls.everyone}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-account-check_div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-account-check_div"\x3e\r\n      \x3cinput id\x3d"share-account-check" data-dojo-attach-point\x3d"share-account-check" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-account-check-label" for\x3d"share-account-check" class\x3d"labels"\x3e\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv id\x3d"share-groups-div" class\x3d"shareOptionItems displaynone" data-dojo-attach-point\x3d"share-groups-div"\x3e\r\n      \x3cinput id\x3d"share-groups-check" data-dojo-attach-point\x3d"shareGroupsCheck" data-dojo-type\x3d"dijit/form/CheckBox" type\x3d"checkbox"/\x3e\r\n      \x3clabel id\x3d"share-groups-check-label" for\x3d"share-groups-check" class\x3d"labels"\x3e${nls.theseGroups}\x3c/label\x3e\r\n      \x3cdiv class\x3d"share-groups-wrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/layout/BorderContainer" gutters\x3d"false" design\x3d"headline" class\x3d"borderContainer"\x3e\r\n          \x3cdiv id\x3d"share-groups-list" class\x3d"share-groups-list" dojotype\x3d"dijit.layout.ContentPane" region\x3d"middle" splitter\x3d"false"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ShareLink.html":'\x3cdiv class\x3d"shareLink"\x3e\r\n  \x3cdiv class\x3d"shareLinkOptionsWrapper displaynone"\x3e\r\n    \x3cdiv role\x3d"button" data-dojo-attach-point\x3d"backBtn" class\x3d"backBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkOptionsTitle"\x3e${nls.linkOptions}\x3c/div\x3e\r\n    \x3cdiv class\x3d"subTitle"\x3e${nls.linkOptionsUrlParameters}\x3c/div\x3e\r\n    \x3cform data-id\x3d"shareOptionsRadios" data-dojo-attach-point\x3d"shareOptionsRadios"\x3e\r\n      \x3cfieldset\x3e\r\n        \x3clegend class\x3d"screen-readers-only"\x3e${nls.linkOptionsUrlParameters}\x3c/legend\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"currentMapExtent" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"currentMapExtent" data-dojo-type\x3d"dijit.form.RadioButton" data-dojo-props\x3d\'checked:true\' checked\x3e\r\n            \x3cdiv class\x3d"labels" data-forid\x3d"currentMapExtent"\x3e${nls.currentMapExtent}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"chooseCenterWithLevelRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"chooseCenterWithLevel" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithLevel" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels" data-forid\x3d"chooseCenterWithLevel"\x3e${nls.chooseCenterWithLevel}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithLevel_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithLevel_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithLevel_levels" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"chooseCenterWithScale" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"chooseCenterWithScale" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.chooseCenterWithScale}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore chooseCenterWithScale_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"chooseCenterWithScale_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cselect data-dojo-attach-point\x3d"chooseCenterWithScale_scales" class\x3d"shareSelects" style\x3d"display: none !important;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsRow" data-dojo-attach-point\x3d"findLocationRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"findLocation" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"findLocation" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.findLocation}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore findLocation_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"findLocation_input" tabindex\x3d"0" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.findLocation_inputPlaceholder}"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"queryFeature" tabindex\x3d"0" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"queryFeature" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.queryFeature}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore queryFeature_optionsMore"\x3e\r\n            \x3cdiv class\x3d"moreOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"queryFeature_layer" name\x3d"queryFeature_layer" class\x3d"queryFeature_layer"\x3e\x3c/div\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_field" name\x3d"queryFeature_field" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n              \x3cselect data-dojo-attach-point\x3d"queryFeature_value" name\x3d"queryFeature_value" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsRow"\x3e\r\n          \x3clabel\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"addMarker" class\x3d"shareRadios jimu-float-leading jimu-radio-btn" type\x3d"radio" name\x3d"radios" data-id\x3d"addMarker" data-dojo-type\x3d"dijit.form.RadioButton"\x3e\r\n            \x3cdiv class\x3d"labels"\x3e${nls.addMarker}\x3c/div\x3e\r\n          \x3c/label\x3e\r\n          \x3cdiv class\x3d"optionsMore addMarker_optionsMore"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"addMarker_marker" class\x3d"markers"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"moreOptions addMarker_moreOptions"\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.WKID}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_spatialReference" tabindex\x3d"0" name\x3d"spatialReference" data-dojo-type\x3d"dijit.form.TextBox"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.popupTitle}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_title" tabindex\x3d"0" title\x3d"${nls.addMarker_titlePlaceholder}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_titlePlaceholder}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.symbol}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_symbolURL" tabindex\x3d"0" title\x3d"${nls.addMarker_symbolURL}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_symbolURL}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.label}\x3c/span\x3e\r\n                  \x3cinput data-dojo-attach-point\x3d"addMarker_label" tabindex\x3d"0" title\x3d"${nls.addMarker_label}" data-dojo-type\x3d"dijit.form.TextBox" placeholder\x3d"${nls.addMarker_label}"\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"moreOptionsRow displaynone"\x3e\r\n                \x3clabel\x3e\r\n                  \x3cspan\x3e${nls.zoomLevel}\x3c/span\x3e\r\n                  \x3cdiv class\x3d"table-for-select"\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"addMarker_level" tabindex\x3d"0" name\x3d"addMarker_level" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/fieldset\x3e\r\n    \x3c/form\x3e\r\n\r\n    \x3cfieldset\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"overwirteMobileLayout" data-id\x3d"share-options-overwirteMobileLayout" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.overwirteMobileLayout}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-overwirteMobileLayout_optionsMore"\x3e\r\n          \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d"true"\r\n                 data-dojo-attach-point\x3d"mobileLayout" tabindex\x3d"0" data-dojo-props\x3d\'style:{width:"100px"}, constraints:{min:300}\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"setlanguage" data-id\x3d"share-options-language" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.language}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-language_optionsMore"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"setlanguage_languages" tabindex\x3d"0" title\x3d"${nls.language}" name\x3d"${nls.language}" class\x3d"shareSelects" style\x3d"display:inline-block;" data-dojo-type\x3d"dijit/form/Select"\x3e\x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix" style\x3d"display: none;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"auth" data-id\x3d"share-options-auth" class\x3d"shareCheckBoxes jimu-float-leading"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.auth}"\'\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"optionsMore share-options-auth_optionsMore"\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"authtoken" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true\'/\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"setLayerVisibility" data-id\x3d"share-options-layerVisibility" class\x3d"shareCheckBoxes"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-props\x3d\'label:"${nls.layerVisibility}"\'\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"optionsRow shareClearFix"\x3e\r\n        \x3clabel\x3e\r\n          \x3cdiv class\x3d"subTitle"\x3e${nls.linkPreview}\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"preview" tabindex\x3d"0" class\x3d"preview inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'\x3e\x3c/div\x3e\r\n        \x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"shareUrlsWrapper"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"Text"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"linkShare" data-dojo-attach-point\x3d"LinkShareContainer"\x3e\r\n      \x3clabel\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"LinkText" class\x3d"subTitle linkToApp"\x3e${nls.shareLinkText}\x3c/div\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_linkUrlTextBox" class\x3d"shareLinkUrl inputsText" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-props\x3d\'required:true,readOnly:true\' tabindex\x3d"0"/\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv class\x3d"shareClearFix"\x3e\r\n        \x3cspan role\x3d"link" class\x3d"optionsText jimu-float-leading" data-dojo-attach-point\x3d"linkOptions" tabindex\x3d"0" aria-title\x3d"${nls.linkOptions}"\x3e${nls.linkOptions}\x3c/span\x3e\r\n        \x3cdiv class\x3d"shareLinkIcons jimu-float-trailing" data-dojo-attach-point\x3d"socialNetworkLinks"\x3e\r\n          \x3ca role\x3d"link" class\x3d"socialNetworkIcons email" data-dojo-attach-point\x3d"emailShare" title\x3d"${nls.shareEmail}" tabindex\x3d"0"\x3e\x3c/a\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons facebook" data-dojo-attach-event\x3d"click:_toFacebook, keydown:_toFacebookKeyDown" data-dojo-attach-point\x3d"FacebookShare" title\x3d"${nls.shareFacebook}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons twitter" data-dojo-attach-event\x3d"click:_toTwitter, keydown:_toTwitterKeyDown" data-dojo-attach-point\x3d"TwitterShare" title\x3d"${nls.shareTwitter}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv role\x3d"link" class\x3d"socialNetworkIcons googlePlus" data-dojo-attach-point\x3d"googlePlusShare" title\x3d"${nls.shareGooglePlus}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"embedShare" data-dojo-attach-point\x3d"EmbedShareContainer"\x3e\r\n      \x3clabel\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"embedText" class\x3d"subTitle"\x3e${nls.embed}\x3c/div\x3e\r\n        \x3cinput data-dojo-attach-point\x3d"_embedCodeTextArea" role\x3d"presentation" class\x3d"shareEmbedCode inputsText" data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d\'required:true,readOnly:true\'/\x3e\r\n      \x3c/label\x3e\r\n      \x3cdiv role\x3d"link" class\x3d"moreOptions" data-dojo-attach-point\x3d"MoreOptions" data-dojo-attach-event\x3d"click:_moreOptionsExpandCollapse, keydown:_moreOptionsExpandCollapseKeyDown" tabindex\x3d"0"\x3e\r\n        \x3cdiv class\x3d"moreOptionsIcon" data-dojo-attach-point\x3d"MoreOptionsIcon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"optionsText"\x3e${nls.more}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"MoreOptionsContainer" class\x3d"moreOptionsContainer inputsText displaynone"\x3e\r\n        \x3cdiv class\x3d"sizeSelect" data-dojo-attach-point\x3d"SizeSelect"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"customSize disable" data-dojo-attach-point\x3d"CustomSizeContainer"\x3e\r\n          \x3cdiv class\x3d"timesConnector"\x3eX\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"shareTips" data-dojo-attach-point\x3d"shareTips"\x3e\r\n      \x3c!--\x3cdiv class\x3d"infoIcon"\x3e\x3c/div\x3e--\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"shareTipsText" class\x3d"shareTipsText"\x3e${nls.shareToWebTips}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.selectLayer}"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/startup/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"header" data-dojo-attach-point\x3d"headerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"viewStackNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:builder/plugins/startup/css/style.css":".plugin-startup\x3e.jimu-viewstack{position: absolute; top: 61px; bottom: 0; left: 0; right: 0; height: auto; overflow: hidden; background-color: #f3f3f3;}.plugin-startup .image-404{position: absolute; top: 50%; margin-top: -80px; left: 50%; margin-left: -238px;}",
"url:builder/plugins/theme-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"theme-list" data-dojo-attach-point\x3d"themeList"\x3e\r\n    \x3cdiv class\x3d"theme-title"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"separate-line"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"style-list" data-dojo-attach-point\x3d"styleList"\x3e\r\n    \x3c!--div class\x3d"style-text"\x3e${nls.styleTitle}\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layout-list" data-dojo-attach-point\x3d"layoutList"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"theme-loading-cover" style\x3d"display:none" data-dojo-attach-point\x3d"themeCoverNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/ColorRecords.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\t\t\x3ctr tabindex\x3d"0" role\x3d"row" data-dojo-attach-point\x3d"container"\x3e\r\n\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/theme-config/css/style.css":".plugin-theme-config{overflow: auto; position: relative;}.plugin-theme-config .section {}.plugin-theme-config .theme-section{}.plugin-theme-config .theme-list{overflow: auto; display: none; padding-left: 20px; padding-right: 4px; border: 0px solid;}.jimu-rtl .plugin-theme-config .theme-list{padding-left: 4px; padding-right: 20px;}.plugin-theme-config .theme-title{margin-top: 20px; margin-left: 18px; font-size: 14px; color: #015574;}.plugin-theme-config .theme-catalog{border: 0px solid; display: none; overflow: hidden;}.plugin-theme-config .catalog-theme-content-div{border: 0px solid; width: 33.333%; height: 118px; overflow: hidden;}.plugin-theme-config .catalog-theme-div{position: relative; width: 110px; height: 78px; cursor: pointer; border: 2px solid #ffffff;}.plugin-theme-config .catalog-theme-div:hover{border-color: #24B5CC;}.plugin-theme-config .catalog-theme-selected {border-color: #24B5CC;}.plugin-theme-config .catalog-theme-img-box-div{width: 106px; height: 74px; border: 1px solid #ddd;}.plugin-theme-config .catalog-theme-img-box-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-box-div.selected{border: 1px solid #ffffff;}.plugin-theme-config .catalog-theme-img-div{text-align: center; width: 84px; height: 56px; display: block; margin-top: 8px; margin-left: auto; margin-right: auto;}.plugin-theme-config .catalog-theme-img{text-align: center; width: 84px; height: 56px;}.plugin-theme-config .catalog-theme-name-div{border: 0px solid; width: 106px; overflow: hidden; text-align: center; padding-top: 5px; font-size: 12px; color: #333; cursor: default; text-overflow: ellipsis; line-height: 17px;}.plugin-theme-config .theme-cl-selected-div{position: absolute; left: 21px; top: 21px; width: 40px; height: 34px; border: 0px solid; text-align: center; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .theme-cl-selected-img{margin-top: 10px;}.plugin-theme-config .separate-line{margin-left: 10px; margin-right: 10px; border-top: 1px solid #ddd;}.plugin-theme-config .style-list{border: 0px solid; padding-right: 20px; padding-left: 20px;}.plugin-theme-config .style-section{border: 0px solid; overflow: auto;}.plugin-theme-config .style-text{margin-top: 20px; margin-bottom: 15px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .style-color-content{}.plugin-theme-config .style-div{position: relative; width: 25%; height: 30px; margin-bottom: 12px; cursor: pointer; padding: 4px; background-clip: content-box; border: 2px solid rgba(0,0,0,0);}.plugin-theme-config .style-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .style-image{}.plugin-theme-config .style-selected{border: 2px solid #24B5CC;}.plugin-theme-config .style-selected-div{position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.65); text-align: center; display: none;}.plugin-theme-config .layout-list{border: 0px solid;}.plugin-theme-config .layout-section{border: 0px solid; overflow: hidden; margin-top: 28px; padding-left: 20px; position: relative;}.plugin-theme-config .layout-section .layout-action{position: absolute; top: 0; right: 30px; font-size: 12px; cursor: pointer; color: #666;}.plugin-theme-config .layout-section .layout-action span{display: inline-block; vertical-align: middle; margin-left: 8px;}.jimu-rtl .plugin-theme-config .layout-section .layout-action{left: 30px; right: auto;}.jimu-rtl .plugin-theme-config .layout-section .layout-action span{margin-left: auto; margin-right: 8px;}.plugin-theme-config .layout-section .layout-action:hover{color: #12A1B8;}.plugin-theme-config .layout-section .layout-action .modify-icon{font-family: 'feature actions';}.plugin-theme-config .layout-section .layout-action .modify-icon:before{content: '\\e90e';}.jimu-rtl .plugin-theme-config .layout-section{padding-right: 20px; padding-left: 4px;}.plugin-theme-config .layout-text{margin-bottom: 16px; font-size: 14px; font-family: \"Avenir Medium\"}.plugin-theme-config .layout-out-div{position: relative; margin-bottom: 15px; width: 33%;}.plugin-theme-config .layout-box-div{width: 106px; height: 80px; border: 2px solid #ffffff;}.plugin-theme-config .layout-box-div:hover{border: 2px solid #24B5CC;}.plugin-theme-config .layout-box-selected{border: 2px solid #24B5CC;}.plugin-theme-config .layout-div{width: 102px; height: 76px; border: 1px solid #ddd; text-align: center; cursor: pointer;}.plugin-theme-config .layout-div:hover{border: 1px solid #ffffff;}.plugin-theme-config .layout-selected{border: 1px solid #ffffff;}.plugin-theme-config .layout-image{width: 80px; height: 54px; margin-top: 10px;}.plugin-theme-config .layout-selected-div{position: absolute; left: 28px; top: 24px; width: 40px; height: 34px; border: 0px solid; text-align: center; padding-top: 6px; display: none; background-color: rgba(0, 0, 0, 0.65);}.plugin-theme-config .layout-selected-img{}.plugin-theme-config .theme-loading-cover{position: absolute; z-index: 999; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.3);}.plugin-theme-config .style-div .color-label{margin-top: -8px;}.plugin-theme-config .jimu-color-picker{border-radius: 0;}.plugin-theme-config .jimu-color-picker:not(.jimu-theme-color-chooser){width: 0; height: 0;}",
"url:builder/plugins/widget-config/WidgetSettingPage.html":'\x3cdiv class\x3d"widget-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.widgetLabel}" required\x3d"true" class\x3d"widget-setting-input" tabindex\x3d"0"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c!-- \x3cspan nowrap class\x3d"change-icon" data-dojo-attach-point\x3d"changeNode"\x3e${nls.changeIcon}\x3c/span\x3e --\x3e\r\n            \x3ca class\x3d"help-link jimu-float-trailing" target\x3d"_blank" data-dojo-attach-point\x3d"helpNode"\x3e${nls.more}\x3c/a\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layout"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"section widget-setting" data-dojo-attach-point\x3d"widgetSettingNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/GroupSettingPage.html":'\x3cdiv class\x3d"group-setting-page"\x3e\r\n  \x3cdiv class\x3d"section common-setting" data-dojo-attach-point\x3d"commonSettingNode"\x3e\r\n    \x3cdiv class\x3d"basic"\x3e\r\n      \x3cdiv class\x3d"icon jimu-float-leading"\x3e\r\n        \x3cimg class\x3d"real-icon"  data-dojo-attach-point\x3d"iconNode"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"right jimu-float-trailing jimu-leading-margin1"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"labelNode" placeholder\x3d"${nls.groupLabel}" required\x3d"true" class\x3d"group-setting-input"\x3e\r\n        \x3cdiv class\x3d"right-foot" data-dojo-attach-point\x3d"rightFooterNode"\x3e\r\n          \x3cdiv class\x3d"image-container"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserPlaceholder"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:builder/plugins/widget-config/WidgetChoosePage.html":'\x3cdiv class\x3d"widget-choose-page"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"officialSection" class\x3d"official-section"\x3e\r\n    \x3cdiv class\x3d"section search" data-dojo-attach-point\x3d"searchSectionNode"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"searchInputNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"list widget-list" data-dojo-attach-point\x3d"widgetListNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"customSection" class\x3d"custom-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"customSearchInputNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/CustomWidgets.html":'\x3cdiv data-dojo-attach-event\x3d"onscroll:_onScroll"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"list" class\x3d"list widget-list" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loading" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:builder/plugins/widget-config/Plugin.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"preload-widgets-list" data-dojo-attach-point\x3d"preloadWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"controller-widgets-list" data-dojo-attach-point\x3d"controllerWidgetsNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"onScreenGroupsHline"\x3e\r\n    \x3cdiv class\x3d"onscreen-groups-list-wrapper"\x3e\r\n      \x3cdiv class\x3d"onscreen-groups-list" data-dojo-attach-point\x3d"onScreenGroupsListNode"\x3e\x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"group-exceed-max-error jimu-state-error" data-dojo-attach-point\x3d"groupExceedMaxErrorNode"\x3e\r\n        \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"groupExceedMaxErrorStringNode"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"not-removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"notRemoveableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n    \x3chr  data-dojo-attach-point\x3d"removeableOnScreenWidgetsHline"\x3e\r\n    \x3cdiv class\x3d"removeable-onscreen-widgets-list" data-dojo-attach-point\x3d"removeableOnScreenWidgetsListNode"\x3e\x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"pool-widgets-list" data-dojo-attach-point\x3d"poolWidgetsNode"\x3e\r\n    \x3cdiv class\x3d"widgets-link" data-dojo-attach-point\x3d"backWidgetsNode" data-dojo-attach-event\x3d"onclick: _onBackWidgetsClick"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"backArrowNode" class\x3d"jimu-float-leading feature-action icon-arrow-back"\x3e\x3c/div\x3e\r\n      \x26nbsp;\r\n      ${nls.widgets}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-title" data-dojo-attach-point\x3d"poolTitleNode"\x3e${nls.setControlledWidgetsBy}\x3cspan data-dojo-attach-point\x3d"controllerLabelNode"\x3e\x3c/span\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"widget-pool-list-wrapper"\x3e\x3cdiv class\x3d"widget-pool-list" data-dojo-attach-point\x3d"poolWidgetsListNode"\x3e\x3c/div\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"offpanel-group-error jimu-state-error" data-dojo-attach-point\x3d"offPanelToGroupErrorNode"\x3e\r\n      \x3cspan class\x3d"jimu-icon jimu-icon-alert"\x3e\x3c/span\x3e\r\n      \x3cspan\x3e${nls.offPanelToGroupError}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/plugins/widget-config/css/style.css":'.json-editor{width: 100%; height: 100%; position: relative;}.app-widgets{width: 100%; height: 100%;}.app-widgets\x3e.jimu-viewstack{width: 100%; height: 100%;}.app-widgets .preload-widgets-list, .app-widgets .pool-widgets-list{position: relative; width: 100%; height: 100%; padding: 10px 0px; -ms-overflow-x: hidden; -ms-overflow-y: auto; overflow-x: hidden; overflow-y: auto;}.app-widgets .preload-widgets-list hr{margin: 10px 15px -5px 15px; border: none; border-top: 1px solid #ddd;}.app-widgets .controller-widget{position: relative; height: 118px; padding-top: 20px; margin-left: -10px;}.jimu-rtl .app-widgets .controller-widget{margin-right: -10px;}.app-widgets .controller-widget:hover{background-color: #F3F3F3;}.app-widgets .controller-widget .action-node{position: absolute; left: 96px; top: 20px; height: 74px; right: 0; line-height: 74px; cursor: pointer; font-size: 14px;}.app-widgets .controller-widget .action-node .action-text{white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: 230px; font-family: "Avenir Medium"}.app-widgets .controller-widget .action-node .action-arrow{margin-top: 30px;}.app-widgets .not-removeable-onscreen-widgets-list,.app-widgets .removeable-onscreen-widgets-list,.app-widgets .onscreen-groups-list-wrapper{position: relative; left: 0; right: 0; margin-top: 20px;}.app-widgets .removeable-onscreen-widgets-list {padding-left: 10px; display: flex; align-items: flex-start; flex-flow: row wrap;}.jimu-rtl .app-widgets .removeable-onscreen-widgets-list {padding-left: 0; padding-right: 10px;}.app-widgets .removeable-onscreen-widgets-list .moveable {position: relative;}.app-widgets .removeable-onscreen-widgets-list \x3e div:not(:nth-child(8n+1)) {margin-left: 20px;}.app-widgets .removeable-onscreen-widgets-list \x3e div:nth-child(8n+1) {margin-left: 10px;}.jimu-rtl .app-widgets .removeable-onscreen-widgets-list \x3e div:not(:nth-child(8n+1)) {margin-right: 20px; margin-left: 0;}.jimu-rtl .app-widgets .removeable-onscreen-widgets-list \x3e div:nth-child(8n+1) {margin-right: 10px; margin-left: 0;}.app-widgets .removeable-onscreen-widgets-list .node-margin {display: none;}.jimu-rtl .app-widgets .removeable-onscreen-widgets-list .moveable,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list .node-margin{float: right;}.app-widgets .widget-pool-list-wrapper{position: absolute; top: 95px; left: 0; right: 0; bottom: 0; overflow-x: hidden; overflow-y: auto;}.app-widgets .widget-pool-list-wrapper .widget-pool-list{width: 100%; height: 100%;}.app-widgets .onscreen-groups-list-wrapper .onscreen-groups-list{width: 100%; height: 100%;}.app-widgets .jimu-state-error{position: absolute; z-index: 1; left: 0; top: 42px; height: 30px; line-height: 30px; width: 100%; padding: 0 10px; filter:alpha(opacity\x3d0); opacity: 0; display: none;}.app-widgets .group-exceed-max-error{z-index: 5; top: 0;}.app-widgets .widgets-link{font-size: 14px; margin-left: 20px; cursor: pointer; font-family: "Avenir Medium"; margin-top: 20px; color: #333;}.app-widgets .widgets-link:hover{color: black;}.app-widgets .widget-pool-title{margin-top: 15px; font-size: 12px; color: #999; margin-left: 20px;}.app-widgets .moveable{position: absolute; font-size: 12px; float: left; z-index: 3;}.jimu-rtl .app-widgets .moveable{float: right;}.app-widgets .moveable.dojoMoveItem{z-index: 4;}.app-widgets .moveable .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 112px; height: 112px; overflow: hidden; cursor: pointer;}.app-widgets .preload-widgets-list .moveable.group-node .box{background-color: #80C6D1; border: 1px solid #80C6D1;}.app-widgets .preload-widgets-list .moveable.group-node .box:hover{}.app-widgets .preload-widgets-list .moveable.placeholder .box{background-color: #bbb; border: 1px solid #bbb;}.app-widgets .preload-widgets-list .moveable.placeholder .box:hover{background-color: #aaa;}.app-widgets .moveable.node-active .box{border: 3px solid #15a4fa;}.app-widgets .moveable .box.jimu-state-active{border: 2px solid red;}.app-widgets .moveable .label{text-align: center; width: 100%; height: 30px; margin-top: 6px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; color: #333;}.app-widgets .moveable .edit-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/edit_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .open-at-start-btn{position: absolute; border-radius: 6px; border: 2px solid white;}.app-widgets .moveable .open-at-start-btn.active{background-color: #336666; filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .open-at-start-btn.deactive{filter:alpha(opacity\x3d50); opacity: 0.5;}.app-widgets .moveable .drop-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-image: url(images/delete_widget.png); background-repeat: no-repeat; background-position: center;}.app-widgets .moveable .switch-btn{position: absolute; border-radius: 2px; background: url(images/eye_open.png) no-repeat center center;}.app-widgets .moveable .small-add-btn{position: absolute; background-color: #000; background-color: rgba(0, 0, 0, 0.3); background-repeat: no-repeat; background-position: center; background-image: url(images/small_add.png);}.app-widgets .moveable.hide .switch-btn{background-image: url(images/eye_close.png);}.app-widgets .moveable.hide{opacity: 0.5;}.app-widgets .moveable .edit-btn:hover, .app-widgets .moveable .drop-btn:hover, .app-widgets .moveable .small-add-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .moveable .open-at-start-btn:hover{filter:alpha(opacity\x3d100); opacity: 1;}.app-widgets .moveable .switch-btn:hover{background-image: url(images/eye_open_hover.png);}.app-widgets .moveable.hide .switch-btn:hover{background-image: url(images/eye_close_hover.png);}.app-widgets .moveable .switch-btn:hover{background-color: rgba(0, 0, 0, 0.6);}.app-widgets .node-shadow{position: absolute; border: 1px dashed;}.app-widgets .node-margin{position: absolute; z-index: 2;}.app-widgets .node-margin-active{background: red;}.app-widgets .add-widget-node{position: absolute; font-size: 12px; float: left;}.app-widgets .add-widget-node .box{background-color: #fafafc; border: 1px dashed #d2dae2; color: #596679;}.app-widgets .add-widget-node .box:hover{background-color: #eaeaea;}.app-widgets .add-widget-node img{width: 20px; height: 20px; display: block; margin: 27px;}.app-widgets .empty-node .box{opacity: 0; cursor: normal;}.app-widgets .empty-node-active .box{opacity: 0.4;}.app-widgets .widget-node .placeholder,.app-widgets .group-node .placeholder{overflow: hidden;}.app-widgets .widget-node .placeholder-inner,.app-widgets .group-node .placeholder-inner{text-align: center; color: white; font-size: 14px;}.app-widgets .group-node .placeholder-inner {border: 1px solid white; width: 32px !important; height: 32px !important; line-height: 32px !important; border-radius: 16px !important; margin: 0 !important;}.app-widgets .group-node .small{float: left;}.app-widgets .group-node .add-button{width: 20px; height: 20px; margin: auto; display: block; margin-top: 25px;}.app-widgets .widget-group-panel{position: absolute; background-color: #E3ECF2;}.app-widgets .group-triangle{position: absolute; width: 0px; height: 0px; top: -8px; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid #E3ECF2;}.widget-setting-popup .content{overflow-y: hidden;}.widget-setting-page{width: 100%; height: 100%;}.widget-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.widget-setting-page .common-setting .basic{overflow: hidden;}.widget-setting-page .common-setting .label input{width: 224px; height: 32px;}.widget-setting-page .opts-section{padding: 5px;}.widget-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.widget-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.widget-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.widget-setting-page .common-setting .right .widget-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.widget-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.widget-setting-page .image-container .help-link{color: #24B5CC; display:none;}.widget-setting-page .image-container .help-link:hover{color: #0090A7;}.widget-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.widget-setting-page .common-setting .right .change-icon{white-space:nowrap; color: white; cursor: pointer; display: inline-block; background-color: #518dca; text-align: center; vertical-align: middle; height: 30px; line-height: 30px; padding-left: 6px; padding-right: 6px; box-shadow: 0 0 2px gray; position: relative;}.widget-setting-page .common-setting .right .disable-change-icon{background-color: #a0acbf; cursor: default;}.widget-setting-page .common-setting .right .more{float: right; color: #15a4fa; display: inline-block; margin-top: 20px;}.widget-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.widget-setting-page .common-setting .right .state{font-size: 14px; margin-top: 10px;}.widget-setting-page .widget-setting{overflow-x: hidden; overflow-y: auto; position: relative;}.widget-setting-page .widget-default-setting{width: 100%; height: 100%;}.widget-setting-page .opts-section{height: 50px;}.widget-setting-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-setting-page .noconfig-info{font-size: 16px; position: absolute; left: 50%; top: 50%; margin-left: -100px;}.widget-choose-page{width: 100%; height: 100%;}.widget-choose-page \x3e .jimu-tab3 \x3e .container-node{height: 635px; overflow: hidden;}.widget-choose-page .jimu-item-selector .setting-tab-container{height: 98%; margin-top: 2%;}.widget-choose-page .jimu-search{margin: 10px 0;}.widget-choose-page .jimu-search .jimu-input{font-size: 12px;}.widget-choose-page .widget-node{width: 84px; height: 118px; margin: 10px 10px 0 0px; float: left; font-size: 12px; cursor: pointer; position: relative;}.widget-choose-page .widget-node .box{position: relative; border: 1px solid #80C6D1; background-color: #80C6D1; width: 78px; height: 78px; overflow: hidden; margin: 0 auto;}.widget-choose-page .widget-node .box-selected{position: absolute; width: 16px; height: 16px; left: 5px; top: 5px; display: none; background: url(images/checked.svg);}.widget-choose-page .widget-node.jimu-state-selected .box-selected{display: block;}.widget-choose-page .widget-node .icon{width: 32px; height: 32px; display: block; margin: auto; margin-top: 23px;}.widget-choose-page .widget-node .label{text-align: center; width: 100%; height: 30px; margin-top: 10px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}.widget-choose-page .search{width: 100%; overflow-x: hidden; overflow-y: hidden;}.widget-choose-page .list{height: 100%; margin-right: -10px; padding-left: 1px; overflow-y: auto; width: 964px;}.widget-choose-page .opts-section{overflow: hidden; margin-top: 10px;}.widget-choose-page .opts-section .jimu-btn{width: 182px; height: 40px; margin-left: 8px;}.widget-choose-page .custom-section{position: relative;}.widget-choose-page .custom-widgets{display: block; position: absolute; width: 100%; left: 0; right: 0; top: 50px; bottom: 0;}.widget-choose-page .hidden{display: none;}.widget-choose-page .custom-widgets .detail-icon{display: none; position: absolute; right: 7px; bottom: 7px; width: 15px; height: 15px; background-color: rgba(0, 0, 0, 0.4); background-repeat: no-repeat; background-image: url(images/info.png); border-radius: 3px; cursor: pointer;}.jimu-rtl .widget-choose-page .custom-widgets .detail-icon{right: auto; left: 7px;}.widget-choose-page .custom-widgets .widget-node .box:hover .detail-icon{display: block;}.group-setting-popup .content{overflow-y: hidden;}.group-setting-page{width: 100%;}.group-setting-page .common-setting{height: 74px; margin-bottom: 20px;}.group-setting-page .common-setting .basic{overflow: hidden;}.group-setting-page .opts-section{padding: 5px;}.group-setting-page .common-setting .icon{background-color: #80C6D1; border: 1px solid #80C6D1; width: 74px; height: 74px; display: inline-block;}.group-setting-page .common-setting .icon img{width: 40px; height: 40px; margin: 17px;}.group-setting-page .common-setting .right{font-size: 10px; width: 875px; display: inline-block;}.group-setting-page .common-setting .right .group-setting-input{width: 100%; color: black; display: block; background-color: #fafafc;}.group-setting-page .image-container{overflow:hidden; min-width: 100px; width: 100%; display: inline-block; position: relative; height: 30px; margin-top: 14px;}.group-setting-page .jimu-image-chooser{height: 30px; padding: 0;}.group-setting-page .common-setting .right-foot{position: relative; font-size: 14px;}.jimu-rtl .app-widgets .controller-widget .action-node{right: 96px; left: 0;}.jimu-rtl .widget-choose-page .widget-node{margin: 10px 0 0 10px; float: right;}.jimu-rtl .widget-choose-page .list{margin-right: 0; padding-left: 0; overflow-x: hidden;}.jimu-rtl .app-widgets .widgets-link{margin-left: auto; margin-right: 20px;}.jimu-rtl .app-widgets .widget-pool-title{margin-left: auto; margin-right: 20px;}.jimu-rtl .app-widgets .not-removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .removeable-onscreen-widgets-list,.jimu-rtl .app-widgets .onscreen-groups-list-wrapper,.jimu-rtl .app-widgets .widget-pool-list-wrapper{right: 0; left: 0;}.jimu-rtl .widget-choose-page .widget-node .box-selected{right: 5px; left: auto;}.dj_ie8 .app-widgets .empty-node .box {-ms-filter: "Alpha(opacity\x3d0)"; filter: Alpha(opacity\x3d0);}.dj_ie8 .app-widgets .moveable .edit-btn{-ms-filter: "Alpha(opacity\x3d30)"; filter: Alpha(opacity\x3d30);}.dj_ie8 .app-widgets .moveable .edit-btn:hover{-ms-filter: "Alpha(opacity\x3d60)"; filter: Alpha(opacity\x3d60);}.dj_ie8 .app-widgets .moveable.hide {-ms-filter: "Alpha(opacity\x3d50)"; filter: Alpha(opacity\x3d50);}.widget-choose-page.hide-custom-widgets .jimu-tab3{height: 100%;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .control-node{display: none;}.widget-choose-page.hide-custom-widgets .jimu-tab3 .jimu-viewstack{height: 100%;}',
"*now":function(p){p(['dojo/i18n!*preload*builder/nls/main*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/config dojo/_base/html dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/cookie dojo/topic dojo/json dojo/request/script jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/Message jimu/DataSourceManager ./tokenUtils ./utils ./PluginManager require esri/request esri/IdentityManager dojo/text!./plugins/plugins.json dojo/i18n!./nls/builder".split(" "),function(p,g,t,v,n,m,u,k,f,e,b,a,c,x,w,q,C,z,E,B,G,F,D){function I(b){g.setStyle("pre-main-page","display",
"none");g.setStyle("main-page","display","block");window.portalUrl=b.portalUrl;q.setPortalUrl(window.portalUrl);var c=a.getSharingUrl(window.portalUrl);G.checkSignInStatus(c).then(function(){J(b)},function(){if(window.isXT)q.xtGetCredentialFromCookie(window.portalUrl)&&J(b);else{var c=a.getPortalSignInUrlFromLocation(),e=encodeURIComponent(window.location.href);window.location.href=c+"?returnUrl\x3d"+e}})}function K(a){g.create("div",{className:"app-error",innerHTML:a},document.body)}function J(e){var f=
"";!window.isXT&&window.queryObject&&(window.queryObject.id&&!/^(stemapp|stemapp3d)$/gi.test(window.queryObject.id)?f=window.queryObject.id:window.queryObject.appid&&(f=window.queryObject.appid));var k=Q(),v=M(),l=S(f),d=function(){q.signOutAll();if(window.isXT)window.location.href=window.location.href;else{var b=a.getPortalSignInUrlFromLocation(),c=encodeURIComponent(window.location.href);window.location.href=b+"?returnUrl\x3d"+c}};n([k,v,l]).then(t.hitch(this,function(h){var k=h[1],l=h[2];h[0]&&
k?"string"===typeof l?(q.signOutAll(),K(l)):T(f).then(function(d){if(d.hasEssentialAppsLicense)if(d.canCreateItem){var f=c.getPortal(window.portalUrl);d=f.loadSelfInfo();var h=L(window.portalUrl),k;n([d,h]).then(function(a){k=a[0];window.portalSelf=k;window.isXT?a=C.checkProtocolAndUpdateSigninInfo(k,e):(a=new m,a.resolve({success:!0}));return a}).then(function(c){if(c.success){var d=k.user&&k.user.culture||k.culture||p.locale;d&&(d=d.toLowerCase());c=null;!window.queryObject.locale&&b.isLocaleChanged(p.locale,
d)&&(u("wab_locale",d),c=window.location.href);window.isXT&&/[\?|\&](action=)(.+)/gi.test(window.location.href)&&(c||(c=window.location.href),c=C.removeActionFromUrl(c));d="https:"===window.location.protocol;if(k.allSSL||d)window.portalUrl=e.portalUrl=a.setHttpsProtocol(e.portalUrl);f.portalUrl=window.portalUrl;var h=0===window.portalUrl.toLowerCase().indexOf("https:");!d&&h&&(c||(c=window.location.href),c=c.replace(/^http:/i,"https:"));c?window.location.href=c:(c=U.startup,c.options={signinInfo:e},
z.getInstance(U).loadPlugin(c).then(t.hitch(this,function(a){a.placeAt(g.byId("main-page"));a.startup()})))}else console.log("Update signin info error.")})}else K(window.jimuNls.noEditPrivileges),q.signOutAll();else K(window.jimuNls.essentialAppsLicenseErrorForBuilder),q.signOutAll()}):d()}),d)}function L(b){var e=a.getSharingUrl(b),f=new m;B({url:e,content:{f:"json"},handleAs:"json",callbackParamName:"callback",preventCache:!0}).then(t.hitch(this,function(e){window.portalVersion=e.currentVersion;
a.isOnline(b)?window.isPortalSupport3D=!0:window.isPortalSupport3D=0<=c.comparePortalVersion(window.portalVersion,"3.7");f.resolve()}),t.hitch(this,function(a){console.error(a);f.reject(a)}));return f}function M(){var b=new m,c=q.getPortalCredential(window.portalUrl);c&&c.token?(c=a.getPortalSelfInfoUrl(window.portalUrl)+"?f\x3djson\x26token\x3d"+c.token,c=a.setHttpsProtocol(c),e.get(c,{handleAs:"json",jsonp:"callback",timeout:6E4}).then(t.hitch(this,function(a){a&&!a.error?b.resolve(!0):b.resolve(!1)}),
t.hitch(this,function(a){console.error(a);b.reject(a)}))):b.resolve(!1);return b}function Q(){var a=new m;window.isXT?c.getPortal(window.portalUrl).getUser().then(function(b){if(b)if("1"===b.level||1===b.level)var c=new x({message:window.builderNls.userLevelTip,buttons:[{label:window.jimuNls.common.ok,onClick:t.hitch(this,function(){a.resolve(!1);c.close()})}]});else a.resolve(!0);else a.resolve(!1)},function(b){a.reject(b)}):a.resolve(!0);return a}function S(a){var b=new m;window.isXT?b.resolve(!0):
a?c.getPortal(window.portalUrl).getItemById(a).then(function(a){403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.resolve(!0)},function(a){a&&403===a.httpCode&&"GWM_0003"===a.messageCode?b.resolve(a.message):b.reject(a)}):b.resolve(!0);return b}function T(a){var e=new m,f={hasEssentialAppsLicense:!0,canCreateItem:!0,error:null};if(window.isXT)e.resolve(f);else{var g=c.getPortal(window.portalUrl);b.checkEssentialAppsLicense(a,g,!0).then(t.hitch(this,function(){g.getUser().then(function(a){a&&
a.canCreateItem()?f.canCreateItem=!0:f.canCreateItem=!1;e.resolve(f)})}),t.hitch(this,function(a){f.hasEssentialAppsLicense=!1;f.error=a;e.resolve(f)}))}return e}function O(a,c){v.forEach(c,function(c){var e=U[c.pluginName],f;for(f in c.parameters)if(f===a.name){var d=c.parameters[f];b.url.isAbsolute(d)||(c.parameters[f]=e.folderUrl+d)}})}function W(a){var c=new m;if(!a.parameters||null===f.stringify(a.parameters).match(/\$\{(\w)+\}/g))return c.resolve(!0),c;var e=U[a.pluginName];z.getInstance().loadPluginI18n(e).then(function(e){a.parameters=
b.replacePlaceHolder(a.parameters,e);c.resolve(!0)});return c}var U=f.parse(F);window.builderNls=D;window.pluginsMeta=U;w.getInstance();"function"!==typeof u.getAll&&(u.getAll=function(a){var b=[];(a=u(a))&&b.push(a);return b});jimuConfig.layoutId=jimuConfig.mainPageId;k.subscribe("switchToMainPage",function(a){var c=C.removeActionFromUrl(window.location.href);b.changeLocation(c);I(a)});(function(){for(var a in U){var b=U[a];b.amdFolder="builder/plugins/"+a.replace(/\./g,"/")+"/";b.folderUrl=E.toUrl(b.amdFolder);
b.uri=b.amdFolder+"Plugin"}a=[];for(var c in U){var b=U[c],e;for(e in b.extensionPoints){var f=b.extensionPoints[e],d;for(d in f.parameters){var g=f.parameters[d];"url"===g.type&&O(g,f.extensions)}if(f.extensions)for(g=0;g<f.extensions.length;g++)a.push(W(f.extensions[g]))}}return n(a)})().then(function(){g.setStyle("main-loading","display","none");window.isXT?E(["./xtMain"]):k.publish("switchToMainPage",{portalUrl:a.getPortalUrlFromLocation()})})});